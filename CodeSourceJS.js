if(!Object.keys){Object.keys=(function(){'use strict';var hasOwnProperty=Object.prototype.hasOwnProperty,hasDontEnumBug=!({toString:null}).propertyIsEnumerable('toString'),dontEnums=['toString','toLocaleString','valueOf','hasOwnProperty','isPrototypeOf','propertyIsEnumerable','constructor'
],dontEnumsLength=dontEnums.length;return function(obj){if(typeof obj!=='object'&&(typeof obj!=='function'||obj===null)){throw new TypeError('Object.keys called on non-object');}
var result=[],prop,i;for(prop in obj){if(hasOwnProperty.call(obj,prop)){result.push(prop);}}
if(hasDontEnumBug){for(i=0;i<dontEnumsLength;i++){if(hasOwnProperty.call(obj,dontEnums[i])){result.push(dontEnums[i]);}}}
return result;};}());}
if(typeof Object.create!=='function'){(function(){var F=function(){};Object.create=function(o){if(arguments.length>1){throw Error('Second argument not supported');}
if(o===null){throw Error('Cannot set a null [[Prototype]]');}
if(typeof o!=='object'){throw TypeError('Argument must be an object');}
F.prototype=o;return new F();};})();};

if(!Function.prototype.bind){Function.prototype.bind=function(obj){var slice=[].slice,args=slice.call(arguments,1),self=this;var nop=function(){};var bound=function(){return self.apply(this instanceof nop?this:(obj||{}),args.concat(slice.call(arguments)));};nop.prototype=self.prototype;bound.prototype=new nop();return bound;};};
(function(){IE.MethodesTableau={};if(!Array.isArray){Array.isArray=function(arg){return Object.prototype.toString.call(arg)==='[object Array]';};}
IE.MethodesTableau.forEach=function(aTableau,aMethode,thisArg){if(!Array.isArray(aTableau)) return;if(aTableau.forEach){aTableau.forEach(aMethode,thisArg);return;}
var i,lLength;for(i=0,lLength=aTableau.length;i<lLength;i++){if(i in aTableau){aMethode.call(thisArg,aTableau[i],i,aTableau);}}};IE.MethodesTableau.every=function(aTableau,aMethode,thisArg){if(!Array.isArray(aTableau)) return;if(aTableau&&aTableau.every){return aTableau.every(aMethode,thisArg);}
var i,lLength;for(i=0,lLength=aTableau.length;i<lLength;i++){if(i in aTableau&&!aMethode.call(thisArg,aTableau[i],i,aTableau)){return false;}}
return true;};IE.MethodesTableau.chercher=function(aValeur,aTableau,aFromIndex){if(aTableau&&aTableau.indexOf){return aTableau.indexOf(aValeur,aFromIndex);}
return $.inArray(aValeur,aTableau,aFromIndex);};IE.MethodesTableau.existe=function(aValeur,aTableau){return IE.MethodesTableau.chercher(aValeur,aTableau)!== -1;};function _filterIntersection(aTableauCompare ,aElement){return IE.MethodesTableau.chercher(aElement,aTableauCompare)!== -1;}
IE.MethodesTableau.intersection=function(aTableau1,aTableau2){var lResult,i;if(aTableau1&&aTableau1.filter){return aTableau1.filter(_filterIntersection.bind(this,aTableau2));}
lResult=[];for(i=0;i<aTableau1.length;i++){if(IE.MethodesTableau.existe(aTableau2,aTableau1[i])){lResult.push(aTableau1[i]);}}
return lResult;};IE.MethodesTableau.existeIntersection=function(aTableau1,aTableau2){return IE.MethodesTableau.intersection(aTableau1,aTableau2).length>0;};function _everyInclus(aTableauCompare ,aElement){return IE.MethodesTableau.chercher(aElement,aTableauCompare)!== -1;}
IE.MethodesTableau.inclus=function(aTableau1,aTableau2){if(!Array.isArray(aTableau1)||!Array.isArray(aTableau2)){return false;}
var I;if(aTableau1.every){return!!aTableau1.every(_everyInclus.bind(this,aTableau2));}
for(I=0;I<aTableau1.length;I++){if(!_everyInclus(aTableau2,aTableau1[I])){return false;}}
return true;};IE.MethodesTableau.insererElement=function(aValeur,aTableau,aIndex){if(!Array.isArray(aTableau)) return false;if(aIndex>=0){var T=aTableau.slice(aIndex);aTableau.length=aIndex;aTableau.push(aValeur);Array.prototype.push.apply(aTableau,T);} else{aTableau.push(aValeur);}};IE.MethodesTableau.supprimerElement=function(aTableau,aIndex){aTableau.splice(aIndex,1);};IE.MethodesTableau.parcourir=function(aTableau,aMethode){var i,lLength;if(!Array.isArray(aTableau)) return;for(i=0,lLength=aTableau.length;i<lLength;i++){if(aMethode(aTableau[i],i)===true){return;}}};IE.MethodesTableau.dernier=function(aTableau){if(Array.isArray(aTableau)&&(aTableau.length>0)){return aTableau[aTableau.length-1];}
return null;};IE.MethodesTableau.enleverDoublons=function(aTableau){var lTableau=[];IE.MethodesTableau.parcourir(aTableau,function(aValeur){if(!IE.MethodesTableau.existe(aValeur,lTableau)){lTableau.push(aValeur);}});return lTableau;};IE.MethodesTableau.nombreElements=function(aTableau){var lNombre=0,i,lElement;for(i=0;i<aTableau.length;i++){lElement=aTableau[i];if(lElement!==null||lElement!==undefined){lNombre++;}}
return lNombre;};}());var MethodesTableau=IE.MethodesTableau;;
Math.borner=function(aValeur,aMin,aMax){return Math.max(Math.min(aValeur,aMax),aMin);};;
if(!Date.now){Date.now=function now(){return new Date().getTime();};}
Date.prototype.estAnneeBissextile=function(){return(new Date(this.getFullYear(),1,29).getDate()===29);};(function(){var lToJSON=Date.prototype.toJSON;Date.prototype.toJSON=function(){if(window.IE&&IE.ObjetJSON&&window.EGenreType&&window._ObjetChaine){var lJSON={};lJSON[IE.ObjetJSON.const_champ_Type]=window.EGenreType.Date;lJSON[IE.ObjetJSON.const_champ_Valeur]=window._ObjetChaine.prototype.DateToStr(this);return lJSON;}
else{return lToJSON.call(this);}};}());;
String.prototype.ucfirst=function(){return this.replace(this.charAt(0),this.charAt(0).toUpperCase());};if(!String.prototype.trim){String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,'');};}
String.prototype.ltrim=function(){return this.replace(/^\s+/,"");};String.prototype.rtrim=function(){return this.replace(/\s+$/,"");};String.prototype.AvecQuotes=function(){return'&quot;'+this+'&quot;';};String.prototype.enleverZero=function(){return parseFloat(this.replace(/,/g,".")).toString();};String.prototype.premierCaractereEnHexa=function(){return this.charCodeAt(0).toString(16);};String.prototype.startsWith=function(str){var lMatch=this.match("^"+str);return!!lMatch&&lMatch.length===1&&lMatch[0]===str;};String.prototype.endsWith=function(str){var lMatch=this.match(str+"$");return!!lMatch&&lMatch.length===1&&lMatch[0]===str;};String.prototype.escapeJQ=function(){return this.replace(/(:|\.|\[|\]|\/)/g,'\\$1');};String.prototype.nl2br=function(){return this.replace(/\n/g,"<br />");};;
IE.MethodesObjet={};(function(){IE.MethodesObjet.getObjectClass=function(aObjet){if(aObjet&&aObjet.constructor){return IE.MethodesObjet.getNomClassDeConstructeur(aObjet.constructor);}
return undefined;};IE.MethodesObjet.getNomClassDeConstructeur=function(aConstructeur){if(aConstructeur&&aConstructeur.name) return aConstructeur.name;if(aConstructeur&&aConstructeur.toString&&IE.MethodesObjet.isFunction(aConstructeur)){var T=aConstructeur.toString().match(/function\s*(\w+)/);if(T&&T.length===2){return T[1];}}
return undefined;};function _setPrototypePere(aClasseFille,aClasseMere){aClasseFille.prototype.__pere__=aClasseMere.prototype;}
IE.MethodesObjet.etendreClasse=function(aClasseFille,aClasseMere,aAvecProtoPere){var lProp;if(!aClasseFille.prototype||!aClasseMere.prototype){return;}
for(lProp in aClasseMere.prototype){if(IE.MethodesObjet.isUndefined(aClasseFille.prototype[lProp])){aClasseFille.prototype[lProp]=aClasseMere.prototype[lProp];}}
if(aAvecProtoPere){_setPrototypePere(aClasseFille,aClasseMere);}};IE.MethodesObjet.etendre=function(aDestination,aSource,aExtensionComplete){var lProperty;for(lProperty in aSource){if(aExtensionComplete||MethodesObjet.isUndefined(aDestination[lProperty])){aDestination[lProperty]=aSource[lProperty];}}
return aDestination;};function _dupliquer(aObjet,_aProfondeur,_aDuplicationParesseuse,aProprietaires,aProprietairesCopie){if((!aObjet)||(!IE.MethodesObjet.isObject(aObjet))){return aObjet;}
if(aObjet.dupliquer){return aObjet.dupliquer();}
if(_aProfondeur>1000){;return aObjet;}
var lIndice= -1;if(aProprietaires.length>0){lIndice=IE.MethodesTableau.chercher(aObjet,aProprietaires);}
if(lIndice>=0){return aProprietairesCopie[lIndice];}
var lObjetDuplique,lProp;if(aObjet.join&&IE.MethodesObjet.isArray(aObjet)){lObjetDuplique=new Array(aObjet.length);}
else if(aObjet.setTime&&IE.MethodesObjet.isDate(aObjet)){lObjetDuplique=new Date();lObjetDuplique.setTime(aObjet.getTime());}
else{lObjetDuplique=Object.create(aObjet.constructor.prototype);}
var lProfondeur=_aProfondeur+1;aProprietaires.push(aObjet);aProprietairesCopie.push(lObjetDuplique);try{var lKeys=Object.keys(aObjet),i;for(i=0;i<lKeys.length;i++){lProp=lKeys[i];var lValeur=aObjet[lProp];if(IE.MethodesObjet.isObject(lValeur)){if(_aDuplicationParesseuse&&(_aProfondeur===0)){lObjetDuplique[lProp]=lValeur;}
else{lObjetDuplique[lProp]=_dupliquer(lValeur,lProfondeur,false,aProprietaires,aProprietairesCopie);}}
else{lObjetDuplique[lProp]=lValeur;}}}
finally{aProprietaires.pop();aProprietairesCopie.pop();}
return lObjetDuplique;}
IE.MethodesObjet.dupliquer=function(aObjet,aDuplicationParesseuse){return _dupliquer(aObjet,0,aDuplicationParesseuse,[],[]);};IE.MethodesObjet.toArray=function(aIterable){if(!aIterable){return[];}
if(!aIterable.length){return[];}
var lLength=aIterable.length;var LResult=new Array(lLength),i;for(i=0;i<lLength;i++){LResult[i]=aIterable[i];}
return LResult;};IE.MethodesObjet.isArray=function(object){return Object.prototype.toString.call(object)==="[object Array]";};IE.MethodesObjet.isFunction=function(object){return typeof object==="function";};IE.MethodesObjet.isString=function(object){return Object.prototype.toString.call(object)==="[object String]";};IE.MethodesObjet.isNumber=function(object){return!isNaN(object)&&Object.prototype.toString.call(object)==="[object Number]";};IE.MethodesObjet.isUndefined=function(object){return typeof object==="undefined";};IE.MethodesObjet.isObject=function(object){return!!object&&typeof object==="object";};IE.MethodesObjet.isDate=function(object){return Object.prototype.toString.call(object)==="[object Date]";};IE.MethodesObjet.isNan=function(object){var rdigit=/\d/;return object===null||object===undefined||!rdigit.test(object)||isNaN(object);};IE.MethodesObjet.isWindow=function(object){return!!object&&typeof object==="object"&&"setInterval" in object;};IE.MethodesObjet.get=function(aObjet,aAccesseur){var lObjet,i,lNomProp;if(!aObjet||!aAccesseur||!aAccesseur.length) return aObjet;if(aAccesseur.trim&&aAccesseur.split){aAccesseur=aAccesseur.split('.');}
var lLength=aAccesseur.length;if(lLength===0) return aObjet;lObjet=aObjet;for(i=0;i<lLength-1;i++){lNomProp=aAccesseur[i];lObjet=lObjet[lNomProp];if(!lObjet)
return undefined;}
return lObjet[aAccesseur[aAccesseur.length-1]];};IE.MethodesObjet.set=function(aObjet,aAccesseur,aValue){if(aAccesseur&&aAccesseur.trim&&aAccesseur.split){aAccesseur=aAccesseur.split('.');}
var lConteneur,lNomProp;if(!aAccesseur||!aAccesseur.length){;return false;}
lNomProp=aAccesseur[aAccesseur.length-1];if(aAccesseur.length===1){lConteneur=aObjet;}
else{lConteneur=IE.MethodesObjet.get(aObjet,aAccesseur.slice(0,aAccesseur.length-1));}
if(lConteneur&&lNomProp){lConteneur[lNomProp]=aValue;return true;}
return false;};IE.MethodesObjet.nomProprieteDeValeur=function(aObjet,aValeur){var lKeys=Object.keys(aObjet),i;for(i=0;i<lKeys.length;i++){if(aValeur===aObjet[lKeys[i]]){return lKeys[i];}}
return'';};IE.MethodesObjet.listerProprietes=function(aObjet,aAvecType,aAvecValeur,aAvecUndefined){};IE.MethodesObjet.listerMethodes=function(aObjet,aAvecImplementation){};IE.MethodesObjet.lister=function(aObjet,aAvecTypePropriete,aAvecValeur,aAvecImplementation){return MethodesObjet.listerProprietes(aObjet,aAvecTypePropriete,aAvecValeur,true)+MethodesObjet.listerMethodes(aObjet,aAvecImplementation);};function _indenterEnumere(aEnumere,aParam){var lProp;if(!aParam){aParam={};}
aParam.indice=aParam.indice||0;if(!aEnumere){return;}
for(lProp in aEnumere){if(IE.MethodesObjet.isNumber(aEnumere[lProp])){aEnumere[lProp]=aParam.indice;aParam.indice+=1;}
else if(IE.MethodesObjet.isObject(aEnumere[lProp])){_indenterEnumere(aEnumere[lProp],aParam);}}}
IE.MethodesObjet.indenterEnumere=function(aEnumere,aIndiceInitiale){if(IE.MethodesObjet.isObject(aEnumere)){_indenterEnumere(aEnumere,{indice:aIndiceInitiale});}};function _getNomPile(aNom){return'__inherited_'+aNom+'__';}
function _getProtoPere(aObjet){try{return aObjet.constructor.prototype.__pere__;}
catch(e){return null;}}
function _empilerPrototype(aObjet,aNom,aImplementationMethode){var lProtoPere,lProtoFils;var lNomPile=_getNomPile(aNom);if(aObjet[lNomPile]){lProtoFils=aObjet[lNomPile].proto;lProtoPere=_getProtoPere(aObjet[lNomPile].proto);aObjet[lNomPile].compteur++;aObjet[lNomPile].proto=lProtoPere;}
else{lProtoFils=aObjet.constructor?aObjet.constructor.prototype:null;lProtoPere=_getProtoPere(aObjet);aObjet[lNomPile]={proto:lProtoPere,compteur:0};}
if(aImplementationMethode){while(lProtoFils&&!lProtoFils.hasOwnProperty(aNom)&&_getProtoPere(lProtoPere)){lProtoFils=lProtoPere;aObjet[lNomPile].proto=lProtoPere=_getProtoPere(lProtoPere);}
while(lProtoPere&&!lProtoPere.hasOwnProperty(aNom)){aObjet[lNomPile].proto=lProtoPere=_getProtoPere(lProtoPere);}}
return aObjet[lNomPile].proto;}
function _depilerPrototype(aObjet,aNom){aObjet[_getNomPile(aNom)].compteur--;if(aObjet[_getNomPile(aNom)].compteur<0){delete aObjet[_getNomPile(aNom)];}}
function inheritedCreate(){var lNomPileConstructeur='_constructeur';var lProtoPere=_empilerPrototype(this,lNomPileConstructeur);try{if(lProtoPere&&lProtoPere.constructor){lProtoPere.constructor.apply(this,arguments);}}
finally{_depilerPrototype(this,lNomPileConstructeur);}}
function inherited(aMethode){if(!IE.MethodesObjet.isString(aMethode)){return;}
var lResult;var lProtoPere=_empilerPrototype(this,aMethode,true);try{if(lProtoPere&&lProtoPere[aMethode]){var lArguments=Array.prototype.slice.call(arguments,1);lResult=lProtoPere[aMethode].apply(this,lArguments);}}
finally{_depilerPrototype(this,aMethode);}
return lResult;}
IE.MethodesObjet.heritagePrototype=function(aClasseFille,aClasseMere){IE.MethodesObjet.etendre(aClasseMere.prototype,{inheritedCreate:inheritedCreate,inherited:inherited});function Local(){}
Local.prototype=aClasseMere.prototype;aClasseFille.prototype=new Local();aClasseFille.prototype.constructor=aClasseFille;aClasseMere.prototype.constructor=aClasseMere;aClasseFille.prototype.__pere__=aClasseMere.prototype;};}());var MethodesObjet=IE.MethodesObjet;;
IE.Tri=(function(){var uSupportLocaleCompare=!!''.localeCompare,uSupportCollator=window.Intl&&window.Intl.Collator,uCollator=uSupportCollator?new window.Intl.Collator('fr',{sensitivity:"accent"}):null,uCollatorCaseSensitive=uSupportCollator?new window.Intl.Collator('fr',{sensitivity:"variant"}):null,uRegExSymbolesASupprimer=/\'|-/g;function _construirePilePere(aValeur,aNomChampePere,aPile){var lObjet=aValeur;while(lObjet&&lObjet[aNomChampePere]&&IE.MethodesObjet.isObject(lObjet[aNomChampePere])&&!IE.MethodesTableau.existe(lObjet[aNomChampePere],aPile)){lObjet=lObjet[aNomChampePere];aPile.push(lObjet);}}
function _comparerTriRecursif(A ,B,aTri){var lPileParentA=[A.contenu],lPileParentB=[B.contenu],i,lResult,j,lNb,lTri,lCount,lA,lB;if(!aTri.tris){return false;}
_construirePilePere(A.contenu,aTri.nomChampPere,lPileParentA);_construirePilePere(B.contenu,aTri.nomChampPere,lPileParentB);lPileParentA.reverse();lPileParentB.reverse();lCount=Math.max(lPileParentA.length,lPileParentB.length);for(i=0;i<lCount;i++){lA=lPileParentA[i];lB=lPileParentB[i];if((!lA&&lB)||(!lA&&!lB)){return-aTri.ordreTri;}
else if(lA&&!lB){return aTri.ordreTri;}
else if(lA===lB){continue;}
for(j=0,lNb=aTri.tris.length;j<lNb;j++){lTri=aTri.tris[j];lResult=_comparerTri(lA,lB,lTri,null,false);if(lResult!==false){return lResult;}}}
return false;}
function _getValeurPourTri(aTri,aElement){var lResult;if(aTri.estFonction){lResult=aTri.nomChamp(aElement);}
else{if(!aElement)
return aElement;lResult=aElement[aTri.nomChamp];}
if(lResult){if(lResult.getTime){return lResult.getTime();}
if(lResult.replace){lResult=GChaine.enleverEntites(lResult);if(!uSupportLocaleCompare&&!uSupportCollator&&aTri.avecLatinize)
lResult=GChaine.latinize(lResult);else lResult=lResult.replace(uRegExSymbolesASupprimer,'');}
if(!aTri.caseSensitive&&!uSupportCollator&&lResult&&lResult.toLowerCase){lResult=lResult.toLowerCase();}}
return lResult;}
function _comparerTri(A ,B,aTri,aIndiceTri,aAvecCacheTri){var lChampTriA,lChampTriB;if(aAvecCacheTri){if(!A.cache[aIndiceTri]){lChampTriA=_getValeurPourTri(aTri,A.contenu);A.cache[aIndiceTri]={valeur:lChampTriA};}
else{lChampTriA=A.cache[aIndiceTri].valeur;}
if(!B.cache[aIndiceTri]){lChampTriB=_getValeurPourTri(aTri,B.contenu);B.cache[aIndiceTri]={valeur:lChampTriB};}
else{lChampTriB=B.cache[aIndiceTri].valeur;}}
else{lChampTriA=_getValeurPourTri(aTri,A);lChampTriB=_getValeurPourTri(aTri,B);}
if(lChampTriA===lChampTriB||(lChampTriA===undefined&&lChampTriB===null)||(lChampTriB===undefined&&lChampTriA===null)){return false;}
if((uSupportLocaleCompare||uSupportCollator)&&aTri.avecLatinize&&lChampTriA&&lChampTriB&&lChampTriA.localeCompare&&lChampTriB.localeCompare){var lResult=0;if(uSupportCollator)
lResult=(aTri.caseSensitive?uCollatorCaseSensitive:uCollator).compare(lChampTriA,lChampTriB);else lResult=lChampTriA.localeCompare(lChampTriB,'fr',{sensitivity:(aTri.caseSensitive?"variant":"accent")});if(lResult<0) return-aTri.ordreTri;if(lResult>0) return aTri.ordreTri;return false;}
if(lChampTriA>lChampTriB||lChampTriB===undefined||lChampTriB===null){return aTri.ordreTri;}
if(lChampTriA<lChampTriB||lChampTriA===undefined||lChampTriA===null){return-aTri.ordreTri;}
return false;}
function _comparer(aTris,A ,B){var i,lNb,lTri,lResult;for(i=0,lNb=aTris.length;i<lNb;i++){lTri=aTris[i];if(lTri.triRecursif){lResult=_comparerTriRecursif(A,B,lTri);}
else{lResult=_comparerTri(A,B,lTri,i,true);}
if(lResult!==false){return lResult;}}
return A.ordre-B.ordre;}
return{init:function(aNomChamp,aGenreTri,aCaseSensitive,aSansLatinize){return{estFonction:MethodesObjet.isFunction(aNomChamp),nomChamp:aNomChamp,ordreTri:aGenreTri===EGenreTriElement.Decroissant?-1:1,caseSensitive:aCaseSensitive===true?true:false,avecLatinize:aSansLatinize!==true};},initRecursif:function(aNomChampPere,aTris,aGenreTri){return{triRecursif:true,nomChampPere:aNomChampPere,tris:aTris,ordreTri:aGenreTri===EGenreTriElement.Decroissant?-1:1};},trierTableau:function(aTableau,aTris){if(!aTableau||!aTableau.sort||!aTris||aTableau.length<2){return;}
var lLength=aTableau.length,lTableau=new Array(lLength),i,lValeur;for(i=0;i<lLength;i++){lValeur=aTableau[i];if(lValeur!==undefined||lValeur!==null){lTableau[i]={contenu:lValeur,cache:[],ordre:i};}
else{lTableau[i]=lValeur;}}
lTableau.sort(_comparer.bind(null,aTris));for(i=0;i<lLength;i++){lValeur=lTableau[i];if(lValeur!==undefined||lValeur!==null){aTableau[i]=lValeur.contenu;}
else{aTableau[i]=lValeur;}}}};}());var ObjetTri=IE.Tri;IEClasses.ObjetIndexsUnique=function ObjetIndexsUnique(){this._indexsUnique=[];};(function(){IEClasses.ObjetIndexsUnique.prototype.ajouterIndex=function(aChamps){if(!IE.MethodesObjet.isArray(aChamps)&&!IE.MethodesObjet.isString(aChamps)){;return this;}
if(!this._indexsUnique){this._indexsUnique=[];}
var lChamps=[],i,lChampIndex,lChampIndexCalcul;if(!IE.MethodesObjet.isArray(aChamps)){aChamps=[aChamps];}
for(i=0;i<aChamps.length;i++){lChampIndex=aChamps[i];if(lChampIndex.valeur){lChampIndexCalcul=lChampIndex;}
else{lChampIndexCalcul=IEClasses.ObjetIndexsUnique.ajouterChamp(lChampIndex);}
lChamps.push(lChampIndexCalcul);}
this._indexsUnique.push(lChamps);return this;};IEClasses.ObjetIndexsUnique.ajouterChamp=function(aValeur,aVideEstDoublon,aSensibleCasse){return{valeur:aValeur,videEstDoublon:!!aVideEstDoublon,sensibleCasse:!!aSensibleCasse,estFonction:IE.MethodesObjet.isFunction(aValeur)};};IEClasses.ObjetIndexsUnique.prototype.estDoublon=function(a,b){var i;for(i=0;i<this._indexsUnique.length;i++){if(_estDoublonComparaisonET(this._indexsUnique[i],a,b)){return true;}}
return false;};IEClasses.ObjetIndexsUnique.prototype.estDoublonDansTableau=function(aElement,aTableau){var i;for(i in aTableau){if(this.estDoublon(aElement,aTableau[i])){return true;}}
return false;};IEClasses.ObjetIndexsUnique.prototype.existeIndex=function(){return this._indexsUnique.length>0;};function _estDoublonComparaisonET(aIndexUnique,a,b){var i,lResult=false;for(i=0;i<aIndexUnique.length;i++){if(aIndexUnique[i]){if(_comparateurChampIndex(aIndexUnique[i],a,b)){lResult=true;}
else{return false;}}}
return lResult;}
function _comparateurChampIndex(aChampIndex,a ,b){if(!aChampIndex||!aChampIndex.valeur){return false;}
if(!a||!b){return false;}
var lValeurA,lValeurB;if(aChampIndex.estFonction){lValeurA=aChampIndex.valeur(a);lValeurB=aChampIndex.valeur(b);}
else{lValeurA=a[aChampIndex.valeur];lValeurB=b[aChampIndex.valeur];if(lValeurA&&lValeurB&&lValeurA.getTime&&lValeurB.getTime){lValeurA=lValeurA.getTime();lValeurB=lValeurB.getTime();}}
if(aChampIndex.sensibleCasse!==true){if(lValeurA&&lValeurA.toLowerCase){lValeurA=lValeurA.toLowerCase();}
if(lValeurB&&lValeurB.toLowerCase){lValeurB=lValeurB.toLowerCase();}}
if(lValeurA===lValeurB&&(lValeurA===''||lValeurA===undefined||lValeurA===null)){return!!aChampIndex.videEstDoublon;}
else{return lValeurA===lValeurB;}}}());;
IE.ObjetJSON={};(function(){IE.ObjetJSON.const_champ_Type='_T';IE.ObjetJSON.const_champ_Valeur='V';IE.ObjetJSON.const_champ_Numero='N';IE.ObjetJSON.const_champ_Libelle='L';IE.ObjetJSON.const_champ_Genre='G';IE.ObjetJSON.const_champ_Position='P';IE.ObjetJSON.const_champ_Etat='E';IE.ObjetJSON.const_champ_Actif='A';IE.ObjetJSON.parse=function(data ,aParametres){var lParametres=$.extend({ignorerEntites:false,JSONCollection:null},aParametres);var lJSON=IE.ObjetJSON.parseJSON(data);return IE.ObjetJSON.parseVariables(lJSON,lParametres);};IE.ObjetJSON.parseJSON=function(data){var lJSON;try{lJSON=$.parseJSON(data);}
catch(e){;}
return lJSON;};IE.ObjetJSON.parseVariables=function(aJSON,aParametres){var lJSON;var lParametres=$.extend({ignorerEntites:false,JSONCollection:null},aParametres);try{lJSON=_parseVariables(aJSON,lParametres);}
catch(e){;lJSON={};}
return lJSON;};IE.ObjetJSON.toJSON=function(aObjet,aParametres){var lJSON;try{if(aParametres&&aParametres.ignorerEntites&&!aParametres.JSONCollection){lJSON=aObjet;}
else{lJSON=IE.ObjetJSON.preparerJSON(aObjet,aParametres);}
lJSON=$.toJSON(lJSON);}
catch(e){;}
return lJSON;};IE.ObjetJSON.preparerJSON=function(aObjet,aParametres){var lJSON,lChaine;try{lChaine=$.toJSON(aObjet);lJSON=$.parseJSON(lChaine);if(aParametres&&aParametres.ignorerEntites&&!aParametres.JSONCollection){return lJSON;}
lJSON=_toJSON(lJSON,{ignorerEntites:!!(aParametres&&aParametres.ignorerEntites),JSONCollection:aParametres&&aParametres.JSONCollection?aParametres.JSONCollection:null});}
catch(e){;}
return lJSON;};function _parseElement(aJSON,aParametres){var lElement=new ObjetElement().fromJSON(aJSON),lValeur,lProp;if(aJSON){if(lElement.Libelle){lElement.Libelle=aParametres.ignorerEntites?lElement.Libelle:GChaine.StrToType(lElement.Libelle,EGenreType.String);}
for(lProp in aJSON){if(lProp!==IE.ObjetJSON.const_champ_Libelle&&lProp!==IE.ObjetJSON.const_champ_Numero&&lProp!==IE.ObjetJSON.const_champ_Genre&&lProp!==IE.ObjetJSON.const_champ_Position&&lProp!==IE.ObjetJSON.const_champ_Actif){lValeur=aJSON[lProp];if(!_parseVariablesDeSource(lElement,lProp,lValeur,aParametres)){lElement[lProp]=lValeur;}}}}
return lElement;}
function _parseVariable(aJSON,aParametres){if(!aJSON){return null;}
var lType=aJSON[IE.ObjetJSON.const_champ_Type],lValeur=aJSON[IE.ObjetJSON.const_champ_Valeur],i,lNb;switch(lType){case EGenreType.Element:if(MethodesObjet.isArray(lValeur)){var lListeElements=new ObjetListeElements();if(lValeur&&lValeur.length){for(i=0,lNb=lValeur.length;i<lNb;i++){var lElement=_parseElement(lValeur[i],aParametres);lListeElements.AddElement(lElement);}}
return lListeElements;}
return _parseElement(lValeur,aParametres);case EGenreType.FichierBase64:if(aParametres&&aParametres.JSONCollection&&aParametres.JSONCollection.fichiers&&aParametres.JSONCollection.fichiers){var lFichierBase64=aParametres.JSONCollection.fichiers[lValeur];aParametres.JSONCollection.fichiers[lValeur]=null;return lFichierBase64;}
;return'';default:return GChaine.StrToType(lValeur,lType);}}
function _estVariable(aJSON){if(aJSON&&aJSON[IE.ObjetJSON.const_champ_Type]&&aJSON[IE.ObjetJSON.const_champ_Valeur]!==undefined&&aJSON[IE.ObjetJSON.const_champ_Type]>=0){var i;for(i in aJSON){if(i!==IE.ObjetJSON.const_champ_Type&&i!==IE.ObjetJSON.const_champ_Valeur){return false;}}
return true;}
return false;}
function _estObjet(aValeur){return aValeur&&!aValeur.trim&&typeof aValeur==='object';}
function _parseVariablesDeSource(aObjetResultat,aNomProprieteSource,aValeurSource,aParametres){var lEstVariable,lResult=true;if(MethodesObjet.isString(aValeurSource)){aObjetResultat[aNomProprieteSource]=aParametres.ignorerEntites?aValeurSource:GChaine.StrToType(aValeurSource,EGenreType.String);}
else if(_estObjet(aValeurSource)){lEstVariable=false;if(!aValeurSource.pop){lEstVariable=_estVariable(aValeurSource);}
aObjetResultat[aNomProprieteSource]=lEstVariable?_parseVariable(aValeurSource,aParametres):_parseVariables(aValeurSource,aParametres);}
else{lResult=false;}
return lResult;}
function _parseVariables(aJSON,aParametres){if(!aJSON){return aJSON;}
var i;for(i in aJSON){_parseVariablesDeSource(aJSON,i,aJSON[i],aParametres);}
return aJSON;}
function _preparerVariableToJSON(aJSON,aParametres){if(!aJSON){return aJSON;}
var lType=aJSON[IE.ObjetJSON.const_champ_Type];switch(lType){case EGenreType.FichierBase64:if(aParametres&&aParametres.JSONCollection){if(!aParametres.JSONCollection.fichiers){aParametres.JSONCollection.fichiers=[];}
aParametres.JSONCollection.fichiers.push(aJSON[IE.ObjetJSON.const_champ_Valeur]);aJSON[IE.ObjetJSON.const_champ_Valeur]=aParametres.JSONCollection.fichiers.length-1;return aJSON;}
;return aJSON;default:return aJSON;}}
function _toJSON(aJSON,aParametres){if(!aJSON){return aJSON;}
var i,lValeur;for(i in aJSON){lValeur=aJSON[i];if(lValeur){if(!!lValeur.trim&&IE.MethodesObjet.isString(lValeur)){if(!aParametres.ignorerEntites){aJSON[i]=GChaine.TypeToStr(lValeur,EGenreType.String);}}
else if(_estVariable(lValeur)){aJSON[i]=_preparerVariableToJSON(lValeur,aParametres);}
else if(lValeur!==true&&!lValeur.MAX_VALUE&&!lValeur.getDate&&typeof lValeur==='object'){aJSON[i]=_toJSON(lValeur,aParametres);}}}
return aJSON;}}());;
var EGenreTriElement={Croissant:1,Decroissant:-1};var EGenreEtat={Aucun:0,Creation:1,Modification:2,Suppression:3,FilsModification:4};function ObjetListeElements(){this.vider();}
ObjetListeElements.prototype.vider=function(){this.ListeElements=[];};ObjetListeElements.prototype.AddElement=function(AElement,I){if(I===null||I===undefined){this.ListeElements.push(AElement);}
else{this.ListeElements[I]=AElement;}};ObjetListeElements.prototype.insererElement=function(AElement,I){MethodesTableau.insererElement(AElement,this.ListeElements,I);};ObjetListeElements.prototype.DelElement=function(){this.ListeElements.pop();};ObjetListeElements.prototype.remove=function(aIndice){MethodesTableau.supprimerElement(this.ListeElements,aIndice);return this;};ObjetListeElements.prototype.GetNbrElements=function(){return this.ListeElements.length;};ObjetListeElements.prototype.GetNbrElementsExistes=function(aGenre){var N=0,I;for(I=0;I<this.ListeElements.length;I++){if(this.Existe(I)&&(aGenre===null||aGenre===undefined||this.GetElement(I).Genre===aGenre)){N++;}}
return N;};ObjetListeElements.prototype.GetListeElements=function(){return this.ListeElements;};ObjetListeElements.prototype.parcourir=function(aFunction){if(!aFunction){return this;}
var I,N;for(I=0,N=this.GetNbrElements();I<N;I++){if(aFunction(this.GetElement(I),I,this)===false){return this;}}
return this;};ObjetListeElements.prototype.getTableauLibelles=function(aGenre,aTrier,aAvecExiste){var T=[],I;if(aTrier){this.trier();}
for(I=0;I<this.ListeElements.length;I++){if((aGenre===null||aGenre===undefined)||($.isNumeric(aGenre)&&aGenre===this.GetGenre(I))||($.isArray(aGenre)&&$.inArray(this.GetGenre(I),aGenre)>-1)){if(!aAvecExiste||this.Existe(I)){T.push(this.GetLibelle(I));}}}
return T;};ObjetListeElements.prototype.getTableauNumeros=function(){var T=[],I;for(I=0;I<this.ListeElements.length;I++){T.push(this.GetNumero(I));}
return T;};ObjetListeElements.prototype.getTableauGenres=function(){var T=[],I;for(I=0;I<this.ListeElements.length;I++){T.push(this.GetGenre(I));}
return T;};ObjetListeElements.prototype.getCle=function(){return this.getTableauNumeros().sort().join('_');};ObjetListeElements.prototype.GetElement=function(I){return this.ListeElements[I];};ObjetListeElements.prototype.getListeElements=function(aFiltre){var lListe=new ObjetListeElements(),I;for(I=0;I<this.ListeElements.length;I++){if(!aFiltre||aFiltre(this.ListeElements[I],I)){lListe.AddElement(this.ListeElements[I]);}}
return lListe;};ObjetListeElements.prototype.getIndiceElementParFiltre=function(aFiltre){var lResult= -1,I;for(I=0;I<this.ListeElements.length&&lResult<0;I++){if(!aFiltre||aFiltre(this.ListeElements[I])){lResult=I;}}
return lResult;};ObjetListeElements.prototype.GetElementParNumero=function(ANumero){var I,lNb;for(I=0,lNb=this.GetNbrElements();I<lNb;I++){if(this.Existe(I)&&(this.GetNumero(I)===ANumero)){return this.GetElement(I);}}};ObjetListeElements.prototype.GetElementParGenre=function(aGenre){var I,lNb;for(I=0,lNb=this.GetNbrElements();I<lNb;I++){if(this.Existe(I)&&(this.GetGenre(I)===aGenre)){return this.GetElement(I);}}};ObjetListeElements.prototype.GetNumero=function(I){return this.ListeElements[I].Numero;};ObjetListeElements.prototype.GetGenre=function(I){return this.ListeElements[I].Genre;};ObjetListeElements.prototype.GetLibelle=function(I){return this.ListeElements[I].Libelle;};ObjetListeElements.prototype.GetActif=function(I){return this.ListeElements[I].Actif;};ObjetListeElements.prototype.GetPosition=function(I){return this.ListeElements[I].Position;};ObjetListeElements.prototype.existeNumero=function(I){var N=this.GetNumero(I);return N&&(N!=='0')?true:false;};ObjetListeElements.prototype.Existe=function(I){return this.ListeElements[I].Existe();};ObjetListeElements.prototype.PourValidation=function(I){return this.ListeElements[I].PourValidation();};ObjetListeElements.prototype.SetLibelle=function(I,ALibelle){this.ListeElements[I].Libelle=ALibelle;};ObjetListeElements.prototype.TrierPourValidation=function(){ObjetTri.trierTableau(this.ListeElements,[ObjetTri.init('Etat')]);};ObjetListeElements.prototype.existeElementPourValidation=function(){var I,lNb;for(I=0,lNb=this.GetNbrElements();I<lNb;I++){if(this.PourValidation(I)){return true;}}
return false;};ObjetListeElements.prototype.setTri=function(aTableauTris){this._tris=aTableauTris;};ObjetListeElements.prototype.getTri=function(){return this._tris;};ObjetListeElements.prototype.trier=function(aGenreTri){if(this.ListeElements){aGenreTri=aGenreTri===null||aGenreTri===undefined?EGenreTriElement.Croissant:aGenreTri;if(!this._tris){this.setTri([ObjetTri.init('Position'),ObjetTri.init('Libelle')]);}
var lTris=[].concat(this._tris);lTris.unshift(ObjetTri.init(function(aElement){return(aElement.Visible===false)||(aElement.Etat===EGenreEtat.Suppression);},aGenreTri));IE.Tri.trierTableau(this.ListeElements,lTris);if(aGenreTri===EGenreTriElement.Decroissant){this.ListeElements.reverse();}}};ObjetListeElements.prototype.Trier=function(AGenreTri){var lGenreTri=AGenreTri===null||AGenreTri===undefined?EGenreTriElement.Croissant:AGenreTri;function Comparer(aGenreTri,A,B){return A.TriComplet>=B.TriComplet?aGenreTri:-1*aGenreTri;}
var I;if(this.ListeElements){for(I=0;I<this.GetNbrElements();I++){var LElement=this.GetElement(I);if(LElement.Tri===null||LElement.Tri===undefined){if((LElement.Position!==null&&LElement.Position!==undefined)){LElement.AddTri(LElement.Position);}
else if(LElement.Libelle){LElement.AddTri(LElement.Libelle);}}
LElement.TriComplet=((LElement.Visible===false)||(LElement.Etat===EGenreEtat.Suppression)?1:0)+'_'+LElement.Tri;}
this.ListeElements.sort(Comparer.bind(this,lGenreTri));}};ObjetListeElements.prototype.GetIndiceParNumeroEtGenre=function(ANumero,AGenre,aAvecExiste){if(this.ListeElements&&(((ANumero!==null&&ANumero!==undefined))||((AGenre!==null&&AGenre!==undefined)))){var N=this.GetNbrElements(),I;for(I=0;I<N;I++){if((!aAvecExiste||this.Existe(I))&&((ANumero===null||ANumero===undefined)||(this.GetNumero(I)===ANumero))&&((AGenre===null||AGenre===undefined)||(this.GetGenre(I)===AGenre))){return I;}}}};ObjetListeElements.prototype.GetIndiceExisteParNumeroEtGenre=function(ANumero,AGenre){if(this.ListeElements&&(((ANumero!==null&&ANumero!==undefined))||((AGenre!==null&&AGenre!==undefined)))){var N=this.GetNbrElements(),J= -1,I;for(I=0;I<N;I++){if(this.Existe(I)){J++;if(((ANumero===null||ANumero===undefined)||(this.GetNumero(I)===ANumero))&&((AGenre===null||AGenre===undefined)||(this.GetGenre(I)===AGenre))){return J;}}}}};ObjetListeElements.prototype.GetElementParNumeroEtGenre=function(ANumero,AGenre,aAvecExiste){return this.GetElement(this.GetIndiceParNumeroEtGenre(ANumero,AGenre,aAvecExiste));};ObjetListeElements.prototype.GetIndiceParElement=function(aElement,aAvecExiste){return aElement?this.GetIndiceParNumeroEtGenre(aElement.GetNumero(),aElement.GetGenre(),aAvecExiste):null;};ObjetListeElements.prototype.GetIndiceExisteParElement=function(aElement){return this.GetIndiceExisteParNumeroEtGenre(aElement.GetNumero(),aElement.GetGenre());};ObjetListeElements.prototype.GetElementParElement=function(aElement,aAvecExiste){return this.GetElement(this.GetIndiceParElement(aElement,aAvecExiste));};ObjetListeElements.prototype.getIndiceParTri=function(aTri){if(this.ListeElements){var I,N=this.GetNbrElements();for(I=0;I<N;I++){if(this.GetElement(I).Tri===aTri){return I;}}}};ObjetListeElements.prototype.GetIndiceParLibelle=function(ALibelle){if(this.ListeElements){var I,N=this.GetNbrElements();for(I=0;I<N;I++){if(this.GetLibelle(I)===ALibelle){return I;}}}};ObjetListeElements.prototype.GetIndiceParParsingLibelle=function(aLibelle){if(!this.ListeElements){return-1;}
if(aLibelle.length===0){return 0;}
var I,N,lIndice=0;for(I=0,N=this.GetNbrElements();I<N;I++){var lLibelle=this.GetLibelle(I);if(lLibelle.toUpperCase()<aLibelle.toUpperCase()){lIndice++;}
else{break;}}
return lIndice>=N?lIndice-1:lIndice;};ObjetListeElements.prototype.GetElementParLibelle=function(ALibelle){return this.GetElement(this.GetIndiceParLibelle(ALibelle));};ObjetListeElements.prototype.GetPremierElement=function(){var i,lNb,lResult=null;for(i=0,lNb=this.GetNbrElements();i<lNb&&!lResult;i++){if(this.Existe(i)){lResult=this.GetElement(i);}}
return lResult;};ObjetListeElements.prototype.FusionnerListe=function(AListeElements,APere,AFaireCeQuIlFaut){if(AListeElements){var I,LNbrElts=AListeElements.GetNbrElements();for(I=0;I<LNbrElts;I++){var LRetour=true;if(APere&&AFaireCeQuIlFaut){LRetour=AFaireCeQuIlFaut.call(APere,AListeElements.GetElement(I));}
if(LRetour){this.AddElement(AListeElements.GetElement(I));}}}
return this;};ObjetListeElements.prototype.setSerialisateurJSON=function(aSerialisateur){this.serialisateurJSON={ignorerEtatsElements:false,methodeSerialisation:null,nePasTrierPourValidation:false};$.extend(this.serialisateurJSON,aSerialisateur);return this;};ObjetListeElements.prototype.toJSON=function(){var I,lNb,lElement,lJSONElement,lGarderElement,lExisteElement,lAvecSerialisation=this.serialisateurJSON&&this.serialisateurJSON.methodeSerialisation,lResult=[],lListe=new ObjetListeElements();lListe.FusionnerListe(this);if(!this.serialisateurJSON||!this.serialisateurJSON.nePasTrierPourValidation){lListe.TrierPourValidation();}
for(I=0,lNb=lListe.GetNbrElements();I<lNb;I++){lElement=lListe.GetElement(I);if(lElement){lExisteElement=(this.serialisateurJSON&&this.serialisateurJSON.ignorerEtatsElements)||lElement.PourValidation();lJSONElement=null;if(lExisteElement||lAvecSerialisation){lJSONElement=lElement.toJSON();if(lAvecSerialisation){lGarderElement=this.serialisateurJSON.methodeSerialisation(lElement,lJSONElement,I);lExisteElement=lGarderElement===null||lGarderElement===undefined?lExisteElement:lGarderElement;}}
if(lExisteElement&&lJSONElement){lResult.push(lJSONElement);}}}
return lResult;};ObjetListeElements.prototype.fromJSON=function(aJSON,aMethodeDeserialisation,aTrier){if(!aJSON||!MethodesObjet.isArray(aJSON)){return this;}
var i,lNb;for(i=0,lNb=aJSON.length;i<lNb;i++){var lElement=new ObjetElement().fromJSON(aJSON[i]);if(!aMethodeDeserialisation||(aMethodeDeserialisation(aJSON[i],lElement,i)!==false)){this.AddElement(lElement);}}
if(aTrier){this.trier();}
return this;};function ObjetElement(ALibelle,ANumero,AGenre,APosition,AActif){this.Libelle=ALibelle;this.Numero=ANumero;this.Genre=AGenre;this.Position=APosition;this.Actif=AActif===null||AActif===undefined?true:AActif;this.Etat=EGenreEtat.Aucun;}(function(){var _numeroCreation= -1000;ObjetElement.getNumeroCreation=function(){_numeroCreation+= -1;return _numeroCreation;};ObjetElement.prototype.toJSON=function(){var lNumero=this.GetNumero(),lGenre=this.GetGenre(),lLibelle=this.GetLibelle();var lJSON={};lJSON[IE.ObjetJSON.const_champ_Numero]=lNumero;if(lGenre!==undefined&&lGenre!==null){lJSON[IE.ObjetJSON.const_champ_Genre]=lGenre;}
if(lLibelle){lJSON[IE.ObjetJSON.const_champ_Libelle]=lLibelle;}
if(this.Etat){lJSON[IE.ObjetJSON.const_champ_Etat]=this.Etat;}
return lJSON;};ObjetElement.prototype.fromJSON=function(aJSON){if(!aJSON){return this;}
this.Libelle=aJSON[IE.ObjetJSON.const_champ_Libelle]||'';this.Numero=aJSON[IE.ObjetJSON.const_champ_Numero]==='0'?0:aJSON[IE.ObjetJSON.const_champ_Numero];this.Genre=aJSON[IE.ObjetJSON.const_champ_Genre];this.Position=aJSON[IE.ObjetJSON.const_champ_Position];if(aJSON[IE.ObjetJSON.const_champ_Actif]!==undefined){this.Actif=aJSON[IE.ObjetJSON.const_champ_Actif];}
return this;};ObjetElement.prototype.copieJSON=function(aJSON){var lProp;for(lProp in aJSON){if(lProp!==IE.ObjetJSON.const_champ_Libelle&&lProp!==IE.ObjetJSON.const_champ_Numero&&lProp!==IE.ObjetJSON.const_champ_Genre&&lProp!==IE.ObjetJSON.const_champ_Position)
this[lProp]=aJSON[lProp];}
return this;};ObjetElement.prototype.copieToJSON=function(){var lProp;var lJson={};for(lProp in this){if(!$.isFunction(this[lProp])&&lProp!=='Libelle'&&lProp!=='Numero'&&lProp!=='Genre'&&lProp!=='Position'&&lProp!=='Etat')
lJson[lProp]=this[lProp];}
return lJson;};ObjetElement.prototype.GetLibelle=function(){return this.Libelle;};ObjetElement.prototype.GetNumero=function(){return this.Numero;};ObjetElement.prototype.GetGenre=function(){return this.Genre;};ObjetElement.prototype.GetActif=function(){return this.Actif;};ObjetElement.prototype.GetPosition=function(){return this.Position;};ObjetElement.prototype.getDonnees=function(){return this.donnees;};ObjetElement.prototype.existeNumero=function(I){var N=this.GetNumero();return N&&(N!=='0')?true:false;};ObjetElement.prototype.Existe=function(){return this.Etat!==EGenreEtat.Suppression;};ObjetElement.prototype.PourValidation=function(){return this._validationSaisie||false;};ObjetElement.prototype.SetLibelle=function(aLibelle){this.Libelle=aLibelle;};ObjetElement.prototype.SetNumero=function(aNumero){this.Numero=aNumero;};ObjetElement.prototype.SetActif=function(aActif){this.Actif=aActif;};ObjetElement.prototype.setDonnees=function(aDonnees){this.donnees=aDonnees;};ObjetElement.prototype.ResetTri=function(){this.Tri=null;};ObjetElement.prototype.AddTri=function(ATri,AType){if(this.Tri===null||this.Tri===undefined){this.Tri='';}
this.Tri+=GChaine.FormatPourTri(ATri,AType)+'   ';};ObjetElement.prototype.getCle=function(){return'_'+this.Genre+'_'+this.Numero;};ObjetElement.prototype.SetEtat=function(AEtat){switch(AEtat){case EGenreEtat.Aucun:delete this._validationSaisie;this.Etat=EGenreEtat.Aucun;break;case EGenreEtat.Creation:if(this.Etat===EGenreEtat.Aucun){this._validationSaisie=true;this.Etat=EGenreEtat.Creation;if(this.Numero===null||this.Numero===undefined){this.Numero=ObjetElement.getNumeroCreation();}}
break;case EGenreEtat.Modification:if((this.Etat===EGenreEtat.Aucun)||(this.Etat===EGenreEtat.FilsModification)){this._validationSaisie=true;this.Etat=(this.Numero!==0)&&((this.Numero!==null&&this.Numero!==undefined))?EGenreEtat.Modification:EGenreEtat.Creation;if(this.Numero===null||this.Numero===undefined){this.Numero=ObjetElement.getNumeroCreation();}}
break;case EGenreEtat.Suppression:if(this.Etat===EGenreEtat.Creation){delete this._validationSaisie;}
else{this._validationSaisie=true;}
this.Etat=EGenreEtat.Suppression;break;case EGenreEtat.FilsModification:if(this.Etat===EGenreEtat.Aucun){this._validationSaisie=true;this.Etat=EGenreEtat.FilsModification;}
break;}};ObjetElement.prototype.afficher=function(){};}());;
function XmlDocument(ANom){try{var LDocument;if(document.implementation&&document.implementation.createDocument)
LDocument=document.implementation.createDocument('',ANom?ANom:'',null);if(window.ActiveXObject)
LDocument=new ActiveXObject('Microsoft.XmlDom');if(ANom&&(LDocument.childNodes.length===0))
LDocument.appendChild(LDocument.createElement(ANom));return LDocument;} catch(e){throw new Error('XmlDocument> '+ANom+', '+e);}}
function ObjetXML(ANom,S){this.Xml=new XmlDocument(ANom);if(S)
this.Xml.loadXML(S);this.Racine=this.Xml.documentElement;this.Noeuds=[];}
ObjetXML.prototype.GetRacine=function(){return this.Racine;};ObjetXML.prototype.GetNomRacine=function(){return this.GetRacine().nodeName;};ObjetXML.prototype.Parcourir=function(ANoeud,ANom,APere,AFaireCeQuIlFaut,ARecursif,AParametre,P){P=P||0;ANoeud=ANoeud||this.Racine;var R=false,I,J=0,N=ANoeud.childNodes.length;for(I=0;(I<N)&&!R;I++){var LNoeud=this.Noeud=ANoeud.childNodes[I];if(((ANom==='')||(this.Noeud.nodeName===ANom))){this.Noeuds.push(this.Noeud);if(AFaireCeQuIlFaut){if(ARecursif)
R=AFaireCeQuIlFaut.call(APere,this,this.Noeud,J,AParametre,this.Noeuds.length-1,this.Noeuds);else R=AFaireCeQuIlFaut.call(APere,this,this.Noeud,J++,AParametre,P);}
this.Noeud=LNoeud;if(ARecursif&&!R&&this.EstUneCategorie(this.Noeud))
R=this.Parcourir(this.Noeud,ANom,APere,AFaireCeQuIlFaut,ARecursif,AParametre,P+1);this.Noeuds.pop();}}
return R;};ObjetXML.prototype.listeFils=function(ANoeud,ANom){var lNoeuds=[];ANoeud=ANoeud===null||ANoeud===undefined?this.Racine:ANoeud;for(var I=0;I<ANoeud.childNodes.length;I++)
if(((ANom==='')||(ANoeud.childNodes[I].nodeName===ANom)))
lNoeuds.push(ANoeud.childNodes[I]);return lNoeuds;};ObjetXML.prototype.ToString=function(){return this.Xml.xml;};ObjetXML.prototype.DetruireCategorie=function(ACategorie,ANoeud){ACategorie=ACategorie===null||ACategorie===undefined?this.Racine:ACategorie;ACategorie.removeChild(ANoeud);};ObjetXML.prototype.CreerCategorie=function(ANoeud,ANom,AGenre,ANumero,ALibelle,AEtat,aActif){ANoeud=ANoeud===null||ANoeud===undefined?this.Racine:ANoeud;var C=ANoeud.ownerDocument.createElement(ANom);this.SetGenre(C,AGenre);this.SetNumero(C,ANumero);this.SetLibelle(C,ALibelle);this.SetEtat(C,AEtat);this.setActif(C,aActif);ANoeud.appendChild(C);return C;};ObjetXML.prototype.CreerElement=function(ANoeud,ANom,AElement,APere,AFaireCeQuIlFaut){if(AElement){var LNoeud=this.CreerCategorie(ANoeud,ANom,AElement.GetGenre(),AElement.GetNumero(),AElement.GetLibelle(),AElement.Etat,AElement.GetActif());if(APere&&AFaireCeQuIlFaut)
AFaireCeQuIlFaut.call(APere,this,LNoeud,AElement);return LNoeud;}};ObjetXML.prototype.CreerListeElements=function(ANoeud,ANomListe,ANom,AListeElements,APere,AFaireCeQuIlFaut,aTrierPourValidation){var LExisteListe=false;var LNoeudListe=ANomListe===''?ANoeud:this.CreerCategorie(ANoeud,ANomListe);var lListeAvantTri=null;if(AListeElements){if(aTrierPourValidation||(aTrierPourValidation===null||aTrierPourValidation===undefined)){lListeAvantTri=new ObjetListeElements();lListeAvantTri.FusionnerListe(AListeElements);AListeElements.TrierPourValidation();}
for(var I=0;I<AListeElements.GetNbrElements();I++)
if(AListeElements.GetElement(I)){var LExisteElement=AListeElements.PourValidation(I);var LNoeudELement=null;if(LExisteElement||(APere&&AFaireCeQuIlFaut)){var LElement=AListeElements.GetElement(I);LNoeudELement=this.CreerElement(LNoeudListe,ANom,LElement);if(APere&&AFaireCeQuIlFaut){var lGarderElement=AFaireCeQuIlFaut.call(APere,this,LNoeudELement,LElement,I);LExisteElement=lGarderElement===null||lGarderElement===undefined?LExisteElement:lGarderElement;}}
if(!LExisteElement&&LNoeudELement)
this.DetruireCategorie(LNoeudListe,LNoeudELement);if(LExisteElement)
LExisteListe=true;}}
if(!LExisteListe&&ANomListe!=='')
this.DetruireCategorie(ANoeud,LNoeudListe);if(lListeAvantTri)
AListeElements.ListeElements=lListeAvantTri.ListeElements;return LExisteListe;};ObjetXML.prototype.nePasControlerEtat=function(){return true;};ObjetXML.prototype.ajouterSiExiste=function(aXml,aNoeud,aElement){return aElement.Existe();};ObjetXML.prototype.ajouterSiEtatAucun=function(aXml,aNoeud,aElement){return aElement.Etat===EGenreEtat.Aucun;};ObjetXML.prototype.CreerVariable=function(ANoeud,ANom,AType,AValeur,AIndice){ANoeud=ANoeud===null||ANoeud===undefined?this.Racine:ANoeud;var C=ANoeud.ownerDocument.createElement(ANom);this.SetIndice(C,AIndice);var V=ANoeud.ownerDocument.createTextNode(GChaine.TypeToStr(AValeur,AType));C.appendChild(V);ANoeud.appendChild(C);this.SetType(C,AType);return C;};ObjetXML.prototype.GetCategorieParGenre=function(ANoeud,ANom,AGenre,ARecursif){this.Nom=ANom;this.Genre=AGenre;return this.Parcourir(ANoeud,'',this,this.EstCategorieParGenre,ARecursif)?this.Noeud:null;};ObjetXML.prototype.EstCategorieParGenre=function(AXml,ANoeud){return(ANoeud.nodeName===this.Nom)&&(ANoeud.getAttribute('G')===this.Genre);};ObjetXML.prototype.GetCategorieParNumero=function(ANoeud,ANom,ANumero,ARecursif){this.Nom=ANom;this.Numero=ANumero;return this.Parcourir(ANoeud,ANom,this,this.EstCategorieParNumero,ARecursif)?this.Noeud:null;};ObjetXML.prototype.EstCategorieParNumero=function(AXml,ANoeud){return(ANoeud.nodeName===this.Nom)&&(ANoeud.getAttribute('N')===this.Numero);};ObjetXML.prototype.NoeudExiste=function(){return true;};ObjetXML.prototype.Existe=function(ANoeud,ANom,ARecursif){return this.Parcourir(ANoeud,ANom,this,this.NoeudExiste,ARecursif);};ObjetXML.prototype.AjouterCategorie=function(AXml,ANoeud){this.Resultat.push(ANoeud);};ObjetXML.prototype.GetCategorie=function(ANoeud,ANom,I,ARecursif){return this.GetListeCategories(ANoeud,ANom,ARecursif)[I===null||I===undefined?0:I];};ObjetXML.prototype.GetListeCategories=function(ANoeud,ANom,ARecursif){if((ANom===null||ANom===undefined)||(ANom===''))
return new Array(ANoeud);ARecursif=ARecursif===null||ARecursif===undefined?false:ARecursif;ANoeud=ANoeud===null||ANoeud===undefined?this.Racine:ANoeud;if(ARecursif)
this.Resultat=ANoeud.getElementsByTagName(ANom);else{this.Resultat=[];this.Parcourir(ANoeud,ANom,this,this.AjouterCategorie);}
return this.Resultat;};ObjetXML.prototype._ajouterElement=function(aListeElements,aFaireCeQuIlFaut,AXml,ANoeud){var lElement=this.GetElement(ANoeud);if(aFaireCeQuIlFaut)
aFaireCeQuIlFaut(this,ANoeud,lElement);aListeElements.AddElement(lElement);};ObjetXML.prototype.GetElement=function(ANoeud,ANom,aFaireCeQuIlFaut){var lElement=new ObjetElement(this.GetLibelle(ANoeud,ANom),this.GetNumero(ANoeud,ANom),this.GetGenre(ANoeud,ANom),this.GetPosition(ANoeud,ANom),this.GetActif(ANoeud,ANom));var lDonnees=this.getDonnees(ANoeud,ANom);if(lDonnees)
lElement.setDonnees(lDonnees);if(aFaireCeQuIlFaut)
aFaireCeQuIlFaut(this,ANoeud,lElement);return lElement;};ObjetXML.prototype.GetListeElements=function(ANoeud,ANom,AAvecTri,aFaireCeQuIlFaut){var lListe=new ObjetListeElements();this.Parcourir(ANoeud,ANom,this,this._ajouterElement.bind(this,lListe,aFaireCeQuIlFaut));if(AAvecTri)
lListe.Trier();return lListe;};ObjetXML.prototype.GetVariable=function(ANoeud,ANom,AValeurParDefaut){var V=this.GetListeVariables(ANoeud,ANom)[0];return V===null||V===undefined?!AValeurParDefaut?false:AValeurParDefaut:V;};ObjetXML.prototype.GetListeVariables=function(ANoeud,ANom){var C=this.GetListeCategories(ANoeud,ANom);this.Resultat=[];for(var I=0;I<C.length;I++)
try{this.Resultat.push(GChaine.StrToType(C[I].firstChild?(C[I].textContent?C[I].textContent:C[I].firstChild.nodeValue):'',parseInt(C[I].getAttribute('T'))));}
catch(e){}
return this.Resultat;};ObjetXML.prototype.GetTypeAttribut=function(AAttribut){switch(AAttribut){case'L':case'D':case'N':return EGenreType.String;case'A':return EGenreType.Cardinal;default:return EGenreType.Cardinal;}};ObjetXML.prototype.GetAttribut=function(ANoeud,ANom,ARecursif,AAttribut){try{var lCategorie=this.GetCategorie(ANoeud,ANom,ARecursif);var lAttribut=lCategorie?lCategorie.getAttribute(AAttribut):null;return lAttribut?AAttribut==='D'?lAttribut:GChaine.StrToType(lAttribut,this.GetTypeAttribut(AAttribut)):null;}
catch(e){return null;}};ObjetXML.prototype.SetGenre=function(ACategorie,AGenre){if(ACategorie&&((AGenre!==null&&AGenre!==undefined)))
ACategorie.setAttribute('G',AGenre);};ObjetXML.prototype.GetGenre=function(ANoeud,ANom,ARecursif){return this.GetAttribut(ANoeud,ANom,ARecursif,'G');};ObjetXML.prototype.SetNumero=function(ACategorie,ANumero){if(ACategorie&&((ANumero!==null&&ANumero!==undefined)))
ACategorie.setAttribute('N',ANumero);};ObjetXML.prototype.GetNumero=function(ANoeud,ANom,ARecursif){var N=this.GetAttribut(ANoeud,ANom,ARecursif,'N');return N==='0'?0:N;};ObjetXML.prototype.SetLibelle=function(ACategorie,ALibelle){if(ACategorie&&((ALibelle!==null&&ALibelle!==undefined)))
ACategorie.setAttribute('L',GChaine.enleverEntites(ALibelle));};ObjetXML.prototype.GetLibelle=function(ANoeud,ANom,ARecursif){var LAttribut=this.GetAttribut(ANoeud,ANom,ARecursif,'L');return LAttribut?LAttribut:'';};ObjetXML.prototype.getDonnees=function(ANoeud,ANom,ARecursif){var LAttribut=this.GetAttribut(ANoeud,ANom,ARecursif,'D');return LAttribut?LAttribut:'';};ObjetXML.prototype.SetPosition=function(ACategorie,APosition){if(ACategorie&&((APosition!==null&&APosition!==undefined)))
ACategorie.setAttribute('P',APosition);};ObjetXML.prototype.GetPosition=function(ANoeud,ANom,ARecursif){return this.GetAttribut(ANoeud,ANom,ARecursif,'P');};ObjetXML.prototype.GetActif=function(ANoeud,ANom,ARecursif){var lAttribut=this.GetAttribut(ANoeud,ANom,ARecursif,'A');return(lAttribut===null||lAttribut===undefined)||(lAttribut===0);};ObjetXML.prototype.setActif=function(aNoeud,aActif){if(aNoeud&&((aActif!==null&&aActif!==undefined))&&!aActif)
aNoeud.setAttribute('A',aActif?'1':'0');};ObjetXML.prototype.SetEtat=function(ACategorie,AEtat){if(ACategorie&&((AEtat!==null&&AEtat!==undefined)))
ACategorie.setAttribute('E',AEtat);};ObjetXML.prototype.SetType=function(ANoeud,AAttribut){if(ANoeud&&AAttribut)
ANoeud.setAttribute('T',AAttribut);};ObjetXML.prototype.SetIndice=function(ACategorie,AIndice){if(ACategorie&&((AIndice!==null&&AIndice!==undefined)))
ACategorie.setAttribute('I',AIndice);};ObjetXML.prototype.EstUneCategorie=function(ANoeud){return!ANoeud.getAttribute('T');};ObjetXML.prototype.GetNombre=function(ACategorie){try{return ACategorie.length;}
catch(e){return ACategorie?1:0;}};ObjetXML.prototype.GetListeDonnees=function(ANoeud,ANom,ARecursif,AFonction){var T=[];this.GetListeCategories(ANoeud,ANom,ARecursif);var N=this.Resultat.length;for(var I=0;I<N;I++)
T.push(AFonction.call(this,this.Resultat[I]));return T;};ObjetXML.prototype.GetListeNumeros=function(ANoeud,ANom,ARecursif){return this.GetListeDonnees(ANoeud,ANom,ARecursif,this.GetNumero);};ObjetXML.prototype.GetListeLibelles=function(ANoeud,ANom,ARecursif){return this.GetListeDonnees(ANoeud,ANom,ARecursif,this.GetLibelle);};;

function assert(aIgnorer,aMessage){}
IE.GUID=(function GUID(){var lGUID_id=1,lGUID_ClassCss=1;return{getId:function(){var lResult='id_'+lGUID_id;lGUID_id+=1;return lResult;},getClassCss:function(){var lResult='c_'+lGUID_ClassCss;lGUID_ClassCss+=1;return lResult;},generateur:function(){var lGUID=1,lCompteur=0;this.get=function(){var lResult='g';if(lCompteur>0)
lResult+=lCompteur+'x';lResult+=lGUID;if(lGUID===Number.MAX_VALUE){lGUID=1;lCompteur+=1;}
else{lGUID+=1;}
return lResult;};}};}());IEClasses.Chrono=function Chrono(){this.reset();this.actif=true;};IEClasses.Chrono.prototype.start=function(){this.dateChrono=Date.now();this.actif=true;};IEClasses.Chrono.prototype.stop=function(){this.valeur+=Date.now()-this.dateChrono;this.actif=false;};IEClasses.Chrono.prototype.reset=function(){this.dateChrono=Date.now();this.valeur=0;};IEClasses.Chrono.prototype.toString=function(){var lValeur=this.valeur+(this.actif?(Date.now()-this.dateChrono):0);return(lValeur/1000)+' s';};IE.Enum.Log={Message:0,Avertissement:1,Erreur:2};IE.Log={};(function(){var _actif=false,_actifRequete=false,_idLogAutorises=[],_compteurRequete=0,_nbRequetesMax=100,_pileLog=[],_pileRequete=[];_idLogAutorises.ERROR=true;IE.Log.getActif=function(){return _actif;};IE.Log.setActif=function(aActif){_actif=aActif;if(aActif){this.addLog('Démarrage Log',null,IE.Enum.Log.Avertissement);}};IE.Log.getActifRequete=function(){return _actifRequete;};IE.Log.setActifRequete=function(aActif){_actifRequete=aActif;};IE.Log.addLog=function(aMessage,aIdFiltrage,aGenreLog){if(!_actif){return;}
if(aIdFiltrage&&_idLogAutorises&&!_idLogAutorises[aIdFiltrage]){return;}
var lMessage=aMessage&&aMessage.toString?aMessage.toString():'aMessage NON LOGGABLE !!!';var lLog={message:lMessage,genreLog:aGenreLog,date:new Date()};_pileLog.push(lLog);this.addConsoleLog(aMessage,aGenreLog);IE.Invocateur.evenement(IE.Invocateur.events.DEBUG_log,lLog);};IE.Log.vider=function(){_pileLog=[];IE.Invocateur.evenement(IE.Invocateur.events.DEBUG_log,null);};IE.Log.setIDFiltrageLog=function(aID,aAutoriser){if(aAutoriser){_idLogAutorises[aID]=true;}
else{delete _idLogAutorises[aID];}};IE.Log.addRequete=function(aDonnees){if(!this.getActifRequete()){return;}
var lDonnees={nomRequete:'',numeroRequete:0,numeroOrdre:0,chrono:null,avecXml:false,estReponse:false,lgcontenu:null,estSaisie:false};$.extend(lDonnees,aDonnees);lDonnees.date=new Date();_compteurRequete+=1;_pileRequete.push(lDonnees);if(_pileRequete.length>_nbRequetesMax){_pileRequete.shift();}
IE.Invocateur.evenement(IE.Invocateur.events.DEBUG_logRequete,lDonnees);};IE.Log.getCompteurRequete=function(){return _compteurRequete;};IE.Log.getPile=function(){return _pileLog;};IE.Log.getRequetes=function(){return _pileRequete;};IE.Log.addConsoleLog=function(aMessage,aGenreMsg){};IE.Log.addConsoleLogObjet=function(aObjet,aLibelle){};IE.Log.addConsolePileAppel=function(aLibelle){};}());(function(){var lGUID_GlobalNomPile=new IE.GUID.generateur();IEClasses.Invocateur=function(){this.pile={};this.pileEvents={};this.generateurGUID=new IE.GUID.generateur();this.nomPileInstance='__pileInvocateur__'+lGUID_GlobalNomPile.get();};function _abonner(aParams){if(!aParams.e||!aParams.e.toString){return null;}
aParams.e=aParams.e.toString();if(!aParams.callB){return null;}
if(aParams.unicite)
this.desabonner(aParams.e,aParams.callB,aParams.inst);if(!this.pileEvents[aParams.e]){this.pileEvents[aParams.e]={};}
var lId=this.generateurGUID.get();aParams.id=lId;this.pile[lId]=aParams;this.pileEvents[aParams.e][lId]=true;if(aParams.inst){if(!aParams.inst[this.nomPileInstance]){aParams.inst[this.nomPileInstance]={};}
aParams.inst[this.nomPileInstance][lId]=true;}
return lId;}
function _supprimerIds(aIds){if(!aIds){return;}
var lId,i,lElement,lInstance,lLength;for(i=0,lLength=aIds.length;i<lLength;i+=1){lId=aIds[i];lElement=this.pile[lId];if(lElement){lInstance=lElement.inst;if(lInstance&&lInstance[this.nomPileInstance]&&lInstance[this.nomPileInstance][lId]){delete lInstance[this.nomPileInstance][lId];if($.isEmptyObject(lInstance[this.nomPileInstance])){delete lInstance[this.nomPileInstance];}}
if(this.pileEvents[lElement.e]){if(this.pileEvents[lElement.e][lId]){delete this.pileEvents[lElement.e][lId];}}
lElement=null;if(this.pile[lId]){this.pile[lId].__INACTIF__=true;}
delete this.pile[lId];}}}
function _abonnerTous(aParam){var lIds=[],lEvent;if(aParam.e&&aParam.e.split){var lTab=aParam.e.split(' ');for(var i=0,lNb=lTab.length;i<lNb;i++){lEvent=lTab[i].trim();lIds.push(_abonner.call(this,{e:lEvent,callB:aParam.callB,inst:aParam.inst,unicite:aParam.unicite,u:aParam.u}));}}
if(lIds.length===0)
return null;if(lIds.length===1)
return lIds[0];return lIds;}
function _desabonnerParEvent(aEvent,aInstance,aCallback){var lEvents=this.pileEvents[aEvent],lPileInstance,lEventsASupprimer,lId,lElement;if(!lEvents){return;}
if(aInstance){lPileInstance=aInstance[this.nomPileInstance];if(!lPileInstance){return;}
lEventsASupprimer=[];for(lId in lPileInstance){if(lPileInstance.hasOwnProperty(lId)){lElement=this.pile[lId];if(lElement&&lElement.e===aEvent){if(!aCallback||aCallback===lElement.callB){lEventsASupprimer.push(lId);}}}}}
else if(aCallback){lEventsASupprimer=[];for(lId in lEvents){if(this.pile[lId]&&this.pile[lId].callB===aCallback){lEventsASupprimer.push(lId);}}}
else{lEventsASupprimer=lEvents;delete this.pileEvents[aEvent];}
if(lEventsASupprimer&&lEventsASupprimer.length>0){_supprimerIds.bind(this)(lEventsASupprimer);}}
IEClasses.Invocateur.prototype.abonner=function(aEvent,aCallback,aInstance,aAvecAbonnementUnicite){return _abonnerTous.call(this,{e:aEvent,callB:aCallback,inst:aInstance,unicite:aAvecAbonnementUnicite!==false?true:false});};IEClasses.Invocateur.prototype.abonnerUnique=function(aEvent,aCallback,aInstance,aAvecAbonnementUnicite){return _abonnerTous.call(this,{e:aEvent,callB:aCallback,inst:aInstance,u:true,unicite:aAvecAbonnementUnicite!==false?true:false});};IEClasses.Invocateur.prototype.desabonner=function(aParam1,aParam2,aParam3){if(!aParam1){return;}
var lEvent,lInstance,lCallBack,lEventsASupprimer,lPileInstance,lId;if(aParam1.push&&aParam1.pop&&IE.MethodesObjet.isArray(aParam1)){_supprimerIds.bind(this)(aParam1);return;}
if(IE.MethodesObjet.isObject(aParam1)){lInstance=aParam1;lCallBack=aParam2;}
else{lEvent=aParam1.toString();if(IE.MethodesObjet.isObject(aParam2)){lInstance=aParam2;}
else{lCallBack=aParam2;if(IE.MethodesObjet.isObject(aParam3)){lInstance=aParam3;}}}
if(lEvent){var lTab=lEvent.split(' ');for(var i=0;i<lTab.length;i++)
_desabonnerParEvent.call(this,lTab[i].trim(),lInstance,lCallBack);}
else if(lInstance){lPileInstance=lInstance[this.nomPileInstance];if(lPileInstance){lEventsASupprimer=[];for(lId in lPileInstance){if(lPileInstance.hasOwnProperty(lId)){if(lCallBack){if(this.pile[lId]&&this.pile[lId].callB===lCallBack){lEventsASupprimer.push(lId);}}
else{lEventsASupprimer.push(lId);}}}
if(!lCallBack){delete lInstance[this.nomPileInstance];}
_supprimerIds.bind(this)(lEventsASupprimer);}}};IEClasses.Invocateur.prototype.evenement=function(aEvent){if(!aEvent){return;}
aEvent=aEvent.toString();var lEvents=this.pileEvents[aEvent],i,lId,lElement,lArguments,lLength,lResult,lEventsATraiter=[],lAvecEvenement=false;if(lEvents){for(lId in lEvents){lAvecEvenement=true;lElement=this.pile[lId];if(lElement&&lElement.callB){lEventsATraiter.push(lElement);}}}
if(!lAvecEvenement){delete this.pileEvents[aEvent];}
for(i=0,lLength=lEventsATraiter.length;i<lLength;i+=1){lElement=lEventsATraiter[i];if(lElement&&!lElement.__INACTIF__){if(lElement.u){_supprimerIds.bind(this)([lElement.id]);}
;if(lElement.callB){lArguments=Array.prototype.slice.call(arguments,1);lResult=lElement.callB.apply(lElement.inst,lArguments);if(lResult===false){return;}}}}};}());IE.Invocateur=new IEClasses.Invocateur();IE.Invocateur.events={modificationModeExclusif:'IIE_modification_ModeExclusif',modeExclusif:'IIE_ModeExclusif',modificationPresenceUtilisateur:'IIE_ModificationPresenceUtilisateur',interruption_Requete:'IIE_Interruption_Requete',modification_RequeteAttente:'IIE_Modification_RequeteAttente',activationImpression:'IIE_Activation_Impression',choixImpression:'IIE_choix_impression',autorisationRechargementPage:'IIE_AutorisationRechargementPage',surRechargementPage:'IIE_SurRechargementPage',etatSaisie:'IIE_SetEtatSaisie',fermerFenetres:'IIE_fermer_fenetres',actualisationAffichage:'IIE_actualisation_affichage',eventReponseUpload:'IIE_eventReponseUpload',eventIOAjax:'IIE_eventIOAjax',modificationHTML:'IIE_modificationHTML',modificationThemeCouleur:'IEE_modificationThemeCouleur',toucheDEBUG:'IIE_ToucheDEBUG',DEBUG_log:'IIE_ADDLOG',DEBUG_logRequete:'IIE_ADDLOG_REQUETE'};IE.localStorage=(function(){var lLocalStorage=null;try{lLocalStorage=window.localStorage||(window.globalStorage?window.globalStorage[window.location.hostname]:null);if(lLocalStorage.setItem){lLocalStorage.setItem('_bidon_',1);lLocalStorage.removeItem('_bidon_');}}
catch(e){lLocalStorage=null;;}
return{actif:!!lLocalStorage,getItem:function(aCle){if(lLocalStorage){try{return lLocalStorage.getItem?lLocalStorage.getItem(aCle):lLocalStorage[aCle];} catch(e){}}
return null;},getItemJSON:function(aCle){var lResult=this.getItem(aCle),lJSON=null;try{lJSON=lResult?$.parseJSON(lResult):null;}
catch(e){;lJSON=null;}
return lJSON;},setItem:function(aCle,aValeur){if(lLocalStorage){try{if(lLocalStorage.setItem){lLocalStorage.setItem(aCle,aValeur);}
else{lLocalStorage[aCle]=aValeur;}} catch(e){}}},setItemJSON:function(aCle,aJSON){var lChaineJSON='';try{lChaineJSON=$.toJSON(aJSON);}
catch(e){;}
this.setItem(aCle,lChaineJSON||'');},removeItem:function(aCle){if(lLocalStorage){try{if(lLocalStorage.removeItem){lLocalStorage.removeItem(aCle);}
else{lLocalStorage[aCle]=null;}} catch(e){}}}};}());if(window.$&&$.mask){$.mask.IE={maskTelephone10:'99 99 99 99 99',maskTelephone12:'?99 99 99 99 99 99'};}
var GUID=IE.GUID,GLog=IE.Log,EGenreLog=IE.Enum.Log,Invocateur=IE.Invocateur;;
IE.deferLoadingScript=(function(){var lModules={},isOpera=typeof opera!=='undefined'&&opera.toString()==='[object Opera]',lUrlsDone={},options={done:null,fail:null},lModuleEnCours=null,lSupportASync,lHead=null;function createNode(config){var node=config.xhtml?document.createElementNS('http://www.w3.org/1999/xhtml','html:script'):document.createElement('script');node.type=config.scriptType||'text/javascript';node.async=false;return node;}
function removeListener(node,func,name,ieName){if(node.detachEvent&&!isOpera){if(ieName){node.detachEvent(ieName,func);}} else{node.removeEventListener(name,func,false);}}
function _getHead(){if(!lHead){lHead=document.getElementsByTagName('head')[0];}
return lHead;}
function createLoaderScript(aUrl,aCallback,aParams){var lLoader={url:aUrl,loaded:false,loadedFail:false,chrono:null,supportASync:false,timerFail:-1,params:aParams,load:function(){if(this.loaded){this.finChargement();return;}
this.chrono=new IEClasses.Chrono();var node=createNode({});if(lSupportASync===undefined){if(!document.addEventListener){lSupportASync=false;}
else lSupportASync='async' in node;}
if(node.attachEvent&&
!(node.attachEvent.toString&&node.attachEvent.toString().indexOf('[native code')<0)&&
!isOpera){node.attachEvent('onreadystatechange',onScriptLoad);} else{node.addEventListener('load',onScriptLoad,false);node.addEventListener('error',onScriptError,false);}
node.src=this.url;if(lSupportASync){node.async=false;}
if(this.params.timeoutLoad>=0){var lMessage=aUrl.split('/');IE.Invocateur.evenement(IE.Invocateur.events.eventIOAjax,{actualisation:true,message:lMessage[lMessage.length-1]});}
_getHead().appendChild(node);var lSelf=this;this.timerFail=setTimeout(function(){lSelf.loadedTimeoutFail=true;onScriptError({currentTarget:node});},aParams.timeoutFailScript);if(lSupportASync&&this.next){if(this.params.timeoutLoad>=0){setTimeout(function(){lSelf.next.load();},this.params.timeoutLoad);}
else this.next.load();}},finChargement:function(){clearTimeout(this.timerFail);aCallback(this);if(this.next&&!lSupportASync){if(this.timeoutLoad>=0){var lSelf=this;setTimeout(function(){lSelf.next.load();},this.timeoutLoad);}
else this.next.load();}}};function finScript(evt){var node=evt.currentTarget||evt.srcElement;removeListener(node,onScriptLoad,'load','onreadystatechange');removeListener(node,onScriptError,'error');return node;}
function onScriptLoad(evt){if(evt.type==='load'||(/^(complete|loaded)$/.test((evt.currentTarget||evt.srcElement).readyState))){finScript(evt);lLoader.loaded=true;lLoader.finChargement();}}
function onScriptError(evt){finScript(evt);lLoader.loadedFail=true;lLoader.finChargement();}
return lLoader;}
return{add:function(aNom,aUrls){var lNom=aNom.toLowerCase(),lModule={urls:[],count:0},lUrl,i;lModules[lNom]=lModule;for(i=0;i<aUrls.length;i++){lUrl=aUrls[i];lModule.urls.push(lUrl);}
return this;},contains:function(aNom){return!!lModules[aNom.toLowerCase()];},setOptions:function(aOptions){$.extend(options,aOptions);return this;},load:function(aNom,aParam){var lNom=aNom.toLowerCase(),lModule=lModules[lNom],lParams=$.extend({done:null,fail:null,eventIO:false,timeoutLoad:0,timeoutFailScript:3*60*1000},aParam);function _callbackFin(aEchec){lModuleEnCours=null;if(lParams.eventIO!==false)
IE.Invocateur.evenement(IE.Invocateur.events.eventIOAjax,{emission:false});if(aEchec){if(options.fail)
options.fail(aNom,lModule);if(lParams.fail)
lParams.fail(aNom,lModule);}
else{if(options.done)
options.done(aNom,lModule);lParams.done(aNom,lModule);}}
if(!lParams||!lParams.done){;return this;}
if(!lModule){_callbackFin();return this;}
if(lModuleEnCours===lNom){return this;}
lModuleEnCours=lNom;if(lParams.eventIO!==false)
IE.Invocateur.evenement(IE.Invocateur.events.eventIOAjax,{emission:true});var lUrl,i,lScript,LPrevScript,lStart=new IEClasses.Chrono();function _callback(aLoader){if(lModule.interrupt)
return;if(aLoader.loadedFail){aLoader.next=null;lModule.interrupt=true;_callbackFin(true);return;}
lUrlsDone[aLoader.url]=true;if(!aLoader.next){_callbackFin();}}
lModule.first=null;for(i=0;i<lModule.urls.length;i++){lUrl=lModule.urls[i];if(!lUrlsDone[lUrl]){lScript=createLoaderScript(lUrl,_callback,lParams);if(LPrevScript){LPrevScript.next=lScript;}
if(!lModule.first){lModule.first=lScript;}
LPrevScript=lScript;}}
if(lModule.first){lModule.first.load();}
else{_callbackFin();}
return this;}};}());;
function _ObjetHtml(){this._tailleMaxCacheCss=50;}(function(){var _cacheReglesCss=null;_ObjetHtml.prototype.elementExiste=function(aElement){return aElement&&(this.estElement(aElement)||this.estDocument(aElement)||document.getElementById(aElement))?true:false;};_ObjetHtml.prototype.estElement=function(aElement){return aElement&&(aElement.nodeType===1);};_ObjetHtml.prototype.estDocument=function(aElement){return aElement&&(aElement.nodeType===9);};_ObjetHtml.prototype.nettoyerHtml=function(aHtml){var lDiv=document.createElement('div');lDiv.innerHTML=aHtml;return lDiv.innerHTML;};_ObjetHtml.prototype.htmlToDOM=function(aHtml){var lDiv=document.createElement('div'),lNoeudDOM;lDiv.innerHTML=aHtml;if(lDiv.childNodes.length>1){lNoeudDOM=MethodesObjet.toArray(lDiv.childNodes);}
else{lNoeudDOM=lDiv.firstChild;}
lDiv=null;return lNoeudDOM;};_ObjetHtml.prototype.insererElementDOM=function(aElementPere,aElement,aInsererEnPremier){if(GHtml.estElement(aElement)&&GHtml.estElement(aElementPere)){if(aInsererEnPremier&&aElementPere.firstChild){aElementPere.insertBefore(aElement,aElementPere.firstChild);}
else{aElementPere.appendChild(aElement);}}};_ObjetHtml.prototype.addHtml=function(aId,aHtml){var i;var lElement=this.getElement(aId);if(this.elementExiste(lElement)&&lElement.appendChild){var lNoeud=this.htmlToDOM(aHtml);if(lNoeud&&(lNoeud.length>1)){for(i=0;i<lNoeud.length;i++){lElement.appendChild(lNoeud[i]);}}
else if(lNoeud){lElement.appendChild(lNoeud);}}};_ObjetHtml.prototype.supprimerElementDOM=function(aId){var lElement=GHtml.getElement(aId);if(lElement){$(lElement).remove();}};_ObjetHtml.prototype.getElement=function(aId){var E=this.estElement(aId)||this.estDocument(aId)?aId:document.getElementById(aId);return E||null;};_ObjetHtml.prototype.getHtml=function(aId){var E=this.getElement(aId);if(E){return E.innerHTML;}};_ObjetHtml.prototype.getValue=function(aId){var E=this.getElement(aId);if(E){return GChaine.ajouterEntites(E.value);}
return'';};_ObjetHtml.prototype.getClass=function(aId){var E=this.getElement(aId);return E&&E.className?E.className:'';};_ObjetHtml.prototype.addClass=function(aId,aClass){this.modifierClass(aId,null,aClass);};_ObjetHtml.prototype.delClass=function(aId,aClass){this.modifierClass(aId,aClass,null);};_ObjetHtml.prototype.modifierClass=function(aId,aClassSuppression,aClasseAjout){if((!aClassSuppression&&!aClasseAjout)||!this.elementExiste(aId)){return;}
var lJElement=GHtml.estElement(aId)?$(aId):$('#'+aId.escapeJQ());if(aClassSuppression){lJElement.removeClass(aClassSuppression);}
if(aClasseAjout){lJElement.addClass(aClasseAjout);}};_ObjetHtml.prototype.getDisplay=function(aId){var E=this.getElement(aId);if(E){if(E.style&&E.style.display==='none'){return false;}
else if(!E.parentNode){return true;}
else{return this.getDisplay(E.parentNode);}}
return false;};_ObjetHtml.prototype.extraireNombreDId=function(aId,aIndiceAvant,aSeparateur){var lOptions,T,lResult,lId=aId;if(!IE.MethodesObjet.isString(lId)){if(this.estElement(lId)&&lId.id){lId=lId.id;}
else{return null;}}
lOptions={separateur:aSeparateur||'_',indiceAvant:aIndiceAvant||0};T=lId.split(lOptions.separateur);lResult=parseInt(T[Math.max(0,T.length-1-lOptions.indiceAvant)],10);return IE.MethodesObjet.isNumber(lResult)?lResult:null;};_ObjetHtml.prototype.setClass=function(aId,aClass){var E=this.getElement(aId);if(E){E.className=aClass;}};_ObjetHtml.prototype.setHtml=function(aId,aHtml,aIgnorerScroll){var E=this.getElement(aId);if(E){var lParametres=$.extend({},aIgnorerScroll);if(aIgnorerScroll===true)
lParametres.ignorerScroll=true;if(lParametres.instance&&lParametres.instance.controleur){lParametres.controleur=lParametres.instance.controleur;}
if($.fn.IEHtml&&(!lParametres.instance||!lParametres.instance.IGNORER_IEHTML)){$(E).IEHtml(aHtml,lParametres);}
else{if(E.getElementsByTagName){$.cleanData(E.getElementsByTagName("*"));}
E.innerHTML=aHtml;if(aIgnorerScroll!==true){var lOverflow=$(E).css('overflow');if(lOverflow==='auto'||lOverflow==='scroll'){E.scrollLeft=0;E.scrollTop=0;}}}}};function _valeurToProp(aValeur){if(aValeur===null||aValeur===undefined)
return'';if(IE.MethodesObjet.isString(aValeur))
return GChaine.enleverEntites(aValeur);if(IE.MethodesObjet.isNumber(aValeur))
return aValeur+'';return aValeur;}
_ObjetHtml.prototype.setTitle=function(aId,aTitle){var E=this.getElement(aId);if(E){E.title=_valeurToProp(aTitle);}};_ObjetHtml.prototype.setValue=function(aId,aValue){var E=this.getElement(aId);if(E){E.value=_valeurToProp(aValue);}};_ObjetHtml.prototype.setDisabled=function(aId,aDisabled){var E=this.getElement(aId);if(E){$(E).inputDisabled(aDisabled);}};_ObjetHtml.prototype.setAvecMain=function(aId,aDisabled){var E=this.getElement(aId);if(E){$(E).toggleClass('AvecMain',!aDisabled);}};_ObjetHtml.prototype.setDisplay=function(aId,aVisible){var E=this.getElement(aId);if(E&&E.style){E.style.display=aVisible?'':'none';}};_ObjetHtml.prototype.setFocus=function(aId,aFocus,aAvecDecalage){function _focus(aElement,aFocus){if(!GHtml.elementExiste(aElement)){return;}
try{if(aFocus){aElement.focus();}
else{aElement.blur();}}
catch(e){GLog.addLog('Erreur ObjetHtml_Espace.prototype.setFocus : '+e.toString()+' ((fv) remarqué uniquement sur IE avec un delai)');}}
if(GHtml.elementExiste(aId)){try{if(this.getDisplay(aId)){var lElement=this.getElement(aId);if(lElement){if(aAvecDecalage){setTimeout(_focus.bind(null,lElement,aFocus||(aFocus===null)||(aFocus===undefined)),200);}
else{_focus(lElement,aFocus||(aFocus===null)||(aFocus===undefined));}}}}
catch(e){}}};_ObjetHtml.prototype.setFocusEdit=function(aId){if(this.elementExiste(aId)){try{if(this.getDisplay(aId)){var E=this.getElement(aId);if(E){E.focus();if(GNavigateur.IsIE){E.select();}
E.value=E.value;}}}
catch(e){}}};_ObjetHtml.prototype.setImage=function(aId,aSrc){var E=this.getElement(aId);if(E){E.src=aSrc;}};_ObjetHtml.prototype.setAlt=function(aId,aValue){var E=this.getElement(aId);if(E){E.alt=aValue;}};_ObjetHtml.prototype.setTexte=function(aId,aTexte){var E=this.getElement(aId);if(E){E.innerHTML='';E.appendChild(document.createTextNode(aTexte));}};_ObjetHtml.prototype.composeBlanc=function(){return'<span style="font-size : 1px">&nbsp;</span>';};_ObjetHtml.prototype._trouverSelecteur=function(aSelecteursTexte,aNomRegleCss){var i;if(aSelecteursTexte&&aSelecteursTexte.join){for(i=0;i<aSelecteursTexte.length;i++){if(aSelecteursTexte[i]===aNomRegleCss){return true;}}}
return false;};function _remplirCacheReglesCss(){var I,i,J,lStyleSheet,lRules,lRegles,lRegle,lSelecteurTexte;_cacheReglesCss=[];for(I=document.styleSheets.length-1;I>=0;I--){lStyleSheet=document.styleSheets[I];if(lStyleSheet&&lStyleSheet.href){try{lRules=lStyleSheet.cssRules||lStyleSheet.rules;}
catch(e){lRules=null;GLog.addLog('lecture cssRules : exception=> '+e);}
if(lRules){lRegles=[];_cacheReglesCss.push(lRegles);for(J=0;J<lRules.length;J++){lSelecteurTexte=lRules[J].selectorText;lRegle={selecteurs:[],regle:lRules[J]};if(lSelecteurTexte&&lSelecteurTexte.split){var lTabSelector=lSelecteurTexte.split(',');if(lTabSelector){for(i=0;i<lTabSelector.length;i++){lRegle.selecteurs.push(lTabSelector[i]&&lTabSelector[i].trim&&(lTabSelector[i].trim().toLowerCase().replace(/'/g,'"')));}}}
lRegles.push(lRegle);}}}}}
_ObjetHtml.prototype.chercherReglesCss=function(aNomRegleCss){var lRules,lRegle,lProp,I,J;if(!aNomRegleCss||!MethodesObjet.isString(aNomRegleCss)){return null;}
aNomRegleCss=aNomRegleCss.toLowerCase();if(!_cacheReglesCss){_remplirCacheReglesCss();}
if(this._cacheCss&&this._cacheCss[aNomRegleCss]){return this._cacheCss[aNomRegleCss];}
var lRegles=[];try{aNomRegleCss=aNomRegleCss.trim().toLowerCase().replace(/'/g,'"');for(I=_cacheReglesCss.length-1;I>=0;I--){lRules=_cacheReglesCss[I];if(lRules){for(J=lRules.length-1;J>=0;J--){lRegle=lRules[J];if(lRegle){if(this._trouverSelecteur(lRegle.selecteurs,aNomRegleCss)){lRegles.push(lRegle.regle);}}}}}
if(lRegles.length>0){if(!this._cacheCss){this._cacheCss=[];}
if(this._cacheCss.length>=this._tailleMaxCacheCss){for(lProp in this._cacheCss){delete this._cacheCss[lProp];break;}}
this._cacheCss[aNomRegleCss]=lRegles;return lRegles;}
else{return null;}} catch(e){GLog.addLog('lecture cssRules : exception=> '+e);}};_ObjetHtml.prototype.convertirProprieteCSS=function(aProprieteCSS){var i;var lTab=aProprieteCSS.split('-');for(i=1;i<lTab.length;i++){lTab[i]=lTab[i].ucfirst();}
return lTab.join('');};_ObjetHtml.prototype.modifierProprieteCSS=function(aRule,aProprieteCSS,aValeur){try{if(aRule&&aRule.style){if(aRule.style.setProperty){aRule.style.setProperty(aProprieteCSS,aValeur,null) ;}
else{aProprieteCSS=this.convertirProprieteCSS(aProprieteCSS);if(!MethodesObjet.isUndefined(aRule.style[aProprieteCSS])){aRule.style[aProprieteCSS]=aValeur;}}}} catch(e){;return false;}
return true;};_ObjetHtml.prototype.getRegleQuiDefinitProprieteCSS=function(aTabRegles,aProprieteCSS){var i;if(!aTabRegles){return null;}
var lAttribut;for(i=0;i<aTabRegles.length;i++){var lRegle=aTabRegles[i];if(lRegle&&lRegle.style){aProprieteCSS=this.convertirProprieteCSS(aProprieteCSS);lAttribut=lRegle.style[aProprieteCSS];if(((lAttribut!==null&&lAttribut!==undefined))&&(lAttribut!=='')){return lRegle;}}}
return null;};_ObjetHtml.prototype.modifierRegleCss=function(aNomRegleCss,aProprieteCSS,aValeur){var lRegles=this.chercherReglesCss(aNomRegleCss);if(!lRegles){return false;}
var lRegleAModifier=this.getRegleQuiDefinitProprieteCSS(lRegles,aProprieteCSS);if(lRegleAModifier===null||lRegleAModifier===undefined){lRegleAModifier=lRegles[0];}
return this.modifierProprieteCSS(lRegleAModifier,aProprieteCSS,aValeur);};_ObjetHtml.prototype.setCheckBox=function(aId,aValue){;if(aValue===undefined){aValue=false;}
var E=this.getElement(aId);if(E){$(E).inputChecked(aValue);}};}());;
MethodesObjet.heritagePrototype(ObjetHtml_Espace,_ObjetHtml);var GHtml=new ObjetHtml_Espace();function ObjetHtml_Espace(){this.inheritedCreate();}
ObjetHtml_Espace.prototype.estTextNode=function(aElement){return aElement&&(aElement.nodeType===3);};ObjetHtml_Espace.prototype.elementExisteByName=function(aElement){return(typeof aElement==='object')||document.getElementsByName(aElement)?true:false;};ObjetHtml_Espace.prototype.estNoeudDeType=function(aElement,aTypeParent){var lElement=this.getElement(aElement);return this.estElement(lElement)&&(lElement.nodeName.toUpperCase()===aTypeParent.toUpperCase());};ObjetHtml_Espace.prototype.getParent=function(aElement){var lElement=this.getElement(aElement);if(this.estElement(lElement)){if(lElement.parentElement){return lElement.parentElement;}
if(lElement.parentNode){return lElement.parentNode;}}
return null;};ObjetHtml_Espace.prototype.creerElementDOM=function(aTypeBalise){var lElement=document.createElement(aTypeBalise);if(!lElement){;return null;}
if(aTypeBalise==='table'){lElement.setAttribute('border',0);lElement.setAttribute('cellPadding',0);lElement.setAttribute('cellSpacing',0);}
return lElement;};ObjetHtml_Espace.prototype.getTextesDeNode=function(aId){var lElement=this.getElement(aId);var lResult=[],i;try{if(GHtml.estTextNode(lElement)){lResult.push(lElement.nodeValue);}
else if(GHtml.estElement(lElement)&&lElement.childNodes){for(i=0;i<lElement.childNodes.length;i++){lResult=lResult.concat(GHtml.getTextesDeNode(lElement.childNodes[i]));}}} catch(e){GLog.addLog('erreur getTextesDeNode : '+e,null,IE.Enum.Log.Erreur);}
return lResult;};ObjetHtml_Espace.prototype.getElementEnFocus=function(){return document.activeElement;};ObjetHtml_Espace.prototype.getValueInt=function(aId){return parseInt(this.getValue(aId),10);};ObjetHtml_Espace.prototype.getCheckBox=function(aId){var E=this.getElement(aId);if(E){return E.checked;}};ObjetHtml_Espace.prototype.setLien=function(aId,aValue){var E=this.getElement(aId);if(E&&(E.tagName.toUpperCase()==='A')){E.href=aValue;}};ObjetHtml_Espace.prototype.setUrl=function(aUrl){var lArray=window.location.href.split('?');var lUrl=lArray[0]+aUrl;if(lArray.length>1){lUrl+='?'+lArray[1];}
window.location.href=lUrl;};ObjetHtml_Espace.prototype.setCursorAtEnd=function(aId){if(this.elementExiste(aId)){try{if(!this.isDisplay(aId)){var E=this.getElement(aId);if(E){var end=E.value.length;if(E.setSelectionRange){E.setSelectionRange(end,end);} else{if(E.createTextRange){var range=E.createTextRange();range.collapse(true);range.moveEnd('character',end);range.moveStart('character',end);range.select();}}}}}
catch(e){}}};ObjetHtml_Espace.prototype.setTabIndex=function(aId,aTabIndex){var E=this.getElement(aId);if(E){E.tabIndex=aTabIndex;}};ObjetHtml_Espace.prototype.setSelection=function(aId,aSelection){var E=this.getElement(aId);if(E){E.selectedIndex=aSelection;}};ObjetHtml_Espace.prototype.setReadOnly=function(aId,aReadOnly){var E=this.getElement(aId);if(E){E.readOnly=aReadOnly;}};ObjetHtml_Espace.prototype.setPassword=function(aId,aPassword){var lType=aPassword?'password':'text',E;try{E=this.getElement(aId);if(E&&E.type){E.type=lType;}}
catch(e){var newElm=document.createElement('span');newElm.innerHTML='<input id="'+E.id+'" type="'+lType+'" name="'+E.name+'" class="'+E.className+'" size="'+E.size+'" onchange="'+E.onchange+'" onKeyup="'+E.onkeyup+'">';newElm=newElm.firstChild;E.parentNode.replaceChild(newElm,E);}};ObjetHtml_Espace.prototype.inverserCheckBox=function(aId){this.setCheckBox(aId,!this.getCheckBox(aId));};ObjetHtml_Espace.prototype.detruireCellule=function(aId){this.setHtml(aId,'');GPosition.setPosition(aId,0,0);GStyle.setVisible(aId,false);};ObjetHtml_Espace.prototype.viderCellule=function(aId){this.setHtml(aId,'');};ObjetHtml_Espace.prototype.composePostIt=function(aMessage){return aMessage?'<div style="width: 18px; height: 18px; top: -2; overflow: hidden"><div class="Image_PostIt" title="'+aMessage+'" onmouseover="GPosition.setLeft (this, -72)" onmouseout="GPosition.setLeft (this, 0)">&nbsp;</div></div>':'&nbsp;';};ObjetHtml_Espace.prototype.retaillerImage=function(aId,aWidth,aHeight){if(document.images[aId].width>document.images[aId].height){document.images[aId].width=aWidth;}
else{document.images[aId].height=aHeight;}};ObjetHtml_Espace.prototype.parcourirReglesCss=function(aNomRegleCss,aMethode,aArreterAuPremier){var lRegles=this.chercherReglesCss(aNomRegleCss),i;if(!lRegles){return false;}
for(i=0;i<lRegles.length;i++){if(aMethode(lRegles[i])){return true;}
if(aArreterAuPremier){return true;}}
return true;};ObjetHtml_Espace.prototype.chercherAttributReglesCss=function(aNomRegleCss,aAttribut){var lRegles=this.chercherReglesCss(aNomRegleCss,false),i;if(!lRegles){return false;}
var lAttribut;for(i=0;i<lRegles.length;i++){if(lRegles[i]&&lRegles[i].style){lAttribut=lRegles[i].style[aAttribut];if(((lAttribut!==null&&lAttribut!==undefined))&&(lAttribut!=='')){return lRegles[i].style[aAttribut];}}}
return false;};ObjetHtml_Espace.prototype.extraireUrlReglesCss=function(aNomRegleCss){var lUrl=this.chercherAttributReglesCss(aNomRegleCss,'backgroundImage');if(!lUrl||(lUrl.length===0)){return'';}
var lTab=lUrl.split('"');lTab=lTab[1];if(!lTab){lTab=lUrl.split("'");lTab=lTab[1];}
if(!lTab){lTab=lUrl.split('(');lTab=lTab[1];if(!lTab){return'';}
lTab=lTab.split(')');lTab=lTab[0];}
if(!lTab){return'';}
lTab=lTab.split('/');var lTab2=[],j;for(j=0;j<lTab.length;j++){if(lTab[j]!=='..'){lTab2.push(lTab[j]);}}
return lTab2.join('/');};ObjetHtml_Espace.prototype.demarrerOmbreFocus=function(){$(document).on({focusin:function(){var lCouleur=$(this).data('couleurFocus');if(!lCouleur){var lConteneurFenetre=$('#'+IE.ZoneFenetre.idZoneFenetre.escapeJQ()).get(0);lCouleur=lConteneurFenetre&&$.contains(lConteneurFenetre,this)?GCouleur.fenetre.cumul:GCouleur.cumul;}
$(this).css('outline',(lCouleur||GCouleur.noir)+' dotted 1px');},focusout:function(){$(this).css('outline','none');}},'.OmbreFocus');};;

IE.Support={};IE.Support.GenreNavigateur={Standard:1,Webkit:2,Moz:3,Opera:4,IE:5};(function(){function _initTableau(){var lTableau=[],lProp;for(lProp in IE.Support.GenreNavigateur){lTableau[IE.Support.GenreNavigateur[lProp]]=false;}
return lTableau;}
function _testerSupports(aDoc){var lProp;var LExtensionsStyle={};LExtensionsStyle[(MethodesObjet.nomProprieteDeValeur(IE.Support.GenreNavigateur,IE.Support.GenreNavigateur.Standard))]='';LExtensionsStyle[(MethodesObjet.nomProprieteDeValeur(IE.Support.GenreNavigateur,IE.Support.GenreNavigateur.Webkit))]='Webkit';LExtensionsStyle[(MethodesObjet.nomProprieteDeValeur(IE.Support.GenreNavigateur,IE.Support.GenreNavigateur.Moz))]='Moz';LExtensionsStyle[(MethodesObjet.nomProprieteDeValeur(IE.Support.GenreNavigateur,IE.Support.GenreNavigateur.Opera))]='O';LExtensionsStyle[(MethodesObjet.nomProprieteDeValeur(IE.Support.GenreNavigateur,IE.Support.GenreNavigateur.IE))]='MS';var lExtensionsCss={};lExtensionsCss[(MethodesObjet.nomProprieteDeValeur(IE.Support.GenreNavigateur,IE.Support.GenreNavigateur.Standard))]='';lExtensionsCss[(MethodesObjet.nomProprieteDeValeur(IE.Support.GenreNavigateur,IE.Support.GenreNavigateur.Webkit))]='-webkit-';lExtensionsCss[(MethodesObjet.nomProprieteDeValeur(IE.Support.GenreNavigateur,IE.Support.GenreNavigateur.Moz))]='-moz-';lExtensionsCss[(MethodesObjet.nomProprieteDeValeur(IE.Support.GenreNavigateur,IE.Support.GenreNavigateur.Opera))]='-o-';lExtensionsCss[(MethodesObjet.nomProprieteDeValeur(IE.Support.GenreNavigateur,IE.Support.GenreNavigateur.IE))]='-ms-';var lElement=aDoc.createElement('div');function _contains(aChaine,aSousChaine){return(''+aChaine).indexOf(aSousChaine)!== -1;}
function _getNomPropEtendu(aStyle,aExtension){return(aExtension.length>0)?aExtension+aStyle.ucfirst():aStyle;}
function _existeStyle(aStyle,aExtension){return!MethodesObjet.isUndefined(lElement.style[_getNomPropEtendu(aStyle,aExtension)]);}
function _leStyleContientLaChaine(aStyle,aExtension,aChaine){var lStyle=lElement.style[_getNomPropEtendu(aStyle,aExtension)];return!MethodesObjet.isUndefined(lStyle)&&_contains(lStyle,aChaine);}
IE.Support.supportFilterIE=!MethodesObjet.isUndefined(lElement.style.filter);if(!MethodesObjet.isUndefined(lElement.style.filter)){lElement.style.filter="progid:DXImageTransform.Microsoft.Gradient(gradientType=1,startColorStr=yellow,endColorStr=red);";IE.Support.supportFilterIE=(lElement.style.filter.length>0);}
for(lProp in LExtensionsStyle){IE.Support.supportBorderRadius[IE.Support.GenreNavigateur[lProp]]=_existeStyle('borderRadius',LExtensionsStyle[lProp]);if(IE.Support.supportBorderRadius[IE.Support.GenreNavigateur[lProp]]){IE.Support.avecBorderRadius=true;}}
lElement.style.cssText='background: linear-gradient(180deg, yellow, blue);';IE.Support.supportGradient[IE.Support.GenreNavigateur.Standard]=_contains(lElement.style.background,'gradient');lElement.style.cssText='background: -ms-linear-gradient(180deg, yellow, blue);';IE.Support.supportGradient[IE.Support.GenreNavigateur.IE]=_contains(lElement.style.background,'gradient');lElement.style.cssText='background: -webkit-gradient(180deg, left top, right top, from(blue), to(yellow));';IE.Support.supportGradient[IE.Support.GenreNavigateur.Webkit]=_contains(lElement.style.background,'gradient');lElement.style.cssText='background: -moz-linear-gradient(180deg, yellow, blue);';IE.Support.supportGradient[IE.Support.GenreNavigateur.Moz]=_contains(lElement.style.background,'gradient');for(lProp in LExtensionsStyle){lElement.style.cssText=lExtensionsCss[lProp]+'opacity:.5;';IE.Support.supportOpacity[IE.Support.GenreNavigateur[lProp]]=_leStyleContientLaChaine('opacity',LExtensionsStyle[lProp],'0.5');if(IE.Support.supportOpacity[IE.Support.GenreNavigateur[lProp]]){IE.Support.avecSupportOpacity=true;}}
for(lProp in LExtensionsStyle){IE.Support.supportBoxShadow[IE.Support.GenreNavigateur[lProp]]=_existeStyle('boxShadow',LExtensionsStyle[lProp]);if(IE.Support.supportBoxShadow[IE.Support.GenreNavigateur[lProp]]){IE.Support.avecSupportBoxShadow=true;}}
for(lProp in LExtensionsStyle){IE.Support.supportUserSelect[IE.Support.GenreNavigateur[lProp]]=_existeStyle('userSelect',LExtensionsStyle[lProp]);if(IE.Support.supportUserSelect[IE.Support.GenreNavigateur[lProp]]){IE.Support.avecUserSelect=true;}}
for(lProp in LExtensionsStyle){IE.Support.supportBackgroundSize[IE.Support.GenreNavigateur[lProp]]=_existeStyle('backgroundSize',LExtensionsStyle[lProp]);if(IE.Support.supportBackgroundSize[IE.Support.GenreNavigateur[lProp]]){IE.Support.avecBackgroundSize=true;}}
IE.Support.supportEventOnSelectStart=!MethodesObjet.isUndefined(lElement.onselectstart);for(lProp in LExtensionsStyle){IE.Support.supportTransitions[IE.Support.GenreNavigateur[lProp]]=_existeStyle('transitionProperty',LExtensionsStyle[lProp]);if(IE.Support.supportTransitions[IE.Support.GenreNavigateur[lProp]]){IE.Support.avecSupportTransitions=true;}}
var lNomTransform;for(lProp in LExtensionsStyle){lNomTransform='';switch(IE.Support.GenreNavigateur[lProp]){case IE.Support.GenreNavigateur.Standard:lNomTransform='transform';break;case IE.Support.GenreNavigateur.Webkit:lNomTransform='WebkitTransform';break;case IE.Support.GenreNavigateur.Moz:lNomTransform='MozTransform';break;case IE.Support.GenreNavigateur.Opera:lNomTransform='OTransform';break;case IE.Support.GenreNavigateur.IE:lNomTransform='msTransform';break;}
IE.Support.supportTransforms[IE.Support.GenreNavigateur[lProp]]=!MethodesObjet.isUndefined(lElement.style[lNomTransform]);if(IE.Support.supportTransforms[IE.Support.GenreNavigateur[lProp]]){IE.Support.avecSupportTransform=true;}}
IE.Support.supportEventOnPopState=!MethodesObjet.isUndefined(window.onpopstate);IE.Support.supportEventPaste='onpaste' in lElement;IE.Support.supportEventInput='oninput' in lElement;IE.Support.supportTouch=('ontouchstart' in window)||window.DocumentTouch&&document instanceof window.DocumentTouch;IE.Support.supportPointerEvent=!!window.PointerEvent;IE.Support.supportTouchPointerEvent=IE.Support.supportPointerEvent&&window.navigator.maxTouchPoints>0;IE.Support.supportMSPointerEvent=!!window.navigator.msPointerEnabled;IE.Support.tactile=IE.Support.supportTouch||IE.Support.supportTouchPointerEvent;IE.Support.avecSupportFileUpload=(function(){if(navigator.userAgent.match(/(Android (1.0|1.1|1.5|1.6|2.0|2.1))|(Windows Phone (OS 7|8.0))|(XBLWP)|(ZuneWP)|(w(eb)?OSBrowser)|(webOS)|(Kindle\/(1.0|2.0|2.5|3.0))/)){return false;}
var el=document.createElement("input");el.type="file";return!el.disabled;})();IE.Support.supportCanvas=!!aDoc.createElement('canvas').getContext;IE.Support.supportCanvasText=!!(IE.Support.supportCanvas&&typeof(aDoc.createElement('canvas').getContext('2d').fillText)==='function');IE.Support.supportBlob=_supportBlob();IE.Support.permissionNotification={defaut:"default",granted:"granted",denied:"denied"};IE.Support.supportNotification=_supportNotif();IE.Support.refreshNotification=function(){IE.Support.supportNotification=_supportNotif();};}
function _supportBlob(){var lBlob=false;try{lBlob=new Blob(['a'],{type:'text/plain'});} catch(e1){try{var BlobBuilder=window.MozBlobBuilder||window.WebKitBlobBuilder||window.BlobBuilder;if(e1.name==='TypeError'&&window.BlobBuilder){var bb=new BlobBuilder();bb.append(['a']);lBlob=bb.getBlob('text/plain');} else if(e1.name==='InvalidStateError'){lBlob=new Blob(['a'],{type:'text/plain'});}} catch(e2){return false;}}
if(lBlob) return true;return false;}
function _supportNotif(){var isSupported=false;try{isSupported=!!(window.Notification||window.webkitNotifications||navigator.mozNotification);if(isSupported){if(window.Notification&&window.Notification.permissionLevel){isSupported=window.Notification.permissionLevel();} else if(window.webkitNotifications&&window.webkitNotifications.checkPermission){if(window.webkitNotifications.checkPermission()===0) isSupported=IE.Support.permissionNotification.granted;else if(window.webkitNotifications.checkPermission()===2) isSupported=IE.Support.permissionNotification.denied;else isSupported=IE.Support.permissionNotification.defaut;} else if(navigator.mozNotification){isSupported=IE.Support.permissionNotification.granted;} else if(window.Notification&&window.Notification.permission){isSupported=window.Notification.permission;}}} catch(e){}
return isSupported;}
function _testerSupportHtml(){var lBody=document.getElementsByTagName("BODY")[0];var lElement=document.createElement('div');lBody.appendChild(lElement);var lTaille=50;var lId='_test_';lElement.innerHTML='<div id="'+lId+'" style="height:auto;"><div style="height:'+lTaille+'px; padding:4px;">&nbsp;</div></div>';IE.Support.bordureExterneDIV=document.getElementById(lId).offsetHeight===lTaille;lElement.innerHTML='<table cellpadding="0" cellspacing="0" border="0"><tr><td class="PetitEspace" id="'+lId+'" style="height:'+lTaille+'px;"><div style="">&nbsp;</div></td></tr></table>';IE.Support.bordureExterneTD=document.getElementById(lId).offsetHeight===lTaille;lElement.innerHTML='<div style="position:relative;height:'+lTaille+'px;width:50px;"><div id="'+lId+'" style="position:absolute; top:0px; bottom:0px; left:0px; right:0px;"></div></div>';IE.Support.positionAbsoluteOppose=document.getElementById(lId).offsetHeight===lTaille;lElement.innerHTML='<table style="position:absolute; z-index:-1; visibility:hidden"><tr>'+'<td style="height:'+lTaille+'px;">'+'<div id="'+lId+'" style="height:100%"><div style="height:'+(lTaille+20)+'px;"></div></div>'+'</td></tr></table>';IE.Support.div100PourcentDansTDGardeHauteurTD=document.getElementById(lId).offsetHeight===lTaille;lBody.removeChild(lElement);}
IE.Support.calculerScrollBar=function(){if(IE.Support.scrollBarWidth> -1){return IE.Support.scrollBarWidth;}
var scr=null;var inn=null;var wNoScroll=0;var wScroll=0;scr=document.createElement('div');scr.style.position='absolute';scr.style.top='-1000px';scr.style.left='-1000px';scr.style.width='100px';scr.style.height='50px';scr.style.overflow='hidden';inn=document.createElement('div');inn.style.width='100%';inn.style.height='200px';scr.appendChild(inn);document.body.appendChild(scr);wNoScroll=inn.offsetWidth;scr.style.overflow='auto';wScroll=inn.offsetWidth;document.body.removeChild(document.body.lastChild);var scrollBarWidth=(wNoScroll-wScroll);if(scrollBarWidth===0){var div=GHtml.htmlToDOM('<div id="divTestIEscroll" style="width:50px;height:50px;overflow:hidden;position:absolute;top:-200px;left:-200px;"><div style="height:100px;"></div></div>');document.body.appendChild(div);var w1=$(div.firstChild).innerWidth();div.style.overflowY='scroll';var w2=$(div.firstChild).innerWidth();document.body.removeChild(div);scrollBarWidth=(w1-w2);div=undefined;w1=undefined;w2=undefined;}
IE.Support.scrollBarWidth=scrollBarWidth;scr=undefined;inn=undefined;wNoScroll=undefined;wScroll=undefined;scrollBarWidth=undefined;return IE.Support.scrollBarWidth;};IE.Support=$.extend({supportFilterIE:false,supportEventOnSelectStart:false,supportEventOnPopState:false,supportEventPaste:false,supportEventInput:false,supportTouch:false,supportPointerEvent:false,supportTouchPointerEvent:false,supportMSPointerEvent:false,tactile:false,supportBorderRadius:_initTableau(),avecBorderRadius:false,supportGradient:_initTableau(),supportOpacity:_initTableau(),avecSupportOpacity:false,supportBoxShadow:_initTableau(),avecSupportBoxShadow:false,supportTransitions:_initTableau(),avecSupportTransitions:false,supportTransforms:_initTableau(),avecSupportTransform:false,supportUserSelect:_initTableau(),avecUserSelect:false,supportBackgroundSize:_initTableau(),avecBackgroundSize:false,scrollBarWidth:-1,avecSupportFileUpload:false,supportCanvas:false,supportCanvasText:false,supportBlob:false,supportNotification:false},IE.Support);$(window).load(function(){_testerSupports(window.document);_testerSupportHtml();});}());;
var EGenreBordure={gauche:1,haut:2,droite:4,bas:8};var EGenreCoin={hautG:1,hautD:2,basG:4,basD:8};function _ObjetStyle(){}
_ObjetStyle.prototype.composeCouleur=function(aCouleurFond,aCouleurTexte,aCouleurBordure,aLargeurBordure,aListeBordures){return this.composeCouleurFond(aCouleurFond)+this.composeCouleurTexte(aCouleurTexte)+this.composeCouleurBordure(aCouleurBordure,aLargeurBordure,aListeBordures);};_ObjetStyle.prototype.composeCouleurBordure=function(aCouleurBordure,aLargeurBordure,aListeBordures){if(!aCouleurBordure)
return'';if(!$.isNumeric(aLargeurBordure)) aLargeurBordure=1;if(!aListeBordures) aListeBordures=0;if(aListeBordures===0)
return' border: '+aLargeurBordure+'px solid '+aCouleurBordure+';';else{var H=[];H.push(aListeBordures&EGenreBordure.gauche?' border-left: '+aLargeurBordure+'px solid '+aCouleurBordure+';':'');H.push(aListeBordures&EGenreBordure.haut?' border-top: '+aLargeurBordure+'px solid '+aCouleurBordure+';':'');H.push(aListeBordures&EGenreBordure.droite?' border-right: '+aLargeurBordure+'px solid '+aCouleurBordure+';':'');H.push(aListeBordures&EGenreBordure.bas?' border-bottom: '+aLargeurBordure+'px solid '+aCouleurBordure+';':'');return H.join('');}};_ObjetStyle.prototype.composeCouleurFond=function(aCouleurFond){if(!aCouleurFond)
return'';else return' background-color:'+aCouleurFond+';';};_ObjetStyle.prototype.composeCouleurTexte=function(aCouleurTexte){if(!aCouleurTexte)
return'';else return' color:'+aCouleurTexte+';';};_ObjetStyle.prototype.composeBordureArrondi=function(aRayonBordure,aListeBordures){return'';};_ObjetStyle.prototype.composeHeight=function(aValeur,aFormat){if(!MethodesObjet.isNumber(aValeur)) return'';if(!aFormat) aFormat='px';return'height:'+aValeur+aFormat+';';};_ObjetStyle.prototype.composeWidth=function(aValeur,aFormat){if(aValeur&&aValeur.indexOf&&aValeur.indexOf('%')>0){aValeur=parseFloat(aValeur);aFormat='%';}
if(!MethodesObjet.isNumber(aValeur)) return'';if(!aFormat) aFormat='px';return'width:'+aValeur+aFormat+';';};_ObjetStyle.prototype.composeMarge=function(aHaut,aBas,aGauche,aDroit){var lResult='';if($.isNumeric(aHaut)) lResult+='margin-top: '+aHaut+'px; ';if($.isNumeric(aBas)) lResult+='margin-bottom: '+aBas+'px; ';if($.isNumeric(aGauche)) lResult+='margin-left: '+aGauche+'px; ';if($.isNumeric(aDroit)) lResult+='margin-right: '+aDroit+'px; ';return lResult;};_ObjetStyle.prototype.composeBoxShadow=function(aParametres){var lParametres={x:4,y:4,blur:2,spread:0,r:0,g:0,b:0,opacity:0.2};$.extend(lParametres,aParametres);var lValeur='';if($.isNumeric(lParametres.x)&&lParametres.x>0)
lValeur+=lParametres.x+'px';else lValeur+='0';lValeur+=' ';if($.isNumeric(lParametres.y)&&lParametres.y>0)
lValeur+=lParametres.y+'px';else lValeur+='0';lValeur+=' ';if($.isNumeric(lParametres.blur)&&lParametres.blur>0){lValeur+=lParametres.blur+'px';}
else{lValeur+='0';}
lValeur+=' ';if($.isNumeric(lParametres.spread)&&lParametres.spread!==0)
lValeur+=lParametres.spread+'px';if(lParametres.opacity>0){lValeur+=' rgba('+lParametres.r+', '+lParametres.g+', '+lParametres.b+', '+lParametres.opacity+')';}
else{lValeur+=' rgb('+lParametres.r+', '+lParametres.g+', '+lParametres.b+')';}
if(IE.Support.supportBoxShadow[IE.Support.GenreNavigateur.Standard])
return'box-shadow: '+lValeur+';';else if(IE.Support.supportBoxShadow[IE.Support.GenreNavigateur.Webkit])
return'-webkit-box-shadow: '+lValeur+';';else if(IE.Support.supportBoxShadow[IE.Support.GenreNavigateur.Moz])
return'-moz-box-shadow: '+lValeur+';';else return'';};_ObjetStyle.prototype.composeTransitions=function(aPropriete,aDureeEnS,aDelaiEnS,aTiming){if(!MethodesObjet.isString(aPropriete)||!MethodesObjet.isString(aDureeEnS)) return'';if(IE.Support.supportTransitions[IE.Support.GenreNavigateur.Standard])
return'transition-property: '+aPropriete+';'+'transition-duration:'+aDureeEnS+';'+(MethodesObjet.isString(aDelaiEnS)?'transition-delay:'+aDelaiEnS+';':'')+(MethodesObjet.isString(aTiming)?'transition-timing-function:'+aTiming+';':'');else if(IE.Support.supportTransitions[IE.Support.GenreNavigateur.Webkit])
return'-webkit-transition-property: '+aPropriete+';'+'-webkit-transition-duration:'+aDureeEnS+';'+(MethodesObjet.isString(aDelaiEnS)?'-webkit-transition-delay:'+aDelaiEnS+';':'')+(MethodesObjet.isString(aTiming)?'-webkit-transition-timing-function:'+aTiming+';':'');else if(IE.Support.supportTransitions[IE.Support.GenreNavigateur.Moz])
return'-moz-transition-property: '+aPropriete+';'+'-moz-transition-duration:'+aDureeEnS+';'+(MethodesObjet.isString(aDelaiEnS)?'-moz-transition-delay:'+aDelaiEnS+';':'')+(MethodesObjet.isString(aTiming)?'-moz-transition-timing-function:'+aTiming+';':'');else if(IE.Support.supportTransitions[IE.Support.GenreNavigateur.Opera])
return'-o-transition-property: '+aPropriete+';'+'-o-transition-duration:'+aDureeEnS+';'+(MethodesObjet.isString(aDelaiEnS)?'-o-transition-delay:'+aDelaiEnS+';':'')+(MethodesObjet.isString(aTiming)?'-o-transition-timing-function:'+aTiming+';':'');else return'';};_ObjetStyle.prototype.whichTransitionEvent=function(){var t;var lElement=document.createElement('fakeelement');var lTransitions={'WebkitTransition':'webkitTransitionEnd','transition':'transitionEnd','OTransition':'oTransitionEnd','MSTransition':'msTransitionEnd','MozTransition':'transitionend'};for(t in lTransitions){if(lElement.style[t]!==undefined){return lTransitions[t];}}};_ObjetStyle.prototype.setTransitions=function(aId,aPropriete,aDureeEnS,aDelaiEnS,aTiming){if(!MethodesObjet.isString(aPropriete)||!MethodesObjet.isString(aDureeEnS)) return'';var lStyle=this.getStyle(aId);if(lStyle){var lChaine=aPropriete+' '+aDureeEnS+' '+(MethodesObjet.isString(aDelaiEnS)?aDelaiEnS+' ':'')+(MethodesObjet.isString(aTiming)?aTiming+' ':'');if(IE.Support.supportTransitions[IE.Support.GenreNavigateur.Standard])
lStyle.transition=lChaine;else if(IE.Support.supportTransitions[IE.Support.GenreNavigateur.Webkit])
lStyle.webkitTransition=lChaine;else if(IE.Support.supportTransitions[IE.Support.GenreNavigateur.Moz])
lStyle.MozTransition=lChaine;else if(IE.Support.supportTransitions[IE.Support.GenreNavigateur.Opera])
lStyle.OTransition=lChaine;}};_ObjetStyle.prototype.getStyle=function(aId){var E=GHtml.getElement(aId);if(E)
return E.style;};_ObjetStyle.prototype.setCouleurBordure=function(aId,aCouleur){var E=GHtml.getElement(aId);if(E)
E.style.borderColor=aCouleur;};_ObjetStyle.prototype.setCouleurBordureHaut=function(aId,aCouleur){var E=GHtml.getElement(aId);if(E)
E.style.borderTopColor=aCouleur;};_ObjetStyle.prototype.setCouleurBordureBas=function(aId,aCouleur){var E=GHtml.getElement(aId);if(E&&E.style)
E.style.borderBottomColor=aCouleur;};_ObjetStyle.prototype.setCouleurBordureGauche=function(aId,aCouleur){var E=GHtml.getElement(aId);if(E)
E.style.borderLeftColor=aCouleur;};_ObjetStyle.prototype.setCouleurBordureDroit=function(aId,aCouleur){var E=GHtml.getElement(aId);if(E)
E.style.borderRightColor=aCouleur;};_ObjetStyle.prototype.setCouleur=function(aId,aCouleurFond,aCouleurTexte,aCouleurBordure){if(aCouleurFond) this.setCouleurFond(aId,aCouleurFond);if(aCouleurTexte) this.setCouleurTexte(aId,aCouleurTexte);if(aCouleurBordure) this.setCouleurBordure(aId,aCouleurBordure);};_ObjetStyle.prototype.setCouleurFond=function(aId,aCouleurFond){var S=this.getStyle(aId);if(S)
S.backgroundColor=aCouleurFond;};_ObjetStyle.prototype.setCouleurTexte=function(aId,aCouleurTexte){var S=this.getStyle(aId);if(S)
S.color=aCouleurTexte;};_ObjetStyle.prototype.setVisible=function(aId,aVisible){var S=this.getStyle(aId);if(S)
S.visibility=aVisible?'visible':'hidden';};_ObjetStyle.prototype.setGras=function(aId,aGras){var E=GHtml.getElement(aId);if(E&&GHtml.estElement(E))
E.style.fontWeight=(aGras?'bold':'normal');};_ObjetStyle.prototype.setZindex=function(aId,aZindex){var S=this.getStyle(aId);if(S)
S.zIndex=aZindex;};_ObjetStyle.prototype.setDisplay=function(aId,aDisplay){var S=this.getStyle(aId);if(S)
S.display=aDisplay?'':'none';};_ObjetStyle.prototype.composeDegradeVertical=function(aCouleurDebut,aCouleurFin){var lResult=this.composeCouleurFond(aCouleurDebut);if(IE.Support.supportFilterIE)
lResult+=' FILTER: progid:DXImageTransform.Microsoft.Gradient(gradientType=0,startColorStr='+aCouleurDebut+',endColorStr='+aCouleurFin+');';else if(IE.Support.supportGradient[IE.Support.GenreNavigateur.Standard])
lResult+=' background: linear-gradient(to bottom, '+aCouleurDebut+', '+aCouleurFin+');';else if(IE.Support.supportGradient[IE.Support.GenreNavigateur.IE])
lResult+=' background: -ms-linear-gradient(top, '+aCouleurDebut+', '+aCouleurFin+');';else if(IE.Support.supportGradient[IE.Support.GenreNavigateur.Moz])
lResult+=' background: -moz-linear-gradient(top, '+aCouleurDebut+', '+aCouleurFin+');';else if(IE.Support.supportGradient[IE.Support.GenreNavigateur.Webkit])
lResult+=' background: -webkit-gradient(linear, left top, left bottom, from('+aCouleurDebut+'), to('+aCouleurFin+'));';return lResult;};_ObjetStyle.prototype.composeContenuDegradeVertical=function(aCouleurDebut,aCouleurFin){return this.composeContenuDegrade(180,aCouleurDebut,aCouleurFin);};_ObjetStyle.prototype.composeContenuDegrade=function(aAngle,aCouleurDebut,aCouleurFin){var lResult='';if(IE.Support.supportGradient[IE.Support.GenreNavigateur.Standard])
lResult+='linear-gradient('+aAngle+'deg, '+aCouleurDebut+', '+aCouleurFin+')';else if(IE.Support.supportGradient[IE.Support.GenreNavigateur.IE])
lResult+='-ms-linear-gradient('+aAngle+'deg, '+aCouleurDebut+', '+aCouleurFin+')';else if(IE.Support.supportGradient[IE.Support.GenreNavigateur.Moz])
lResult+='-moz-linear-gradient('+aAngle+'deg, '+aCouleurDebut+', '+aCouleurFin+')';else if(IE.Support.supportGradient[IE.Support.GenreNavigateur.Webkit])
lResult+='-webkit-gradient('+aAngle+'deg, left top, left bottom, from('+aCouleurDebut+'), to('+aCouleurFin+'))';else lResult+=aCouleurDebut;return lResult;};;
var EGenreCurseur={Defaut:0,Main:1,Sablier:2,Aide:3,Move:4,Retaillage:5,Interdiction:6};;
MethodesObjet.heritagePrototype(ObjetStyle_Espace,_ObjetStyle);var GStyle=new ObjetStyle_Espace();function ObjetStyle_Espace(){this.inheritedCreate();}
ObjetStyle_Espace.prototype.composeAlignementVertical=function(aAlignementVertical){return' vertical-align : '+aAlignementVertical+';';};ObjetStyle_Espace.prototype.composeAlignementTexte=function(aAlignementTexte){return' text-align : '+aAlignementTexte+';';};ObjetStyle_Espace.prototype.composeBordureEtAlignement=function(aCouleurBordure,aLargeurBordure,aAlignementBordure){return' border-'+(aAlignementBordure?'left':'right')+': '+aLargeurBordure+'px '+aCouleurBordure+' solid;';};ObjetStyle_Espace.prototype.composeCouleurBandeau=function(){return GStyle.composeCouleurFond(GCouleur.blanc);};ObjetStyle_Espace.prototype.composeCouleurTitre=function(aInverser){var lCouleurFond=aInverser?GCouleur.fond:GCouleur.texte;var lCouleurTexte=aInverser?GCouleur.texte:GCouleur.fond;return this.composeCouleur(lCouleurFond,lCouleurTexte);};ObjetStyle_Espace.prototype.composeCouleurDegrade=function(aCouleurDebut,aCouleurFin){aCouleurDebut=aCouleurDebut||GCouleur.texte;aCouleurFin=aCouleurFin||GCouleur.intermediaire;return this.composeDegrade(aCouleurDebut,aCouleurFin);};ObjetStyle_Espace.prototype.composeDegrade=function(aCouleurDebut,aCouleurFin,aAvecBorderRadius){var lResult=this.composeCouleurFond(aCouleurDebut);if(aCouleurDebut!==aCouleurFin){if(IE.Support.supportFilterIE){if(!aAvecBorderRadius||!IE.Support.avecBorderRadius)
lResult=' FILTER: progid:DXImageTransform.Microsoft.Gradient(gradientType=1,startColorStr='+aCouleurDebut+',endColorStr='+aCouleurFin+');';}
else if(IE.Support.supportGradient[IE.Support.GenreNavigateur.Standard])
lResult+=' background: linear-gradient(to right, '+aCouleurDebut+', '+aCouleurFin+');';else if(IE.Support.supportGradient[IE.Support.GenreNavigateur.IE])
lResult+=' background: -ms-linear-gradient(left, '+aCouleurDebut+', '+aCouleurFin+');';else if(IE.Support.supportGradient[IE.Support.GenreNavigateur.Moz])
lResult+=' background: -moz-linear-gradient(left, '+aCouleurDebut+', '+aCouleurFin+');';else if(IE.Support.supportGradient[IE.Support.GenreNavigateur.Webkit])
lResult+=' background: -webkit-gradient(linear, left top, right top, from('+aCouleurDebut+'), to('+aCouleurFin+'));';}
return lResult;};ObjetStyle_Espace.prototype.composeDegradeCoinSuperieur=function(aAlignement){if(aAlignement==='right')
return this.composeDegradeCoinSuperieurGauche();else return'';};ObjetStyle_Espace.prototype.composeDegradeCoinSuperieurGauche=function(){return IE.Support.supportFilterIE?('FILTER: progid:DXImageTransform.Microsoft.Alpha( style=1,opacity=30,finishOpacity=100,startX=0,finishX=20,startY=0,finishY=100);'):'';};ObjetStyle_Espace.prototype.composeDegradeCoinSuperieurDroit=function(){return IE.Support.supportFilterIE?('FILTER: progid:DXImageTransform.Microsoft.Alpha( style=1,opacity=30,finishOpacity=100,startX=100,finishX=80,startY=0,finishY=100);'):'';};ObjetStyle_Espace.prototype.composeTaillePolice=function(aTaillePolice){return' font-size:'+aTaillePolice+'px;';};ObjetStyle_Espace.prototype.composeCurseur=function(aGenreCurseur){return' cursor:'+new Array('default','pointer','help','nw-resize','not-allowed')[aGenreCurseur]+';';};ObjetStyle_Espace.prototype.composeOpacite=function(aOpacite){if(!$.isNumeric(aOpacite)||aOpacite<0||aOpacite>1){;return'';}
aOpacite=Math.borner(aOpacite,0,1);if(IE.Support.supportOpacity[IE.Support.GenreNavigateur.Standard])
return'opacity: '+aOpacite+';';else if(IE.Support.supportOpacity[IE.Support.GenreNavigateur.Webkit])
return'-webkit-opacity: '+aOpacite+';';else if(IE.Support.supportOpacity[IE.Support.GenreNavigateur.Moz])
return'-moz-opacity: '+aOpacite+';';else if(IE.Support.supportFilterIE)
return'FILTER: progid:DXImageTransform.Microsoft.Alpha(opacity='+parseInt(aOpacite*100)+')'+';';else return'';};ObjetStyle_Espace.prototype.getCouleurFond=function(aId){try{return this.getStyle(aId).backgroundColor;} catch(E){}};ObjetStyle_Espace.prototype.getZindex=function(aId){var S=this.getStyle(aId);if(S&&S.zIndex)
return parseInt(S.zIndex);};ObjetStyle_Espace.prototype.setStyle=function(aId,aStyle){var E=GHtml.getElement(aId);if(E){if(E.style&&E.style.setAttribute)
E.style.setAttribute('cssText',aStyle);else if(E.setAttribute)
E.setAttribute('style',aStyle);}};ObjetStyle_Espace.prototype.setBordure=function(aId,aCouleurBordure,aLargeurBordure,aStyleBordure){if(!$.isNumeric(aLargeurBordure)) aLargeurBordure=1;if(!aStyleBordure) aStyleBordure='solid';var S=this.getStyle(aId);if(S)
S.border=aLargeurBordure+'px '+aStyleBordure+' '+aCouleurBordure;};ObjetStyle_Espace.prototype.setEpaisseurBordure=function(aId,aEpaisseur){var E=GHtml.getElement(aId);if(E)
E.style.borderWidth=aEpaisseur;};ObjetStyle_Espace.prototype.setEpaisseurBordureBas=function(aId,aEpaisseur){var E=GHtml.getElement(aId);if(E)
E.style.borderBottomWidth=aEpaisseur;};ObjetStyle_Espace.prototype.setEpaisseurBordureGauche=function(aId,aEpaisseur){var E=GHtml.getElement(aId);if(E)
E.style.borderLeftWidth=aEpaisseur;};ObjetStyle_Espace.prototype.setEpaisseurBordureDroit=function(aId,aEpaisseur){var E=GHtml.getElement(aId);if(E)
E.style.borderRightWidth=aEpaisseur;};ObjetStyle_Espace.prototype.setEpaisseurMargeHaut=function(aId,aEpaisseur){var E=GHtml.getElement(aId);if(E)
E.style.marginTop=aEpaisseur;};ObjetStyle_Espace.prototype.setCurseur=function(aId,aGenreCurseur){var lCursor;switch(aGenreCurseur){case EGenreCurseur.Main:{lCursor='pointer';break;}
case EGenreCurseur.Sablier:{lCursor='wait';break;}
case EGenreCurseur.Aide:{lCursor='help';break;}
case EGenreCurseur.Move:{lCursor='move';break;}
default:{lCursor='default';break;}}
var S=this.getStyle(aId);if(S)
S.cursor=lCursor;};ObjetStyle_Espace.prototype.getDisplay=function(aId){var S=this.getStyle(aId);return S.display==='';};ObjetStyle_Espace.prototype.setTexteSouligne=function(aId,aSouligne){var S=this.getStyle(aId);if(S)
S.textDecoration=aSouligne?'underline':'none';};ObjetStyle_Espace.prototype.getVisible=function(aId){var E=GHtml.getElement(aId);return E.style?E.style.visibility==='visible':false;};ObjetStyle_Espace.prototype.setImageFond=function(aId,aImage){var S=this.getStyle(aId);if(S){S.backgroundImage='url('+aImage+')';S.backgroundAttachment='fixed';}};ObjetStyle_Espace.prototype.setBordureArrondi=function(aId,aRayonBordure,aListeBordures){};ObjetStyle_Espace.prototype.setOpacity=function(aId,aOpacite,aAvecOpacityFilter){if(!$.isNumeric(aOpacite)||aOpacite<0||aOpacite>1){;return'';}
aOpacite=Math.min(1,Math.max(0,aOpacite));var lStyle=this.getStyle(aId);if(lStyle){if(IE.Support.supportOpacity[IE.Support.GenreNavigateur.Standard])
lStyle.opacity=aOpacite;else if(IE.Support.supportOpacity[IE.Support.GenreNavigateur.Webkit])
lStyle.webkitOpacity=aOpacite;else if(IE.Support.supportOpacity[IE.Support.GenreNavigateur.Moz])
lStyle.MozOpacity=aOpacite;else if(aAvecOpacityFilter&&IE.Support.supportFilterIE)
lStyle.filter='alpha(opacity='+parseInt(aOpacite*100)+')';}};ObjetStyle_Espace.prototype.setTransforms=function(aId,aTransforms){if(!aTransforms)
return;var lStyle=this.getStyle(aId);if(lStyle){if(IE.Support.supportTransforms[IE.Support.GenreNavigateur.Standard])
lStyle.transformProperty=aTransforms;else if(IE.Support.supportTransforms[IE.Support.GenreNavigateur.Webkit])
lStyle.WebkitTransform=aTransforms;else if(IE.Support.supportTransforms[IE.Support.GenreNavigateur.Moz])
lStyle.MozTransform=aTransforms;else if(IE.Support.supportTransforms[IE.Support.GenreNavigateur.IE])
lStyle.msTransform=aTransforms;}};ObjetStyle_Espace.prototype.nonVisible=function(aId){var lElement=GHtml.getElement(aId);if(!GHtml.estElement(lElement))
return true;return $.expr.filters.hidden(lElement);};;
var EGenreType={Cardinal:1,Boolean:2,String:3,Color:4,Alignment:5,FontStyles:6,Date:7,Domaine:8,Traduction:9,Note:10,EnsembleCardinal:11,Double:13,Arrondi:14,Ensemble:15,IP:16,Integer:20,Html:21,JSON:22,ChaineBrute:23,Element:24,FichierBase64:25,EnsembleNombre:26};;
function TypeDomaine(AValeurParDefaut,ANombreValeurs){this.valeurSemaine={plein:'1',vide:'0'};this.nombreValeurs=ANombreValeurs?ANombreValeurs:ObjetCycles.C_MaxDomaineCycle;AValeurParDefaut=(AValeurParDefaut===null)||AValeurParDefaut===undefined||(AValeurParDefaut==='')?'[]':AValeurParDefaut;this.Domaine=this.GetDomaine(AValeurParDefaut,this.nombreValeurs);}
TypeDomaine.CTailleOuverte= -1;TypeDomaine.prototype.GetDomaine=function(AValeurParDefaut,ANombreValeurs){var lType=typeof(AValeurParDefaut);var D;if((lType!=='objet')&&(lType!=='string'))
D=new Array(1+(ANombreValeurs===null||ANombreValeurs===undefined?ObjetCycles.C_MaxDomaineCycle:ANombreValeurs)).join((lType==='boolean')&&AValeurParDefaut?this.valeurSemaine.plein:this.valeurSemaine.vide).split('');switch(lType){case'number':D[AValeurParDefaut-1]=this.valeurSemaine.plein;return D;case'objet':return AValeurParDefaut;case'string':return this.strToDomaine(AValeurParDefaut,ANombreValeurs);case'boolean':return D;default:return D;}};TypeDomaine.prototype.strToDomaine=function(aChaine,aNombreValeurs){if(!((aChaine.charAt(0)==='[')&&(aChaine.charAt(aChaine.length-1)===']'))){var lTab=aChaine.split('');if(aNombreValeurs!==null&&aNombreValeurs>=0)
lTab.length=aNombreValeurs;return lTab;}
aChaine=aChaine.substring(1,aChaine.length-1);var R=new Array(aNombreValeurs!==TypeDomaine.CTailleOuverte?aNombreValeurs:0);var T1=aChaine.split(',');for(var I=0;I<T1.length;I++){var T2=T1[I].split('..');var V1=parseInt(T2[0]);var V2=parseInt(T2.length===1?V1:T2[1]);for(var J=V1;J<=V2;J++)
R[J-1]=this.valeurSemaine.plein;}
if(this.nombreValeurs!==TypeDomaine.CTailleOuverte)
this.nombreValeurs=R.length;return R;};TypeDomaine.prototype.toString=function(){var S='',N=0;for(var I=0;I<=this.Domaine.length;I++){if(this.Domaine[I]==='1')
N++;else if(N>0){if(S.length)
S+=',';if(N>1)
S+=(I+1-N)+'..';S+=(I);N=0;}}
return'['+S+']';};TypeDomaine.prototype.Vider=function(){this.SetValeur(false,1,this.GetTaille());};TypeDomaine.prototype.EstVide=function(){for(var I=1;I<=this.Domaine.length;I++)
if(this.GetValeur(I)) return false;return true;};TypeDomaine.prototype.SetValeur=function(AValeur,ADeb,AFin){if((ADeb>this.GetTaille())&&(this.nombreValeurs!==TypeDomaine.CTailleOuverte)) return;if(this.nombreValeurs!==TypeDomaine.CTailleOuverte){ADeb=Math.borner(ADeb ,1,this.GetTaille());AFin=Math.borner(AFin===null||AFin===undefined?ADeb:AFin,1,this.GetTaille());}
else{ADeb=Math.max(ADeb,1);AFin=AFin===null||AFin===undefined?ADeb:Math.max(ADeb,AFin);}
for(var I=ADeb-1;I<AFin;I++)
this.Domaine[I]=AValeur?this.valeurSemaine.plein:this.valeurSemaine.vide;};TypeDomaine.prototype.GetValeur=function(APos){return this.Domaine[APos-1]===this.valeurSemaine.plein;};TypeDomaine.prototype.GetPremierePosition=function(aValeur){for(var I=0;I<this.Domaine.length;I++){var lValeur=this.Domaine[I]===null||this.Domaine[I]===undefined?this.valeurSemaine.vide:this.Domaine[I];if(lValeur===(aValeur===false?this.valeurSemaine.vide:this.valeurSemaine.plein))
return I+1;}
return-1;};TypeDomaine.prototype.GetDernierePosition=function(aValeur){for(var I=this.Domaine.length-1;I>=0;I--){var lValeur=this.Domaine[I]===null||this.Domaine[I]===undefined?this.valeurSemaine.vide:this.Domaine[I];if(lValeur===(aValeur===false?this.valeurSemaine.vide:this.valeurSemaine.plein))
return I+1;}
return-1;};TypeDomaine.prototype.GetNbrValeurs=function(AValeur){var N=0;var LValeur=AValeur||(AValeur===null)||AValeur===undefined?this.valeurSemaine.plein:this.valeurSemaine.vide;for(var I=0;I<this.Domaine.length;I++)
if(this.Domaine[I]===LValeur)
N++;return N;};TypeDomaine.prototype.EstUnNombre=function(){return this.GetNbrValeurs(true)<=1;};TypeDomaine.prototype.getNombre=function(){return this.GetNbrValeurs(true)===1?this.GetPremierePosition(true):0;};TypeDomaine.prototype.GetTaille=function(){return this.Domaine.length;};TypeDomaine.prototype.GetIntersection=function(aDomaine){if(!aDomaine) return MethodesObjet.dupliquer(this);var lTaille=Math.min(this.GetTaille(),aDomaine.GetTaille());var lIntersect=new TypeDomaine(null,lTaille);for(var I=1;I<=lTaille;I++)
if(this.GetValeur(I)&&aDomaine.GetValeur(I))
lIntersect.SetValeur(true,I);return lIntersect;};TypeDomaine.prototype.getInversion=function(){var lTaille=this.GetTaille();var lInversion=new TypeDomaine(null,lTaille);for(var I=1;I<=lTaille;I++)
lInversion.SetValeur(!this.GetValeur(I),I);return lInversion;};TypeDomaine.prototype.getDomaineSoustraction=function(aDomaineASoustraire){var lDomaine=MethodesObjet.dupliquer(this);if(!aDomaineASoustraire) return lDomaine;for(var I=1;I<=aDomaineASoustraire.GetTaille();I++)
if(aDomaineASoustraire.GetValeur(I))
lDomaine.SetValeur(false,I);return lDomaine;};TypeDomaine.prototype.getDomaineUnion=function(aDomaineAAjouter){var lDomaine=MethodesObjet.dupliquer(this);if(!aDomaineAAjouter) return lDomaine;for(var I=1,lTaille=aDomaineAAjouter.GetTaille();I<=lTaille;I++)
if(aDomaineAAjouter.GetValeur(I))
lDomaine.SetValeur(true,I);return lDomaine;};TypeDomaine.prototype.egal=function(aDomaine){if(!aDomaine) return false;for(var I=1;I<=this.GetTaille();I++)
if(this.GetValeur(I)!==aDomaine.GetValeur(I))
return false;return true;};TypeDomaine.prototype.getSemaines=function(){var lTaille=this.GetTaille(),lSemaines=[],I;for(I=1;I<=lTaille;I++){if(this.GetValeur(I)){lSemaines.push(I);}}
return lSemaines;};TypeDomaine.prototype.dupliquer=function(){var lDomaine=new TypeDomaine(null,this.nombreValeurs);lDomaine.Domaine=[].concat(this.Domaine);return lDomaine;};TypeDomaine.prototype.toJSON=function(){var lJSON={};lJSON[IE.ObjetJSON.const_champ_Type]=EGenreType.Domaine;lJSON[IE.ObjetJSON.const_champ_Valeur]=this.toString();return lJSON;};;
var GTraductions=new ObjetTraduction();function ObjetTraduction(){}(function(){ObjetTraduction.prototype.add=function(aNom,aValeur){try{var lNomDernierNoeud=aNom;var lObjet=this;if(aNom.indexOf('.')>0){var T=aNom.split('.');for(var J=0;J<T.length-1;J++){var lProp=aNom.split('.')[J];if(!lObjet[lProp])
lObjet[lProp]=new ObjetTraduction();lObjet=lObjet[lProp];}
if(T.length>0)
lNomDernierNoeud=aNom.split('.')[T.length-1];}
if(MethodesObjet.isString(lObjet)){alert('Erreur de traduction > '+lObjet+' (valeur : '+aValeur+') doit être ajouté en objet mais est déjà existant en chaine');return;}
var LValeur=aValeur||' ';if(LValeur){if(lObjet[lNomDernierNoeud]){if(IE.MethodesObjet.isString(lObjet[lNomDernierNoeud]))
lObjet[lNomDernierNoeud]=[lObjet[lNomDernierNoeud]];lObjet[lNomDernierNoeud].push(LValeur);}
else{lObjet[lNomDernierNoeud]=LValeur;}}} catch(e){alert('Erreur de traduction > '+aNom+' --> '+aValeur);}};ObjetTraduction.prototype.getValeur=function(aNom,aTableauRemplacements){var lValeur=IE.MethodesObjet.get(this,aNom);if(!lValeur){return lValeur||'';}
if(aTableauRemplacements){if(IE.MethodesObjet.isString(lValeur))
lValeur=GChaine.Format(lValeur,aTableauRemplacements);}
return lValeur;};ObjetTraduction.prototype.getTitreMFiche=function(aIdRessource){var lChaine=GTraductions.getValeur(aIdRessource);if(lChaine!==''){var lJson=IE.ObjetJSON.parse(lChaine);if(lJson&&lJson.titre){return lJson.titre;} else ;} else ;};ObjetTraduction.prototype._DEBUG_PasserEnCleDeTraductions=function(aChaine){};}());
var TypeGestionRenvoisImp={impRenvoisAucun:0,impRenvoisSousBloc:1,impRenvoisApresPage:2,impRenvoisCumulesALaFin:3};
var TypeHttpGenerationPDF={EDT:0,ReleveDeNotes:1,Bulletin:2,LivretScolaire:3,SuiviPluriAnnuel:4,ConvocationOral:5,Resultats:6,Trombinoscope:7,BulletinDeCompetences:8,FeuilleAppel:9,EquipePedagogique:10,ListeStagiaires:11,CertificatScolarite:12,ListeRessources:13,ResultatsQCM:14};
var TypeHttpNotificationDonnes={THND_ListeDocJointEtablissement:0,THND_ListeClasse:1,THND_ListeClasseNiveau:2,THND_ListeGroupe:3,THND_ListeProfesseur:4,THND_AutorisationProfesseur:5,THND_AutorisationPersonnel:6,THND_NombreDepotDocumentCasierNonLus:7,THND_NombreMessagesNonLus:8,THND_NombreActualitesNonLues:9};
var TypeGenreObservationVS={OVS_DefautCarnet:0,OVS_ObservationParent:1,OVS_Autres:2};
var TypeHttpPeriode={TPN_Aujourdhui:0,TPN_CyclePrecedent:1,TPN_CycleCourant:2,TPN_MoisCourant:3,TPN_Annee:4,TPN_Trimestres:5,TPN_Semestres:6,TPN_Continue:7,TPN_AuChoix:8,TPN_NonOfficielle:9,TPN_MoisAnnee:10};
var TypeGenreIndividuAuteur={GIA_Administratif:0,GIA_Inspecteur:1,GIA_Personnel:2,GIA_Professeur:3,GIA_ProfesseurHistorique:4,GIA_PersonnelHistorique:5,GIA_MaitreDeStage:6,GIA_Responsable:7,GIA_Eleve:8,GIA_Utilisateur:9};
var TypeGenreNotation={Aucun:0,Trimestrielle:1,Semestrielle:2,Annuelle:3,Multiple:4};
var TypeModeQuestionnaire={MQZ_NoteSans:0,MQZ_NoteDevoir:1,MQZ_NoteInformative:2};
var TypeModeCorrectionQCM={FBQ_CorrigeSans:0,FBQ_CorrigeApresQuestion:1,FBQ_CorrigeALaFin:2};
var TypeGenreExerciceDeQuestionnaire={GEQ_Inconnu:0,GEQ_SingleChoice:1,GEQ_MultiChoice:2,GEQ_TrueFalse:3,GEQ_NumericalAnswer:4,GEQ_ShortAnswer:5,GEQ_SpellAnswer:6,GEQ_Matching:7,GEQ_ClozeField:8,GEQ_ClozeFixed:9,GEQ_ClozeVariable:10,GEQ_Essay:11};
var TypeNumerotation={n123:0,nABC:1,NRoman:2};
var TypeGenreFichierBase64={tgfbDirect:0,tgfbImageQCM:1,tgfbSonQCM:2};
var TypeQualificatifReponse={qrBonne:0,qrBonnePartielle:1,qrFausse:2,qrSansReponse:3};
var TypeEtatExecutionQCMPourRepondant={EQR_EnCours:0,EQR_Termine:1,EQR_DureeMaxDepassee:2,EQR_ARefaire:3};
var TypeGenreEvenementVS={GEVS_DossierVS:0,GEVS_Stage:1,GEVS_SuiviStage:2,GEVS_Punition:3,GEVS_Sanction:4,GEVS_Dispense:5,GEVS_OrientationEleve:6,GEVS_AbsenceEleve:7,GEVS_Retard:8,GEVS_MemoEleve:9,GEVS_DossierMedical:10};
var TypeChoixComptabilisation={HeuresDeCours:0,DemiJBrutes:1,DemiJCalculees:2,DemiJBulletin:3};
var TypeGenreAppreciation={GA_Bulletin_Professeur:0,GA_Bulletin_Generale:1,GA_Bulletin_CPE:2,GA_Releve_Professeur:3,GA_Releve_Generale:4,GA_BilanAnnuel_Professeur:5,GA_BilanAnnuel_Generale:6,GA_Observations_Competences:7,GA_BulletinCompetence_Professeur:8,GA_BulletinCompetence_Generale:9,GA_BulletinCompetence_CPE:10};
var TypeServiceOAuth2={CS_Box:0,CS_DropBox:1,CS_GoogleDrive:2,CS_OneDrive:3};
var TTypeElementCloud={tec_Fichier:0,tec_Dossier:1};
var TypeStatutInterrogationCloud={sic_Inconnu:0,sic_OK:1,sic_TokenInvalide:2,sic_Timeout:3,sic_ArretApplication:4,sic_DossierTropGros:5};
var TypeGenreCumul={Cumul_Aucun:0,Cumul_Matiere:1,Cumul_Niveau:2};
var TypeArrierePlanAuthentification={Photo:0,Rebus:1,Neutre:2,Personnalise:3};
var TypeEtatPublication={PublieeDansDate:0,PublieeHorsDate:1,PasPubliee:2};
var TypeGenreReponseInternetActualite={AvecAR:0,Textuelle:1,ChoixUnique:2,ChoixMultiple:3,SansAR:4};
var TypeGenreInternetIndividu={InternetIndividu_Professeur:0,InternetIndividu_Personnel:1,InternetIndividu_Parent:2,InternetIndividu_ParentEleve:3,InternetIndividu_Eleve:4,InternetIndividu_MaitreDeStage:5,InternetIndividu_MaitreDeStageEleve:6,InternetIndividu_Inspecteur:7};
var TypeOptionGenerationMotDePasse={OGMDP_AvecAuMoinsUneLettre:0,OGMDP_AvecAuMoinsUnChiffre:1,OGMDP_AvecAuMoinsUnCaractereSpecial:2,OGMDP_AvecMelangeMinusculeMajuscule:3,OGMDP_AvecControleIdentifiantDifferent:4};
var TypeModeGrillesEDT={TMG_CycleHebdomadaire:0,TMG_CycleAvecferies:1,TMG_CycleSansFeries:2};
var TypeOptionMaquetteLivretScolaireStandard={OMLST_AvecMoyenneAnnuelle:0,OMLST_AvecAppreciationsParPeriode:1,OMLST_AvecMoyenneGenerale:2,OMLST_AvecRangEleve:3,OMLST_AvecMoyenneEleve:4,OMLST_AvecMoyenneClasse:5,OMLST_AvecRepartitionMoyenne:6,OMLST_AvecAppreciation:7};
var TypeAvisCommentaire={tac_ChefEtablissement:0,tac_Engagement:1,tac_Investissement:2};
IE.Enum.c_constantesJSON={noeudJSON:"D",Signature:"_Signature_",SignatureAttente:"_SignatureAttente_",Donnees:"donnees"};
GTraductions.add("principal.fermer", "Fermer");
GTraductions.add("principal.oui", "Oui");
GTraductions.add("principal.non", "Non");
GTraductions.add("principal.annuler", "Annuler");
GTraductions.add("principal.affecter", "Affecter");
GTraductions.add("liste.doublon", "Ce nom est déjà dans la liste !");
GTraductions.add("liste.creationImpossible", "Création impossible");
GTraductions.add("liste.editionImpossible", "Edition impossible");
GTraductions.add("liste.suppressionImpossible", "Suppression impossible");
GTraductions.add("liste.suppressionSelection", "Voulez-vous supprimer la sélection ?");
GTraductions.add("liste.erreurDate", "La date doit être de la forme dd/mm/aaaa");
GTraductions.add("liste.tailleMaxSaisie", "Vous avez atteint la taille maximale possible.");
GTraductions.add("liste.creer", "Créer");
GTraductions.add("liste.modifier", "Modifier");
GTraductions.add("liste.supprimer", "Supprimer");
GTraductions.add("liste.premierePage", "Première page");
GTraductions.add("liste.pagePrecedente", "Page précédente");
GTraductions.add("liste.pageSuivante", "Page suivante");
GTraductions.add("liste.dernierePage", "Dernière page");
GTraductions.add("liste.numerotationPage", "Page #1 / #2");
GTraductions.add("liste.nouveau", "Nouveau");
GTraductions.add("liste.tri", "Tri");
GTraductions.add("liste.toutCocher", "Tout cocher");
GTraductions.add("liste.toutDecocher", "Tout décocher");
GTraductions.add("fenetre.SaisieValide", "Votre saisie sera validée automatiquement");
GTraductions.add("fenetre.Aucune", "Aucune");
GTraductions.add("fenetreImpression.MessageAlerteImpression", "Attention ! Les données qui seront imprimées n'ont pas toutes été validées. Voulez-vous continuer ?");
GTraductions.add("fenetreImpression.MessageAlerteSurImpression", "Attention ! Lors de l'impression certaines des données saisies n'étaient pas validées.");
GTraductions.add("fenetreImpression.FormatDImpression", "Format d'impression");
GTraductions.add("fenetreImpression.GrandFormat", "Grand format");
GTraductions.add("fenetreImpression.MoyenFormat", "Moyen format");
GTraductions.add("fenetreImpression.PetitFormat", "Petit format");
GTraductions.add("fenetreImpression.TresPetitFormat", "Très petit format");
GTraductions.add("calendrier.ferieAbr", "F");
GTraductions.add("GenerationPDF.MessageAlerteGenerationPdf", "Attention ! Les données non validées seront ignorées. Voulez-vous continuer ?");
GTraductions.add("GenerationPDF.Generer", "Générer");
GTraductions.add("GenerationPDF.TitreCommande", "Générer un PDF");
GTraductions.add("GenerationPDF.Titre", "Options de génération du PDF");
GTraductions.add("GenerationPDF.Orientation", "Orientation");
GTraductions.add("GenerationPDF.Portrait", "Portrait");
GTraductions.add("GenerationPDF.Paysage", "Paysage");
GTraductions.add("GenerationPDF.TaillePoliceSouhaitee", "Souhaitée");
GTraductions.add("GenerationPDF.TaillePoliceMinAutorisee", "Minimale autorisée");
GTraductions.add("GenerationPDF.EDT.TaillePoliceCours", "Taille de police dans les cours");
GTraductions.add("GenerationPDF.EDT.CouleurCours", "Couleur des cours");
GTraductions.add("GenerationPDF.EDT.Aucune", "Aucune");
GTraductions.add("GenerationPDF.EDT.FondCouleur", "Fond en couleur");
GTraductions.add("GenerationPDF.EDT.TexteCouleur", "Texte en couleur");
GTraductions.add("GenerationPDF.EDT.AucunRenvoi", "Aucun renvoi");
GTraductions.add("GenerationPDF.EDT.Renvois", "Renvois");
GTraductions.add("GenerationPDF.EDT.RenvoiSousChaqueGrille", "Sous la grille (max. 3 lignes)");
GTraductions.add("GenerationPDF.EDT.RenvoiApresChaquePage", "Sur une nouvelle page");
GTraductions.add("GenerationPDF.EDT.RenvoiRegroupeFin", "Regroupés à la fin");
GTraductions.add("GenerationPDF.EDT.Agencement", "Agencement");
GTraductions.add("GenerationPDF.EDT.GrilleDomaine", "1 grille pour toutes les semaines");
GTraductions.add("GenerationPDF.EDT.GrilleParSemaine", "1 grille par semaine");
GTraductions.add("GenerationPDF.ReleveNotes.TaillePoliceNotes", "Taille de police pour les notes");
GTraductions.add("GenerationPDF.ReleveNotes.TaillePolicePied", "Taille de police pour les appréciations et le pied");
GTraductions.add("GenerationPDF.ReleveNotes.HauteurService", "Hauteur d'un service");
GTraductions.add("GenerationPDF.ReleveNotes.Minimum", "Minimum");
GTraductions.add("GenerationPDF.ReleveNotes.Maximum", "Maximum");
GTraductions.add("GenerationPDF.ReleveNotes.AdapterHauteurApp", "Adapter la hauteur aux appréciations");
GTraductions.add("GenerationPDF.Lien.TitreLienPDF", "Le PDF a été généré");
GTraductions.add("GenerationPDF.Lien.LienValidePendant", "Ce lien est valide pendant %s secondes");
GTraductions.add("GenerationPDF.Lien.CliquerIci", "Cliquer ici pour ouvrir le PDF");
GTraductions.add("WAI.ScrollHorizontal", "Barre de défilement horizontal");
GTraductions.add("WAI.ScrollVertical", "Barre de défilement vertical");
GTraductions.add("Navigation.Aide", "Informations concernant l'accessibilité du site et la navigation clavier. ");
GTraductions.add("Navigation.Tableau", "Utilisez les flèches haut, bas, gauche et droite pour naviguer. ");
GTraductions.add("Navigation.AvecValidation", "Validez votre choix avec les touches Entrée ou Barre espace. ");
GTraductions.add("Navigation.BarreOnglets", "Barre d'onglets : ");
GTraductions.add("Navigation.NavigationHorizontal", "Utilisez les flèches gauche et droite pour naviguer. ");
GTraductions.add("Navigation.NavigationVertical", "Utilisez les flèches haut et bas pour naviguer. ");
GTraductions.add("Navigation.NavigationHorizontalAvecValidation", "Utilisez les flèches gauche et droite pour naviguer et la barre espace ou entrée pour valider. ");
GTraductions.add("Navigation.NavigationVerticalAvecValidation", "Utilisez les flèches haut et bas pour naviguer et la barre espace ou entrée pour valider. ");
GTraductions.add("Navigation.CalendrierNavigation", "Pour sélectionner la semaine précédente ou suivante, ");
GTraductions.add("Navigation.CalendrierPrecedent", "Sélectionnez la semaine précédente. ");
GTraductions.add("Navigation.CalendrierSuivant", "Sélectionnez la semaine suivante. ");
GTraductions.add("Navigation.ValidezEvenement", "les touches Entrée ou Barre espace pour consulter les détails de l'évènement. ");
GTraductions.add("Navigation.TitreDetailEvenement", "Détails des évènements pour la période sélectionnée : ");
GTraductions.add("Navigation.MenuContextuel", "Menu contextuel : ");
GTraductions.add("Navigation.NavigationMenuContextuel", "Utilisez les flèches haut et bas pour naviguer, la barre espace ou entrée pour valider et la touche échappe pour sortir sans sélectionner. ");
GTraductions.add("Navigation.ItemDesactiver", "Cet item est désactivé. ");
GTraductions.add("Navigation.AvecEdition", "Activez l'édition avec les touches majuscule + entrée. ");
GTraductions.add("Navigation.Tabulation", "Utilisez les touches tabulation ou majuscule + tabulation pour naviguer entre les éléments. ");
GTraductions.add("Navigation.Supprimer", "Supprimez la sélection avec la touche Suppr. ");
GTraductions.add("Navigation.Fenetre", "Nouvelle fenêtre, ");
GTraductions.add("Navigation.NouvelElement", "Pour ajouter un nouvel élément, ");
GTraductions.add("Navigation.BarreOngletsPrincipal", "menu déroulant, Sélection des onglets et sous-onglets. Utilisez les flèches haut et bas pour naviguer dans un niveau, gauche et droite pour changer de niveau, barre espace ou entrée pour valider, échappe pour fermer le menu. ");
GTraductions.add("Navigation.SousOnglets", "sous menu, ");
GTraductions.add("Navigation.RetourDebutFenetre", "Retour en début de fenêtre, ");
GTraductions.add("Navigation.FenetreChoix", "Utilisez la touche entrée ou flèche bas pour ouvrir la fenêtre de choix");
GTraductions.add("Navigation.AideRaccourcisClavier", "Pour utiliser les raccourcis clavier, appuyez simultanément sur les touches Controle + Shift + Alt + un des chiffres de la partie supérieure du clavier (pas le pavé numérique). ");
GTraductions.add("Navigation.AideRaccourcisClavierDetails", "Menu: Controle+Shift+Alt+ 0, Commande: Controle+Shift+Alt+ 1, Contenu: Controle+Shift+Alt+ 2, Déconnexion: Controle+Shift+Alt+ 9");
GTraductions.add("WAI.AucuneDonnee", "Aucune donnée");
GTraductions.add("WAI.FermerFiche", "Fermer la fiche");
GTraductions.add("WAI.FicheCours", "Ouverture de la fiche de cours");
GTraductions.add("WAI.ListeSelectionCategorie", "Liste déroulante : sélectionnez une catégorie.");
GTraductions.add("WAI.ZoneDImpression", "Zone d'impression");
GTraductions.add("WAI.Sur", "sur");
GTraductions.add("SaisieQCM.Libelle", "Libellé");
GTraductions.add("SaisieQCM.Matiere", "Matière");
GTraductions.add("SaisieQCM.Niveau", "Niveau");
GTraductions.add("SaisieQCM.Proprios", "Propriétaires");
GTraductions.add("SaisieQCM.HintNiveau", "Le niveau est pris en compte pour l'organisation des QCM dans la bibliothèque");
GTraductions.add("SaisieQCM.HintMatiere", "La matière est prise en compte pour l'organisation des QCM dans la bibliothèque");
GTraductions.add("SaisieQCM.HintLibelle", "Ce nom sera également utilisé dans la bibliothèque");
GTraductions.add("SaisieQCM.HintBibliotheque", "Signale la présence dans la bibliothèque de l'établissement pour le partager aux autres enseignants");
GTraductions.add("SaisieQCM.LigneNouveauQCM", "Créer un nouveau QCM");
GTraductions.add("SaisieQCM.UniquementMatieresEnseignees", "Uniquement les matières enseignées");
GTraductions.add("SaisieQCM.SelectionnerUnQCM", "Sélectionner un QCM");
GTraductions.add("SaisieQCM.LigneNouvelleQuestion", "Ajouter une question");
GTraductions.add("SaisieQCM.copieqcm.ok", "Le QCM  a été copié avec succès.");
GTraductions.add("SaisieQCM.copieqcm.ko", "Une erreur s'est produite lors de la copie du QCM");
GTraductions.add("SaisieQCM.copiequest.ok", "Les questions ont été copiées avec succès.");
GTraductions.add("SaisieQCM.copiequest.ko", "Une erreur s'est produite lors de la copie des questions.");
GTraductions.add("SaisieQCM.TitreQCM", "%s - %d questions - total de points %d");
GTraductions.add("SaisieQCM.TitreQCMQSoumises", "%s - %d questions / %d - total de points %d");
GTraductions.add("SaisieQCM.InfoQCMSelection", "%d questions - noté sur %d");
GTraductions.add("SaisieQCM.NbQuestions", "%d questions");
GTraductions.add("SaisieQCM.DureeExec", "durée %d min");
GTraductions.add("SaisieQCM.InfoPreCreationTrou", "Création des trous : ");
GTraductions.add("SaisieQCM.InfoPreSuppressionTrou", "Suppression des trous : ");
GTraductions.add("SaisieQCM.InfoPreEditerTrou", "Edition des réponses : ");
GTraductions.add("SaisieQCM.InfoSelectClic", "sélectionnez le texte concerné et cliquez sur le bouton");
GTraductions.add("SaisieQCM.InfoCadrePointilleClic", "placez votre curseur dans le cadre en pointillés qui symbolise le trou et cliquez sur le bouton");
GTraductions.add("SaisieQCM.InfoEditionSupprimer", "cliquez sur le bouton « Supprimer » dans la fenêtre d'édition des réponses proposées");
GTraductions.add("SaisieQCM.HintBonneReponseSingle", "Indique la bonne réponse");
GTraductions.add("SaisieQCM.HintBonnesReponsesMulti", "Indique les bonnes réponses");
GTraductions.add("SaisieQCM.HintMediaReponses", "Média liés aux réponses");
GTraductions.add("SaisieQCM.HintElementsB", "Liste des choix attendus en face des éléments A");
GTraductions.add("SaisieQCM.HintReponsesShortAnswer", "Indique les bonnes réponses. Seule une réponse sera acceptée");
GTraductions.add("SaisieQCM.SaisieQuestions", "Saisie des questions");
GTraductions.add("SaisieQCM.SaisieModaliteExe", "Modalités d'exécution");
GTraductions.add("SaisieQCM.SaisieResultats", "Résultats");
GTraductions.add("SaisieQCM.AjouterImage", "Choisir une image qui sera affichée avec l'énoncé de la question");
GTraductions.add("SaisieQCM.SupprimerImage", "Retirer l'image de l'énoncé de la question");
GTraductions.add("SaisieQCM.BaremeQCMMax", "Vous avez atteint le barème max d'un QCM fixé à %d");
GTraductions.add("SaisieQCM.ValiderPourVisu", "Valider votre saisie pour avoir la visualisation");
GTraductions.add("SaisieQCM.AjouterSon", "Choisir un son qui sera associé à l'énoncé de la question");
GTraductions.add("SaisieQCM.SupprimerSon", "Souhaitez-vous supprimer ce son ?");
GTraductions.add("SaisieQCM.EditeurReponse", "Edition avancée d'une réponse");
GTraductions.add("SaisieQCM.ActiverEditionAvancee", "Activer la mise en forme des réponses");
GTraductions.add("SaisieQCM.CreerDevoir", "Associer le QCM à un nouveau devoir");
GTraductions.add("SaisieQCM.EditionAvanceePerteDonnee", "Souhaitez-vous vraiment convertir la mise en forme des réponses déjà saisies ? Des données peuvent être perdues !");
GTraductions.add("SaisieQCM.MiseEnFormeDesReponses", "Avec mise en forme");
GTraductions.add("SaisieQCM.SansMiseEnFormeDesReponses", "Sans mise en forme");
GTraductions.add("SaisieQCM.TexteAnnulerNote", "Définir la nouvelle date de disponibilité de l'iDevoir");
GTraductions.add("SaisieQCM.ConfirmDeleteExeQCM", "Etes-vous sûr de vouloir supprimer cette exécution QCM ? Les résultats, devoirs et contenus associés seront effacés !");
GTraductions.add("SaisieQCM.SupprimerImageReponse", "Supprimer l'image");
GTraductions.add("SaisieQCM.VoirCorrigeQCM", "Afficher le corrigé");
GTraductions.add("SaisieQCM.MFicheTypeDeQuestions", '{"titre":" Les différents types de questions","html":{"_T":23,"V":"<div><em><strong><span style=\\\"font-family: Arial; font-size: 12px;\\\">Choix unique : </span></strong></em><span style=\\\"font-family: Arial; font-size: 12px;\\\">une seule bonne r&eacute;ponse &agrave; retrouver parmi les choix propos&eacute;s.</span></div><div style=\\\"font-family: Arial; font-size: 13px;\\\"><span style=\\\"font-family: Arial; font-size: 12px;\\\">&nbsp;</span></div><div><em><strong><span style=\\\"font-family: Arial; font-size: 12px;\\\">Choix multiple :</span></strong></em><span style=\\\"font-family: Arial; font-size: 12px;\\\"> plusieurs bonnes r&eacute;ponses &agrave; retrouver parmi les choix propos&eacute;s.</span></div><div>&nbsp;</div><div><em><strong><span style=\\\"font-family: Arial; font-size: 12px;\\\">Valeur num&eacute;rique :</span></strong></em><span style=\\\"font-family: Arial; font-size: 12px;\\\"> une ou plusieurs bonnes r&eacute;ponses sont r&eacute;dig&eacute;es dans un format num&eacute;rique, une d\'elles doit &ecirc;tre saisie dans une zone de texte. La r&eacute;ponse de l\'&eacute;l&egrave;ve est prise en compte ind&eacute;pendamment &nbsp;des s&eacute;parateurs num&eacute;riques et des espaces.</span></div><div style=\\\"font-family: Arial; font-size: 13px;\\\"><em><strong><span style=\\\"font-family: Arial; font-size: 12px;\\\">&nbsp;</span></strong></em></div><div><em><strong><span style=\\\"font-family: Arial; font-size: 12px;\\\">R&eacute;ponse &agrave; saisir :</span></strong></em><span style=\\\"font-family: Arial; font-size: 12px;\\\"> une ou plusieurs bonnes r&eacute;ponses sont r&eacute;dig&eacute;es, une d\'elles doit &ecirc;tre saisie dans une zone de texte. Une option permet de pr&eacute;ciser si les majuscules et accents doivent &ecirc;tre pris en compte.</span></div><div style=\\\"font-family: Arial; font-size: 13px;\\\"><span style=\\\"font-family: Arial; font-size: 12px;\\\">&nbsp;</span></div><div><em><strong><span style=\\\"font-family: Arial; font-size: 12px;\\\">Epellation :</span></strong></em><span style=\\\"font-family: Arial; font-size: 12px;\\\"> Une seule bonne r&eacute;ponse &agrave; &eacute;peler lettre par lettre. Une option permet de pr&eacute;ciser si les majuscules et accents doivent &ecirc;tre pris en compte.</span></div><div style=\\\"font-family: Arial; font-size: 13px;\\\"><span style=\\\"font-family: Arial; font-size: 12px;\\\">&nbsp;</span></div><div><em><strong><span style=\\\"font-family: Arial; font-size: 12px;\\\">Association : </span></strong></em><span style=\\\"font-family: Arial; font-size: 12px;\\\">diff&eacute;rentes associations de 2 &eacute;l&eacute;ments doivent &ecirc;tre reform&eacute;es.</span></div><div style=\\\"font-family: Arial; font-size: 13px;\\\"><span style=\\\"font-family: Arial; font-size: 12px;\\\">&nbsp;</span></div><div><em><strong><span style=\\\"font-family: Arial; font-size: 12px;\\\">Texte &agrave; trous : </span></strong></em><span style=\\\"font-family: Arial; font-size: 12px;\\\">un texte est r&eacute;dig&eacute; et certains mots sont occult&eacute;s</span></div><div><em><em><strong><span style=\\\"font-family: Arial; font-size: 12px;\\\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></strong></em></em><div><em><strong><span style=\\\"font-family: Arial; font-size: 12px;\\\">Texte &agrave; trous : </span></strong></em><span style=\\\"font-family: Arial; font-size: 12px;\\\">un texte est r&eacute;dig&eacute; et certains mots sont occult&eacute;s</span></div><div><em><strong><span style=\\\"font-family: Arial; font-size: 12px;\\\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- R&eacute;ponse libre : </span></strong></em><span style=\\\"font-family: Arial; font-size: 12px;\\\">les bonnes r&eacute;ponses doivent &ecirc;tre saisies (aucune indication n\'est donn&eacute;e).</span></div><div><em><strong><span style=\\\"font-family: Arial; font-size: 12px;\\\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- Liste unique :</span></strong></em><span style=\\\"font-family: Arial; font-size: 12px;\\\">&nbsp;les bonnes r&eacute;ponses sont choisies dans une liste commune &agrave; tous les trous.</span></div><div><span style=\\\"font-family: Arial; font-size: 12px;\\\">&nbsp;&nbsp;&nbsp;&nbsp;</span><em><strong><span style=\\\"font-family: Arial; font-size: 12px;\\\">&nbsp;- Liste variable : </span></strong></em><span style=\\\"font-family: Arial; font-size: 12px;\\\">les bonnes r&eacute;ponses sont choisies dans une liste sp&eacute;cifique &agrave; chaque trou.</span></div></div>"},"width":575,"height":286,"type":4,"boutons":{"_T":18,"V":1024}}');
GTraductions.add("QCM_Divers.Bareme", "Barème");
GTraductions.add("QCM_Divers.AuMoinsDeuxAssociations", "Vous devez saisir au moins deux associations");
GTraductions.add("QCM_Divers.AuMoinsDeuxPropositions", "Vous devez faire au moins deux propositions");
GTraductions.add("QCM_Divers.AuMoinsDeuxTrous", "Vous devez définir au moins 2 trous pour constituer la liste");
GTraductions.add("QCM_Divers.AuMoinsUneReponse", "Vous devez saisir au moins une réponse");
GTraductions.add("QCM_Divers.AuMoinsUnTrou", "Vous devez définir au moins un trou");
GTraductions.add("QCM_Divers.AuMoinsUneBonneReponse", "Vous devez définir au moins une bonne réponse");
GTraductions.add("QCM_Divers.IlManqueLaBonneReponse", "Vous devez définir la bonne réponse");
GTraductions.add("QCM_Divers.DupliquerQCM", "Dupliquer un QCM");
GTraductions.add("QCM_Divers.ImportQCMs", "Importer des QCM");
GTraductions.add("QCM_Divers.MnuImportQCMBiblioEtablissement", "de la bibliothèque établissement");
GTraductions.add("QCM_Divers.Enonce", "Enoncé");
GTraductions.add("QCM_Divers.ApercuQuestion", "Simuler");
GTraductions.add("QCM_Divers.TitreSaisieQuestion", "Edition d'une question \"%s\"");
GTraductions.add("QCM_Divers.ReponsesProposees", "Réponses proposées");
GTraductions.add("QCM_Divers.Image", "Image");
GTraductions.add("QCM_Divers.CommentaireFacultatif", "Commentaire facultatif");
GTraductions.add("QCM_Divers.LigneNouvelleReponse", "Proposer une réponse");
GTraductions.add("QCM_Divers.BonnesReponsesPossibles", "Bonnes réponses possibles");
GTraductions.add("QCM_Divers.BonneReponse", "Bonne réponse");
GTraductions.add("QCM_Divers.LigneBonneReponse", "Ajouter une bonne réponse possible");
GTraductions.add("QCM_Divers.ElementsA", "Eléments A");
GTraductions.add("QCM_Divers.ElementsB", "Eléments B");
GTraductions.add("QCM_Divers.LigneCreerAssociation", "Créer une association");
GTraductions.add("QCM_Divers.Intitule", "Intitulé");
GTraductions.add("QCM_Divers.InfoReponseEpellation", "A l'exécution les lettres seront remplacées par un nombre égal de traits");
GTraductions.add("QCM_Divers.InfoReponseReponseCourte2", "Seule la 1ère bonne réponse sera affichée dans le corrigé.");
GTraductions.add("QCM_Divers.GenreExerciceChoixUnique", "Choix unique");
GTraductions.add("QCM_Divers.GenreExerciceChoixMultiple", "Choix multiple");
GTraductions.add("QCM_Divers.GenreExerciceReponseASaisir", "Réponse à saisir - Texte");
GTraductions.add("QCM_Divers.GenreExerciceReponseNumerique", "Réponse à saisir - Numérique");
GTraductions.add("QCM_Divers.GenreExerciceAssociation", "Association");
GTraductions.add("QCM_Divers.GenreExerciceClozeField", "Texte à trous - réponse libre");
GTraductions.add("QCM_Divers.GenreExerciceClozeFixed", "Texte à trous - liste unique");
GTraductions.add("QCM_Divers.GenreExerciceClozeVariable", "Texte à trous - liste variable");
GTraductions.add("QCM_Divers.GenreExerciceEpellation", "Epellation");
GTraductions.add("QCM_Divers.UpdateQuestion", "Modifier la question");
GTraductions.add("QCM_Divers.ReponseAEpeler", "Réponse à épeler");
GTraductions.add("QCM_Divers.EnSavoirPlus", "En savoir plus...");
GTraductions.add("QCM_Divers.A", "à");
GTraductions.add("QCM_Divers.DispoDu", "Disponible du");
GTraductions.add("QCM_Divers.Au", "au");
GTraductions.add("QCM_Divers.UpdateBareme", "Modifier le barème");
GTraductions.add("QCM_Divers.NouvelleQuestion", "Nouvelle question");
GTraductions.add("QCM_Divers.DuplicateQuestion", "Dupliquer la sélection");
GTraductions.add("QCM_Divers.DeleteQuestion", "Retirer la question du QCM");
GTraductions.add("QCM_Divers.DeleteQuestions", "Retirer les questions du QCM");
GTraductions.add("QCM_Divers.ToutDeployer", "Déployer toutes les questions");
GTraductions.add("QCM_Divers.ToutReduire", "Réduire toutes les questions");
GTraductions.add("QCM_Divers.CopieDe", "Copie de %s");
GTraductions.add("QCM_Divers.ConfirmDeleteQuestion", "Etes-vous sûr de vouloir retirer cette question du QCM ?");
GTraductions.add("QCM_Divers.ExporterQCM", "Exporter le QCM");
GTraductions.add("QCM_Divers.reponduSur", "%d répondus / %d");
GTraductions.add("QCM_Divers.DevoirDu", "du %s");
GTraductions.add("QCM_Divers.CopierQCM", "Copier dans \"Mes QCM\"");
GTraductions.add("QCM_Divers.CopierQuestion", "Copier les questions dans \"Mes QCM\"");
GTraductions.add("QCM_Divers.notes", "Notes");
GTraductions.add("QCM_Divers.pts", "/%d ");
GTraductions.add("QCM_Divers.temps", "Temps");
GTraductions.add("QCM_Divers.questions", "%d questions");
GTraductions.add("QCM_Divers.quest", "Q");
GTraductions.add("QCM_Divers.xPts", "%d pts");
GTraductions.add("QCM_Divers.min", "/%d min");
GTraductions.add("QCM_Divers.totalResultats", "Total de bonnes réponses : ");
GTraductions.add("QCM_Divers.totalResultats", "Total de réponses partielles : ");
GTraductions.add("QCM_Divers.totalResultats", "Total de mauvaises réponses : ");
GTraductions.add("QCM_Divers.totalResultats", "Total de sans réponses : ");
GTraductions.add("QCM_Divers.TitrePDF_ResultatsQCM", "Résultats de QCM");
GTraductions.add("FenetreParamExecutionQCM.DiffusionCorriges", "Diffusion des corrigés");
GTraductions.add("FenetreParamExecutionQCM.CorrigeSans", "Sans corrigé");
GTraductions.add("FenetreParamExecutionQCM.CorrigeApresChaqueQuestion", "Corrigé à chaque question");
GTraductions.add("FenetreParamExecutionQCM.CorrigeALaFin", "Corrigé à la fin");
GTraductions.add("FenetreParamExecutionQCM.ToutesLesQuestions", "Toutes les questions");
GTraductions.add("FenetreParamExecutionQCM.SeulementQuestions", "Seulement");
GTraductions.add("FenetreParamExecutionQCM.PresentationInterdirNavigation", "Autoriser le retour aux questions précédentes");
GTraductions.add("FenetreParamExecutionQCM.OrdreReponseAleatoire", "Mélanger l'ordre des réponses proposées");
GTraductions.add("FenetreParamExecutionQCM.LimiterTempsQuestionnaire", "Limiter le temps de réponse à");
GTraductions.add("FenetreParamExecutionQCM.Minutes", "minutes");
GTraductions.add("FenetreParamExecutionQCM.PresentationQuestions", "Présentation des questions");
GTraductions.add("FenetreParamExecutionQCM.Assouplissement", "Règles d'assouplissement pour la correction des questions à choix multiples");
GTraductions.add("FenetreParamExecutionQCM.acceptIncomplet", "Accepter les bonnes réponses incomplètes quand aucune réponse fausse n'est donnée simultanément");
GTraductions.add("FenetreParamExecutionQCM.msgBareme", "Cette option n'est disponible que quand toutes les questions ont le même nombre de points");
GTraductions.add("FenetreParamExecutionQCM.NotationSans", "Sans note");
GTraductions.add("FenetreParamExecutionQCM.NotationInformative", "Note à titre informatif (non comptabilisée dans la moyenne)");
GTraductions.add("FenetreParamExecutionQCM.NotationDevoir", "Note associée à un devoir (comptabilisée dans la moyenne)");
GTraductions.add("FenetreParamExecutionQCM.NotationTitre", "Notation");
GTraductions.add("FenetreParamExecutionQCM.Questions", "questions");
GTraductions.add("FenetreDevoir.SelectionnerUnQCM", "Sélectionner un QCM");
GTraductions.add("FenetreDevoir.ListeQCMTitre", "Liste des QCM");
GTraductions.add("FenetreDevoir.ParametresExeQCMDevoir", "Modalités d'exécution de l'iDevoir");
GTraductions.add("FenetreDevoir.AssocierAUnQCM", "Associer un QCM");
GTraductions.add("FenetreDevoir.AssocieAUnQCM", "QCM associé");
GTraductions.add("Notes.SelectionnerPeriode", "Sélectionner une période");
GTraductions.add("accueil.executionsQCM", "Prochains iDevoirs");
GTraductions.add("accueil.AucuneExecutionsQCM", "Aucun iDevoir programmé");
GTraductions.add("Numerotation.NumerotationArabe", "1, 2, 3...");
GTraductions.add("Numerotation.NumerotationABC", "A, B, C...");
GTraductions.add("Numerotation.NumerotationRomaine", "I, II, III...");
GTraductions.add("connexion.ErreurConnexionInterrompue", "Connexion interrompue !");
GTraductions.add("connexion.Deconnecter", "Vous avez été déconnecté");
GTraductions.add("connexion.SeConnecter", "Se connecter");
GTraductions.add("connexion.PageIndisponible", "La page que vous recherchez est actuellement indisponible ou inexistante.");
GTraductions.add("connexion.AffichagePageImpossible", "Impossible d'afficher la page");
GTraductions.add("connexion.Erreur", "Erreur");
GTraductions.add("connexion.DeconnexionEnCours", "Déconnexion en cours");
GTraductions.add("connexion.DeconnexionSaisieNonValidee", "Vous n'avez pas validé votre saisie.");
GTraductions.add("connexion.ConfirmezDeconnexion", "Confirmez-vous la déconnexion ?");
GTraductions.add("connexion.MessageVeuillezPatienter", "Veuillez patienter...");
GTraductions.add("requete.validationEchec", "La validation a échoué.");
GTraductions.add("requete.erreur", "Une erreur s'est produite");
GTraductions.add("requete.validationEnCours", "Validation en cours");
GTraductions.add("requete.validationAutomatique", "Votre saisie sera validée automatiquement");
GTraductions.add("requete.VeuillezPatienter", "Veuillez patienter...");
GTraductions.add("requete.transfertPJ", "Transfert des pièces jointes");
GTraductions.add("date.separateurHeure", "h");
GTraductions.add("inputFile.echecSelection", "Le fichier sélectionné n'est pas valide. Il doit avoir l'extension %s");
GTraductions.add("inputFile.msgEchecTailleFichier", "La taille des documents joints est limitée à %s Ko.");
GTraductions.add("interface.SaisieNonValidee", "Attention, votre saisie n'est pas validée");
GTraductions.add("interface.SouhaitezVousValiderSaisie", "Souhaitez-vous valider votre saisie avant de poursuivre ?\nSi vous répondez Non, votre saisie sera définitivement perdue.");
GTraductions.add("genreBoiteMessage.Information", "Information");
GTraductions.add("genreBoiteMessage.Confirmation", "Confirmation");
GTraductions.add("upload_impossible_titre", "Envoi de fichier impossible");
GTraductions.add("upload_impossible_message", "Votre navigateur ne supporte pas l'envoi de fichier.");
GTraductions.add("Onglet.Libelle", "");
GTraductions.add("Onglet.Libelle", "");
GTraductions.add("Onglet.Libelle", "Communication");
GTraductions.add("Onglet.Libelle", "Notes");
GTraductions.add("Onglet.Libelle", "Bulletin");
GTraductions.add("Onglet.Libelle", "Vie\nscolaire");
GTraductions.add("Onglet.Libelle", "");
GTraductions.add("Onglet.Libelle", "Page d'accueil");
GTraductions.add("Onglet.Libelle", "Informations & sondages");
GTraductions.add("Onglet.Libelle", "Agenda");
GTraductions.add("Onglet.Libelle", "Menu de la cantine");
GTraductions.add("Onglet.Libelle", "Calendrier scolaire");
GTraductions.add("Onglet.Libelle", "Relevé de notes");
GTraductions.add("Onglet.Libelle", "Bulletin");
GTraductions.add("Onglet.Libelle", "Liste des orientations");
GTraductions.add("Onglet.Libelle", "Voeux et décisions");
GTraductions.add("Onglet.Libelle", "Emploi du temps");
GTraductions.add("Onglet.Libelle", "Cahier de textes");
GTraductions.add("Onglet.Libelle", "Remplacements");
GTraductions.add("Onglet.Libelle", "Absences, punitions ...");
GTraductions.add("Onglet.Libelle", "Dossiers de la vie scolaire");
GTraductions.add("Onglet.Libelle", "");
GTraductions.add("Onglet.Libelle", "Compte enfant");
GTraductions.add("Onglet.Libelle", "Saisie des notes");
GTraductions.add("Onglet.Libelle", "");
GTraductions.add("Onglet.Libelle", "Appréciations professeurs");
GTraductions.add("Onglet.Libelle", "");
GTraductions.add("Onglet.Libelle", "Appréciations générales");
GTraductions.add("Onglet.Libelle", "Mon cahier de textes");
GTraductions.add("Onglet.Libelle", "Feuille d'appel");
GTraductions.add("Onglet.Libelle", "Appréciations professeurs");
GTraductions.add("Onglet.Libelle", "");
GTraductions.add("Onglet.Libelle", "Options générales");
GTraductions.add("Onglet.Libelle", "");
GTraductions.add("Onglet.Libelle", "Fiche brevet");
GTraductions.add("Onglet.Libelle", "");
GTraductions.add("Onglet.Libelle", "Informations médicales");
GTraductions.add("Onglet.Libelle", "Equipe pédagogique");
GTraductions.add("Onglet.Libelle", "Graphique");
GTraductions.add("Onglet.Libelle", "Résultats");
GTraductions.add("Onglet.Libelle", "Orientations");
GTraductions.add("Onglet.Libelle", "Bulletin de la classe");
GTraductions.add("Onglet.Libelle", "Fiche de stage");
GTraductions.add("Onglet.Libelle", "Absences");
GTraductions.add("Onglet.Libelle", "Suivi pluriannuel");
GTraductions.add("Onglet.Libelle", "Relevé de compétences");
GTraductions.add("Onglet.Libelle", "");
GTraductions.add("Onglet.Libelle", "");
GTraductions.add("Onglet.Libelle", "");
GTraductions.add("Onglet.Libelle", "Compte");
GTraductions.add("Onglet.Libelle", "B2i");
GTraductions.add("Onglet.Libelle", "Validation du B2i");
GTraductions.add("Onglet.Libelle", "Stage");
GTraductions.add("Onglet.Libelle", "Saisie des appréciations");
GTraductions.add("Onglet.Libelle", "");
GTraductions.add("Onglet.Libelle", "Compétences");
GTraductions.add("Onglet.Libelle", "Saisie des évaluations");
GTraductions.add("Onglet.Libelle", "Brevet");
GTraductions.add("Onglet.Libelle", "Personnel de\nl'établissement");
GTraductions.add("Onglet.Libelle", "Emploi du temps");
GTraductions.add("Onglet.Libelle", "Emploi du temps");
GTraductions.add("Onglet.Libelle", "Cahier\nde textes");
GTraductions.add("Onglet.Libelle", "");
GTraductions.add("Onglet.Libelle", "");
GTraductions.add("Onglet.Libelle", "Tableau des moyennes par classe");
GTraductions.add("Onglet.Libelle", "Liste des évaluations");
GTraductions.add("Onglet.Libelle", "Administratif");
GTraductions.add("Onglet.Libelle", "Anciennes évaluations");
GTraductions.add("Onglet.Libelle", "Liste des punitions programmées");
GTraductions.add("Onglet.Libelle", "Mon entreprise");
GTraductions.add("Onglet.Libelle", "Bilan par classe");
GTraductions.add("Onglet.Libelle", "Définition");
GTraductions.add("Onglet.Libelle", "Liste des dispenses");
GTraductions.add("Onglet.Libelle", "Liste des absences et retards");
GTraductions.add("Onglet.Libelle", "Suivi des absences et retards");
GTraductions.add("Onglet.Libelle", "Via les progressions");
GTraductions.add("Onglet.Libelle", "");
GTraductions.add("Onglet.Libelle", "Trombinoscope");
GTraductions.add("Onglet.Libelle", "Carnet de correspondance");
GTraductions.add("Onglet.Libelle", "i-Manuels Nathan");
GTraductions.add("Onglet.Libelle", "");
GTraductions.add("Onglet.Libelle", "Emploi du temps");
GTraductions.add("Onglet.Libelle", "Trombinoscope");
GTraductions.add("Onglet.Libelle", "Livret scolaire");
GTraductions.add("Onglet.Libelle", "QCM");
GTraductions.add("Onglet.Libelle", "Mes QCM");
GTraductions.add("Onglet.Libelle", "Bibliothèque de l'établissement");
GTraductions.add("Onglet.Libelle", "Répondre aux iDevoirs");
GTraductions.add("Onglet.Libelle", "Travail à faire");
GTraductions.add("Onglet.Libelle", "Contenu des cours");
GTraductions.add("Onglet.Libelle", "Rencontres\nParents/Profs");
GTraductions.add("Onglet.Libelle", "Indisponibilités");
GTraductions.add("Onglet.Libelle", "Desiderata");
GTraductions.add("Onglet.Libelle", "Recherche des créneaux libres");
GTraductions.add("Onglet.Libelle", "Planning");
GTraductions.add("Onglet.Libelle", "QCM pour réviser");
GTraductions.add("Onglet.Libelle", "Bibliothèque de Nathan");
GTraductions.add("Onglet.Libelle", "Emploi du temps des professeurs");
GTraductions.add("Onglet.Libelle", "Offres de stage");
GTraductions.add("Onglet.Libelle", "Ressources pédagogiques");
GTraductions.add("Onglet.Libelle", "Bulletin");
GTraductions.add("Onglet.Libelle", "Offres de stage");
GTraductions.add("Onglet.Libelle", "Casier numérique");
GTraductions.add("Onglet.Libelle", "Documents déposés");
GTraductions.add("Onglet.Libelle", "Mon casier numérique");
GTraductions.add("Onglet.Libelle", "Liste des élèves");
GTraductions.add("Onglet.Libelle", "Classes/Groupes");
GTraductions.add("Onglet.Libelle", "Salles");
GTraductions.add("Onglet.Libelle", "Livret scolaire");
GTraductions.add("Onglet.Libelle", "Saisie des appréciations");
GTraductions.add("Onglet.Libelle", "Saisie des compétences");
GTraductions.add("Onglet.Libelle", "Profil");
GTraductions.add("Onglet.Libelle", "Evolution annuelle");
GTraductions.add("Onglet.Libelle", "Appel et suivi");
GTraductions.add("Onglet.Libelle", "Appel");
GTraductions.add("Onglet.Libelle", "Récapitulatif annuel");
GTraductions.add("Onglet.Libelle", "Liste détaillée");
GTraductions.add("Onglet.Libelle", "Heures manquées");
GTraductions.add("Onglet.Libelle", "En grille");
GTraductions.add("Onglet.Libelle", "En tableau");
GTraductions.add("Onglet.Libelle", "En liste");
GTraductions.add("Onglet.Libelle", "En grille");
GTraductions.add("Onglet.Libelle", "Relevé de notes");
GTraductions.add("Onglet.Libelle", "Liste des professeurs");
GTraductions.add("Onglet.Libelle", "Liste des classes");
GTraductions.add("Onglet.Libelle", "Liste des groupes");
GTraductions.add("Onglet.Libelle", "Liste des responsables");
GTraductions.add("Onglet.Libelle", "Liste des personnels");
GTraductions.add("Onglet.Libelle", "Elèves");
GTraductions.add("Onglet.Libelle", "Professeurs");
GTraductions.add("Onglet.Libelle", "Emploi du temps");
GTraductions.add("Onglet.Libelle", "Discussions");
GTraductions.add("Onglet.Libelle", "Messagerie");
GTraductions.add("Onglet.Libelle", "Bulletin de la classe");
GTraductions.add("Onglet.Libelle", "Emploi du temps des personnels");
GTraductions.add("Onglet.Libelle", "Incidents");
GTraductions.add("Onglet.Libelle", "Feuille d'appel - enseignants");
GTraductions.add("Onglet.Libelle", "Autorisations de sortie");
GTraductions.add("Onglet.Libelle", "Récapitulatif des absences, retards et passages à l'infirmerie");
GTraductions.add("Onglet.Libelle", "Récapitulatif des rubriques de la feuille d'appel");
GTraductions.add("Onglet.Libelle", "Récapitulatif Punitions Sanctions");
GTraductions.add("Onglet.Libelle", "Programmes officiels");
GTraductions.add("Onglet.Libelle", "Trombinoscope des professeurs");
GTraductions.add("Onglet.Libelle", "Trombinoscope des personnels");
GTraductions.add("Onglet.Libelle", "Paramètres");
GTraductions.add("Onglet.Libelle", "Liste des stagiaires");
GTraductions.add("Onglet.Libelle", "Cours non assurés");
GTraductions.add("Onglet.Libelle", "Personnels");
GTraductions.add("Onglet.Libelle", "Documents à télécharger");
GTraductions.add("Onglet.Libelle", "Progression");
GTraductions.add("Onglet.Libelle", "Bibliothèque de l'établissement");
GTraductions.add("Onglet.Libelle", "Saisie");
GTraductions.add("Onglet.Libelle", "Consultation");
GTraductions.add("Onglet.Libelle", "Documents");
GTraductions.add("Onglet.Libelle", "Liste des devoirs sur table");
GTraductions.add("Onglet.LibelleLong", "");
GTraductions.add("Onglet.LibelleLong", "");
GTraductions.add("Onglet.LibelleLong", "");
GTraductions.add("Onglet.LibelleLong", "");
GTraductions.add("Onglet.LibelleLong", "");
GTraductions.add("Onglet.LibelleLong", "");
GTraductions.add("Onglet.LibelleLong", "");
GTraductions.add("Onglet.LibelleLong", "Toutes les rubriques ...");
GTraductions.add("Onglet.LibelleLong", "Informations & sondages");
GTraductions.add("Onglet.LibelleLong", "Agenda de l'établissement");
GTraductions.add("Onglet.LibelleLong", "Menu de la cantine");
GTraductions.add("Onglet.LibelleLong", "Calendrier scolaire");
GTraductions.add("Onglet.LibelleLong", "Relevé de notes");
GTraductions.add("Onglet.LibelleLong", "Bulletin");
GTraductions.add("Onglet.LibelleLong", "Liste des orientations");
GTraductions.add("Onglet.LibelleLong", "Voeux et décisions d'orientation");
GTraductions.add("Onglet.LibelleLong", "Emploi du temps");
GTraductions.add("Onglet.LibelleLong", "Cahier de textes");
GTraductions.add("Onglet.LibelleLong", "Remplacements");
GTraductions.add("Onglet.LibelleLong", "Absences, punitions ...");
GTraductions.add("Onglet.LibelleLong", "Dossiers de la vie scolaire");
GTraductions.add("Onglet.LibelleLong", "");
GTraductions.add("Onglet.LibelleLong", "Compte enfant");
GTraductions.add("Onglet.LibelleLong", "Saisie des notes");
GTraductions.add("Onglet.LibelleLong", "");
GTraductions.add("Onglet.LibelleLong", "Appréciations professeurs du bulletin");
GTraductions.add("Onglet.LibelleLong", "");
GTraductions.add("Onglet.LibelleLong", "Appréciations générales du bulletin");
GTraductions.add("Onglet.LibelleLong", "");
GTraductions.add("Onglet.LibelleLong", "Feuille d'appel");
GTraductions.add("Onglet.LibelleLong", "Appréciations professeurs du relevé de notes");
GTraductions.add("Onglet.LibelleLong", "");
GTraductions.add("Onglet.LibelleLong", "");
GTraductions.add("Onglet.LibelleLong", "");
GTraductions.add("Onglet.LibelleLong", "Fiche brevet");
GTraductions.add("Onglet.LibelleLong", "");
GTraductions.add("Onglet.LibelleLong", "Informations médicales");
GTraductions.add("Onglet.LibelleLong", "Equipe pédagogique");
GTraductions.add("Onglet.LibelleLong", "Graphique");
GTraductions.add("Onglet.LibelleLong", "");
GTraductions.add("Onglet.LibelleLong", "");
GTraductions.add("Onglet.LibelleLong", "Bulletin de la classe");
GTraductions.add("Onglet.LibelleLong", "Fiche de stage");
GTraductions.add("Onglet.LibelleLong", "");
GTraductions.add("Onglet.LibelleLong", "Suivi pluriannuel");
GTraductions.add("Onglet.LibelleLong", "Relevé de compétences");
GTraductions.add("Onglet.LibelleLong", "");
GTraductions.add("Onglet.LibelleLong", "");
GTraductions.add("Onglet.LibelleLong", "");
GTraductions.add("Onglet.LibelleLong", "Mon compte");
GTraductions.add("Onglet.LibelleLong", "B2i");
GTraductions.add("Onglet.LibelleLong", "Validation du B2i");
GTraductions.add("Onglet.LibelleLong", "");
GTraductions.add("Onglet.LibelleLong", "Appréciations de la fiche brevet");
GTraductions.add("Onglet.LibelleLong", "");
GTraductions.add("Onglet.LibelleLong", "");
GTraductions.add("Onglet.LibelleLong", "Saisie des évaluations de compétences");
GTraductions.add("Onglet.LibelleLong", "");
GTraductions.add("Onglet.LibelleLong", "");
GTraductions.add("Onglet.LibelleLong", "");
GTraductions.add("Onglet.LibelleLong", "Emploi du temps des classes/groupes");
GTraductions.add("Onglet.LibelleLong", "");
GTraductions.add("Onglet.LibelleLong", "");
GTraductions.add("Onglet.LibelleLong", "");
GTraductions.add("Onglet.LibelleLong", "Tableau des moyennes par classe");
GTraductions.add("Onglet.LibelleLong", "Liste des évaluations des compétences");
GTraductions.add("Onglet.LibelleLong", "Personnel administratif");
GTraductions.add("Onglet.LibelleLong", "Anciennes évaluations");
GTraductions.add("Onglet.LibelleLong", "Liste des punitions programmées");
GTraductions.add("Onglet.LibelleLong", "Mon entreprise");
GTraductions.add("Onglet.LibelleLong", "Bilan de compétences par classe");
GTraductions.add("Onglet.LibelleLong", "Définition des progressions");
GTraductions.add("Onglet.LibelleLong", "Liste des dispenses");
GTraductions.add("Onglet.LibelleLong", "Liste des absences et retards");
GTraductions.add("Onglet.LibelleLong", "Suivi des absences et retards");
GTraductions.add("Onglet.LibelleLong", "Affectation des progressions");
GTraductions.add("Onglet.LibelleLong", "");
GTraductions.add("Onglet.LibelleLong", "Trombinoscope des classes");
GTraductions.add("Onglet.LibelleLong", "Carnet de correspondance");
GTraductions.add("Onglet.LibelleLong", "");
GTraductions.add("Onglet.LibelleLong", "");
GTraductions.add("Onglet.LibelleLong", "Emploi du temps des salles");
GTraductions.add("Onglet.LibelleLong", "");
GTraductions.add("Onglet.LibelleLong", "Livret scolaire");
GTraductions.add("Onglet.LibelleLong", "");
GTraductions.add("Onglet.LibelleLong", "Mes QCM");
GTraductions.add("Onglet.LibelleLong", "Bibliothèque de QCM de l'établissement");
GTraductions.add("Onglet.LibelleLong", "Répondre aux iDevoirs");
GTraductions.add("Onglet.LibelleLong", "Travail à faire");
GTraductions.add("Onglet.LibelleLong", "Contenu des cours");
GTraductions.add("Onglet.LibelleLong", "");
GTraductions.add("Onglet.LibelleLong", "Indisponibilités pour les rencontres");
GTraductions.add("Onglet.LibelleLong", "Desiderata pour les rencontres");
GTraductions.add("Onglet.LibelleLong", "Recherche des créneaux libres");
GTraductions.add("Onglet.LibelleLong", "Planning des rencontres");
GTraductions.add("Onglet.LibelleLong", "QCM pour réviser");
GTraductions.add("Onglet.LibelleLong", "Bibliothèque de QCM Nathan");
GTraductions.add("Onglet.LibelleLong", "Emploi du temps des professeurs");
GTraductions.add("Onglet.LibelleLong", "Offres de stage");
GTraductions.add("Onglet.LibelleLong", "Ressources pédagogiques des périodes");
GTraductions.add("Onglet.LibelleLong", "Bulletin");
GTraductions.add("Onglet.LibelleLong", "Offres de stage");
GTraductions.add("Onglet.LibelleLong", "Casier numérique");
GTraductions.add("Onglet.LibelleLong", "Documents déposés dans les casiers");
GTraductions.add("Onglet.LibelleLong", "Mon casier numérique");
GTraductions.add("Onglet.LibelleLong", "Liste des élèves");
GTraductions.add("Onglet.LibelleLong", "");
GTraductions.add("Onglet.LibelleLong", "");
GTraductions.add("Onglet.LibelleLong", "Livret scolaire");
GTraductions.add("Onglet.LibelleLong", "Saisie des appréciations du livret");
GTraductions.add("Onglet.LibelleLong", "Saisie des compétences du livret");
GTraductions.add("Onglet.LibelleLong", "Graphique du profil");
GTraductions.add("Onglet.LibelleLong", "Graphique de l'évolution annuelle");
GTraductions.add("Onglet.LibelleLong", "Feuille d'appel et suivi");
GTraductions.add("Onglet.LibelleLong", "Feuille d'appel");
GTraductions.add("Onglet.LibelleLong", "Récapitulatif annuel des absences, punitions ...");
GTraductions.add("Onglet.LibelleLong", "Liste détaillée des absences, punitions ...");
GTraductions.add("Onglet.LibelleLong", "Heures manquées");
GTraductions.add("Onglet.LibelleLong", "Remplacements en grille");
GTraductions.add("Onglet.LibelleLong", "Remplacements en tableau");
GTraductions.add("Onglet.LibelleLong", "Planning des rencontres en liste");
GTraductions.add("Onglet.LibelleLong", "Planning des rencontres en grille");
GTraductions.add("Onglet.LibelleLong", "");
GTraductions.add("Onglet.LibelleLong", "Liste des professeurs");
GTraductions.add("Onglet.LibelleLong", "Liste des classes");
GTraductions.add("Onglet.LibelleLong", "Liste des groupes");
GTraductions.add("Onglet.LibelleLong", "Liste des responsables");
GTraductions.add("Onglet.LibelleLong", "Liste des personnels");
GTraductions.add("Onglet.LibelleLong", "");
GTraductions.add("Onglet.LibelleLong", "");
GTraductions.add("Onglet.LibelleLong", "Emploi du temps des élèves");
GTraductions.add("Onglet.LibelleLong", "Discussions");
GTraductions.add("Onglet.LibelleLong", "Messagerie");
GTraductions.add("Onglet.LibelleLong", "");
GTraductions.add("Onglet.LibelleLong", "Emploi du temps des personnels");
GTraductions.add("Onglet.LibelleLong", "");
GTraductions.add("Onglet.LibelleLong", "Feuille d'appel des enseignants");
GTraductions.add("Onglet.LibelleLong", "Autorisations de sortie");
GTraductions.add("Onglet.LibelleLong", "");
GTraductions.add("Onglet.LibelleLong", "");
GTraductions.add("Onglet.LibelleLong", "");
GTraductions.add("Onglet.LibelleLong", "Programmes scolaires (Sources : B.O. de l'Education Nationale)");
GTraductions.add("Onglet.LibelleLong", "Trombinoscope des professeurs");
GTraductions.add("Onglet.LibelleLong", "Trombinoscope des personnels");
GTraductions.add("Onglet.LibelleLong", "Mes paramètres");
GTraductions.add("Onglet.LibelleLong", "");
GTraductions.add("Onglet.LibelleLong", "Cours non assurés des professeurs");
GTraductions.add("Onglet.LibelleLong", "");
GTraductions.add("Onglet.LibelleLong", "Documents à télécharger");
GTraductions.add("Onglet.LibelleLong", "");
GTraductions.add("Onglet.LibelleLong", "Bibliothèque des progressions de l'établissement");
GTraductions.add("Onglet.LibelleLong", "");
GTraductions.add("Onglet.LibelleLong", "");
GTraductions.add("Onglet.LibelleLong", "");
GTraductions.add("Onglet.LibelleLong", "");
GTraductions.add("Onglet.CompteDe", "Compte de %s");
GTraductions.add("Onglet.InfosMedicalesDe", "Informations médicales de %s");
GTraductions.add("SelectionAffichage", "Veuillez sélectionner un affichage au travers des menus ci-dessus");
GTraductions.add("boutonMembre", "+ d'infos");
GTraductions.add("hint.boutonMembre", "Informations liées à %s");
GTraductions.add("plusInfo", "Plus d'info");
GTraductions.add("mobile.redirigeVersionMobile", "Vous avez été redirigé vers la version mobile.");
GTraductions.add("mobile.accederVersionClassique", "Accéder à la version classique");
GTraductions.add("mobile.activerEffets", "Activer les effets");
GTraductions.add("mobile.desactiverEffets", "Désactiver les effets");
GTraductions.add("tous", "Tous");
GTraductions.add("toutes", "Toutes");
GTraductions.add("ModeCompatible", "Votre navigateur est en mode compatible. Il est conseillé de revenir au mode par défaut.");
GTraductions.add("caracteresMax", "caractères maximum");
GTraductions.add("VeuillezPatienter", "Veuillez patienter ...");
GTraductions.add("TraitementEnCours", "Traitement en cours ...");
GTraductions.add("MessageImpression", "Pour imprimer, utilisez le bouton d'impression de votre espace");
GTraductions.add("MessagePDF", "Pour imprimer, utilisez le bouton PDF de votre Espace");
GTraductions.add("Arrondi", "sans");
GTraductions.add("Arrondi", "1/10");
GTraductions.add("Arrondi", "1/4");
GTraductions.add("Arrondi", "1/2");
GTraductions.add("Arrondi", "1 point");
GTraductions.add("MinutesCourt", "min.");
GTraductions.add("SecondesCourt", "s.");
GTraductions.add("Jours", "lundi");
GTraductions.add("Jours", "mardi");
GTraductions.add("Jours", "mercredi");
GTraductions.add("Jours", "jeudi");
GTraductions.add("Jours", "vendredi");
GTraductions.add("Jours", "samedi");
GTraductions.add("Jours", "dimanche");
GTraductions.add("JoursCourt", "lun.");
GTraductions.add("JoursCourt", "mar.");
GTraductions.add("JoursCourt", "mer.");
GTraductions.add("JoursCourt", "jeu.");
GTraductions.add("JoursCourt", "ven.");
GTraductions.add("JoursCourt", "sam.");
GTraductions.add("JoursCourt", "dim.");
GTraductions.add("Mois", "janvier");
GTraductions.add("Mois", "février");
GTraductions.add("Mois", "mars");
GTraductions.add("Mois", "avril");
GTraductions.add("Mois", "mai");
GTraductions.add("Mois", "juin");
GTraductions.add("Mois", "juillet");
GTraductions.add("Mois", "août");
GTraductions.add("Mois", "septembre");
GTraductions.add("Mois", "octobre");
GTraductions.add("Mois", "novembre");
GTraductions.add("Mois", "décembre");
GTraductions.add("MoisCourt", "jan.");
GTraductions.add("MoisCourt", "fév.");
GTraductions.add("MoisCourt", "mars");
GTraductions.add("MoisCourt", "avril");
GTraductions.add("MoisCourt", "mai");
GTraductions.add("MoisCourt", "juin");
GTraductions.add("MoisCourt", "juil.");
GTraductions.add("MoisCourt", "août");
GTraductions.add("MoisCourt", "sept.");
GTraductions.add("MoisCourt", "oct.");
GTraductions.add("MoisCourt", "nov.");
GTraductions.add("MoisCourt", "déc.");
GTraductions.add("PeriodeCourt", "T1");
GTraductions.add("PeriodeCourt", "T2");
GTraductions.add("PeriodeCourt", "T3");
GTraductions.add("PeriodeCourt", "S1");
GTraductions.add("PeriodeCourt", "S2");
GTraductions.add("Message", "Sélectionnez une classe");
GTraductions.add("Message", "Sélectionnez un groupe");
GTraductions.add("Message", "Sélectionnez un élève");
GTraductions.add("Message", "Sélectionnez un service");
GTraductions.add("Message", "Sélectionnez une appréciation");
GTraductions.add("Message", "Sélectionnez une période");
GTraductions.add("Message", "Aucun élève disponible pour cette période");
GTraductions.add("Message", "Aucun service disponible pour cette période");
GTraductions.add("Message", "Aucune appréciation disponible pour cette période");
GTraductions.add("Message", "Il n'y a pas de notes pour la période sélectionnée.");
GTraductions.add("Message", "Sélectionnez une classe ou un groupe");
GTraductions.add("Message", "Aucun élève disponible pour cette classe");
GTraductions.add("Message", "Sélectionnez une compétence");
GTraductions.add("Message", "Cette compétence n'est affectée à aucune classe");
GTraductions.add("Message", "Aucune compétence pour cet élève");
GTraductions.add("Message", "Aucun bulletin n'est publié pour cet élève");
GTraductions.add("Message", "Aucun relevé de notes n'est publié pour cet élève");
GTraductions.add("Message", "Aucun compte rendu de conseil de classe n'est publié pour cet élève");
GTraductions.add("Message", "Ce professeur n'enseigne à aucune classe");
GTraductions.add("Message", "Ce professeur n'enseigne aucune matière à la classe sélectionnée.");
GTraductions.add("Message", "Sélectionnez une discipline du brevet");
GTraductions.add("Message", "Aucune discipline brevet");
GTraductions.add("Message", "Sélectionnez un palier");
GTraductions.add("Message", "Aucun palier");
GTraductions.add("Message", "Sélectionnez une matière");
GTraductions.add("Message", "Aucune matière");
GTraductions.add("Message", "Sélectionnez un item");
GTraductions.add("Message", "Sélectionnez une salle");
GTraductions.add("Message", "Aucun élève disponible pour ce groupe");
GTraductions.add("Message", "Sélectionnez une discipline du livret scolaire");
GTraductions.add("Message", "Aucune discipline livret scolaire");
GTraductions.add("Message", "Sélectionnez un professeur");
GTraductions.add("Message", "Aucune classe n'est disponible");
GTraductions.add("Message", "Aucun bulletin de compétences n'est publié pour cet élève");
GTraductions.add("Message", "Aucune salle n'est disponible");
GTraductions.add("Message", "Sélectionnez un personnel");
GTraductions.add("Professeur", "Professeur");
GTraductions.add("Professeurs", "Professeurs");
GTraductions.add("Classes", "Classes");
GTraductions.add("Groupes", "Groupes");
GTraductions.add("Salles", "Salles");
GTraductions.add("MaitreDeStage", "Maître de stage");
GTraductions.add("MaitresDeStage", "Maîtres de stage");
GTraductions.add("Niveau", "Niveau");
GTraductions.add("Nom", "Nom");
GTraductions.add("Personnel", "Personnel");
GTraductions.add("Personnels", "Personnels");
GTraductions.add("Validee", "Validée");
GTraductions.add("NonValidee", "Non validée");
GTraductions.add("SocleValide", "Validé");
GTraductions.add("SocleNonValide", "Non validé");
GTraductions.add("AnneeScolaire", "Année scolaire");
GTraductions.add("Nouveau", "Nouveau");
GTraductions.add("Annuler", "Annuler");
GTraductions.add("Supprimer", "Supprimer");
GTraductions.add("Valider", "Valider");
GTraductions.add("Fermer", "Fermer");
GTraductions.add("Imprimer", "Imprimer");
GTraductions.add("ApercuAvantImpression", "Aperçu avant impression...");
GTraductions.add("Semaine", "Semaine");
GTraductions.add("Aujourdhui", "aujourd'hui");
GTraductions.add("Demain", "demain");
GTraductions.add("Hier", "hier");
GTraductions.add("SemaineEnCours", "Semaine en cours");
GTraductions.add("MoisEnCours", "Mois en cours");
GTraductions.add("AnneeComplete", "Année complète");
GTraductions.add("Depuis", "depuis");
GTraductions.add("Du", "du");
GTraductions.add("De", "de");
GTraductions.add("Des", "des");
GTraductions.add("Au", "au");
GTraductions.add("A", "à");
GTraductions.add("Le", "le");
GTraductions.add("jusquAu", "jusqu'au");
GTraductions.add("Le_Maj", "Le");
GTraductions.add("EtLe", "et le");
GTraductions.add("Non", "Non");
GTraductions.add("Oui", "Oui");
GTraductions.add("Et", "et");
GTraductions.add("Par", "Par");
GTraductions.add("Sur", "sur");
GTraductions.add("Aucun", "Aucun");
GTraductions.add("Aucune", "Aucune");
GTraductions.add("Commentaire", "Commentaire");
GTraductions.add("Annee", "Année");
GTraductions.add("Matieres", "Matières");
GTraductions.add("Matiere", "Matière");
GTraductions.add("Groupe", "Groupe");
GTraductions.add("Classe", "Classe");
GTraductions.add("Salle", "Salle");
GTraductions.add("Eleves", "Élèves");
GTraductions.add("Eleve", "Élève");
GTraductions.add("Etudiants", "Élèves");
GTraductions.add("Etudiant", "Élève");
GTraductions.add("Appreciation", "Appréciation");
GTraductions.add("Devoirs", "Devoirs");
GTraductions.add("Moyenne", "Moyenne");
GTraductions.add("Moyennes", "Moyennes");
GTraductions.add("MoyenneGenerale", "Moyenne générale");
GTraductions.add("Heures", "Heures");
GTraductions.add("Heure", "Heure");
GTraductions.add("Date", "Date");
GTraductions.add("Duree", "Durée");
GTraductions.add("SaisieImpossible", "Saisie impossible !");
GTraductions.add("PeriodeCloturee", "La période est clôturée.\nSeuls les utilisateurs du groupe administratif peuvent enlever la clôture.");
GTraductions.add("AConsulter", "A consulter");
GTraductions.add("Ferie", "Férié");
GTraductions.add("Feriee", "Fériée");
GTraductions.add("NonPlace", "Non placé");
GTraductions.add("SousForme", "Sous forme");
GTraductions.add("Grille", "grille");
GTraductions.add("Tableau", "tableau");
GTraductions.add("Total", "Total");
GTraductions.add("Assure", "assuré");
GTraductions.add("ValiderSaisie", "Validez votre saisie");
GTraductions.add("VersionImprimable", "VERSION IMPRIMABLE");
GTraductions.add("FormatImpression", "Impression grand format");
GTraductions.add("FormatImpression", "Impression moyen format");
GTraductions.add("FormatImpression", "Impression petit format");
GTraductions.add("AfficherTousEleves", "AFFICHER TOUS LES ELEVES");
GTraductions.add("MessageAttendre", "Attente de la réponse");
GTraductions.add("MessageSaturation", "La communication avec le serveur est impossible");
GTraductions.add("MessageAlerteImpression", "Attention ! Les données qui seront imprimées n'ont pas toutes été validées. Voulez-vous continuer ?");
GTraductions.add("MsgAlerteSurLImpression", "Attention ! Lors de l'impression certaines des données saisies n'étaient pas validées.");
GTraductions.add("MessageTailleMaxAppr", "Vous avez atteint la taille maximale de l'appréciation");
GTraductions.add("HeuresPerdues", "Heures perdues");
GTraductions.add("Multiple", "Multiple");
GTraductions.add("Precedent", "Précédent");
GTraductions.add("Suivant", "Suivant");
GTraductions.add("ToutesLesMatieres", "Toutes les matières");
GTraductions.add("DeLaClasse", "De la classe");
GTraductions.add("DuGroupe", "Du groupe");
GTraductions.add("NonPublie", "Non publié");
GTraductions.add("AfficherCorrige", "Afficher le corrigé");
GTraductions.add("Libelle", "Libellé");
GTraductions.add("Personnaliser", "Personnaliser");
GTraductions.add("PersonnaliserTheme", "Personnaliser le thème");
GTraductions.add("Periode", "Période");
GTraductions.add("Competence", "Compétence");
GTraductions.add("Service", "Service");
GTraductions.add("Item", "Item");
GTraductions.add("Discipline", "Discipline");
GTraductions.add("NbEleveSelection", "%s élèves sélectionnés");
GTraductions.add("ClicListeArbo", "Cliquer ici pour dérouler ou replier un élément");
GTraductions.add("SemaineFeriee", "Semaine fériée");
GTraductions.add("RegleAdminAbr", "RA");
GTraductions.add("Code", "Code");
GTraductions.add("Authentification", "Authentification");
GTraductions.add("Identification", "Identification");
GTraductions.add("FicheRenseignement", "Voir la fiche de renseignements");
GTraductions.add("VoirPhotoEleve", "Voir la photo de l'élève");
GTraductions.add("AllerAuContenu", "Aller au contenu");
GTraductions.add("TransfertPJ", "Transfert des pièces jointes");
GTraductions.add("Autre", "Autre");
GTraductions.add("EnregistrementEnCours", "Enregistrement en cours");
GTraductions.add("Multiple", "Multiple");
GTraductions.add("ConseilDeClasse", "Conseil de classe");
GTraductions.add("ValideeLe", "Validée le");
GTraductions.add("Corrige", "Corrigé");
GTraductions.add("SemaineCourante", "Semaine courante");
GTraductions.add("SemainePrecedente", "Semaine précédente");
GTraductions.add("SemaineSuivante", "Semaine suivante");
GTraductions.add("hintliencloud", "Modification des liens sur des services de stockage");
GTraductions.add("mficheliencloud", '{"titre":"Information sur le partage","html":{"_T":23,"V":"<p>Le document&nbsp;partag&eacute; depuis le&nbsp;cloud sera accessible &agrave; toutes les personnes qui disposeront du lien.</p>"},"width":265,"height":100,"type":4,"boutons":{"_T":18,"V":1024}}');
GTraductions.add("WAI.ListeSelectionEleve", "Liste déroulante : sélectionnez un élève.");
GTraductions.add("WAI.ListeSelectionProfesseur", "Liste déroulante : sélectionnez un professeur.");
GTraductions.add("WAI.ListeSelectionTheme", "Liste déroulante : sélectionnez un thème.");
GTraductions.add("WAI.ListeSelectionPeriode", "Liste déroulante : sélectionnez une période.");
GTraductions.add("WAI.MenuSelectGroupe", "Menu déroulant : Choisissez un groupe :");
GTraductions.add("WAI.MenuSelectClasse", "Menu déroulant : Choisissez une classe :");
GTraductions.add("WAI.MenuSelectClasseGroupe", "Menu déroulant : choisissez une classe ou un groupe :");
GTraductions.add("WAI.heure", "heure");
GTraductions.add("WAI.heures", "heures");
GTraductions.add("WAI.minute", "minute");
GTraductions.add("WAI.minutes", "minutes");
GTraductions.add("ModeExclusif.UsageExclusif", "Usage exclusif");
GTraductions.add("ModeExclusif.EntrerModeExclusif", "Des opérations doivent être effectuées sur la base de données. Vous êtes temporairement mis en mode consultation.");
GTraductions.add("ModeExclusif.SortieModeExclusif", "L'administrateur a terminé ses opérations sur la base. Cette dernière va être mise à jour et vous allez retrouver vos droits.");
GTraductions.add("ModeExclusif.ConsultationTemporaire", "Consultation temporaire");
GTraductions.add("ModeExclusif.SaisieImpossibleConsultation", "La saisie est impossible en mode consultation");
GTraductions.add("Fenetre_SelectionRessource.CocherEleves", "Cocher les élèves");
GTraductions.add("Fenetre_SelectionRessource.CocherProfesseurs", "Cocher les professeurs");
GTraductions.add("Fenetre_SelectionRessource.CocherResponsables", "Cocher les responsables");
GTraductions.add("Fenetre_SelectionRessource.CocherPersonnel", "Cocher les personnels");
GTraductions.add("Fenetre_SelectionRessource.CocherMaitresDeStage", "Cocher les maîtres de stage");
GTraductions.add("Fenetre_SelectionRessource.CocherInspecteurs", "Cocher les inspecteurs pédagogiques");
GTraductions.add("Fenetre_SelectionRessource.CocherPeriodes", "Cocher les périodes");
GTraductions.add("Vacances.MessageVacancesNonDefinis", "Les vacances et jours fériés n'ont pas été définis.");
GTraductions.add("Vacances.WeekEnd", "Week-end");
GTraductions.add("Vacances.Vacances", "Vacances et jours fériés");
GTraductions.add("AucuneDonneeSuiviPluriAnnuel", "Aucune donnée pour la suivi pluriannuel n'est disponible");
GTraductions.add("Commande.Nathan.Actif", "Accéder à votre compte i-Manuel Nathan");
GTraductions.add("Commande.Nathan.Inactif", "Vous n'avez aucun i-Manuel Nathan activé");
GTraductions.add("Commande.FenetreTeinte.Titre", "Sélection de la teinte personnalisée");
GTraductions.add("Commande.Accueil.Actif", "Accueil");
GTraductions.add("Commande.Validation.Actif", "Validez votre saisie");
GTraductions.add("Commande.Validation.Inactif", "Aucune donnée à valider");
GTraductions.add("Commande.Impression.Actif", "Imprimer");
GTraductions.add("Commande.Impression.Inactif", "Aucune impression pour cet affichage");
GTraductions.add("Commande.LiveEdu.Actif", "Ouvrir ma messagerie Live@Edu");
GTraductions.add("Commande.LiveEdu.Inactif", "compte Live@Edu inactif");
GTraductions.add("Commande.SkyDrive.Actif", "Ouvrir SkyDrive");
GTraductions.add("Commande.SkyDrive.Inactif", "SkyDrive inactif");
GTraductions.add("Commande.AccesMobile.Actif", "Accéder à la version mobile de l'%s");
GTraductions.add("Commande.Communication.Actif", "Communiquer avec ...");
GTraductions.add("Commande.OngletIManuel.Actif", "Accéder à votre espace i-Manuel Nathan");
GTraductions.add("Commande.Accessible.Actif", "Activer le mode accessible");
GTraductions.add("Commande.Accessible.Desactive", "Désactiver le mode accessible");
GTraductions.add("Commande.Tutoriel.Actif", "Voir les tutoriels");
GTraductions.add("Commande.TelechargerClient.Actif", "Téléchargez le Client PRONOTE");
GTraductions.add("Commande.SuivrePronoteTwitter.Actif", "Suivre PRONOTE sur Twitter");
GTraductions.add("Commande.PDF.Actif", "Générer un PDF");
GTraductions.add("Commande.PDF.Inactif", "Aucun PDF pour cet affichage");
GTraductions.add("Commande.Manuel.Actif", "Afficher l'aide PDF");
GTraductions.add("Commande.Kiosque.Actif", "Afficher les manuels numériques");
GTraductions.add("Commande.CertificatScolarite.Actif", "Télécharger le certificat de scolarité");
GTraductions.add("Commande.CertificatScolarite.Titre", "Certificat de scolarité");
GTraductions.add("Commande.FenetreKiosque.Titre", "Manuels numériques");
GTraductions.add("Commande.FenetreKiosque.Message", "Aucunes ressources disponibles");
GTraductions.add("Commandes.Onglet.Plus", "Plus...");
GTraductions.add("connexion.AccesRefuse", "Accès refusé");
GTraductions.add("connexion.ErreurIdentification", "Votre identifiant ou votre mot de passe est incorrect.\nPour information, la saisie du mot de passe doit respecter les minuscules et majuscules.");
GTraductions.add("connexion.ErreurAutorisation", "Vous n'avez pas accès à l'#1.\nContactez l'établissement afin qu'il mette à jour votre profil d'autorisations.");
GTraductions.add("connexion.ErreurConnexionClasse", "Vous n'avez pas les autorisations nécessaires pour accéder aux affichages liés au mode de connexion 'Dans la classe'.");
GTraductions.add("connexion.ErreurAucuneRessource", "Vous n'avez pas accès à l'#1.\nContactez l'établissement afin qu'il mette à jour votre fiche de renseignements.");
GTraductions.add("connexion.ErreurConnexion", "Vous n'avez pas les autorisations nécessaires pour accéder aux affichages");
GTraductions.add("connexion.ErreurPersonnalisationMDP", "Votre administrateur vous impose de personnaliser votre mot de passe.\nVous devez vous connecter sur le Client PRONOTE en mode administratif pour réaliser ce changement.");
GTraductions.add("connexion.modeConnexion", "Mode de connexion");
GTraductions.add("connexion.modeConnexionTitre", "Choisissez le mode de connexion.");
GTraductions.add("connexion.modeConnexionMessage", "En mode \"Dans la classe\" vous n'aurez accès qu'à la saisie des absences et du cahier de textes, pour plus de confidentialité.");
GTraductions.add("connexion.modeConnexion1", "Domicile");
GTraductions.add("connexion.modeConnexion2", "Dans la classe");
GTraductions.add("connexion.commentSeConnecter", "Comment se connecter ?");
GTraductions.add("connexion.identifiant", "Identifiant");
GTraductions.add("connexion.identifiantTitre", "Saisissez votre IDENTIFIANT.");
GTraductions.add("connexion.identifiantTitreDemo", "En version de démonstration, l'identifiant et le mot de passe ne sont pas modifiables.");
GTraductions.add("connexion.identifiantInfo", "Saisissez votre identifiant.");
GTraductions.add("connexion.identifiantInfoDemo", "L'Identifiant n'est pas saisissable.");
GTraductions.add("connexion.identifiantMessage", "Il vous est communiqué par l'établissement et peut être différent de votre nom de famille.");
GTraductions.add("connexion.motDePasse", "Mot de passe");
GTraductions.add("connexion.motDePasseTitre", "Saisissez votre MOT DE PASSE.");
GTraductions.add("connexion.motDePasseTitreDemo", "Cliquez sur \"Se connecter\" afin de découvrir l'#1.");
GTraductions.add("connexion.motDePasseInfo", "Saisissez votre mot de passe.");
GTraductions.add("connexion.motDePasseInfoDemo", "Le mot de passe n'est pas saisissable.");
GTraductions.add("connexion.motDePasseMessage", "Il vous est communiqué par l'établissement, vous pourrez le modifier dans l'onglet \"#1\".");
GTraductions.add("connexion.motDePasseMessageDemo", "Vous pourrez consulter et saisir toutes les données, en revanche aucune validation n'est possible.");
GTraductions.add("connexion.seConnecter", "Se connecter");
GTraductions.add("connexion.seConnecterTitre", "Cliquez sur le bouton \"Se connecter\".");
GTraductions.add("connexion.conseilsTitre", "Conseil");
GTraductions.add("connexion.conseilsMessage", "Pour ne pas risquer de perdre votre saisie, validez régulièrement.");
GTraductions.add("connexion.ConnexionCAS", "Connexion à PRONOTE.net - Veuillez patienter...");
GTraductions.add("connexion.RecuperationMDP.texte", "Récupérer son identifiant et son mot de passe.");
GTraductions.add("connexion.RecuperationMDP.titre", "Cliquez pour commencer la procédure de récupération de vos identifiant et mot de passe.");
GTraductions.add("connexion.SeDeconnecter", "Se déconnecter");
GTraductions.add("connexion.SeSouvenir", "Se souvenir de moi");
GTraductions.add("connexion.SeSouvenirInfo", "Attention ne cocher pas cette option si vous êtes sur un ordinateur partagé.");
GTraductions.add("mobile.validerAvantQuitter", "Valider ma saisie avant de quitter");
GTraductions.add("mobile.quitterSansValider", "Quitter sans valider");
GTraductions.add("mobile.nonSupporte", "Votre téléphone n'est pas supporté");
GTraductions.add("mobile.confirmDeco", "Voulez-vous continuer et vous déconnecter ?");
GTraductions.add("mobile.aucunMenu", "Aucun menu saisi");
GTraductions.add("mobile.aucunOngletPublie", "Aucun onglet n'est publié.");
GTraductions.add("mobile.hintAccueil", "Retour vers la page d'accueil");
GTraductions.add("mobile.hintMenu", "Ouvrir le menu principal");
GTraductions.add("mobile.hintValider", "Validez votre saisie");
GTraductions.add("mobile.hintDeconnexion", "Se déconnecter");
GTraductions.add("accueil.rienASignalerVS", "Rien à signaler");
GTraductions.add("accueil.titre", "PRONOTE.net Mobile");
GTraductions.add("accueil.TAF", "Travail à faire");
GTraductions.add("accueil.contenuDesCours", "Contenu des cours");
GTraductions.add("accueil.saisieAbsences", "Feuille d'appel");
GTraductions.add("accueil.releveNotes", "Relevé de notes");
GTraductions.add("accueil.accueilMobile", "Accueil");
GTraductions.add("accueil.actualites", "Informations & Sondages");
GTraductions.add("accueil.dernieresNotes", "Dernières notes");
GTraductions.add("accueil.vieScolaire", "Absences, punitions ...");
GTraductions.add("accueil.menu", "Menu de la cantine");
GTraductions.add("accueil.emploiDuTemps", "Emploi du temps");
GTraductions.add("accueil.trombinoscope", "Trombinoscope");
GTraductions.add("accueil.listeEleves", "Liste des élèves");
GTraductions.add("accueil.toutVoir", "Tout voir");
GTraductions.add("accueil.aucuneNote", "Aucune nouvelle note");
GTraductions.add("mobile.aucuneNote", "Vous n'avez actuellement aucune note");
GTraductions.add("mobile.aucuneNoteParent", "Votre enfant n'a actuellement aucune note");
GTraductions.add("accueil.aucuneAbsence", "Aucun nouvel évènement");
GTraductions.add("accueil.aucuneAgenda", "Aucun événement saisi");
GTraductions.add("accueil.aucuneActualite", "Aucune nouvelle information");
GTraductions.add("accueil.pasDeMenu", "Aucun menu");
GTraductions.add("accueil.moyClasse", "Moy. classe");
GTraductions.add("accueil.moyGroupe", "Moy. groupe");
GTraductions.add("accueil.moyenneClasse", "Moyenne de la classe");
GTraductions.add("accueil.moyenneGroupe", "Moyenne du groupe");
GTraductions.add("accueil.absenceAJustifier", "Absence à justifier");
GTraductions.add("accueil.retardAJustifier", "Retard à justifier");
GTraductions.add("accueil.prisConnaissance", "J'ai pris connaissance de cette information");
GTraductions.add("accueil.saisirReponse", "Saisissez votre réponse ici !");
GTraductions.add("accueil.ModifierEleves", "Modifier les élèves");
GTraductions.add("accueil.EnvoiEmail", "Envoi d'e-mail");
GTraductions.add("accueil.info.executionsQCM", "Les iDevoirs des 15 prochains jours");
GTraductions.add("accueil.info.notes", "Les 10 dernières notes");
GTraductions.add("accueil.info.viescolaire", "Les évènements des 15 derniers jours");
GTraductions.add("accueil.info.menu", "Le menu du jour");
GTraductions.add("accueil.info.agenda", "L'agenda des 15 prochains jours");
GTraductions.add("accueil.info.actualites", "Les informations et sondages non lus");
GTraductions.add("accueil.info.edtJour", "L'emploi du temps du jour");
GTraductions.add("accueil.info.edtSemaine", "L'emploi du temps de la semaine");
GTraductions.add("accueil.info.travailAFaire", "Travaux à faire des 7 prochains jours");
GTraductions.add("accueil.info.discussions", "Les discussions non lues");
GTraductions.add("accueil.aucunMessage", "Aucun nouveau message");
GTraductions.add("accueil.ParametresMobile", "Paramètres");
GTraductions.add("accueil.absencesProf.titre", "Heures libérées");
GTraductions.add("accueil.absencesProf.aucuneHeureLiberee", "Aucune heure libérée");
GTraductions.add("accueil.absencesProf.AccesRechercheCreneauxLibres", "Accéder à la recherche de créneaux libres");
GTraductions.add("accueil.absencesProf.EntreLesDates", "entre le %s et le %s");
GTraductions.add("accueil.rencontres", "Planning des rencontres");
GTraductions.add("accueil.EDT.commande.CDT", "Saisir le cahier de textes");
GTraductions.add("accueil.EDT.commande.appel", "Faire l'appel");
GTraductions.add("accueil.EDT.commande.notes", "Saisir des notes");
GTraductions.add("accueil.EDT.commande.evaluations", "Saisir des évaluations");
GTraductions.add("accueil.EDT.commande.appreciations", "Saisir des appréciations");
GTraductions.add("accueil.EDT.commande.information", "Diffuser une information");
GTraductions.add("accueil.EDT.commande.sondage", "Effectuer un sondage");
GTraductions.add("accueil.appelNonFait.titre", "Appels non faits");
GTraductions.add("accueil.appelNonFait.message", "Tous les appels ont été effectués");
GTraductions.add("accueil.appelNonFait.faireLAppel", "Faire l'appel !");
GTraductions.add("accueil.appelNonFait.hintLien", "Faire l'appel");
GTraductions.add("accueil.CDTNonSaisi.titre", "Cah. de textes non saisis");
GTraductions.add("accueil.CDTNonSaisi.message", "Tous les cahiers de textes ont été saisis");
GTraductions.add("accueil.CDTNonSaisi.hintLien", "Saisir le cahier de textes");
GTraductions.add("accueil.CDC.titre", "Bulletins");
GTraductions.add("accueil.CDC.colonne.classe", "Classe");
GTraductions.add("accueil.CDC.colonne.date", "Conseil");
GTraductions.add("accueil.CDC.colonne.devoirs", "Devoirs");
GTraductions.add("accueil.CDC.colonne.apprManquantes", "Appr. manquantes");
GTraductions.add("accueil.CDC.colonne.hint.devoirs", "Nombre de devoirs");
GTraductions.add("accueil.CDC.colonne.hint.apprManquantes", "Nombre d'appréciations manquantes de la classe");
GTraductions.add("accueil.CDC.hintLien.devoir", "Voir les devoirs");
GTraductions.add("accueil.CDC.hintLien.appreciation", "Saisir les appréciations manquantes");
GTraductions.add("accueil.CDC.hint.clotureDevoir", "La saisie des notes est clôturée ");
GTraductions.add("accueil.CDC.hint.dateClotureDevoir", "la saisie des notes sera clôturée le %s");
GTraductions.add("accueil.CDC.hint.clotureAppreciation", "La saisie des appréciations est clôturée ");
GTraductions.add("accueil.CDC.hint.dateClotureAppreciation", "la saisie des appréciations sera clôturée le %s");
GTraductions.add("accueil.agenda.titre", "Agenda");
GTraductions.add("accueil.agenda.hintLien", "Afficher le détail de l'évènement");
GTraductions.add("accueil.informations.hintLien.information", "Afficher le détail de l'information");
GTraductions.add("accueil.informations.hintLien.sondage", "Afficher le détail du sondage");
GTraductions.add("accueil.discussions.titre", "Discussions");
GTraductions.add("accueil.discussions.hintLien", "Ouvrir la discussion");
GTraductions.add("accueil.competences.titre", "Dernières compétences évaluées");
GTraductions.add("accueil.competences.hint", "Les 10 dernières compétences évaluées");
GTraductions.add("accueil.competences.hintLien", "Afficher le détail de l'évaluation");
GTraductions.add("accueil.casier.titre", "Casier numérique");
GTraductions.add("accueil.casier.deposePar", "déposé par %s");
GTraductions.add("accueil.casier.message", "Tous les documents ont été lus");
GTraductions.add("accueil.kiosque.titre", "Manuels numériques");
GTraductions.add("accueil.aide.titre", "Aide Index Education");
GTraductions.add("accueil.coursNonAssures.titre", "Professeurs absents");
GTraductions.add("accueil.coursNonAssures.message", "Aucun professeur absent");
GTraductions.add("accueil.penseBete.titre", "Pense-bête");
GTraductions.add("accueil.ressources.titreAvecBO", "QCM / Progressions / Programmes");
GTraductions.add("accueil.ressources.titreSansBO", "QCM / Progressions");
GTraductions.add("accueil.ressources.QCM", "QCM");
GTraductions.add("accueil.ressources.Progressions", "Progressions");
GTraductions.add("accueil.ressources.ProgrammesBO", "Programmes du BO");
GTraductions.add("accueil.ressources.hint.MesQCM", "Mes QCM ");
GTraductions.add("accueil.ressources.hint.QCMPartages", "QCM de la bibliothèque de l'établissement et QCM Nathan");
GTraductions.add("accueil.ressources.hint.MesProgressions", "Mes progressions");
GTraductions.add("accueil.ressources.hint.ProgressionsPartagees", "Progression de la bibliothèque de l'établissement");
GTraductions.add("accueil.ressources.hint.ProgrammesBO", "Programmes officiels du BO");
GTraductions.add("accueil.ressources.libelle", "Programmes du BO");
GTraductions.add("accueil.ressources.libelle", "Manuels numériques");
GTraductions.add("accueil.ressourcePedagogique.titre", "Dernières ressources pédagogiques");
GTraductions.add("accueil.ressourcePedagogique.aucuneRessourcePedagogique", "Aucune ressource pédagogique");
GTraductions.add("accueil.ressourcePedagogique.info", "Les 5 dernières ressources pédagogiques");
GTraductions.add("accueil.ressourcePedagogique.deposeLe", "déposé le %s");
GTraductions.add("accueil.DS.titre", "Prochains DS");
GTraductions.add("accueil.DS.hint", "Devoirs sur table programmés");
GTraductions.add("accueil.DSEvaluation.titre", "Prochaines évaluations de compétences");
GTraductions.add("accueil.DSEvaluation.hint", "Evaluations de compétences programmées");
GTraductions.add("accueil.kiosques.mrFiche", '{"titre":"Qu\'est-ce que sont les Manuels numériques ?","html":{"_T":23,"V":"<p>Les&nbsp;Manuels num&eacute;riques&nbsp;sont des ressources disponibles pour l\'ensemble de votre &eacute;tablissement depuis le site web des&nbsp;kiosques num&eacute;riques&nbsp;(KNE, CNS). PRONOTE vous permet d\'acc&eacute;der directement &agrave; ces&nbsp;manuels sans que vous ayez besoin de vous identifier sur le site de ces kiosques. <br />En cliquant sur le lien vers ces&nbsp;ressources depuis votre accueil, votre cahier de textes et vos ressources p&eacute;dagogiques, vous serez redirig&eacute;s vers&nbsp;le kiosque&nbsp;concern&eacute;, plateforme ind&eacute;pendante de PRONOTE.&nbsp;</p>"},"width":410,"height":145,"type":4,"boutons":{"_T":18,"V":1024}}');
GTraductions.add("accueil.travailAFaireAbbr", "Travail à faire");
GTraductions.add("accueil.prochainsCours", "Prochains cours du jour");
GTraductions.add("accueil.mesProchainsCours", "Mes prochains cours");
GTraductions.add("accueil.mesDernieresNotes", "Mes 5 dernières notes");
GTraductions.add("accueil.TAFProchainsJours", "Travail à faire dans les prochains jours");
GTraductions.add("accueil.travailAFaire", "Travail à faire");
GTraductions.add("accueil.dernieresVS", "Derniers évènements de la vie scolaire");
GTraductions.add("accueil.aucunCours", "Aucun cours");
GTraductions.add("accueil.aucunTAF", "Aucun travail à faire n'a été saisi pour cette semaine");
GTraductions.add("accueil.pourle", "Pour le");
GTraductions.add("accueil.pour", "pour");
GTraductions.add("accueil.ou", "ou");
GTraductions.add("accueil.menuPrincipal", "Menu Principal");
GTraductions.add("Mobile.titleBoutonPrecedent", "Élément précédent");
GTraductions.add("Mobile.titleBoutonSuivant", "Élément suivant");
GTraductions.add("Mobile.titleBoutonJourPrecedent", "Jour précédent");
GTraductions.add("Mobile.titleBoutonJourSuivant", "Jour suivant");
GTraductions.add("Mobile.AucunCours", "Aucun Cours");
GTraductions.add("Mobile.aucuneNote", "Aucune note saisie");
GTraductions.add("actualites.ToutesVategories", "Toutes");
GTraductions.add("actualites.AucuneActualite", "Sélectionnez une information ou un sondage");
GTraductions.add("actualites.PrisConnaissance", "J'ai pris connaissance de cette information");
GTraductions.add("actualites.TailleMaximale", "Vous avez atteint la taille maximale");
GTraductions.add("actualites.UniquementNonLues", "Uniquement les non lues");
GTraductions.add("actualites.ATitreIndividuel", "À titre individuel");
GTraductions.add("actualites.AProposDe", "Relatif à %s");
GTraductions.add("actualites.ValiderReponse", "Validez votre réponse");
GTraductions.add("actualites.ValiderModification", "Validez vos modifications");
GTraductions.add("actualites.SaisirReponse", "Saisissez votre réponse ici !");
GTraductions.add("actualites.Colonnes.Titre", "Titre");
GTraductions.add("actualites.Colonnes.Categorie", "Catégorie");
GTraductions.add("actualites.Colonnes.Auteur", "Auteur");
GTraductions.add("actualites.Colonnes.Destinataire", "Destinataire");
GTraductions.add("actualites.Colonnes.datePublication", "Date");
GTraductions.add("actualites.Colonnes.AR", "AR");
GTraductions.add("actualites.Reception", "Réception");
GTraductions.add("actualites.Saisie", "Diffusion");
GTraductions.add("actualites.MarquerLu", "Marquer comme lu");
GTraductions.add("actualites.MarquerNonLu", "Marquer comme non lu");
GTraductions.add("actualites.MarquerSupprimee", "Supprimer");
GTraductions.add("actualites.Creation", "Créer une information ou un sondage");
GTraductions.add("actualites.creerInfo", "Diffuser une information");
GTraductions.add("actualites.creerSondage", "Effectuer un sondage");
GTraductions.add("actualites.Publiee", "Publiée");
GTraductions.add("actualites.NatureReponse", "Nature de la réponse");
GTraductions.add("actualites.Oui", "Oui");
GTraductions.add("actualites.Non", "Non");
GTraductions.add("actualites.Classes", "Classes");
GTraductions.add("actualites.Groupes", "Groupes");
GTraductions.add("actualites.Eleves", "Élèves");
GTraductions.add("actualites.Professeurs", "Professeurs");
GTraductions.add("actualites.Responsables", "Responsables");
GTraductions.add("actualites.Personnels", "Personnels");
GTraductions.add("actualites.MaitresDeStage", "Maîtres de stage");
GTraductions.add("actualites.Inspecteurs", "Inspecteurs pédagogiques");
GTraductions.add("actualites.Classe", "Classe");
GTraductions.add("actualites.Groupe", "Groupe");
GTraductions.add("actualites.Eleve", "Élève");
GTraductions.add("actualites.Professeur", "Professeur");
GTraductions.add("actualites.Responsable", "Responsable");
GTraductions.add("actualites.Responsable1", "1er responsable légal");
GTraductions.add("actualites.Responsable2", "2nd responsable légal");
GTraductions.add("actualites.Personnel", "Personnel");
GTraductions.add("actualites.MaitreDeStage", "Maître de stage");
GTraductions.add("actualites.Inspecteur", "Inspecteur pédagogique");
GTraductions.add("actualites.Multiple", "Multiple");
GTraductions.add("actualites.Edition.Modification", "Modification");
GTraductions.add("actualites.Edition.NonModifiable", "La modification du contenu n'est plus possible car certains destinataires ont déjà répondu au message.");
GTraductions.add("actualites.Edition.Creation", "Création d'une actualité");
GTraductions.add("actualites.Edition.Dupliquer", "Dupliquer");
GTraductions.add("actualites.Edition.CopieDe", "%s (copie de)");
GTraductions.add("actualites.Edition.Publier", "Publier");
GTraductions.add("actualites.Edition.Depublier", "Ne pas publier");
GTraductions.add("actualites.Edition.Supprimer", "Supprimer");
GTraductions.add("actualites.Edition.Destinataires", "Destinataires");
GTraductions.add("actualites.Edition.Message", "Message");
GTraductions.add("actualites.Edition.Publication", "Publication");
GTraductions.add("actualites.Edition.Information", "Information");
GTraductions.add("actualites.Edition.Questionnaire", "Sondage");
GTraductions.add("actualites.Edition.AvecAR", "avec accusé de réception");
GTraductions.add("actualites.Edition.ModifPJ", "Modification des pièces jointes");
GTraductions.add("actualites.Edition.ChoixUnique", "Choix unique");
GTraductions.add("actualites.Edition.ChoixMultiple", "Choix multiple");
GTraductions.add("actualites.Edition.Texte", "Réponse à saisir");
GTraductions.add("actualites.Edition.NbrCharTexte", "caractères maximum");
GTraductions.add("actualites.Edition.OngletEntite", "Destinataires liés aux classes (%d) / groupes (%d)");
GTraductions.add("actualites.Edition.OngletIndividu", "Destinataires à titre individuel (%d)");
GTraductions.add("actualites.Edition.OngletSaisie", "Aperçu");
GTraductions.add("actualites.Edition.OngletResultats", "Retours");
GTraductions.add("actualites.Edition.FiltreRepondu", "Afficher uniquement les personnes ayant répondu");
GTraductions.add("actualites.Edition.ColonneDest", "Destinataires");
GTraductions.add("actualites.Edition.ColonneARRecu", "AR reçu");
GTraductions.add("actualites.Edition.ColonneRepondu", "répondu");
GTraductions.add("actualites.Edition.ColonneNonRepondu", "non répondu");
GTraductions.add("actualites.Edition.ColonneReponse", "réponse");
GTraductions.add("actualites.Edition.MenuGrapheCumul", "Générer le graphe des réponses données par \"%s\"");
GTraductions.add("actualites.Edition.MenuGrapheSelection", "Générer le graphe des réponses de la sélection");
GTraductions.add("actualites.Edition.MenuGrapheTotal", "Générer le graphe du total des réponses");
GTraductions.add("actualites.Edition.MenuSupprimerRep", "Supprimer les réponses sélectionnées");
GTraductions.add("actualites.Edition.TitreGrapheCumul", "Diagramme des réponses données par \"%s\"");
GTraductions.add("actualites.Edition.TitreGrapheSelection", "Diagramme des réponses de la sélection (%d)");
GTraductions.add("actualites.Edition.TitreGrapheTotal", "Diagramme du total des réponses");
GTraductions.add("actualites.Edition.ConfSupprimerRep", "Confirmez-vous la suppression des réponses sélectionnées ?");
GTraductions.add("actualites.Edition.MenuToutSelect", "Tout sélectionner");
GTraductions.add("actualites.choix.nouveau", "Création d'un nouveau choix");
GTraductions.add("actualites.choix.monter", "Monter");
GTraductions.add("actualites.choix.descendre", "Descendre");
GTraductions.add("actualites.public.responsables", "Responsables");
GTraductions.add("actualites.public.professeurs", "Équipe pédagogique");
GTraductions.add("actualites.public.personnels", "Personnels");
GTraductions.add("actualites.public.maitreDeStage", "Maîtres de stage");
GTraductions.add("actualites.public.eleves", "Élèves");
GTraductions.add("actualites.SemaineEnCours", "Semaine en cours");
GTraductions.add("actualites.MoisEnCours", "Mois en cours");
GTraductions.add("actualites.AnneeComplete", "Année complète");
GTraductions.add("actualites.AucunDestinataire", "Attention : il n'y a pas de destinataire");
GTraductions.add("actualites.Aucun", "Aucun");
GTraductions.add("actualites.Combo.Titre", "Informations et sondages");
GTraductions.add("actualites.Combo.Reception", "Réception");
GTraductions.add("actualites.Combo.Saisie", "Diffusion");
GTraductions.add("actualites.Cumul.Classe", "Classe");
GTraductions.add("actualites.Cumul.Alphabetique", "Ordre alphabétique");
GTraductions.add("actualites.filtre.equipePedagogique", "Uniquement l'équipe pédagogique");
GTraductions.add("actualites.AucuneActu", "Aucune information");
GTraductions.add("actualites.MesInfos", "Mes informations");
GTraductions.add("actualites.MsgAucunUnDestinataire", "Veuillez sélectionner un destinataire");
GTraductions.add("actualites.MsgAucunContenu", "Veuillez saisir un contenu");
GTraductions.add("actualites.ConfirmationSuppression", "La sélection contient une information avec des réponses. Etes-vous sûr de tout supprimer ?");
GTraductions.add("actualites.Nominatif", "Sondage nominatif");
GTraductions.add("actualites.Anonyme", "Sondage anonyme");
GTraductions.add("actualites.InfoNominatif", "Ce sondage est nominatif");
GTraductions.add("actualites.InfoAnonyme", "Ce sondage est anonyme");
GTraductions.add("actualites.dejaRepondu", "Cet individu a déjà répondu à cette information ou à ce sondage");
GTraductions.add("menus.Message.AucunJourPublie", "Aucun jour publié");
GTraductions.add("Menus.RepasMidi", "Repas de midi");
GTraductions.add("Menus.RepasSoir", "Repas du soir");
GTraductions.add("Menus.Ou", "ou");
GTraductions.add("competences.title.validationAuto", "Validation automatique des items et compétences");
GTraductions.add("competences.titre.validationAuto", "Validation automatique des items et compétences des élèves sélectionnés");
GTraductions.add("competences.titre.validationB2IAuto", "Validation automatique du B2I selon le BO du 27 Novembre 2006");
GTraductions.add("competences.message.validationAuto", "La compétence est acquise lorsque tous les items qui la composent sont acquis\nVoulez-vous continuer ?");
GTraductions.add("competences.message.validationB2IAuto", "Le B2I sera acquis si 80% de ses sous-items sont validés avec au moins 50% d'acquisitions dans chaque domaine.\nVoulez-vous continuer ?");
GTraductions.add("competences.message.suppresionLanguePourBrevet", "Aucune langue vivante étrangère ne sera affectée dans le socle commun et au brevet des collèges.");
GTraductions.add("competences.message.confirmation", "Confirmez-vous cette modification ?");
GTraductions.add("competences.SelectionnezEvaluation", "Sélectionnez une évaluation");
GTraductions.add("competences.items", "Items");
GTraductions.add("competences.itemsEvalues", "Items évalués");
GTraductions.add("competences.date", "Date");
GTraductions.add("competences.choixItemsEvaluer", "Choix des items à évaluer");
GTraductions.add("competences.etat", "Niveau");
GTraductions.add("competences.valideLe", "Validé le");
GTraductions.add("competences.acquisition", "Niveau d'acquisition");
GTraductions.add("competences.eleve", "Élève");
GTraductions.add("competences.eleve", "élèves");
GTraductions.add("competences.evaluation", "Evaluation");
GTraductions.add("competences.evaluation", "Evaluations");
GTraductions.add("competences.matiere", "Matière");
GTraductions.add("competences.competencesEvaluees", "Compétences évaluées");
GTraductions.add("competences.competencesAcquises", "Compétences acquises");
GTraductions.add("competences.competencesValidees", "Compétences validées");
GTraductions.add("competences.competencesValideesNonOptionnel", "Compétences non optionnelles validées");
GTraductions.add("competences.observations", "Observations");
GTraductions.add("competences.competenceB2I", "Brevet informatique et internet (B2i)");
GTraductions.add("competences.competenceA2", "Niveau A2 en");
GTraductions.add("competences.titreAide", "Connaissances et capacités exigibles pour le B2i");
GTraductions.add("competences.aide", "(Extrait de l'arrêté du 18/12/2007 - JO du 28/12/2007)\n\nAu collège, l'attestation est délivrée lorsque 80 % des items (et au moins la moitié des items de chacun des domaines) sont validés.\n\nAu lycée, l'attestation est délivrée lorsque sont validés en dehors des items optionnels 80 % des items, et au moins la moitié des items de chacun des domaines.");
GTraductions.add("competences.conserverB2I", "Souhaitez-vous conserver le B2I acquis ?");
GTraductions.add("competences.languePourBrevet", "Langue évaluée au niveau A2 dans le socle commun et au brevet des collèges");
GTraductions.add("competences.choixValidationLVEPalier", "Langue choisie dans le livret personnel de compétences");
GTraductions.add("competences.message.choixLVEAnnulePalier2", "Le niveau A1 en langue vivante étrangère ne sera pas renseigné dans le livret personnel de compétences au palier 2.");
GTraductions.add("competences.message.choixLVEAnnulePalier3", "Le niveau A2 en langue vivante étrangère ne sera pas renseigné dans le livret personnel de compétences au palier 3.");
GTraductions.add("competences.message.choixLVEAnnuleAutresPaliers", "Aucune langue vivante étrangère ne sera renseignée dans le livret personnel de compétences personnalisé.");
GTraductions.add("competences.pourLaCompetence", "Pour la compétence");
GTraductions.add("competences.ServiceLVE", "Service LVE");
GTraductions.add("competences.acquiseParDefaut", "Marquer comme validée par défaut");
GTraductions.add("competences.intitule", "Intitulé");
GTraductions.add("competences.descriptif", "Descriptif");
GTraductions.add("competences.message.CompetenceManquant", "aucune compétence évaluée n'est renseignée");
GTraductions.add("competences.message.ServiceLVEManquant", "le service de langue vivante étrangère (LVE) n'est pas renseigné");
GTraductions.add("competences.message.IntituleManquant", "l'intitulé n'est pas renseigné");
GTraductions.add("competences.message.ConfirmationSuppression", "Attention ! La suppression de l'évaluation de cet item va entraîner la suppression des données déjà saisies pour les élèves.\nVoulez-vous vraiment continuer ?");
GTraductions.add("competences.Parametrage", "Options du bilan par classe");
GTraductions.add("competences.AfficherDates", "Afficher les dates");
GTraductions.add("competences.AfficherNiveauxAcquisition", "Afficher les niveaux d'acquisition");
GTraductions.add("competences.AfficherEvaluationsHistoriques", "Afficher les évaluations des années précédentes");
GTraductions.add("competences.OrdreEvaluations", "Afficher les évaluations par ordre chronologique inverse");
GTraductions.add("competences.Pourcentage", "%");
GTraductions.add("competences.PourcentageAcquis", "Afficher le pourcentage d'items acquis");
GTraductions.add("competences.ValidePar", "Validé par");
GTraductions.add("competences.ToutesEvals", "Toutes les évaluations");
GTraductions.add("competences.EvalsAnneeEnCours", "Évaluations de l'année en cours");
GTraductions.add("competences.AucuneEval", "Aucune évaluation");
GTraductions.add("competences.EvalsPeriode", "Évaluations du %s");
GTraductions.add("competences.ImpossibleModifierEvaluationHistorique", "Impossible de modifier une évaluation historique");
GTraductions.add("competences.EleveHorsEtablissement", "L'élève n'est plus dans l'établissement");
GTraductions.add("competences.EleveHorsClasse", "L'élève n'est plus dans la classe");
GTraductions.add("competences.EleveHorsGroupe", "L'élève n'est plus dans le groupe");
GTraductions.add("competences.AucuneLangue", "Aucune langue");
GTraductions.add("competences.CompetenceAcquiseAnneePrecedente", "La compétence a été acquise au cours de l'année précédente");
GTraductions.add("competences.ClasseGroupe", "Classe/Groupe");
GTraductions.add("competences.service", "Service");
GTraductions.add("competences.Informations", "Informations");
GTraductions.add("competences.palier", "Palier");
GTraductions.add("competences.ValiderAbbrev", "Val.");
GTraductions.add("competences.MarquerValider", "Marquer comme validé par défaut");
GTraductions.add("competences.DupliquerEvalLVE", "Dupliquer l'évaluation concernant la compétence LVE sur les services de langue");
GTraductions.add("competences.DupliquerEvalService", "Dupliquer l'évaluation sur les services");
GTraductions.add("competences.ModificationEvaluation", "Modification d'une évaluation");
GTraductions.add("competences.CreationEvaluation", "Création d'une évaluation");
GTraductions.add("competences.MsgEvaluationDupliquee", "L'évaluation a été dupliquée, n'oubliez pas de valider.");
GTraductions.add("competences.Dupliquer", "Dupliquer");
GTraductions.add("competences.etatAcquisition", "Etat d'acquisition");
GTraductions.add("competences.nbr", "Nb.");
GTraductions.add("competences.nbrHint", "Nombre d'évaluations du domaine/items/sous-items");
GTraductions.add("competence.titreBandeau", "Bulletin de compétences");
GTraductions.add("competence.itemsEvalues", "Items évalués");
GTraductions.add("competence.niveau", "Niveau");
GTraductions.add("competences.domaine", "Domaine(s)");
GTraductions.add("competences.titreGraphe", "Taux d'évaluations acquises par compétence");
GTraductions.add("competences.pasDAffichageGraphe", "Pour afficher le graphe de l'élève, celui-ci doit être évalué dans au moins 3 compétences.");
GTraductions.add("competences.titreChoixGraphe", "Afficher le taux d'évaluations de : ");
GTraductions.add("competences.choixGrapheClasse", "Classe");
GTraductions.add("competences.choixGrapheNiveau", "Niveau");
GTraductions.add("competences.Parametrage", "Paramétrage");
GTraductions.add("competences.AjouterCommentaire", "Ajouter un commentaire");
GTraductions.add("competences.ModifierDate", "Modifier la date");
GTraductions.add("competences.GrapheAraignee", "Graphe araignée");
GTraductions.add("competences.MFicheEvaluationCompetences", '{"titre":"Comment indiquer un niveau d\'acquisition ?","html":{"_T":23,"V":"<div><span style=\\\"font-family: Arial; font-size: 12px;\\\">Vous </span><span style=\\\"font-family: Arial; font-size: 12px;\\\">pouvez indiquer les niveaux d\'acquisitions des &eacute;l&egrave;ves&nbsp;en utilisant les raccourcis claviers ci-dessous </span><span style=\\\"font-family: Arial; font-size: 12px;\\\">:</span></div><div style=\\\"text-indent: 0px; margin-left: 0px;\\\"><span style=\\\"font-family: Arial; font-size: 12px;\\\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>Alt +&nbsp;</strong></span><strong><span style=\\\"font-size: 12px; font-family: Arial;\\\">0</span></strong><span style=\\\"font-family: Arial; font-size: 12px;\\\"> : Aucune &eacute;valuation</span></div><div style=\\\"text-indent: 0px; margin-left: 0px;\\\"><strong><span style=\\\"font-family: Arial; font-size: 12px;\\\"><span style=\\\"font-family: Arial; font-size: 12px;\\\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>Alt + 1</span></strong><span style=\\\"font-family: Arial; font-size: 12px;\\\">&nbsp;: Expert</span></div><div style=\\\"text-indent: 0px; margin-left: 0px;\\\"><span style=\\\"font-family: Arial; font-size: 12px;\\\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>Alt + 2</strong></span><span style=\\\"font-family: Arial; font-size: 12px;\\\">&nbsp;: Acquis</span></div><div style=\\\"text-indent: 0px; margin-left: 0px;\\\"><span style=\\\"font-family: Arial; font-size: 12px;\\\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>&nbsp;Alt + 3</strong></span><span style=\\\"font-family: Arial; font-size: 12px;\\\"> :&nbsp;Presque acquis</span></div><div style=\\\"text-indent: 0px; margin-left: 0px;\\\"><span style=\\\"font-family: Arial; font-size: 12px;\\\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><strong><span style=\\\"font-family: Arial; font-size: 12px;\\\">Alt + 4</span></strong><span style=\\\"font-family: Arial; font-size: 12px;\\\">&nbsp;: En cours d\'acquisition</span></div><div style=\\\"text-indent: 0px; margin-left: 0px;\\\"><span style=\\\"font-family: Arial; font-size: 12px;\\\"><strong><span style=\\\"font-family: Arial; font-size: 12px;\\\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Alt +&nbsp;5</span></strong><span style=\\\"font-family: Arial; font-size: 12px;\\\">&nbsp;: D&eacute;but d\'acquisition</span></span></div><div style=\\\"text-indent: 0px; margin-left: 0px;\\\"><span style=\\\"font-family: Arial; font-size: 12px;\\\"><span style=\\\"font-family: Arial; font-size: 12px;\\\"><strong><span style=\\\"font-family: Arial; font-size: 12px;\\\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Alt +&nbsp;6</span></strong><span style=\\\"font-family: Arial; font-size: 12px;\\\">&nbsp;: Non acquis</span></span></span></div><div style=\\\"text-indent: 0px; margin-left: 0px;\\\"><span style=\\\"font-family: Arial; font-size: 12px;\\\"><span style=\\\"font-family: Arial; font-size: 12px;\\\"><span style=\\\"font-family: Arial; font-size: 12px;\\\"><strong><span style=\\\"font-family: Arial; font-size: 12px;\\\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Alt +&nbsp;A</span></strong><span style=\\\"font-family: Arial; font-size: 12px;\\\">&nbsp;: Absent</span></span></span></span></div><div style=\\\"text-indent: 0px; margin-left: 0px;\\\"><span style=\\\"font-family: Arial; font-size: 12px;\\\"><span style=\\\"font-family: Arial; font-size: 12px;\\\"><span style=\\\"font-family: Arial; font-size: 12px;\\\"><span style=\\\"font-family: Arial; font-size: 12px;\\\"><strong><span style=\\\"font-family: Arial; font-size: 12px;\\\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Alt + N </span></strong><span style=\\\"font-family: Arial; font-size: 12px;\\\">: Non &eacute;valu&eacute;</span></span></span></span></span></div>"},"width":410,"height":145,"type":4,"boutons":{"_T":18,"V":1024}}');
GTraductions.add("competences.SensDeSaisieHorizontal", "Continuer l'édition horizontalement");
GTraductions.add("competences.SensDeSaisieVertical", "Continuer l'édition verticalement");
GTraductions.add("evaluations.creer", "Créer une évaluation");
GTraductions.add("evaluations.colonne.intitule", "Intitulé");
GTraductions.add("evaluations.colonne.date", "Date");
GTraductions.add("evaluations.colonne.periode", "Période");
GTraductions.add("evaluations.colonne.publieeLe", "Publiée le");
GTraductions.add("evaluations.CmdSupprimerCorrige", "Supprimer le corrigé");
GTraductions.add("evaluations.MsgConfirmSupprCorrige", "Voulez-vous supprimer le corrigé de l'évaluation ?");
GTraductions.add("evaluations.aucunCorrige", "Aucun corrigé");
GTraductions.add("evaluations.AvecLeCorrige", "Avec le corrigé");
GTraductions.add("stage.page.duType", "Stage du type");
GTraductions.add("stage.page.sujet", "Sujet");
GTraductions.add("stage.page.professeurReferent", "Professeur référent");
GTraductions.add("stage.page.stageChez", "Stage effectué chez");
GTraductions.add("stage.page.aucunStage", "Il n'y a aucun stage pour cet élève");
GTraductions.add("stage.page.conventionSignee", "Convention signée");
GTraductions.add("stage.page.appreciation", "Appréciations des maîtres de stages et professeurs référents");
GTraductions.add("stage.page.suivi", "Stage suivi par");
GTraductions.add("stage.page.titresListeSuivi.evenement", "Évènement");
GTraductions.add("stage.page.titresListeSuivi.date", "Date");
GTraductions.add("stage.page.titresListeSuivi.lieu", "Lieu");
GTraductions.add("stage.page.titresListeSuivi.commentaire", "Commentaire");
GTraductions.add("stage.page.titresListeSuivi.publier", "Pub.");
GTraductions.add("stage.page.aucunMDS", "Aucun maître de stage ou professeur référent n'est affecté");
GTraductions.add("stage.page.pasDeSujetDetaille", "Pas de sujet détaillé ...");
GTraductions.add("stage.page.annexePedagogique", "Annexe pédagogique");
GTraductions.add("stage.page.ligneCreation", "Créer un suivi");
GTraductions.add("stage.fiche.titre", "Modification du stage de l'élève");
GTraductions.add("stage.fiche.titreInformations", "Informations supplémentaires du stage de l'élève");
GTraductions.add("stage.fiche.sujetDetaille", "Sujet détaillé");
GTraductions.add("stage.fiche.objectifs", "Objectifs");
GTraductions.add("stage.fiche.activitesPrevues", "Activités prévues");
GTraductions.add("stage.fiche.competencesVisees", "Compétences visées");
GTraductions.add("stage.fiche.modalitesConcertation", "Modalités de concertation");
GTraductions.add("stage.fiche.modalitesEvaluation", "Modalités d'évaluation");
GTraductions.add("stage.fiche.commentaire", "Commentaire");
GTraductions.add("stage.fiche.publier", "Publier sur l'Espace Parents");
GTraductions.add("stage.menu.creer", "Créer un nouvel évènement");
GTraductions.add("stage.menu.modifier", "Modifier l'évènement");
GTraductions.add("stage.menu.supprimer", "Supprimer l'évènement");
GTraductions.add("stage.fenetresuivi.creer", "Création d'un suivi de stage");
GTraductions.add("stage.fenetresuivi.modifier", "Modification de suivi de stage");
GTraductions.add("stage.message.supprimer", "Voulez-vous supprimer cet évènement du suivi de stage ?");
GTraductions.add("stage.comboStage", "Liste déroulante : Choisissez un stage:");
GTraductions.add("stage.msgConfirmSupprSuiviStage", "La pièce jointe %s est utilisée dans %d autre(s) stage(s).");
GTraductions.add("stage.msgConfirmSupprPJSuiviStage", "Confirmez-vous la suppression du document « %s » sur le serveur ?");
GTraductions.add("stage.Horaires", "Horaires");
GTraductions.add("stage.TelFixe", "Tél. Fixe");
GTraductions.add("stage.TelPortable", "Tél. Port.");
GTraductions.add("stage.Fax", "Fax");
GTraductions.add("stage.listeStagiaire.stagiaire", "Stagiaire");
GTraductions.add("stage.listeStagiaire.sujet", "Sujet");
GTraductions.add("stage.listeStagiaire.entreprise", "Entreprise");
GTraductions.add("stage.listeStagiaire.maitresDeStage", "Maîtres de stage");
GTraductions.add("stage.listeStagiaire.parametres", "Paramètres d'affichage");
GTraductions.add("stage.listeStagiaire.comboStage", "Liste déroulante : Choisissez une session de stage:");
GTraductions.add("stage.listeStagiaire.infosStagiaire", "Informations du stagiaire");
GTraductions.add("stage.listeStagiaire.infosEntreprise", "Informations de l'entreprise");
GTraductions.add("stage.listeStagiaire.dateNaissance", "Date de naissance");
GTraductions.add("stage.listeStagiaire.formation", "Formation");
GTraductions.add("stage.listeStagiaire.telephone", "Téléphone");
GTraductions.add("stage.listeStagiaire.coordonneesEntreprise", "Coordonnées de l'entreprise");
GTraductions.add("stage.listeStagiaire.responsableEntreprise", "Responsable de l'entreprise");
GTraductions.add("iCal.hint", "Exporter l'emploi du temps au format iCal");
GTraductions.add("iCal.hint", "Exporter l'agenda au format iCal");
GTraductions.add("iCal.fenetre.titre", "Export au format iCal");
GTraductions.add("iCal.fenetre.sousTitre1", "Semaines à prendre en compte");
GTraductions.add("iCal.fenetre.sousTitre2", "2 modes de récupération de l'emploi du temps");
GTraductions.add("iCal.fenetre.sousTitre2", "2 modes de récupération de l'agenda");
GTraductions.add("iCal.fenetre.semainesPubliees", "Toutes les semaines publiées");
GTraductions.add("iCal.fenetre.semainesSelectionnees", "Uniquement les semaines sélectionnées");
GTraductions.add("iCal.fenetre.titreFichier", "Cliquez sur le lien ci-dessus pour télécharger le fichier iCal  de l'emploi du temps tel qu'il est actuellement (il ne sera pas mis à jour automatiquement)");
GTraductions.add("iCal.fenetre.titreFichier", "Cliquez sur le lien ci-dessus pour télécharger le fichier iCal  de l'agenda tel qu'il est actuellement (il ne sera pas mis à jour automatiquement)");
GTraductions.add("iCal.fenetre.titreLienPermanent", "Copiez l'adresse ci-dessous dans votre \"gestionnaire d'agenda\" pour le synchroniser avec PRONOTE (votre emploi du temps sera mis à jour en temps réel)");
GTraductions.add("iCal.fenetre.titreLienPermanent", "Copiez l'adresse ci-dessous dans votre \"gestionnaire d'agenda\" pour le synchroniser avec PRONOTE (votre agenda sera mis à jour en temps réel)");
GTraductions.add("iCal.fenetre.QRCode", "Vous pouvez aussi utiliser le code ci-dessous pour récupérer l'adresse");
GTraductions.add("Fenetre_Date.Titre", "Choisir un jour");
GTraductions.add("Fenetre_Date.MoisPrecedent", "Mois précédent");
GTraductions.add("Fenetre_Date.MoisSuivant", "Mois suivant");
GTraductions.add("Fenetre_Date.AucuneDate", "Aucune date");
GTraductions.add("ficheScolaire.livretScolaire", "Livret scolaire");
GTraductions.add("ficheScolaire.titreColService", "Service");
GTraductions.add("ficheScolaire.titreColDiscipline", "Discipline");
GTraductions.add("ficheScolaire.titreColPeriode", "Période");
GTraductions.add("ficheScolaire.titreColAbbrPeriode", "Per.");
GTraductions.add("ficheScolaire.titreColRang", "Rang");
GTraductions.add("ficheScolaire.titreColMoyEleve", "Moyenne de l'élève");
GTraductions.add("ficheScolaire.titreColAbbrMoyEleve", "Moy Eleve");
GTraductions.add("ficheScolaire.titreColMoyClasse", "Moyenne de la classe");
GTraductions.add("ficheScolaire.titreColAbbrMoyClasse", "Moy Classe");
GTraductions.add("ficheScolaire.titreColInf8", "<8");
GTraductions.add("ficheScolaire.titreCol8A12", "Entre 8 et 12");
GTraductions.add("ficheScolaire.titreColSup12", ">=12");
GTraductions.add("ficheScolaire.titreColCompetences", "Evaluation des compétences");
GTraductions.add("ficheScolaire.titreColAppreciations", "Appréciations des professeurs");
GTraductions.add("ficheScolaire.titreColAppreciationsAnn", "Appréciation annuelle");
GTraductions.add("ficheScolaire.autresServices", "Autres services de notation");
GTraductions.add("ficheScolaire.annuel", "Ann.");
GTraductions.add("ficheScolaire.moyGenerale", "Moyenne générale");
GTraductions.add("ficheScolaire.messageAucunServicePourEleve", "Aucun service de notation ne concerne cet élève");
GTraductions.add("ficheScolaire.messageAucuneDonneeDiscipline", "Aucune donnée pour la discipline sélectionnée");
GTraductions.add("ficheScolaire.messageAucuneDonnee", "Aucune donnée");
GTraductions.add("ficheScolaire.AvisDuChefDetablissement", "Avis du chef d'établissement");
GTraductions.add("ficheScolaire.AvisEnVueDuBac", "Avis en vue de l'examen du baccalauréat");
GTraductions.add("ficheScolaire.Engagements", "Engagements de l'élève");
GTraductions.add("ficheScolaire.Investissement", "Avis de l'équipe pédagogique et du CPE sur l'investissement de l'élève");
GTraductions.add("ficheScolaire.AvisNonRempli", "Avis non rempli");
GTraductions.add("ficheScolaire.messageClasseSansFiliere", "Le livret scolaire de cette filière ne comporte aucune compétence.");
GTraductions.add("ficheScolaire.messageGroupeSansFiliere", "Aucune classe du groupe n'est affiliée à un livret scolaire officiel");
GTraductions.add("ficheScolaire.titreSaisieEvaluations", "Saisie des évaluations");
GTraductions.add("ficheScolaire.engagement.code", "Code");
GTraductions.add("ficheScolaire.engagement.titre", "Engagements et responsabilités de l'élève au sein de l'établissement");
GTraductions.add("ficheScolaire.engagement.aucun", "Aucun engagement saisi");
GTraductions.add("ficheScolaire.engagement.commentaire", "Observations éventuelles");
GTraductions.add("ficheScolaire.investissement.titre", "Avis de l'équipe pédagogique et du conseiller principal d'éducation sur l'investissement de l'élève et sa participation à la vie du lycée");
GTraductions.add("ficheScolaire.investissement.aucun", "Aucun avis sur l'investissement de l'élève saisi");
GTraductions.add("ficheScolaire.Accessible.inf8", "Inférieures à 8");
GTraductions.add("ficheScolaire.Accessible.de8a12", "Entre 8 et 12");
GTraductions.add("ficheScolaire.Accessible.sup12", "Supérieures à 12");
GTraductions.add("ficheScolaire.Accessible.evaluation", "Evaluation");
GTraductions.add("ficheScolaire.Accessible.pasevalue", "Non évalué");
GTraductions.add("ficheScolaire.Accessible.RepartitionDesNotesDansLaClasse", "Répartition des notes dans la classe");
GTraductions.add("ficheScolaire.Accessible.Competences", "Compétences");
GTraductions.add("ficheScolaire.Signataire.AvisCE", "Auteur de l'avis du chef d'établissement");
GTraductions.add("ficheScolaire.Signataire.Engagement", "Choix du CPE");
GTraductions.add("ficheScolaire.Signataire.Investissement", "Choix du professeur principal");
GTraductions.add("ficheScolaire.boutonGraphe", "Profil annuel de l'élève");
GTraductions.add("ficheScolaire.titreGraphe", "Profil annuel de %s");
GTraductions.add("ficheScolaire.pasDAffichageGraphe", "Pour afficher un profil significatif, l'élève doit avoir été noté dans au moins 3 matières");
GTraductions.add("ficheScolaire.optionPDFGraphe", "Avec le profil annuel (graphe)");
GTraductions.add("dossierVieScolaire.titreRecapitulatif", "Récapitulatif annuel");
GTraductions.add("dossierVieScolaire.titreDossiers", "Dossiers particuliers");
GTraductions.add("dossierVieScolaire.creerDossier", "Créer un dossier");
GTraductions.add("dossierVieScolaire.ajouterElement", "Ajouter un élément");
GTraductions.add("dossierVieScolaire.supprimerElement", "Voulez-vous retirer cet élément du dossier ?");
GTraductions.add("dossierVieScolaire.supprimerDossier", "Voulez-vous supprimer le dossier : %s ?");
GTraductions.add("dossierVieScolaire.suppressionPunition", "Attention : cette punition ne pouvant pas exister sans dossier, elle sera supprimée de votre base de données.");
GTraductions.add("dossierVieScolaire.suppressionVSDossier", "Ce dossier a été créé par %s. Confirmez-vous la suppression de ce dossier ?");
GTraductions.add("dossierVieScolaire.suppressionVSElement", "Ce dossier a été créé par %s. Confirmez-vous la suppression de cet élément du dossier ?");
GTraductions.add("dossierVieScolaire.viescolaire", "la Vie Scolaire");
GTraductions.add("dossierVieScolaire.professeur", "un autre professeur");
GTraductions.add("dossierVieScolaire.choisirCategorie", "Choisir une catégorie");
GTraductions.add("dossierVieScolaire.droitPublier", "Vous n'avez pas les droits nécessaires pour publier/dépublier les dossiers de vie scolaire");
GTraductions.add("dossierVieScolaire.droitAutres", "Vous n'avez pas les droits nécessaires pour modifier les dossiers de vie scolaire saisis par d'autres utilisateurs");
GTraductions.add("dossierVieScolaire.msgConfirmSupprDossier", "La pièce jointe %s est utilisée dans %d autre(s) dossier(s) de vie scolaire.");
GTraductions.add("dossierVieScolaire.questConfirmSupprDossier", "Confirmez-vous sa suppression du serveur ?");
GTraductions.add("dossierVieScolaire.msgConfirmSupprPJDossier", "Confirmez-vous la suppression du document « %s » sur le serveur ?");
GTraductions.add("dossierVS.msgMotifDossierObligatoire", "Vous devez renseigner le motif du dossier");
GTraductions.add("dossierVS.titreIncident", "Genre de l'incident");
GTraductions.add("dossierVieScolaire.Editer", "Editer");
GTraductions.add("dossierVieScolaire.ReponseAbr", "R");
GTraductions.add("dossierVieScolaire.listeTitres", "Événement");
GTraductions.add("dossierVieScolaire.listeTitres", "Date");
GTraductions.add("dossierVieScolaire.listeTitres", "Demandeur / Resp. adm.");
GTraductions.add("dossierVieScolaire.listeTitres", "Interlocuteur");
GTraductions.add("dossierVieScolaire.listeTitres", "Complément d'information");
GTraductions.add("dossierVieScolaire.editionMotifs.confirmSuppr", "Confirmez-vous la suppression de ce motif de dossier ?");
GTraductions.add("dossierVieScolaire.editionMotifs.msgSupprImpossibleUtilise", "Ce motif est utilisé dans au moins un dossier de vie scolaire, une punition ou une sanction.");
GTraductions.add("dossierVieScolaire.editionMotifs.msgSupprImpossibleDefaut", "Ce motif étant crée par défaut, il ne peut pas être supprimé !");
GTraductions.add("dossierVieScolaire.editionMotifs.msgSupprImpossible", "Suppression impossible");
GTraductions.add("selecteurPJ.ajoutNouvellePJ", "Ajouter une nouvelle pièce jointe");
GTraductions.add("selecteurPJ.ajoutPJExistante", "Ouvrir le gestionnaire de pièces jointes");
GTraductions.add("selecteurPJ.msgEchecLibelleFichier", "Un document portant le même nom existe déjà. Veuillez renommer le document.");
GTraductions.add("selecteurPJ.msgEchecTailleFichier", "La taille des documents joints est limitée à %s Ko.");
GTraductions.add("selecteurPJ.supprimerPJ", "Supprimer");
GTraductions.add("selecteurPJ.msgConfirmPJ", "Confirmez-vous la suppression du document « %s » sur le serveur ?");
GTraductions.add("dossierVieScolaire.fenetre.titre", "Création d'un dossier de suivi de la vie scolaire");
GTraductions.add("dossierVieScolaire.fenetre.titreModification", "Modification de dossier");
GTraductions.add("dossierVieScolaire.fenetre.date", "Date");
GTraductions.add("dossierVieScolaire.fenetre.categorie", "Catégorie");
GTraductions.add("dossierVieScolaire.fenetre.motif", "Motif");
GTraductions.add("dossierVieScolaire.fenetre.infoEditionMotif", "Édition des motifs");
GTraductions.add("dossierVieScolaire.fenetre.respAdmin", "Resp. administratif");
GTraductions.add("dossierVieScolaire.fenetre.commentaires", "Commentaire");
GTraductions.add("dossierVieScolaire.fenetre.contexte", "Contexte");
GTraductions.add("dossierVieScolaire.fenetre.lieu", "Lieu");
GTraductions.add("dossierVieScolaire.fenetre.victime", "Victime");
GTraductions.add("dossierVieScolaire.fenetre.temoin", "Temoin");
GTraductions.add("fenetrePJ.filtre.uniquementPJUtilisees", "Afficher uniquement les pièces jointes utilisées");
GTraductions.add("fenetrePJ.filtre.uniquementLiensUtilisees", "Afficher uniquement les sites internet utilisés");
GTraductions.add("fenetrePJ.filtre.memeMatiere", "Pour les cours de la même matière");
GTraductions.add("fenetrePJ.filtre.memeClasseGpe", "Pour les cours de la même classe ou du même groupe");
GTraductions.add("fenetrePJ.filtre.today", "Aujourd'hui");
GTraductions.add("fenetrePJ.filtre.15jours", "depuis 15 jours");
GTraductions.add("fenetrePJ.filtre.1mois", "depuis 1 mois");
GTraductions.add("fenetrePJ.filtre.3mois", "depuis 3 mois");
GTraductions.add("fenetrePJ.filtre.6mois", "depuis 6 mois");
GTraductions.add("fenetrePJ.filtre.12mois", "sur toute l'année");
GTraductions.add("fenetrePJ.titre.gestionPJ", "Gestion des pièces jointes");
GTraductions.add("fenetrePJ.titre.gestionSites", "Gestion des sites internet");
GTraductions.add("fenetrePJ.siteInternet", "Site internet");
GTraductions.add("fenetrePJ.nomDocument", "Nom du document");
GTraductions.add("fenetrePJ.majPJ", "Mettre à jour le document");
GTraductions.add("fenetrePJ.supprimerPJ", "Supprimer le document sélectionné");
GTraductions.add("fenetrePJ.supprimer", "Supprimer");
GTraductions.add("fenetrePJ.le", "le %s");
GTraductions.add("fenetreCorrespondance.titre", "Ajouter une correspondance en tant qu'événement du dossier");
GTraductions.add("fenetreCorrespondance.date", "Date");
GTraductions.add("fenetreCorrespondance.type", "Type du contact");
GTraductions.add("fenetreCorrespondance.respAdmin", "Resp. administratif");
GTraductions.add("fenetreCorrespondance.commentaires", "Saisissez un commentaire");
GTraductions.add("fenetreCorrespondance.interlocuteur", "Resp. de l'élève");
GTraductions.add("fenetreCorrespondance.envoi", "Envoi");
GTraductions.add("fenetreCorrespondance.reponse", "Réception");
GTraductions.add("fenetreMotifs.titre", "Sélectionner un motif");
GTraductions.add("fenetreMotifs.motif", "Motif");
GTraductions.add("fenetreMotifs.genre", "Type d'incident");
GTraductions.add("SousCategorieDossier.NonRenseigne", "Autres motifs");
GTraductions.add("SousCategorieDossier.AtteintesAAutrui", "Atteintes à autrui");
GTraductions.add("SousCategorieDossier.AtteintesALaSecurite", "Atteintes à la sécurité");
GTraductions.add("SousCategorieDossier.AtteintesAuxBiens", "Atteintes aux biens");
GTraductions.add("SousCategorieDossier.AutresFaitsDeViolence", "Autres faits de violence");
GTraductions.add("fenetreActions.titre", "Sélection des actions");
GTraductions.add("fenetreActions.libelle", "Libellé");
GTraductions.add("fenetrePunition.titre", "Ajouter une punition en tant qu'événement du dossier");
GTraductions.add("fenetrePunition.nonAffectees", "Afficher uniquement les punitions qui ne sont affectées à aucun dossier");
GTraductions.add("fenetrePunition.date", "Date");
GTraductions.add("fenetrePunition.punition", "Punition");
GTraductions.add("fenetrePunition.motif", "Motif");
GTraductions.add("fenetrePunition.demandeur", "Demandeur");
GTraductions.add("fenetrePunition.programmeeLe", "Programmée le");
GTraductions.add("fenetrePunition.realiseeLe", "Réalisée le");
GTraductions.add("fenetrePunition.Accessible_comboType", "Liste déroulante : Choisissez un type:");
GTraductions.add("fenetrePunition.Accessible_comboDuree", "Liste déroulante : Choisissez une durée:");
GTraductions.add("fenetrePunition.Accessible_comboDate", "Liste déroulante : Choisissez une date:");
GTraductions.add("fenetreSaisiePunition.type", "Type");
GTraductions.add("fenetreSaisiePunition.motif", "Motif");
GTraductions.add("fenetreSaisiePunition.duree", "Durée");
GTraductions.add("fenetreSaisiePunition.circonstances", "Circonstances");
GTraductions.add("fenetreSaisiePunition.taf", "Travail à faire");
GTraductions.add("fenetreSaisiePunition.aRendre", "A rendre le");
GTraductions.add("fenetreSaisiePunition.aRendreMin", "à rendre le");
GTraductions.add("fenetreSaisiePunition.creerPunition", "Ajouter une punition");
GTraductions.add("fenetreSaisiePunition.modifierPunition", "Modifier une punition");
GTraductions.add("fenetreSaisiePunition.creerExclusion", "Créer une exclusion");
GTraductions.add("fenetreSaisiePunition.modifierExclusion", "Modifier une exclusion");
GTraductions.add("fenetreSaisiePunition.publierEspaceParent", "Publier sur l'espace parent");
GTraductions.add("fenetreSaisiePunition.suiteDonnee", "Suite donnée");
GTraductions.add("fenetreSaisiePunition.aProgrammer", "A programmer");
GTraductions.add("fenetreSaisiePunition.prevenirResponsables", "Prévenir les responsables");
GTraductions.add("fenetreSaisiePunition.publierElementPunitionDossier", "Publier le dossier lié dans les dossiers de la vie scolaire sur l'Espace Parents");
GTraductions.add("fenetreSaisiePunition.publierPunition", "Publier la punition dans le récapitulatif de la vie scolaire sur l'Espace Parents");
GTraductions.add("fenetreSaisiePunition.DatePasUnJoursOuvre", "Le %s n'est pas un jour ouvré");
GTraductions.add("fenetreRecupIdMDP.titre", "Récupérer votre identifiant / mot de passe");
GTraductions.add("fenetreRecupIdMDP.header", "La récupération de vos identifiant et mot de passe se fait en 3 étapes, vous ne devez en aucun cas fermer cette fenêtre tant que vous n'avez pas rempli les 3 étapes.");
GTraductions.add("fenetreRecupIdMDP.stage1", "Saisissez votre adresse e-mail");
GTraductions.add("fenetreRecupIdMDP.stage1_bis", "(celle que vous avez donné à l'établissement)");
GTraductions.add("fenetreRecupIdMDP.stage2", "Saisissez votre code de sécurité reçu par e-mail");
GTraductions.add("fenetreRecupIdMDP.stage3", "Définissez votre nouveau mot de passe");
GTraductions.add("fenetreRecupIdMDP.stage", "Etape");
GTraductions.add("fenetreRecupIdMDP.stage2_ok", "Nous vous avons envoyé un e-mail avec votre identifiant et un code de sécurité valable pendant 15 minutes et uniquement sur cette page.");
GTraductions.add("fenetreRecupIdMDP.stage2_ko_multi", "Votre adresse e-mail est définie pour plusieurs comptes, veuillez entrer en relation avec votre contact technique pour changer de mot de passe.");
GTraductions.add("fenetreRecupIdMDP.stage2_ko_zero", "Nous n'avons pas trouvé votre adresse dans la base, veuillez entrer en relation avec votre contact technique pour changer de mot de passe.");
GTraductions.add("fenetreRecupIdMDP.stage3_ok", "Votre mot de passe a été mis à jour, cliquez sur terminer pour vous connecter.");
GTraductions.add("fenetreRecupIdMDP.stage3_ko", "Une erreur s'est produite, veuillez entrer en relation avec votre contact technique pour changer de mot de passe.");
GTraductions.add("fenetreRecupIdMDP.mailOk", "Le code de sécurité, indispensable à l'étape 2, a été envoyé à l'adresse mail saisie ci-dessus.");
GTraductions.add("fenetreRecupIdMDP.motdepasse", "Mot de passe : ");
GTraductions.add("fenetreRecupIdMDP.confirmation", "Confirmation : ");
GTraductions.add("fenetreRecupIdMDP.terminer", "Terminer");
GTraductions.add("fenetreRecupIdMDP.erreurSMTP", "Les paramètres permettant la récupération des mots de passe oubliés ne sont pas correctement définis.\nVeuillez contacter l'établissement.");
GTraductions.add("BulletinEtReleve.TitreFenetreCalculMoyenne", "Méthode de calcul de la moyenne");
GTraductions.add("BulletinEtReleve.FenetreCalculMoyenneNetteAvecMatiere", "Calcul de la moyenne nette de %s en %s :");
GTraductions.add("BulletinEtReleve.FenetreCalculMoyenneBruteAvecMatiere", "Calcul de la moyenne brute de %s en %s :");
GTraductions.add("BulletinEtReleve.FenetreCalculMoyenneNette", "Calcul de la moyenne nette de %s :");
GTraductions.add("BulletinEtReleve.FenetreCalculMoyenneBrute", "Calcul de la moyenne brute de %s :");
GTraductions.add("BulletinEtReleve.SaisieIncorrecte", "Saisie incorrecte");
GTraductions.add("BulletinEtReleve.InfoBornesSaisie", "Le nombre saisi doit être compris entre %d et %d.");
GTraductions.add("BulletinEtReleve.Matieres", "Matières");
GTraductions.add("BulletinEtReleve.Moyennes", "Moyennes");
GTraductions.add("BulletinEtReleve.Eleve", "Elève");
GTraductions.add("BulletinEtReleve.Classe", "Classe");
GTraductions.add("BulletinEtReleve.Dev", "Dev.");
GTraductions.add("BulletinEtReleve.Serie", "Série");
GTraductions.add("BulletinEtReleve.Moy", "Moy.");
GTraductions.add("BulletinEtReleve.NbrDevoirs", "Nombre de devoirs");
GTraductions.add("BulletinEtReleve.Annuelle", "Annuelle");
GTraductions.add("BulletinEtReleve.NC", "N.C.");
GTraductions.add("BulletinEtReleve.Appreciations", "Appréciations");
GTraductions.add("BulletinEtReleve.Detail", "Détail");
GTraductions.add("BulletinEtReleve.RS_HAbs", "H.Abs.");
GTraductions.add("BulletinEtReleve.VolH", "Vol. H.");
GTraductions.add("BulletinEtReleve.Coeff", "Coeff.");
GTraductions.add("BulletinEtReleve.ECTS", "ECTS");
GTraductions.add("BulletinEtReleve.NbrNotes", "Nbr. Notes");
GTraductions.add("BulletinEtReleve.Rang", "Rang");
GTraductions.add("BulletinEtReleve.Progres", "En progrès");
GTraductions.add("BulletinEtReleve.Regulier", "Régulier");
GTraductions.add("BulletinEtReleve.Regression", "En régression");
GTraductions.add("BulletinEtReleve.Evol", "Evol.");
GTraductions.add("BulletinEtReleve.MoyAnnee", "Moy. année");
GTraductions.add("BulletinEtReleve.Pts", "Pts");
GTraductions.add("BulletinEtReleve.MoyGen", "Moyenne générale");
GTraductions.add("BulletinEtReleve.MoyBasse", "Moyenne la plus basse");
GTraductions.add("BulletinEtReleve.MoyHaute", "Moyenne la plus haute");
GTraductions.add("BulletinEtReleve.RangEleve", "Rang élève");
GTraductions.add("BulletinEtReleve.MoyAnnuelle", "Moyenne annuelle");
GTraductions.add("BulletinEtReleve.MoyEleve", "Moyenne élève");
GTraductions.add("BulletinEtReleve.MoyClasse", "Moyenne classe");
GTraductions.add("BulletinEtReleve.Devoirs", "devoirs");
GTraductions.add("BulletinEtReleve.Devoir", "devoir");
GTraductions.add("BulletinEtReleve.hintBtnCalculECTS", "Calcule les ECTS en fonction de la moyenne obtenue par l'élève et du nombre d'ECTS défini pour le service");
GTraductions.add("BulletinEtReleve.affectationECTS", "Affectation automatique des ECTS");
GTraductions.add("BulletinEtReleve.msgAffectationECTS", "Ce service compte pour %s ECTS.\nCes crédits ECTS vont être affectés aux élèves en fonction de leur moyenne (%s).\nVoulez-vous continuer ?");
GTraductions.add("BulletinEtReleve.ECTSParRatio", "ratio");
GTraductions.add("BulletinEtReleve.ECTSParSeuil", "seuil");
GTraductions.add("BulletinEtReleve.absences", "Absences");
GTraductions.add("BulletinEtReleve.abs_0", "Aucune absence");
GTraductions.add("BulletinEtReleve.abs_1", "%d demi-journée");
GTraductions.add("BulletinEtReleve.abs_N", "%d demi-journées");
GTraductions.add("BulletinEtReleve.absJustifie_1", "%d demi-journée justifiée");
GTraductions.add("BulletinEtReleve.absJustifie_N", "%d demi-journées justifiées");
GTraductions.add("BulletinEtReleve.dontInjustifie_1", "dont %d est injustifiée");
GTraductions.add("BulletinEtReleve.dontInjustifie_N", "dont %d sont injustifiées");
GTraductions.add("BulletinEtReleve.injustifie_1", "%d injustifiée");
GTraductions.add("BulletinEtReleve.injustifie_N", "%d injustifiées");
GTraductions.add("BulletinEtReleve.dureeManquee", "(%s de cours)");
GTraductions.add("BulletinEtReleve.retards", "Retards");
GTraductions.add("BulletinEtReleve.punitions", "Punitions");
GTraductions.add("BulletinEtReleve.sanctions", "Sanctions");
GTraductions.add("BulletinEtReleve.retard_0", "Aucun retard");
GTraductions.add("BulletinEtReleve.punition_0", "Aucune punition");
GTraductions.add("BulletinEtReleve.sanction_0", "Aucune sanction");
GTraductions.add("BulletinEtReleve.aucuneClasse", "Aucune classe");
GTraductions.add("BulletinEtReleve.aucunDevoir", "Aucun devoir");
GTraductions.add("BulletinEtReleve.aucuneMoyenne", "Aucune moyenne");
GTraductions.add("BulletinEtReleve.aucunEleve", "Aucun élève");
GTraductions.add("BulletinEtReleve.devoirSur", "devoirs sur");
GTraductions.add("BulletinEtReleve.MoyProposee", "Moy. prop.");
GTraductions.add("BulletinEtReleve.MoyDeliberee", "Moy. délib.");
GTraductions.add("BulletinEtReleve.MoyCalculee", "Moy. calculée");
GTraductions.add("BulletinEtReleve.MaitrisePalierAttestee", "La maîtrise des connaissances et compétences du socle commun au %s est attestée le %s");
GTraductions.add("BulletinEtReleve.MaitrisePalierPasAttestee", "Le socle commun de connaissances et de compétences n'est pas validé.");
GTraductions.add("BulletinEtReleve.titreGraphe", "Profil de l'élève");
GTraductions.add("BulletinEtReleve.pasDAffichageGraphe", "Pour afficher un profil significatif, l'élève doit avoir été noté dans au moins 3 matières");
GTraductions.add("resultatsClasses.eleve", "élève");
GTraductions.add("resultatsClasses.eleves", "élèves");
GTraductions.add("resultatsClasses.coefficient", "Coeff :");
GTraductions.add("resultatsClasses.sousMatiere", "Sous Matière :");
GTraductions.add("resultatsClasses.moyenneGenerale", "Moyenne générale");
GTraductions.add("resultatsClasses.moyGenerale", "Moy. générale");
GTraductions.add("resultatsClasses.services", "Services");
GTraductions.add("resultatsClasses.serv", "Serv.");
GTraductions.add("resultatsClasses.trimestres", "Trimestres");
GTraductions.add("resultatsClasses.trim", "Trim.");
GTraductions.add("resultatsClasses.semestres", "Semestres");
GTraductions.add("resultatsClasses.sem", "Sem.");
GTraductions.add("resultatsClasses.enlever", "Enlever les sous-services");
GTraductions.add("resultatsClasses.afficher", "Afficher les sous-services");
GTraductions.add("resultatsClasses.deployer", "Déployer les périodes");
GTraductions.add("resultatsClasses.pasdeployer", "Ne pas déployer les périodes");
GTraductions.add("resultatsClasses.moyenneClasse", "Moyenne de la classe :");
GTraductions.add("resultatsClasses.moyenneGroupe", "Moyenne des groupes :");
GTraductions.add("resultatsClasses.parametreMoyenne", "Paramètres de la moyenne générale des élèves");
GTraductions.add("resultatsClasses.arrondi.sans", "La moyenne générale n'est pas arrondie");
GTraductions.add("resultatsClasses.arrondi.avec", "La moyenne générale est arrondie au");
GTraductions.add("resultatsClasses.arrondiClasse.sans", "La moyenne générale de la classe n'est pas arrondie");
GTraductions.add("resultatsClasses.arrondiClasse.avec", "La moyenne générale de la classe est arrondie au");
GTraductions.add("resultatsClasses.arrondi.superieur", "supérieur");
GTraductions.add("resultatsClasses.arrondi.proche", "le plus proche");
GTraductions.add("resultatsClasses.arrondi.point", "de point");
GTraductions.add("resultatsClasses.arrondi.unPoint", "point");
GTraductions.add("fenetreEnvoiEmail.combo_titre_professeurs", "Professeurs");
GTraductions.add("fenetreEnvoiEmail.combo_titre_parents", "Responsables");
GTraductions.add("fenetreEnvoiEmail.combo_titre_genre", "Genre Utilisateurs");
GTraductions.add("fenetreEnvoiEmail.combo_item_TousLesProfesseurs", "Tous les professeurs");
GTraductions.add("fenetreEnvoiEmail.combo_item_professeur", "Professeurs");
GTraductions.add("fenetreEnvoiEmail.combo_item_TousLesPersonnels", "Tous les personnels");
GTraductions.add("fenetreEnvoiEmail.combo_item_personnel", "Autres");
GTraductions.add("fenetreEnvoiEmail.combo_item_classe", "Classe");
GTraductions.add("fenetreEnvoiEmail.combo_item_groupe", "Groupe");
GTraductions.add("fenetreEnvoiEmail.combo_item_responsable", "Parents");
GTraductions.add("fenetreEnvoiEmail.combo_item_eleve", "Elèves");
GTraductions.add("fenetreEnvoiEmail.titre_webmaster", "Webmaster");
GTraductions.add("fenetreEnvoiEmail.titre_secretariat", "Secrétariat");
GTraductions.add("fenetreEnvoiEmail.liste_titre_eleve", "Elève");
GTraductions.add("fenetreEnvoiEmail.liste_titre_responsable", "Responsable");
GTraductions.add("fenetreEnvoiEmail.liste_titre_professeur", "Nom");
GTraductions.add("fenetreEnvoiEmail.liste_titre_matiere", "Matière");
GTraductions.add("fenetreEnvoiEmail.liste_titre_personnel", "Nom");
GTraductions.add("fenetreEnvoiEmail.liste_titre_fonction", "Fonction");
GTraductions.add("fenetreEnvoiEmail.liste_titre_email", "E-mail");
GTraductions.add("fenetreEnvoiEmail.ToutCocher", "Tout cocher");
GTraductions.add("fenetreEnvoiEmail.ToutDecocher", "Tout décocher");
GTraductions.add("fenetreCommunication.titre", "Communiquer avec ...");
GTraductions.add("fenetreCommunication.onglet.equipePedagogique", "Equipe pédagogique");
GTraductions.add("fenetreCommunication.onglet.eleve", "Élèves");
GTraductions.add("fenetreCommunication.onglet.parent", "Responsables");
GTraductions.add("fenetreCommunication.onglet.professeur", "Professeurs");
GTraductions.add("fenetreCommunication.onglet.personnel", "Personnels");
GTraductions.add("fenetreCommunication.onglet.maitreDeStage", "Maîtres de stage");
GTraductions.add("fenetreCommunication.onglet.inspecteur", "Inspecteurs");
GTraductions.add("fenetreCommunication.colonne.nom", "Nom");
GTraductions.add("fenetreCommunication.colonne.classe", "Classes");
GTraductions.add("fenetreCommunication.colonne.matiere", "Matières");
GTraductions.add("fenetreCommunication.colonne.eleve", "Élèves");
GTraductions.add("fenetreCommunication.colonne.fonction", "Fonction");
GTraductions.add("fenetreCommunication.colonne.discussionAutorisee", "Discussion autorisée");
GTraductions.add("fenetreCommunication.colonne.emailAutorise", "Email autorisé");
GTraductions.add("fenetreCommunication.bouton.email", "Rédiger un e-mail");
GTraductions.add("fenetreCommunication.bouton.demarrerDiscussion", "Démarrer une discussion");
GTraductions.add("fenetreCommunication.bouton.demarrerDiscuClasse", "Démarrer une discussion avec l'équipe pédagogique");
GTraductions.add("fenetreCommunication.bouton.discussionsCommunes", "Afficher les discussions communes");
GTraductions.add("fenetreCommunication.bouton.information", "Donner une information");
GTraductions.add("fenetreCommunication.bouton.sondage", "Effectuer un sondage");
GTraductions.add("fenetreCommunication.bouton.casier", "Déposer un document dans le casier");
GTraductions.add("fenetreCommunication.profPrincipal", "Prof. principal");
GTraductions.add("entreprise.titreEntreprise", "Lieu du stage");
GTraductions.add("entreprise.titreResponsable", "Contact(s) de l'entreprise");
GTraductions.add("entreprise.infoSIRET", "Saisissez le numéro de SIRET de l'établissement.");
GTraductions.add("entreprise.infoURSSAF", "Saisissez le numéro de URSSAF de l'établissement.");
GTraductions.add("entreprise.infoNom", "Saisissez le nom du contact de l'établissement.");
GTraductions.add("entreprise.infoPrenom", "Saisissez le prénom du contact de l'établissement.");
GTraductions.add("entreprise.infoEmail", "Saisissez l'adresse électronique du contact de l'établissement.");
GTraductions.add("entreprise.infoFax", "Saisissez le numéro de fax");
GTraductions.add("entreprise.infoTelephoneFixe", "Saisissez le numéro de téléphone fixe");
GTraductions.add("entreprise.infoPortable", "Saisissez le numéro de portable");
GTraductions.add("entreprise.responsable", " du contact de l'établissement.");
GTraductions.add("entreprise.etablissement", " de l'établissement.");
GTraductions.add("entreprise.responsableEntreprise", "Responsable de l'entreprise");
GTraductions.add("entreprise.maitreDeStage", "Maître de stage");
GTraductions.add("entreprise.nom", "Nom");
GTraductions.add("entreprise.prenom", "Prénom");
GTraductions.add("entreprise.fax", "Fax");
GTraductions.add("entreprise.email", "Courrier électronique");
GTraductions.add("entreprise.telephoneFixe", "Tél. Fixe");
GTraductions.add("entreprise.telephonePortable", "Tél. Port.");
GTraductions.add("entreprise.siret", "N° SIRET");
GTraductions.add("entreprise.urssaf", "N° URSSAF");
GTraductions.add("entreprise.siteWeb", "Site web");
GTraductions.add("entreprise.infoSiteWeb", "Saisissez l'adresse du site web de l'entreprise");
GTraductions.add("infosperso.titreBulletin", "Bulletins et relevés");
GTraductions.add("infosperso.titreInfosEleve", "Infos liées à l'élève");
GTraductions.add("infosperso.titreInfosProf", "Infos venant des professeurs");
GTraductions.add("infosperso.titreInfosGen", "Infos non liées à l'élève");
GTraductions.add("infosperso.EmailAdministration", "Je souhaite recevoir des e-mails de l'administration");
GTraductions.add("infosperso.infoEmail", "Saisissez votre adresse électronique.");
GTraductions.add("infosperso.infoSMS", "Saisissez votre numéro de téléphone portable.");
GTraductions.add("infosperso.infoFax", "Saisissez votre numéro de fax.");
GTraductions.add("infosperso.infoTelephoneFixe", "Saisissez votre numéro de téléphone fixe.");
GTraductions.add("infosperso.infoFonctions", "Edition de la liste des fonctions d'entreprise");
GTraductions.add("infosperso.titreDestinataire", "Je souhaite être contacté par :");
GTraductions.add("infosperso.titreDestinataireConsultation", "Vous pouvez être contacté par :");
GTraductions.add("infosperso.titreRecevoir", "Pour recevoir :");
GTraductions.add("infosperso.SMS", "SMS");
GTraductions.add("infosperso.Email", "Courrier électronique");
GTraductions.add("infosperso.Papier", "Courrier papier");
GTraductions.add("infosperso.fax", "Fax");
GTraductions.add("infosperso.telephoneFixe", "Tél. Fixe");
GTraductions.add("infosperso.fonction", "Fonction dans l'entreprise");
GTraductions.add("infosperso.EmailEtablissement", "De l'établissement");
GTraductions.add("infosperso.EMailParents", "Des parents d'élèves");
GTraductions.add("infosperso.CDT", "Autoriser la consultation du cahier de textes par les IPR");
GTraductions.add("infosperso.titreAutorisations", "Autorisations");
GTraductions.add("infosperso.MessageriePRONOTE", "Messagerie");
GTraductions.add("infosperso.AccepteDiscussionAvec", "Accepte les discussions avec :");
GTraductions.add("infosperso.DiscussionsParents", "Les parents");
GTraductions.add("infosperso.DiscussionsEleves", "Les élèves");
GTraductions.add("infosperso.DiscussionsProfsPersos", "Les professeurs et personnels");
GTraductions.add("infosperso.HintDiscussionsProfsPersos", "Les discussions avec les professeurs et les personnels ne sont pas désactivables");
GTraductions.add("infosperso.EstContactVS", "Accepte d'être un contact de vie scolaire");
GTraductions.add("CahierDeTexte.afficherOption", "Afficher :");
GTraductions.add("CahierDeTexte.optionDSEval", "Les devoirs et évaluations");
GTraductions.add("CahierDeTexte.optionAvecTAF", "Les travaux à faire");
GTraductions.add("CahierDeTexte.optionToutesMatieres", "Les matières enseignées");
GTraductions.add("CahierDeTexte.optionDeployerDetail", "les informations détaillées");
GTraductions.add("CahierDeTexte.SaisieCahierDeTextes", "Saisie du cahier de textes");
GTraductions.add("CahierDeTexte.miseEnForme", "Mise en forme du texte");
GTraductions.add("CahierDeTexte.TravailPourCeCours", "Travail donné pour ce cours");
GTraductions.add("CahierDeTexte.AffectationEltsProgressionAUnCahier", "Affecter des contenus au cahier de textes");
GTraductions.add("CahierDeTexte.RattacherAUnCDTSansCours", "Affecter un cahier de textes sans cours");
GTraductions.add("CahierDeTexte.PourLe", "Pour le");
GTraductions.add("CahierDeTexte.msgConfirmationSupprimerCDT", "Voulez-vous supprimer le cahier de textes ?");
GTraductions.add("CahierDeTexte.msgConfirmationSupprimerContenu", "Voulez-vous supprimer ce contenu du cahier de textes ?");
GTraductions.add("CahierDeTexte.msgConfirmationSupprimerTAF", "Voulez-vous supprimer ce travail à faire du cahier de textes ?");
GTraductions.add("CahierDeTexte.SelectionnerUnCoursPourSaisirCDT", "Sélectionnez un cours pour saisir le cahier de textes.");
GTraductions.add("CahierDeTexte.CoursNonUtilisableDansPNParCDT", "Ce cours n'est pas exploitable par PRONOTE : aucun cahier de textes ne peut être saisi.");
GTraductions.add("CahierDeTexte.CoursPrecedent", "« Cours précédent");
GTraductions.add("CahierDeTexte.CoursSuivant", "Cours suivant »");
GTraductions.add("CahierDeTexte.DernierCours", "Dernier cours le %s");
GTraductions.add("CahierDeTexte.ProchainCours", "Prochain cours le %s");
GTraductions.add("CahierDeTexte.PlusCoursPrecedent", "Plus de cours précédent");
GTraductions.add("CahierDeTexte.PlusCoursSuivant", "Plus de cours suivant");
GTraductions.add("CahierDeTexte.AjoutImpossibleCDTVerrouille", "Le cahier de textes ne peut pas être modifié car il est verrouillé.");
GTraductions.add("CahierDeTexte.HintVisa", "Visé le %s par %s");
GTraductions.add("CahierDeTexte.HintVisaSansI", "Visé le %s");
GTraductions.add("CahierDeTexte.SupprimerDocumentJoint", "Supprimer le document");
GTraductions.add("CahierDeTexte.ViserCahiersDeTextes", "Viser les cahiers de textes");
GTraductions.add("CahierDeTexte.SupprimerLesVisas", "Supprimer les visas");
GTraductions.add("CahierDeTexte.VisualisationCahierDeTexte", "Visualiser le cahier de textes");
GTraductions.add("CahierDeTexte.NaviguationCahierTexte", "Passer en saisie du cahier de textes");
GTraductions.add("CahierDeTexte.SupprimerCahierTexte", "Supprimer le cahier de textes");
GTraductions.add("CahierDeTexte.AffecterContenuAuCours", "Affecter le contenu sélectionné au cahier de textes");
GTraductions.add("CahierDeTexte.ConfirmerSuppressionCDT", "Voulez-vous supprimer le cahier de textes ?");
GTraductions.add("CahierDeTexte.ParametresExeQCMTAF", "Modalités d'exécution du QCM pour ce cahier de textes");
GTraductions.add("CahierDeTexte.travailPersoAFaire", "Travail à effectuer");
GTraductions.add("CahierDeTexte.cahierDeTextes", "Cahier de textes");
GTraductions.add("CahierDeTexte.titreFenetreChargeTAF", "Charge de travail de ");
GTraductions.add("CahierDeTexte.titreFenetreTAFCours", "Travail à faire pour le %s");
GTraductions.add("CahierDeTexte.titreFenetreTAFEleves", "Cocher les élèves concernés");
GTraductions.add("CahierDeTexte.tousLesEleves", "Tous les élèves");
GTraductions.add("CahierDeTexte.eleve", "%d/%d élève");
GTraductions.add("CahierDeTexte.eleves", "%d/%d élèves");
GTraductions.add("CahierDeTexte.publie", "Publié");
GTraductions.add("CahierDeTexte.hintPublie", "Par défaut les cahiers de textes sont publiés dès la fin des cours; vous pouvez forcer la publication en cochant la case ci-contre.");
GTraductions.add("CahierDeTexte.hintBoutonPleinEcranAgrandir", "Agrandir la zone de saisie");
GTraductions.add("CahierDeTexte.hintBoutonPleinEcranReduire", "Réduire la zone de saisie");
GTraductions.add("CahierDeTexte.hintBoutonAjoutContenu", "Ajouter un contenu au cahier de textes");
GTraductions.add("CahierDeTexte.hintBoutonAjoutTAF", "Ajouter un travail à faire au cahier de textes");
GTraductions.add("CahierDeTexte.titre", "Titre");
GTraductions.add("CahierDeTexte.categorie", "Catégorie");
GTraductions.add("CahierDeTexte.comboCategorie", "Liste déroulante : sélectionnez une catégorie. ");
GTraductions.add("CahierDeTexte.categorieEditionOuSelection", "Sélectionner ou éditer une catégorie");
GTraductions.add("CahierDeTexte.infoCategorie", "Editer les catégories");
GTraductions.add("CahierDeTexte.docJoints", "Modification des pièces jointes");
GTraductions.add("CahierDeTexte.sites", "Modification des sites internet");
GTraductions.add("CahierDeTexte.ExosQCM", "QCM");
GTraductions.add("CahierDeTexte.ChargeTAFAFaire", "Charge de travail à faire");
GTraductions.add("CahierDeTexte.ViseLe", "visé le");
GTraductions.add("CahierDeTexte.EtVerrouille", "et verrouillé");
GTraductions.add("CahierDeTexte.SansTitre", "sans titre");
GTraductions.add("CahierDeTexte.ContenusPrecedents", "Contenus précédents");
GTraductions.add("CahierDeTexte.SaisieLe", "Saisie le %s");
GTraductions.add("CahierDeTexte.PoursuivreCoursPrecedent", "Affecter le même contenu que précédemment");
GTraductions.add("CahierDeTexte.PoursuivreProgression", "Continuer la progression");
GTraductions.add("CahierDeTexte.ProgrammerDS", "Programmer un devoir sur table");
GTraductions.add("CahierDeTexte.ProgrammerEval", "Programmer une évaluation de compétences");
GTraductions.add("CahierDeTexte.ModifierDS", "Modifier le devoir sur table");
GTraductions.add("CahierDeTexte.ModifierEval", "Modifier l'évaluation de compétences");
GTraductions.add("CahierDeTexte.SupprimerDS", "Supprimer le devoir sur table");
GTraductions.add("CahierDeTexte.SupprimerEval", "Supprimer l'évaluation de compétences");
GTraductions.add("CahierDeTexte.creationModeleLecons", "Modèles de travail de type \"Leçons\"");
GTraductions.add("CahierDeTexte.creationModeleDevoirs", "Modèles de travail de type \"Devoirs\"");
GTraductions.add("CahierDeTexte.editeurHtml", "Editeur HTML");
GTraductions.add("CahierDeTexte.commands.ajouterContenu", "Ajouter un contenu");
GTraductions.add("CahierDeTexte.commands.supprimerContenu", "Supprimer ce contenu");
GTraductions.add("CahierDeTexte.commands.ajouterTAF", "Ajouter un travail à faire");
GTraductions.add("CahierDeTexte.commands.supprimerTAF", "Supprimer ce travail à faire");
GTraductions.add("CahierDeTexte.BoutonRattachementCDT", "Liste des cahiers de textes sans cours affectés");
GTraductions.add("CahierDeTexte.FenetreRattachementCDT", "Cahiers de textes sans cours affectés");
GTraductions.add("CahierDeTexte.Rattachement.Confirmation", "Voulez-vous affecter le cahier de textes sélectionné au cours du %s à %s ?");
GTraductions.add("CahierDeTexte.Rattachement.DragDrop", "Suite à des modifications d'emplois du temps, ces cahiers de textes ne sont plus consultables par les élèves.\nVous devez les réaffecter en cliquant/glissant sur vos cours.");
GTraductions.add("CahierDeTexte.Rattachement.Selection", "Sélectionnez le cahier de textes à rattacher à ce cours");
GTraductions.add("CahierDeTexte.Rattachement.Menu.Visualiser", "Visualiser le cahier de textes");
GTraductions.add("CahierDeTexte.Rattachement.Menu.Supprimer", "Supprimer le cahier de textes");
GTraductions.add("CahierDeTexte.Rattachement.SupprimerCDTSelect", "Supprimer le cahier de textes sélectionné");
GTraductions.add("CahierDeTexte.Rattachement.ClasseGroupe", "Classe/Groupe");
GTraductions.add("CahierDeTexte.Rattachement.Travail", "Travail");
GTraductions.add("CahierDeTexte.Rattachement.AncienCours", "Ancien cours");
GTraductions.add("CahierDeTexte.Rattachement.CoursNonPlace", "Ce cours n'est plus placé sur l'emploi du temps");
GTraductions.add("CahierDeTexte.TAF_Lecon", "Leçon");
GTraductions.add("CahierDeTexte.TAF_Devoir", "Devoir");
GTraductions.add("CahierDeTexte.TAF_QCM", "QCM");
GTraductions.add("CahierDeTexte.TAF_SaisirUnTravail", "Saisir un travail");
GTraductions.add("CahierDeTexte.TAF_EnrichirLaListe", "Enrichir la liste");
GTraductions.add("CahierDeTexte.CopierCDT", "Copier le cahier de textes");
GTraductions.add("CahierDeTexte.CollerCDT", "Coller le cahier de textes");
GTraductions.add("CahierDeTexte.SupprimerCDT", "Supprimer le cahier de textes");
GTraductions.add("CahierDeTexte.TAF_QCMAssocie", "QCM :");
GTraductions.add("CahierDeTexte.CategorieMsgSuppressionImp", "Impossible de supprimer une catégorie créée par défaut ou utilisée !");
GTraductions.add("CahierDeTexte.Libelle", "Libellé");
GTraductions.add("CahierDeTexte.Ajouter_D_Contenus", "Ajouter %d contenus de cours dans une progression");
GTraductions.add("CahierDeTexte.AjouterLeContenu", "Ajouter le contenu de cours dans une progression");
GTraductions.add("CahierDeTexte.Ajouter", "Ajouter");
GTraductions.add("CahierDeTexte.ChoixProgression", "Choix de la progression");
GTraductions.add("CahierDeTexte.ChoixDossier", "Choix du dossier");
GTraductions.add("CahierDeTexte.AucunTAF", "Aucun travail à faire n'a été saisi pour cette semaine");
GTraductions.add("CahierDeTexte.AucunContenu", "Aucun contenu n'a été saisi pour cette semaine");
GTraductions.add("CahierDeTexte.AucunTAFSaisi", "Aucun travail à faire saisi");
GTraductions.add("CahierDeTexte.AucunContenuSaisi", "Aucun contenu saisi");
GTraductions.add("CahierDeTexte.SansContenu", "Sans contenu");
GTraductions.add("CahierDeTexte.TitreFichierCloud", "Exploration de %s");
GTraductions.add("CahierDeTexte.NomFichierCloud", "Nom");
GTraductions.add("CahierDeTexte.TailleFichierCloud", "Taille");
GTraductions.add("CahierDeTexte.PartagerFichierCloud", "Partager");
GTraductions.add("CahierDeTexte.MessageSuppressionImage", "Certaines images n'ont pas pu être récupérées par le copier/coller.\nNous vous conseillons d'attacher l'ensemble de votre document en tant que pièce jointe");
GTraductions.add("CahierDeTexte.documentsAConsulter", "Documents à consulter");
GTraductions.add("CahierDeTexte.travailAFaire", "Travail personnel à effectuer");
GTraductions.add("CahierDeTexte.pourLe", "Pour le");
GTraductions.add("CahierDeTexte.donneLe", "Donné le");
GTraductions.add("CahierDeTexte.fermer", "Fermer la fiche");
GTraductions.add("CahierDeTexte.jour", "jour");
GTraductions.add("CahierDeTexte.jours", "jours");
GTraductions.add("CahierDeTexte.lecons", "Leçons");
GTraductions.add("CahierDeTexte.devoirs", "Devoirs");
GTraductions.add("CahierDeTexte.contenus", "Contenus");
GTraductions.add("CahierDeTexte.contenusDu", "Contenus du %s");
GTraductions.add("CahierDeTexte.le", "Le");
GTraductions.add("CahierDeTexte.a", "à");
GTraductions.add("CahierDeTexte.infoDevoirPerso", "Ce travail n'a pas été donné à l'ensemble de la classe");
GTraductions.add("CahierDeTexte.pasdeployer", "Ne pas afficher le détail");
GTraductions.add("CahierDeTexte.deployer", "Afficher le détail");
GTraductions.add("CahierDeTexte.travailAFaireChkBx", "Travail à faire");
GTraductions.add("CahierDeTexte.contenuChkBx", "Contenu des cours");
GTraductions.add("CahierDeTexte.CDTconsultableDuAu", "Le cahier de textes sera consultable du %0:s au %1:s");
GTraductions.add("CahierDeTexte.consultableDuAu", "consultable du %0:s au %1:s");
GTraductions.add("CahierDeTexte.CDTNonConsultable", "Le cahier de textes n'est pas consultable");
GTraductions.add("CahierDeTexte.CDTViseEtVerrouille", "Visé et verrouillé");
GTraductions.add("CahierDeTexte.DevoirSurveille_Devoir", "Devoir sur table programmé");
GTraductions.add("CahierDeTexte.DevoirSurveille_Evaluation", "Evaluation de compétences programmée");
GTraductions.add("CahierDeTexte.wai.SelectJour", "D'abord pour sélectionner un jour");
GTraductions.add("CahierDeTexte.wai.SelectMatiere", "D'abord pour sélectionner la matière");
GTraductions.add("CahierDeTexte.wai.DetailsMatiereDuJour", "Pour les détails d'une matière du jour sélectionné, utilisez la fleche droite.");
GTraductions.add("CahierDeTexte.wai.DetailsJourDeLaMatiere", "Pour les détails par jour de la matière, utilisez la fleche droite.");
GTraductions.add("CahierDeTexte.wai.NavigationMatiere", "Pour passer d'une matière à l'autre");
GTraductions.add("CahierDeTexte.wai.NavigationJour", "Pour passer d'un jour à l'autre");
GTraductions.add("CahierDeTexte.wai.NavigationMatiereRetour", "Dans le détail des matières, pour revenir sur le jour utilisez la fleche gauche.");
GTraductions.add("CahierDeTexte.wai.NavigationJourRetour", "Dans le détail d'un jour, pour revenir sur la matière utilisez la fleche gauche.");
GTraductions.add("FicheBrevet.Titre_Disciplines", "Disciplines");
GTraductions.add("FicheBrevet.Titre_MoyClasse", "Moy. classe");
GTraductions.add("FicheBrevet.Titre_MoyEleve", "Moy. élève");
GTraductions.add("FicheBrevet.Titre_Appreciations", "Appréciations des professeurs");
GTraductions.add("FicheBrevet.Titre_Note", "Note affectée du coefficient");
GTraductions.add("FicheBrevet.Total", "Total des points");
GTraductions.add("FicheBrevet.Indicatif", "A titre indicatif");
GTraductions.add("FicheBrevet.Avis", "Avis du chef d'établissement");
GTraductions.add("FicheBrevet.LangueRegionale", "Niveau A2 en langue régionale");
GTraductions.add("FicheBrevet.Brevet2013.Titre", "Modalités d'évaluation en EPS au titre du Brevet (d'après le B.O. spécial n°5 du 19 juillet 2012)");
GTraductions.add("FicheBrevet.Brevet2013.Message", "La note d'EPS au Brevet est calculée exclusivement avec les devoirs retenus pour le Brevet.\nPour chacun d'eux, l'option «Devoir à prendre en compte pour le brevet» doit être cochée dans la fenêtre de paramétrage du devoir.");
GTraductions.add("FicheBrevet.NonCommunique", "N.C.");
GTraductions.add("Appreciations.TitreColCategorie", "Catégories");
GTraductions.add("Appreciations.TitreColAppreciation", "Appréciation");
GTraductions.add("Appreciations.LigneCreationCategorie", "Créer une catégorie");
GTraductions.add("Appreciations.LigneCreationAppreciation", "Créer une appréciation");
GTraductions.add("Appreciations.NePasUtiliserAssistant", "Ne pas utiliser l'assistant de saisie");
GTraductions.add("Appreciations.PasserEnSaisie", "Passer en saisie");
GTraductions.add("Appreciations.ActiverAssistantSaisie", "Activer l'assistant de saisie");
GTraductions.add("Appreciations.DesactiverAssistantSaisie", "Désactiver l'assistant de saisie");
GTraductions.add("Appreciations.AssistantSaisie", "Assistant de saisie des appréciations");
GTraductions.add("Appreciations.MsgSuppressionApprecInterdit", "Vous n'êtes pas autorisé à supprimer cette appréciation !");
GTraductions.add("Appreciations.MsgSuppressionCategInterdit", "Vous n'êtes pas autorisé à supprimer cette catégorie !");
GTraductions.add("Appreciations.MsgSupprCategXAppr", "Cette catégorie contient des appréciations !");
GTraductions.add("Appreciations.MsgSupprCategXApprDetail", "Sa suppression va entraîner la suppression des %d appréciations qui la composent.");
GTraductions.add("Appreciations.MsgSupprCategAppr", "Cette catégorie contient une appréciation !");
GTraductions.add("Appreciations.MsgSupprCategApprDetail", "Sa suppression va entraîner la suppression de l'appréciation qui la compose.");
GTraductions.add("Appreciations.MsgConfirmSuppr", "Confirmez-vous sa suppression ?");
GTraductions.add("Appreciations.MsgConfirmSupprDirect", "Voulez-vous supprimer la catégorie sélectionnée ?");
GTraductions.add("Appreciations.SelectionnerTypeAppr", "Sélectionner");
GTraductions.add("Appreciations.SelectionnerCategorie", "Sélectionnez une catégorie d'appréciations");
GTraductions.add("Appreciations.TitreAss_Brevet", "Assistant de saisie des appréciations bilan, fiche brevet et livret scolaire");
GTraductions.add("Appreciations.TitreAss_Bulletin", "Assistant de saisie des appréciations du bulletin");
GTraductions.add("Appreciations.TitreAss_Releve", "Assistant de saisie des appréciations du relevé de notes");
GTraductions.add("Appreciations.ApprA", "Appréciation A");
GTraductions.add("Appreciations.ApprB", "Appréciation B");
GTraductions.add("Appreciations.ApprC", "Appréciation C");
GTraductions.add("Appreciations.CommA", "Commentaire A");
GTraductions.add("Appreciations.CommB", "Commentaire B");
GTraductions.add("Appreciations.CommC", "Commentaire C");
GTraductions.add("Appreciations.CPE", "CPE");
GTraductions.add("Appreciations.Annuelle", "Bilan / fiche brevet");
GTraductions.add("Appreciations.Mentions", "Mentions");
GTraductions.add("Appreciations.SaisieMentions", "Saisie des mentions");
GTraductions.add("Appreciations.HintAucuneMention", "Aucune mention");
GTraductions.add("Appreciations.HintImprimeeDansLesDocuments", "Mention imprimée dans les bulletins et publiée dans les espaces parents et élèves");
GTraductions.add("Appreciations.HintNonImprimeeDansLesDocuments", "Mention non imprimée dans les bulletins et non publiée dans les espaces parents et éleves");
GTraductions.add("Appreciations.titreMsgDepasseTailleMax", "Affectation impossible");
GTraductions.add("Appreciations.msgDepasseTailleMax", "L'appréciation sélectionnée dépasse le nombre de caractères maximum autorisés (%d).");
GTraductions.add("AppreciationsBrevetParDiscipline.Titre_Eleve", "Élève");
GTraductions.add("AppreciationsBrevetParDiscipline.Titre_Serie", "Série");
GTraductions.add("AppreciationsBrevetParDiscipline.Titre_MoyEleve", "Moy.");
GTraductions.add("AppreciationsBrevetParDiscipline.Titre_Appreciation", "Appréciation");
GTraductions.add("AppreciationsBrevetParDiscipline.Titre_MoyClasse", "Moyenne classe");
GTraductions.add("EDT.coursOrigine", "Cours d'origine");
GTraductions.add("EDT.coursRemplacement", "Cours de remplacement");
GTraductions.add("EDT.CoursDu", "Cours du");
GTraductions.add("EDT.EnStage", "Élèves en stage");
GTraductions.add("EDT.Exclu", "exclu");
GTraductions.add("EDT.Cours", "Cours");
GTraductions.add("EDT.DetailCours", "Afficher le détail des cours");
GTraductions.add("EDT.AfficherCoursAnnules", "Afficher les cours annulés");
GTraductions.add("EDT.MasquerCoursAnnules", "Masquer les cours annulés");
GTraductions.add("EDT.PlageNonLibre", "La plage n'est pas libre");
GTraductions.add("EDT.AfficherMemo", "Afficher le mémo");
GTraductions.add("EDT.AfficherCDT", "Afficher le cahier de textes");
GTraductions.add("EDT.TitreFenetreMemo", "Mémo");
GTraductions.add("EDT.WAI.CoursDe", "Cours de");
GTraductions.add("EDT.WAI.memo", "Mémo");
GTraductions.add("EDT.WAI.avecCDTpublie", "Avec cahier de textes publié");
GTraductions.add("EDT.WAI.avecCDT", "Avec cahier de textes");
GTraductions.add("EDT.enListe", "Sous forme de liste");
GTraductions.add("EDT.enGrille", "Sous forme de grille");
GTraductions.add("EDT.coursMultipleDuDeA", "%s cours du %s de %s à %s");
GTraductions.add("EDT.coursMultipleEntreEt", "%s séances entre %s et %s");
GTraductions.add("EDT.seancesDifferentes", "%s séances différentes");
GTraductions.add("EDT.EDTconsultableDuAu", "L'emploi du temps sera consultable du %0:s au %1:s");
GTraductions.add("EDT.consultableDuAu", "consultable du %0:s au %1:s");
GTraductions.add("EDT.EDTNonConsultable", "L'emploi du temps n'est pas consultable");
GTraductions.add("Absence.AucuneAbsence", "Aucune absence depuis le %s");
GTraductions.add("Absence.AucunRetard", "Aucun retard depuis le %s");
GTraductions.add("Absence.AucuneExclusion", "Aucune exclusion depuis le %s");
GTraductions.add("Absence.AucuneInfirmerie", "Aucun passage infirmerie depuis le %s");
GTraductions.add("Absence.AucunePunition", "Aucune punition depuis le %s");
GTraductions.add("Absence.AucuneDispense", "Aucune dispense depuis le %s");
GTraductions.add("Absence.AucunDefautDeCarnet", "Aucun défaut de carnet depuis le %s");
GTraductions.add("Absence.AucuneObservationParents", "Aucune observation aux parents depuis le %s");
GTraductions.add("Absence.AucuneObservationAutres", "Aucun \"%s\" depuis le %s");
GTraductions.add("Absence.TitreListeEvnmts", "%s depuis le %s");
GTraductions.add("Absence.TitreAbsences", "Absences");
GTraductions.add("Absence.TitreRetards", "Retards");
GTraductions.add("Absence.TitreExclusions", "Exclusions");
GTraductions.add("Absence.TitreInfirmeries", "Infirmerie");
GTraductions.add("Absence.TitrePunitions", "Punitions");
GTraductions.add("Absence.CoursManque", "cours manqué");
GTraductions.add("Absence.CoursManques", "cours manqués");
GTraductions.add("Absence.CoursManqueCours", "1 cours de \"%s\" manqué");
GTraductions.add("Absence.CoursManquesCours", "%d cours de \"%s\" manqués");
GTraductions.add("Absence.RetardCours", "1 retard pour le cours de %s");
GTraductions.add("Absence.RetardsCours", "%d retards pour le cours de %s");
GTraductions.add("Absence.ExclusionCours", "1 exclusion pour le cours de %s");
GTraductions.add("Absence.ExclusionsCours", "%d exclusions pour le cours de %s");
GTraductions.add("Absence.InfirmerieCours", "1 passage à l'infirmerie pour le cours de %s");
GTraductions.add("Absence.InfirmeriesCours", "%d passages à l'infirmerie pour le cours de %s");
GTraductions.add("Absence.PunitionCours", "1 punition pour le cours de %s");
GTraductions.add("Absence.PunitionsCours", "%d punitions pour le cours de %s");
GTraductions.add("Absence.ObservationCours", "1 \"%s\" pour le cours de %s");
GTraductions.add("Absence.ObservationsCours", "%s \"%s\" pour le cours de %s");
GTraductions.add("Absence.AbsenceDuAu", "Absence du %s au %s");
GTraductions.add("Absence.AbsenceLeDeA", "Absence le %s de %s à %s");
GTraductions.add("Absence.DispenseDuAu", "Dispense du %s au %s");
GTraductions.add("Absence.DispenseLeDeA", "Dispense le %s de %s à %s");
GTraductions.add("Absence.DispensePresenceEnCoursObligatoire", "Présence en cours obligatoire");
GTraductions.add("Absence.AbsenceOuverte", "Absence ouverte à partir du %s");
GTraductions.add("Absence.Absence", "absence");
GTraductions.add("Absence.Absences", "absences");
GTraductions.add("Absence.RetardDe", "Retard de %d min");
GTraductions.add("Absence.Retard", "retard");
GTraductions.add("Absence.Retards", "retards");
GTraductions.add("Absence.Exclusion", "exclusion");
GTraductions.add("Absence.Exclusions", "exclusions");
GTraductions.add("Absence.PsgInfirmerie", "Passage infirmerie de %s à %s");
GTraductions.add("Absence.Infirmerie", "passage à l'infirmerie");
GTraductions.add("Absence.Infirmeries", "Passages à l'infirmerie");
GTraductions.add("Absence.PunitionProgrammeeLe", "Cette punition est programmée le %s");
GTraductions.add("Absence.Punition", "punition");
GTraductions.add("Absence.Punitions", "punitions");
GTraductions.add("Absence.Observation", "observation");
GTraductions.add("Absence.Observations", "observations");
GTraductions.add("Absence.DispenseCour", "dispense");
GTraductions.add("Absence.DispensesCour", "dispenses");
GTraductions.add("Absence.DispenseCours", "1 dispense pour le cours de %s");
GTraductions.add("Absence.DispensesCours", "%d dispenses pour le cours de %s");
GTraductions.add("Absence.minute", "mn");
GTraductions.add("Absence.Nature", "Nature");
GTraductions.add("Absence.Depart", "Départ");
GTraductions.add("Absence.Retour", "Retour");
GTraductions.add("Absence.EleveEnStage", "1 élève en stage");
GTraductions.add("Absence.ElevesEnStage", "%d élèves en stage");
GTraductions.add("Absence.TousLesElevesEnStage", "Tous les élèves sont en stage");
GTraductions.add("Absence.AucunEleve", "Aucun élève dans le cours sélectionné");
GTraductions.add("Absence.FeuilleDAppel_SaisieImpossibleNonOuvre", "La saisie des absences et retards est impossible car le jour de saisie est non ouvré.");
GTraductions.add("Absence.MFicheFeuilleAppel", '{"titre":" Comment renseigner la feuille d\'appel ?","html":{"_T":23,"V":"<p><span style=\\\"font-family: Arial; font-size: 12px;\\\">1. S&eacute;lectionnez votre cours ou &agrave; d&eacute;faut d&eacute;finissez votre cr&eacute;neau horaire en d&eacute;pla&ccedil;ant les curseurs sur les horaires de votre choix.</span></p><div style=\\\"font-family: Arial; margin-left: 0px; margin-right: 0px; font-size: 13px;\\\"><span style=\\\"font-family: Arial; font-size: 12px;\\\">2. Choisissez la nature de l\'&eacute;v&egrave;nement &agrave; saisir : <span style=\\\"color: #888888;\\\"><em><strong>Absence</strong></em></span>, <strong><em><span style=\\\"color: #888888;\\\">Retard</span></em></strong>, <span style=\\\"color: #888888;\\\"><em><strong>Infirmerie</strong></em></span> ou <span style=\\\"color: #888888;\\\"><em><strong>Exclusion de cours</strong></em></span>.</span></div><div style=\\\"font-family: Arial; margin-left: 0px; margin-right: 0px; font-size: 13px;\\\"><span style=\\\"font-family: Arial; font-size: 8px;\\\">&nbsp;</span></div><div style=\\\"margin-left: 0px; margin-right: 0px;\\\"><span style=\\\"font-family: Arial; font-size: 12px;\\\">3. Cochez les &eacute;l&egrave;ves concern&eacute;s.<br />Vous pouvez </span><span style=\\\"font-family: Arial; font-size: 12px;\\\">utilisez les fl&egrave;ches haut et bas pour naviguer dans la liste des &eacute;l&egrave;ves et la fl&egrave;che droite, le \\\"+\\\" ou la barre d\'espace pour ajouter un &eacute;v&egrave;nement.</span></div><div style=\\\"font-family: Arial; margin-left: 0px; margin-right: 0px; font-size: 13px;\\\"><span style=\\\"font-family: Arial; font-size: 12px;\\\">&nbsp;</span></div><div style=\\\"margin-left: 0px; margin-right: 0px;\\\"><span style=\\\"font-family: Arial; font-size: 12px;\\\">Vous pouvez aussi saisir en dehors du cr&eacute;neau en </span><span style=\\\"font-family: Arial; font-size: 12px;\\\">cliquant directement dans le pas horaire sur la ligne de l\'&eacute;l&egrave;ve concern&eacute;.</span></div>"},"width":415,"height":198,"type":4,"boutons":{"_T":18,"V":1024}}');
GTraductions.add("Absence.TimeSep", "h");
GTraductions.add("Absence.ListeEleves", "Elèves");
GTraductions.add("Absence.ListeType", "Type");
GTraductions.add("Absence.ListeMotif", "Motif");
GTraductions.add("Absence.ListeDateProgrammation", "Programmée le");
GTraductions.add("Absence.ListeDateRealisation", "Réalisée le");
GTraductions.add("Absence.HintFermerAbsence", "Cliquez pour fermer l'absence");
GTraductions.add("Absence.HintOuvrirAbsence", "Cliquez pour ouvrir l'absence");
GTraductions.add("Absence.HintBorne", "Glissez-déposez la borne sur le pas horaire de votre choix");
GTraductions.add("Absence.HeureDepart", "Heure de départ");
GTraductions.add("Absence.HeureRetour", "Heure de retour");
GTraductions.add("Absence.Commentaire", "Commentaire");
GTraductions.add("Absence.TailleCommentaire", "Le commentaire ne peut dépasser 80 caractères.");
GTraductions.add("Absence.AccompagnePar", "Accompagné par");
GTraductions.add("Absence.HintBoutonVoirPunition", "Voir la liste des punitions");
GTraductions.add("Absence.msgExclusion", "Saisie impossible : l'élève est exclu de l'établissement.");
GTraductions.add("Absence.AbsenceAbbr", "Abs.");
GTraductions.add("Absence.RetardAbbr", "Ret.");
GTraductions.add("Absence.DispenseAbbr", "Disp.");
GTraductions.add("Absence.Coche", "Coché");
GTraductions.add("Absence.NonCoche", "Non coché");
GTraductions.add("AbsenceVS.observationNonLue", "observation non lue");
GTraductions.add("AbsenceVS.observationLue", "observation lue");
GTraductions.add("AbsenceVS.observationsNonLue", "Observations non lue");
GTraductions.add("AbsenceVS.observationsLue", "Observations lues");
GTraductions.add("AbsenceVS.observation", "observation");
GTraductions.add("AbsenceVS.observations", "observations");
GTraductions.add("AbsenceVS.absence", "absence");
GTraductions.add("AbsenceVS.absences", "absences");
GTraductions.add("AbsenceVS.absenceEnCours", "absence aux cours");
GTraductions.add("AbsenceVS.absencesEnCours", "absences aux cours");
GTraductions.add("AbsenceVS.absenceCoursJust", "absence justifiée");
GTraductions.add("AbsenceVS.absenceCoursNonJust", "absence non justifiée");
GTraductions.add("AbsenceVS.absencesCoursJust", "Absences justifiées");
GTraductions.add("AbsenceVS.absencesCoursNonJust", "Absences non justifiées");
GTraductions.add("AbsenceVS.retard", "retard");
GTraductions.add("AbsenceVS.retards", "retards");
GTraductions.add("AbsenceVS.absenceRepas", "absence repas");
GTraductions.add("AbsenceVS.absencesRepas", "Absences repas");
GTraductions.add("AbsenceVS.absenceInternat", "absence à l'internat");
GTraductions.add("AbsenceVS.absencesInternat", "Absences à l'internat");
GTraductions.add("AbsenceVS.punition", "punition");
GTraductions.add("AbsenceVS.punitions", "punitions");
GTraductions.add("AbsenceVS.sanction", "sanction");
GTraductions.add("AbsenceVS.sanctions", "Sanctions");
GTraductions.add("AbsenceVS.infirmerie", "passage à l'infirmerie");
GTraductions.add("AbsenceVS.infirmeries", "Passages à l'infirmerie");
GTraductions.add("AbsenceVS.toutesLesAbsences", "Tous les évènements");
GTraductions.add("AbsenceVS.absencesRecapJust", "1/2j absence justifiée");
GTraductions.add("AbsenceVS.absencesRecapNonJust", "1/2j absence non justifiée");
GTraductions.add("AbsenceVS.incidentPunition", "Incident lié aux punitions");
GTraductions.add("AbsenceVS.aucuneObservation", "aucune observation");
GTraductions.add("AbsenceVS.aucuneAbsence", "aucune absence");
GTraductions.add("AbsenceVS.aucunRetard", "aucun retard");
GTraductions.add("AbsenceVS.aucunInfirmerie", "aucun passage à l'infirmerie");
GTraductions.add("AbsenceVS.aucunIncident", "aucun incident");
GTraductions.add("AbsenceVS.aucunePunition", "aucune punition");
GTraductions.add("AbsenceVS.aucuneSanction", "aucune sanction");
GTraductions.add("AbsenceVS.travailAFaire", "Travail à faire");
GTraductions.add("AbsenceVS.accuseDeReception", "J'ai pris connaissance de cette punition");
GTraductions.add("AbsenceVS.ajouterUnEleve", "Ajouter un élève");
GTraductions.add("AbsenceVS.SuppressionEleve", "Supprimer l'élève du cours");
GTraductions.add("AbsenceVS.ConfirmationSuppressionEleve", "Etes-vous sur de vouloir supprimer l'élève %s du cours ?");
GTraductions.add("AbsenceVS.ARegulariser", "Evénements à régulariser");
GTraductions.add("AbsenceVS.Autres", "Autres événements");
GTraductions.add("AbsenceVS.exclusions", "Exclusions de cours");
GTraductions.add("AbsenceVS.exclusion", "exclusion de cours");
GTraductions.add("AbsenceVS.exclusion2", "exclusion");
GTraductions.add("AbsenceVS.retenue", "Retenue");
GTraductions.add("AbsenceVS.retenues", "retenues");
GTraductions.add("AbsenceVS.devoirSuppl", "Devoir supplémentaire");
GTraductions.add("AbsenceVS.devoirsSuppl", "devoirs supplémentaires");
GTraductions.add("AbsenceVS.TIG", "Travail d'intérêt général");
GTraductions.add("AbsenceVS.TIGs", "Travaux d'intérêt général");
GTraductions.add("AbsenceVS.punitionAutre", "Autre punition");
GTraductions.add("AbsenceVS.punitionsAutres", "autres punitions");
GTraductions.add("AbsenceVS.exclusionDefinitive", "exclusion définitive");
GTraductions.add("AbsenceVS.exclusionTempClasse", "exclusion temporaire de la classe");
GTraductions.add("AbsenceVS.exclusionsTempClasse", "exclusions temporaires de la classe");
GTraductions.add("AbsenceVS.exclusionTempEtablissement", "exclusion temporaire de l'établissement");
GTraductions.add("AbsenceVS.exclusionsTempEtablissement", "exclusions temporaires de l'établissement");
GTraductions.add("AbsenceVS.exclusionDP", "exclusion de la demi-pension");
GTraductions.add("AbsenceVS.exclusionsDP", "exclusions de la demi-pension");
GTraductions.add("AbsenceVS.exclusionInternat", "exclusion de l'internat");
GTraductions.add("AbsenceVS.exclusionsInternat", "exclusions de l'internat");
GTraductions.add("AbsenceVS.sanctionAutreExclusions", "Autre exclusion");
GTraductions.add("AbsenceVS.sanctionAutresExclusions", "autres exclusions");
GTraductions.add("AbsenceVS.sanctionAvertissement", "avertissement");
GTraductions.add("AbsenceVS.sanctionAvertissements", "avertissements");
GTraductions.add("AbsenceVS.sanctionBlame", "blâme");
GTraductions.add("AbsenceVS.sanctionBlames", "blâmes");
GTraductions.add("AbsenceVS.sanctionMesureResp", "mesure de responsabilisation");
GTraductions.add("AbsenceVS.sanctionMesuresResp", "mesures de responsabilisation");
GTraductions.add("AbsenceVS.sanctionAutre", "Autre sanction");
GTraductions.add("AbsenceVS.sanctionAutres", "autres sanctions");
GTraductions.add("AbsenceVS.mesureConservatoire", "mesure conservatoire");
GTraductions.add("AbsenceVS.mesuresConservatoires", "mesures conservatoires");
GTraductions.add("AbsenceVS.incident", "Incident");
GTraductions.add("AbsenceVS.incidents", "Incidents");
GTraductions.add("AbsenceVS.AucuneMesure", "Aucune mesure disciplinaire");
GTraductions.add("AbsenceVS.IncidentSignaleLe", "Incident signalé le %s à %s");
GTraductions.add("AbsenceVS.LieAPunition", "Lié à une punition");
GTraductions.add("AbsenceVS.LieASanction", "Lié à une sanction");
GTraductions.add("AbsenceVS.LieAMesureConservatoire", "Lié à une mesure conservatoire");
GTraductions.add("AbsenceVS.SansMesureDiciplinaire", "Sans mesure disciplinaire");
GTraductions.add("AbsenceVS.avecSursis", "avec sursis");
GTraductions.add("AbsenceVS.heureCoursManque", "#1 de cours manqué");
GTraductions.add("AbsenceVS.heuresCoursManquees", "#1 de cours manquées");
GTraductions.add("AbsenceVS.demiJournee", "#1 demi-journée bulletin");
GTraductions.add("AbsenceVS.demiJournees", "#1 demi-journées bulletin");
GTraductions.add("AbsenceVS.soit", "soit");
GTraductions.add("AbsenceVS.nonProgramme", "aucune programmation");
GTraductions.add("AbsenceVS.demande", "Punition demandée");
GTraductions.add("AbsenceVS.demandePar", "Punition demandée par #1");
GTraductions.add("AbsenceVS.decidePar", "Sanction décidée par #1");
GTraductions.add("AbsenceVS.observationLu", "J'ai pris connaissance de cette observation");
GTraductions.add("AbsenceVS.minutes", "min.");
GTraductions.add("AbsenceVS.aPartirDe", "à partir de");
GTraductions.add("AbsenceVS.aRendreLe", "à rendre le");
GTraductions.add("AbsenceVS.aJustifier", "à justifier");
GTraductions.add("AbsenceVS.dont", "dont");
GTraductions.add("AbsenceVS.nonLue", "non lue");
GTraductions.add("AbsenceVS.nonLues", "non lues");
GTraductions.add("AbsenceVS.nonJustifieAbsence", "non justifiée");
GTraductions.add("AbsenceVS.nonJustifieAbsences", "non justifiées");
GTraductions.add("AbsenceVS.nonJustifieRetard", "non justifié");
GTraductions.add("AbsenceVS.nonJustifieRetards", "non justifiés");
GTraductions.add("AbsenceVS.jour", "jour");
GTraductions.add("AbsenceVS.jours", "jours");
GTraductions.add("AbsenceVS.nuit", "nuit");
GTraductions.add("AbsenceVS.nuits", "nuits");
GTraductions.add("AbsenceVS.heure", "heure");
GTraductions.add("AbsenceVS.heures", "heures");
GTraductions.add("AbsenceVS.midi", "midi");
GTraductions.add("AbsenceVS.soir", "soir");
GTraductions.add("AbsenceVS.amidi", "à midi");
GTraductions.add("AbsenceVS.ausoir", "au soir");
GTraductions.add("AbsenceVS.matin", "matin");
GTraductions.add("AbsenceVS.apresMidi", "après-midi");
GTraductions.add("AbsenceVS.aPreciser", "Choisissez une raison");
GTraductions.add("AbsenceVS.sansRaisonValable", "non recevable");
GTraductions.add("AbsenceVS.sansMotif", "Sans motif");
GTraductions.add("AbsenceVS.saisissezCommentaire", "Votre commentaire (max %s c.)");
GTraductions.add("AbsenceVS.votreRaison", "Votre raison");
GTraductions.add("AbsenceVS.limiteCommentaire", "Le commentaire est limité à %s caractères");
GTraductions.add("AbsenceVS.excluDefinitive", "a été exclu définitivement de l'établissement le #1");
GTraductions.add("AbsenceVS.Recapitulatif_TitreAnnuel", "Récapitulatif de l'année #1");
GTraductions.add("AbsenceVS.Recapitulatif_TitreMois", "Récapitulatif du mois de #1");
GTraductions.add("AbsenceVS.titres.date", "Date");
GTraductions.add("AbsenceVS.titres.professeur", "Professeur");
GTraductions.add("AbsenceVS.titres.matiere", "Matière");
GTraductions.add("AbsenceVS.titres.personnel", "personnel");
GTraductions.add("AbsenceVS.titres.observation", "observation");
GTraductions.add("AbsenceVS.titres.lu", "lu");
GTraductions.add("AbsenceVS.titres.HCours", "H. Cours");
GTraductions.add("AbsenceVS.titres.DemiJBul", "1/2j. Bul.");
GTraductions.add("AbsenceVS.titres.motif", "Motif");
GTraductions.add("AbsenceVS.titres.motifParent", "Raison des parents/Motif");
GTraductions.add("AbsenceVS.titres.commentaire", "Commentaire");
GTraductions.add("AbsenceVS.titres.duree", "Durée");
GTraductions.add("AbsenceVS.titres.symptMedicaux", "Symptômes médicaux");
GTraductions.add("AbsenceVS.titres.actesMedicaux", "Actes médicaux");
GTraductions.add("AbsenceVS.titres.modalites", "modalités");
GTraductions.add("AbsenceVS.titres.circonstances", "circonstances");
GTraductions.add("AbsenceVS.titres.demandeur", "Demandeur");
GTraductions.add("AbsenceVS.titres.decideur", "Décideur");
GTraductions.add("AbsenceVS.titres.saisiepar", "Saisie par");
GTraductions.add("AbsenceVS.titres.RA", "RA");
GTraductions.add("AbsenceVS.titres.gravite", "Gravité");
GTraductions.add("AbsenceVS.titres.mesureDisciplinaire", "Mesure disciplinaire");
GTraductions.add("AbsenceVS.titres.details", "Détails");
GTraductions.add("AbsenceVS.titres.auteurSignalement", "Auteur du signalement");
GTraductions.add("AbsenceVS.AccuserReception", "Accuser réception");
GTraductions.add("AbsenceVS.RegleeAdmin", "Réglée administrativement");
GTraductions.add("AbsenceVS.NonRegleeAdmin", "Non réglée administrativement");
GTraductions.add("AbsenceVS.RegleAdmin", "Réglé administrativement");
GTraductions.add("AbsenceVS.AbsenceSaisieParVS", "L'absence a été saisie par la vie scolaire");
GTraductions.add("AbsenceVS.AbsenceSaisieParPers", "L'absence a été saisie par le personnel %s");
GTraductions.add("AbsenceVS.AbsenceSaisieParProf", "L'absence a été saisie par le professeur %s");
GTraductions.add("AbsenceVS.RetardSaisiParVS", "Le retard a été saisi par la vie scolaire");
GTraductions.add("AbsenceVS.DispenseSaisieParVS", "La dispense a été saisie par la vie scolaire");
GTraductions.add("AbsenceVS.DispenseLongue", "Cette dispense n'est pas restreinte à ce cours, elle ne peut être modifiée dans la feuille d'appel");
GTraductions.add("AbsenceVS.PunitionProgrammeeLe", "Cette punition est programmée le %s");
GTraductions.add("AbsenceVS.PunitionProgrammeeLeA", "Cette punition est programmée le %s à %s");
GTraductions.add("AbsenceVS.AbsentAuDernierCours", "%s était absent au dernier cours de %s avec %s");
GTraductions.add("AbsenceVS.SortieEtabAutorisee", "est autorisé(e) à ne pas être présent dans l'établissement");
GTraductions.add("AbsenceVS.AutoriseSortirEtab", "%s est autorisé(e) à ne pas être présent dans l'établissement");
GTraductions.add("AbsenceVS.AppelFait", "Appel terminé");
GTraductions.add("AbsenceVS.AuCoursDe", "au cours de");
GTraductions.add("AbsenceVS.ElevesPresents", "%d élèves présents dans la salle");
GTraductions.add("AbsenceVS.ElevePresent", "1 élève présent dans la salle");
GTraductions.add("AbsenceVS.AucunElevePresent", "Aucun élève présent dans la salle");
GTraductions.add("AbsenceVS.CommentaireInfPerdu", "Vous avez saisi un commentaire pour ce passage infirmerie. Souhaitez-vous quand même supprimer ce passage infirmerie ?");
GTraductions.add("AbsenceVS.CommentaireObsPerdu", "Vous avez saisi un commentaire pour cette observation. Souhaitez-vous quand même supprimer cette observation ?");
GTraductions.add("AbsenceVS.InfosPunitionPerdues", "Vous avez saisi des informations pour cette punition. Souhaitez-vous quand même supprimer cette punition ?");
GTraductions.add("AbsenceVS.InfosExclusionPerdues", "Vous avez saisi des informations pour cette exclusion. Souhaitez-vous quand même supprimer cette exclusion ?");
GTraductions.add("AbsenceVS.AjouterPunition", "Ajouter une punition");
GTraductions.add("AbsenceVS.ModifierPunition", "Modifier la punition");
GTraductions.add("AbsenceVS.SupprimerPunition", "Supprimer la punition");
GTraductions.add("AbsenceVS.SupprimerPunitionConfirmation", "Confirmez vous la suppression de la punition ?");
GTraductions.add("AbsenceVS.DecompteDepuis", "Suivi depuis");
GTraductions.add("AbsenceVS.SujetMailtoObservation", "En regard de l'observation de #1 du #2");
GTraductions.add("AbsenceVS.AucuneAbsence", "Aucun évènement");
GTraductions.add("AbsenceVS.AucuneHeuresManquees", "aucune heures manquées");
GTraductions.add("AbsenceVS.PublierEspaceParents", "Publier sur l'Espace Parents");
GTraductions.add("AbsenceVS.Depublier", "Dépublier");
GTraductions.add("AbsenceVS.InfoNonJustifie", "Une absence est non justifiée si elle n'a pas de motif ou un motif non recevable");
GTraductions.add("AbsenceVS.AppelCoursAnnule", "Vous ne pouvez pas faire l'appel sur un cours annulé");
GTraductions.add("AbsenceVS.AppelCoursNonUtilisable", "Ce cours n'est pas exploitable par PRONOTE : aucun appel ne peut être effectué.");
GTraductions.add("AbsenceVS.InfirmerieEnDehorsLimite", "Horaire en dehors des limites autorisées");
GTraductions.add("AbsenceVS.InfirmerieHeureSortieSuperieurAHeureEntree", "L'heure de retour doit être postérieure à l'heure de départ");
GTraductions.add("AbsenceVS.ObservationLueWebLe", "Observation lue par les parents le %s");
GTraductions.add("AbsenceVS.Hint.Publie", "Publié sur l'Espace Parents");
GTraductions.add("AbsenceVS.Hint.PublieInfirmerie", "Publié sur l'Espace Parents selon la décision de l'infirmerie");
GTraductions.add("AbsenceVS.Hint.PublieObservationParent", "Publié sur l'Espace Parents selon la décision du professeur");
GTraductions.add("AbsenceVS.date", "Date");
GTraductions.add("AbsenceVS.redac", "Rédacteur");
GTraductions.add("AbsenceVS.titreFenetreListePunitions", "Punitions du %s données par %s");
GTraductions.add("AbsenceVS.LegendeFeuilleAppel", "Remplir la feuille d'appel");
GTraductions.add("AbsenceVS.SaisirPunition", "Saisir une punition");
GTraductions.add("AbsenceVS.Liste", "Liste");
GTraductions.add("AbsenceVS.SelectionElevePunition", "Sélectionnez d'abord l'élève à qui affecter la punition");
GTraductions.add("AbsenceVS.aucunePunitionClasse", "Aucune punition saisie par le professeur pour cette classe");
GTraductions.add("AbsenceVS.Traduction_PourLeCoursDe", "pour le cours de");
GTraductions.add("AbsenceVS.Traduction_PourLeCreneauDe", "pour le créneau de");
GTraductions.add("AbsenceVS.convocationVieScolaire", "Convocation à la vie scolaire pour absence non-justifiée");
GTraductions.add("AbsenceVS.msgPasAutorise", "Cette absence a été saisie par la vie scolaire, vous n'êtes pas autorisé à la supprimer.");
GTraductions.add("AbsenceVS.msgAutreProf", "Cette absence a été saisie par un autre professeur, vous n'êtes pas autorisé à la supprimer.");
GTraductions.add("AbsenceVS.msgContenu", "Du contenu est associé, confirmez-vous la suppression ?");
GTraductions.add("AbsenceVS.selectionnerCours", "Sélectionnez votre cours");
GTraductions.add("AbsenceVS.appelDu", "Appel du");
GTraductions.add("AbsenceVS.hintInfirmerie", "clic GAUCHE pour supprimer le passage à l'infirmerie, clic DROIT pour le modifier ou voir le détail.");
GTraductions.add("AbsenceVS.hintInfirmerieSansSaisieGrille", "clic DROIT pour modifier ou voir le détail.");
GTraductions.add("AbsenceVS.hintRepas", "Prend le repas de midi dans l'établissement");
GTraductions.add("AbsenceVS.hintBus", "Utilise les transports en commun");
GTraductions.add("AbsenceVS.msgConfimation", "Confirmez vous la suppression de l'absence saisie par la vie scolaire?");
GTraductions.add("AbsenceVS.msgEleveRetard", "L'élève a déjà un retard sur cet intervalle.");
GTraductions.add("AbsenceVS.msgEleveAbsenceRetard", "L'élève est absent à cette place, le retard ne peut lui être attribué.");
GTraductions.add("AbsenceVS.msgEleveAbsenceOuverte", "L'élève a une absence ouverte, toute action ultérieure est impossible");
GTraductions.add("AbsenceVS.msgClotureAbsence", "Confirmez-vous la clôture de l'absence en cours ?");
GTraductions.add("AbsenceVS.msgOuvrirAbsence", "Voulez-vous ouvrir l'absence débutant le %s à %s");
GTraductions.add("AbsenceVS.msgImpossibleOuvrirAbsence", "Vous ne pouvez pas ouvrir cette absence car elle dépasserait le cadre du cours sélectionné.");
GTraductions.add("AbsenceVS.msgDispense", "L'élève est dispensé sur ce cours, confirmez-vous l'attribution d'une absence?");
GTraductions.add("AbsenceVS.msgSaisieAbsSurDispenseSansPresence", "Cet élève est dispensé et sa présence n'est pas obligatoire en cours : aucune absence ne peut être saisie");
GTraductions.add("AbsenceVS.msgExclusionTemporaire", "Saisie impossible : l'élève est exclu de l'établissement dans cet intervalle.");
GTraductions.add("AbsenceVS.Eleves", "Elève(s)");
GTraductions.add("AbsenceVS.EleveAbsentAuDernierCours", "Était absent au dernier cours du professeur avec la même matière");
GTraductions.add("AbsenceVS.memo", "Mémo");
GTraductions.add("AbsenceVS.memos", "Mémos");
GTraductions.add("AbsenceVS.CreerUnMemo", "Créer un mémo");
GTraductions.add("AbsenceVS.Auteur", "Auteur");
GTraductions.add("AbsenceVS.ExclusionAbr", "E");
GTraductions.add("AbsenceVS.InfirmerieAbr", "I");
GTraductions.add("AbsenceVS.Recapitulatif", "Récapitulatif");
GTraductions.add("AbsenceVS.DetailsVieScolaire", "Détails de la vie scolaire");
GTraductions.add("AbsenceVS.SelectionnerUnMotifAbsence", "Sélectionner un motif d'absence");
GTraductions.add("AbsenceVS.SelectionnerEtJustifierMotifAbsence", "Justifier le motif d'absence");
GTraductions.add("AbsenceVS.comboRessource", "Liste déroulante : Choisissez une ressource :");
GTraductions.add("AbsenceVS.comboEnseignant", "Liste déroulante : Choisissez un enseignant :");
GTraductions.add("AbsenceVS.comboDates", "Liste déroulante : Choisissez une date:");
GTraductions.add("AbsenceVS.comboEleveAccInfirmerie", "Liste déroulante : sélectionnez l'élève accompagnateur. Faites attention au mode de lecteur d'écran.");
GTraductions.add("AbsenceVS.comboPeriode", "Liste déroulante : Choisissez la periode.");
GTraductions.add("AbsenceVS.comboGenreAbsence", "Liste déroulante : Choisissez le genre d'absence.");
GTraductions.add("AbsenceVS.comboMotifAbsence", "Liste déroulante : Choisissez un motif.");
GTraductions.add("AbsenceVS.EvtSaisiParVieScolaire", "\"%s\" saisi par la vie scolaire");
GTraductions.add("AbsenceVS.EvtSaisiParProfesseur", "\"%s\" saisi par le professeur (%s)");
GTraductions.add("AbsenceVS.MFicheFeuilleAppelVS", '{"titre":"Fonctionnement de la feuille \\\"Appel et suivi\\\" ?","html":{"_T":23,"V":"<div style=\\\"text-align: left; text-indent: 0px; margin-left: 0px;\\\"><span style=\\\"font-family: Arial; font-size: 12px;\\\"><strong>Personnalisation des</strong> <strong>rubriques</strong></span></div><div style=\\\"text-align: left; text-indent: 0px; margin-left: 0px;\\\"><span style=\\\"font-family: Arial; font-size: 12px;\\\">Vous pouvez choisir d\'ajouter des rubriques facultatives dans la fen&ecirc;tre de param&egrave;tres <img src=\\\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAARCAYAAAA7bUf6AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAACxMAAAsTAQCanBgAAAIoSURBVDhPpVRNaxNRFD1vZiSTihSqxiS0BAURpaFbwY3rIhgoKAiCIPUDC1WRoFSxlKKxiyzELqRuXHQjddelG/+AkKZJTIO02hqTNolJpulMaGZeb16mNTUDgj3DYea+c7ncd+57w+r6FscBwYytGjf0mh22EIsnMDY+iYFgP+7dvgm/z2srzmB6TeN6bdMO/yAWTyL8dBwulwszb6I44TluK52QuMVhmWYHg+fO4MpQCJpWxeyHj445u5QsbsE0G4glkuLdzlR6CZIkIb6Y6NDaSZ2YMBvbmIxEsbCYEt9NVioVJFNpyLICRTm0t+5ExbKok0YDwf6zeP5iCqFLg/i6lKEuMuDUpSzLKJaKyHxbwalAr+3CfrByIc+JKJTKeDwRoQ6qQpAkmcgog8g53KqKZ+H7ONnnF3o7WGn9FyeK4He5ivlPn5GgbSiKjI2NIvS6AUYPp0Kq6sLYwxEEen0ifxeskFvjxdxPO9yP1ew6Iq/fwjAMEbcKqXgyegd9fo9Ya4KMbXniRL+nB+GRYahut9gWo0kZ9TpeUuHva7m9PKllrLPrTfqOdePR3Rtwu13CnqZPhqFjanoGP7J5kdPqxGH27fQe7caDW1SItgK6adeGLuPihfN4NzsndKk5RqdT+De9PUcwOnwdXYe7UKIBVKqbqGia0Fh2OcOzKxnbon8jX6ri/dw8ynQYr4YGMXA6AJZe+MJzq8t2yv+BTUdfHfB/AuwAD0WjZeLJ2hsAAAAASUVORK5CYII=\\\" alt=\\\"\\\" />.</span></div><div style=\\\"text-align: left; text-indent: 0px; margin-left: 0px;\\\">&nbsp;</div><div style=\\\"text-align: left; text-indent: 0px; margin-left: 0px;\\\"><div style=\\\"text-align: left; text-indent: 0px; margin-left: 0px;\\\"><div style=\\\"text-align: left; text-indent: 0px; margin-left: 0px;\\\"><span style=\\\"font-family: Arial; font-size: 12px;\\\"><strong>Lien avec la vie scolaire<br /></strong>&agrave; droite du nom de l\'&eacute;l&egrave;ve, diff&eacute;rents icones vous renseignent<strong><br /></strong></span></div><div style=\\\"text-align: left; text-indent: 0px; margin-left: 0px;\\\"><span style=\\\"font-family: Arial; font-size: 12px;\\\"><span style=\\\"font-family: Arial;\\\"><img src=\\\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAARCAYAAAA7bUf6AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAACxMAAAsTAQCanBgAAAMCSURBVDhPjZJrSJNRHMafXdTNFJWZuuGFXPMSI6W8FfQhCj9EHyIIuhAUhRSBQgQVRNmnAqE+iJZlfihEzRTSNA1yqJEzW07RuS3NqeSld73z3UU3t/n2nrNh9Cl/8PIennPOc57/+R/wAgvLDn6R4ciQX2Kc/GfjDzreLmIILDEc2j6Mwh8IYnNzE99tK0TeNtSkUJshbA6iuccAVVIcFHHRcK956YLtQE0I544XwWSZh9E8j1x1CiQSSXgG+MW60DdkwvPGbswvsVTr6Tfi0q1aIT0PEamJqgJdulHMLTlw5cxhiEUiqk0vevD0ZSdGDEZ4vV5kqTNQUqBFbX0T1FlatD25HjIZ/GqFb8OPIwf2oKFVhxOlxVDE70BrrxFTswxUKhXGx8dhsVjg8XgwOzsLVVomWuoqkamMDpUjlYjQp59Ax0cDSg/tBYQU5JKHh4eg1+vhcrlQXFyM/Px8KJVK5OTkIEKotnfASNP+U47L4wXn9sI8vYCD+zSIlsvQ0qFDS9cw9hcU0UQ6nQ5msxlOJ4dVpwc3yssgqRQIe0AqlaD53RCqX7QjSRGP3N1p0GbvEuL60aMbAcMwGBsbg8PhENZGQCoWgePYv91xeXx41jKAxjc9iImJwev3X/BpxETnfjtc1MBgMAgJnIiKiqJ6pPCXy2ShclbsHGpe9WJQb4RcLqftJY8uM0MFdfpOtHf1g7GzVBOLt87F+vo6rl48BdGkdY5/XN8Jy8w8PYF85JqkUindQBJwHEe1QCBANTJmWRYadSaa6+5B3K37hrFJ61ZE4k4IBoO0lTabDW63G36/nybx+Xyw2+1QKBJRdb8CqclxEJ89eRTKlETqLBJaS8zIwqmpKWwGN/DwbjnKLpymCUir19bWkJycjOqqOyjJy6AH0jv5ybhw+0EDJkxWxMbG0tPTU1PwqPIaCvM08Pp5jFuXYbbOQBYViXytBpq0BPKcQhATAuv08Zdv1vAJ2cf48xVV/OKKIzzzf7ZMCKvuDb7p7QDvcHrCynbg+T+0GxBMRvRVzgAAAABJRU5ErkJggg==\\\" alt=\\\"\\\" />&nbsp;:&nbsp;&nbsp;&nbsp; l\'&eacute;l&egrave;ve est convoqu&eacute; &agrave; la vie scolaire<br /><img src=\\\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAQCAYAAADj5tSrAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAACxMAAAsTAQCanBgAAALuSURBVDhPnZRbSBRRGMf/M3tzL6aFptCLkA+taaQYeSHIt6KHkMC3HirzAiGI9KJYCWaGy1rky9ZDmhVeE0EJQyofTEMQrAfNS1JCKuruuu6OMzu7ezpzdrQs2tQfHOa7nDnfnO9/zoDsk4+jw6TBZlO9yPDYB92vulBadhNeQVAjkdlzkZdtL1B7z4ZgMIDYmBg1Gpk9FXk90A+bvQkcx7Fh0OvVTGR2XWRq8jPq6u3QaDRs8LwGi0vLajYyuy5S1/AQkiSzxTmOZzuZmp5Vs/9BPQARaW5pJqeyz5DTuWfJ05ZW4vF4yNSXaSKKIvG6ncQvbpJQKMjmSps+9lQQhbC9YycL3+dQWX0LjieP1Ug41tzazlpEPx6X8i8iUFGBI0PvwVNfH2WE9KwV7uIS+sEhyD29cBYUsEE+jEDaFH61q72zDVeKyvD23RC6unuxvLSADfcqnrd10jaJ22K7XG7o8/Igj41Bq9NBS8VXbCUW/LEIqacHpuJiGPLzITgc0IMLF7HZ7XjwyAEfPfccz0MQRfT2D8DpWcebwSEWo3NRUlyIxIQ46FJSQNxutqgyFJvF1HvjHx6GNikJhzo64AeB5g4lM/0krMesmJj4BNpn8LQ1X+e/Yc3pwtzsvCIcLpw/h+tXL8MQZQKfcBjS4CA0iYkIra4iMDcHc+E1kOgDCC0uIjA+Dnl0FPLkJEy5ueAUYVh5ysrqCqqqa0BFZa1RUNLJyUfR1NgAk9nCYn5RYL0nXi/zOYsFOqqVspLBaII8MwOxrw/yyAjM5eU7j3B8XDzstnpkZKQjRN9QCkQZjai5XbldQEH2+1l7FC2YHpmZ9A8QZEIrgivos7LYkzPRnTPrNyx0sbs11UhLPU5ncLhRWoSDFpOaDWM+EAvdiTTVA7R0p0ZzNAw5OdCmpmKjqgq+xkbosrPBW63/vidrzjVSW3efCD6PGvkb5W5s3Y8tArJftQiRJYl4111khyZ/ItOjqzNEqd5+AX4CW4Ui3qxu/JwAAAAASUVORK5CYII=\\\" alt=\\\"\\\" />&nbsp;:&nbsp; l\'absence a &eacute;t&eacute; saisie par la vie scolaire<br /><img src=\\\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB0AAAAQCAYAAADqDXTRAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAACxMAAAsTAQCanBgAAANLSURBVEhLnVT7T81hGP98z0m6iWrTUA7jHyhzm9nMQsnlF0Y5lbAml8aMRG1ZDWF0cc1q6ofWRS7dGF1MaotWlEmGpIuSE4U6qu/39bzv+aaby8nnu/fs/T7P830+7/N5nveA/QcURWZPa6rZufh4pjBZtZoPDcYJxmTczs3Fth270dXVTQbVMQ6Mi5QTZmZn41jUCcjyAKZMtlc944PZpCQqCkuKEXPqHCRJEmuipaXqHQkGBSS7+OZ3UphFyuhpaGxAVPRJaLVasTQaLVrb2oV3OHhsZtZ1bPELRFh4BJ8Z1TMEs0gH5H6S9CSMxn5BJkkaUWn9q9fklWhxKkX8EgvsJ9mTVYLOdabqG+YnjCIlM0lC0yn2wkLv6RlZqKurVwlN0m7auAEpSYnEKYlqEi5cRMmDEkotw9bWBhKp4ew8lQuN2uc1uJaSitraGkEs8REeTN5h6EBcwiXMnq3D9oAAkbzj00ds8glEr7FXHILbDh3Yj/Xr1nA+gZ7e7wjaGSL2Op0L5rm5ISfvDhYtnI/m5mY0vm/iAmCFxzL46/W8UgZZGUD2rZvw1W9DUVEJMtKv4+u3bhoGBcnXUmH8YRRkfB09fJAIvcXeJC1QUfGEVNCI1dLSjryCe9BoLfC4sgotrW1ktxC+quoaES9RYhaXcB4ZWTeEgYMHBG7Vw8vTA3r/IPT19QsldgbtgJ/vZiIcPQoMbTRUr9+8FdXfvJ0r7jAXca23F5ycnGBjbQV3d3cRS/IqQuDSR+U4czYWhs5OOqUWdnZ2WLJ4Ae7dL6YeK1jtuQphoQd+Q2iCGBJKdCUpGZWV1UIJbnOZMQ0he3bBYYqDGC6OoZ7SYzAYcCQ8Ei/rX6ny8TwMc+fOweXzsbAU99JkHw1+LxOvJpGk1dDQt+FhoUhNS0Pjuya4ukxHyN5gODo4UqQ0NL38FFyG2LOnSQY3SsInmcHK2hpRkRGY8BdCfuSHpaWorHpmak2AH3SzXKkVPpA0EppbPyC/4C5FqeCVDgfvcU9vDwveu48tXb6S5eTliz/4f0NhL+pesqtJyWo8z6Sw+4VFrKysXOxNrTRVMwY84HPXFxZ9PIbJZhEOYjCxKfkQRr7/6ulYDDf/Sdb/AfATw+uWtEaQeO0AAAAASUVORK5CYII=\\\" alt=\\\"\\\" />&nbsp;: l\'&eacute;l&egrave;ve n\'est absent que sur une partie du cours&nbsp;<br /><img src=\\\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAACxMAAAsTAQCanBgAAAILSURBVDhPjZPta1JhGMavPEcx6z+YCZlfKqGX1VzbzMzT3NYgogKpZSpJQf/ECEYUEcWgRWtrRZ9icy8U5DaKqKnrU2svlpuDcWw1XNA+iKjg3fHZ04vFsf0+3fd1P8/FuS/OA9ogg8MjvCpHg/+Qy+XQce0G3k994Eo5m0ouvC4jm80iPDqGB719+Ly8jK1bDLBYLNhhNuNA9X64jjqh1WrVDaKxSTztH8DbiQiKxSJXf7PNaMStm9fVDX4yMzuL9qsdMJlM2Ld3D0JDw5DlFJvt3rUTGwoxk8lQ590uViur0RnPOaqps5PdKZHwJjLZ/vLVazS7GyGKInMuUSgU8CI8quQwDr1ej5YmNwRBYGfmF5JIzC/AarVCY6s5iLl4HIHgJeTzeXa5PzQIyd2i7B9FwOdloel0OjYrsSTLEEQBfm/b+gq373SSrd5BbRcCFLx8hWobjtBEJMY++W+mpmeozuGirvvdrP+VwUBoiKpr68nW4CA5leJqOd/X1shz3kd9j59QkWvMIJ1OU+uJU3TYeYwO2Z1KYPfY8E9WV79Rd08vxeMfubIOvq6s0MnTHpKajtOcMozG3inpuuhTIsGPVAZnvX6SmlspPDbOJaKeh4/IGwjyrjKazQYDLvp9aJRcPGPAryQvCKLyC3/hSgW40T8kk4s08uw579RRfY1m83YYq6p4pwbwAx89JDecK4JVAAAAAElFTkSuQmCC\\\" alt=\\\"\\\" />&nbsp;&nbsp;:&nbsp;&nbsp;&nbsp; l\'&eacute;l&egrave;ve &eacute;tait absent &agrave; l&rsquo;heure pr&eacute;c&eacute;dente (en rouge si l\'absence est non r&eacute;gl&eacute;e)</span></span></div><div style=\\\"text-align: left; text-indent: 0px; margin-left: 0px;\\\"><span style=\\\"font-family: Arial; font-size: 12px;\\\"><span style=\\\"font-family: Arial;\\\"><br /><span style=\\\"color: #ff0000;\\\">Nom de l\'&eacute;l&egrave;ve en rouge</span> : Il &eacute;tait absent&nbsp;&agrave; votre&nbsp;dernier cours</span></span></div></div><div style=\\\"text-align: left; text-indent: 0px; margin-left: 0px;\\\">&nbsp;</div><div style=\\\"text-align: left; text-indent: 0px; margin-left: 0px;\\\"><span style=\\\"font-family: Arial; font-size: 12px;\\\"><strong>D&eacute;compte des &eacute;v&egrave;nements pass&eacute;s</strong></span></div><span style=\\\"font-family: Arial; font-size: 12px;\\\">Dans chaque colonne, PRONOTE d&eacute;compte le nombre d\'&eacute;v&egrave;nements que vous avez affect&eacute; &agrave; chaque &eacute;l&egrave;ve depuis la date d&eacute;finie en haut &agrave; droite. Un double clic sur ce nombre affiche le d&eacute;tail des &eacute;v&egrave;nements de l\'&eacute;l&egrave;ve ainsi que, si vous en avez l\'autorisation, les &eacute;v&egrave;nements de m&ecirc;me nature dans les autres mati&egrave;res.</span></div>"},"width":500,"height":280,"type":4,"boutons":{"_T":18,"V":1024}}');
GTraductions.add("AbsenceVS.MFicheFeuilleAppelVSSansCours", '{"titre":"Comment renseigner la feuille \\\"Appel et suivi\\\" ?","html":{"_T":23,"V":"<div style=\\\"text-align: left; text-indent: 0px; margin-left: 0px;\\\"><span style=\\\"font-family: Arial; font-size: 12px;\\\">1. Choisissez votre classe ou groupe et d&eacute;finissez le cr&eacute;neau horaire en choisssant les horaires dans le bandeau de titre.</span></div><div style=\\\"text-align: left; text-indent: 0px; font-family: Arial; font-size: 13px; margin-left: 0px;\\\"><span style=\\\"font-family: Arial; font-size: 8px;\\\">&nbsp;</span></div><div style=\\\"text-align: left; text-indent: 0px; margin-left: 0px;\\\"><span style=\\\"font-family: Arial; font-size: 12px;\\\">2. Dans chaque colonne cochez les &eacute;l&egrave;ves concern&eacute;s par l\'&eacute;v&egrave;nement.</span></div><div style=\\\"text-align: left; text-indent: 0px; margin-left: 0px;\\\">&nbsp;</div><div style=\\\"text-align: left; text-indent: 0px; margin-left: 0px;\\\"><span style=\\\"font-family: Arial; font-size: 12px;\\\">Vous pouvez choisir d\'ajouter des rubriques facultatives dans la fen&ecirc;tre accessible depuis le bouton <img src=\\\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAPCAYAAAA71pVKAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAACxMAAAsTAQCanBgAAAD0SURBVDhPY3x1+/P/X9/+Mvz48puBWPDj8y+G+9eeMjA+ufjhP0jj9w+/oFKEwcdnPxm2HV3DwHjn6Ov/II0/3kBlkMCh9eegLAYGu0AjKIuB4eHzuwzr9i1hYILyMQBI477zm+EYG8CqGaYRBrY8mAlloQKcNsMASOOZRc/ABjbUNTKYxElBZYjQ7KOQjuESGMDQjE0hUX7GZQMMwLwAAyxQGqtG9IBC1ggCcM3YNKIrRgdYA4wYjSCAoZlYjSDAeGXH0/8fHv9kePH2CVSIMHj2+jHDrhMbGRg39536f/zSAYYHz+5ApQiDT18/MLz99IoBAInRj3tGMjDAAAAAAElFTkSuQmCC\\\" alt=\\\"\\\" />.</span></div><div style=\\\"text-align: left; text-indent: 0px; margin-left: 0px;\\\">&nbsp;</div><div style=\\\"text-align: left; text-indent: 0px; margin-left: 0px;\\\"><span style=\\\"font-family: Arial; font-size: 12px;\\\">Dans chaque colonne, PRONOTE d&eacute;compte le nombre d\'&eacute;v&egrave;nements que vous avez affect&eacute; &agrave; &nbsp;chaque &eacute;l&egrave;ve depuis la date d&eacute;finie en haut &agrave; droite. Un double clic sur ce nombre affiche le d&eacute;tail des &eacute;v&egrave;nements de l\'&eacute;l&egrave;ve ainsi que, si vous en avez l\'autorisation, les &eacute;v&egrave;nements de m&ecirc;me nature dans les autres mati&egrave;res.</span></div>"},"width":440,"height":175,"type":4,"boutons":{"_T":18,"V":1024}}');
GTraductions.add("AbsenceVS.dureeAbsence", "Durée de l'absence - %s");
GTraductions.add("AbsenceVS.EdTEleve", "Afficher l'emploi du temps de l'élève sélectionné");
GTraductions.add("AbsenceVS.MasquerEdTEleve", "Masquer l'emploi du temps de l'élève");
GTraductions.add("AbsenceVS.UnRetard", "Un retard");
GTraductions.add("AbsenceVS.ToutesLesPermanences", "Toutes les permanences");
GTraductions.add("AbsenceVS.InscrireDesinscrireRepasMidi", "Inscrire/Désinscrire un élève au repas du midi");
GTraductions.add("AbsenceVS.InscrireDesinscrireRepasSoir", "Inscrire/Désinscrire un élève au repas du soir");
GTraductions.add("AbsenceVS.HintEleveNonDP", "Cet élève n'est pas inscrit à la demi-pension, vous ne pouvez pas lui prévoir de repas");
GTraductions.add("AbsenceVS.HintVerrouille", "L'appel est verrouillé, vous ne pouvez plus saisir d'absence ni de retard.");
GTraductions.add("AbsenceVS.SelectionColonnes", "Sélectionner les colonnes à afficher");
GTraductions.add("AbsenceVS.Titre_FenetreInfirmerie", "Modification du passage à l'infirmerie");
GTraductions.add("AbsenceVS.Choix_RubriquesFacultatives", "Choix des rubriques facultatives");
GTraductions.add("AbsenceVS.RecapEleve", "Afficher le récapitulatif des absences de l'élève sélectionné");
GTraductions.add("ConseilClasse.matieres", "Matières");
GTraductions.add("ConseilClasse.volHoraire", "Vol. H.");
GTraductions.add("ConseilClasse.coeff", "Coeff.");
GTraductions.add("ConseilClasse.nbrNotes", "Nbr. Notes");
GTraductions.add("ConseilClasse.moyennes", "Moyennes");
GTraductions.add("ConseilClasse.moy", "Moy.");
GTraductions.add("ConseilClasse.classe", "Classe");
GTraductions.add("ConseilClasse.moyGenerale", "Moyenne générale");
GTraductions.add("Notes.Creer", "Créer");
GTraductions.add("Notes.CreerDevoir", "Créer un devoir");
GTraductions.add("Notes.CreationDevoir", "\"Création d'un devoir");
GTraductions.add("Notes.ModificationDevoir", "Modification d'un devoir");
GTraductions.add("Notes.PeriodeDejaAffectee", "Cette période est déjà affectée");
GTraductions.add("Notes.AucunEleve", "Aucun élève");
GTraductions.add("Notes.TitreImpression", "Notes");
GTraductions.add("Notes.Brevet", "Brevet");
GTraductions.add("Notes.Colonne.Promotion", "Classe");
GTraductions.add("Notes.Colonne.Moyenne", "Moyenne");
GTraductions.add("Notes.Colonne.MoyenneBrute", "Moy. Brute");
GTraductions.add("Notes.Colonne.Bonus", "Bonus");
GTraductions.add("Notes.Colonne.BonusMalus", "Bonus / Malus");
GTraductions.add("Notes.Colonne.TitreMoyenne", "Prend en compte tous les coefficients et paramètres de calculs et est utilisée pour les résultats et les bulletins");
GTraductions.add("Notes.Colonne.TitreMoyenneBrute", "Ne prend en compte aucun coefficient ni paramètre et sert de référence");
GTraductions.add("Notes.MoyenneGroupe", "Moy. du groupe");
GTraductions.add("Notes.MoyenneClasse", "Moy. de la classe");
GTraductions.add("Notes.Message.NoteEntre", "La valeur doit être comprise entre %s et %s");
GTraductions.add("Notes.Message.DevoirVerrouille", "Vous ne pouvez pas modifier la note car le devoir est verrouillé !");
GTraductions.add("Notes.Message.EleveNonNotable", "L'élève n'a pas pu participer à ce devoir : il n'était pas dans cette classe à la date du devoir.");
GTraductions.add("Notes.Message.MaquetteSansAppreciations", "La maquette du relevé de notes de cette classe ne comporte pas d'appréciations");
GTraductions.add("Notes.MFicheNotationSpecifique", '{"titre":" Comment indiquer une absence, une dispense ... ","html":{"_T":23,"V":"<div><span style=\\\"font-family: Arial; font-size: 12px;\\\">Les notes saisissables sont fonction du barème de chaque devoir.</span></div><div><span style=\\\"font-family: Arial; font-size: 12px;\\\">En revanche vous pouvez indiquer d\'autres états en utilisant les caractères désignés ci-dessous.</span></div><div style=\\\"text-indent: 0px; margin-left: 0px; font-size: 13px;\\\"><span style=\\\"font-family: Arial; font-size: 8px;\\\"> </span></div><div style=\\\"text-indent: 0px; margin-left: 0px;\\\"><span style=\\\"font-family: Arial; font-size: 12px;\\\">Pour ne pas comptabiliser le devoir dans le calcul de la moyenne :</span></div><div style=\\\"text-indent: 0px; margin-left: 0px;\\\"><span style=\\\"font-family: Arial; font-size: 12px;\\\">        </span><strong><span style=\\\"font-family: Arial; font-size: 12px;\\\">A</span></strong><span style=\\\"font-family: Arial; font-size: 12px;\\\"> : L\'élève est Absent (Abs)</span></div><div style=\\\"text-indent: 0px; margin-left: 0px;\\\"><strong><span style=\\\"font-family: Arial; font-size: 12px;\\\"><span style=\\\"font-family: Arial; font-size: 12px;\\\">        </span>D</span></strong><span style=\\\"font-family: Arial; font-size: 12px;\\\"> : L\'élève est Dispensé (Disp)</span></div><div style=\\\"text-indent: 0px; margin-left: 0px;\\\"><span style=\\\"font-family: Arial; font-size: 12px;\\\">        </span><strong><span style=\\\"font-family: Arial; font-size: 12px;\\\">N</span></strong><span style=\\\"font-family: Arial; font-size: 12px;\\\"> : L\'élève est Non noté (N.Not)</span></div><div style=\\\"text-indent: 0px; margin-left: 0px;\\\"><span style=\\\"font-family: Arial; font-size: 12px;\\\">        </span><strong><span style=\\\"font-family: Arial; font-size: 12px;\\\">I</span></strong><span style=\\\"font-family: Arial; font-size: 12px;\\\"> :   L\'élève est Inapte (Inap)</span></div><div style=\\\"text-indent: 0px; margin-left: 0px;\\\"><span style=\\\"font-family: Arial; font-size: 12px;\\\">        </span><strong><span style=\\\"font-family: Arial; font-size: 12px;\\\">R</span></strong><span style=\\\"font-family: Arial; font-size: 12px;\\\"> : L\'élève n\'a pas Rendu son devoir (N.Rdu)</span></div><div style=\\\"text-indent: 0px; margin-left: 0px; font-size: 13px;\\\"><span style=\\\"font-family: Arial; font-size: 8px;\\\"> </span></div><div style=\\\"text-indent: 0px; margin-left: 0px;\\\"><span style=\\\"font-family: Arial; font-size: 12px;\\\">Pour  comptabiliser le devoir comme un 0 dans le calcul de la moyenne :</span></div><div style=\\\"text-indent: 0px; margin-left: 0px;\\\"><span style=\\\"font-family: Arial; font-size: 12px;\\\">        </span><strong><span style=\\\"font-family: Arial; font-size: 12px;\\\">Z</span></strong><span style=\\\"font-family: Arial; font-size: 12px;\\\"> :  L\'élève a une absence injustifiée (Abs*)</span></div><div style=\\\"text-indent: 0px; margin-left: 0px;\\\"><span style=\\\"font-family: Arial; font-size: 12px;\\\">        </span><strong><span style=\\\"font-family: Arial; font-size: 12px;\\\">W</span></strong><span style=\\\"font-family: Arial; font-size: 12px;\\\"> : L\'élève n\'a pas rendu son travail (N. Rdu*)</span></div>"},"width":440,"height":225,"type":4,"boutons":{"_T":18,"V":1024}}');
GTraductions.add("Notes.Bouton.OrdreChronologique", "Affichage des devoirs par ordre chronologique");
GTraductions.add("Notes.Bouton.OrdreChronologiqueInverse", "Affichage des devoirs par ordre chronologique inversé");
GTraductions.add("Notes.Bouton.ParametresServices", "Paramètres des services et sous-services");
GTraductions.add("Notes.Bouton.Aide", "Comment indiquer une absence, une dispense ...");
GTraductions.add("Notes.WAI.TitresDesDevoirs", "Devoirs");
GTraductions.add("Notes.RecupererCSV", "Télécharger une copie en CSV");
GTraductions.add("FicheService.MoyenneService", "Moyenne du service :");
GTraductions.add("FicheService.MoyenneGenerale", "MOYENNE GÉNÉRALE :");
GTraductions.add("FicheService.CoefficientGeneral", "Coefficient");
GTraductions.add("FicheService.CoefficientSousService", "Coefficient sous-service");
GTraductions.add("FicheService.Facultatif", "Facultatif");
GTraductions.add("FicheService.DevoirSupMoyenne", "Ne compter que les devoirs > moy");
GTraductions.add("FicheService.BonusMalus", "Tenir compte des bonus / malus");
GTraductions.add("FicheService.Ponderer", "Pondérer");
GTraductions.add("FicheService.NotePlusHaute", "la note la plus haute");
GTraductions.add("FicheService.NotePlusBasse", "la note la plus basse");
GTraductions.add("FicheService.Arrondir", "arrondir la moyenne à la limite");
GTraductions.add("FicheService.Superieure", "Supérieure");
GTraductions.add("FicheService.LaPlusProche", "La plus proche");
GTraductions.add("FicheService.ErreurSaisieNote", "La valeur doit être comprise entre %d et %d");
GTraductions.add("FicheService.ModeCalculMoyenne", "Mode de calcul de la moyenne");
GTraductions.add("FicheService.ModeCalculMoyenneSousService", "Moyenne des sous-services");
GTraductions.add("FicheService.ModeCalculMoyenneDevoir", "Moyenne des devoirs");
GTraductions.add("FicheService.MoyenneBulletin", "Moyenne de référence du bulletin");
GTraductions.add("FicheService.MoyenneBulletinGroupe", "Tous les élèves du groupe");
GTraductions.add("FicheService.MoyenneBulletinClasse", "Les élèves de la même classe");
GTraductions.add("GrilleCalendrier.midi", "midi");
GTraductions.add("GrilleCalendrier.soir", "soir");
GTraductions.add("EquipePedagogique.professeurPrincipal", "Professeur principal");
GTraductions.add("EquipePedagogique.professeursPrincipaux", "Professeurs principaux");
GTraductions.add("EquipePedagogique.titresListe", "Professeur");
GTraductions.add("EquipePedagogique.titresListe", "Enseignement");
GTraductions.add("EquipePedagogique.titresListe", "E-mail");
GTraductions.add("EquipePedagogique.titre", "Équipe pédagogique");
GTraductions.add("EquipePedagogique.nonrenseigne", "Équipe pédagogique non renseigné");
GTraductions.add("Agenda.CreerEvenement", "Créer un nouvel événement");
GTraductions.add("Agenda.ModifierEvenement", "Modifier l'événement sélectionné");
GTraductions.add("Agenda.SupprimerEvenement", "Supprimer l'événement sélectionné");
GTraductions.add("Agenda.CollerEvenement", "Coller l'évènement copié");
GTraductions.add("Agenda.CopierEvenement", "Copier l'évènement sélectionné");
GTraductions.add("Agenda.AucunEvenement", "Aucun événement publié pour la semaine sélectionnée");
GTraductions.add("Agenda.AucunEvenementPublie", "Aucun événement publié");
GTraductions.add("Agenda.Salle", "Salle");
GTraductions.add("Agenda.President", "Président");
GTraductions.add("Agenda.ParentsDelegues", "Parents délégués");
GTraductions.add("Agenda.ElevesDelegues", "Élèves délégués");
GTraductions.add("Agenda.A", "A");
GTraductions.add("Agenda.Du", "Du");
GTraductions.add("Agenda.De", "De");
GTraductions.add("Agenda.SemaineDu", "semaine du");
GTraductions.add("Agenda.AgendaDe", "Agenda de");
GTraductions.add("RecapAbsenceEleve.HeuresSuiviParClasse", "Heures suivies par classe");
GTraductions.add("RecapAbsenceEleve.DetailsHeuresManquees", "Heures manquées");
GTraductions.add("RecapAbsenceEleve.TotalManquees", "Total");
GTraductions.add("RecapAbsenceEleve.Absences", "Absences élève");
GTraductions.add("RecapAbsenceEleve.ExclusionCours", "Exclusions cours");
GTraductions.add("RecapAbsenceEleve.ExclusionEtablissement", "Exclusions établissement");
GTraductions.add("RecapAbsenceEleve.Infirmerie", "Passage Infirmerie");
GTraductions.add("RecapAbsenceEleve.NbMatieres", "%s matières(s)");
GTraductions.add("fenetreInfosMedicales.titre", "Informations médicales");
GTraductions.add("FenetreDevoir.Service", "Pour le service :");
GTraductions.add("FenetreDevoir.Date", "Date :");
GTraductions.add("FenetreDevoir.Matiere", "Matière :");
GTraductions.add("FenetreDevoir.SousMatiere", "Sous-matière :");
GTraductions.add("FenetreDevoir.Enseignant", "Professeur :");
GTraductions.add("FenetreDevoir.Classe", "Elève de la classe");
GTraductions.add("FenetreDevoir.Groupe", "Elève du groupe");
GTraductions.add("FenetreDevoir.Coefficient", "Coefficient :");
GTraductions.add("FenetreDevoir.Bareme", "Notation sur :");
GTraductions.add("FenetreDevoir.Ramenersur20", "Ramener sur %s les notes du devoir lors du calcul de la moyenne");
GTraductions.add("FenetreDevoir.Facultatif", "Facultatif");
GTraductions.add("FenetreDevoir.CommeUnBonus", "Comme un bonus");
GTraductions.add("FenetreDevoir.CommeUneNote", "Comme une note");
GTraductions.add("FenetreDevoir.Periodes", "Périodes :");
GTraductions.add("FenetreDevoir.ElevesDe", "Elèves de");
GTraductions.add("FenetreDevoir.PeriodeNotation", "Période 1");
GTraductions.add("FenetreDevoir.PeriodeNotation", "Période 2");
GTraductions.add("FenetreDevoir.Commentaire", "Commentaire :");
GTraductions.add("FenetreDevoir.DatePublication", "Publier la note à partir du ");
GTraductions.add("FenetreDevoir.DevoirPourBrevet", "Devoir à prendre en compte pour la note du brevet");
GTraductions.add("FenetreDevoir.Verrouille", "Devoir verrouillé");
GTraductions.add("FenetreDevoir.ConfirmerSuppression", "Voulez-vous supprimer ce devoir ?");
GTraductions.add("FenetreDevoir.ReponseEleveEntre", "Les élèves pourront répondre entre : ");
GTraductions.add("FenetreDevoir.AvertissementChangementDeBareme1", "Toutes les notes supérieures à %s vont être modifiées !");
GTraductions.add("FenetreDevoir.ConfirmerChangementDeBareme", "Confirmez-vous le changement de notation du devoir ?");
GTraductions.add("FenetreDevoir.AucunCorrige", "Aucun");
GTraductions.add("FenetreDevoir.AvecLeCorrige", "Avec le corrigé");
GTraductions.add("FenetreDevoir.AvecCorrigeQCM", "Avec le corrigé de l'iDevoir");
GTraductions.add("FenetreDevoir.MsgConfirmSupprCorrige", "Voulez-vous supprimer le corrigé du devoir ?");
GTraductions.add("FenetreDevoir.CmdSupprimerCorrige", "Supprimer le corrigé");
GTraductions.add("FenetreDevoir.MFicheBaremeDifferentDe20", '{"titre":" Comment utiliser un barème différent du barème général ?","html":{"_T":23,"V":"<div style=\\\"text-indent: 0px; margin-left: 0px;\\\">&nbsp;</div><div><span style=\\\"font-family: Arial; font-size: 12px;\\\">Un devoir not&eacute; sur un bar&egrave;me de notation diff&eacute;rent du bar&egrave;me g&eacute;n&eacute;ral peut &ecirc;tre pris en compte de deux fa&ccedil;ons dans le calcul de la moyenne du service :</span></div><div style=\\\"font-size: 13px;\\\"><span style=\\\"font-family: Arial; font-size: 12px;\\\">&nbsp;</span></div><div><span style=\\\"font-family: Arial; font-size: 12px;\\\">- Si vous cochez la case <span style=\\\"color: #888888;\\\"><em><strong>Ramener les notes sur 20 lors du calcul de la moyenne</strong></em></span>, PRONOTE ram&egrave;nera toutes les notes sur un bar&egrave;me de 20 avant de calculer la moyenne du service.</span></div><div style=\\\"font-size: 13px;\\\"><span style=\\\"font-family: Arial; font-size: 12px;\\\">&nbsp;</span></div><div><span style=\\\"font-family: Arial; font-size: 12px;\\\">- Si vous ne cochez pas <span style=\\\"color: #888888;\\\"><em><strong>Ramener les notes sur 20 lors du calcul de la moyenne</strong></em></span>, chaque devoir sera pond&eacute;r&eacute; par son bar&egrave;me : ainsi un devoir sur 10 comptera dans la moyenne deux fois moins qu\'un devoir sur 20.</span></div><div style=\\\"font-size: 13px;\\\"><span style=\\\"font-family: Arial; font-size: 12px;\\\">&nbsp;</span></div><div style=\\\"line-height: 115%; margin-left: 0px; margin-right: 0px;\\\"><span style=\\\"font-family: arial,helvetica,sans-serif;\\\"><em><span style=\\\"font-size: 12px;\\\">Exemple&nbsp;:</span><span style=\\\"font-size: 12px;\\\"><br />Vous avez trois notes, 18/20, 2/10 et 1/5.<br />Si vous cochez <span style=\\\"color: #888888;\\\"><strong>Ramener les notes sur 20</strong></span>, la moyenne sera&nbsp;:</span></em></span></div><div style=\\\"line-height: 115%; margin-left: 0px; margin-right: 0px;\\\"><table style=\\\"width: 367px; height: 47px;\\\" border=\\\"0\\\"><tbody><tr><td><div><span style=\\\"font-family: arial,helvetica,sans-serif;\\\">&nbsp;</span></div><span style=\\\"font-family: arial,helvetica,sans-serif;\\\"><em><span style=\\\"font-size: 12px;\\\">&nbsp;&nbsp;&nbsp;</span><span style=\\\"text-decoration: underline;\\\"><span style=\\\"font-size: 12px;\\\">&nbsp;18 + 4 + 4 &nbsp;&nbsp;</span></span></em></span><div style=\\\"line-height: 115%; margin-left: 0px; margin-right: 0px;\\\"><span style=\\\"font-family: arial,helvetica,sans-serif;\\\"><em><span style=\\\"font-size: 12px;\\\">&nbsp;&nbsp;&nbsp;20 + 20 + 20</span></em></span></div></td><td><span style=\\\"font-family: arial,helvetica,sans-serif;\\\"><em><span style=\\\"font-size: 12px;\\\">X 20 = 8,67, soit une note de 8,67/20</span></em></span></td></tr></tbody></table></div><div style=\\\"line-height: 115%; margin-left: 0px; margin-right: 0px;\\\"><span style=\\\"font-family: arial,helvetica,sans-serif;\\\"><em><span style=\\\"font-size: 12px;\\\">&nbsp;</span></em></span></div><div style=\\\"line-height: 115%; margin-left: 0px; margin-right: 0px;\\\"><span style=\\\"font-family: arial,helvetica,sans-serif;\\\"><em><span style=\\\"font-size: 12px;\\\">Si vous ne cochez pas <span style=\\\"color: #888888;\\\"><strong>Ramener les notes sur 20</strong></span>, la moyenne sera&nbsp;:</span></em></span></div><div style=\\\"line-height: 115%; margin-left: 0px; margin-right: 0px;\\\"><table style=\\\"width: 370px; height: 47px;\\\" border=\\\"0\\\"><tbody><tr><td><div><span style=\\\"font-family: arial,helvetica,sans-serif;\\\">&nbsp;</span></div><div><span style=\\\"font-family: arial,helvetica,sans-serif;\\\"><em><em><span style=\\\"text-decoration: underline;\\\"><span style=\\\"font-size: 12px;\\\"><em><span style=\\\"font-size: 12px;\\\">&nbsp; &nbsp;</span><span style=\\\"text-decoration: underline;\\\"><span style=\\\"font-size: 12px;\\\">18 +2 +1&nbsp;&nbsp;&nbsp;</span></span><span style=\\\"font-size: 12px;\\\">&nbsp;</span></em></span></span></em></em></span></div><div><span style=\\\"font-family: arial,helvetica,sans-serif;\\\"><em><span style=\\\"font-size: 12px;\\\">&nbsp; 20 + 10 + &nbsp;</span></em><span style=\\\"font-size: 12px;\\\">5</span></span></div></td><td><span style=\\\"font-family: arial,helvetica,sans-serif;\\\"><em><span style=\\\"font-size: 12px;\\\">X 20 = 12, soit une note de 12/20</span></em></span></td></tr></tbody></table></div><div style=\\\"line-height: 115%; margin-left: 0px; margin-right: 0px;\\\"><div style=\\\"line-height: 115%; margin-bottom: 13px;\\\"><span style=\\\"font-family: arial,helvetica,sans-serif; font-size: 14px;\\\">&nbsp;</span></div></div>"},"width":487,"height":350,"type":4,"boutons":{"_T":18,"V":1024}}');
GTraductions.add("FenetreDevoir.MFicheDevoirFacultatif", '{"titre":" Qu\'est ce qu\'un devoir facultatif ?","html":{"_T":23,"V":"<div>&nbsp;</div><div><strong><span style=\\\"font-family: Arial; font-size: 12px;\\\">M&eacute;thode 1 : Comme un bonus</span></strong></div><div style=\\\"font-size: 11px;\\\"><strong><span style=\\\"font-family: Arial; font-size: 10px;\\\">&nbsp;</span></strong></div><div><span style=\\\"font-family: Arial; font-size: 12px;\\\">Seuls les points sup&eacute;rieurs &agrave; 10 des devoirs facultatifs sont pris en compte dans le calcul de la moyenne du service ou sous-service.</span></div><div style=\\\"padding-left: 30px;\\\"><em><span style=\\\"font-family: Arial; font-size: 12px;\\\">Moyenne des devoirs non facultatifs (12+16) / 2 = 14</span></em></div><div style=\\\"padding-left: 30px;\\\"><span style=\\\"text-decoration: underline;\\\"><em><span style=\\\"font-family: Arial; font-size: 12px;\\\">Exemple 1</span></em></span></div><div style=\\\"padding-left: 30px;\\\"><em><span style=\\\"font-family: Arial; font-size: 12px;\\\">Devoir facultatif : 17, Moyenne : (12+16+7) / 2 = 17,5</span></em></div><div style=\\\"padding-left: 30px;\\\"><span style=\\\"text-decoration: underline;\\\"><em><span style=\\\"font-family: Arial; font-size: 12px;\\\">Exemple 2</span></em></span></div><div style=\\\"padding-left: 30px;\\\"><em><span style=\\\"font-family: Arial; font-size: 12px;\\\">Devoir facultatif : 8, Moyenne : (12+16+0) / 2 = 14</span></em></div><div style=\\\"font-size: 13px;\\\"><em><span style=\\\"font-family: Arial; font-size: 12px;\\\">&nbsp;</span></em></div><div><strong><span style=\\\"font-family: Arial; font-size: 12px;\\\">M&eacute;thode 2 : Comme une note</span></strong></div><div style=\\\"font-size: 11px;\\\"><strong><span style=\\\"font-family: Arial; font-size: 10px;\\\">&nbsp;</span></strong></div><div><span style=\\\"font-family: Arial; font-size: 12px;\\\">Les devoirs facultatifs sont pris en compte, dans la moyenne du service ou sous-service, uniquement s\'ils am&eacute;liorent la moyenne de l\'&eacute;l&egrave;ve.</span></div><div style=\\\"padding-left: 30px;\\\"><em><span style=\\\"font-family: Arial; font-size: 12px;\\\">Moyenne des devoirs non facultatifs (12+16) / 2 = 14</span></em></div><div style=\\\"padding-left: 30px;\\\"><span style=\\\"text-decoration: underline;\\\"><em><span style=\\\"font-family: Arial; font-size: 12px;\\\">Exemple 1</span></em></span></div><div style=\\\"padding-left: 30px;\\\"><em><span style=\\\"font-family: Arial; font-size: 12px;\\\">Devoir facultatif : 17, Moyenne : (12+16+17) / (2+1) = 15</span></em></div><div style=\\\"padding-left: 30px;\\\"><span style=\\\"text-decoration: underline;\\\"><em><span style=\\\"font-family: Arial; font-size: 12px;\\\">Exemple 2</span></em></span></div><div style=\\\"padding-left: 30px;\\\"><em><span style=\\\"font-family: Arial; font-size: 12px;\\\">Devoir facultatif : 8, Moyenne : (12+16+0) / (2+0) = 14</span></em></div>"},"width":420,"height":297,"type":4,"boutons":{"_T":18,"V":1024}}');
GTraductions.add("FenetreDevoir.WAI_SelectionDe", "Sélection de");
GTraductions.add("FenetreDevoir.WAI_PourLesElevesDe", "pour les élèves de");
GTraductions.add("SaisieQCM.HintRessentiDifficile", "L'élève a indiqué qu'il a trouvé ce QCM difficile");
GTraductions.add("SaisieQCM.QuestionsFiltrees", "%d questions n'ont pas été exportées car elles sont sous copyright Nathan.");
GTraductions.add("SaisieQCM.HintFeedback", "Information donnée à l'élève après qu'il ait répondu (dépend des options des modalités d'exécution)");
GTraductions.add("SaisieQCM.ActiverCaseSensitive", "Respecter la casse et les accents");
GTraductions.add("SaisieQCM.QCMnonTermine", "Le corrigé n'est pas disponible, l'iDevoir n'est pas terminé.");
GTraductions.add("SaisieQCM.CDTPourLeQCM", "Associer le QCM à un cahier de textes");
GTraductions.add("SaisieQCM.VoirCorrige", "Voir la copie de l'élève");
GTraductions.add("SaisieQCM.RedonnerTAF", "Redonner le travail à faire aux élèves sélectionnés");
GTraductions.add("SaisieQCM.AnnulerNote", "Permettre aux élèves sélectionnés de refaire le devoir");
GTraductions.add("SaisieQCM.SupprimerResultat", "Supprimer les réponses des élèves sélectionnés");
GTraductions.add("SaisieQCM.AnnulerDevoir", "Les élèves :\n%s\nn'ont pas démarré le devoir. Si vous continuez leur session sera clôturée. Souhaitez-vous les ajouter aux élèves sélectionnés pour refaire le devoir ?");
GTraductions.add("SaisieQCM.TitreRedonnerTAF", "Redonner le travail à faire");
GTraductions.add("SaisieQCM.TitreAnnulerNote", "Permettre aux élèves de refaire le devoir");
GTraductions.add("SaisieQCM.TexteRedonnerTAF", "Définir la date à laquelle le travail à faire doit être rendu");
GTraductions.add("SaisieQCM.ConfirmDeleteQCM", "Etes-vous sûr de vouloir supprimer ce QCM ? Toutes les questions, résultats, devoirs et contenus associés seront effacés !");
GTraductions.add("SaisieQCM.HintReponsesProposees", "Liste des propositions soumises à l'élève");
GTraductions.add("SaisieQCM.ActiverCaseSensitiveEpellation", "Respecter la casse et les accents");
GTraductions.add("ExecutionQCM.notation.non_note", '<p>QCM <strong>non not&eacute;</strong></p>');
GTraductions.add("ExecutionQCM.notation.titre.non_note", "QCM non noté");
GTraductions.add("ExecutionQCM.notation.revision", '<p>QCM <strong>de r&eacute;vision</strong></p>');
GTraductions.add("ExecutionQCM.notation.titre_informatif", '<p>QCM &eacute;valu&eacute; sur %d <strong>non comptabilis&eacute; dans la moyenne</strong></p>');
GTraductions.add("ExecutionQCM.notation.titre.titre_informatif", "QCM évalué sur %d ");
GTraductions.add("ExecutionQCM.notation.associe_devoir", '<p>iDevoir not&eacute; sur %d <strong>comptabilis&eacute; dans la moyenne</strong></p>');
GTraductions.add("ExecutionQCM.notation.titre.associe_devoir", "iDevoir noté sur %d ");
GTraductions.add("ExecutionQCM.corrige.aucun", '<p><strong>Sans corrig&eacute;</strong></p>');
GTraductions.add("ExecutionQCM.corrige.chaque_question", '<p>Corrig&eacute; <strong>&agrave; chaque question</strong></p>');
GTraductions.add("ExecutionQCM.corrige.fin_qcm", '<p>Corrig&eacute; <strong>&agrave; la fin</strong></p>');
GTraductions.add("ExecutionQCM.presentation.retour_precedent", '<p><strong>Retour</strong> &agrave; la question pr&eacute;c&eacute;dente</p>');
GTraductions.add("ExecutionQCM.presentation.sans_retour_precedent", '<p><strong>Sans retour</strong> &agrave; la question pr&eacute;c&eacute;dente</p>');
GTraductions.add("ExecutionQCM.presentation.limite_temps", '<p>Dur&eacute;e <strong>limit&eacute;e &agrave; %d</strong></p>');
GTraductions.add("ExecutionQCM.presentation.sans_limite_temps", '<p>Dur&eacute;e <strong>illimit&eacute;e</strong></p>');
GTraductions.add("ExecutionQCM.presentationCorrige.CorrigeQCMExecute", "Ce QCM a déjà été fait");
GTraductions.add("ExecutionQCM.presentationCorrige.CorrigeIdevoirExecute", "Cet iDevoir a déjà été fait");
GTraductions.add("ExecutionQCM.presentationCorrige.limite_temps", "Le temps de réponse était limité à %d");
GTraductions.add("ExecutionQCM.presentationCorrige.sans_limite_temps", "Le temps de réponse n'était pas limité");
GTraductions.add("ExecutionQCM.presentationCorrige.noteObtenue", "Note obtenue : %d/%d");
GTraductions.add("ExecutionQCM.presentationCorrige.reponsesDonnees", "Réponses données : %d/%d dont %d bonnes");
GTraductions.add("ExecutionQCM.presentationCorrige.VisualiserCorrige", "Voir le corrigé");
GTraductions.add("ExecutionQCM.presentationCorrige.RecommencerQCM", "Rejouer le QCM");
GTraductions.add("ExecutionQCM.Minutes", "minutes");
GTraductions.add("ExecutionQCM.MinutesCourt", "min.");
GTraductions.add("ExecutionQCM.SecondesCourt", "sec.");
GTraductions.add("ExecutionQCM.Valider", "Valider");
GTraductions.add("ExecutionQCM.Terminer", "Terminer");
GTraductions.add("QCM.QuestionLibelle", "Question");
GTraductions.add("QCM.BaremePts", "%d pts");
GTraductions.add("ExecutionQCM.valeurRessenti", "Très difficile");
GTraductions.add("ExecutionQCM.valeurRessenti", "Difficile");
GTraductions.add("ExecutionQCM.valeurRessenti", "Moyen");
GTraductions.add("ExecutionQCM.valeurRessenti", "Facile");
GTraductions.add("ExecutionQCM.valeurRessenti", "Très facile");
GTraductions.add("ExecutionQCM.TitreRessenti", "Comment était ce QCM ?");
GTraductions.add("ExecutionQCM.phraseRessenti", "J'ai trouvé ce QCM : ");
GTraductions.add("ExecutionQCM.phraseFin", "C'est la fin de l'iDevoir. Le bouton « Terminer » permet de fermer cette fenêtre.");
GTraductions.add("ExecutionQCM.phraseFinQCM", "C'est la fin du QCM. Le bouton « Terminer » permet de fermer cette fenêtre.");
GTraductions.add("ExecutionQCM.phraseFinAvantCorrige", "C'est la fin de l'iDevoir. Cliquez sur le bouton pour voir le corrigé.");
GTraductions.add("ExecutionQCM.phraseFinQCMAvantCorrige", "C'est la fin du QCM. Cliquez sur le bouton pour voir le corrigé.");
GTraductions.add("ExecutionQCM.PhraseCloture", "Cet iDevoir a déjà été terminé.");
GTraductions.add("ExecutionQCM.PhraseClotureQCM", "Ce QCM a déjà été terminé.");
GTraductions.add("ExecutionQCM.PhraseClotureQCMDelaiMax", "Impossible de poursuivre ce QCM, le délai de réponse est dépassé.");
GTraductions.add("ExecutionQCM.PhraseClotureDelaiMax", "Impossible de poursuivre cet iDevoir, le délai de réponse est dépassé.");
GTraductions.add("ExecutionQCM.LisezIndications", "A lire attentivement");
GTraductions.add("ExecutionQCM.CommencerQCM", "Je commence à répondre");
GTraductions.add("ExecutionQCM.QCMPublieLe", "QCM publié le");
GTraductions.add("ExecutionQCM.RepondreQCM", "Répondre au QCM");
GTraductions.add("ExecutionQCM.RepondreQCMContenu", "QCM pour réviser");
GTraductions.add("ExecutionQCM.Point", "Point");
GTraductions.add("ExecutionQCM.Points", "Points");
GTraductions.add("ExecutionQCM.CopyRightEditeur2013", "© %s 2013");
GTraductions.add("ExecutionQCM.QuestionXSurY", "Question %s/%s");
GTraductions.add("ExecutionQCM.AucunQCMRevision", "Aucun QCM de révision n'est disponible");
GTraductions.add("ExecutionQCM.ImageNonSupportee", "<em>Votre navigateur ne supporte pas l'affichage des images</em>");
GTraductions.add("ExecutionQCM.FichierIndispo", "Le fichier n'est pas disponible");
GTraductions.add("ExecutionQCM.NonExecute", "L'iDevoir n'a pas encore été exécuté");
GTraductions.add("ExecutionQCM.AudioNonSupporte", "Votre navigateur ne supporte pas les fichiers audio");
GTraductions.add("ExecutionQCM.BonneReponse", "Bonne réponse !");
GTraductions.add("ExecutionQCM.Navigation", "Navigation");
GTraductions.add("ExecutionQCM.LabelCorrige", "Corrigé");
GTraductions.add("ExecutionQCM.Suivant", "Suivant");
GTraductions.add("ExecutionQCM.Precedent", "Précédent");
GTraductions.add("ExecutionQCM.phraseClotureNonDemarre", "Le QCM est terminé mais n'a jamais été joué.");
GTraductions.add("FenetreParamExecutionQCM.QuestionsPrisesAuHasard", "questions prises au hasard pour chaque élève");
GTraductions.add("FenetreParamExecutionQCM.PermettreRessentiEleve", "Permettre à l'élève de se prononcer sur le niveau de difficulté ressenti");
GTraductions.add("FenetreParamExecutionQCM.OrdreQuestionAleatoire", "mélangées aléatoirement pour chaque élève");
GTraductions.add("FenetreParamExecutionQCM.RessentiEleve", "Ressenti de l'élève");
GTraductions.add("FenetreParamExecutionQCM.tolererFausses", "Tolérer la présence de réponses fausses si au moins une des réponses est juste");
GTraductions.add("QCM_Divers.MnuImportQCMBiblioNathan", "de la bibliothèque Nathan");
GTraductions.add("QCM_Divers.InfoReponseReponseCourte", "Respecter la casse et les accents");
GTraductions.add("QCM_Divers.classes", "Classes");
GTraductions.add("QCM_Divers.eleves", "%d élèves");
GTraductions.add("QCM_Divers.ExecVerrouillee", "Modification impossible.\nDes élèves ont déjà répondu.");
GTraductions.add("QCM_Divers.ressenti", "Ressenti de l'élève : indique que l'élève a trouvé le QCM difficile");
GTraductions.add("QCM_Divers.nbReponsesOK", "Nombre de bonnes réponses");
GTraductions.add("QCM_Divers.VisuEleve", "Simuler la vision élève");
GTraductions.add("QCM_Divers.TAFPourLe", "pour le %s");
GTraductions.add("QCM_Divers.HintBtnSaisieQCMTraining", "Ajouter des QCM de révision");
GTraductions.add("QCM_Divers.PourReviser", "QCM");
GTraductions.add("QCM_Divers.InfoReponseChoixUnique", "L'élève devra cocher la bonne réponse parmi les réponses proposées");
GTraductions.add("QCM_Divers.InfoReponseChoixMultiple", "L'élève devra cocher les bonnes réponses parmi les réponses proposées");
GTraductions.add("QCM_Divers.InfoReponseNumerique", "La réponse de l'élève sera prise en compte indépendamment des séparateurs numériques et des espaces");
GTraductions.add("QCM_Divers.InfoReponseAssociation", "L'élève devra reformer les associations [A <-> B] ci-dessous");
GTraductions.add("OffreStage.NonPublie", "En attente de validation");
GTraductions.add("OffreStage.PostesPourvus", "Postes pourvus");
GTraductions.add("OffreStage.Sujet", "Sujet :");
GTraductions.add("OffreStage.SujetDetaille", "Sujet détaillé");
GTraductions.add("OffreStage.PostesAPourvoir", "Nb. postes à pourvoir");
GTraductions.add("OffreStage.DureePrevue", "Durée prévue (en semaines)");
GTraductions.add("OffreStage.Commentaire", "Commentaire");
GTraductions.add("OffreStage.Proposer", "Proposer cette offre");
GTraductions.add("OffreStage.TitreEdition", "Modification de l'offre de stage");
GTraductions.add("OffreStage.EditInterdit_Auteur", "Vous n'êtes pas l'auteur de cette offre de stage");
GTraductions.add("OffreStage.EditInterdit_Publie", "Cette offre de stage est publiée");
GTraductions.add("OffreStage.TitreListeOffres", "Offres déjà proposées");
GTraductions.add("OffreStage.TitreNewOffre", "Nouvelle offre");
GTraductions.add("OffreStage.MsgAucuneOffre", "Il n'y a aucune offre de stage.");
GTraductions.add("OffreStage.PostesRestants", "Nb. postes disponibles");
GTraductions.add("OffreStage.titre.Sujet", "Sujet");
GTraductions.add("OffreStage.titre.Entreprise", "Entreprise");
GTraductions.add("OffreStage.titre.Activite", "Activité");
GTraductions.add("OffreStage.titre.Duree", "Durée (sem)");
GTraductions.add("OffreStage.titre.CodePostal", "Code Postal");
GTraductions.add("OffreStage.titre.Date", "Date");
GTraductions.add("OffreStage.info.Duree", "Durée prévue (en semaines)");
GTraductions.add("OffreStage.selectOffre", "Sélectionnez une offre de stage");
GTraductions.add("OffreStage.DepuisLe", "Depuis le");
GTraductions.add("OffreStage.AuMoins", "Au moins");
GTraductions.add("OffreStage.Semaines", "semaines");
GTraductions.add("OffreStage.titre.Filtre", "Critères de recherche");
GTraductions.add("OffreStage.titre.FiltreSujet", "Sélectionnez les sujets");
GTraductions.add("OffreStage.titre.FiltreEntreprise", "Sélectionnez les entreprises");
GTraductions.add("OffreStage.titre.FiltreActivite", "Sélectionnez les activités");
GTraductions.add("OffreStage.titre.FiltreCodePostal", "Sélectionnez les codes postaux");
GTraductions.add("OffreStage.SujetNonDefini", "Sujet non renseigné");
GTraductions.add("OffreStage.ActiviteNonDefini", "Activité non renseignée");
GTraductions.add("OffreStage.CodePostalNonDefini", "Code postal non défini");
GTraductions.add("ReleveDeNotes.CoeffficientDevoir", "coefficient du devoir");
GTraductions.add("ReleveDeNotes.BaremeDevoir", "barème du devoir");
GTraductions.add("ReleveDeNotes.AbreviationCoef", "Coef.");
GTraductions.add("ReleveDeNotes.AucuneAppreciation", "Aucune appréciation");
GTraductions.add("ReleveDeNotes.Note", "Note");
GTraductions.add("ReleveDeNotes.MoyEleve", "Moy. élève");
GTraductions.add("TypeNote.Annotation.Absent", "Abs");
GTraductions.add("TypeNote.Annotation.Dispense", "Disp");
GTraductions.add("TypeNote.Annotation.NonNote", "N.Not");
GTraductions.add("TypeNote.Annotation.Inapte", "Inap");
GTraductions.add("TypeNote.Annotation.NonRendu", "N.Rdu");
GTraductions.add("TypeNote.CaractereAnnotation.Absent", "a");
GTraductions.add("TypeNote.CaractereAnnotation.Dispense", "d");
GTraductions.add("TypeNote.CaractereAnnotation.NonNote", "n");
GTraductions.add("TypeNote.CaractereAnnotation.Inapte", "i");
GTraductions.add("TypeNote.CaractereAnnotation.NonRendu", "r");
GTraductions.add("TypeNote.CaractereAnnotation.AbsentZero", "z");
GTraductions.add("TypeNote.CaractereAnnotation.NonRenduZero", "w");
GTraductions.add("PageCompte.Identifiant", "Identifiant");
GTraductions.add("PageCompte.MotDePasse", "Mot de passe");
GTraductions.add("PageCompte.Coordonnees", "Coordonnées");
GTraductions.add("PageCompte.Autorisations", "Autorisations");
GTraductions.add("PageCompte.CompteEnfant", "Compte de votre enfant");
GTraductions.add("PageCompte.Modifier", "Modifier");
GTraductions.add("PageCompte.titreEcranMotDePasse", "Modification de votre mot de passe");
GTraductions.add("PageCompte.titreEcranMotDePasseEnfant", "Modification du mot de passe de votre enfant");
GTraductions.add("PageCompte.libelle1EcranMotDePasse", "1. Saisissez votre mot de passe actuel :");
GTraductions.add("PageCompte.libelle2EcranMotDePasse", "2. Saisissez votre nouveau mot de passe :");
GTraductions.add("PageCompte.libelle3EcranMotDePasse", "3. Confirmez votre nouveau mot de passe :");
GTraductions.add("PageCompte.libelle1EcranMotDePasseEleve", "1. Saisissez le nouveau mot de passe :");
GTraductions.add("PageCompte.libelle2EcranMotDePasseEleve", "2. Confirmez le nouveau mot de passe :");
GTraductions.add("PageCompte.message1MotDePasse", "Veuillez saisir votre mot de passe actuel.");
GTraductions.add("PageCompte.message2MotDePasse", "Le nouveau mot de passe ne peut être vide.");
GTraductions.add("PageCompte.ErreurConfirmationMotDePasse", "La modification a échoué.\nLe nouveau mot de passe et sa confirmation ne sont pas identiques.");
GTraductions.add("PageCompte.titreEcranIdentifiant", "Modification de votre identifiant");
GTraductions.add("PageCompte.libelle1EcranIdentifiant", "1. Saisissez votre mot de passe :");
GTraductions.add("PageCompte.libelle2EcranIdentifiant", "2. Saisissez votre nouvel identifiant :");
GTraductions.add("PageCompte.conseil2EcranIdentifiant", "(Un identifiant doit comporter au moins %d caractères)");
GTraductions.add("PageCompte.libelle3EcranIdentifiant", "3. Confirmez votre nouvel identifiant :");
GTraductions.add("PageCompte.message1Identifiant", "Veuillez saisir votre mot de passe actuel.");
GTraductions.add("PageCompte.message2Identifiant", "Le nouvel identifiant ne peut être vide.");
GTraductions.add("PageCompte.message3Identifiant", "Erreur dans la saisie des nouveaux identifiants.");
GTraductions.add("PageCompte.IdentifiantEnfant", "Identifiant :");
GTraductions.add("PageCompte.MotDePasseEnfant", "Mot de passe :");
GTraductions.add("PageCompte.Supprimer", "Supprimer");
GTraductions.add("PageCompte.SupprimerInfo", "Supprimer le mot de passe de ");
GTraductions.add("PageCompte.Valider", "Valider");
GTraductions.add("PageCompte.ValiderInfo", "Valider le nouveau mot de passe.");
GTraductions.add("PageCompte.MsgNewMotDePasse", "Veuillez saisir le nouveau mot de passe");
GTraductions.add("PageCompte.MsgEnfant1", "Votre enfant peut personnaliser son mot de passe à partir de l'onglet \"Mon compte\" lorsqu'il est connecté à l'Espace Elèves de l'établissement.");
GTraductions.add("PageCompte.MsgEnfant2", "Si votre enfant oublie son mot de passe vous pourrez le supprimer afin d'en saisir un nouveau.");
GTraductions.add("PageCompte.MailNonValide", "adresse électronique non valide");
GTraductions.add("PageCompte.DerniereConnexion", "Dernière connexion");
GTraductions.add("PageRemplacement.Cours_Initial", "Cours initial");
GTraductions.add("PageRemplacement.Remplacement", "Remplacement");
GTraductions.add("PageRemplacement.Aucun_Remplacement", "Aucun remplacement");
GTraductions.add("PageRemplacement.Date_Et_Heure", "Date et heure");
GTraductions.add("PageRemplacement.TotalHeuresNonAssurees", "Total des heures non assurées");
GTraductions.add("PageRemplacement.TotalHeuresRemplacees", "Total des heures remplacées");
GTraductions.add("PageRemplacement.Remplace", "Remplacé");
GTraductions.add("PageRemplacement.RemplacePar", "Remplacé par");
GTraductions.add("PageRemplacement.NonAssure", "Non assuré");
GTraductions.add("PageRemplacement.Annule", "Annulé");
GTraductions.add("PageRemplacement.Permanence", "Permanence");
GTraductions.add("PageRemplacement.TableauRemplacements", "Tableau des remplacements.");
GTraductions.add("PageRemplacement.Remplacement_AucunCours", "Aucun cours non assuré pour la période selectionnée");
GTraductions.add("PageRemplacement.RemplacementPour", "Remplacements pour");
GTraductions.add("PageRemplacement.GrilleRemplacement", "Grille des remplacements.");
GTraductions.add("AutorisationSortie.titre", "Autorisations de sortie");
GTraductions.add("AutorisationSortie.intro1", "Choisissez l'autorisation de sortie de votre enfant. Quelque soit l'autorisation choisie, votre enfant ne pourra quitter l'établissement entre deux heures de cours.");
GTraductions.add("AutorisationSortie.intro2", "Ces autorisations permettent de prendre en charge votre enfant au sein de l'établissement et d'en autoriser sa sortie (en cas de permanence ou d'absence de professeurs par exemple)");
GTraductions.add("AutorisationSortie.fixee", "Les entrées/sorties de votre enfant sont contrôlées selon l'autorisation suivante :");
GTraductions.add("RegimeEleve.titreFenetreSelection", "Sélection des régimes élèves");
GTraductions.add("RegimeEleve.regimes", "Régimes");
GTraductions.add("RecapAbs.colClasses", "Classes");
GTraductions.add("RecapAbs.colEleves", "Elèves");
GTraductions.add("RecapAbs.colNaiss", "Né(e) le");
GTraductions.add("RecapAbs.colRegime", "Régimes");
GTraductions.add("RecapAbs.colNbAbs", "Nb Abs");
GTraductions.add("RecapAbs.colDureeTot", "Durée Totale");
GTraductions.add("RecapAbs.colTotDemi", "Total ½ journées");
GTraductions.add("RecapAbs.colOui", "Oui");
GTraductions.add("RecapAbs.colNon", "Non");
GTraductions.add("RecapAbs.colRepas", "Absences Repas");
GTraductions.add("RecapAbs.colInternat", "Absences Internat");
GTraductions.add("RecapAbs.colRetard", "Retards");
GTraductions.add("RecapAbs.colInfirmerie", "Infirmerie");
GTraductions.add("RecapPunition.colPunition", "Punitions");
GTraductions.add("RecapPunition.colSanction", "Sanctions");
GTraductions.add("RecapPunition.filles", "Filles");
GTraductions.add("RecapPunition.garcons", "Garçons");
GTraductions.add("RecapAbs.gpeColAbsJust", "Justifiées");
GTraductions.add("RecapAbs.gpeColAbsJustDJ", "½ journées justifiées");
GTraductions.add("RecapAbs.gpeColAbsHorsEtab", "Hors étab");
GTraductions.add("RecapAbs.gpeColAbsSante", "Santé");
GTraductions.add("RecapAbs.gpeColAbs", "Absences");
GTraductions.add("RecapAbs.criteresCommuns", "Critères de sélection communs");
GTraductions.add("RecapAbs.criteres", "Critères de sélection");
GTraductions.add("RecapAbs.uniquNonRA", "Uniquement les évènements non réglés adminitrativement");
GTraductions.add("RecapAbs.uniquJeunes", "Uniquement les élèves dont l'âge est inférieur à");
GTraductions.add("RecapAbs.titreAbs", "Absences");
GTraductions.add("RecapAbs.titreRetard", "Retards");
GTraductions.add("RecapAbs.uniquAbsSup", "Uniquement les absences supérieures à");
GTraductions.add("RecapAbs.uniquAbsTotSup", "Uniquement les élèves dont la durée totale des absences est supérieure à");
GTraductions.add("RecapAbs.uniquAbsInjust", "Uniquement les absences non justifiées");
GTraductions.add("RecapAbs.uniquRetardInjust", "Uniquement les retards non justifiées");
GTraductions.add("RecapAbs.absRepas", "Absences aux repas");
GTraductions.add("RecapAbs.absInternat", "Absences à l'internat");
GTraductions.add("RecapAbs.infirmerie", "Passages à l'infirmerie");
GTraductions.add("RecapAbs.uniquRetardSup", "Uniquement les retards de durée supérieure à");
GTraductions.add("RecapPunition.motifsPunitionSanction", "Motifs punition/sanction");
GTraductions.add("RecapPunition.motifsPunition", "Motifs punition");
GTraductions.add("RecapPunition.motifsSanction", "Motifs sanction");
GTraductions.add("RecapAbs.motifsAbsence", "Motifs d'absence");
GTraductions.add("RecapAbs.selectionMotifsAbsence", "Sélection des motifs d'absence");
GTraductions.add("RecapAbs.motifsRetard", "Motifs de retard");
GTraductions.add("RecapAbs.selectionMotifsRetard", "Sélection des motifs de retard");
GTraductions.add("RecapAbs.motifsInfirmerie", "Types d'intervention");
GTraductions.add("RecapAbs.selectionMotifsInfirmerie", "Sélection des types d'intervention");
GTraductions.add("RecapAbs.HeureCours", "heures de cours");
GTraductions.add("RecapAbs.DJBrute", "demi-journées brutes");
GTraductions.add("RecapAbs.DJCalcule", "demi-journées calculées");
GTraductions.add("RecapAbs.DJBulletin", "demi-journées bulletin");
GTraductions.add("RecapAbs.NbClasses", "%d classes");
GTraductions.add("RecapAbs.NbEleves", "%d élèves");
GTraductions.add("AbsenceVS.HeureDepart", "Heure départ");
GTraductions.add("AbsenceVS.HeureRetour", "Heure retour");
GTraductions.add("AbsenceVS.xAbsence", "%d absence");
GTraductions.add("AbsenceVS.coursManqueDepuis", "%d cours manqué depuis le %s");
GTraductions.add("AbsenceVS.DJBruteDepuis", "%d ½ journée brute depuis le %s");
GTraductions.add("AbsenceVS.DJCalculeeDepuis", "%d ½ journée calculée depuis le %s");
GTraductions.add("AbsenceVS.DJBullDepuis", "%d ½ journée bulletin depuis le %s");
GTraductions.add("AbsenceVS.absRepasDepuis", "%d absence repas depuis le %s");
GTraductions.add("AbsenceVS.absInternatDepuis", "%d absence à l'internat depuis le %s");
GTraductions.add("AbsenceVS.retardDepuis", "%d retard depuis le %s");
GTraductions.add("AbsenceVS.passInfDepuis", "%d passage à l'infirmerie depuis le %s");
GTraductions.add("AbsenceVS.xAbsences", "%d absences");
GTraductions.add("AbsenceVS.coursManquesDepuis", "%d cours manqués depuis le %s");
GTraductions.add("AbsenceVS.DJBrutesDepuis", "%d ½ journées brutes depuis le %s");
GTraductions.add("AbsenceVS.DJCalculeesDepuis", "%d ½ journées calculées depuis le %s");
GTraductions.add("AbsenceVS.DJBulletinsDepuis", "%d ½ journées bulletins depuis le %s");
GTraductions.add("AbsenceVS.absencesRepasDepuis", "%d absences repas depuis le %s");
GTraductions.add("AbsenceVS.absencesInternatDepuis", "%d absences à l'internat depuis le %s");
GTraductions.add("AbsenceVS.retardsDepuis", "%d retards depuis le %s");
GTraductions.add("AbsenceVS.passagesInfDepuis", "%d passages à l'infirmerie depuis le %s");
GTraductions.add("AbsenceVS.obsDepuis", "%d observation (%s) depuis le %s");
GTraductions.add("AbsenceVS.obssDepuis", "%d observations (%s) depuis le %s");
GTraductions.add("AbsenceVS.sanctionDepuis", "%d sanction (%s) depuis le %s");
GTraductions.add("AbsenceVS.sanctionsDepuis", "%d sanctions (%s) depuis le %s");
GTraductions.add("AbsenceVS.defautCarnetDepuis", "Défauts de carnet de %s depuis le %s");
GTraductions.add("SaisieCours.SalleNonReservable", "%s n'est pas une salle réservable");
GTraductions.add("SaisieCours.SallesNonReservables", "%s ne sont pas des salles réservables");
GTraductions.add("SaisieCours.SalleDisponibles", "Salles disponibles");
GTraductions.add("SaisieCours.ProfDisponibles", "Professeurs disponibles");
GTraductions.add("SaisieCours.SupprimerCours", "Supprimer le cours");
GTraductions.add("SaisieCours.AnnulerModificationCours", "Annuler les modifications");
GTraductions.add("SaisieCours.ConfirmerSuppressionRessource", "Voulez-vous confirmer la suppression de %s ?");
GTraductions.add("SaisieCours.ConfirmerSuppressionCours", "Voulez-vous confirmer la suppression du cours ?");
GTraductions.add("SaisieCours.ConfirmerAnnulationModificationCours", "Voulez-vous confirmer l'annulation des modifications du cours ?");
GTraductions.add("SaisieCours.ConfirmerDeplacementCours", "Voulez-vous confirmer le déplacement du cours ?");
GTraductions.add("SaisieCours.Gabarit.DblClickPlacerCours", "Faites un double clic pour placer la cours à la place désignée par le cadre vert");
GTraductions.add("SaisieCours.UniqementLesSallesReservables", "Uniquement les salles réservables");
GTraductions.add("SaisieCours.SemaineCoursADeplacerNonModifiable", "La semaine du cours à déplacer n'est pas modifiable");
GTraductions.add("SaisieCours.MessageCDTSurCours", "Attention, le cahier de textes saisi sur le cours ne sera plus affecté.");
GTraductions.add("SaisieCours.AjouterSalle", "Réserver une salle");
GTraductions.add("SaisieCours.RemplacerSalle", "Remplacer la salle");
GTraductions.add("SaisieCours.SupprimerSalle", "Supprimer la salle");
GTraductions.add("SaisieCours.AnnulerModification", "Annuler les modifications");
GTraductions.add("ChoixEleveGAEV.nouveau", "Modifier les élèves");
GTraductions.add("ChoixEleveGAEV.AffecterLesEleves", "Affecter les élèves d'une autre semaine...");
GTraductions.add("SaisieMotDePasse.ReussiteModification", "Votre modification a bien été prise en compte");
GTraductions.add("SaisieMotDePasse.EchecModification", "Echec de la modification");
GTraductions.add("SaisieMotDePasse.validation.titre", "Le mot de passe doit");
GTraductions.add("SaisieMotDePasse.validation.longueur", "contenir entre %s et %s caractères");
GTraductions.add("SaisieMotDePasse.validation.chiffre", "contenir au moins un caractère numérique");
GTraductions.add("SaisieMotDePasse.validation.lettre", "contenir au moins une lettre");
GTraductions.add("SaisieMotDePasse.validation.special", "contenir au moins un caractère spécial \n(ni lettre, ni chiffre)");
GTraductions.add("SaisieMotDePasse.validation.MajMin", "mélanger des minuscules et des majuscules");
GTraductions.add("SaisieMotDePasse.validation.login", "être différent du nom et de l'identifiant");
GTraductions.add("SaisieMotDePasse.validation.ErreurMotDePasseActuel", "Le mot de passe actuel est incorrect");
GTraductions.add("Casier.Colonne.NomDocument", "Nom du document");
GTraductions.add("Casier.Colonne.Memo", "Mémo");
GTraductions.add("Casier.Colonne.Personnel", "Personnels");
GTraductions.add("Casier.Colonne.Professeur", "Professeurs");
GTraductions.add("Casier.Colonne.MaitreDeStage", "Maître de st.");
GTraductions.add("Casier.Colonne.Depo", "Déposé par");
GTraductions.add("Casier.Colonne.Date", "Date");
GTraductions.add("Casier.Colonne.Destinataire", "Destinataires");
GTraductions.add("Casier.Cmd.Maj", "Mettre à jour");
GTraductions.add("Casier.Cmd.Telecharger", "Télécharger");
GTraductions.add("Casier.Msg.InfoSaisieRestreinte", "Seule la suppression des documents est autorisée");
GTraductions.add("Casier.LigneCreation", "Déposer un document");
GTraductions.add("Casier.HintDocSupprime", "Ce destinataire a supprimé le document de son casier numérique.");
GTraductions.add("Casier.FiltreNonLus", "Uniquement les non lus");
GTraductions.add("Casier.msgCasierVide", "Aucun document dans le casier");
GTraductions.add("Casier.msgConfirmSupprDest", "Confirmez-vous la suppression du document %s de votre casier ?");
GTraductions.add("Casier.msgConfirmSupprDepositaire", "Confirmez-vous la suppression du document %s ?");
GTraductions.add("Casier.hintAucunMdS", "Aucun maître de stage n'est présent dans la base");
GTraductions.add("Casier.hintAucunPerso", "Aucun personnel n'est présent dans la base");
GTraductions.add("Casier.hintAucunProf", "Aucun professeur n'est présent dans la base");
GTraductions.add("Messagerie.TitreFenetre", "Nouvelle discussion");
GTraductions.add("Messagerie.ObjetMsg", "Objet");
GTraductions.add("Messagerie.BtnEnvoyer", "Envoyer");
GTraductions.add("Messagerie.DestinatairesMsg", "À");
GTraductions.add("Messagerie.Personnels", "Personnels");
GTraductions.add("Messagerie.Profs", "Professeurs");
GTraductions.add("Messagerie.Parents", "Responsables");
GTraductions.add("Messagerie.Eleves", "Élèves");
GTraductions.add("Messagerie.Resp1Legal", "1er responsable légal");
GTraductions.add("Messagerie.Resp2Legal", "2nd responsable légal");
GTraductions.add("Messagerie.EquipePeda", "Équipe pédagogique");
GTraductions.add("Messagerie.MsgAucuneSelection", "Veuillez sélectionner un destinataire");
GTraductions.add("Messagerie.HintPJ", "Ajouter une nouvelle pièce jointe");
GTraductions.add("Messagerie.Titre.Date", "Date");
GTraductions.add("Messagerie.Titre.Participants", "Participants");
GTraductions.add("Messagerie.MesDiscussions", "Discussions");
GTraductions.add("Messagerie.AucuneDiscussion", "Aucune Discussion");
GTraductions.add("Messagerie.CommParentEleveInactif", "Vous n'avez pas activé la messagerie avec les responsables et les élèves");
GTraductions.add("Messagerie.CommParentInactif", "Vous n'avez pas activé la messagerie avec les responsables");
GTraductions.add("Messagerie.CommEleveInactif", "Vous n'avez pas activé la messagerie avec les élèves");
GTraductions.add("Messagerie.MsgAucunDestinataire", "Veuillez sélectionner un destinataire");
GTraductions.add("Messagerie.MsgAucunContenu", "Veuillez saisir un contenu");
GTraductions.add("Messagerie.RedigezMessage", "Rédigez votre message");
GTraductions.add("Messagerie.ListeDestinataires", "Liste des destinataires");
GTraductions.add("Messagerie.Info.FiltrerMessages", "Filtrer les messages");
GTraductions.add("Messagerie.Info.TousMessages", "Afficher tous les messages des discussions");
GTraductions.add("Messagerie.DiscussionAvec", "Discussions avec %s");
GTraductions.add("Messagerie.AucuneDiscussionAvec", "Il n'y a aucune discussion avec %s");
GTraductions.add("Messagerie.AucuneDiscussionSelectionnee", "Aucune discussion n'est sélectionnée");
GTraductions.add("Messagerie.DestinatairesNonAutorises", "Pas de réponse possible : vous avez choisi de ne plus autoriser les discussions avec ces participants");
GTraductions.add("Messagerie.NonAutorisePourDestinataires", "Pas de réponse possible : Les destinataires n'ont pas autorisé les discussions");
GTraductions.add("Messagerie.UnDestinataire", "1 destinataire");
GTraductions.add("Messagerie.NParticipants", "%d participants");
GTraductions.add("Messagerie.NDestinataires", "%d destinataires");
GTraductions.add("Messagerie.LigneNouvelleDiscussion", "Démarrer une nouvelle discussion");
GTraductions.add("Messagerie.AucunProfesseur", "Aucun professeur n'a activé les discussions ou son email");
GTraductions.add("Messagerie.AucunProfesseurPourEleve", "Aucun professeur n'a activé les discussions");
GTraductions.add("Messagerie.AucunPersonnel", "Aucun personnel n'a activé les discussions ou son email");
GTraductions.add("Messagerie.AucunPersonnelPourEleve", "Aucun personnel n'a activé les discussions");
GTraductions.add("Messagerie.ConfirmationSuppression", "Les messages sélectionnés vont être supprimés définitivement");
GTraductions.add("Messagerie.Menu.Lu", "Marquer comme lu");
GTraductions.add("Messagerie.Menu.NonLu", "Marquer comme non lu");
GTraductions.add("Messagerie.Menu.Supprimer", "Supprimer la discussion");
GTraductions.add("Messagerie.InactiveParentsEleves", "Vous n'avez pas activé la messagerie avec les responsables et les élèves");
GTraductions.add("Messagerie.InactiveParents", "Vous n'avez pas activé la messagerie avec les responsables");
GTraductions.add("Messagerie.ContacterVS", "Contacter la vie scolaire");
GTraductions.add("Messagerie.AucunPersonnelConnecte", "Aucun personnel de vie scolaire n'est connecté actuellement");
GTraductions.add("Messagerie.EnvoyerA", "Envoyer à %s");
GTraductions.add("Messagerie.EnvoyerATous", "Envoyer à tous");
GTraductions.add("Messagerie.Destinataires", "Destinataires");
GTraductions.add("Messagerie.Brouillon", "Brouillon");
GTraductions.add("Messagerie.NBrouillons", "%d brouillons");
GTraductions.add("Messagerie.UnBrouillon", "1 brouillon");
GTraductions.add("Messagerie.HintEnregistrerBrouillon", "Enregistrer le brouillon");
GTraductions.add("Messagerie.HintSupprimerBrouillon", "Supprimer le brouillon");
GTraductions.add("Messagerie.Archiver", "Archiver");
GTraductions.add("Messagerie.Desarchiver", "Désarchiver");
GTraductions.add("Messagerie.HintAjouterDest", "Ajouter des participants à la discussion");
GTraductions.add("Messagerie.TousLesProfesseursDejaDestinataires", "Tous les professeurs de l'établissement sont déjà destinataires du message");
GTraductions.add("Messagerie.TousLesPersonnelsDejaDestinataires", "Tous les personnels de l'établissement sont déjà destinataires du message");
GTraductions.add("Messagerie.HintDiscussionArchive", "La discussion est placée dans les archives, elle ne sera pas concernée par la suppression automatique ");
GTraductions.add("Messagerie.ConfirmationEnregistrerBrouillon", "Ce message n'est pas sauvegardé, voulez-vous enregistrer le brouillon ?\nVotre discussion sera placée dans vos brouillons.");
GTraductions.add("Messagerie.BrouillonDiscussion", "Brouillon d'une nouvelle discussion");
GTraductions.add("Messagerie.BrouillonDiscussionTransfert", "Brouillon d'une nouvelle discussion (transfert)");
GTraductions.add("Messagerie.MenuVisu_Repondre", "Répondre au message sélectionné");
GTraductions.add("Messagerie.MenuVisu_AfficherDiscussion", "Afficher la discussion du message sélectionné");
GTraductions.add("Messagerie.MenuVisu_ReprendreBrouillon", "Reprendre le brouillon");
GTraductions.add("Messagerie.MenuVisu_SupprimerBrouillon", "Supprimer le brouillon");
GTraductions.add("Messagerie.AbreviationTransfert", "TR");
GTraductions.add("Messagerie.TransfererLeMessage", "Transférer le message");
GTraductions.add("Messagerie.TransfererLesMessages", "Transférer les messages");
GTraductions.add("Messagerie.1Messagetransfere", "1 message transféré");
GTraductions.add("Messagerie.NMessagestransferes", "%d messages transférés");
GTraductions.add("Messagerie.Menu_TransfererLeMessage", "Transférer le message");
GTraductions.add("Messagerie.Menu_TransfererLaDiscussion", "Transférer la discussion");
GTraductions.add("Messagerie.MFicheDiscussion", '{"titre":"Comment répondre à un message d\'une discussion ?","html":{"_T":23,"V":"<p><span style=\\\"font-size: 12px; font-family: arial,helvetica,sans-serif;\\\">Pour r&eacute;pondre &agrave; une discussion, s&eacute;lectionnez une discussion et renseignez votre r&eacute;ponse &agrave; droite.</span></p><p><span style=\\\"font-size: 12px; font-family: arial,helvetica,sans-serif;\\\">Pour ne r&eacute;pondre qu\'&agrave; une personne de la discussion, pensez &agrave; d&eacute;ployer la discussion, s&eacute;lectionnez la ligne (le message ou la sous-discussion) et renseignez votre r&eacute;ponse &agrave; droite.</span></p>"},"width":430,"height":240,"type":4,"boutons":{"_T":18,"V":1024}}');
GTraductions.add("RessourcePedagogique.DocJoint", "Documents joints");
GTraductions.add("RessourcePedagogique.SitesWeb", "Sites Web");
GTraductions.add("RessourcePedagogique.IDevoirs", "QCM");
GTraductions.add("RessourcePedagogique.Corriges", "Corrigés");
GTraductions.add("RessourcePedagogique.Kiosque", "Manuels numériques");
GTraductions.add("RessourcePedagogique.Cloud", "Documents de mon Cloud");
GTraductions.add("RessourcePedagogique.DocJoint_S", "Document joint");
GTraductions.add("RessourcePedagogique.SitesWeb_S", "Site Web");
GTraductions.add("RessourcePedagogique.IDevoirs_S", "QCM");
GTraductions.add("RessourcePedagogique.Corriges_S", "Corrigé");
GTraductions.add("RessourcePedagogique.Kiosque_S", "Manuel numérique");
GTraductions.add("RessourcePedagogique.colonne.document", "Document");
GTraductions.add("RessourcePedagogique.colonne.deposeLe", "Déposé le");
GTraductions.add("RessourcePedagogique.colonne.commentaire", "Commentaire");
GTraductions.add("RessourcePedagogique.colonne.public", "Public");
GTraductions.add("RessourcePedagogique.Toutes", "Toutes");
GTraductions.add("RessourcePedagogique.Retour", "Retour");
GTraductions.add("RessourcePedagogique.AucuneRessourcePeda", "Aucune ressource pédagogique n'est disponible pour le moment");
GTraductions.add("RessourcePedagogique.AucuneRessourcePedaPourPeriode", "Aucune ressource pédagogique n'est disponible pour la période sélectionnée");
GTraductions.add("SuiviPluriannuel.MoyClasse", "Moy. classe");
GTraductions.add("SuiviPluriannuel.MoyenneGenerale", "Moyenne générale");
GTraductions.add("SuiviPluriannuel.Graphique", "Graphique");
GTraductions.add("PiedDeConseilDeClasse.1ereDemande", "1ère demande");
GTraductions.add("PiedDeConseilDeClasse.Favorable_Abbr", "Fav");
GTraductions.add("PiedDeConseilDeClasse.Favorable", "Favorable");
GTraductions.add("PiedDeConseilDeClasse.Reserve_Abbr", "Rés");
GTraductions.add("PiedDeConseilDeClasse.Reserve", "Réservé");
GTraductions.add("PiedDeConseilDeClasse.Defavorable_Abbr", "Déf");
GTraductions.add("PiedDeConseilDeClasse.Defavorable", "Défavorable");
GTraductions.add("PiedDeConseilDeClasse.TresFavorable_Abbr", "T. fav");
GTraductions.add("PiedDeConseilDeClasse.TresFavorable", "Très favorable");
GTraductions.add("PiedDeConseilDeClasse.Mentions", "Mentions");
GTraductions.add("PiedDeBulletin.VieScolaire", "Vie scolaire");
GTraductions.add("PiedDeBulletin.AppConseilDeClasse", "Appréciations du conseil de classe");
GTraductions.add("PiedDeBulletin.Commentaires", "Commentaires");
GTraductions.add("PiedDeBulletin.Orientations", "Orientations");
GTraductions.add("PiedDeBulletin.Attestations", "Attestations");
GTraductions.add("PiedDeBulletin.Compétences", "Compétences");
GTraductions.add("ParametresUtilisateur.cahierDeTextes", "Cahier de textes");
GTraductions.add("ParametresUtilisateur.CouleursDesCours", "Couleurs des cours");
GTraductions.add("ParametresUtilisateur.TipCouleursDesCours", "Ce paramétrage s'applique à tous les emplois du temps des professeurs.");
GTraductions.add("ParametresUtilisateur.LabelCouleur", "En fonction de :");
GTraductions.add("ParametresUtilisateur.CouleurMatieres", "Matières");
GTraductions.add("ParametresUtilisateur.CouleurClasses", "Classes");
GTraductions.add("ParametresUtilisateur.NavigationCoursCDT", "Définition du cours précédent / cours suivant");
GTraductions.add("ParametresUtilisateur.CoursMatiereIdentique", "Cours de même matière");
GTraductions.add("ParametresUtilisateur.CoursRessourceIdentique", "Cours de même ressource (classe, groupe)");
GTraductions.add("ParametresUtilisateur.CoursRessourceCommune", "Cours ayant une ressource en commun (classe, groupe)");
GTraductions.add("ParametresUtilisateur.CoursEleveCommun", "Cours ayant au moins un élève en commun");
GTraductions.add("ParametresUtilisateur.PageAccueil", "Page d'accueil");
GTraductions.add("ParametresUtilisateur.AfficherAccueilDemarrage", "Afficher la page d'accueil au démarrage");
GTraductions.add("ParametresUtilisateur.Theme", "Choix du thème :");
GTraductions.add("ParametresUtilisateur.ModeAccessible", "Mode accessible");
GTraductions.add("ParametresUtilisateur.Notification", "Notification");
GTraductions.add("ParametresUtilisateur.UtiliserNotification", "Faire apparaître une notification lors de la réception d'un message");
GTraductions.add("theme.Personnalise", "Personnalisé");
GTraductions.add("theme.Accessible", "Accessible");
GTraductions.add("theme.Gris", "Taupe");
GTraductions.add("theme.Tomette", "Citrouille");
GTraductions.add("theme.Olive", "Chocolat");
GTraductions.add("theme.Iris", "Bleu");
GTraductions.add("theme.Menthe", "Emeraude");
GTraductions.add("theme.Caramel", "Mandarine");
GTraductions.add("theme.Givre", "Bleu océan");
GTraductions.add("theme.Violette", "Lavande");
GTraductions.add("theme.Chocolat", "Chocolat");
GTraductions.add("theme.Noisette", "Chocolat");
GTraductions.add("theme.Amande", "Chocolat");
GTraductions.add("theme.Bonbon", "Framboise");
GTraductions.add("theme.Mauve", "Prune");
GTraductions.add("theme.Bleuet", "Prune");
GTraductions.add("theme.Mandarine", "Mandarine");
GTraductions.add("theme.Prairie", "Feuille");
GTraductions.add("theme.Fraise", "Fraise");
GTraductions.add("theme.Chamois", "Chocolat");
GTraductions.add("theme.Ardoise", "Taupe");
GTraductions.add("theme.Banquise", "Bleu océan");
GTraductions.add("theme.Azur", "Bleu");
;
var EGenreAnnotation={erreur:-1,note:0,absent:1,dispense:2,nonNote:3,inapte:4,nonRendu:5,absentZero:6,nonRenduZero:7};function TypeNote(aParametre,N){this.note='0.00';this.masque=null;this.valeur=0.00;this.genre=EGenreAnnotation.note;var lType=typeof(aParametre);if(lType==='string'){this.valeur=this.noteToValeur(aParametre);var lEstUneAnnotation=isNaN(this.valeur);this.genre=lEstUneAnnotation?this.getGenreNote(aParametre):EGenreAnnotation.note;this.note=lEstUneAnnotation?this.getChaineAnnotationDeGenre(this.genre):this.valeurToNote(this.valeur,N);this.chaine=aParametre;} else if(lType==='number'){this.note=this.valeurToNote(aParametre,N);this.valeur=aParametre;this.genre=EGenreAnnotation.note;this.chaine='';}}(function(){var lTableauNotations=null;function _getTableauNotations(){if(!lTableauNotations)
lTableauNotations=['',GTraductions.getValeur('TypeNote.Annotation.Absent'),GTraductions.getValeur('TypeNote.Annotation.Dispense'),GTraductions.getValeur('TypeNote.Annotation.NonNote'),GTraductions.getValeur('TypeNote.Annotation.Inapte'),GTraductions.getValeur('TypeNote.Annotation.NonRendu'),GTraductions.getValeur('TypeNote.Annotation.Absent')+'*',GTraductions.getValeur('TypeNote.Annotation.NonRendu')+'*'
];return lTableauNotations;}
TypeNote.baremeNotation=null;TypeNote.prototype.getCaractereAnnotation=function(agenreNote){var lCaractereAnnotation={};for(var x in agenreNote){switch(agenreNote[x]){case(EGenreAnnotation.absent):lCaractereAnnotation.Absent=GTraductions.getValeur('TypeNote.CaractereAnnotation.Absent');break;case(EGenreAnnotation.dispense):lCaractereAnnotation.Dispense=GTraductions.getValeur('TypeNote.CaractereAnnotation.Dispense');break;case(EGenreAnnotation.nonNote):lCaractereAnnotation.NonNote=GTraductions.getValeur('TypeNote.CaractereAnnotation.NonNote');break;case(EGenreAnnotation.inapte):lCaractereAnnotation.Inapte=GTraductions.getValeur('TypeNote.CaractereAnnotation.Inapte');break;case(EGenreAnnotation.nonRendu):lCaractereAnnotation.NonRendu=GTraductions.getValeur('TypeNote.CaractereAnnotation.NonRendu');break;case(EGenreAnnotation.absentZero):lCaractereAnnotation.AbsentZero=GTraductions.getValeur('TypeNote.CaractereAnnotation.AbsentZero');break;case(EGenreAnnotation.nonRenduZero):lCaractereAnnotation.NonRenduZero=GTraductions.getValeur('TypeNote.CaractereAnnotation.NonRenduZero');break;}}
return lCaractereAnnotation;};TypeNote.prototype.getGenreNote=function(aChaine){if(aChaine.split('|').length===2)
return parseInt(aChaine.split('|')[1]);var lTabNotations=_getTableauNotations();for(var I in lTabNotations)
if(lTabNotations[I].toLowerCase()===aChaine.toLowerCase()){return parseInt(I);}
return EGenreAnnotation.note;};TypeNote.prototype.getNote=function(){return this.masque?this.masque.note+'*':this.note;};TypeNote.prototype.getValeur=function(){return this.valeur;};TypeNote.prototype.getGenre=function(){return this.genre;};TypeNote.prototype.estUneValeur=function(){return!isNaN(this.valeur);};TypeNote.prototype.toString=function(){return this.genre===EGenreAnnotation.note?this.note:'|'+this.genre;};TypeNote.prototype.toJSON=function(){var lJSON={};lJSON[IE.ObjetJSON.const_champ_Type]=EGenreType.Note;lJSON[IE.ObjetJSON.const_champ_Valeur]=this.genre===EGenreAnnotation.note?this.note:'|'+this.genre;return lJSON;};TypeNote.prototype.setNoteAffichee=function(aNoteAffichee){this.noteAffichee=aNoteAffichee;};TypeNote.prototype.setMasque=function(aMasque){this.masque=aMasque;};TypeNote.prototype.noteToValeur=function(aNote){return parseFloat(aNote.replace(',','.'));};TypeNote.prototype.valeurToNote=function(aValeur,N){if(isNaN(aValeur))
return'';N=N===null||N===undefined?2:N;return(''+(parseFloat(aValeur).toFixed(N))).replace('.',',');};TypeNote.prototype.estUneNoteVide=function(){return(this.chaine==='');};TypeNote.prototype.estUneNoteValide=function(aNoteMin,aNoteMax,aAvecNotationSpecifique,aAvecVide){if(this.estUneNoteVide())
return aAvecVide===true;var lTabNotations=_getTableauNotations();if(aAvecNotationSpecifique)
for(var I in lTabNotations)
if((lTabNotations[I]===this.chaine)||(lTabNotations[I]+'*'===this.chaine))
return true;var lChaine=this.chaine.replace(/\./g,',');if(lChaine.indexOf(',')=== -1) lChaine+=',';var lPosVirgule=lChaine.indexOf(',');var lNbrVirgule=lChaine.split(',').length-1;var lPosMoins=lChaine.indexOf('-');var lPosVirguleMax=Math.max((''+(parseInt(aNoteMin))).length,(''+(parseInt(aNoteMax))).length);return(lPosMoins<=0)&&(lPosVirgule<=lPosVirguleMax)&&(lChaine.length-(lPosVirgule+1)<=2)&&(lNbrVirgule<=1)&&(this.valeur>=aNoteMin.getValeur())&&(this.valeur<=aNoteMax.getValeur());};TypeNote.prototype.getBaremeEntier=function(){return'/'+this.getNote().enleverZero();};TypeNote.prototype.getCoefficientEntier=function(){return this.getNote().enleverZero();};TypeNote.prototype.estBaremeParDefaut=function(){return TypeNote.baremeNotation?this.getValeur()===TypeNote.baremeNotation.getValeur():false;};TypeNote.prototype.estCoefficientParDefaut=function(){return this.getNote()==='1,00';};TypeNote.prototype.getChaineAnnotationDeCaractere=function(aCaractere){switch(aCaractere.toLowerCase()){case(GTraductions.getValeur('TypeNote.CaractereAnnotation.Absent')):return _getTableauNotations()[EGenreAnnotation.absent];case(GTraductions.getValeur('TypeNote.CaractereAnnotation.Dispense')):return _getTableauNotations()[EGenreAnnotation.dispense];case(GTraductions.getValeur('TypeNote.CaractereAnnotation.NonNote')):return _getTableauNotations()[EGenreAnnotation.nonNote];case(GTraductions.getValeur('TypeNote.CaractereAnnotation.Inapte')):return _getTableauNotations()[EGenreAnnotation.inapte];case(GTraductions.getValeur('TypeNote.CaractereAnnotation.NonRendu')):return _getTableauNotations()[EGenreAnnotation.nonRendu];case(GTraductions.getValeur('TypeNote.CaractereAnnotation.AbsentZero')):return _getTableauNotations()[EGenreAnnotation.absentZero];case(GTraductions.getValeur('TypeNote.CaractereAnnotation.NonRenduZero')):return _getTableauNotations()[EGenreAnnotation.nonRenduZero];}};TypeNote.prototype.getChaineAnnotationDeGenre=function(aGenre){return _getTableauNotations()[aGenre];};TypeNote.prototype.dupliquer=function(){var lNote=new TypeNote();lNote.note=this.note ;lNote.masque=this.masque;lNote.valeur=this.valeur ;lNote.genre=this.genre;lNote.chaine=this.chaine;lNote.noteAffichee=this.noteAffichee;return lNote;};})();;
function TypeEnsembleNombre(){this.clear();}(function(){TypeEnsembleNombre.prototype.clear=function(){this._hash={};return this;};TypeEnsembleNombre.prototype.add=function(aValeur){var lProp,lNombre;if(IE.MethodesObjet.isNumber(aValeur)){this._hash[aValeur]=true;}
else if(aValeur instanceof TypeEnsembleNombre){for(lProp in aValeur._hash){this._hash[lProp]=true;}}
else if(IE.MethodesObjet.isArray(aValeur)){for(lProp in aValeur){lNombre=aValeur[lProp];if(IE.MethodesObjet.isNumber(lNombre)){this._hash[lNombre]=true;}}}
return this;};TypeEnsembleNombre.prototype.remove=function(aValeur){var lProp,lNombre;if(IE.MethodesObjet.isNumber(aValeur)){delete this._hash[aValeur];}
else if(aValeur instanceof TypeEnsembleNombre){for(lProp in aValeur._hash){delete this._hash[lProp];}}
else if(IE.MethodesObjet.isArray(aValeur)){for(lProp in aValeur){lNombre=aValeur[lProp];if(IE.MethodesObjet.isNumber(lNombre)){delete this._hash[lNombre];}}}
return this;};TypeEnsembleNombre.prototype.contains=function(aValeur){var lProp,lResult;if(IE.MethodesObjet.isNumber(aValeur)){return this._hash[aValeur]!==undefined;}
if(aValeur instanceof TypeEnsembleNombre){lResult=false;for(lProp in aValeur._hash){if(!this._hash[lProp]){return false;}
lResult=true;}
return lResult;}
if(IE.MethodesObjet.isArray(aValeur)){if(aValeur.length===0){return false;}
for(lProp in aValeur){if(!this._hash[aValeur[lProp]]){return false;}}
return true;}
return false;};TypeEnsembleNombre.prototype.intersect=function(aValeur){var lProp,lNombre,lHash={};if(aValeur instanceof TypeEnsembleNombre){for(lProp in aValeur._hash){if(this._hash[lProp]){lHash[lProp]=true;}}
this._hash=lHash;}
else if(IE.MethodesObjet.isArray(aValeur)){for(lProp in aValeur){lNombre=aValeur[lProp];if(this._hash[lNombre]){lHash[lNombre]=true;}}
this._hash=lHash;}
else{;}
return this;};TypeEnsembleNombre.prototype.get=function(aIndex){var lItems=this.items();if(aIndex<0||aIndex>lItems.length){return null;}
return lItems[aIndex];};TypeEnsembleNombre.prototype.items=function(){var lItems=[],lProp;for(lProp in this._hash){lItems.push(parseInt(lProp,10));}
lItems.sort(_sort);return lItems;};TypeEnsembleNombre.prototype.count=function(){var lResult=0,i;for(i in this._hash){lResult++;}
return lResult;};TypeEnsembleNombre.prototype.each=function(aMethode,thisArg){var lItems=this.items(),i,lNb=lItems.length;for(i=0;i<lNb;i++){aMethode.call(thisArg,lItems[i]);}};TypeEnsembleNombre.prototype.dupliquer=function(){var lEnsemble=new TypeEnsembleNombre(),i;for(i in this._hash){lEnsemble._hash[i]=true;}
return lEnsemble;};TypeEnsembleNombre.prototype.toString=function(){var lResult='',lIx,lNbDeSuite=0,lValeur,lItems=this.items();for(lIx=1;lIx<=lItems.length;lIx++){lValeur=lItems[lIx];if((lItems.length>lIx)&&(lValeur===lItems[lIx-1]+1)){lNbDeSuite++;}
else{if(lResult.length>0){lResult+=',';}
if(lNbDeSuite>0){lResult+=lItems[lIx-1-lNbDeSuite]+'..';}
lResult+=lItems[lIx-1];lNbDeSuite=0;}}
return'['+lResult+']';};TypeEnsembleNombre.prototype.fromString=function(aChaine){if(!aChaine||!aChaine.length||aChaine.length<2){return this;}
aChaine=aChaine.substring(1,aChaine.length-1);var T1=aChaine.split(','),I,J,T2,V1,V2;for(I=0;I<T1.length;I++){T2=T1[I].split('..');V1=parseInt(T2[0],10);V2=parseInt(T2.length===1?V1:T2[1],10);for(J=V1;J<=V2;J++){this._hash[J]=true;}}
return this;};TypeEnsembleNombre.prototype.toJSON=function(){var lJSON={};lJSON[IE.ObjetJSON.const_champ_Type]=EGenreType.EnsembleNombre;lJSON[IE.ObjetJSON.const_champ_Valeur]=this.toString();return lJSON;};function _sort(a,b){return a<b?-1:a>b?1:0;}}());;
var EGenreArrondi={sans:0,superieur:1,inferieur:2,plusProche:3};function TypeArrondi(aGenrePronote){this.precision=0;this.genre=EGenreArrondi.sans;this.toType(aGenrePronote);}
TypeArrondi.prototype.getPrecision=function(){return this.precision;};TypeArrondi.prototype.getGenre=function(){return this.genre;};TypeArrondi.prototype.setPrecision=function(aPrecision){this.precision=aPrecision;};TypeArrondi.prototype.setGenre=function(aGenre){this.genre=aGenre ;};TypeArrondi.prototype.arrondir=function(aValeur){aValeur=Math.round(Number(aValeur/0.01).toFixed(2))*0.01;switch(this.genre){case EGenreArrondi.superieur:return Math.ceil(Number(aValeur/this.precision).toFixed(2))*this.precision;case EGenreArrondi.inferieur:return Math.floor(Number(aValeur/this.precision).toFixed(2))*this.precision;case EGenreArrondi.plusProche:return Math.round(Number(aValeur/this.precision).toFixed(2))*this.precision;default:return aValeur;}};TypeArrondi.prototype.toType=function(aGenrePronote){this.precision=[0.01,0.10,0.25,0.50,1,0.10,0.25,0.50,1][aGenrePronote];this.genre=parseInt(aGenrePronote)!==0?parseInt(aGenrePronote)<=4?EGenreArrondi.superieur:EGenreArrondi.plusProche:EGenreArrondi.sans;};TypeArrondi.prototype.toString=function(){switch(this.genre){case EGenreArrondi.sans:return 0;case EGenreArrondi.superieur:switch(this.precision){case 0.10:return 1;case 0.25:return 2;case 0.50:return 3;case 1:return 4;default:;return 0;}
break;case EGenreArrondi.plusProche:switch(this.precision){case 0.10:return 5;case 0.25:return 6;case 0.50:return 7;case 1:return 8;default:;return 0;}
break;default:return 0;}};TypeArrondi.prototype.strPrecision=function(){switch(this.precision){case 0.01:return GTraductions.Arrondi[0];case 0.10:return GTraductions.Arrondi[1];case 0.25:return GTraductions.Arrondi[2];case 0.50:return GTraductions.Arrondi[3];case 1.00:return GTraductions.Arrondi[4];}
return GTraductions.Arrondi[0];};TypeArrondi.prototype.dupliquer=function(){var lArrondi=new TypeArrondi(0);lArrondi.precision=this.precision;lArrondi.genre=this.genre;return lArrondi;};TypeArrondi.prototype.toJSON=function(){var lJSON={};lJSON[IE.ObjetJSON.const_champ_Type]=EGenreType.Arrondi;lJSON[IE.ObjetJSON.const_champ_Valeur]=this.toString();return lJSON;};;
function ObjetCycles(){this.donneesCycles={premiereDate:null,derniereDate:null,dateDebutPremierCycle:null,joursOuvresParCycle:null,premierJourSemaine:2,joursOuvres:null,joursFeries:new TypeEnsembleNombre(),grillesEDTEnCycle:null};this.cache={datePremierJourOuvre:null,cycleEtIndiceParDate:[],datesAfficheesParCycle:[],bornesCycles:[],nombreCyclesAnneeScolaire:null,domaineFerie:null};}(function(){ObjetCycles.C_IndicePremierJourCycle=0;ObjetCycles.C_IndiceDernierJourCycle=Number.MAX_VALUE;ObjetCycles.C_IndiceDernierJourOuvreCycle=Number.MAX_VALUE-1;ObjetCycles.C_MaxDomaineCycle=62;ObjetCycles.recherche={strict:0,autoriserSuivants:1,autoriserPrecedents:2};var C_JoursParAn=52*7,C_JourCycleHorsGrille= -1,C_MaxJoursParSemaine=7,C_NbJoursCaches=C_JoursParAn+21;function _DateEnJourHebdo(ADate,APremierJourSemaine){var LJourTt,LPremierJour;LPremierJour=APremierJourSemaine;if(LPremierJour>C_MaxJoursParSemaine){LPremierJour=LPremierJour-C_MaxJoursParSemaine;}
LJourTt=ADate.getDay()+1;if(LJourTt>=LPremierJour){return LJourTt-LPremierJour;}
return LJourTt+C_MaxJoursParSemaine-LPremierJour;}
function _IncJourHebdo(aJourHebdo){return(aJourHebdo+1)%C_MaxJoursParSemaine;}
function _calculer(){var lDatesAIgnorer=new TypeEnsembleNombre(),lEnSemaine,lJourSemaine,iJour,iCycle,lIndiceCycle,lJourHebdo,LCycle,IDate,LIndiceJourAnnee,LPasToutRempli,lTab,i;if(window.TypeModeGrillesEDT&&this.donneesCycles.grillesEDTEnCycle===TypeModeGrillesEDT.TMG_CycleSansFeries&&this.donneesCycles.joursFeries){lTab=this.donneesCycles.joursFeries.items();for(i in lTab){lDatesAIgnorer.add(GDate.GetJourSuivant(this.donneesCycles.dateDebutPremierCycle,lTab[i]-1).getTime());}}
this.cache.datePremierJourOuvre=this.donneesCycles.premiereDate;lEnSemaine=lDatesAIgnorer.count()===0&&(this.donneesCycles.joursOuvresParCycle%this.donneesCycles.joursOuvres.count()===0);if(lEnSemaine){lJourSemaine=this.cache.datePremierJourOuvre.getDay()+1;while(lJourSemaine!==this.donneesCycles.premierJourSemaine){this.cache.datePremierJourOuvre=GDate.GetJourSuivant(this.cache.datePremierJourOuvre,-1);lJourSemaine=this.cache.datePremierJourOuvre.getDay()+1;}}
for(iJour=0;iJour<=C_NbJoursCaches;iJour++){this.cache.cycleEtIndiceParDate[iJour]={cycle:1,indice:C_JourCycleHorsGrille};}
for(iCycle=0;iCycle<=ObjetCycles.C_MaxDomaineCycle;iCycle+=1){this.cache.datesAfficheesParCycle[iCycle]=[];this.cache.bornesCycles[iCycle]={DateDebut:new Date(0),DateFin:new Date(0)};}
this.cache.bornesCycles[1].DateDebut=this.cache.datePremierJourOuvre;lIndiceCycle= -1;lJourHebdo=_DateEnJourHebdo(this.cache.datePremierJourOuvre,this.donneesCycles.premierJourSemaine)-1;LCycle=0;IDate=GDate.GetJourSuivant(this.cache.datePremierJourOuvre,-1);this.cache.nombreCyclesAnneeScolaire=0;LIndiceJourAnnee=0;LPasToutRempli=true;while(LPasToutRempli){IDate=GDate.GetJourSuivant(IDate,1);lJourHebdo=_IncJourHebdo(lJourHebdo);if(lDatesAIgnorer.contains(IDate.getTime())||((!lEnSemaine)&&(IDate.getTime()<this.donneesCycles.premiereDate.getTime()))||!(this.donneesCycles.joursOuvres.contains(lJourHebdo))){if(LIndiceJourAnnee<=C_NbJoursCaches){this.cache.cycleEtIndiceParDate[LIndiceJourAnnee]={cycle:Math.max(1,LCycle),indice:C_JourCycleHorsGrille};}}
else{lIndiceCycle=(lIndiceCycle+1)%this.donneesCycles.joursOuvresParCycle;if(lIndiceCycle===0){LCycle+=1;}
if(LIndiceJourAnnee<=C_NbJoursCaches){this.cache.cycleEtIndiceParDate[LIndiceJourAnnee]={cycle:LCycle,indice:lIndiceCycle};}
if(LCycle<=ObjetCycles.C_MaxDomaineCycle){this.cache.datesAfficheesParCycle[LCycle][lIndiceCycle]=IDate;}
if((lIndiceCycle===0)&&(LCycle>1)){if(LCycle<=ObjetCycles.C_MaxDomaineCycle){this.cache.bornesCycles[LCycle].DateDebut=new Date(IDate.getTime());}
if(LCycle-1<=ObjetCycles.C_MaxDomaineCycle){this.cache.bornesCycles[LCycle-1].DateFin=GDate.GetJourSuivant(IDate,-1);}}}
if(GDate.estJourEgal(IDate,this.donneesCycles.derniereDate)){this.cache.nombreCyclesAnneeScolaire=LCycle;}
LIndiceJourAnnee+=1;LPasToutRempli=(LCycle<=ObjetCycles.C_MaxDomaineCycle)||(LIndiceJourAnnee<=C_NbJoursCaches);}}
function _CycleEtIndiceCycleDeDate(aDate){var lDate=GDate.GetJour(aDate),LDateRef=this.cache.bornesCycles[1].DateDebut,lResult={cycle:-1,indice:C_JourCycleHorsGrille};if((lDate.getTime()>=LDateRef.getTime())&&(lDate.getTime()<=this.cache.bornesCycles[this.cache.nombreCyclesAnneeScolaire].DateFin)){lResult=this.cache.cycleEtIndiceParDate[ GDate.getNbrJoursEntreDeuxDates(lDate,LDateRef)-1 ];}
return lResult;}
ObjetCycles.prototype.init=function(aParametres){$.extend(this.donneesCycles,aParametres);_calculer.bind(this)();};ObjetCycles.prototype.nombreJoursOuvresParCycle=function(){return this.donneesCycles.joursOuvresParCycle;};ObjetCycles.prototype.dateDebutPremierCycle=function(){return new Date(this.cache.bornesCycles[1].DateDebut);};ObjetCycles.prototype.dateFinDernierCycle=function(){return new Date(this.cache.bornesCycles[this.cache.nombreCyclesAnneeScolaire].DateFin);};ObjetCycles.prototype.dateEnCycleEtJourCycle=function(aDate,aTypeRecherche,aParamOut){var LCycleEtIndice,LDate;LCycleEtIndice={cycle:-1,indice:C_JourCycleHorsGrille};try{LDate=aDate;if(LDate<this.dateDebutPremierCycle()){if(aTypeRecherche!==ObjetCycles.recherche.autoriserSuivants){return false;}
LDate=this.dateDebutPremierCycle();}
if(LDate>this.dateFinDernierCycle()){if(aTypeRecherche!==ObjetCycles.recherche.autoriserPrecedents){return false;}
LDate=this.dateFinDernierCycle();}
while(LCycleEtIndice.indice===C_JourCycleHorsGrille&&LDate>=this.dateDebutPremierCycle()&&LDate<=this.dateFinDernierCycle()){LCycleEtIndice=_CycleEtIndiceCycleDeDate.bind(this)(LDate);if(LCycleEtIndice.indice===C_JourCycleHorsGrille){switch(aTypeRecherche){case ObjetCycles.recherche.autoriserSuivants:LDate=GDate.GetJourSuivant(LDate,1);break;case ObjetCycles.recherche.autoriserPrecedents:LDate=GDate.GetJourSuivant(LDate,-1);break;default:return false;}}}}
finally{aParamOut.cycle=LCycleEtIndice.cycle;aParamOut.indice=LCycleEtIndice.indice;return aParamOut.jourCycle!==C_JourCycleHorsGrille;}};ObjetCycles.prototype.nombreCyclesAnneeScolaire=function(){return this.cache.nombreCyclesAnneeScolaire;};ObjetCycles.prototype.cycleDeLaDate=function(aDate){var LDate=GDate.getDateBornee(aDate);return _CycleEtIndiceCycleDeDate.bind(this)(LDate).cycle;};ObjetCycles.prototype.dateEnJourCycle=function(aDate){var lParam={};if(this.dateEnCycleEtJourCycle(aDate,ObjetCycles.recherche.autoriserPrecedents,lParam)){return lParam.indice;}
return 0;};ObjetCycles.prototype.cycleCourant=function(){return this.cycleDeLaDate(new Date());};ObjetCycles.prototype.dateDebutCycle=function(aCycle){var lDate=this.cache.bornesCycles[Math.borner(aCycle,1,ObjetCycles.C_MaxDomaineCycle)].DateDebut;return IE.MethodesObjet.isDate(lDate)?new Date(lDate):lDate;};ObjetCycles.prototype.dateFinCycle=function(aCycle){var lDate=this.cache.bornesCycles[Math.borner(aCycle,1,ObjetCycles.C_MaxDomaineCycle)].DateFin;return IE.MethodesObjet.isDate(lDate)?new Date(lDate):lDate;};ObjetCycles.prototype.dateDernierJourOuvreCycle=function(aCycle){var lCycle=Math.borner(aCycle,1,ObjetCycles.C_MaxDomaineCycle),lIndice=this.donneesCycles.joursOuvresParCycle,lResult=0;while(lResult===0&&lIndice>=0){lResult=this.cache.datesAfficheesParCycle[lCycle][lIndice]||0;lIndice+= -1;}
return IE.MethodesObjet.isDate(lResult)?new Date(lResult):lResult;};ObjetCycles.prototype.jourCycleEnDate=function(AJourCycle,ACycle){if(ACycle<1){return this.dateDebutPremierCycle();}
if(ACycle>ObjetCycles.C_MaxDomaineCycle){return this.dateFinCycle(ObjetCycles.C_MaxDomaineCycle);}
if(AJourCycle<0){return this.dateDebutCycle(ACycle);}
if(AJourCycle===ObjetCycles.C_IndicePremierJourCycle){return this.dateDebutCycle(ACycle);}
if(AJourCycle===ObjetCycles.C_IndiceDernierJourCycle){return this.dateFinCycle(ACycle);}
if(AJourCycle===ObjetCycles.C_IndiceDernierJourOuvreCycle||AJourCycle>=this.cache.datesAfficheesParCycle[ACycle].length){return this.dateDernierJourOuvreCycle(ACycle);}
var lDate=this.cache.datesAfficheesParCycle[ACycle][AJourCycle];return IE.MethodesObjet.isDate(lDate)?new Date(lDate):lDate;};ObjetCycles.prototype.getDomaineFerie=function(){if(!this.cache.domaineFerie){this.cache.domaineFerie=new TypeDomaine();var lCycle,lJourCycle,LSemaineFeriee,lNombreCycles=this.nombreCyclesAnneeScolaire(),lNombreJoursCycle=this.nombreJoursOuvresParCycle(),lDateDebutPremierCycle=this.dateDebutPremierCycle(),lJourAnnuel,lDate;for(lCycle=1;lCycle<=lNombreCycles;lCycle+=1){LSemaineFeriee=true;for(lJourCycle=0;lJourCycle<lNombreJoursCycle&&LSemaineFeriee;lJourCycle+=1){lDate=this.jourCycleEnDate(lJourCycle,lCycle);lJourAnnuel=GDate.getNbrJoursEntreDeuxDates(lDate,lDateDebutPremierCycle);LSemaineFeriee=this.donneesCycles.joursFeries.contains(lJourAnnuel)||!GDate.estDateDansAnneeScolaire(lDate);}
this.cache.domaineFerie.SetValeur(LSemaineFeriee,lCycle);}}
return this.cache.domaineFerie;};ObjetCycles.prototype.cycleDansAnnee=function(aCycle){return Math.max(1,Math.min(this.nombreCyclesAnneeScolaire(),aCycle));};}());;
var EGenreJour={Lundi:0,Mardi:1,Mercredi:2,Jeudi:3,Vendredi:4,Samedi:5,Dimanche:6};;
var GDate=new ObjetDate();function ObjetDate(){this.DureeMillisecondes=1;this.DureeSecondes=1000*this.DureeMillisecondes;this.DureeMinutes=60*this.DureeSecondes;this.DureeHeures=60*this.DureeMinutes;this.DureeJours=24*this.DureeHeures;this.DureeSemaines=7*this.DureeJours;this.aujourdhui=new Date();this.demain=new Date();this.demain.setHours(this.demain.getHours()+24);this.hier=new Date();this.hier.setHours(this.demain.getHours()-24);this.conserverNumerosCalendaires=false;}
ObjetDate.prototype.SetDonnees=function(APremierLundi,aPremiereDate,aDerniereDate,APlacesParJour,APlacesParHeure,ADureeSequence,APremiereHeure,AListeHeures1,AListeHeures2,aJoursOuvres,aJour){this.PremierLundi=APremierLundi;this.premiereDate=aPremiereDate;this.derniereDate=aDerniereDate;this.PlacesParJour=APlacesParJour;this.PlacesParHeure=APlacesParHeure;this.DureeSequence=ADureeSequence;this.DureePlace=ADureeSequence/APlacesParHeure;this.PremiereHeure=APremiereHeure;this.ListeHeures=AListeHeures1;this.ListeHeuresFin=AListeHeures2;this.joursOuvres=aJoursOuvres||new TypeDomaine(true,7);this.jour=this.GetDateDemiJour(aJour||new Date());this.jourOuvreToJour=[];var I=0,J;for(J=0;J<7;J++){if(this.joursOuvres.GetValeur(((J+GDate.GetJourDeDate(this.PremierLundi))%7)+1)){this.jourOuvreToJour[I++]=J;}}};ObjetDate.prototype.estUnJourOuvre=function(aDate){return this.joursOuvres.GetValeur(GDate.GetJourDeDate(aDate)+1);};ObjetDate.prototype.estDateEgale=function(ADate1,ADate2){return(ADate1-ADate2)===0;};ObjetDate.prototype.estJourEgal=function(ADate1,ADate2){return ADate1&&ADate2&&(ADate1.getDate()===ADate2.getDate())&&(ADate1.getMonth()===ADate2.getMonth())&&(ADate1.getFullYear()===ADate2.getFullYear());};ObjetDate.prototype.estJourSemaineEgal=function(ADate1,ADate2){return(ADate1.getDay()===ADate2.getDay())&&(ADate1.getMonth()===ADate2.getMonth())&&(ADate1.getFullYear()===ADate2.getFullYear());};ObjetDate.prototype.estJourCourant=function(aDate){return this.estJourEgal(aDate,this.getDateCourante());};ObjetDate.prototype.estAvantJourCourant=function(aDate){return(aDate-this.getDateCourante())<0;};ObjetDate.prototype.estAvantJour=function(aDate1,aDate2){return(aDate1-aDate2)<0;};ObjetDate.prototype.estDateValide=function(aDate){return MethodesObjet.isDate(aDate)&&!isNaN(aDate.getTime());};ObjetDate.prototype.getDateCourante=function(){var lDate=new Date();lDate=new Date(lDate.getFullYear(),lDate.getMonth(),lDate.getDate());if(lDate<this.premiereDate){return this.premiereDate;}
if(lDate>this.derniereDate){return this.derniereDate;}
return lDate;};ObjetDate.prototype.getDateBornee=function(aDate){if(aDate<this.premiereDate)
return this.premiereDate;if(aDate>this.derniereDate)
return this.derniereDate;else return aDate;};ObjetDate.prototype.estDateDansAnneeScolaire=function(aDate){return(aDate>=this.premiereDate||this.estJourEgal(aDate,this.premiereDate))&&(aDate<=this.derniereDate||this.estJourEgal(aDate,this.derniereDate));};ObjetDate.prototype.getDateHeureCourante=function(){var lDate=new Date();if(lDate<this.premiereDate){return this.premiereDate;}
if(lDate>this.derniereDate){return this.derniereDate;}
return lDate;};ObjetDate.prototype.GetDateDemiJour=function(ADate){return new Date(ADate.getFullYear(),ADate.getMonth(),ADate.getDate(),12);};ObjetDate.prototype.premierJourOuvreDeLaSemaine=function(aNrSemaine){return IE.Cycles.dateDebutCycle(aNrSemaine);};ObjetDate.prototype.dernierJourOuvreDeLaSemaine=function(aNrSemaine){return IE.Cycles.dateDernierJourOuvreCycle(aNrSemaine);};ObjetDate.prototype.dernierJourDeLaSemaine=function(aNrSemaine){return GDate.GetDateParSemaineEtJour(aNrSemaine,6);};ObjetDate.prototype.premierJourDeLaSemaine=function(aNrSemaine){return GDate.GetDateParSemaineEtJour(aNrSemaine,0);};ObjetDate.prototype.GetJour=function(ADate,N){return new Date(ADate.getFullYear(),ADate.getMonth(),ADate.getDate(),N===null||N===undefined?0:24*N);};ObjetDate.prototype.GetJourDeSemaine=function(ADate,B){return(7+ADate.getDay()-(B?this.PremierLundi.getDay():1))%7;};ObjetDate.prototype.GetSemaineSuivante=function(ADate,N){return new Date(ADate.getTime()+(N===null||N===undefined?1:N)*this.DureeSemaines);};ObjetDate.prototype.GetJourSuivant=function(ADate,N){var lDate=new Date(ADate.getTime()),lNombreJours=IE.MethodesObjet.isNumber(N)?N:1;lDate.setDate(lDate.getDate()+lNombreJours);return lDate;};ObjetDate.prototype.EstUnJourDuWE=function(AAnnee,AMois,AJour){var D=new Date(AAnnee,AMois,AJour).getDay();return(D===0)||(D===6);};ObjetDate.prototype.GetNombreJoursDuMois=function(AAnnee,AMois){AMois=(AMois+1)%12;if(AMois===0){AAnnee++;}
return new Date(AAnnee,AMois,0).getDate();};ObjetDate.prototype.GetPremierJourDuMois=function(AAnnee,AMois){return new Date(AAnnee,AMois,1,12);};ObjetDate.prototype.GetPremierLundiDuMois=function(AAnnee,AMois){var LJour=this.GetPremierJourDuMois(AAnnee,AMois);return this.GetJourSuivant(LJour,(GDate.GetJourDeSemaine(this.PremierLundi)-(7+GDate.GetJourDeSemaine(LJour)))%7);};ObjetDate.prototype.GetDernierJourDuMois=function(AAnnee,AMois){return new Date(AAnnee,AMois,this.GetNombreJoursDuMois(AAnnee,AMois),12);};ObjetDate.prototype.EstUnJourDuMois=function(AAnnee,AMois,AJour){return new Date(AAnnee,AMois,AJour).getMonth()===AMois;};ObjetDate.prototype.estHeureIdentique=function(aDate1,aDate2,aALaMinute){return(aDate1.getHours()===aDate2.getHours())&&(aDate1.getMinutes()===aDate2.getMinutes());};ObjetDate.prototype.JourEstDansLaPeriode=function(AAnnee,AMois,AJour,ADateDebut,ADateFin){var LDate=new Date(AAnnee,AMois,AJour);return(LDate>=ADateDebut)&&(LDate<=ADateFin);};ObjetDate.prototype.dateEstDansLaPeriode=function(aDate,aDateDebut,aDateFin){return(aDate>=aDateDebut)&&(aDate<=aDateFin);};ObjetDate.prototype.StrMoisCourt=function(AAnnee,AMois,AAvecAnnee){return GTraductions.getValeur('MoisCourt')[AMois]+(AAvecAnnee?'&nbsp;'+AAnnee:'');};ObjetDate.prototype.nombreJoursSurPeriode=function(aDateDebut,aDateFin){return this._GetNbrJours(aDateFin)-this._GetNbrJours(aDateDebut);};ObjetDate.prototype.NombreMoisSurPeriode=function(ADateDebut,ADateFin){return 12*(ADateFin.getFullYear()-ADateDebut.getFullYear())+(ADateFin.getMonth()-ADateDebut.getMonth())+1;};ObjetDate.prototype.nombresSemainesDansLAnnee=function(){var lDay=this.GetJourDeDate(new Date(this.PremierLundi.getFullYear(),0,1));return(lDay===EGenreJour.Jeudi)?(lDay===EGenreJour.Mercredi&&this.PremierLundi.estAnneeBissextile())?53:53:52;};ObjetDate.prototype.GetDateParSemaineEtJour=function(ANumeroSemaine,ANumeroJour){return new Date(this.PremierLundi.valueOf()+this.DureeJours*(0.5+7*ANumeroSemaine+ANumeroJour));};ObjetDate.prototype.GetDateParPlace=function(ANumeroSemaine,APlace,APlacesParJour){return this.GetDateParSemaineEtJour(ANumeroSemaine,Math.floor(APlace/APlacesParJour));};ObjetDate.prototype.GetJourDeDate=function(ADate){return(ADate.getDay()+7-1)%7;};ObjetDate.prototype.getFuseau=function(aDate){return aDate?aDate.getTimezoneOffset()/60:0;};ObjetDate.prototype.getEcartFuseau=function(aDate1,aDate2){return this.getFuseau(aDate1)-this.getFuseau(aDate2);};ObjetDate.prototype.GetSemaine=function(aDate){aDate=aDate||new Date();return Math.max(1,1+parseInt((aDate.getTime()-this.PremierLundi.getTime()-this.getEcartFuseau(aDate,this.PremierLundi)*60*60*1000)/this.DureeSemaines,10)%52);};ObjetDate.prototype.getNbrJoursDepuisPremiereDate=function(aDate){return this.getNbrJoursEntreDeuxDates(aDate,this.PremierLundi);};ObjetDate.prototype.getNbrJoursEntreDeuxDates=function(aDate1,aDate2){aDate1=aDate1||new Date();aDate2=aDate2||new Date();return Math.max(1,1+Math.floor((aDate1.getTime()-aDate2.getTime()-this.getEcartFuseau(aDate1,aDate2)*60*60*1000)/this.DureeJours));};ObjetDate.prototype.GetSemaineCalendaire=function(){return 1+Math.round((this.PremierLundi-new Date(this.PremierLundi.getFullYear(),0,1))/this.DureeSemaines);};ObjetDate.prototype.semaineToCalendaire=function(aSemaine){return this.conserverNumerosCalendaires?((aSemaine-1)+(this.GetSemaineCalendaire()-1))%this.nombresSemainesDansLAnnee()+1:aSemaine;};ObjetDate.prototype.GetDifferenceJours=function(aDate1,aDate2){var lJour1=parseInt(this.GetJour(aDate1)/this.DureeJours,10);var lJour2=parseInt(this.GetJour(aDate2)/this.DureeJours,10);return lJour1-lJour2;};ObjetDate.prototype.GetDifferenceJoursPar24h=function(aDate1,aDate2){var duree_ms=aDate1-aDate2;return parseInt(duree_ms/this.DureeJours,10);};ObjetDate.prototype.GetDifferenceTime=function(aDate1,aDate2){var duree_ms=aDate1-aDate2;var reste_heures=duree_ms-(parseInt(duree_ms/this.DureeJours,10)*this.DureeJours);var nb_heures=parseInt(reste_heures/this.DureeHeures,10);var reste_minutes=duree_ms-(parseInt(duree_ms/this.DureeHeures,10)*this.DureeHeures);var nb_minutes=parseInt(reste_minutes/this.DureeMinutes,10);var reste_secondes=duree_ms-(parseInt(duree_ms/this.DureeMinutes,10)*this.DureeMinutes);var nb_secondes=parseInt(reste_secondes/this.DureeSecondes,10);return(nb_heures<10?'0':'')+nb_heures+':'+(nb_minutes<10?'0':'')+nb_minutes+':'+(nb_secondes<10?'0':'')+nb_secondes;};ObjetDate.prototype.FormatDate=function(ADate,AFormat){if(!ADate){return'';}
AFormat=AFormat.replace(/\[(.*?)\]/ig,!this.estJourEgal(ADate,this.aujourdhui)?!this.estJourEgal(ADate,this.demain)?!this.estJourEgal(ADate,this.hier)?'$1':GTraductions.getValeur('Hier'):GTraductions.getValeur('Demain'):GTraductions.getValeur('Aujourdhui'));var LHour=ADate.getHours();var LMinute=ADate.getMinutes();var LSecond=ADate.getSeconds();var LDay=this.GetJourDeDate(ADate);var LDate=ADate.getDate();var LMonth=ADate.getMonth()+1;var LYear=ADate.getFullYear();AFormat=AFormat.replace('%hh' ,(LHour<10?'0':'')+LHour);AFormat=AFormat.replace('%xh' ,LHour);AFormat=AFormat.replace('%mm' ,(LMinute<10?'0':'')+LMinute);AFormat=AFormat.replace('%ss' ,(LSecond<10?'0':'')+LSecond);AFormat=AFormat.replace('%JJJJ',GTraductions.getValeur('Jours')[LDay]);AFormat=AFormat.replace('%JJJ' ,GTraductions.getValeur('JoursCourt')[LDay]);AFormat=AFormat.replace('%JJ' ,(LDate<10?'0':'')+LDate);AFormat=AFormat.replace('%J' ,LDate);AFormat=AFormat.replace('%MMMM',GTraductions.getValeur('Mois')[LMonth-1]);AFormat=AFormat.replace('%MMM' ,GTraductions.getValeur('MoisCourt')[LMonth-1]);AFormat=AFormat.replace('%MM' ,(LMonth<10?'0':'')+LMonth);AFormat=AFormat.replace('%AAAA',LYear);AFormat=AFormat.replace('%AA' ,(LYear%100<10?'0':'')+LYear%100);return AFormat;};ObjetDate.prototype.estDateParticulier=function(ADate){return this.estJourEgal(ADate,this.aujourdhui)||this.estJourEgal(ADate,this.demain)||this.estJourEgal(ADate,this.hier);};ObjetDate.prototype.FormatDureeEnMillisecondes=function(ADureeEnMillisecondes,AFormat){if(ADureeEnMillisecondes===null||ADureeEnMillisecondes===undefined){return'';}
if((AFormat.lastIndexOf('%hh')> -1)||(AFormat.lastIndexOf('%xh')> -1)){var LHour=parseInt(ADureeEnMillisecondes/this.DureeHeures,10);AFormat=AFormat.replace('%hh' ,(LHour<10?'0':'')+LHour);AFormat=AFormat.replace('%xh' ,LHour);ADureeEnMillisecondes=ADureeEnMillisecondes-LHour*this.DureeHeures;}
if(AFormat.lastIndexOf('%mm')> -1){var LMinute=parseInt(ADureeEnMillisecondes/this.DureeMinutes,10);AFormat=AFormat.replace('%mm' ,(LMinute<10?'0':'')+LMinute);ADureeEnMillisecondes=ADureeEnMillisecondes-LMinute*this.DureeMinutes;}
var LSecond=parseInt(ADureeEnMillisecondes/this.DureeSecondes,10);AFormat=AFormat.replace('%ss' ,(LSecond<10?'0':'')+LSecond);return AFormat;};ObjetDate.prototype.enCentiemeDHeure=function(aDureeEnMillisecondes){var lDuree=parseInt(aDureeEnMillisecondes,10);if(!IE.MethodesObjet.isNumber(lDuree)){return'';}
var lNbHeures=Math.floor(lDuree/GDate.DureeHeures),lMinutesEnCentiemes=Math.floor((lDuree/GDate.DureeHeures-lNbHeures)*100);if(lMinutesEnCentiemes<10){lMinutesEnCentiemes='0'+lMinutesEnCentiemes;}
return lNbHeures+','+lMinutesEnCentiemes;};ObjetDate.prototype.strSemaine=function(aNumeroSemaine,aFormatDebut,aFormatFin,aSeparateur1,aSeparateur2,aSeparateur3){var lDateDeb=this.FormatDate(this.premierJourOuvreDeLaSemaine(aNumeroSemaine),aFormatDebut);var lDateFin=this.FormatDate(this.dernierJourOuvreDeLaSemaine(aNumeroSemaine),aFormatFin);return(aSeparateur1||'')+lDateDeb+(aSeparateur2||'')+lDateFin+(aSeparateur3||'');};ObjetDate.prototype.strDomaine=function(aDomaine,aFormatDebut,aFormatFin,aSeparateur1,aSeparateur2,aSeparateur3){var lDateDeb=this.FormatDate(IE.Cycles.dateDebutCycle(aDomaine.GetPremierePosition()),aFormatDebut);var lDateFin=this.FormatDate(IE.Cycles.dateDernierJourOuvreCycle(aDomaine.GetDernierePosition()),aFormatFin);return(aSeparateur1||'')+lDateDeb+(aSeparateur2||'')+lDateFin+(aSeparateur3||'');};ObjetDate.prototype.strDates=function(aDateDebut,aDateFin){var lResult=[];if(this.estJourEgal(aDateDebut,aDateFin)){lResult.push(GDate.FormatDate(aDateDebut,'['+GTraductions.getValeur('Le')+' '+'%J %MMMM'+']'));lResult.push(' ');lResult.push(this.FormatDate(aDateDebut,GTraductions.getValeur('De')+' %hhh%mm')+' '+GDate.FormatDate(aDateFin,GTraductions.getValeur('A')+' %hhh%mm'));} else{lResult.push(this.FormatDate(aDateDebut,GTraductions.getValeur('Du')+' '+'%J %MMMM')+' '+GDate.FormatDate(aDateDebut,GTraductions.getValeur('A')+' %hhh%mm'));lResult.push(' ');lResult.push(this.FormatDate(aDateFin,GTraductions.getValeur('Au')+' '+'%J %MMMM')+' '+GDate.FormatDate(aDateFin,GTraductions.getValeur('A')+' %hhh%mm'));}
return lResult.join('');};ObjetDate.prototype.PlaceAnnuelleEnDate=function(APlace,AEstDateFin){var LJour=this.GetJourSuivant(this.PremierLundi,Math.floor(APlace/this.PlacesParJour));var LHeure=this.ListeHeures.GetLibelle(APlace%this.PlacesParJour+(AEstDateFin?1:0));return new Date(LJour.getFullYear(),LJour.getMonth(),LJour.getDate(),LHeure.split(GTraductions.getValeur('date.separateurHeure'))[0],LHeure.split(GTraductions.getValeur('date.separateurHeure'))[1]);};ObjetDate.prototype.DateEnPlaceAnnuelle=function(ADate,AEstDateFin){var LPlaceJour=(this._GetNbrJours(ADate)-this._GetNbrJours(this.PremierLundi))*this.PlacesParJour;var I;for(I=this.PlacesParJour-1;(I>=0)&&(this._GetNbrMinutes(ADate)-(AEstDateFin?1:0)<this._GetNbrMinutes_LibelleHeure(I));I--){$.noop();}
return LPlaceJour+I;};ObjetDate.prototype.PlaceParJourEnDate=function(APlace){var LJour=this.getDateCourante();var LHeure=this.ListeHeures.GetLibelle(APlace);return new Date(LJour.getFullYear(),LJour.getMonth(),LJour.getDate(),LHeure.split(GTraductions.getValeur('date.separateurHeure'))[0],LHeure.split(GTraductions.getValeur('date.separateurHeure'))[1]);};ObjetDate.prototype.DateEnPlaceHebdomadaire=function(ADate,AEstDateFin){var LPlaceJour=GDate.GetJourDeDate(ADate)*this.PlacesParJour;var I;for(I=this.PlacesParJour-1;(I>=0)&&(this._GetNbrMinutes(ADate)-(AEstDateFin?1:0)<this._GetNbrMinutes_LibelleHeure(I));I--){$.noop();}
return LPlaceJour+I;};ObjetDate.prototype._GetNbrMinutes=function(ADate){return ADate.getHours()*60+ADate.getMinutes();};ObjetDate.prototype._GetNbrMinutes_LibelleHeure=function(I){var LLibelleHeure=this.ListeHeures.GetLibelle(I);return parseInt(LLibelleHeure.split(GTraductions.getValeur('date.separateurHeure'))[0],10)*60+parseInt(LLibelleHeure.split(GTraductions.getValeur('date.separateurHeure'))[1],10);};ObjetDate.prototype._GetNbrJours=function(ADate){return Date.UTC(ADate.getFullYear(),ADate.getMonth(),ADate.getDate())/this.DureeJours;};ObjetDate.prototype.placeEnDate=function(aNumeroCycle,aPlace,aEstPlaceFin,aInstanceCycles){var lCycles=aInstanceCycles||IE.Cycles,LJour=lCycles.jourCycleEnDate(Math.floor(aPlace/this.PlacesParJour),aNumeroCycle);var LHeure=!aEstPlaceFin?this.ListeHeures.GetLibelle(aPlace%this.PlacesParJour):this.ListeHeuresFin?this.ListeHeuresFin.GetLibelle(aPlace%this.PlacesParJour):this.ListeHeures.GetLibelle(aPlace%this.PlacesParJour+1);return LHeure?new Date(LJour.getFullYear(),LJour.getMonth(),LJour.getDate(),LHeure.split(GTraductions.getValeur('date.separateurHeure'))[0],LHeure.split(GTraductions.getValeur('date.separateurHeure'))[1]):new Date(LJour.getFullYear(),LJour.getMonth(),LJour.getDate());};ObjetDate.prototype.dureeEnDate=function(aDuree){return new Date((aDuree*this.DureePlace*this.DureeMinutes)+new Date(0).getTimezoneOffset()*60*1000);};ObjetDate.prototype.nombrePlacesEnMillisecondes=function(aPlaces){var lMinutes=(60/this.PlacesParHeure)*(aPlaces%this.PlacesParHeure);var lHeures=Math.floor(aPlaces/this.PlacesParHeure);return lHeures*this.DureeHeures+lMinutes*this.DureeMinutes;};ObjetDate.prototype.getDateDeChaine=function(aChaine,aDateDebut,aDateFin){aDateDebut=aDateDebut||this.PremierLundi;aDateFin=aDateFin||this.derniereDate;var T=aChaine.split('/');if(T[2]&&(T[2].length===2)){T[2]='20'+T[2];}
var lDate=new Date(T[2],T[1]-1,T[0]);var lEstValide=((lDate.getFullYear()===parseInt(T[2]))||(lDate.getFullYear()===parseInt('20'+T[2],10)))&&(lDate.getMonth()===Number(T[1]-1))&&(lDate.getDate()===parseInt(T[0]))&&(lDate>=aDateDebut)&&(lDate<=aDateFin);;return lEstValide?lDate:null;};ObjetDate.prototype.getDuree=function(aMinutes){var lHeures=Math.floor(aMinutes/60);var lMinutes=(aMinutes%60);return lHeures+GTraductions.getValeur('date.separateurHeure')+(lMinutes<10?'0':'')+lMinutes;};ObjetDate.prototype.getListeSemaines=function(aSemaineDebut,aSemaineFin,aGenreTri){var lLibelle,LDateDeb,LDateFin;var lSemaineCourante=this.GetSemaine();var lListeSemaines=new ObjetListeElements();var lSemaineDeb=Math.max(0,aSemaineDebut);var lSemaineFin=Math.min(this.nombresSemainesDansLAnnee(),aSemaineFin);for(var lSemaine=lSemaineDeb;lSemaine<=lSemaineFin;lSemaine++){if(lSemaine===lSemaineCourante)
lLibelle=GTraductions.getValeur('SemaineEnCours');else if(lSemaine===lSemaineCourante+1)
lLibelle=GTraductions.getValeur('SemaineSuivante');else if(lSemaine===lSemaineCourante-1)
lLibelle=GTraductions.getValeur('SemainePrecedente');else{LDateDeb=GDate.FormatDate(IE.Cycles.dateDebutCycle(lSemaine),'%JJ/%MM');LDateFin=GDate.FormatDate(IE.Cycles.dateDernierJourOuvreCycle(lSemaine),'%JJ/%MM');lLibelle=GTraductions.getValeur('Du')+' '+LDateDeb+' '+GTraductions.getValeur('Au')+' '+LDateFin;}
lListeSemaines.AddElement(new ObjetElement(lLibelle,null,lSemaine));}
lListeSemaines.setTri([ObjetTri.init('Genre')]);lListeSemaines.trier(aGenreTri);return lListeSemaines;};ObjetDate.prototype.getListeMoisAPartirDeDate=function(aDateDebut,aDateFin){var lListeMois=new ObjetListeElements(),lElement,lAnnee,lMois,lDate,lVrai=true,lPremiereDate=aDateDebut||this.premiereDate,lDerniereDate=aDateFin||this.derniereDate,lAnneeDebut=lPremiereDate.getFullYear(),lMoisDebut=lPremiereDate.getMonth(),lAnneeFin=lDerniereDate.getFullYear(),lMoisFin=lDerniereDate.getMonth();if(lPremiereDate.getTime()<lDerniereDate.getTime()){lMois=lMoisDebut;lAnnee=lAnneeDebut;while(lVrai){if(lMois>=lMoisFin&&lAnnee>=lAnneeFin||lAnnee>lAnneeFin){lVrai=false;}
lDate=new Date(lAnnee,lMois);lElement=new ObjetElement(GDate.FormatDate(lDate,'%MMMM %AAAA').ucfirst());lElement.annee=lAnnee;lElement.mois=lMois;lDate=this.GetPremierJourDuMois(lAnnee,lMois);lElement.dateDebut=lDate>=lPremiereDate?lDate:lPremiereDate;lDate=this.GetDernierJourDuMois(lAnnee,lMois);lElement.dateFin=lDate<=lDerniereDate?lDate:lDerniereDate;lListeMois.AddElement(lElement);lMois+=1;if(lMois>11){lAnnee+=1;lMois=0;}}}
return lListeMois;};;
function _ObjetChaine(){var I,J;this.ListeZeros='0000000000';this.ListeAvecAccents=['éèê','à'];this.ListeSansAccents=['e' ,'a'];this.ListeExpAccents=[];for(I=0;I<this.ListeAvecAccents.length;I++){this.ListeExpAccents[I]=new RegExp('['+this.ListeAvecAccents[I]+']','ig');}
this.LongueurCaracteres=new Array(30);for(I=0;I<30;I++){this.LongueurCaracteres[I]=new Array(2);for(J=0;J<2;J++){this.LongueurCaracteres[I][J]=[];}}
this._DOM_Modele=document.createElement('textarea');}
_ObjetChaine.prototype.enleverChemin=function(aFichier){var N=aFichier.lastIndexOf('/');if(N=== -1)
N=aFichier.lastIndexOf('\\');return aFichier.substring(N+1,aFichier.length);};_ObjetChaine.prototype.AvecEspaceSiVide=function(AChaine){return AChaine&&(AChaine.length>0)?AChaine:'&nbsp;';};(function(){_ObjetChaine.prototype.StrToType=function(AChaine,AType){switch(AType){case EGenreType.Cardinal:return this.StrToCardinal(AChaine);case EGenreType.Boolean:return this.StrToBoolean(AChaine);case EGenreType.String:return this.ajouterEntites(AChaine);case EGenreType.Color:return AChaine;case EGenreType.Date:return this.StrToDate(AChaine);case EGenreType.Domaine:return this.strToDomaine(AChaine);case EGenreType.Note:return this.strToNote(AChaine);case EGenreType.Traduction:return AChaine;case EGenreType.EnsembleCardinal:return this.strToDomaine(AChaine,TypeDomaine.CTailleOuverte);case EGenreType.Arrondi:return this.strToArrondi(AChaine);case EGenreType.Ensemble:return this.strToEnsemble(AChaine);case EGenreType.IP:return this.strToIp(AChaine);case EGenreType.Integer:return this.strToInteger(AChaine);case EGenreType.Html:return this.StrToHtml(AChaine);case EGenreType.Double:return this.strToDouble(AChaine);case EGenreType.JSON:return IE.ObjetJSON.parse(AChaine);case EGenreType.EnsembleNombre:return new TypeEnsembleNombre().fromString(AChaine);default:return AChaine;}};_ObjetChaine.prototype.StrToDate=function(ADate){ADate=ADate.split(' ');var LJour=ADate[0].split('/');var LHeure=ADate[1]?ADate[1].split(':'):[0,0,0];return new Date(LJour[2],LJour[1]-1,LJour[0],LHeure[0],LHeure[1],LHeure[2]);};_ObjetChaine.prototype.strToInteger=function(aInteger){return parseInt(aInteger,10);};_ObjetChaine.prototype.strToDouble=function(aDouble){return parseFloat(aDouble.replace(',','.'));};_ObjetChaine.prototype.StrToHtml=function(aChaine){return GHtml.nettoyerHtml(aChaine);};_ObjetChaine.prototype.StrToCardinal=function(ACardinal){return parseInt(ACardinal,10);};_ObjetChaine.prototype.StrToBoolean=function(ABoolean){return(ABoolean==='1')||(ABoolean.toUpperCase()==='TRUE')||(ABoolean.toUpperCase()==='VRAI');};_ObjetChaine.prototype.strToIp=function(aIP){var T=aIP.split('.');if(T.length!==4){return'';}
var lIp=0,I,lValeur;for(I=0;I<4;I++){lValeur=parseInt(T[I],10);if((lValeur<0)||(lValeur>255)){return 0;}
lIp=256*lIp+lValeur;}
return lIp;};_ObjetChaine.prototype.strToDomaine=function(aDomaine,aNombreValeurs){if(!window.TypeDomaine){;return null;}
return new TypeDomaine(aDomaine,aNombreValeurs);};_ObjetChaine.prototype.strToNote=function(aNote){if(!window.TypeNote){;return null;}
if(MethodesObjet.isArray(aNote)){var T=[],i;for(i in aNote){T[i]=new TypeNote(aNote[i]);}
return T;}
return new TypeNote(aNote);};_ObjetChaine.prototype.strToArrondi=function(aArrondi){if(!window.TypeArrondi){;return null;}
return new TypeArrondi(aArrondi);};_ObjetChaine.prototype.strToEnsemble=function(aArrondi){if(!window.TypeDomaine){;return null;}
return new TypeDomaine(aArrondi);};_ObjetChaine.prototype.TypeToStr=function(AChaine,AType){switch(AType){case EGenreType.Cardinal:return this.CardinalToStr(AChaine);case EGenreType.Boolean:return this.BooleanToStr(AChaine);case EGenreType.String:return this.enleverEntites(this.ChaineToStr(AChaine));case EGenreType.Color:return this.ChaineToStr(AChaine);case EGenreType.Date:return this.DateToStr(AChaine);case EGenreType.Domaine:return this.domaineToStr(AChaine);case EGenreType.Note:return this.noteToStr(AChaine);case EGenreType.Traduction:return this.ChaineToStr(AChaine);case EGenreType.Arrondi:return this.arrondiToStr(AChaine);case EGenreType.Ensemble:return this.ensembleToStr(AChaine);case EGenreType.IP:return this.ipToStr(AChaine);case EGenreType.Integer:return this.integerToStr(AChaine);case EGenreType.Double:return this.doubleToStr(AChaine);case EGenreType.JSON:return IE.ObjetJSON.toJSON(AChaine);case EGenreType.EnsembleNombre:return AChaine?AChaine.toString():'';default:return AChaine;}};_ObjetChaine.prototype.DateToStr=function(ADate){return ADate?ADate.getDate()+'/'+(ADate.getMonth()+1)+'/'+ADate.getFullYear()+' '+ADate.getHours()+':'+ADate.getMinutes()+':'+ADate.getSeconds():'';};_ObjetChaine.prototype.domaineToStr=function(aDomaine){return aDomaine?aDomaine.toString():'';};_ObjetChaine.prototype.noteToStr=function(aNote){return aNote?aNote.toString():'';};_ObjetChaine.prototype.arrondiToStr=function(aArrondi){return aArrondi?aArrondi.toString():'';};_ObjetChaine.prototype.ensembleToStr=function(aDomaine){return aDomaine?aDomaine.toString():'';};_ObjetChaine.prototype.integerToStr=function(aInteger){return''+aInteger;};_ObjetChaine.prototype.doubleToStr=function(aDouble){return(''+aDouble).replace('.',',');};_ObjetChaine.prototype.ChaineToStr=function(AChaine){return!AChaine?'':AChaine;};_ObjetChaine.prototype.CardinalToStr=function(ACardinal){return''+ACardinal;};_ObjetChaine.prototype.BooleanToStr=function(ABoolean){return ABoolean?'TRUE':'FALSE';};_ObjetChaine.prototype.ipToStr=function(aIp){aIp=parseInt(aIp,10);if(isNaN(aIp)){return'';}
var T=[],I;for(I=4;I>0;I--){T[I-1]=(aIp%256);if(T[I-1]<0){T[I-1]+=256;}
aIp=Math.floor(aIp/256);}
return T.join('.');};_ObjetChaine.prototype.FormatPourTri=function(AChaine,AType){if(!AType){var LType=typeof AChaine;if(LType==='string'){AType=EGenreType.String;}
else if(LType==='number'){AType=EGenreType.Cardinal;}
else if(LType==='boolean'){AType=EGenreType.Boolean;}}
switch(AType){case EGenreType.Cardinal:return this.CardinalToTri(AChaine);case EGenreType.Boolean:return this.BooleanToTri(AChaine);case EGenreType.String:return this.StringToTri(AChaine);case EGenreType.Date:return this.DateToTri(AChaine);default:return AChaine;}};_ObjetChaine.prototype.StringToTri=function(AChaine){var I;if(AChaine){AChaine=AChaine.toLowerCase();for(I=0;I<this.ListeAvecAccents.length;I++){AChaine=AChaine.replace(this.ListeExpAccents[I],this.ListeSansAccents[I]);}}
return AChaine;};_ObjetChaine.prototype.DateToTri=function(ADate){return GDate.FormatDate(ADate,'%AA%MM%JJ%hh%mm%ss');};_ObjetChaine.prototype.CardinalToTri=function(ACardinal){var LCardinal=''+ACardinal;return this.ListeZeros.slice(0,10-LCardinal.length)+LCardinal;};_ObjetChaine.prototype.BooleanToTri=function(ABoolean){return ABoolean?'1':'0';};_ObjetChaine.prototype.FormatNum=function(aChaine,aTabElementsASubstituer){if(aChaine){aChaine=aChaine.replace(/%(\d):[sd]/gi,function(aMatch,aPos){return aTabElementsASubstituer[parseInt(aPos,10)];});}
return aChaine;};_ObjetChaine.prototype.Format=function(AChaine,ATabElementsASubstituer){var I;if(AChaine&&ATabElementsASubstituer&&ATabElementsASubstituer.length){AChaine=AChaine.replace(/%s/g,'##');AChaine=AChaine.replace(/%d/g,'##');var N=AChaine.split('##').length;for(I=0;I<N;I++){AChaine=AChaine.replace('##','#'+(I+1));}
var lRegEx,lPourcentTrouve=AChaine.indexOf('%')>=0;for(I=0;I<ATabElementsASubstituer.length;I++){AChaine=AChaine.replace('#'+(I+1),ATabElementsASubstituer[I]);if(lPourcentTrouve){lRegEx=new RegExp('%'+I+':d','g');AChaine=AChaine.replace(lRegEx,parseInt(ATabElementsASubstituer[I],10));lRegEx=new RegExp('%'+I+':(s|d|e|f|g|n|m)','g');AChaine=AChaine.replace(lRegEx,ATabElementsASubstituer[I]);}}
AChaine=AChaine.replace(/%%/g,'%');}
return AChaine;};_ObjetChaine.prototype.Insecable=function(AChaine){try{return AChaine?AChaine.replace(/ /g,"&nbsp;").replace(/-/g,"&#x2011;"):'';} catch(e){return'';}};_ObjetChaine.prototype._getConteneurCalculChaine=function(){var ldLongueurChaineEnPixel='LongueurChaineEnPixel';var E=document.getElementById(ldLongueurChaineEnPixel);if(!GHtml.estElement(E)){var lConteneur=GHtml.getElement(GApplication.getIdConteneur())||document.body;GHtml.addHtml(lConteneur,'<div id="'+ldLongueurChaineEnPixel+'" class="Texte10 hide" style="position:absolute; top:-50px; white-space:pre;"></div>');E=document.getElementById(ldLongueurChaineEnPixel);}
if(E)
return E;;return null;};_ObjetChaine.prototype.GetLongueurChaineDansDiv=function(AChaine,ATaille,AGras,aNonToTexte){;if(!AChaine){return 0;}
if(!this.__cacheCanvas){this.__cacheCanvas=IE.Support.supportCanvasText&&GHtml.chercherAttributReglesCss?{canvas:document.createElement("canvas"),fontFamily:window.GHtml?GHtml.chercherAttributReglesCss('.Texte','fontFamily'):null,fontSize:{}}:{};this.__cacheCanvas.actif=!!this.__cacheCanvas.canvas&&!!this.__cacheCanvas.fontFamily;if(!this.__cacheCanvas.actif){this.__cacheCanvas.canvas=null;}}
if(this.__cacheCanvas.actif){var lContext=this.__cacheCanvas.canvas.getContext("2d");if(!this.__cacheCanvas.fontSize[ATaille]){this.__cacheCanvas.fontSize[ATaille]=GHtml.chercherAttributReglesCss('.Texte'+ATaille,'fontSize');}
lContext.font=(AGras?'bold ':'')+this.__cacheCanvas.fontSize[ATaille]+' '+this.__cacheCanvas.fontFamily;var lMetrics=lContext.measureText(AChaine);return lMetrics.width;}
var E=this._getConteneurCalculChaine();if(!E){return 0;}
E.className='hide Texte'+ATaille+(AGras?' Gras':'');var lChaine=aNonToTexte===true?AChaine:this.ajouterEntites(AChaine);lChaine=lChaine&&lChaine.replace?lChaine.replace(/ /g,"&nbsp;"):lChaine;E.innerHTML=lChaine;var lLongueur=E.clientWidth;E.innerHTML='';return lLongueur;};_ObjetChaine.prototype.GetLongueurChaine=function(AChaine,ATaille,AGras,ALongueur,aChaineEnTexte){if(!AChaine){return'';}
var lChaine=this.enleverEntites(AChaine);var LLongueur=0;var N=lChaine.length;var G=AGras?1:0;var C,L,I;for(I=0;(I<N)&&((ALongueur===null||ALongueur===undefined)||(LLongueur<ALongueur));I++){C=lChaine.charCodeAt(I);L=this.LongueurCaracteres[ATaille][G][C];if(!L){L=this.LongueurCaracteres[ATaille][G][C]=this.GetLongueurChaineDansDiv(lChaine.charAt(I),ATaille,AGras);}
LLongueur+=L===0?10:L;}
if(ALongueur===null||ALongueur===undefined){return LLongueur;}
if(LLongueur>=ALongueur){if(LLongueur===0){return aChaineEnTexte?'':'<font style="font-size:1px">&nbsp;</font>';}
var lChaineTronque=lChaine.substring(0,I-1);while(I>2){if(this.GetLongueurChaineDansDiv(lChaineTronque,ATaille,AGras)<ALongueur){break;}
I--;lChaineTronque=lChaine.substring(0,I-1);}
return this.ajouterEntites(lChaineTronque);}
return AChaine;};_ObjetChaine.prototype.GetChaine=function(AChaine,ATaille,AGras,ALongueur,aChaineEnTexte){return this.GetLongueurChaine(AChaine,ATaille,AGras,ALongueur,aChaineEnTexte);};_ObjetChaine.prototype.GetChainePourUrl=function(S,aEstUnFichier){;try{if(aEstUnFichier){return encodeURI(S).replace(/#/ig,'%23');}
return encodeURI(decodeURI(S));} catch(e){return'';}};_ObjetChaine.prototype.ToHTML=function(AChaine){;return AChaine?AChaine.replace(/\r\n|\n|\r|&#32;/g,"<br />"):'';};_ObjetChaine.prototype.fromHTML=function(AChaine){;return AChaine?AChaine.replace(/<br( \/)?>/gi,'\n'):'';};_ObjetChaine.prototype.ajouterEntites=function(aChaine,aSansQuote){;if(!aChaine||!aChaine.replace){return aChaine;}
var re=aSansQuote?/([<>'&])/g : /([<>"'&])/g;return aChaine.replace(re,function(m){if(m==="<"){return"&lt;";}
if(m===">"){return"&gt;";}
if(m==="\""){return"&quot;";}
if(m==="'"){return"&#039;";}
if(m==="&"){return"&amp;" ;}});};_ObjetChaine.prototype.enleverEntites=function(aChaine){;if(!aChaine||!aChaine.replace){return aChaine;}
var re=/&(lt|gt|quot|#039|amp);/g;return aChaine.replace(re,function(m){if(m==="&lt;"){return"<";}
if(m==="&gt;"){return">";}
if(m==="&quot;"){return"\"";}
if(m==="&#039;"){return"'";}
if(m==="&amp;"){return"&" ;}});};_ObjetChaine.prototype.toTexte=function(aChaine,aRemplaceDoubleQuote){return aChaine;};_ObjetChaine.prototype.nettoyerCommentaire=function(aChaine){;return aChaine&&aChaine.replace?aChaine.replace(/(<!--)(.+)(-->)/g,''):aChaine;};_ObjetChaine.prototype.verifierURLHttp=function(aUrl){return aUrl?(aUrl.toLowerCase().indexOf('http://')===0)||(aUrl.toLowerCase().indexOf('https://')===0)?aUrl:'http://'+aUrl:aUrl ;};_ObjetChaine.prototype.composerURL=function(aUrl,aLibelle,aEstUnFichier,aBloquerUrl,aClass){aUrl=aUrl||aLibelle;var lHref=aEstUnFichier?aUrl:this.verifierURLHttp(aUrl);var lOnClick=aBloquerUrl?' onclick="return false;"':'';return'<a id="'+window.GUID.getId()+'" '+(aClass?'class="'+aClass+'"':'')+'href="'+GChaine.GetChainePourUrl(lHref,aEstUnFichier)+'" '+lOnClick+' target="_blank">'+aLibelle+'</a>';};_ObjetChaine.prototype.composeUrlRequete=function(aParam){var lResult='';if(aParam.url){lResult=aParam.url;if(lResult.charAt(lResult.length-1)!=='/'){lResult+='/';}}
if(aParam.nomRequete){if(aParam.nomRequete.charAt(0)!=='/'){lResult+=aParam.nomRequete;}
else{lResult+=aParam.nomRequete.substring(1,aParam.nomRequete.length-1);}}
return lResult;};_ObjetChaine.prototype.supprimerEspaces=function(aChaine){;return aChaine&&aChaine.replace?aChaine.replace(/ /g,''):aChaine;};var _regexLatinize=null;function _latinize(aMatch){var x,lTranslate={'á':'a','à':'a','â':'a','ä':'a','ã':'a','ç':'c','é':'e','è':'e','ê':'e','ë':'e','í':'i','ì':'i','î':'i','ï':'i','ñ':'n','ó':'o','ò':'o','ô':'o','ö':'o','õ':'o','ő':'o','ß':'ss','š':'szz','ú':'u','ù':'u','û':'u','ü':'u','ű':'u','ý':'y','ÿ':'y','æ':'ae','œ':'oe'};if(!aMatch){if(!_regexLatinize){var lRegex=[];for(x in lTranslate){lRegex.push(x);}
_regexLatinize=lRegex.join('');}
return _regexLatinize;}
var lMatchLower=aMatch.toLowerCase();var lIsUpperCase=lMatchLower!==aMatch;return lIsUpperCase?lTranslate[lMatchLower].ucfirst():lTranslate[lMatchLower];}
_ObjetChaine.prototype.latinize=function(aChaine){;return aChaine?aChaine.replace(new RegExp('['+_latinize()+']','gi'),_latinize):'';};_ObjetChaine.prototype.miseEnFormeEmail=function(aEmail){;return aEmail?aEmail.replace(/;/g,'<br/>'):'';};_ObjetChaine.prototype.controleTailleTexte=function(aParam){var lResult={controleOK:true,chaine:aParam.chaine};var lValeurSansEntites=this.enleverEntites(aParam.chaine);if((aParam.tailleTexteMax>0)&&(lValeurSansEntites.length>aParam.tailleTexteMax)){lValeurSansEntites=lValeurSansEntites.slice(0,aParam.tailleTexteMax);lResult={controleOK:false,chaine:this.ajouterEntites(lValeurSansEntites)};}
return lResult;};}());;
MethodesObjet.heritagePrototype(ObjetChaine_Espace,_ObjetChaine);var GChaine=new ObjetChaine_Espace();function ObjetChaine_Espace(){this.inheritedCreate();this._hauteurPolice=[];}
ObjetChaine_Espace.prototype.AvecSautDeLigne=function(AChaine){return AChaine+'<br>';};ObjetChaine_Espace.prototype.AvecTexteGras=function(AChaine){return'<B>'+AChaine+'</B>';};ObjetChaine_Espace.prototype.AvecMajuscule=function(AChaine){return AChaine.substring(0,1).toUpperCase()+AChaine.substring(1);};ObjetChaine_Espace.prototype.ToStringHtml=function(aChaine,aSansConversionSautDeLigne){var lSeperateur=aSansConversionSautDeLigne?"":"<br>";return aChaine.replace(/\n/g,lSeperateur);};ObjetChaine_Espace.prototype.SansSautDeLigneHtml=function(AChaine,ASeparateur){return AChaine.replace("<br>",ASeparateur);};ObjetChaine_Espace.prototype.StrToPourcentage=function(AChaine){var lValeur=parseInt(AChaine.replace('%',''))/100;return lValeur;};ObjetChaine_Espace.prototype.normaliserIp=function(aIp){return this.ipToStr(this.strToIp(aIp));};ObjetChaine_Espace.prototype.GetLongueurCaractere=function(ACodeCaractere,ATaille,AGras){var G=AGras?1:0;var L=this.LongueurCaracteres[ATaille][G][ACodeCaractere];if(!L)
L=this.LongueurCaracteres[ATaille][G][ACodeCaractere]=this.GetLongueurChaineDansDiv(String.fromCharCode(ACodeCaractere),ATaille,AGras,true);return L;};ObjetChaine_Espace.prototype.GetHauteurPolice=function(ATaille){var lHauteur=this._hauteurPolice[ATaille];if(!lHauteur){var E=this._getConteneurCalculChaine();if(!E)
return 0;E.className='hide Texte'+ATaille;E.innerHTML='X';lHauteur=this._hauteurPolice[ATaille]=E.offsetHeight;}
return lHauteur;};ObjetChaine_Espace.prototype.GetChaineDecoupee=function(AChaine,ATaille,AGras,ALongueur){var LListeChaines=[];while(AChaine.length){var LChaine=this.GetChaine(AChaine,ATaille,AGras,ALongueur);LListeChaines.push(LChaine);AChaine=AChaine.substring(LChaine.length);}
return LListeChaines.join('<br>');};ObjetChaine_Espace.prototype.EstChaineTropLongue=function(AChaine,ATaille,AGras,ALongueur){return this.GetChaine(AChaine,ATaille,AGras,ALongueur).length!==AChaine.length;};ObjetChaine_Espace.prototype.DecouperChaineSiMasquee=function(AChaine){var LgChaine=AChaine.length;if(LgChaine>0){var I=0;var CaractereCourant=AChaine.charAt(I) ;while((CaractereCourant==='*')&&(I<LgChaine)){I++;CaractereCourant=AChaine.charAt(I);}
if(I===LgChaine){return'***';}}
return AChaine;};ObjetChaine_Espace.prototype.activerURL=function(S){return S&&S.replace?S.replace(/http:\/\/[0-9a-z?_.=&\/%~\-]*[0-9a-z\/]/ig,'<a href="$&" target="_blank">$&</a>'):S;};ObjetChaine_Espace.prototype.desactiverURL=function(S){return S&&S.replace?S.replace(/(<a href=")([0-9a-z:?_.=&\/%~\-]*)(">)([0-9a-z:?_.=&\/%~\-]+)(<\/a>)/ig,'$2'):S;};ObjetChaine_Espace.prototype.ajouterBlankURL=function(S){return S&&S.replace?S.replace('href','target="_blank" href'):S;};ObjetChaine_Espace.prototype.actualiserURL=function(S){if(!S||!S.toLowerCase)
return S;if(S.toLowerCase().indexOf('href')=== -1)
S=this.activerURL(S);if(S.toLowerCase().indexOf('target')=== -1)
S=this.ajouterBlankURL(S);return S;};ObjetChaine_Espace.prototype.composerEmail=function(aEmail,aNotMailTo,aStyleSite,aSansTabulation){return!aNotMailTo?'<a href="mailto:'+aEmail+'"'+(aSansTabulation?' tabindex="-1"':'')+' target="_blank">'+GChaine.miseEnFormeEmail(aEmail)+'</a>':'<span class="LienAccueil AvecMain">'+GChaine.miseEnFormeEmail(aEmail)+'</span>';};ObjetChaine_Espace.prototype.toTitle=function(aChaine){var lChaine=aChaine&&aChaine.toString?aChaine.toString():'';return lChaine&&lChaine.replace?lChaine.replace(/\r\n/g,"&#013;").replace(/\n/g,"&#013;").replace(/"/g,'&quot;'):'';};ObjetChaine_Espace.prototype.estChaineHTMLEgal=function(aChaine1,aChaine2){if(aChaine1===aChaine2)
return true;var lDiv=GHtml.creerElementDOM('div');lDiv.innerHTML=aChaine1;var lTemp=lDiv.innerHTML;lDiv.innerHTML=aChaine2;return(lTemp===lDiv.innerHTML);};ObjetChaine_Espace.prototype.EstCardinal=function(V){return typeof(V)==='number';};ObjetChaine_Espace.prototype.chaineToEntier=function(aChaine,aMin,aMax){var lEntier=parseInt(aChaine);return isNaN(lEntier)?aMin:Math.borner(Math.floor(lEntier),aMin,aMax);};ObjetChaine_Espace.prototype.getNomFichier=function(aFichier){var N=aFichier.lastIndexOf('.');return aFichier.substring(0,N);};ObjetChaine_Espace.prototype.getExtFichier=function(aFichier){var N=aFichier.lastIndexOf('.');return aFichier.substring(N+1,aFichier.length);};ObjetChaine_Espace.prototype.toNumeroTelephone=function(aChaine,aSansEspaces){var lRegex=aSansEspaces?/[^0-9]+/g:/[^0-9 ]+/g;var lChaine=aChaine.replace(lRegex,'');return lChaine.trim();};ObjetChaine_Espace.prototype.formatTelephone=function(aChaine){var lTel='',lChar,lChaine=aChaine||'',lIndice=0;for(var i=0,lNb=lChaine.length;i<lNb;i++){lChar=lChaine.charAt(i);if(IE.MethodesObjet.isNumber(parseInt(lChar))){if(lIndice>0&&lIndice%2===0){lTel+=' ';}
lTel+=lChar;lIndice+=1;}}
return lTel.trim();};ObjetChaine_Espace.prototype.toIndicatifTelephone=function(aChaine){var lRegex=/[^0-9 +]/g;var lChaine=aChaine.replace(lRegex,'');return lChaine.trim();};ObjetChaine_Espace.prototype.estEmailValide=function(aEmail){if(!MethodesObjet.isString(aEmail))
return false;var lEmailRegEx=/^([A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,6}\s*;?\s*)*$/i;return aEmail.search(lEmailRegEx)!== -1;};ObjetChaine_Espace.prototype.extraireNomFichier=function(aNomFichier){if(!aNomFichier||!aNomFichier.split)
return aNomFichier;var lTab=aNomFichier.split('.');if(lTab.length>1)
lTab.pop();return lTab.join('.');};ObjetChaine_Espace.prototype.extraireExtensionFichier=function(aNomFichier){if(!aNomFichier||!aNomFichier.split)
return'';var lTab=aNomFichier.split('.');return lTab.length>1?lTab[lTab.length-1]:'';};;
var EEvent={SurError:1,SurResize:2,SurPreResize:3,SurPostResize:4,SurClick:5,SurScroll:6,SurKeyDown:7,SurKeyUp:8,SurKeyPress:9,SurMouseMove:10,SurMouseDown:11,SurSelectStart:12,SurMouseUp:13,SurFinDeplacement:14,SurBlur:15,SurChange:16,SurDblClick:17,SurFocus:18,SurLoad:19,SurUnload:20,SurMouseOut:21,SurMouseOver:22,SurFinResize:23};;
var GApplication;function ObjetApplication(){this.init();this.nomProduit='INDEX';this.hauteurTitre=20;this.hauteurLigne=20;this.hauteurBandeau=22;this.idLigneBandeau="ligneBandeau";this.idBreadcrumb="breadcrumbBandeau";this.idBreadcrumbPerso="breadcrumbBandeauPerso";}
ObjetApplication.EtatApplication={normal:1,modeExclusif:2};(function(){var lCommunication=null;var lParametres=null;var lEstDemo=false;var lListeObjetsGraphiques=[],lDateServeurReferant,lDateClientReferant;var lEtatApplication=ObjetApplication.EtatApplication.normal;var lEstDebug=false;ObjetApplication.prototype.init=function(){IE.Invocateur.abonner(IE.Invocateur.events.modificationModeExclusif,_setModeExclusif,this);};ObjetApplication.prototype.getNom=function(){return'GApplication';};ObjetApplication.prototype.getIdConteneur=function(){return'div';};ObjetApplication.prototype.getCommunication=function(){;return lCommunication;};ObjetApplication.prototype.setCommunication=function(aInstanceCommunication){lCommunication=aInstanceCommunication;if(lCommunication&&lCommunication.setNom){lCommunication.setNom(this.getNom()+'.getCommunication ()');}};ObjetApplication.prototype.getParametres=function(){;return lParametres;};ObjetApplication.prototype.setParametres=function(aInstanceParametres){lParametres=aInstanceParametres;};ObjetApplication.prototype.getDemo=function(){return lEstDemo;} ;ObjetApplication.prototype.setDemo=function(aValeur){lEstDemo=aValeur;};ObjetApplication.prototype.getDateDemo=function(){return this.dateDemo;};ObjetApplication.prototype.setDateDemo=function(aDateDemo){this.dateDemo=aDateDemo;};ObjetApplication.prototype.initDateServeur=function(aDate){lDateServeurReferant=aDate;lDateClientReferant=new Date();};ObjetApplication.prototype.getDateServeur=function(){if(!lDateServeurReferant||!lDateClientReferant){;return new Date();}
return new Date(lDateServeurReferant.getTime()+new Date().getTime()-lDateClientReferant.getTime());};ObjetApplication.prototype.ajouterObjetGraphique=function(aIndice,aNom){if(this._verificationAjoutObjetDansTableau){this._verificationAjoutObjetDansTableau(lListeObjetsGraphiques,aIndice,aNom);}
lListeObjetsGraphiques[aIndice]={nom:aNom,estFenetre:_estObjetFenetreVolante(aNom)};};ObjetApplication.prototype.getObjetGraphique=function(aParametre){var lInfosObjet=IE.MethodesObjet.isNumber(aParametre)?lListeObjetsGraphiques[aParametre]:null;if(!lInfosObjet){if(IE.MethodesObjet.isString(aParametre)&&window[aParametre]){lInfosObjet={nom:aParametre,estFenetre:_estObjetFenetreVolante(aParametre),constructeur:window[aParametre]};}
else if(aParametre&&IE.MethodesObjet.isFunction(aParametre)){lInfosObjet={nom:'NON IDENTIFIE',estFenetre:aParametre.prototype&&aParametre.prototype.__estFenetreVolante,constructeur:aParametre};}}
else{lInfosObjet.constructeur=window[lInfosObjet.nom];}
return lInfosObjet;};function _estObjetFenetreVolante(aNomConstructeur){if(window[aNomConstructeur]&&window[aNomConstructeur].prototype&&window[aNomConstructeur].prototype.__estFenetreVolante){return!!window[aNomConstructeur].prototype.__estFenetreVolante;}
return false;}
ObjetApplication.prototype.existeObjetGraphique=function(aParametre){var lObjetGraphique=this.getObjetGraphique(aParametre);return lObjetGraphique&&IE.MethodesObjet.isFunction(lObjetGraphique.constructeur);};ObjetApplication.prototype.estObjetGraphiqueFenetre=function(aIndice){;try{return lListeObjetsGraphiques[aIndice]&&lListeObjetsGraphiques[aIndice].estFenetre;} catch(e){;}};ObjetApplication.prototype.getTraductionsObjetMessage=function(){return{fermer:GTraductions.getValeur('Fermer'),oui:GTraductions.getValeur('Oui'),non:GTraductions.getValeur('Non'),annuler:GTraductions.getValeur('Annuler')};};ObjetApplication.prototype._initialiserObjetMessage=function(){if(window.ObjetMessage){this._objetMessage=new window.ObjetMessage(this.getNom()+'._objetMessage');}
else if(window.FenetreModale_InformationConfirmation){this._objetMessage=new window.FenetreModale_InformationConfirmation();}
if(this._objetMessage&&this._objetMessage.setTraductions){var lTraduc=this.getTraductionsObjetMessage();this._objetMessage.setTraductions(lTraduc.fermer,lTraduc.oui,lTraduc.non,lTraduc.annuler);}};ObjetApplication.prototype.getMessage=function(){if(!this._objetMessage){this._initialiserObjetMessage();}
return this._objetMessage;};ObjetApplication.prototype.getEtatApplication=function(){return lEtatApplication;};function _setModeExclusif(aEstModeExclusif){this.changerEtatApplication(aEstModeExclusif?ObjetApplication.EtatApplication.modeExclusif:ObjetApplication.EtatApplication.normal);}
ObjetApplication.prototype.getModeExclusif=function(){return this.getEtatApplication()===ObjetApplication.EtatApplication.modeExclusif;};ObjetApplication.prototype.entreeModeExclusif=function(){IE.Invocateur.evenement(IE.Invocateur.events.modeExclusif,true);};ObjetApplication.prototype.sortieModeExclusif=function(){IE.Invocateur.evenement(IE.Invocateur.events.modeExclusif,false);};ObjetApplication.prototype.changerEtatApplication=function(aEtat){switch(lEtatApplication){case ObjetApplication.EtatApplication.normal:switch(aEtat){case ObjetApplication.EtatApplication.normal:break;case ObjetApplication.EtatApplication.modeExclusif:lEtatApplication=aEtat;this.entreeModeExclusif();break;default:;}
break;case ObjetApplication.EtatApplication.modeExclusif:switch(aEtat){case ObjetApplication.EtatApplication.normal:lEtatApplication=aEtat;this.sortieModeExclusif();break;case ObjetApplication.EtatApplication.modeExclusif:break;default:;}
break;default:;}};ObjetApplication.prototype.finSession=function(aParametres){var lParametresFin={constructionPage:false};$.extend(lParametresFin,aParametres);IE.Invocateur.desabonner(IE.Invocateur.events.modificationModeExclusif,this);$(document).off();$(window).off();IE.Invocateur.desabonner(IE.Invocateur.events.autorisationRechargementPage);if(lCommunication&&lCommunication.arreter){lCommunication.arreter();}
if(window.GNavigateur){GNavigateur.viderCache();if(GNavigateur.BloquerInterface){GNavigateur.BloquerInterface(false,window.EGenreCurseur?EGenreCurseur.Defaut:null,false);}}
if(lParametresFin.constructionPage){this.construirePageFinSession(lParametresFin);}
lCommunication=null;lParametres=null;lListeObjetsGraphiques=null;};ObjetApplication.prototype.construirePageFinSession=function(aParametres){if(this._unloadEnCours){return;}
var lCouleur={texte:'black',fond:'white',bordure:'black'};if(window.GCouleur){$.extend(lCouleur,GCouleur);}
var lParametresFin={jsonErreur:null,statut:'',couleur:lCouleur,sansBoutonSeConnecter:false};$.extend(lParametresFin,aParametres);var lTitre=null;var lMessage=null,lGenreErreur;if(lParametresFin.jsonErreur){lGenreErreur=lParametresFin.jsonErreur.G;lTitre=lParametresFin.jsonErreur.Titre;lMessage=lParametresFin.jsonErreur.Message;}
lTitre=lTitre===null||lTitre===undefined?GTraductions.getValeur('connexion.PageIndisponible'):lTitre;lMessage=lMessage===null||lMessage===undefined?GTraductions.getValeur('connexion.AffichagePageImpossible'):lMessage;var T=[];T.push(this.construireEnTetePageFinSession(lParametresFin));T.push('<div style="clear:both; position:relative; top:100px;',GStyle.composeCouleurBordure(lCouleur.bordure,2),GStyle.composeBordureArrondi(8),GStyle.composeCouleurTexte(lCouleur.texte),GStyle.composeCouleurFond(lCouleur.fond),'margin:auto; text-align : center; min-width:290px; max-width:800px; width:50%; padding:10px;','">');T.push('<div id="waispan_id" class="Texte14 Gras EspaceBas">'+GTraductions.getValeur('connexion.Deconnecter')+'</div>');if(lTitre){T.push('<div class="Texte14 Gras EspaceBas">'+lTitre+(lParametresFin.statut?' ('+GTraductions.getValeur('connexion.Erreur')+' '+lParametresFin.statut+')':'')+'</div>');}
if(lMessage){T.push('<div class="Texte12">'+lMessage+'</div>');}
if(lGenreErreur!==7&&!lParametresFin.sansBoutonSeConnecter){T.push('<div class="Texte12 GrandEspaceHaut">','<div tabindex="0" ',window.GObjetWAI?window.GObjetWAI.composeRole(EGenreRole.Button):'',window.GObjetWAI?window.GObjetWAI.composeAttribut({genre:EGenreAttribut.describedby,valeur:"waispan_id"}):'','class="AvecMain Souligne"','onkeyup="if (GNavigateur.IsToucheSelection()) window.location.reload()" onclick="window.location.reload ()">',GTraductions.getValeur('connexion.SeConnecter'),'</div>','</div>');}
T.push('</div>');GHtml.setHtml(this.getIdConteneur(),T.join(''));};ObjetApplication.prototype.construireEnTetePageFinSession=function(aParametres){return'';};ObjetApplication.prototype.estDebug=function(){return lEstDebug;};ObjetApplication.prototype.setEstDebug=function(aValeur){lEstDebug=aValeur;};ObjetApplication.prototype.nomPropConteneurDebug=function(){return'conteneurDebug';};ObjetApplication.prototype.getDebug=function(){return this[this.nomPropConteneurDebug()];};}());function ObjetApplicationPN(){this.inheritedCreate();this.nomProduit='PRONOTE';}
MethodesObjet.heritagePrototype(ObjetApplicationPN,ObjetApplication);;
function _ObjetNavigateur(){this.Nom='GNavigateur';this.OnEvent=[];this.nbBlocageClavier=0;this.interactionUtilisateur=true;this.ActualiserTailleEcran();}(function(){var lTimerPresenceUtilisateur,lTimerDeclencherVerifierPresenceUtilisateur=null,c_dureeInteractionUtilisateur=10*60*1000;_ObjetNavigateur.prototype.Initialiser=function(){this.UserAgent=navigator.userAgent;var LIndex=this.UserAgent.lastIndexOf("MSIE");this.isIpad=this.UserAgent.lastIndexOf("iPad")!== -1;this.isIphone=this.UserAgent.lastIndexOf("iPhone")!== -1;this.isAndroid=this.UserAgent.lastIndexOf("Android")!== -1;if(document.body.parentNode.parentNode.firstChild.nodeValue===null||document.body.parentNode.parentNode.firstChild.nodeValue===undefined){this.IsIE9=parseInt(this.UserAgent.substring(LIndex+5,LIndex+6),10)===9;}
try{this.IsIE=LIndex!== -1;} catch(e){this.IsIE=LIndex!== -1;}
this.IsIE=(LIndex!== -1)||(this.UserAgent.lastIndexOf("Trident")!== -1);if(this.IsIE){this.IEVersion=this.UserAgent.match(/MSIE (.*?);/)?parseInt(this.UserAgent.match(/MSIE (.*?);/)[1],10):0;this.IEModeCompatible=this.IEVersion>document.documentMode;this.IsIE8=this.IEVersion===8;}
if(this.IsIE&&!this.IsIE8){this.IsIE8=document.documentMode===8;}
this.isIETouch=this.IsIE&& /Touch/.test(this.UserAgent);this.isIE9Mobile=this.IsIE&& /Windows Phone OS 7/.test(this.UserAgent);this.isTactile=this.isIpad||this.isIphone||this.isAndroid||this.isIETouch;this.IsWebKit=this.UserAgent.lastIndexOf('AppleWebKit/')> -1;this.IsGecko=!this.IsIE&&this.UserAgent.lastIndexOf('Gecko')> -1&&this.UserAgent.lastIndexOf('KHTML')=== -1;this.IsOpera=Object.prototype.toString.call(window.opera)==='[object Opera]';this.withContentEditable=this.IsIE||this.IsOpera||this.IsGecko||(this.IsWebKit&&!this.isAndroid&&!this.isIphone&&!this.isIpad)||(this.IsWebKit&&parseInt(this.UserAgent.match(/AppleWebKit\/(\d*)/)[1],10)>=534);GNavigateur.ActualiserTailleEcran();_uniformisationTouch();_emulationContextMenu();_uniformisationEventIEChange();if(IE.Support.supportTouch){$(document).on('touchstart touchmove','.IE_draggable',function(event){event.preventDefault();});}
IE.Invocateur.abonner(IE.Invocateur.events.eventIOAjax,_surEventIOAjax,this);var lTimeoutTailleEcran;IE.Invocateur.abonner(IE.Invocateur.events.modificationHTML,function(){if(lTimeoutTailleEcran){clearTimeout(lTimeoutTailleEcran);lTimeoutTailleEcran=null;}
lTimeoutTailleEcran=setTimeout(function(){GNavigateur.ActualiserTailleEcran();},100);});};_ObjetNavigateur.prototype.ActualiserTailleEcran=function(){if(document.body){this.EcranL=document.body.scrollWidth;this.EcranH=document.body.scrollHeight;this.ClientL=document.body.clientWidth;this.ClientH=document.body.clientHeight;}};_ObjetNavigateur.prototype.ResetCodeTouche=function(){this.CodeTouche=null;this.ShiftTouche=null;this.AltTouche=null;this.CtrlTouche=null;this.CmdTouche=null;};function _surEventIOAjax(aParametres){if(aParametres.init||aParametres.actualisation){return;}
var lBloquer=!!aParametres.emission;this.nbBlocageClavier=this.nbBlocageClavier+(lBloquer?1:-1);this.nbBlocageClavier=Math.max(0,this.nbBlocageClavier);}
_ObjetNavigateur.prototype.getBloquerClavier=function(){return this.nbBlocageClavier>0;};_ObjetNavigateur.prototype._surUnload=function(event){var lNavigateur=event.data.instance;Invocateur.evenement(Invocateur.events.surRechargementPage);lNavigateur.viderCache();};_ObjetNavigateur.prototype._surBeforeUnload=function(event){var lData;if(IE.Invocateur){lData={};Invocateur.evenement(Invocateur.events.autorisationRechargementPage,lData);if(lData.message){return lData.message;}}
if(window.GApplication){GApplication._unloadEnCours=true;}
return;};_ObjetNavigateur.prototype.finChargementPage=function(event){event.data.instance.chargementTermine=true;};_ObjetNavigateur.prototype.viderCache=function(){this.OnEvent=[];if(lTimerPresenceUtilisateur)
clearTimeout(lTimerPresenceUtilisateur);if(lTimerDeclencherVerifierPresenceUtilisateur)
clearTimeout(lTimerDeclencherVerifierPresenceUtilisateur);};_ObjetNavigateur.prototype._surBlurFenetre=function(aEvent){aEvent.data.instance.ResetCodeTouche();};function _utilisateurNonPresent(){Invocateur.evenement(Invocateur.events.modificationPresenceUtilisateur,false);GNavigateur.interactionUtilisateur=false;}
function _verifierPresenceUtilisateur(aEvent){if(!GNavigateur.interactionUtilisateur){Invocateur.evenement(Invocateur.events.modificationPresenceUtilisateur,true);}
GNavigateur.interactionUtilisateur=true;if(lTimerPresenceUtilisateur){clearTimeout(lTimerPresenceUtilisateur);lTimerPresenceUtilisateur=null;}
lTimerPresenceUtilisateur=setTimeout(_utilisateurNonPresent,c_dureeInteractionUtilisateur);$(document).off('click keydown mousemove',_verifierPresenceUtilisateur);if(lTimerDeclencherVerifierPresenceUtilisateur){clearTimeout(lTimerDeclencherVerifierPresenceUtilisateur);lTimerDeclencherVerifierPresenceUtilisateur=null;}
lTimerDeclencherVerifierPresenceUtilisateur=setTimeout(_declencherVerifierPresenceUtilisateur,1000*10);}
function _declencherVerifierPresenceUtilisateur(){$(document).on('click keydown mousemove',_verifierPresenceUtilisateur);}
_ObjetNavigateur.prototype.getEventInvocateur=function(aGenreEvent){return'IIE_EventNavigateur_'+aGenreEvent;};function _emulationContextMenu(){if(!IE.Support.supportTouch){return;}
var lDelai=500,uGestionTouch={},const_margesDeplacementContextMenu=100;function _arreterContextMenu(){if(uGestionTouch.timerTouchStart){clearTimeout(uGestionTouch.timerTouchStart);}
uGestionTouch={};}
function _activerContextMenu(){uGestionTouch.forcerContextMenu=true;}
function _touchstart(event){_arreterContextMenu();var lPosition=GPosition.getPositionEventJQuery(event);uGestionTouch.x=lPosition.x;uGestionTouch.y=lPosition.y;uGestionTouch.timerTouchStart=setTimeout(_activerContextMenu,lDelai);}
function _toucheend(event){if(uGestionTouch.forcerContextMenu===true){var lPosition=GPosition.getPositionEventJQuery(event);var lAccepterContextMenu=event.target&&Math.abs(lPosition.x-uGestionTouch.x)<const_margesDeplacementContextMenu&&Math.abs(lPosition.y-uGestionTouch.y)<const_margesDeplacementContextMenu&&(!window.GPosition||GPosition.positionDansZone(lPosition,event.target));_arreterContextMenu();if(!lAccepterContextMenu){return;}
event.stopImmediatePropagation();event.preventDefault();var lEvent=$.Event('contextmenu');lEvent.contextMenuSimule=true;GNavigateur.SourisX=lPosition.x;GNavigateur.SourisY=lPosition.y;setTimeout(function(){$(event.target).trigger(lEvent);},0);}}
function _contextMenu(){_arreterContextMenu();}
$(document).on({touchstart:_touchstart,touchend:_toucheend,touchcancel:function(){_arreterContextMenu();},contextmenu:_contextMenu});}
function _uniformisationTouch(){var uTouchTimerEnCours= -1,uTouchDblClickEnCours=null,uTouchDblClickEnCoursTimer= -1,const_delaiDblClick=200,uLongTouch=null,uLongTouchTimer= -1,uLongTouchTimerFin= -1,uTouchTimerTouchEnScroll= -1,const_delaiLongTouch=500,const_delaiLongTouchFin=1500,const_margesDeplacementLongTouch=50,const_delaiTouch=1200,const_namespace='uniformisationTouch';GNavigateur.touchEnCours=false;GNavigateur.touchEnScroll=false;function _traiterClickEtDblclick(aEventOrigine,aEventSimule){var lEstDblClick=false;clearTimeout(uTouchDblClickEnCoursTimer);var X1,X2,Y1,Y2;if(uTouchDblClickEnCours&&uTouchDblClickEnCours.identifiant===aEventSimule.identifiant){X1=uTouchDblClickEnCours.x1;X2=uTouchDblClickEnCours.x2;Y1=uTouchDblClickEnCours.y1;Y2=uTouchDblClickEnCours.y2;uTouchDblClickEnCours=null;lEstDblClick=true;}
else{X1=GPosition.getLeft(aEventOrigine.target);X2=X1+GPosition.getWidth(aEventOrigine.target);Y1=GPosition.getTop(aEventOrigine.target);Y2=Y1+GPosition.getHeight(aEventOrigine.target);}
if(((aEventSimule.pageX>X1)&&(aEventSimule.pageX<X2)&&(aEventSimule.pageY>Y1)&&(aEventSimule.pageY<Y2))){var aNewEventSimule=_creerEvent('ieclick',aEventOrigine);$(aEventOrigine.target).trigger(aNewEventSimule);if(lEstDblClick){aNewEventSimule=_creerEvent(lEstDblClick?'iedblclick':'ieclick',aEventOrigine);$(aEventOrigine.target).trigger(aNewEventSimule);}
else{uTouchDblClickEnCours={x1:X1,x2:X2,y1:Y1,y2:Y2,identifiant:aEventSimule.identifiant};uTouchDblClickEnCoursTimer=setTimeout(function(){uTouchDblClickEnCours=null;},const_delaiDblClick);}}}
function _stopperLongTouch(){clearTimeout(uLongTouchTimer);clearTimeout(uLongTouchTimerFin);uLongTouch=null;}
function _demarrageLongTouch(aEventOrigine,aEventSimule){_stopperLongTouch();uLongTouch={identifiant:aEventSimule.identifiant,x:aEventSimule.clientX,y:aEventSimule.clientY,ok:false};uLongTouchTimer=setTimeout(function(){if(uLongTouch) uLongTouch.ok=true;},const_delaiLongTouch);uLongTouchTimerFin=setTimeout(function(){if(uLongTouch){_finaliserLongTouch(aEventOrigine,aEventSimule,true);}},const_delaiLongTouchFin);}
function _eventDansMargesLongTouch(aEvent){return uLongTouch&&Math.abs(aEvent.clientX-uLongTouch.x)<const_margesDeplacementLongTouch&&Math.abs(aEvent.clientY-uLongTouch.y)<const_margesDeplacementLongTouch;}
function _finaliserLongTouch(aEventOrigine,aEventSimule,aSurTimer){clearTimeout(uLongTouchTimer);clearTimeout(uLongTouchTimerFin);if(uLongTouch.ok&&uLongTouch.identifiant===aEventSimule.identifiant&&_eventDansMargesLongTouch(aEventSimule)){var lEventSimule=_creerEvent('ielongtouch',aEventSimule);if(aSurTimer)
lEventSimule.surTimer=true;$(aEventOrigine.target).trigger(lEventSimule);}
_stopperLongTouch();}
function _estTouchEnCours(){GNavigateur.touchEnCours=true;clearTimeout(uTouchTimerEnCours);uTouchTimerEnCours=setTimeout(function(){GNavigateur.touchEnCours=false;},const_delaiTouch);}
function _traiterTouch(event){_estTouchEnCours();if(event.originalEvent&&event.originalEvent.changedTouches&&event.originalEvent.changedTouches[0]){event.pageX=event.originalEvent.changedTouches[0].pageX||0;event.pageY=event.originalEvent.changedTouches[0].pageY||0;event.clientX=event.originalEvent.changedTouches[0].clientX||0;event.clientY=event.originalEvent.changedTouches[0].clientY||0;event.screenX=event.originalEvent.changedTouches[0].screenX||0;event.screenY=event.originalEvent.changedTouches[0].screenY||0;GNavigateur.SourisX=event.pageX;GNavigateur.SourisY=event.pageY;}}
function _creerEvent(aNom,event){var lIdentifiant=1;if(event.originalEvent){if(event.originalEvent.pointerId){lIdentifiant=event.originalEvent.pointerId;}
else if(event.originalEvent&&event.originalEvent.changedTouches&&event.originalEvent.changedTouches.length>0){lIdentifiant=event.originalEvent.changedTouches[0].identifier;}}
var lEstStylet=event.originalEvent&&event.originalEvent.pointerType==='pen',lEstTouch=(event.originalEvent&&event.originalEvent.pointerType==='touch')||lEstStylet||event.type==='touchstart'||event.type==='touchend'||event.type==='touchmove'||event.type==='touchcancel'||event.type==='touchleave' ;if(lEstTouch){_estTouchEnCours();}
var lEvent=jQuery.Event(aNom,{ietype:event.type,identifiant:lIdentifiant,estTouch:lEstTouch,estSouris:!lEstTouch,estStylet:lEstStylet,pageX:event.pageX,pageY:event.pageY,screenX:event.screenX,screenY:event.screenY,offsetX:event.offsetX,offsetY:event.offsetY,clientX:event.clientX,clientY:event.clientY,which:event.which,button:event.button,buttons:event.buttons,metaKey:event.metaKey,altKey:event.altKey,shiftKey:event.shiftKey,relatedTarget:event.relatedTarget,originalEvent:event.originalEvent,view:window});return lEvent;}
function _handle(event){var lType=event.type.toLowerCase(),lNewType=lType;if(GNavigateur.touchEnCours){if(lType==='mousedown'||lType==='mouseup'||lType==='mousemove'){return;}
if(IE.Support.supportTouch&&(lType==='click'||lType==='dblclick')){return;}}
switch(lType){case'pointerdown':case'mousedown':case'touchstart':lNewType='iedown';break;case'pointerup':case'mouseup':case'touchend':lNewType='ieup';break;case'pointermove':case'mousemove':case'touchmove':lNewType='iemove';break;case'pointercancel':case'touchcancel':lNewType='iecancel';if(uLongTouch)
_stopperLongTouch();break;case'click':lNewType='ieclick';break;case'dblclick':lNewType='iedblclick';break;default:;return;}
if(lType==='touchstart'||lType==='touchend'||lType==='touchmove'||lType==='touchcancel'){_traiterTouch(event);}
var lEvent=_creerEvent(lNewType,event);if((lType==='touchstart'||lType==='pointerdown')&&lEvent.estTouch){clearTimeout(uTouchTimerTouchEnScroll);GNavigateur.touchEnScroll=false;}
$(event.target).trigger(lEvent);if(lType==='touchend'&&event.target){_traiterClickEtDblclick(event,lEvent);}
if(uLongTouch&&(lType==='touchmove'||lType==='pointermove')){if(uLongTouch.identifiant!==lEvent.identifiant||!_eventDansMargesLongTouch(lEvent)){_stopperLongTouch();}}
if(event.target&&(lType==='touchstart'||lType==='pointerdown')&&lEvent.estTouch){_demarrageLongTouch(event,lEvent);}
if(event.target&&uLongTouch&&(lType==='touchend'||lType==='pointerup')&&lEvent.estTouch){_finaliserLongTouch(event,lEvent);}
if(GNavigateur.touchEnScroll&&(lType==='touchend'||lType==='pointerup'||lType==='touchcancel'||lType==='pointercancel')){clearTimeout(uTouchTimerTouchEnScroll);uTouchTimerTouchEnScroll=setTimeout(function(){GNavigateur.touchEnScroll=false;},const_delaiTouch);}}
function specialAddTouch(aCallback ,type){if(!$.event.special[type])
$.event.special[type]={};var lOldAdd=$.event.special[type].add;$.event.special[type].add=function(handleObj){if(lOldAdd) lOldAdd(handleObj);var old_handler=handleObj.handler;handleObj.handler=function(event){aCallback(event);return old_handler.apply(this,arguments);};};}
IE.MethodesTableau.forEach(['touchstart','touchend','touchmove','touchcancel'],specialAddTouch.bind(null,_traiterTouch));var lEvents=[];if(IE.Support.supportTouchPointerEvent){lEvents=lEvents.concat(['pointerdown','pointerup','click','dblclick','pointermove']);}
else{lEvents=lEvents.concat(['mousedown','mouseup','click','dblclick','mousemove']);if(IE.Support.supportTouch){lEvents=lEvents.concat(['touchstart','touchend','touchmove','touchcancel']);}}
IE.MethodesTableau.parcourir(lEvents,function(aNom,aIndex){lEvents[aIndex]=aNom+'.'+const_namespace;});$(document).on(lEvents.join(' '),_handle);$(window).on('scroll',function(){if(uLongTouch){clearTimeout(uTouchTimerTouchEnScroll);_stopperLongTouch();}
if(GNavigateur.touchEnCours)
GNavigateur.touchEnScroll=true;});}
function _uniformisationEventIEChange(){var lListener=function(){$(this).trigger('IEChange');};var lDeferListener=function(){var lTimeout,lThis=this;if(!lTimeout){lTimeout=setTimeout(function(){$(lThis).trigger('IEChange');lTimeout=null;},0);}};var lJSelecteur=$('body'),lSelecteurCible='textarea, input';if(IE.Support.supportEventInput&&!GNavigateur.IsIE9){lJSelecteur.on('input',lSelecteurCible,lListener);}
else{lJSelecteur.on('keydown',lSelecteurCible,function(event){var key=event.keyCode;if(key===91||(15<key&&key<19)||(37<=key&&key<=40)) return;lDeferListener.call(this,event);});if(IE.Support.supportEventPaste){lJSelecteur.on('paste cut',lSelecteurCible,lDeferListener);}
lJSelecteur.on('change',lSelecteurCible,lListener);}}
_ObjetNavigateur.prototype.declarationEvenements=function(){try{window.onerror=this.SurError;document.onclick=this.SurClick;document.onkeydown=this.SurKeyDown;document.onkeyup=this.SurKeyUp;document.onkeypress=this.SurKeyPress;document.onmousemove=this.SurMouseMove;document.onmouseup=this.SurMouseUp;document.onmousedown=this.SurMouseDown;document.onselectstart=this.SurSelectStart;$(document).on('click dblclick mousedown mouseup mousemove '+'keydown keyup keypress '+'touchstart touchend touchcancel touchmove '+'pointerdown pointerup pointermove '+'contextmenu '+'iedown ieup ieclick iedblclick iemove ielongtouch',function(event){IE.Invocateur.evenement(GNavigateur.getEventInvocateur(event.type),event,this);});_verifierPresenceUtilisateur();var lEventMap={};if(this.SurResize){lEventMap.resize=this.SurResize;}
if(this.SurScroll){lEventMap.scroll=this.SurScroll;}
lEventMap.load=this.finChargementPage;lEventMap.unload=this._surUnload;lEventMap.beforeunload=this._surBeforeUnload;lEventMap.blur=this._surBlurFenetre;$(window).on(lEventMap,{instance:this});if(this.abonnementBlocageInterfaceGenerale){this.abonnementBlocageInterfaceGenerale('bloquer');}}
catch(ignore){}};}());;
function _ObjetPosition(){}
_ObjetPosition.prototype.getWidth=function(aId){var lElement=GHtml.getElement(aId);return GHtml.estElement(lElement)?lElement.offsetWidth:0;};_ObjetPosition.prototype.getHeight=function(aId){var lElement=GHtml.getElement(aId);return GHtml.estElement(lElement)?lElement.offsetHeight:0;};_ObjetPosition.prototype.getLeft=function(aId){var lLeft=0;try{GNavigateur.bloquerResize=true;var lElement=GHtml.getElement(aId);var lEstPopup=false;while(GHtml.estElement(lElement)&&!lEstPopup){lLeft+=lElement.offsetLeft-lElement.scrollLeft;lElement=lElement.offsetParent;}}
finally{GNavigateur.bloquerResize=false;}
return lLeft+document.body.scrollLeft;};_ObjetPosition.prototype.getTop=function(aId){var lTop=0;try{GNavigateur.bloquerResize=true;var lElement=GHtml.getElement(aId);while(GHtml.estElement(lElement)){lTop+=lElement.offsetTop-lElement.scrollTop;lElement=lElement.offsetParent;}}
finally{GNavigateur.bloquerResize=false;}
return lTop+document.body.scrollTop;};_ObjetPosition.prototype.setWidth=function(aId,aWidth,aAjuster,aFormat){try{if(aWidth===undefined){return;}
var lElement=GHtml.getElement(aId);if(!lElement||!lElement.style){return;}
var lWidthEnString=IE.MethodesObjet.isString(aWidth);aFormat=!aFormat&&!lWidthEnString?'px':aFormat;if(lWidthEnString&&aWidth==='auto'){lElement.style.width=aWidth;}
else{aWidth=Math.max(0,aWidth);lElement.style.width=aWidth+aFormat;}
if(aAjuster&&(aFormat==='px')&&GHtml.getDisplay(lElement)){var lWidth=this.getWidth(lElement);if(aWidth!==lWidth){lElement.style.width=Math.max(0,aWidth-(lWidth-aWidth))+aFormat;}}}catch(e){;}};_ObjetPosition.prototype.setHeight=function(aId,aHeight,aAjuster,aFormat){try{if(aHeight===undefined){return;}
var lElement=GHtml.getElement(aId);if(!lElement||!lElement.style){return;}
var lHeightEnString=IE.MethodesObjet.isString(aHeight);aFormat=!aFormat&&!lHeightEnString?'px':aFormat;if(lHeightEnString&&aHeight==='auto'){lElement.style.height=aHeight;}
else{aHeight=Math.max(0,aHeight);lElement.style.height=aHeight+aFormat;}
if(aAjuster&&(aFormat==='px')&&GHtml.getDisplay(lElement)){var lHeight=this.getHeight(lElement);if(aHeight!==lHeight){lElement.style.height=Math.max(0,aHeight-(lHeight-aHeight))+aFormat;}}} catch(e){;}};_ObjetPosition.prototype.setLeft=function(aId,aLeft,aAjuster,aFormat){aFormat=!aFormat?'px':aFormat;try{if(aLeft===undefined){return;}
var lElement=GHtml.getElement(aId);if(!lElement||!lElement.style){return;}
aLeft=isNaN(aLeft)?0:aLeft;lElement.style.left=aLeft+aFormat;if(aAjuster&&(aFormat==='px')&&GHtml.getDisplay(lElement)){var lLeft=this.getLeft(lElement);if(aLeft!==lLeft){lElement.style.left=aLeft-(lLeft-aLeft)+aFormat;}}} catch(e){;}};_ObjetPosition.prototype.setTop=function(aId,aTop,aAjuster,aFormat){aFormat=!aFormat?'px':aFormat;try{if(aTop===undefined){return;}
var lElement=GHtml.getElement(aId);if(!lElement||!lElement.style){return;}
aTop=isNaN(aTop)?0:aTop;lElement.style.top=aTop+aFormat;if(aAjuster&&(aFormat==='px')&&GHtml.getDisplay(lElement)){var lTop=this.getTop(lElement);if(aTop!==lTop){lElement.style.top=aTop-(lTop-aTop)+aFormat;}}} catch(e){;}};_ObjetPosition.prototype.setPosition=function(aId,aLeft,aTop,aAjuster,aFormat){this.setLeft(aId,aLeft,aAjuster,aFormat);this.setTop(aId,aTop,aAjuster,aFormat);};_ObjetPosition.prototype.centrer=function(aId,aIdPere,aClient){var lLeft,lTop,lWidth,lHeight;if(!aIdPere){lLeft=window.pageXOffset||0;lTop=window.pageYOffset||0;if(document.documentElement){lLeft=lLeft||document.documentElement.scrollLeft;lTop=lTop||document.documentElement.scrollTop;}
if(GNavigateur.isTactile&&window.innerHeight){lWidth=window.innerWidth;lHeight=window.innerHeight;}
else if(!aClient){lWidth=GNavigateur.EcranL;lHeight=GNavigateur.EcranH;}
else{lWidth=GNavigateur.ClientL;lHeight=GNavigateur.ClientH;}}
else{lLeft=this.getLeft(aIdPere);lTop=this.getTop(aIdPere);lWidth=this.getWidth(aIdPere);lHeight=this.getHeight(aIdPere);}
var lWidthId=this.getWidth(aId),lHeightId=this.getHeight(aId);if(lWidthId*lHeightId){this.setPosition(aId,Math.max(0,lLeft+(lWidth-lWidthId)/2),Math.max(0,lTop+(lHeight-lHeightId)/2),true);}};_ObjetPosition.prototype.setScrollTop=function(aId,aScrollTop){var E=GHtml.getElement(aId);if(E&&GHtml.estElement(E)){E.scrollTop=aScrollTop;}};_ObjetPosition.prototype.setTaille=function(aId,aWidth,aHeight,aFormat){this.setWidth(aId,aWidth,aFormat);this.setHeight(aId,aHeight,aFormat);};_ObjetPosition.prototype.positionDansZone=function(aPosition,aId){var X1=this.getLeft(aId);var X2=X1+this.getWidth(aId);var Y1=this.getTop(aId);var Y2=Y1+this.getHeight(aId);return aPosition&&(aPosition.x>X1)&&(aPosition.x<X2)&&(aPosition.y>Y1)&&(aPosition.y<Y2);};_ObjetPosition.prototype.getPositionEventJQuery=function(aEvent){if(!aEvent){;return{x:0,y:0};}
if(aEvent.pageX!==undefined){return{x:Math.round(aEvent.pageX),y:Math.round(aEvent.pageY)};}
if(aEvent.originalEvent&&aEvent.originalEvent.changedTouches&&aEvent.originalEvent.changedTouches[0]){return{x:aEvent.originalEvent.changedTouches[0].pageX||0,y:aEvent.originalEvent.changedTouches[0].pageY||0};}
;return{x:0,y:0};};;
MethodesObjet.heritagePrototype(ObjetPosition_Espace,_ObjetPosition);var GPosition=new ObjetPosition_Espace();function ObjetPosition_Espace(){}(function(){ObjetPosition_Espace.prototype.setBackgroundPosition=function(aId,aLeft,aTop,aFormat){aFormat=!aFormat?'px':aFormat;var lElement=GHtml.getElement(aId);if(lElement&&lElement.style){var lLeft=aLeft||0;var lTop=aTop||0;lElement.style.backgroundPosition=lLeft+aFormat+' '+lTop+aFormat;}};function _avecChevauchement(aPosition,aPositionSource){return(aPosition.x<(aPositionSource.x+aPositionSource.width))&&((aPosition.x+aPosition.width)>aPositionSource.x)&&(aPosition.y<(aPositionSource.y+aPositionSource.height))&&((aPosition.y+aPosition.height)>aPositionSource.y);}
function _getPositionElement(aElement){var lX=GPosition.getLeft(aElement),lY=GPosition.getTop(aElement),lWidth=GPosition.getWidth(aElement),lHeight=GPosition.getHeight(aElement);return{x:lX,y:lY,width:lWidth,height:lHeight};}
ObjetPosition_Espace.prototype.deplacerSiChevauchement=function(aIdMobile,aIdReference){var lPosition=_getPositionElement(aIdMobile),lPositionSource=_getPositionElement(aIdReference);if((lPosition.x+lPosition.width)>GNavigateur.EcranL){lPosition.x=GNavigateur.EcranL-lPosition.width;}
if((lPosition.y+lPosition.height)>GNavigateur.EcranH){lPosition.y=GNavigateur.EcranH-lPosition.height;}
if(_avecChevauchement(lPosition,lPositionSource)){lPosition.x=lPositionSource.x+lPositionSource.width+6;if(lPosition.x+lPosition.width>GNavigateur.EcranL){lPosition.x=Math.max(lPositionSource.x-lPosition.width,1);}}
if(lPosition.x+lPosition.width>GNavigateur.EcranL){lPosition.x=GNavigateur.EcranL-lPosition.width;}
if(lPosition.x<6){lPosition.x=6;}
if(_avecChevauchement(lPosition,lPositionSource)){lPosition.y=lPositionSource.y+lPositionSource.height+6;if(lPosition.y+lPosition.height>GNavigateur.EcranH){lPosition.y=Math.max(lPositionSource.y-lPosition.height,1);}}
if(lPosition.y+lPosition.height>GNavigateur.EcranH){lPosition.y=GNavigateur.EcranH-lPosition.height;}
this.setPosition(aIdMobile,Math.max(0,lPosition.x),Math.max(0,lPosition.y),true);};ObjetPosition_Espace.prototype.placerFiche=function(aId,aIdSource,aVisible){var lPositionSource=_getPositionElement(aIdSource);this.placerFicheSource(aId,lPositionSource.x,lPositionSource.x+lPositionSource.width,lPositionSource.y,lPositionSource.y+lPositionSource.height,aVisible);};ObjetPosition_Espace.prototype.placerFicheSource=function(aId,aX1Source,aX2Source,aY1Source,aY2Source,aVisible){var lVisible=aVisible===null||aVisible===undefined?GStyle.getVisible(aId):aVisible;var lPosition=_getPositionElement(aId),lPositionSource={x:aX1Source,y:aY1Source,width:aX2Source-aX1Source,height:aY2Source-aY1Source};if((lPosition.x+lPosition.width)>GNavigateur.EcranL){lPosition.x=GNavigateur.EcranL-lPosition.width;}
if((lPosition.y+lPosition.height)>GNavigateur.EcranH){lPosition.y=GNavigateur.EcranH-lPosition.height;}
if(!lVisible||_avecChevauchement(lPosition,lPositionSource)){lPosition.x=lPositionSource.x+lPositionSource.width+6;if(lPosition.x+lPosition.width>GNavigateur.EcranL){lPosition.x=Math.max(aX1Source-lPosition.width,1);}
if(!lVisible){lPosition.y=lPositionSource.y;if(lPosition.y+lPosition.height>GNavigateur.EcranH){lPosition.y=Math.max(lPositionSource.y+lPositionSource.height-lPosition.height,1);}}}
if(lPosition.x+lPosition.width>GNavigateur.EcranL){lPosition.x=GNavigateur.EcranL-lPosition.width;}
if(lPosition.y+lPosition.height>GNavigateur.EcranH){lPosition.y=GNavigateur.EcranH-lPosition.height;}
if(lPosition.x<10){lPosition.x=10;}
this.setPosition(aId,Math.max(0,lPosition.x),Math.max(0,lPosition.y),true);};ObjetPosition_Espace.prototype.placer=function(aId,aLeft,aTop,aEcartBordEcran){var lX1=MethodesObjet.isNumber(aLeft)?aLeft:GNavigateur.SourisX;var lX2=lX1+this.getWidth(aId);var lY1=MethodesObjet.isNumber(aTop)?aTop:GNavigateur.SourisY;var lY2=lY1+this.getHeight(aId);var lEcartBordEcran=$.extend({x:2,y:2},aEcartBordEcran);if(lX2+lEcartBordEcran.x>GNavigateur.EcranL){lX1=GNavigateur.EcranL-this.getWidth(aId)-lEcartBordEcran.x;}
if(lY2+lEcartBordEcran.y>GNavigateur.EcranH){lY1=GNavigateur.EcranH-this.getHeight(aId)-lEcartBordEcran.y;}
this.setPosition(aId,Math.max(lEcartBordEcran.x,lX1),Math.max(lEcartBordEcran.y,lY1),true);};ObjetPosition_Espace.prototype.sourisEstSurZone=function(aId){return this.positionDansZone({x:GNavigateur.SourisX,y:GNavigateur.SourisY},aId);};ObjetPosition_Espace.prototype.getScrollTop=function(aId){var E=GHtml.getElement(aId);return E?E.scrollTop:0;};ObjetPosition_Espace.prototype.setSelect=function(aId){try{var E=GHtml.getElement(aId);if(E){E.select();}}
catch(e){}};ObjetPosition_Espace.prototype.declencherResizeCommun=function(aIds,aModificateurs,aPourcentages){var lTabElements=[],i,lId,lElements,lModificateur,lPourcent,lTaille;for(i=0;i<aIds.length;i++){lId=aIds[i];lElements=this._getParentsDeTd(lId);if(lElements){if(GNavigateur.isTactile){GPosition.setHeight(lElements.td,100,false,'%');GPosition.setHeight(lElements.table,100,false,'%');GPosition.setHeight(lElements.div,100,false,'%');}
else{lTabElements.push(lElements);GPosition.setHeight(lElements.div,1);GPosition.setHeight(lElements.table,1);GPosition.setHeight(lElements.td,1);}}}
if(GNavigateur.isTactile){return;}
for(i=0;i<lTabElements.length;i++){lModificateur=aModificateurs&&aModificateurs[i]?aModificateurs[i]:0;lPourcent=aPourcentages&&aPourcentages[i]>0&&aPourcentages[i]<=100?aPourcentages[i]:100;lTaille=Math.max(0,GPosition.getHeight(GHtml.getParent(lTabElements[i].div))-GPosition.getHeight(lTabElements[i].table)+GPosition.getHeight(lTabElements[i].td)+lModificateur);lTabElements[i].height=lTaille*lPourcent/100;}
for(i=0;i<lTabElements.length;i++){GPosition.setHeight(lTabElements[i].td,lTabElements[i].height);lTabElements[i].div.style.height='auto';}};ObjetPosition_Espace.prototype.declencherResizeFreres=function(aIds,aModificateurs,aPourcentages){var lTabElements=[];var lTable=null;var lDiv=null,i,lId,lElements,lTaille,lModificateur,lPourcent;for(i=0;i<aIds.length;i++){lId=aIds[i];lElements=this._getParentsDeTd(lId);if(lElements){if(GNavigateur.isTactile){GPosition.setHeight(lElements.td,aPourcentages&&aPourcentages[i]?aPourcentages[i]:100,false,'%');GPosition.setHeight(lElements.table,100,false,'%');GPosition.setHeight(lElements.div,100,false,'%');}
else{lTabElements.push(lElements.td);if(i===0){lTable=lElements.table;lDiv=lElements.div;GPosition.setHeight(lElements.div,1);GPosition.setHeight(lElements.table,1);}
GPosition.setHeight(lElements.td,1);}}}
if(GNavigateur.isTactile){return;}
var lHeightTDs=0;for(i=0;i<lTabElements.length;i++){lHeightTDs+=GPosition.getHeight(lTabElements[i]);}
lTaille=GPosition.getHeight(GHtml.getParent(lDiv))-GPosition.getHeight(lTable)+lHeightTDs;for(i=0;i<lTabElements.length;i++){lModificateur=aModificateurs&&aModificateurs[i]?aModificateurs[i]:0;lPourcent=aPourcentages&&aPourcentages[i]>0&&aPourcentages[i]<=100?aPourcentages[i]:100;GPosition.setHeight(lTabElements[i],Math.max(0,lTaille*lPourcent/100+lModificateur));}
lDiv.style.height='auto';};ObjetPosition_Espace.prototype.declencherResize=function(aId,aModificateur,aForcerTailleEnTactile){var lModificateur=aModificateur||0;var lElement=GHtml.getElement(aId);if(!GHtml.elementExiste(lElement)){return;}
if(GHtml.estNoeudDeType(lElement,'td')){var lElements=this._getParentsDeTd(lElement);if(lElements){if(GNavigateur.isTactile&&!aForcerTailleEnTactile){GPosition.setHeight(lElements.td,100,false,'%');GPosition.setHeight(lElements.table,100,false,'%');GPosition.setHeight(lElements.div,100,false,'%');return;}
GPosition.setHeight(lElements.div,1);GPosition.setHeight(lElements.table,1);GPosition.setHeight(lElements.td,1);this._appliquerRetaillageTd(lElements.td,lElements.table,lElements.div,lModificateur);}}
else if(GHtml.estNoeudDeType(lElement,'div')){var lParentDiv=GHtml.getParent(lElement);if(GHtml.estNoeudDeType(lParentDiv,'div')){if(GNavigateur.isTactile&&!aForcerTailleEnTactile){GPosition.setHeight(lElement,100,false,'%');GPosition.setHeight(lParentDiv,100,false,'%');return;}
GPosition.setHeight(lParentDiv,0);GPosition.setHeight(lParentDiv,$(GHtml.getParent(lParentDiv)).height(),true);GPosition.setHeight(lElement,0);var lTailleTotale=$(lParentDiv).height();var lHauteurFils=0,i,lFils;for(i=0;i<lParentDiv.childNodes.length;i++){lFils=lParentDiv.childNodes[i];if(GHtml.elementExiste(lFils)&&(lFils.offsetWidth!==0)){lHauteurFils+=$(lFils).outerHeight();}}
GPosition.setHeight(lElement,Math.max(0,lTailleTotale-lHauteurFils+lModificateur));lParentDiv.style.height='auto';}}
else{GLog.addLog(aId+' : ni DIV ni TD');}};ObjetPosition_Espace.prototype._appliquerRetaillageTd=function(aTd,aTable,aDiv,aModificateur){var lHeightDiv=GPosition.getHeight(GHtml.getParent(aDiv));GPosition.setHeight(aTd,Math.max(0,lHeightDiv-GPosition.getHeight(aTable)+GPosition.getHeight(aTd)+aModificateur));aDiv.style.height='auto';};ObjetPosition_Espace.prototype._getParentsDeTd=function(aId){var lElement=GHtml.getElement(aId);if(GHtml.estNoeudDeType(lElement,'td')){var lTable=lElement;while((!lTable)||!GHtml.estNoeudDeType(lTable,'table')){lTable=GHtml.getParent(lTable);}
var lDiv=GHtml.getParent(lTable);if(GHtml.estNoeudDeType(lDiv,'div')){return{td:lElement,table:lTable,div:lDiv};}}
return null;};}());;
var ToucheClavier={};ToucheClavier.Backspace=8;ToucheClavier.Tab=9;ToucheClavier.RetourChariot=13;ToucheClavier.Espace=32;ToucheClavier.Shift=16;ToucheClavier.Ctrl=17;ToucheClavier.Alt=18;ToucheClavier.Windows=91;ToucheClavier.ContextMenu=93;ToucheClavier.Echap=27;ToucheClavier.FlecheGauche=37;ToucheClavier.FlecheDroite=39;ToucheClavier.FlecheHaut=38;ToucheClavier.FlecheBas=40;ToucheClavier.Inserer=45;ToucheClavier.Supprimer=46;ToucheClavier.Debut=36;ToucheClavier.Fin=35;ToucheClavier.PageHaut=33;ToucheClavier.PageBas=34;ToucheClavier._0=48;ToucheClavier._1=49;ToucheClavier._2=50;ToucheClavier._3=51;ToucheClavier._4=52;ToucheClavier._5=53;ToucheClavier._6=54;ToucheClavier._7=55;ToucheClavier._8=56;ToucheClavier._9=57;ToucheClavier.A=65;ToucheClavier.B=66;ToucheClavier.C=67;ToucheClavier.D=68;ToucheClavier.E=69;ToucheClavier.F=70;ToucheClavier.G=71;ToucheClavier.H=72;ToucheClavier.I=73;ToucheClavier.J=74;ToucheClavier.K=75;ToucheClavier.L=76;ToucheClavier.M=77;ToucheClavier.N=78;ToucheClavier.O=79;ToucheClavier.P=80;ToucheClavier.Q=81;ToucheClavier.R=82;ToucheClavier.S=83;ToucheClavier.T=84;ToucheClavier.U=85;ToucheClavier.V=86;ToucheClavier.W=87;ToucheClavier.X=88;ToucheClavier.Y=89;ToucheClavier.Z=90;ToucheClavier.AccoladeDroite=222;ToucheClavier.AccoladeGauche=220;ToucheClavier.Dollar=223;ToucheClavier.CrochetGauche=186;ToucheClavier.CrochetDroite=192;ToucheClavier.Circonflexe=221;ToucheClavier.PointInterrogation=219;ToucheClavier.VerrMaj=20;ToucheClavier.VerrNum=144;ToucheClavier.F1=115;ToucheClavier.F3=114;ToucheClavier.F2=113;ToucheClavier.F5=116;ToucheClavier.F6=117;ToucheClavier.F7=118;ToucheClavier.F8=119;ToucheClavier.F9=120;ToucheClavier.F10=121;ToucheClavier.F11=122;ToucheClavier.F12=123;ToucheClavier.ArretDefilement=145;ToucheClavier.Pause=19;ToucheClavier.Inferieur=226;ToucheClavier.Virgule=188;ToucheClavier.Tiret=189;ToucheClavier.Point=190;ToucheClavier.Section=191;ToucheClavier.NumpadPlus=107;ToucheClavier.NumpadMoins=109;ToucheClavier.NumpadSlash=111;ToucheClavier.NumpadStar=106;ToucheClavier.Numpad_0=96;ToucheClavier.Numpad_1=97;ToucheClavier.Numpad_2=98;ToucheClavier.Numpad_3=99;ToucheClavier.Numpad_4=100;ToucheClavier.Numpad_5=101;ToucheClavier.Numpad_6=102;ToucheClavier.Numpad_7=103;ToucheClavier.Numpad_8=104;ToucheClavier.Numpad_9=105;ToucheClavier.NumpadPoint=110;;
var EGenreBoutonSouris={Gauche:0,Droite:1};var EGenreFiltreCaractere={Tous:0,Decimal:1,Hexa:2,Date:3,Note:4};MethodesObjet.heritagePrototype(ObjetNavigateur_Espace,_ObjetNavigateur);function ObjetNavigateur_Espace(){this.inheritedCreate();this.AvecSelection=true;this.NbrBlocages=0;this.OrdreTabulation=[];this.ListeTouchesSpeciales=[ToucheClavier.Backspace,ToucheClavier.Tab,ToucheClavier.Shift,24,ToucheClavier.Echap,ToucheClavier.Fin,ToucheClavier.Debut,ToucheClavier.FlecheGauche,ToucheClavier.FlecheHaut,ToucheClavier.FlecheDroite,ToucheClavier.FlecheBas,ToucheClavier.Supprimer];this.filtreCaractere=EGenreFiltreCaractere.Tous;this.chargementTermine=false;}
ObjetNavigateur_Espace.prototype.AddEvent=function(AGenre,APere,AEvenement){if(!this.chargementTermine){return;}
if(!AEvenement||!APere){return;}
if(!this.OnEvent[AGenre]){this.OnEvent[AGenre]=[];}
this.OnEvent[AGenre].push({evenement:AEvenement,pere:APere});};ObjetNavigateur_Espace.prototype.DelEvent=function(AGenre,APere){var LNom=APere.Nom;var LArrayEvent=this.OnEvent[AGenre];if(!LArrayEvent){GLog.addLog('DelEvent sur un element non ajouté ! APere = '+APere.Nom,null,EGenreLog.Erreur);return;}
var i=0;while(i<LArrayEvent.length){if(LArrayEvent[i].pere.Nom===LNom){this.OnEvent[AGenre].splice(i,1);} else{i++;}}};ObjetNavigateur_Espace.prototype.DeclencherEvenements=function(AGenre,aInverse){var LContinuer,I,lEvent;if(aInverse){if(this.OnEvent[AGenre]){for(I=this.OnEvent[AGenre].length-1;I>=0;I--){lEvent=this.OnEvent[AGenre][I];LContinuer=!lEvent.evenement.call(lEvent.pere)&&(LContinuer!==false);}}}
else{for(I=0;this.OnEvent[AGenre]&&(I<this.OnEvent[AGenre].length);I++){lEvent=this.OnEvent[AGenre][I];LContinuer=!lEvent.evenement.call(lEvent.pere)&&(LContinuer!==false);}}
return LContinuer;};ObjetNavigateur_Espace.prototype.getEvenement=function(aEvenement){return aEvenement||window.event;};ObjetNavigateur_Espace.prototype.StopperEvenement=function(AEvenement){AEvenement=this.getEvenement(AEvenement);AEvenement.cancelBubble=true;if(AEvenement.stopPropagation){AEvenement.stopPropagation();}};ObjetNavigateur_Espace.prototype.bloquerValeurEvenement=function(aEvenement){aEvenement=this.getEvenement(aEvenement);if(aEvenement.preventDefault){aEvenement.preventDefault();}
else{aEvenement.returnValue=false;}};ObjetNavigateur_Espace.prototype.restaurerAvecSelection=function(){this.AvecSelection=this.avecSelectionPourRestauration;};ObjetNavigateur_Espace.prototype.OuvrirFenetre=function(ATitre,APage){var LParametres='resizable=no, location=no, width=800, height=600, menubar=yes, status=no, scrollbars=yes';var W=window.open('',ATitre,LParametres);W.document.write(APage);W.document.close();W.focus();return W;};ObjetNavigateur_Espace.prototype.accepteRetourChariotHint=function(){return this.IsIE||this.IsWebKit;};ObjetNavigateur_Espace.prototype.IsToucheEspace=function(){return(this.CodeTouche===ToucheClavier.Espace)&&!this.ShiftTouche;};ObjetNavigateur_Espace.prototype.IsToucheRetourChariot=function(){return(this.CodeTouche===ToucheClavier.RetourChariot)&&!this.ShiftTouche&&!this.AltTouche&&!this.CtrlTouche;};ObjetNavigateur_Espace.prototype.IsToucheSelection=function(){return(this.IsToucheRetourChariot()||this.IsToucheEspace());};ObjetNavigateur_Espace.prototype.IsToucheMenuContextuel=function(){return(this.CodeTouche===ToucheClavier.RetourChariot)&&!this.ShiftTouche&&(this.AltTouche||this.CtrlTouche);};ObjetNavigateur_Espace.prototype.IsToucheEdition=function(){return(this.CodeTouche===ToucheClavier.RetourChariot)&&this.ShiftTouche&&!this.AltTouche&&!this.CtrlTouche;};ObjetNavigateur_Espace.prototype.IsToucheSupprimer=function(){return((this.CodeTouche===46)&&!this.ShiftTouche&&!this.AltTouche&&!this.CtrlTouche)||((this.CodeTouche===ToucheClavier.Backspace)&&this.CmdTouche);};ObjetNavigateur_Espace.prototype.IsToucheEchap=function(){return this.CodeTouche===ToucheClavier.Echap;};ObjetNavigateur_Espace.prototype.IsToucheFlecheHaut=function(){return this.CodeTouche===ToucheClavier.FlecheHaut;};ObjetNavigateur_Espace.prototype.IsToucheFlecheBas=function(){return this.CodeTouche===ToucheClavier.FlecheBas;};ObjetNavigateur_Espace.prototype.IsToucheFlecheGauche=function(){return this.CodeTouche===ToucheClavier.FlecheGauche;};ObjetNavigateur_Espace.prototype.IsToucheFlecheDroite=function(){return this.CodeTouche===ToucheClavier.FlecheDroite;};ObjetNavigateur_Espace.prototype.IsToucheFleche=function(){return(this.IsToucheFlecheHaut()||this.IsToucheFlecheBas()||this.IsToucheFlecheGauche()||this.IsToucheFlecheDroite());};ObjetNavigateur_Espace.prototype.IsToucheTab=function(){return this.CodeTouche===ToucheClavier.Tab;};ObjetNavigateur_Espace.prototype.IsToucheShiftTab=function(){return this.CodeTouche===ToucheClavier.Tab&&this.ShiftTouche;};ObjetNavigateur_Espace.prototype.IsToucheOnlyTab=function(){return this.CodeTouche===ToucheClavier.Tab&&!this.ShiftTouche;};ObjetNavigateur_Espace.prototype.IsToucheDebug=function(){return(this.CodeTouche===188)&&(this.CtrlTouche);};ObjetNavigateur_Espace.prototype.IsToucheOnglets=function(){return(this.CodeTouche===66)&&(this.AltTouche||this.CtrlTouche);};ObjetNavigateur_Espace.prototype.IsToucheAide=function(){return(this.CodeTouche===112)&&!this.ShiftTouche&&!this.AltTouche&&!this.CtrlTouche;};ObjetNavigateur_Espace.prototype.IsToucheActualisation=function(){return(this.CodeTouche===116)&&!this.ShiftTouche&&!this.AltTouche;};ObjetNavigateur_Espace.prototype.IsToucheBackspace=function(){return(this.CodeTouche===ToucheClavier.Backspace)&&!this.ShiftTouche&&!this.AltTouche&&!this.CtrlTouche;};ObjetNavigateur_Espace.prototype.GetToucheAltNum=function(ADeb,AFin){var LCodeTouche;if(this.CodeTouche>=ToucheClavier.Numpad_0){LCodeTouche=this.CodeTouche-ToucheClavier.Numpad_0;return this.altPrecedent&&!this.shiftPrecedent&&(LCodeTouche>=ADeb)&&(LCodeTouche<=AFin)?LCodeTouche:null;}
LCodeTouche=this.CodeTouche-ToucheClavier._0;return this.altPrecedent&&this.shiftPrecedent&&(LCodeTouche>=ADeb)&&(LCodeTouche<=AFin)?LCodeTouche:null;};ObjetNavigateur_Espace.prototype.EstToucheSpeciale=function(){var I;for(I=0;I<this.ListeTouchesSpeciales.length;I++){if(this.ListeTouchesSpeciales[I]===this.CodeTouche){return true;}}
return false;};ObjetNavigateur_Espace.prototype.estCaractereDecimal=function(){return GNavigateur.estCaractere('0-9');};ObjetNavigateur_Espace.prototype.estCaractereHexa=function(){return GNavigateur.estCaractere('0-9abcdefABCDEF');};ObjetNavigateur_Espace.prototype.estCaractereDate=function(){return GNavigateur.estCaractere('0-9');};ObjetNavigateur_Espace.prototype.estCaractereNumeroTelephone=function(){return GNavigateur.estCaractereDecimal()||GNavigateur.IsToucheEspace();};ObjetNavigateur_Espace.prototype.estCaractereNumeroTelephoneIndicatif=function(){return GNavigateur.estCaractereDecimal()||GNavigateur.IsToucheEspace()||GNavigateur.estCaractere('+');};ObjetNavigateur_Espace.prototype.estCaractereNote=function(aAvecLettre,aAvecVirgule,aAvecMoins,aCaractereAnnotation){aAvecLettre=aAvecLettre===null||aAvecLettre===undefined?true:aAvecLettre;aAvecVirgule=aAvecVirgule===null||aAvecVirgule===undefined?true:aAvecVirgule;aAvecMoins=aAvecMoins===null||aAvecMoins===undefined?true:aAvecMoins;aCaractereAnnotation=aCaractereAnnotation===null||aCaractereAnnotation===undefined?GTraductions.getValeur('TypeNote.CaractereAnnotation'):aCaractereAnnotation;var lRegExp='0-9';if(aAvecLettre){var lCarAnnot='';for(var x in aCaractereAnnotation){if(aCaractereAnnotation[x].toLowerCase&&aCaractereAnnotation[x]!==' ') lCarAnnot+=aCaractereAnnotation[x].toLowerCase();}
lRegExp+=lCarAnnot+lCarAnnot.toUpperCase();}
if(aAvecVirgule){lRegExp+='.,';}
if(aAvecMoins){lRegExp+='-';}
return GNavigateur.estCaractere(lRegExp);};ObjetNavigateur_Espace.prototype.estCaractereAlphaNumerique=function(){return!this.AltTouche&&!this.CtrlTouche&&(new RegExp('[0-9.a-z.A-Z]').test(this.CaractereTouche));};ObjetNavigateur_Espace.prototype.estCaractere=function(aRegExp){return(GNavigateur.CaractereTouche==='')||new RegExp('['+aRegExp+']').test(this.CaractereTouche);};ObjetNavigateur_Espace.prototype.setFiltreCaractere=function(aFiltreCaractere){this.filtreCaractere=aFiltreCaractere;};ObjetNavigateur_Espace.prototype.estSourisBoutonGauche=function(){return(this.BoutonSouris===EGenreBoutonSouris.Gauche);};ObjetNavigateur_Espace.prototype.estSourisBoutonDroit=function(){return(this.BoutonSouris===EGenreBoutonSouris.Droite);};ObjetNavigateur_Espace.prototype.SurError=function(AMessage,AUrl,ALigne){GLog.addLog('ObjetNavigateur.SurError : '+AMessage+'; '+AUrl+'; Ligne : '+ALigne,'ERROR',EGenreLog.Erreur);GNavigateur.DeclencherEvenements(EEvent.SurError);};ObjetNavigateur_Espace.prototype.SurResize=function(e){var lNavigateur=e?e.data.instance:this;if(lNavigateur.isTactile){return;}
if(lNavigateur.bloquerResize){return;}
lNavigateur.retailler(true);if(lNavigateur.EnResize){window.clearTimeout(lNavigateur.TimerResize);}
else{lNavigateur.EnResize=true;lNavigateur.DeclencherEvenements(EEvent.SurPreResize);}
lNavigateur.DeclencherEvenements(EEvent.SurResize);lNavigateur.TimerResize=window.setTimeout(lNavigateur.SurPostResize.bind(lNavigateur,e),300);};ObjetNavigateur_Espace.prototype.SurPostResize=function(e){if(GNavigateur.isTactile){return;}
if(GNavigateur.IsIE){$(window).unbind('resize');}
try{GNavigateur.ActualiserTailleEcran();GNavigateur.DeclencherEvenements(EEvent.SurPostResize);GNavigateur.DeclencherEvenements(EEvent.SurFinResize);GNavigateur.ActualiserTailleEcran();GNavigateur.retailler();}
finally{GNavigateur.EnResize=false;if(GNavigateur.IsIE){$(window).bind('resize',{instance:GNavigateur},GNavigateur.SurResize);}}};ObjetNavigateur_Espace.prototype.SurClick=function(e){GNavigateur.DeclencherEvenements(EEvent.SurClick);};ObjetNavigateur_Espace.prototype.SurScroll=function(event){event.data.instance.DeclencherEvenements(EEvent.SurScroll);};ObjetNavigateur_Espace.prototype.SurKeyDown=function(e){GNavigateur.SetCodeTouche(e);GNavigateur.CaractereTouche='';if(GNavigateur.IsToucheDebug()){Invocateur.evenement(Invocateur.events.toucheDEBUG);}
return GNavigateur.DeclencherEvenements(EEvent.SurKeyDown);};ObjetNavigateur_Espace.prototype.SurKeyUp=function(e){GNavigateur.altPrecedent=GNavigateur.AltTouche;GNavigateur.shiftPrecedent=GNavigateur.ShiftTouche;GNavigateur.ShiftTouche=null;GNavigateur.AltTouche=null;GNavigateur.CtrlTouche=null;GNavigateur.CmdTouche=null;GNavigateur.DeclencherEvenements(EEvent.SurKeyUp);};ObjetNavigateur_Espace.prototype.SurKeyPress=function(e){GNavigateur.SetCaractereTouche(e);if(GNavigateur.filtreCaractere!==EGenreFiltreCaractere.Tous){if((GNavigateur.filtreCaractere===EGenreFiltreCaractere.Decimal)&&!GNavigateur.estCaractereDecimal()){return false;}
if((GNavigateur.filtreCaractere===EGenreFiltreCaractere.Hexa)&&!GNavigateur.estCaractereHexa()){return false;}
if((GNavigateur.filtreCaractere===EGenreFiltreCaractere.Date)&&!GNavigateur.estCaractereDate()){return false;}
if((GNavigateur.filtreCaractere===EGenreFiltreCaractere.Note)&&!GNavigateur.estCaractereNote()){return false;}}
return GNavigateur.DeclencherEvenements(EEvent.SurKeyPress);};ObjetNavigateur_Espace.prototype.SurMouseMove=function(e){if(e){GNavigateur.SourisX=e.pageX;GNavigateur.SourisY=e.pageY;}
else if(document.body&&document.documentElement){GNavigateur.SourisX=window.event.clientX+Math.max(document.body.scrollLeft,document.documentElement.scrollLeft);GNavigateur.SourisY=window.event.clientY+Math.max(document.body.scrollTop,document.documentElement.scrollTop);}
GNavigateur.EnDeplacement();GNavigateur.DeclencherEvenements(EEvent.SurMouseMove);};ObjetNavigateur_Espace.prototype.getBoutonSouris=function(e){if(e){switch(e.button){case 0:return EGenreBoutonSouris.Gauche;case 2:return EGenreBoutonSouris.Droite;}}
else{switch(window.event.button){case 1:return EGenreBoutonSouris.Gauche;case 2:return EGenreBoutonSouris.Droite;}}};ObjetNavigateur_Espace.prototype.SurMouseDown=function(e){GNavigateur.SourisBouton=true;GNavigateur.BoutonSouris=GNavigateur.getBoutonSouris(e);GNavigateur.DeclencherEvenements(EEvent.SurMouseDown);};ObjetNavigateur_Espace.prototype.SurMouseUp=function(e){GNavigateur.SourisBouton=false;GNavigateur.FinDeplacement();GNavigateur.DeclencherEvenements(EEvent.SurMouseUp);};ObjetNavigateur_Espace.prototype.SurSelectStart=function(e){GNavigateur.DeclencherEvenements(EEvent.SurSelectStart);};ObjetNavigateur_Espace.prototype.positionnerMenuContextuelSurId=function(aId,aDeltaX,aDeltaY){var lElement=document.getElementById(aId);if(lElement){GNavigateur.SourisX=aDeltaX?GPosition.getLeft(lElement)+aDeltaX:GPosition.getLeft(lElement) ;GNavigateur.SourisY=aDeltaY?GPosition.getTop(lElement)+aDeltaY:GPosition.getTop(lElement);}};ObjetNavigateur_Espace.prototype.isShiftTouche=function(e){return e&&e.shiftKey;};ObjetNavigateur_Espace.prototype.isAltTouche=function(e){return e&&e.altKey;};ObjetNavigateur_Espace.prototype.isCtrlTouche=function(e){return e&&e.ctrlKey;};ObjetNavigateur_Espace.prototype.isCmdTouche=function(e){return e&&e.metaKey;};ObjetNavigateur_Espace.prototype.SetCodeTouche=function(e){e=e||window.event;this.CodeTouche=e.keyCode;this.ShiftTouche=e.shiftKey;this.AltTouche=e.altKey;this.CtrlTouche=e.ctrlKey;this.CmdTouche=e.metaKey;};ObjetNavigateur_Espace.prototype.SetCaractereTouche=function(e){e=e||window.event;this.CaractereTouche=e.charCode===0?'':String.fromCharCode(e.charCode||e.keyCode);};ObjetNavigateur_Espace.prototype.DebDeplacement=function(APere,AId){this._idDeplacement=AId;this.Deplacement=true;this.DecalageX=this.SourisX-GPosition.getLeft(this._idDeplacement);this.DecalageY=this.SourisY-GPosition.getTop(this._idDeplacement);};ObjetNavigateur_Espace.prototype.EnDeplacement=function(){if(this.Deplacement){GPosition.placer(this._idDeplacement,this.SourisX-this.DecalageX,this.SourisY-this.DecalageY);}};ObjetNavigateur_Espace.prototype.FinDeplacement=function(){if(this.Deplacement){this.Deplacement=false;GNavigateur.DeclencherEvenements(EEvent.SurFinDeplacement);delete this._idDeplacement;}};ObjetNavigateur_Espace.prototype.GetLargeurBarreDeScroll=function(){return 11+2;};ObjetNavigateur_Espace.prototype.retailler=function(aPreResize){this.retaillerDivBloquant(aPreResize);};ObjetNavigateur_Espace.prototype.retaillerDivBloquant=function(aPreResize){if(this._interfaceBloquee){if(aPreResize){GPosition.setTaille('bloquer',0,0);}
else{if(!this.IsGecko){GPosition.setTaille('bloquer',GNavigateur.EcranL,GNavigateur.EcranH);}
else{GPosition.setTaille('bloquer',$(document).width(),$(document).height());}}}};(function(){var lPileZIndex={};var lMaxZIndex= -1;var lZIndexBlocage=1000;function _ajoutDansPile(aId,aPourPremierPlan,aPourBlocageInterface){if(lPileZIndex[aId]){lPileZIndex[aId].pourPremierPlan=lPileZIndex[aId].pourPremierPlan||aPourPremierPlan;lPileZIndex[aId].pourBlocageInterface=lPileZIndex[aId].pourBlocageInterface||aPourBlocageInterface;}
else{var lElement=GHtml.getElement(aId);var lZindex=GStyle.getZindex(aId);if(lZindex||aPourBlocageInterface){lPileZIndex[aId]={element:lElement,zIndexOrigine:lZindex,zIndex:lZindex,pourPremierPlan:aPourPremierPlan,pourBlocageInterface:aPourBlocageInterface,compteurBlocage:0};lMaxZIndex=Math.max(lMaxZIndex,lZindex);}}}
function _setZIndex(aId,zIndex){if(!lPileZIndex[aId]){return;}
lPileZIndex[aId].zIndex=zIndex;GStyle.setZindex(aId,zIndex);}
ObjetNavigateur_Espace.prototype.BloquerInterface=function(ABloquer,AGenreCurseur,aAvecVoileOpaque){_notifierAbonnesBlocageInterface.call(this,ABloquer,aAvecVoileOpaque,AGenreCurseur,true);};ObjetNavigateur_Espace.prototype.BloquerInterfaceAvecCompteur=function(ABloquer,AGenreCurseur,aAvecVoileOpaque){if(!ABloquer&&(this.NbrBlocages===0)){return;}
this.NbrBlocages=Math.max(0,this.NbrBlocages+(ABloquer?1:-1));_notifierAbonnesBlocageInterface.call(this,ABloquer,aAvecVoileOpaque,AGenreCurseur);};ObjetNavigateur_Espace.prototype.estInterfaceBloque=function(){return this.NbrBlocages>0;};function _notifierAbonnesBlocageInterface(aBloquer,aAvecVoileOpaque,aGenreCurseur,aForcerDeblocage){var lId,lElement;for(lId in lPileZIndex){if(lPileZIndex[lId]&&lPileZIndex[lId].pourBlocageInterface){lElement=lPileZIndex[lId];if(!aBloquer&&aForcerDeblocage){lElement.compteurBlocage=0;if(lElement.methode){lElement.methode(aBloquer,aAvecVoileOpaque,aGenreCurseur);}
else{_setZIndex(lId,lElement.zIndexOrigine);}}
else{lElement.compteurBlocage=Math.max(0,lElement.compteurBlocage+(aBloquer?1:-1));if((aBloquer&&(lElement.compteurBlocage===1))||(aBloquer&&!lElement.avecVoile&&aAvecVoileOpaque!==false)||(!aBloquer&&(lElement.compteurBlocage===0))){if(lElement.methode){if(aBloquer){lElement.avecVoile=aAvecVoileOpaque;}
lElement.methode(aBloquer,aAvecVoileOpaque,aGenreCurseur);}
else{if(aBloquer){lElement.estBloque=true;if(lElement.zIndex>lZIndexBlocage-10){_setZIndex(lId,lZIndexBlocage-10);}}
else{delete lElement.estBloque;_setZIndex(lId,lElement.zIndexOrigine);}}}}}}}
ObjetNavigateur_Espace.prototype.abonnementBlocageInterfaceGenerale=function(aId){function _bloquerInterfaceGenerale(ABloquer,aAvecVoileOpaque,AGenreCurseur){var lElement=GHtml.getElement('bloquer');if(!lElement){return;}
if(ABloquer){var lAvecVoileOpaque=aAvecVoileOpaque===null||aAvecVoileOpaque===undefined?true:aAvecVoileOpaque;GHtml.setClass(lElement,'BloquerInterface NePasImprimer'+(lAvecVoileOpaque?' VoileOpaque':''));}
if(!lElement.oncontextmenu){lElement.oncontextmenu=function(){return false;};}
this._interfaceBloquee=ABloquer;GStyle.setDisplay(lElement,ABloquer);this.retaillerDivBloquant(true);if(ABloquer){this.retaillerDivBloquant();}
if((AGenreCurseur!==null&&AGenreCurseur!==undefined)){GStyle.setCurseur(lElement,AGenreCurseur);}}
lPileZIndex[aId]={pourPremierPlan:false,pourBlocageInterface:true,compteurBlocage:0,methode:_bloquerInterfaceGenerale.bind(this)};};ObjetNavigateur_Espace.prototype.abonnementBlocageInterface=function(aId){_ajoutDansPile(aId,false,true);};ObjetNavigateur_Espace.prototype.desabonnementBlocageInterface=function(aId){if(lPileZIndex[aId]&&lPileZIndex[aId].pourBlocageInterface){GStyle.setZindex(aId,lPileZIndex[aId].zIndex);if(!lPileZIndex[aId].pourPremierPlan){delete lPileZIndex[aId];}
else{lPileZIndex[aId].estBloque=false;lPileZIndex[aId].pourBlocageInterface=false;}}};ObjetNavigateur_Espace.prototype.abonnementPremierPlan=function(aId){_ajoutDansPile(aId,true,false);};ObjetNavigateur_Espace.prototype.desabonnementPremierPlan=function(aId){var lId;if(lPileZIndex[aId]){if(lPileZIndex[aId].zIndex>=lMaxZIndex){lMaxZIndex= -1;for(lId in lPileZIndex){if(lPileZIndex[lId]&&lPileZIndex[lId].pourPremierPlan&&(lId!==aId)){lMaxZIndex=Math.max(lMaxZIndex,lPileZIndex[lId].zIndex);}}}
_setZIndex(aId,lPileZIndex[aId].zIndexOrigine);if(!lPileZIndex[aId].pourBlocageInterface){delete lPileZIndex[aId];}
else{lPileZIndex[aId].pourPremierPlan=false;}}};ObjetNavigateur_Espace.prototype.EnPremierPlan=function(AIdPremierPlan){if(!lPileZIndex[AIdPremierPlan]){return;}
var lId,lElement;for(lId in lPileZIndex){lElement=lPileZIndex[lId];if(lElement&&lElement.pourPremierPlan){if(!GHtml.elementExiste(lId)){GLog.addLog('Erreur ObjetNavigateur_Espace.prototype.EnPremierPlan : element supprimé sans etre desabonné',null,EGenreLog.Erreur);this.desabonnementPremierPlan(lId);}
else if(!lElement.estBloque){if(lId===AIdPremierPlan){_setZIndex(lId,lMaxZIndex+1);}
else if(lPileZIndex[lId].compteurBlocage===0)
_setZIndex(lId,lElement.zIndexOrigine);}}}};})();ObjetNavigateur_Espace.prototype.getJqFocusable=function(aIdContext){;return $('#'+aIdContext.escapeJQ()).find('a[href], link[href], button, input[type!="hidden"], select, textarea, menuitem, *[draggable], *[tabindex][tabindex!="-1"]').filter(':visible');};ObjetNavigateur_Espace.prototype.setUrl=function(aUrl){window.location.href=aUrl;};ObjetNavigateur_Espace.prototype.getHost=function(){return window.location.href.slice(0,window.location.href.lastIndexOf('/')+1);};var GNavigateur=new ObjetNavigateur_Espace();GNavigateur.declarationEvenements();;
var EGenreAction={Valider:0,NePasValider:1,Annuler:2};;
var EGenreBoiteMessage={Information:0,Confirmation:1,MrFiche:2};;

$.fn.inputDisabled=function(aValue){var $this=$(this);if(aValue===undefined){return $this.is(':disabled');}
else{if(aValue){$this.attr('disabled',true);}
else{$this.removeAttr('disabled');}
$this.trigger('IEDisabled');return $this;}};;
$.fn.inputChecked=function(aValue){var $this=$(this);if(aValue===undefined){return $this.is(':checked');}
$this.prop('checked',aValue);$this.trigger('IEChecked');return $this;};$.fn.cbIndeterminate=function(aValue){var $this=$(this);if(aValue===undefined){var lValeur=false;try{lValeur=$this.is(':indeterminate');}
catch(e){lValeur=!!this.indeterminate;}
return lValeur;}
$this.prop('indeterminate',aValue);$this.trigger('IECBIndeterminate');return $this;};;

IE.HTML=(function(){var uBalises={},uAttributs={},lNodeNames=[],lGUIDControleur1=1,lGUIDControleur2=1,lGUIDCollectionIdentite=1,c_nomEventInjectionHTML='eventIEHTML_displayHTML',C_id_event_iemodel='ie-model_verification',C_RegExp_Match=/^\/(.*)\/([gim]*)$/,lOutils,uInvocateur=new IEClasses.Invocateur();function _initControleur(aControleur){if(!aControleur.$GUID){aControleur.$GUID=lGUIDControleur1+'_'+lGUIDControleur2;if(lGUIDControleur1===Number.MAX_VALUE){lGUIDControleur1=1;lGUIDControleur2+=1;}
else{lGUIDControleur1+=1;}}
if(!aControleur.$refreshSelf){aControleur.$refreshSelf=function(){if(this.instance&&(this.instance.__enCoursDeDestruction||this.instance._estDetruite))
return;if(this.$timeoutRefresh!==false){if(this.$timerRefreshSelf){clearTimeout(this.$timerRefreshSelf);this.$timerRefreshSelf=null;}
var lInvocateur=this.$invocateur;this.$timerRefreshSelf=setTimeout(function(){lInvocateur.evenement(C_id_event_iemodel);},0);}
else{this.$invocateur.evenement(C_id_event_iemodel);}
return this;};}
if(!aControleur.$refresh){aControleur.$refresh=function(aHashCibles){if(this.$timeoutRefresh!==false){if(this.$timerRefresh){clearTimeout(this.$timerRefresh);this.$timerRefresh=null;}
this.$timerRefresh=setTimeout(function(){uInvocateur.evenement(C_id_event_iemodel,this.$GUID,aHashCibles);},0);}
else{uInvocateur.evenement(C_id_event_iemodel,this.$GUID,aHashCibles);}
return this;};}
if(!aControleur.$invocateur){aControleur.$invocateur=new IEClasses.Invocateur();}
return aControleur;}
function _transfererFragmentDansHTML(aNodesFragment,aParent,aInsererAvantLeNode){var lTab=_sliceNodes(aNodesFragment);for(var i=0;i<lTab.length;i++){if(aInsererAvantLeNode)
aParent.insertBefore(lTab[i],aInsererAvantLeNode);else aParent.appendChild(lTab[i]);}
var lNode=lTab[0];if(_estNoeudCommentaire(lNode)&&lTab[1])
lNode=lTab[1];return lNode;}
function _sliceNodes(aNodes){var lResult;try{lResult=aNodes?Array.prototype.slice.call(aNodes):[];}catch(e){var i;lResult=[];for(i=0;i<aNodes.length;i++){lResult.push(aNodes[i]);}}
return lResult;}
function _finaliserInjectionHTML(aElementParent,aControleur,aIgnorerScroll){var lParentDocument=false,lElement=aElementParent,lParent;while(!lParentDocument&&lElement){lParent=null;if(lElement.nodeType===1){if(lElement.parentElement){lParent=lElement.parentElement;}
else if(lElement.parentNode){lParent=lElement.parentNode;}}
lElement=lParent;lParentDocument=lElement===document;}
if(lParentDocument){if(aIgnorerScroll!==true){var lOverflow=$(aElementParent).css('overflow');if(lOverflow==='auto'||lOverflow==='scroll'){aElementParent.scrollLeft=0;aElementParent.scrollTop=0;}
lOverflow=null;}
IE.Invocateur.evenement(IE.Invocateur.events.modificationHTML);if(aControleur){aControleur.$invocateur.evenement(c_nomEventInjectionHTML);}}}
function _injectHTML(aParametres){var lSafe=_createSafeFragment(document),lNodeParent,lChilds,lNode;try{lNodeParent=lSafe.appendChild(document.createElement("div"));if(aParametres.html&&aParametres.html.nodeType>0){var lDiv=document.createElement('div');lNodeParent.appendChild(lDiv);lDiv.appendChild(aParametres.html);}
else{lNodeParent.innerHTML='<div>'+aParametres.html+'</div>';}
lNodeParent=lNodeParent.firstChild;lChilds=lNodeParent.childNodes;_compile(lChilds,aParametres.element,aParametres.controleur,aParametres.contexte||{},aParametres.invocateur,0);lNode=_transfererFragmentDansHTML(lChilds,aParametres.element,aParametres.insererAvantLeNode);}
finally{lChilds=null;lNodeParent=null;lSafe=null;_finaliserInjectionHTML(aParametres.element,aParametres.controleur,aParametres.ignorerScroll);}
return lNode;}
function _estAccesseurIEHTML(aChaine){return!!aChaine&&aChaine.length&&aChaine.length>4&&aChaine.charAt(0)==='{'&&aChaine.charAt(1)==='{'&&aChaine.charAt(aChaine.length-1)==='}'&&aChaine.charAt(aChaine.length-2)==='}';}
function _hasAttribute(aNode,aNomAttribute){if(aNode.hasAttribute)
return aNode.hasAttribute(aNomAttribute);else{var lNode=aNode.getAttributeNode(aNomAttribute);return!!(lNode&&(lNode.specified||lNode.nodeValue));}}
function _remplirDataModel(aContexteCourant){var lModele=aContexteCourant.node.getAttribute('ie-model');if(!lModele){return null;}
var lModeleArg=_parseValueEvent(lModele,aContexteCourant.contexte);if(lModeleArg&&lModeleArg.nom){aContexteCourant.data.$modeleParsed=lModeleArg;aContexteCourant.data.$modeleValue=lModele;}}
function _getModel(aContexteCourant){_remplirDataModel(aContexteCourant);var lModele=aContexteCourant.data.$modeleValue;if(!lModele){return null;}
if(_hasAttribute(aContexteCourant.node,'ie-model')){aContexteCourant.node.removeAttribute('ie-model');lOutils.addCommentaireDebug(aContexteCourant.node,'ie-model="'+lModele+'"');}
var lDelay=aContexteCourant.node.getAttribute('ie-model-delay');if(!lDelay){lDelay= -1;if(_hasAttribute(aContexteCourant.node,'ie-model-delay')){lDelay=0;}}
else{lDelay=parseInt(lDelay,10)||0;}
if(lDelay!== -1){aContexteCourant.data.$modeleDelay={delay:lDelay};var lTimeout=null;aContexteCourant.contexte.refresh=function(){if(lTimeout){clearTimeout(lTimeout);lTimeout=null;}
lTimeout=setTimeout(function(){aContexteCourant.controleur.$refresh();},lDelay);};var lTimeoutSelf=null;aContexteCourant.contexte.refreshSelf=function(){if(lTimeoutSelf){clearTimeout(lTimeoutSelf);lTimeoutSelf=null;}
lTimeoutSelf=setTimeout(function(){aContexteCourant.controleur.$refreshSelf();},lDelay);};aContexteCourant.node.removeAttribute('ie-model-delay');lOutils.addCommentaireDebug(aContexteCourant.node,'ie-model-delay="'+lDelay+'"');}
return lModele;}
function _getControleSaisieEvent(aContexteCourant){if(!aContexteCourant.node.hasAttribute('ie-controlesaisie')){return false;}
aContexteCourant.$controleSaisie=!!IE.controleSaisieSurEvenement;;aContexteCourant.node.removeAttribute('ie-controlesaisie');lOutils.addCommentaireDebug(aContexteCourant.node,'ie-controleSaisie');return true;}
function _creerInstanceIdentite(aClass,aParametresIdentite){var lGUID=lGUIDCollectionIdentite;lGUIDCollectionIdentite+=1;aParametresIdentite.nomComplet='IE.HTML.collectionIdentite['+lGUID+']';var lInstance=new aClass(aParametresIdentite);IE.HTML.collectionIdentite[lGUID]=lInstance;return{instance:lInstance,callbackDestruction:function(){delete IE.HTML.collectionIdentite[lGUID];}};}
function _createSafeFragment(document){var list=IE.MethodesObjet.dupliquer(lNodeNames),safeFrag=document.createDocumentFragment();if(safeFrag.createElement){while(list.length){safeFrag.createElement(list.pop());}}
return safeFrag;}
function _callbackRefresh(aControleur,aData,aCallback ,aGuidEmetteur,aHashGuidCible){if(aHashGuidCible&&aControleur&&!aHashGuidCible[aControleur.$GUID]){return;}
if(aControleur&&aControleur.$off&&aControleur.$off()){return;}
aCallback(aGuidEmetteur,aHashGuidCible);}
function _abonnerRefresh(aCallback,aElementPourDestruction,aContexteCourant,aCallbackDestroy){var lCallbacks=[],lAjouterAbonnement=true,lId,lIdSelf;if(!aElementPourDestruction){;return;}
if(aContexteCourant.data){if(!aContexteCourant.data.$callbacksRefresh){aContexteCourant.data.$callbacksRefresh=[];}
else{lAjouterAbonnement=false;}
lCallbacks=aContexteCourant.data.$callbacksRefresh;}
lCallbacks.push(function(){_callbackRefresh.call(this,aContexteCourant.controleur,aContexteCourant.data,aCallback);});if(lAjouterAbonnement){var lInvocateur=aContexteCourant.invocateur?aContexteCourant.invocateur:uInvocateur;lId=lInvocateur.abonner(C_id_event_iemodel,function(aGuidEmetteur,aHashGuidCible){if(aContexteCourant.controleur&&aContexteCourant.controleur.instance&&(aContexteCourant.controleur.instance.__enCoursDeDestruction||aContexteCourant.controleur.instance._estDetruite))
return;var i,lNb=lCallbacks.length;for(i=0;i<lNb;i++){lCallbacks[i](aGuidEmetteur,aHashGuidCible);}},null,false);if(!aContexteCourant.invocateur)
lIdSelf=aContexteCourant.controleur.$invocateur.abonner(C_id_event_iemodel,function(){if(aContexteCourant.controleur&&aContexteCourant.controleur.instance&&(aContexteCourant.controleur.instance.__enCoursDeDestruction||aContexteCourant.controleur.instance._estDetruite))
return;var i,lNb=lCallbacks.length;for(i=0;i<lNb;i++){lCallbacks[i]();}},null,false);$(aElementPourDestruction).bind('destroyed',function(){lInvocateur.desabonner([lId]);if(!aContexteCourant.invocateur)
aContexteCourant.controleur.$invocateur.desabonner([lIdSelf]);if(aContexteCourant.data){aContexteCourant.data.$destroy=true;}
if(aCallbackDestroy){aCallbackDestroy();}});}}
function _getAccesParametres(aNomEnChaine,aContexteCourant,aAccepteErreur){var lParsed=null,lResult={valide:false,estFonction:false,nom:aNomEnChaine,args:[]};if(aNomEnChaine&&(!aContexteCourant.data||!aContexteCourant.data.$modeleParsed)){lParsed=_parseValueEvent(aNomEnChaine,aContexteCourant.contexte,aAccepteErreur);if(!lParsed){;return lResult;}
aNomEnChaine=lParsed.nom;}
if(aContexteCourant.data&&aContexteCourant.data.$modeleParsed){lParsed=aContexteCourant.data.$modeleParsed;if(aContexteCourant.data.$modeleParsed.nom){aNomEnChaine=lParsed.nom+(aNomEnChaine?'.'+aNomEnChaine:'');}}
var lArgs=lResult.args=lParsed?lParsed.args:[];if(!aContexteCourant.controleur||!aNomEnChaine){;return lResult;}
var lAncreControleur=aContexteCourant.controleur;var lTab=aNomEnChaine.split('.');var lNom=lTab.pop();lAncreControleur=IE.MethodesObjet.get(aContexteCourant.controleur,lTab);if(lAncreControleur&&lAncreControleur[lNom]!==undefined&&IE.MethodesObjet.isFunction(lAncreControleur[lNom])){var lArgsCallback=lArgs||[],lIx,lAvecArgsBoucleREPEAT=false,lArray;for(lIx=0;lIx<lArgsCallback.length;lIx++){if(lArgsCallback[lIx]&&lArgsCallback[lIx].getterArray){lAvecArgsBoucleREPEAT=true;break;}}
lResult.valide=true;lResult.controleur=aContexteCourant.controleur;lResult.getAncre=function(){return IE.MethodesObjet.get(aContexteCourant.controleur,lTab);};lResult.callback=function(aTabArguments){var lAncre=IE.MethodesObjet.get(aContexteCourant.controleur,lTab);if(!lAncre||!lAncre[lNom]||!lAncre[lNom].apply){;return'';}
var lArgs=lArgsCallback,lArgCallback;if(lAvecArgsBoucleREPEAT){lArgs=new Array(lArgsCallback.length);for(var lIx=0,lLength=lArgsCallback.length;lIx<lLength;lIx++){lArgCallback=lArgsCallback[lIx];if(lArgCallback&&lArgCallback.getterArray){lArray=lArgCallback.getterArray();lArgs[lIx]={indice:lArgCallback.indice,element:lArray[lArgCallback.indice],tableau:lArray,arguments:lArgCallback.arguments};}
else{lArgs[lIx]=lArgsCallback[lIx];}}}
return lAncre[lNom].apply(aContexteCourant,aTabArguments&&aTabArguments.length>0?lArgs.concat(aTabArguments):lArgs);};lResult.estFonction=true;lResult.nom=lNom;return lResult;}
lResult.valide=!!IE.MethodesObjet.get(aContexteCourant.controleur.instance,lTab);lResult.getAncre=function(){return IE.MethodesObjet.get(aContexteCourant.controleur.instance,lTab);};lResult.getAncreControleur=lAncreControleur&&lAncreControleur[lNom]!==undefined?function(){return IE.MethodesObjet.get(aContexteCourant.controleur,lTab);}:null;lResult.callback=function(){var lAncre=IE.MethodesObjet.get(aContexteCourant.controleur.instance,lTab);if(!lAncre){;return'';}
return lAncre[lNom];};lResult.estFonction=false;lResult.nom=lNom;return lResult;}
function _addCommentaireDebug(aNode,aCommentaire){}
function _estNoeudCommentaire(aNode){return!!aNode&&aNode.nodeType===8;}
function _getContexteCourant(aControleur,aContexte,aNode,aData,aInvocateur){return{controleur:aControleur,instance:aControleur?aControleur.instance:null,contexte:aContexte,data:aData,node:aNode,invocateur:aInvocateur};}
function _getAttributesDeNode(aNode){if(window.GNavigateur&&(GNavigateur.IsIE8)){var j,lLength,attr,lAttrsTemp=aNode.attributes,lAttributes=[];for(j=0,lLength=lAttrsTemp&&lAttrsTemp.length;j<lLength;j++){attr=lAttrsTemp[j];if(attr.specified){lAttributes.push(attr);}}
lAttrsTemp=null;return lAttributes;}
else{return _sliceNodes(aNode.attributes);}}
function _getMapDeNode(aNode){var lMap={},lName;for(var attr,nAttrs=_getAttributesDeNode(aNode),j=0,jj=nAttrs&&nAttrs.length;j<jj;j++){attr=nAttrs[j];if(attr.name){lName=attr.name.toLowerCase();if(!window.GNavigateur||!GNavigateur.IsIE8||!lName.startsWith('jquery'))
lMap[lName]=attr.value;}}
return lMap;}
lOutils={parseValueEvent:_parseValueEvent,getModel:_getModel,nomEventInjectionHTML:c_nomEventInjectionHTML,creerInstanceIdentite:_creerInstanceIdentite,abonnerRefresh:_abonnerRefresh,getAccesParametres:_getAccesParametres,hasAttribute:_hasAttribute,injectHTML:_injectHTML,getContexteCourant:_getContexteCourant,getControleSaisieEvent:_getControleSaisieEvent,getAttributesDeNode:_getAttributesDeNode,getMapDeNode:_getMapDeNode,gererInputCB:_gererInputCB,addCommentaireDebug:_addCommentaireDebug,composantsAttributs:uAttributs,caret:_caret};function _parseArg(aArg,aEstChaine,aContexte){if(aEstChaine){return aArg;}
if(aContexte&&aContexte.repeat&&aContexte.repeat[aArg]){return aContexte.repeat[aArg];}
if(aArg==='null'){return null;}
if(aArg==='undefined'){return undefined;}
if(aArg==='true'){return true;}
if(aArg==='false'){return false;}
var lNumber=parseInt(aArg,10);if(isNaN(lNumber)){lNumber=null;throw'erreur _parseArg';}
return lNumber;}
function _parseValueEvent(aValue,aContexte,aSortieEnErreur){if(!aValue){return null;}
var lResult={nom:'',args:[]},lIPars=null,lEtat='rech_fonction',lChar,lNomFonction='',lArg='',LArgEstChaine=false,lLength=aValue.length,lSepDebut='(',lSepFin=')';try{for(lIPars=0;lIPars<lLength;lIPars++){lChar=aValue.charAt(lIPars);switch(lEtat){case'rech_fonction':if(lChar===lSepDebut||lIPars===lLength-1){lEtat='rech_param';if(lIPars===aValue.length-1){lNomFonction+=lChar;}
lResult.nom=lNomFonction.trim();if(lResult.nom.length===0){return null;}
lArg='';}
else{lNomFonction+=lChar;}
break;case'rech_param':if(lChar===lSepFin){if(lIPars<lLength-1){if(aValue.charAt(lIPars+1)!==';')
throw'erreur fermeture fonction';}
lArg=lArg.trim();if(LArgEstChaine||lArg.length>0||lResult.args.length>0){lResult.args.push(_parseArg(lArg,LArgEstChaine,aContexte));}
lEtat='fin';break;}
if(lChar===','){lResult.args.push(_parseArg(lArg.trim(),LArgEstChaine,aContexte));lArg='';LArgEstChaine=false;}
else if(lChar==='\''){if(lArg.trim().length>0){;}
lArg='';lEtat='rech_chaine';}
else{lArg+=lChar;}
break;case'rech_chaine':if(lChar==='\''){lEtat='rech_param';LArgEstChaine=true;break;}
lArg+=lChar;break;case'fin':if(lChar!==';')
throw'erreur fin fonction';break;default:throw'cas non géré';}}} catch(e){;if(aSortieEnErreur)
return false;}
return lResult;}
function _positionnerObjetSelonAccesseur(aChaineAccesseur,aObjet){if(!aObjet){return null;}
var lTab=aChaineAccesseur.split('.'),lResult=aObjet,i;for(i=0;i<lTab.length;i++){lResult=lResult[lTab[i]];if(!lResult){return null;}}
return lResult;}
function _caret(aElement,begin,end){var range;if(!aElement){return;}
if(typeof begin==='number'){end=(typeof end==='number')?end:begin;var lValue=aElement.value;begin=Math.min(begin,lValue.length);end=Math.min(end,lValue.length);if(aElement.setSelectionRange){aElement.setSelectionRange(begin,end);} else if(aElement.createTextRange){range=aElement.createTextRange();range.collapse(true);range.moveEnd('character',end);range.moveStart('character',begin);range.select();}} else{if(aElement.setSelectionRange){begin=aElement.selectionStart;end=aElement.selectionEnd;} else if(document.selection&&document.selection.createRange){range=document.selection.createRange();begin=0-range.duplicate().moveStart('character',-100000);end=begin+range.text.length;}
return{begin:begin,end:end};}}
function _verificationInputModel(aContexteCourant,aParametres,aPatternValidateRegex){if(aParametres.data.$ignoreRefresh){return;}
var lValue=aParametres.getterValue(),lValueInput;if(aParametres.saveValues.value!==lValue){if(aParametres.estCB){aParametres.eventActif=false;$(aParametres.node).inputChecked(lValue);aParametres.eventActif=true;aParametres.saveValues.value=aParametres.saveValues.inputValue=lValue;}
else{aParametres.eventActif=false;lValueInput=lValue;if(aParametres.toDisplay)
lValueInput=aParametres.toDisplay(lValueInput);aParametres.node.value=lValueInput;aParametres.eventActif=true;if(aPatternValidateRegex){var lAncreControleur=_positionnerObjetSelonAccesseur(aParametres.data.$modeleParsed.nom,aParametres.controleur);if(lAncreControleur){aContexteCourant.$patternOK=aPatternValidateRegex(lValue);}}
aParametres.saveValues.value=lValue;aParametres.saveValues.inputValue=lValueInput;}}
else if(aParametres.toDisplay){lValueInput=aParametres.toDisplay(lValue);if(aParametres.saveValues.inputValue!==lValueInput){aParametres.eventActif=false;aParametres.node.value=lValueInput;aParametres.eventActif=true;}}
if(aParametres.getterDisabled){lValue=aParametres.getterDisabled();if(lValue!==aParametres.saveDisabled){$(aParametres.node).inputDisabled(lValue);aParametres.saveDisabled=lValue;}}
if(aParametres.getterReadOnly){lValue=!!aParametres.getterReadOnly();if(lValue!==aParametres.saveReadOnly){$(aParametres.node).prop('readonly',lValue);aParametres.saveReadOnly=lValue;}}}
function _affecterGetterSetterInputModel(aParametres,aContexteCourant,aEstCB){var lInfosGetValue,lInfosSetValue,lInfosGetDisabled,lInfosGetReadOnly,lInfosGetSetModele,lInfosExitChange,lValue,lAncre;lInfosGetValue=_getAccesParametres('getValue',aContexteCourant);lInfosGetSetModele=_getAccesParametres('',aContexteCourant);if(lInfosGetValue.estFonction){aParametres.getterValue=function(){var lValue=lInfosGetValue.callback([aParametres.node]);if(aEstCB){return!!lValue;}
return lValue===undefined||lValue===null?'':lValue.toString();};}
else{lAncre=lInfosGetSetModele.getAncre();if(!lInfosGetSetModele.valide||!lAncre){;return false;}
lValue=lAncre[lInfosGetSetModele.nom];if(lValue){if(aEstCB&&lValue!==true){;return false;}
if(!aEstCB&&!IE.MethodesObjet.isString(lAncre[lInfosGetSetModele.nom])){;return false;}}
aParametres.getterValue=function(){var lValue=lInfosGetSetModele.callback();if(aEstCB){return!!lValue;}
return lValue===undefined||lValue===null?'':lValue.toString();};}
lInfosSetValue=_getAccesParametres('setValue',aContexteCourant);if(lInfosSetValue.estFonction){aParametres.setterValue=function(aValue,aParametresSetter){return lInfosSetValue.callback([aValue,aParametresSetter]);};}
else{lAncre=lInfosGetSetModele.getAncre();if(!lInfosGetSetModele.valide||!lAncre){;return false;}
aParametres.setterValue=function(aValue){var lAncre=lInfosGetSetModele.getAncre();if(!lAncre){;return;}
lAncre[lInfosGetSetModele.nom]=aValue;};}
lInfosGetDisabled=_getAccesParametres('getDisabled',aContexteCourant);if(lInfosGetDisabled.estFonction){aParametres.getterDisabled=lInfosGetDisabled.callback.bind(null,[aParametres.node,aContexteCourant.data]);}
lInfosGetReadOnly=_getAccesParametres('getReadOnly',aContexteCourant);if(lInfosGetReadOnly.estFonction){aParametres.getterReadOnly=lInfosGetReadOnly.callback.bind(null,[aParametres.node,aContexteCourant.data]);}
lInfosExitChange=_getAccesParametres('exitChange',aContexteCourant);if(lInfosExitChange.estFonction){aParametres.infosExitChange=lInfosExitChange;}
return true;}
function _positionPremierCarChange(aChaine,aChaineCompare){if(!aChaine) return 0;for(var i=0,lNb=aChaine.length;i<lNb;i++){if(i>=aChaineCompare.length)
return i;if(aChaine.charAt(i)!==aChaineCompare.charAt(i))
return i;}}
function _gererInputModele(aContexteCourant,aJNode,aEstCB,aAttributType,aMaxLength){var lModele=null,lMask,lMatchMask,lPattern,lMatchPattern,lPatternValidateRegex,lSaveValues={},lTrim=true,lAvecAttrNoTrim=false,lValue=aEstCB?false:'',lDisabled=false,lReadOnly=false,lInfosToDisplay=null,lInfosFromDisplay=null,lEstTexteBrut=false,lRefresh=aContexteCourant.contexte.refresh,lParametres={node:aContexteCourant.node,controleur:aContexteCourant.controleur,data:aContexteCourant.data,estCB:aEstCB,saveValues:lSaveValues,eventActif:true,saveDisabled:false,getterValue:null,setterValue:null,getterDisabled:null,getterReadOnly:null,toDisplay:null,fromDisplay:null};if(_hasAttribute(aContexteCourant.node,'ie-etatsaisie')){aContexteCourant.etatSaisie=true;aContexteCourant.node.removeAttribute('ie-etatsaisie');lOutils.addCommentaireDebug(aContexteCourant.node,'ie-etatsaisie');}
if(aContexteCourant.controleur){lModele=_getModel(aContexteCourant);if(lModele){$.extend(lParametres,{modele:lModele,modeleArg:aContexteCourant.data.$modeleParsed});if(!_affecterGetterSetterInputModel(lParametres,aContexteCourant,aEstCB)){return;}
lValue=lParametres.getterValue();if(lParametres.getterDisabled){lDisabled=lParametres.saveDisabled=!!lParametres.getterDisabled();aJNode.inputDisabled(lDisabled);}
if(lParametres.getterReadOnly){lReadOnly=lParametres.saveReadOnly=!!lParametres.getterReadOnly();aJNode.prop('readonly',lReadOnly);}
if(aEstCB){lValue=!!lValue;lSaveValues.value=lSaveValues.inputValue=lValue;aJNode.inputChecked(lValue);}
else{lValue=lValue||'';lSaveValues.value=lSaveValues.inputValue=lValue;lAvecAttrNoTrim=_hasAttribute(aContexteCourant.node,'ie-noTrim');lTrim=aAttributType!=='password'&&!lAvecAttrNoTrim;if(lAvecAttrNoTrim){lOutils.addCommentaireDebug(aContexteCourant.node,'ie-noTrim');aContexteCourant.node.removeAttribute('ie-noTrim');}
if(aContexteCourant.estTelephone||aContexteCourant.estIndicatifTelephone||aAttributType==='password'||aAttributType==='email'){lEstTexteBrut=true;}
else if(_hasAttribute(aContexteCourant.node,'ie-textbrut')){lEstTexteBrut=true;aContexteCourant.node.removeAttribute('ie-textbrut');lOutils.addCommentaireDebug(aContexteCourant.node,'ie-textbrut');}
lInfosToDisplay=_getAccesParametres('toDisplay',aContexteCourant);lInfosFromDisplay=_getAccesParametres('fromDisplay',aContexteCourant);lParametres.toDisplay=function(aChaine){if(!lEstTexteBrut)
aChaine=GChaine.enleverEntites(aChaine);if(aContexteCourant.estIndicatifTelephone)
aChaine='+ '+aChaine.replace(IE.HTML.REGEXP_INDICATIF_TELEPHONE,'').slice(0,IE.HTML.TAILLEMAX_INDICATIF_TELEPHONE);if(aContexteCourant.estTelephone&&window.GChaine&&GChaine.formatTelephone)
aChaine=GChaine.formatTelephone(aChaine.replace(IE.HTML.REGEXP_TELEPHONE,'').slice(0,IE.HTML.TAILLEMAX_TELEPHONE));if(lInfosToDisplay&&lInfosToDisplay.estFonction)
aChaine=lInfosToDisplay.callback([aChaine,aContexteCourant.data]);return aChaine;};lParametres.fromDisplay=function(aChaine){if(lInfosFromDisplay&&lInfosFromDisplay.estFonction)
aChaine=lInfosFromDisplay.callback([aChaine,aContexteCourant.data]);if(!lEstTexteBrut)
aChaine=GChaine.ajouterEntites(aChaine);if(lTrim&&aChaine.trim)
aChaine=aChaine.trim();if(aContexteCourant.estIndicatifTelephone)
aChaine=aChaine.replace(/\+| /g,'').replace(IE.HTML.REGEXP_INDICATIF_TELEPHONE,'').slice(0,IE.HTML.TAILLEMAX_INDICATIF_TELEPHONE);if(aContexteCourant.estTelephone)
aChaine=aChaine.replace(/ /g,'').replace(IE.HTML.REGEXP_TELEPHONE,'').slice(0,IE.HTML.TAILLEMAX_TELEPHONE);return aChaine;};lValue=lSaveValues.inputValue=lParametres.toDisplay(lValue);aContexteCourant.node.value=lValue;lPattern=aContexteCourant.node.getAttribute('ie-pattern');lMatchPattern=lPattern&&lPattern.match?lPattern.match(C_RegExp_Match):null;if(lMatchPattern){var lRegExp=new RegExp(lMatchPattern[1],lMatchPattern[2]);lPatternValidateRegex=function(value){return!value||lRegExp.test(value);};aContexteCourant.$patternOK=lPatternValidateRegex(lSaveValues.inputValue);}
if(lPattern){lOutils.addCommentaireDebug(aContexteCourant.node,'ie-pattern="'+lPattern+'"');aContexteCourant.node.removeAttribute('ie-pattern');}}}}
if(!aEstCB){if(aContexteCourant.estIndicatifTelephone){lMask=IE.HTML.REGEXP_INDICATIF_TELEPHONE;}
else if(aContexteCourant.estTelephone){lMask=IE.HTML.REGEXP_TELEPHONE;}
else{lMask=aContexteCourant.node.getAttribute('ie-mask');if(lMask){lOutils.addCommentaireDebug(aContexteCourant.node,'ie-mask="'+lMask+'"');aContexteCourant.node.removeAttribute('ie-mask');}}
if(lMask&&!lModele){lSaveValues.value=aContexteCourant.node.value;}
lMatchMask=lMask&&lMask.match?lMask.match(C_RegExp_Match):null;}
if(lModele){_abonnerRefresh(function(){_verificationInputModel(aContexteCourant,lParametres,lPatternValidateRegex);},aContexteCourant.node,aContexteCourant);}
if(lModele||(!aEstCB&&(lMatchMask||aMaxLength))){aJNode.on(aEstCB?'IEChecked change input':'input change paste cut keydown keyup',function(aEvent){if(!lParametres.eventActif){return;}
var lNewValue=null,lNewInputValue=null,lValueInput;if(aEstCB){lNewValue=$(this).is(':checked');}
else{lValueInput=this.value;lNewValue=lValueInput;lNewInputValue=lNewValue;if(lParametres.fromDisplay){lNewValue=lParametres.fromDisplay(lNewValue);}
if(lParametres.toDisplay){lNewInputValue=lParametres.toDisplay(lNewValue);if((lTrim&&lNewInputValue.trim()!==lValueInput.trim())||(!lTrim&&lNewInputValue!==lValueInput)){var lCaret=null;if(aContexteCourant.estTelephone){lCaret=_caret(this);if(lValueInput.length<lSaveValues.inputValue.length){lCaret.begin=Math.min(lCaret.begin,_positionPremierCarChange(lValueInput,lSaveValues.inputValue));lCaret.change=true;}
else{if(lNewInputValue.length<lSaveValues.inputValue.length){lCaret.begin-=lValueInput.length-lNewInputValue.length+1;}
if(lNewInputValue===lSaveValues.inputValue){lCaret.begin-=lValueInput.length-lNewInputValue.length;}
else if(lNewInputValue.charAt(lCaret.begin-1)===' ')
lCaret.begin+=1;lCaret.change=true;}}
this.value=lNewInputValue;if(lCaret&&lCaret.change){_caret(this,lCaret.begin);}}}
if(aMaxLength>0&&lNewValue.length>aMaxLength){var lTop=$(this).scrollTop();this.value=lNewValue.slice(0,aMaxLength);$(this).scrollTop(lTop);return false;}
if(lMatchMask&&lNewValue.length>0&&new RegExp(lMatchMask[1],lMatchMask[2]).test(lNewValue)){if(lParametres.toDisplay)
this.value=lParametres.toDisplay(lSaveValues.value);else this.value=lSaveValues.value;return false;}}
if(lSaveValues.value!==lNewValue){var lPatternOK,lCloneSave;if(lModele){lPatternOK=true;if(lPatternValidateRegex){lPatternOK=lPatternValidateRegex(lNewValue);aContexteCourant.$patternOK=lPatternOK;}
lCloneSave=IE.MethodesObjet.dupliquer(lSaveValues);}
lSaveValues.value=lNewValue;lSaveValues.inputValue=lNewInputValue;if(aContexteCourant.etatSaisie){IE.Invocateur.evenement(IE.Invocateur.events.etatSaisie,true);}
if(lModele){if(lParametres.setterValue){lParametres.setterValue(lNewValue,{node:this,event:aEvent,value:lNewValue,inputValue:lNewInputValue,textBrut:lEstTexteBrut,oldValues:lCloneSave,patternOK:lPatternOK});}
aContexteCourant.data.$ignoreRefresh=true;try{lRefresh();}finally{delete aContexteCourant.data.$ignoreRefresh;}
if(aContexteCourant.data.$destroy===true){return;}
_verificationInputModel(aContexteCourant,lParametres);}}});}
if(lParametres.infosExitChange){var lValueCourante=lParametres.getterValue();aJNode.on('change blur',function(){if(lValueCourante!==lParametres.getterValue()){lParametres.infosExitChange.callback([lSaveValues.value,aContexteCourant.node,aContexteCourant.data]);_verificationInputModel(aContexteCourant,lParametres,lPatternValidateRegex);lValueCourante=lSaveValues.value;lRefresh();}});}}
function _gererInputCB(aContexteCourant,aAttributType){_gererInputModele(aContexteCourant,$(aContexteCourant.node),true,aAttributType);}
function _gererMaxLengthInputText(aContexteCourant,aNode,aJNode,aEstInput,aAttributType){var lAttrMaxLength=aNode.getAttribute('maxlength'),lMaxLength=0;if(aEstInput){if(aContexteCourant.estIndicatifTelephone||aContexteCourant.estTelephone){return;}
if(IE.HTML.MAX_LENGTH_Default===0){return;}
if(!lAttrMaxLength&&(aAttributType==='text'||aAttributType===''||aAttributType==='number'||aAttributType==='email'||aAttributType==='url')){aJNode.attr('maxlength',IE.HTML.MAX_LENGTH_Default);}
else if(parseInt(lAttrMaxLength,10)===0){aNode.removeAttribute('maxlength');}}
else{lMaxLength=lAttrMaxLength?parseInt(lAttrMaxLength,10):IE.HTML.MAX_LENGTH_Default;if(isNaN(lMaxLength)){lMaxLength=IE.HTML.MAX_LENGTH_Default;}
if(lMaxLength>0){lOutils.addCommentaireDebug(aNode,'maxlength:'+lMaxLength);}
if(lAttrMaxLength){aNode.removeAttribute('maxlength');}}
return lMaxLength;}
function _gererInputText(aContexteCourant,aEstInput,aAttributType){var lJNode=$(aContexteCourant.node);if(aEstInput&&_hasAttribute(aContexteCourant.node,'ie-indicatiftel')){aContexteCourant.estIndicatifTelephone=true;lJNode.addClass('ie-indicatiftel');lOutils.addCommentaireDebug(aContexteCourant.node,'ie-indicatiftel');aContexteCourant.node.removeAttribute('ie-indicatiftel');}
else if(aEstInput&&_hasAttribute(aContexteCourant.node,'ie-telephone')){aContexteCourant.estTelephone=true;lJNode.addClass('ie-telephone');lOutils.addCommentaireDebug(aContexteCourant.node,'ie-telephone');aContexteCourant.node.removeAttribute('ie-telephone');}
var lMaxLength=_gererMaxLengthInputText(aContexteCourant,aContexteCourant.node,lJNode,aEstInput,aAttributType);_gererInputModele(aContexteCourant,lJNode,false,aAttributType,lMaxLength);lJNode=null;}
function _getDataDeNode(aNode){var lNodeValue=aNode.getAttribute('ie-data'),lData=null;if(lNodeValue&&lNodeValue.length>2&&lNodeValue.charAt(0)==='{'&&lNodeValue.charAt(lNodeValue.length-1)==='}'){try{lData=IE.ObjetJSON.parse(lNodeValue,{ignorerEntites:true});} catch(e){lData=null;}}
return lData;}
function _traiterIF(aNode,aNodeParent,aControleur,aContexte,aData){var lValueAttr=aNode.getAttribute('ie-if');aNode.removeAttribute('ie-if');if(!lValueAttr){return true;}
if(!aControleur){return true;}
var lContexteCourant=_getContexteCourant(aControleur,aContexte,aNode,aData);_remplirDataModel(lContexteCourant);var lInfos=_getAccesParametres(lValueAttr,lContexteCourant),lValue=!!lInfos.callback(),lOldValue=lValue,lChaineData='ie-if',lNodeComm=document.createComment(lChaineData),lCloneModele=aNode.cloneNode(true);aNode.parentNode.insertBefore(lNodeComm,aNode);var lInvocateur=new IEClasses.Invocateur();_abonnerRefresh(function(aGuidEmetteur,aHashGuidCible){var lValue=!!lInfos.callback();if(lOldValue!==lValue){if(lValue){var lDiv=document.createElement('div');lDiv.appendChild(lCloneModele.cloneNode(true));_compile(lDiv.childNodes,aNodeParent,aControleur,aContexte,lInvocateur,0);_transfererFragmentDansHTML(lDiv.childNodes,aNodeParent,lNodeComm.nextSibling);_finaliserInjectionHTML(aNodeParent,aControleur);lDiv=null;}
else{while(lNodeComm.nextSibling&&_estNoeudCommentaire(lNodeComm.nextSibling))
aNodeParent.removeChild(lNodeComm.nextSibling);$.cleanData(lNodeComm.nextSibling.getElementsByTagName("*"));aNodeParent.removeChild(lNodeComm.nextSibling);}
lOldValue=lValue;}
else{lInvocateur.evenement(C_id_event_iemodel,aGuidEmetteur,aHashGuidCible);}},aNodeParent,lContexteCourant);if(!lValue){$(aNode).remove();}
return lValue;}
function _addNodeDeREPEAT(aNodeParent,aControleur,aCloneModele,aNomVariableBoucle,aIndice,aInfosAcces,aNodeComm,aContexte,aArrayNodes,aInvocateur){var lNodeAvant;lNodeAvant=aNodeComm;if(aIndice>0){lNodeAvant=aArrayNodes[aIndice-1];}
if(!aContexte.repeat){aContexte.repeat={};}
var lContexte=$.extend({},aContexte),lContexteBoucles={};lContexteBoucles[aNomVariableBoucle]={indice:aIndice,arguments:aInfosAcces.args,getterArray:function(){return aInfosAcces.callback()||[];}};lContexte.repeat=$.extend(lContexteBoucles,aContexte.repeat);var lDiv=document.createElement('div');lDiv.appendChild(aCloneModele.cloneNode(true));_compile(lDiv.childNodes,aNodeParent,aControleur,lContexte,aInvocateur,0);aArrayNodes[aIndice]=_transfererFragmentDansHTML(lDiv.childNodes,aNodeParent,lNodeAvant.nextSibling);lDiv=null;}
function _traiterREPEAT(aNode,aNodeParent,aControleur,aContexte,aData){var lValueAttr=aNode.getAttribute('ie-repeat');aNode.removeAttribute('ie-repeat');if(!lValueAttr){return true;}
if(!aControleur){return true;}
var lTab=lValueAttr.split('in');if(lTab.length!==2){return true;}
lValueAttr=lTab[1].trim();var lNomVariableBoucle=lTab[0].trim();if(!aContexte.repeat){aContexte.repeat={};}
if(aContexte.repeat[lNomVariableBoucle]){return true;}
var lContexteCourant=_getContexteCourant(aControleur,aContexte,aNode,aData);var lInfos=_getAccesParametres(lValueAttr,lContexteCourant),lGetterLength=function(){var lValue=lInfos.callback()||[];return lValue?lValue.length||0:0;},lLength=lGetterLength(),lOldLength=lLength,lChaineData='ie-repeat',lNodeComm=document.createComment(lChaineData),lArrayNodes=[],lArrayComms=[],lCloneModele=aNode.cloneNode(true);aNode.parentNode.insertBefore(lNodeComm,aNode);var lInvocateur=new IEClasses.Invocateur();_abonnerRefresh(function(aGuidEmetteur,aHashGuidCible){var lLength=lGetterLength(),i;if(lOldLength!==lLength){var lArrayRemove=[];for(i=lLength;i<lOldLength;i++){lArrayRemove.push(lArrayNodes[i]);lArrayNodes[i]=null;if(i>0&&lArrayComms[i]){lArrayRemove.push(lArrayComms[i]);lArrayComms[i]=null;}}
$(lArrayRemove).remove();for(i=lOldLength;i<lLength;i++){_addNodeDeREPEAT(aNodeParent,aControleur,lCloneModele,lNomVariableBoucle,i,lInfos,lNodeComm,aContexte,lArrayNodes,lInvocateur);}
lOldLength=lLength;_finaliserInjectionHTML(aNodeParent,aControleur);}
lInvocateur.evenement(C_id_event_iemodel,aGuidEmetteur,aHashGuidCible);},aNodeParent,lContexteCourant);$(aNode).remove();for(var i=0;i<lLength;i++){_addNodeDeREPEAT(aNodeParent,aControleur,lCloneModele,lNomVariableBoucle,i,lInfos,lNodeComm,aContexte,lArrayNodes,lInvocateur);}
return false;}
function _compileNode(aNode,aNodeParent,aControleur,aContexte,aInvocateur,aProfondeur){var lResultBalise,lNodeType,lNodeName,lNode=aNode,lProfondeur=aProfondeur||0,lData=null,lAvecAttributData=false,lAttrValue,lJSONDebugData,lNameAttribut,lAvecCompilFils=true,lContexteCourant=_getContexteCourant(aControleur,aContexte,aNode,null,aInvocateur),lParametresCompile;if(lProfondeur>1000){;return;}
lNodeType=lNode.nodeType;lNodeName=lNode.nodeName?lNode.nodeName.toLowerCase():'';if(lNodeType===1&&!!lNodeName){aContexte.refresh=function(){aControleur.$refresh();};aContexte.refreshSelf=function(){aControleur.$refreshSelf();};lJSONDebugData=null;lData=_getDataDeNode(lNode);lAvecAttributData=!!lData;if(!lData){lData={};}
if(aNode.hasAttribute('ie-if')){if(!_traiterIF(aNode,aNodeParent,aControleur,aContexte,lData)){return;}}
if(aNode.hasAttribute('ie-repeat')){if(!_traiterREPEAT(aNode,aNodeParent,aControleur,aContexte,lData)){return;}}
lContexteCourant.data=lData;var lAvecTransformationNoeud=!!uBalises[lNodeName],lNomBaliseTransform=lNodeName;if(!lAvecTransformationNoeud){for(lNameAttribut in uBalises){if(_hasAttribute(lNode,lNameAttribut)){lAvecTransformationNoeud=true;lNomBaliseTransform=lNameAttribut;lNode.removeAttribute(lNameAttribut);}}}
if(lAvecTransformationNoeud){lResultBalise=uBalises[lNomBaliseTransform](lContexteCourant,lOutils);lAvecCompilFils=!lResultBalise||lResultBalise.avecCompileFils!==false;if(lResultBalise&&lResultBalise.node){lNode=lResultBalise.node;lContexteCourant.node=lNode;lNodeName=lNode.nodeName?lNode.nodeName.toLowerCase():'';}}
var lAttributType='';if(lNodeName==='input'){lAttributType=(lNode.getAttribute('type')||'').toLowerCase();}
if(lNodeName==='textarea'||(lNodeName==='input'&&(lAttributType==='text'||lAttributType===''||lAttributType==='password'||lAttributType==='number'||lAttributType==='email'||lAttributType==='url'||lAttributType==='date'||lAttributType==='dateTimeLocal'||lAttributType==='time'||lAttributType==='month'||lAttributType==='week'))){_gererInputText(lContexteCourant,lNodeName==='input',lAttributType);}
else if(lNodeName==='input'&&(lAttributType==='radio'||lAttributType==='checkbox')){_gererInputCB(lContexteCourant,lAttributType);}
if(lData&&!$.isEmptyObject(lData)){$(lNode).IEData(lData);if(lAvecAttributData){if(lJSONDebugData)
lOutils.addCommentaireDebug(lNode,'ie-data="'+lJSONDebugData+'"');lNode.removeAttribute('ie-data');}}
for(lNameAttribut in uAttributs){if(_hasAttribute(lNode,lNameAttribut)){lParametresCompile={};try{lAttrValue=lNode.getAttribute(lNameAttribut);lNode.removeAttribute(lNameAttribut);uAttributs[lNameAttribut](lContexteCourant,lNodeName,lAttrValue,lOutils,lParametresCompile);if(lAvecCompilFils)
lAvecCompilFils=lParametresCompile.avecCompileFils!==false;}
catch(e){;}}}}
if(lAvecCompilFils&&lNode.childNodes&&lNode.childNodes.length>0){_compile(lNode.childNodes,lNode,aControleur,aContexte,aInvocateur,lProfondeur+1);}}
function _compile(aNodeList,aNodeParent,aControleur,aContexte,aInvocateur,aProfondeur){var lProfondeur=aProfondeur||0;if(lProfondeur>1000){;return;}
var lChildNodes=_sliceNodes(aNodeList),lNode,i;for(i=0;i<lChildNodes.length;i++){lNode=lChildNodes[i];_compileNode(lNode,aNodeParent,aControleur,aContexte,aInvocateur,lProfondeur);}}
return{initControleur:_initControleur,addBalise:function(aBalise,aFonction){aBalise=aBalise.toLowerCase();uBalises[aBalise]=aFonction;lNodeNames.push(aBalise);},addAttribut:function(aAttribut,aFonction){aAttribut=aAttribut.toLowerCase();uAttributs[aAttribut]=aFonction;},ieData:function(aObjet){if(!aObjet){return'';}
var lChaine=IE.ObjetJSON.toJSON(aObjet,{ignorerEntites:true});if(!lChaine){return'';}
return' ie-data="'+lChaine.replace(/"/g,'&quot;')+'" ';},refresh:function(aGuidEmmeteur,aHashGuidCible,aTimeoutRefresh){if(aTimeoutRefresh){setTimeout(function(){uInvocateur.evenement(C_id_event_iemodel,aGuidEmmeteur,aHashGuidCible);},0);}
else{uInvocateur.evenement(C_id_event_iemodel,aGuidEmmeteur,aHashGuidCible);}
return this;},injectHTML:function(aElement,aHtml,aControleur,aIgnorerScroll,aInsererAvantNode){if(aControleur){_initControleur(aControleur);}
return _injectHTML({element:aElement,insererAvantLeNode:aInsererAvantNode,html:aHtml,controleur:aControleur,ignorerScroll:aIgnorerScroll,avecCommentaireConstructeur:true});},collectionIdentite:{},C_id_event_iemodel:C_id_event_iemodel,MAX_LENGTH_Default:0,URL_REGEXP:/^(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/,EMAIL_REGEXP:/^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,6}$/,HEUREMINUTE:/^([01]?[0-9]|2[0-3])h[0-5][0-9]/i,REGEXP_INDICATIF_TELEPHONE:/[^0-9]/ig,TAILLEMAX_INDICATIF_TELEPHONE:3,REGEXP_TELEPHONE:/[^0-9]/ig,TAILLEMAX_TELEPHONE:12};}());$.fn.IEHtml=function(aHtml,aParametres){var lParametres={ignorerScroll:false,controleur:null,sansCompile:false};$.extend(lParametres,aParametres);return this.each(function(){if(this.getElementsByTagName){$.cleanData(this.getElementsByTagName("*"));}
if(lParametres.sansCompile){this.innerHTML=aHtml;}
else{this.innerHTML='';IE.HTML.injectHTML(this,aHtml,lParametres.controleur,lParametres.ignorerScroll);}});};$.fn.IEData=function(aData){if(arguments.length>0){return this.each(function(){$(this).data('ieData',aData);});}
return $(this).data('ieData');};(function($){$.event.special.destroyed={remove:function(event){if(event.handler){event.handler();}}};})(jQuery);;
var GImage=new ObjetImage();function ObjetImage(){}
ObjetImage.prototype.compose=function(aClass,aLargeur){return'<div'+(aClass?' class="'+aClass+'"':'')+' style="margin-left:auto; margin-right:auto; width:'+(aLargeur?aLargeur+'px':'100%;')+'">&nbsp;</div>';};ObjetImage.prototype.composeImage=function(aClass,aLargeur,aPourImpression){if(!aClass){GLog.addLog('ObjetImage.prototype.composeImage : aClass non definie');return'';}
if(aPourImpression){var lRegleCss='.'+aClass;var lUrl=GHtml.extraireUrlReglesCss(lRegleCss);if(!lUrl){GLog.addLog('ObjetImage.prototype.composeImage : lUrl non trouvé dans la regle Css : '+aClass);return'';}
var lPosition=GHtml.chercherAttributReglesCss(lRegleCss,'position');var lHeight=GHtml.chercherAttributReglesCss(lRegleCss,'height');if(!lPosition)
lPosition='relative';var lLargeur=aLargeur;if(!lLargeur)
lLargeur=parseInt(GHtml.chercherAttributReglesCss(lRegleCss,'width'));var lLeft,lTop=0;var lBackGroundPosition=GHtml.chercherAttributReglesCss(lRegleCss,'backgroundPosition');if(lBackGroundPosition){var lTab=lBackGroundPosition.split(' ');if(lTab.length===2){lLeft=lTab[0];lTop=lTab[1];}}
else{lLeft=GHtml.chercherAttributReglesCss(lRegleCss,'left');lTop=GHtml.chercherAttributReglesCss(lRegleCss,'top');}
var lStyle='';if(lPosition) lStyle+='position:'+lPosition+';';if(lHeight) lStyle+='height:'+lHeight+';';if(lLeft) lStyle+='left:'+lLeft+';';if(lTop) lStyle+='top:'+lTop+';';return'<div style="'+GStyle.composeWidth(lLargeur)+'margin-left:auto; margin-right:auto; overflow: hidden">'+'<img src="'+lUrl+'" style="'+lStyle+'" ></img></div>';}
else return'<div class="'+aClass+'" style="'+(aLargeur?GStyle.composeWidth(aLargeur):'')+'margin-left:auto; margin-right:auto;">&nbsp;</div>';};ObjetImage.prototype.setImage=function(aId,aClass){GHtml.setHtml(aId,this.compose(aClass));};ObjetImage.prototype.retailler=function(aId,aWidth,aHeight){if(document.images[aId].width>document.images[aId].height)
document.images[aId].width=aWidth;else document.images[aId].height=aHeight;};;
function ObjetMessage(ANom){this.Nom=ANom;this.idFenetre=this.Nom+'_fenetre';this.idFenetreMessage=this.Nom+'_fenetreMessage';this.idBandeauTitre=this.Nom+'_bandeauTitre';this.idMessage=this.Nom+'_message';this.idMessageTitre=this.Nom+'_messageTitre';this.idTitreMessage=this.Nom+'_titreMessage';this.idMessageTexte=this.Nom+'_messageTexte';this.idValidationAuto=this.Nom+'_ValidationAuto';this.idImg=this.Nom+'_img';this.avecDeplacementSurBandeau=true;this._parametres={};this.controleur={$off:function(){return!this.instance.EnAffichage;},btn:{event:function(aGenre){this.instance.Fermer(aGenre);},getDisplay:function(aGenre){if(aGenre===EGenreAction.NePasValider){return this.instance._parametres.type===EGenreBoiteMessage.Confirmation;}
return true;},getLibelle:function(aGenre){switch(aGenre){case EGenreAction.Valider:return this.instance._parametres.type===EGenreBoiteMessage.Confirmation?this.instance.traductions.Oui:this.instance.traductions.Fermer;case EGenreAction.NePasValider:return this.instance.traductions.Non;}
return'';}},rbChoix:{getValue:function(aIndice){return this.instance._objetChoixMultiple.INDICE_CHOIX===aIndice;},setValue:function(aIndice,aValue){if(aValue)
this.instance._objetChoixMultiple.INDICE_CHOIX=aIndice;}}};this.controleur.instance=this;}(function(){ObjetMessage.delaiFermetureParDefaut=30*1000;ObjetMessage.prototype.setTraductions=function(aFermer,aOui,aNon,aAnnuler){this.traductions={};this.traductions.Fermer=aFermer;this.traductions.Oui=aOui;this.traductions.Non=aNon;this.traductions.Annuler=aAnnuler;};ObjetMessage.prototype._composeNewLook=function(){var H=[];H.push('<div '+window.GObjetWAI.composeRole(EGenreRole.Dialog)+' id="'+this.idFenetreMessage+'" ',GObjetWAI.composeAttribut({genre:EGenreAttribut.labelledby,valeur:this.idMessageTitre}),' tabindex="-1" class="Message SansOutline SansSelectionTexte" style="display:none;">');H.push('<span class="wai_hidden" tabindex="0"  onfocus="'+this.Nom+'.FocusSurPremierElement();"></span>');H.push('<div id="'+this.idFenetre+'" style="'+GStyle.composeBoxShadow()+'">');H.push(' <table style="background-color:white;" height="100%" border="0" cellspacing="0" cellpadding="0">');H.push('  <tr><td>');H.push(this._composeBandeauTitre());H.push('  </td></tr>');H.push('  <tr><td class="Espace" height="100%" id="'+this.idMessage+'" tabIndex="-1">');H.push(this._composeCorpsMessage());H.push('  </td></tr>');H.push('  <tr><td class="EspaceBas">');H.push(this._composeBtnsAction());H.push('  </td></tr>');H.push(' </table>');H.push('</div>');H.push('<span class="wai_hidden" tabindex="0"  onfocus="'+this.Nom+'.FocusSurPremierElement();"></span>');H.push('</div>');return H.join('');};ObjetMessage.prototype.FocusSurPremierElement=function(){GHtml.setFocus(this.Nom+'_'+EGenreAction.Valider,true);};ObjetMessage.prototype._composeBandeauTitre=function(){var H=[];H.push('<table id="'+this.idBandeauTitre+'" style="width: 100%; height: 29px;" border="0" cellspacing="0" cellpadding="0">');H.push('<tr>');H.push('<td id="'+this.idImg+'" style="width: 21px; padding-left: 5px;"></td>');H.push('<td id="'+this.idMessageTitre+'" class="Espace Texte10 Gras ',this.avecDeplacementSurBandeau?'AvecMove':'','"></td>');H.push('</tr>');H.push('</table>');return H.join('');};ObjetMessage.prototype._composeCorpsMessage=function(){var H=[];H.push('<div style="margin-top: 20px;">');H.push('<div class="Texte10 Espace Gras" style="padding-top;" id="'+this.idTitreMessage+'">a</div>');H.push('<div class="Texte10 Espace AlignementHaut" style="min-height: 90px" id="'+this.idMessageTexte+'"></div>');H.push('</div>');return H.join('');};ObjetMessage.prototype._composeBtnsAction=function(){var H=[];H.push('<table border="0" cellspacing="0" cellpadding="0" style="width:100%;"><tr>');H.push('<td id="'+''+'" style="width: 100%">'+'<div id="'+this.idValidationAuto+'" class="hide">'+this._composeValidationAuto()+'</td>');var lTab=[EGenreAction.Valider,EGenreAction.NePasValider],i;for(i in lTab)
H.push('<td class="EspaceDroit">'+'<ie-bouton id="',this.Nom+'_'+lTab[i]+'"',' ie-model="btn('+lTab[i]+')"',' ie-display="getDisplay" style="width:75px;" ',' ie-html="getLibelle" ',GObjetWAI.composeAttribut({genre:EGenreAttribut.describedby ,valeur:this.idMessageTexte+' '+this.idFenetreMessage}),'>','</ie-bouton>'+'</td>');H.push('</tr></table>');return H.join('');};ObjetMessage.prototype.Afficher=function(aTypeMessage,aTitreMessage,aMessage,aTitreBandeau,aPere,aEvenement,aP1,aP2,aP3,aP4){this.afficher({type:aTypeMessage,titre:aTitreMessage,message:aMessage,titreBandeau:aTitreBandeau,callback:new Callback(aPere,aEvenement),p1:aP1,p2:aP2,p3:aP3,p4:aP4});};ObjetMessage.prototype.afficher=function(aParametres){if(this.EnAffichage){if(!this._pileMessage) this._pileMessage=[];this._pileMessage.push(aParametres);GLog.addLog('ObjetMessage.prototype.Afficher : un message est deja visible, le nouveau message est empilé : '+aParametres.message,null,EGenreLog.Avertissement);return;}
this._parametres={type:EGenreBoiteMessage.Information,titreBandeau:'',titre:'',message:'',avecValidationAuto:false,callback:null,controleur:null,delaiFermeture:null,avecDecalageFocusBouton:false,idRessource:null};$.extend(this._parametres,aParametres);if(this._parametres.idRessource){var lChaine=GTraductions.getValeur(this._parametres.idRessource);if(lChaine!==''){var lJson=IE.ObjetJSON.parse(lChaine);if(lJson&&lJson.titre&&lJson.html&&lJson.type>=0&&lJson.boutons){this._parametres.type=_typeEditeurToBoiteMessage(lJson.type);this._parametres.titreBandeau=lJson.titre;this._parametres.message='<div style="width:'+lJson.width+'px;height:'+lJson.height+'px;">'+lJson.html+'</div>';} else ;} else ;}
if(!GHtml.elementExiste(this.idFenetreMessage)){var lDivPere=GHtml.getElement(GApplication.getIdConteneur());var lElement=IE.HTML.injectHTML(lDivPere,this._composeNewLook(),this.controleur,true,lDivPere.firstChild);if(this.avecDeplacementSurBandeau){$(lElement).jIEDraggable({handle:'#'+this.idMessageTitre.escapeJQ()});}}
this.EnAffichage=true;IE.Invocateur.desabonner(IE.Invocateur.events.fermerFenetres,this);IE.Invocateur.abonner(IE.Invocateur.events.fermerFenetres,_fermer.bind(this,{genreAction:EGenreAction.Annuler,avecTimeout:false}),this);this.setVisibleValidationAuto(this._parametres.avecValidationAuto);GNavigateur.BloquerInterfaceAvecCompteur(true);_setAffichage.bind(this)(this._parametres.type,this._parametres.titre?''+this._parametres.titre:'',this._parametres.message?''+this._parametres.message:'',this._parametres.titreBandeau?''+this._parametres.titreBandeau:'',this._parametres.controleur);GHtml.setFocus(this.Nom+'_'+EGenreAction.Valider,true,this._parametres.avecDecalageFocusBouton);if(this._parametres.delaiFermeture){var lDelai=this._parametres.delaiFermeture===true?ObjetMessage.delaiFermetureParDefaut:this._parametres.delaiFermeture;this._timeoutFermeture=setTimeout(this.Fermer.bind(this,EGenreAction.Valider),lDelai);}
this.controleur.$refreshSelf();};function _getTitreBandeau(aGenreMessage){switch(aGenreMessage){case EGenreBoiteMessage.Information:case EGenreBoiteMessage.MrFiche:return GTraductions.getValeur('genreBoiteMessage.Information');case EGenreBoiteMessage.Confirmation:return GTraductions.getValeur('genreBoiteMessage.Confirmation');default:;return'';}}
function _typeEditeurToBoiteMessage(aGenreEditeur){switch(aGenreEditeur){case 2:return EGenreBoiteMessage.Information;case 4:return EGenreBoiteMessage.MrFiche;case 3:return EGenreBoiteMessage.Confirmation;default:;return EGenreBoiteMessage.Information;}}
function _setAffichage(aTypeMessage,aTitreMessage,aMessage,aTitreBandeau,aControleur){GHtml.setHtml(this.idMessageTitre,(aTitreBandeau?aTitreBandeau:_getTitreBandeau(aTypeMessage)),{controleur:aControleur});GHtml.setHtml(this.idTitreMessage,(aTitreMessage?aTitreMessage:''),{controleur:aControleur});GHtml.setDisplay(this.idTitreMessage,(aTitreMessage?true:false));GHtml.setHtml(this.idMessageTexte,this._parametres.idRessource?aMessage:'<div style="width:360px;height:auto;">'+GChaine.ToHTML(aMessage)+'</div>',{controleur:aControleur});GHtml.setClass(this.idFenetre,'Message_Cadre'+aTypeMessage);GHtml.setClass(this.idBandeauTitre,'BandeauTitre'+aTypeMessage);GHtml.setHtml(this.idImg,GImage.compose('Image_Message'+aTypeMessage,21),{controleur:aControleur});GHtml.setDisplay(this.idFenetreMessage,true);GPosition.centrer(this.idFenetreMessage,null,true);GHtml.setFocus(this.idFenetreMessage);}
ObjetMessage.prototype._composeValidationAuto=function(){var lHtml=[];lHtml.push('<table class="Texte10" border="0" cellpadding="0" cellspacing="0">','<tr>','<td style="padding-left:10px;">',GImage.composeImage('Image_CommandeValider_MenuContext',20),'</td>','<td class="EspaceGauche" style="width: 200px">',GTraductions.getValeur('requete.validationAutomatique'),'</td>','</tr>','</table>');return lHtml.join('');};ObjetMessage.prototype.setVisibleValidationAuto=function(aVisible){GStyle.setVisible(this.idValidationAuto,aVisible);};function _fermer(aParametres){IE.Invocateur.desabonner(IE.Invocateur.events.fermerFenetres,this);var lParams=$.extend({genreAction:EGenreAction.Annuler,avecTimeout:true},aParametres);if(this._timeoutFermeture){clearTimeout(this._timeoutFermeture);delete this._timeoutFermeture;}
if(this.EnAffichage){this.EnAffichage=false;this.Accepte=lParams.genreAction;GNavigateur.BloquerInterfaceAvecCompteur(false);GHtml.setDisplay(this.idFenetreMessage,false);GHtml.supprimerElementDOM(this.idFenetreMessage);if(lParams.avecTimeout){setTimeout(this._fermerBis.bind(this),200);}
else{this._fermerBis();}}}
ObjetMessage.prototype.Fermer=function(aGenreAction){_fermer.bind(this)({genreAction:aGenreAction,avecTimeout:true});};ObjetMessage.prototype._fermerBis=function(){if(this._parametres.callback){if(this._parametres.callback.appel)
this._parametres.callback.appel(this.Accepte,this._parametres.p1,this._parametres.p2,this._parametres.p3,this._parametres.p4);else this._parametres.callback(this.Accepte);}
delete this._objetChoixMultiple;if(this._pileMessage&&this._pileMessage.length>0){var lParametres=this._pileMessage.pop();if(this._pileMessage.length===0)
delete this._pileMessage;this.afficher(lParametres);}};}());;
function ObjetCryptageAES(){}
ObjetCryptageAES.prototype.Decrypter=function(aChaine,aCle,aIv,aEnBytes){try{var lChiffreur=forge.aes.createDecryptionCipher(forge.util.hexToBytes(forge.md.md5.create().update(forge.util.encodeUtf8(aCle)).digest().toHex()));lChiffreur.start(aIv?forge.util.hexToBytes(forge.md.md5.create().update(forge.util.encodeUtf8(aIv)).digest().toHex()):forge.util.createBuffer(''));lChiffreur.update(forge.util.createBuffer(forge.util.hexToBytes(aChaine)));lChiffreur.finish();return lChiffreur.output.bytes();} catch(e){;return'';}};ObjetCryptageAES.prototype.Encrypter=function(aChaine,aCle,aIv){try{var lChiffreur=forge.aes.createEncryptionCipher(forge.util.hexToBytes(forge.md.md5.create().update(forge.util.encodeUtf8(aCle)).digest().toHex()));lChiffreur.start(aIv?forge.util.hexToBytes(forge.md.md5.create().update(forge.util.encodeUtf8(aIv)).digest().toHex()):forge.util.createBuffer(''));lChiffreur.update(forge.util.createBuffer(aChaine));lChiffreur.finish();return lChiffreur.output.toHex();} catch(e){;return'';}};;
function ObjetCryptageRSA(aModulo,aExposant){this.modulo=aModulo;this.exposant=aExposant;}
ObjetCryptageRSA.prototype.encrypter=function(aChaine){var lRSA=forge.pki.rsa.setPublicKey(new forge.jsbn.BigInteger(this.modulo,16),new forge.jsbn.BigInteger(this.exposant,16));var lResult=forge.util.encode64(lRSA.encrypt(aChaine),64);return lResult;};ObjetCryptageRSA.prototype.setClePublique=function(aModulo,aExposant){this.modulo=aModulo;this.exposant=aExposant;};;
var GCryptage=new ObjetCryptage();function ObjetCryptage(){this.Minuscules='abcdefghijklmnopkrstuvwxyz';this.Majuscules='ABCDEFGHIJKLMNOPQRSTUVWXYZ';this.Nombres='0123456789';this.Caracteres='&#|^@£$µ?!%ù§~°()[]{}+-*/=.,;';this.CryptageAES=new ObjetCryptageAES();try{this.cryptageRSA=new ObjetCryptageRSA('','');} catch(e){}}
ObjetCryptage.prototype.GenererTexteAleatoire=function(ALongueur){var LListeCaracteres=this.Minuscules+this.Majuscules+this.Nombres;var N=LListeCaracteres.length;var LChaine='';while(LChaine.length<ALongueur)
LChaine+=LListeCaracteres.charAt(Math.floor(N*Math.random()));return LChaine;};ObjetCryptage.prototype.encrypter=function(aOptions){var lDefault={genreCryptage:EGenreCryptage.Aucun,chaine:'',cle:'',iv:'',avecAlea:false,avecCompression:false};var lOptions={};$.extend(lOptions,lDefault,aOptions);lOptions.chaine=''+lOptions.chaine;if(lOptions.avecAlea) lOptions.chaine=this.ajouterAlea(lOptions.chaine);lOptions.chaine=forge.util.encodeUtf8(lOptions.chaine);var lChainePourMD5=lOptions.chaine;if(lOptions.avecCompression){lOptions.chaine=forge.util.createBuffer(lOptions.chaine).toHex();lOptions.chaine=window.pako.deflateRaw(lOptions.chaine,{level:6,to:'string'});}
var lChaineEncrypte='';switch(lOptions.genreCryptage){case EGenreCryptage.Aucun:lChaineEncrypte=lOptions.chaine;break;case EGenreCryptage.Unicode:lChaineEncrypte=lOptions.chaine;break;case EGenreCryptage.AES:lChaineEncrypte=this.CryptageAES.Encrypter(lOptions.chaine,lOptions.cle,lOptions.iv);break;case EGenreCryptage.RSA:lChaineEncrypte=this.cryptageRSA.encrypter(lOptions.chaine);break;default:;break;}
return(lOptions.genreCryptage===EGenreCryptage.AES||lOptions.genreCryptage===EGenreCryptage.RSA?forge.md.md5.create().update(lChainePourMD5+forge.util.encodeUtf8(lOptions.cle)).digest().toHex().toUpperCase():'')+lChaineEncrypte;};ObjetCryptage.prototype.decrypter=function(aOptions){var lDefault={genreCryptage:EGenreCryptage.Aucun,chaine:'',cle:'',iv:'',avecAlea:false,enBytes:false,avecCompression:false,controleIntegrite:true};var lOptions={};$.extend(lOptions,lDefault,aOptions);var lChaineEncrypte,lMD5;if(lOptions.genreCryptage===EGenreCryptage.AES){lChaineEncrypte=lOptions.chaine.slice(32);lMD5=lOptions.chaine.substr(0,32).toUpperCase();} else{lChaineEncrypte=lOptions.chaine;lMD5='';}
var lChaineDecrypte='';switch(lOptions.genreCryptage){case EGenreCryptage.Aucun:lChaineDecrypte=lChaineEncrypte;break;case EGenreCryptage.Unicode:lChaineDecrypte=lChaineEncrypte;break;case EGenreCryptage.AES:lChaineDecrypte=this.CryptageAES.Decrypter(lChaineEncrypte,lOptions.cle,lOptions.iv,lOptions.enBytes);break;default:;break;}
if(lOptions.avecCompression){lChaineDecrypte=window.pako.inflateRaw(lChaineDecrypte,{to:'string'});lChaineDecrypte=forge.util.decodeUtf8(lChaineDecrypte);}
if(lOptions.genreCryptage===EGenreCryptage.AES&&lOptions.controleIntegrite&&lMD5!==forge.md.md5.create().update(lChaineDecrypte+forge.util.encodeUtf8(lOptions.cle)).digest().toHex().toUpperCase()) lChaineDecrypte='<xml><Erreur /></xml>';return lOptions.avecAlea?this.enleverAlea(lChaineDecrypte):lChaineDecrypte;};ObjetCryptage.prototype.ajouterAlea=function(AChaine){var N=AChaine.length;var LTableauAvecAlea=[];var LListeCaracteres=this.Minuscules+this.Majuscules+this.Nombres;var C=LListeCaracteres.length;for(var I=0;I<N;I++){LTableauAvecAlea.push(LListeCaracteres.charAt(Math.floor(C*Math.random())));LTableauAvecAlea.push(String(AChaine).charAt(I));}
return LTableauAvecAlea.join('');};ObjetCryptage.prototype.enleverAlea=function(AChaine){var N=AChaine.length;var LTableauSansAlea=new Array(N);for(var I=0;I<N;I+=1){if(I%2===0){LTableauSansAlea.push(AChaine.charAt(I));}}
return LTableauSansAlea.join('');};ObjetCryptage.prototype.ChiffrementUrl=function(LChemin,LNomFichier,ACle,ANumeroSession){var LUrlChiffree=this.encrypter({genreCryptage:EGenreCryptage.AES,chaine:LChemin,cle:ACle});return'cheminsecurise'+LUrlChiffree+'/'+LNomFichier+'?Session='+ANumeroSession;};;
try{window.Document.prototype.loadXML=function(S){var LDocument=(new DOMParser()).parseFromString(S,"text/xml");while(this.hasChildNodes())
this.removeChild(this.lastChild);for(var I=0;I<LDocument.childNodes.length;I++)
this.appendChild(this.importNode(LDocument.childNodes[I],true));};}
catch(e){}
try{window.Document.prototype.__defineGetter__("xml",function(){return(new XMLSerializer()).serializeToString(this);});}
catch(e){}
IE.getXmlHttp=function(){try{if(window.XMLHttpRequest)
return new XMLHttpRequest();if(window.ActiveXObject){try{return new ActiveXObject("Msxml2.XMLHTTP");} catch(e){return new ActiveXObject("Microsoft.XMLHTTP");}}} catch(e){throw new Error('XmlHttp> '+e);}};;
function ObjetRequete(aParametres){this.Parametres={idSaisie:'',numeroSession:0,numeroRequete:0,asynchrone:true,post:true,nomRequete:'',genreEspace:'',sansBlocageInterface:false,nomDeFonction:'',parametres:'',jsonNonSecurise:null,fichiers:null,callBackReadyStateChange:null,pereReponse:null,evenementReponse:null,messageDetail:'',jsonOrigine:null,log:{}};$.extend(this.Parametres,aParametres);this.estUneRequete=true;this.etat=ObjetRequete.genreEtat.initial;this.Requete=IE.getXmlHttp();}(function(){ObjetRequete.genreEtat={initial:0,preparationEnvoi:1,envoye:2,recu:3,termine:4};ObjetRequete.prototype.enAttente=function(){return this.etat===ObjetRequete.genreEtat.preparationEnvoi||this.etat===ObjetRequete.genreEtat.envoye||this.etat===ObjetRequete.genreEtat.recu;};function _getData(aNumeroOrdreChiffre){var lJSON={};lJSON[_ObjetCommunication.cRequete_numeroSession]=parseInt(this.Parametres.numeroSession,10);lJSON[_ObjetCommunication.cRequete_numeroOrdre]=aNumeroOrdreChiffre;lJSON[_ObjetCommunication.cRequete_nomFonction]=this.Parametres.nomDeFonction;if(this.Parametres.idSaisie)
lJSON[_ObjetCommunication.cRequete_idSaisie]=this.Parametres.idSaisie;lJSON[_ObjetCommunication.cRequete_donneesSecurisee]=this.Parametres.parametres;if(this.Parametres.jsonNonSecurise)
lJSON[_ObjetCommunication.cRequete_donneesNonSecurisee]=this.Parametres.jsonNonSecurise;return $.toJSON(lJSON);}
ObjetRequete.prototype.EnvoieRequete=function(aParametres){var lParametres=$.extend({numeroOrdre:0,numeroOrdreChiffre:''},aParametres);var lCheminSecurise=this.Parametres.nomRequete+'/'+(this.Parametres.genreEspace||0).toString()+'/'+
this.Parametres.numeroSession+'/'+
lParametres.numeroOrdreChiffre;this.Requete.open(this.Parametres.post?'Post':'Get',lCheminSecurise,this.Parametres.asynchrone);this.Requete.onreadystatechange=_OnReadyStateChange.bind(this);this.Requete.setRequestHeader('Content-Type','application/json');this.Requete.send(this.Parametres.post?_getData.bind(this)(lParametres.numeroOrdreChiffre):null);this.etat=ObjetRequete.genreEtat.envoye;try{if(GLog.getActifRequete()){var lEstAttente=false;GLog.addRequete({nomRequete:this.Parametres.nomDeFonction,numeroRequete:this.Parametres.numeroRequete,numeroOrdre:lParametres.numeroOrdre,chrono:{xml:'',traitement:this.Parametres.log.tempsChiffre},avecXml:!!this.Parametres.jsonOrigine[_ObjetCommunication.cRequete_xml],estReponse:false,lgcontenu:this.Parametres.log.tailleDonnees,estAttente:lEstAttente,estSaisie:this.Parametres.log.estUneSaisie});}} catch(e){}};function _OnReadyStateChange(){if(this.Requete.readyState===4){this.etat=ObjetRequete.genreEtat.recu;if(this.Parametres.callBackReadyStateChange){var lRequeteXmlHttp=this.Requete;delete this.Requete;this.Parametres.callBackReadyStateChange(this,lRequeteXmlHttp.responseText,lRequeteXmlHttp.status);lRequeteXmlHttp.onreadystatechange=null;}}}
ObjetRequete.prototype.toString=function(){return this.Parametres.nomDeFonction;};})();;
function ObjetFichier(aID_Fichier,aID_Saisie,aIdForm,aIdFichier,aIdNomFichier,aIdSession,aIdOrdre,aIdIDFichier,aIdIDSaisie,aIdGenreUpload,aGenreUpload){this.estUneRequete=false;this.ID_Fichier=aID_Fichier;this.ID_Saisie=aID_Saisie;this.genreUpload=aGenreUpload;this.IdFichier=aIdFichier;this.IdNomFichier=aIdNomFichier;this.IdSession=aIdSession;this.IdOrdre=aIdOrdre;this.IdForm=aIdForm;this.IdIDFichier=aIdIDFichier;this.IdIDSaisie=aIdIDSaisie;this.idGenreUpload=aIdGenreUpload;this.etat=ObjetRequete.genreEtat.initial;}
ObjetFichier.prototype.EnvoieRequete=function(ANumeroDeSession,ANumeroOrdreChiffre){this.etat=ObjetRequete.genreEtat.envoye;GHtml.setValue(this.IdNomFichier,GHtml.getValue(this.IdFichier));GHtml.setValue(this.IdSession ,ANumeroDeSession);GHtml.setValue(this.IdOrdre ,ANumeroOrdreChiffre);GHtml.setValue(this.IdIDFichier ,this.ID_Fichier);GHtml.setValue(this.IdIDSaisie ,this.ID_Saisie);GHtml.setValue(this.idGenreUpload ,this.genreUpload);GHtml.getElement(this.IdForm).submit();};ObjetFichier.prototype.enAttente=function(){return this.etat===ObjetRequete.genreEtat.preparationEnvoi||this.etat===ObjetRequete.genreEtat.envoye||this.etat===ObjetRequete.genreEtat.recu;};;
var EGenreCryptage={Aucun:0,Unicode:1,AES:2,RSA:3};;
function _ObjetCommunication(AGenreEspace,aNumeroSession){this.NumeroRequeteCourante=0;this.NumeroRequete=0;this._attenteEnCours=false;this.nbrMaxTraitements=30;this.nbrMaxTentatives=0;this.FDureeEnCours=1000*0.5;this._dureeTimerPresence=_ObjetCommunication.cDureeTimerPresence;this.GenreEspace=AGenreEspace;this.NomRequete='appelfonction';this.NomUpload='uploadfichier';this.NomBase64='fichierbase64';this.NomImportQCM='importqcm';this.NombreRequetes=50;this.Requetes=[this.NombreRequetes];this.NumeroDeSession=!!aNumeroSession?aNumeroSession:0;this._numeroOrdreCommunicationPolling=1;this.NumeroOrdreCommunication=1;this.cleAES='';this.ivAES='';this.ivAESTemp=GCryptage.GenererTexteAleatoire(16);this.IdForm='GCommunication_Form_';this.IdFichier='GCommunication_Fichier_';this.IdNomFichier='GCommunication_NomFichier_';this.IdSession='GCommunication_Session';this.IdOrdre='GCommunication_Ordre_';this.IdIDFichier='GCommunication_IDFichier_';this.IdIDSaisie='GCommunication_IDSaisie_';this.IdGenreUpload='GCommunication_GenreUpload_';this.IdIFrame='iframe_upload_fichier_';var lNom='GCommunication';this.getNom=function(){return lNom;};this.setNom=function(aNom){lNom=aNom;};Invocateur.abonner(Invocateur.events.modificationPresenceUtilisateur,this._modificationPresenceUtilisateur,this);Invocateur.abonner(Invocateur.events.interruption_Requete,this._eventInterruptionRequete,this);Invocateur.abonner(Invocateur.events.modification_RequeteAttente,this._eventModificationRequeteAttente,this);}(function(){_ObjetCommunication.optionsSecurite={};_ObjetCommunication.cDureeTimerPresence=2*60*1000;_ObjetCommunication.cNom_SignatureAttente='_SignatureAttente_';_ObjetCommunication.cRequete_numeroSession='session';_ObjetCommunication.cRequete_numeroOrdre='numeroOrdre';_ObjetCommunication.cRequete_idSaisie='idSaisie';_ObjetCommunication.cRequete_donneesSecurisee='donneesSec';_ObjetCommunication.cRequete_donneesNonSecurisee='donneesNonSec';_ObjetCommunication.cRequete_xml='xml';_ObjetCommunication.cRequete_nomFonction='nom';var _pileTimerEnAttente={};_ObjetCommunication.prototype.arreter=function(){Invocateur.desabonner(this);this.desactiverPresence();this.arreterPolling();delete this.ivAES;delete this.cleAES;delete this.NumeroOrdreCommunication;};_ObjetCommunication.prototype.getIDSaisie=function(){return this.NumeroDeSession+'_'+new Date().getTime();};_ObjetCommunication.prototype.setIvAES=function(){this.ivAES=this.ivAESTemp;delete(this.ivAESTemp);};_ObjetCommunication.prototype.appel_fonction_fichier=function(aID_Fichier,aID_Saisie,aGenreUpload){var LNumeroRequete=this.NumeroRequete;this.NumeroRequete=this.GetNumeroSuivant(this.NumeroRequete);this.Requetes[this.NumeroRequete]=null;this.Requetes[LNumeroRequete]=new ObjetFichier(aID_Fichier,aID_Saisie,this.IdForm+aID_Fichier,this.IdFichier+aID_Fichier,this.IdNomFichier+aID_Fichier,this.IdSession+aID_Fichier,this.IdOrdre+aID_Fichier,this.IdIDFichier+aID_Fichier,this.IdIDSaisie+aID_Fichier,this.IdGenreUpload+aID_Fichier,aGenreUpload);this.EnvoieRequete(LNumeroRequete);};_ObjetCommunication.prototype.appel_fonction_asynchrone_xml=function(aParametres){var lParametresAppel={nom:'',xml:null,json:{},estUneSaisie:false,callbackPere:null,callbackEvenement:null,numeroRequete:null,idSaisie:null,sansBlocageInterface:false,messageDetail:''};$.extend(lParametresAppel,aParametres);;var lJSONCollection={},LNumeroRequete;lParametresAppel.json=IE.ObjetJSON.preparerJSON(lParametresAppel.json,{JSONCollection:lJSONCollection});if(lParametresAppel.xml){var lRacineXml=lParametresAppel.xml.GetRacine();if(lRacineXml&&lRacineXml.childNodes.length>0){lParametresAppel.json[_ObjetCommunication.cRequete_xml]=lParametresAppel.xml.ToString();}}
if(!$.isNumeric(parseInt(lParametresAppel.numeroRequete))){LNumeroRequete=this.NumeroRequete;this.NumeroRequete=this.GetNumeroSuivant(this.NumeroRequete);this.Requetes[this.NumeroRequete]=null;} else{LNumeroRequete=lParametresAppel.numeroRequete ;}
var lSecurise=!_ObjetCommunication.optionsSecurite.sansCryptageAES,lChrono,lChronoTrait;var lParametres=lParametresAppel.json;var lJSONChaine='';if(lSecurise){if(window.GLog&&GLog.getActifRequete&&IEClasses.Chrono&&GLog.getActifRequete()){lChrono=new IEClasses.Chrono();}
lJSONChaine=$.toJSON(lParametres);lParametres=GCryptage.encrypter({genreCryptage:lSecurise?EGenreCryptage.AES:EGenreCryptage.Unicode,chaine:lJSONChaine,cle:this.cleAES,iv:lSecurise?this.ivAES:null,avecCompression:lSecurise&&!_ObjetCommunication.optionsSecurite.sansCompressionAES});if(lChrono){lChronoTrait=lChrono.toString();}}
var lIDSaisie=lParametresAppel.estUneSaisie?(lParametresAppel.idSaisie||this.getIDSaisie()):'';var lRequete=this.Requetes[LNumeroRequete]=new ObjetRequete({idSaisie:lIDSaisie,numeroSession:this.NumeroDeSession,numeroRequete:LNumeroRequete,nomRequete:this.NomRequete,genreEspace:this.GenreEspace,sansBlocageInterface:lParametresAppel.sansBlocageInterface===true,nomDeFonction:lParametresAppel.nom,parametres:lParametres,jsonNonSecurise:$.isEmptyObject(lJSONCollection)?null:lJSONCollection,callBackReadyStateChange:this.EvenementSurReponseRequete.bind(this),pereReponse:lParametresAppel.callbackPere,evenementReponse:lParametresAppel.callbackEvenement,messageDetail:lParametresAppel.messageDetail,jsonOrigine:lParametresAppel.json,log:{estUneSaisie:lParametresAppel.estUneSaisie,tailleDonnees:lJSONChaine.length,tempsChiffre:lChronoTrait}});this.EnvoieRequete(LNumeroRequete);return lRequete;};_ObjetCommunication.prototype.GetNumeroSuivant=function(ANumero){return(ANumero+1)%this.NombreRequetes;};_ObjetCommunication.prototype.EnvoieRequete=function(ANumeroRequete){var lRequete=this.Requetes[ANumeroRequete],lRequeteCourante=this.Requetes[this.NumeroRequeteCourante];if(!lRequete){return;}
if(!lRequeteCourante||!lRequeteCourante.enAttente()){this.NumeroRequeteCourante=ANumeroRequete;lRequete.etat=ObjetRequete.genreEtat.preparationEnvoi;var lNumeroOrdreChiffre=this.getChaineChiffreeAES(this.NumeroOrdreCommunication);if(!this._attenteEnCours&&(!lRequete.Parametres||!lRequete.Parametres.sansBlocageInterface)){IE.Invocateur.evenement(IE.Invocateur.events.eventIOAjax,{emission:true,upload:!lRequete.estUneRequete,message:lRequete.estUneRequete?lRequete.Parametres.messageDetail:null});}
if(lRequete.estUneRequete){lRequete.EnvoieRequete({numeroOrdre:this.NumeroOrdreCommunication,numeroOrdreChiffre:lNumeroOrdreChiffre});}
else{var LCheminSecurise='/'+this.NumeroDeSession+'/'+lNumeroOrdreChiffre;if(lRequete.genreUpload===null){document.forms["formulaire_upload_"+lRequete.ID_Fichier].action=this.NomUpload+LCheminSecurise;}
else{document.forms["formulaire_upload_"+lRequete.ID_Fichier].action=this.NomBase64+LCheminSecurise;}
lRequete.EnvoieRequete(this.NumeroDeSession,lNumeroOrdreChiffre);}
var lNumeroPrecedent=ANumeroRequete===0?this.NombreRequetes-1:(ANumeroRequete-1)%this.NombreRequetes;if(this.Requetes[lNumeroPrecedent]){;this.Requetes[lNumeroPrecedent]=null;}}
else{if(lRequeteCourante&&lRequeteCourante.etat===ObjetRequete.genreEtat.envoye&&!this._attenteEnCours&&lRequeteCourante.Parametres&&lRequeteCourante.Parametres.sansBlocageInterface&&(!lRequete.Parametres||!lRequete.Parametres.sansBlocageInterface)){lRequeteCourante.Parametres.sansBlocageInterface=false;IE.Invocateur.evenement(IE.Invocateur.events.eventIOAjax,{emission:true,upload:!lRequeteCourante.estUneRequete});}}};_ObjetCommunication.prototype.EnvoieRequeteSuivante=function(){this.EnvoieRequete(this.GetNumeroSuivant(this.NumeroRequeteCourante),this.NumeroRequeteCourante);};_ObjetCommunication.prototype.composeIFrameFichier=function(){var T=[];T.push('<IFRAME id="'+this.IdIFrame+'" name="'+this.IdIFrame+'" onload="'+this.getNom()+'.evenementSurReponseFichier();" tabIndex="-1" style="width:0px;height:0px;border:0; display:none;" src=""></IFRAME>');return T.join('');};_ObjetCommunication.prototype.composeFormFichier_=function(aParam){var T=[];var lSurOnClick=aParam.evntOnClick?'onclick="'+aParam.evntOnClick+'"':'';T.push('<form id="'+this.getIdFormInputFile(aParam.idFichier)+'" name="formulaire_upload_'+aParam.idFichier+'" target="'+this.IdIFrame+'" action="uploadfichier" method="post" enctype="multipart/form-data" style="overflow:hidden;position:absolute;top:-500px;left:-500px;width:10px;height:10px;">');T.push('<input type="file" id="'+this.getIdInputFile(aParam.idFichier)+'" name="fichier" value="fichier" ',lSurOnClick,' onChange="'+aParam.evntOnChange+' ('+aParam.paramOnChange+');" class="AvecMain" style="position:absolute;top:0;right:0;" title="'+(aParam.title||'')+'"'+(aParam.accept?' accept="'+aParam.accept+'"':'')+(aParam.labelWai?' aria-label="'+aParam.labelWai+'"':'')+' />');T.push('<input type="hidden" id="'+this.IdNomFichier+aParam.idFichier+'" name="NomFichier" value="" />');T.push('<input type="hidden" id="'+this.IdSession+aParam.idFichier+'" name="NumeroDeSession" value="" />');T.push('<input type="hidden" id="'+this.IdOrdre+aParam.idFichier+'" name="NumeroOrdreCommunication" value="" />');T.push('<input type="hidden" id="'+this.IdIDFichier+aParam.idFichier+'" name="IDFichier" value="" />');T.push('<input type="hidden" id="'+this.IdIDSaisie+aParam.idFichier+'" name="IDSaisie"  value="" />');T.push('<input type="hidden" id="'+this.IdGenreUpload+aParam.idFichier+'" name="GenreUpload"  value="" />');T.push('</form>');return T.join('');};_ObjetCommunication.prototype.getIdFormInputFile=function(aIdFichier){return(this.IdForm+aIdFichier);};_ObjetCommunication.prototype.getIdInputFile=function(aIdFichier){return(this.IdFichier+aIdFichier);};_ObjetCommunication.prototype.evenementSurReponseFichier=function(){var lRequete=this.Requetes[this.NumeroRequeteCourante];if(lRequete&&!lRequete.estUneRequete&&lRequete.enAttente()){var lReussiteUpload=false,lContenuReponse=null;try{var T=IE.ObjetJSON.parseJSON(window.frames[this.IdIFrame].document.body.innerHTML);if(T){var lNumeroOrdreCommunication=GCryptage.decrypter({genreCryptage:EGenreCryptage.AES,chaine:T.numeroOrdre,cle:this.cleAES,iv:this.ivAES});var lNumeroOrdre=parseInt(lNumeroOrdreCommunication,10);if(MethodesObjet.isNumber(lNumeroOrdre)&&!isNaN(lNumeroOrdre)){this.NumeroOrdreCommunication=lNumeroOrdre;this.NumeroOrdreCommunication++;lReussiteUpload=true;lContenuReponse=T.reponse;} else{;}}} catch(e){;}
IE.Invocateur.evenement(IE.Invocateur.events.eventReponseUpload,lReussiteUpload,lContenuReponse);lRequete.etat=ObjetRequete.genreEtat.termine;IE.Invocateur.evenement(IE.Invocateur.events.eventIOAjax,{emission:false,upload:true});this.EnvoieRequeteSuivante();}};_ObjetCommunication.prototype.GetNomFichier=function(aIDFichier){return GHtml.getValue(this.IdFichier+aIDFichier);};function _getErreurConnexionInterrompue(){return{Titre:'',Message:GTraductions.getValeur('connexion.ErreurConnexionInterrompue')};}
function _getXmlReponseStatut200(ARequete,AReponse,aJSON){var lNumeroSession=aJSON[_ObjetCommunication.cRequete_numeroSession],lNumeroOrdre=aJSON[_ObjetCommunication.cRequete_numeroOrdre],lDonneesSecurisees=aJSON[_ObjetCommunication.cRequete_donneesSecurisee],lSecurise=!_ObjetCommunication.optionsSecurite.sansCryptageAES,lNomRequete=aJSON[_ObjetCommunication.cRequete_nomFonction]+'Reponse',LXml=null,lErreur=_getErreurConnexionInterrompue();if(parseInt(this.NumeroDeSession,10)!==lNumeroSession&&lNumeroSession!==0){if(!aJSON.Erreur){aJSON.Erreur=lErreur;}
return null;}
var lNumOrdreServeur=parseInt(GCryptage.decrypter({genreCryptage:EGenreCryptage.AES,chaine:lNumeroOrdre,cle:this.cleAES,iv:this.ivAES}),10);if(lNumOrdreServeur!==this.NumeroOrdreCommunication+1){if(!aJSON.Erreur){aJSON.Erreur=lErreur;}
return null;}
this.NumeroOrdreCommunication+=2;var lChrono,lChronoTrait='';if(lSecurise){if(window.GLog&&GLog.getActifRequete&&IEClasses.Chrono&&GLog.getActifRequete()){lChrono=new IEClasses.Chrono();}
var lReponse=GCryptage.decrypter({genreCryptage:_ObjetCommunication.optionsSecurite.sansCryptageAES?EGenreCryptage.Unicode:EGenreCryptage.AES,chaine:lDonneesSecurisees,cle:this.cleAES,iv:this.ivAES,enBytes:!_ObjetCommunication.optionsSecurite.sansCompressionAES,avecCompression:!_ObjetCommunication.optionsSecurite.sansCompressionAES});aJSON.donnees=IE.ObjetJSON.parseJSON(lReponse);if(lChrono&&GLog.getActifRequete()){lChronoTrait=lChrono.toString();}}
else{aJSON.donnees=lDonneesSecurisees;}
delete aJSON[_ObjetCommunication.cRequete_donneesSecurisee];if(!aJSON.donnees){aJSON.Erreur=lErreur;return null;}
var lAvecXml=!!aJSON.donnees[_ObjetCommunication.cRequete_xml];;LXml=window.ObjetXML?lAvecXml?new window.ObjetXML(null,aJSON.donnees[_ObjetCommunication.cRequete_xml]):new window.ObjetXML(null,'<'+lNomRequete+'/>'):null;delete aJSON.donnees[_ObjetCommunication.cRequete_xml];aJSON.donnees=IE.ObjetJSON.parseVariables(aJSON.donnees,{JSONCollection:aJSON[_ObjetCommunication.cRequete_donneesNonSecurisee]});try{if(GLog.getActifRequete()){var lChronoXml='';var lEstAttente=false;GLog.addRequete({nomRequete:lNomRequete,numeroRequete:ARequete.Parametres.numeroRequete,numeroOrdre:this.NumeroOrdreCommunication-1,chrono:{xml:lChronoXml,traitement:lChronoTrait},avecXml:lAvecXml,estReponse:true,lgcontenu:AReponse.length,estAttente:lEstAttente});}} catch(e){}
return LXml;}
_ObjetCommunication.prototype.EvenementSurReponseRequete=function(ARequete,AReponse,AStatut){_traiterPileAttenteSurReponseRequete(ARequete);switch(parseInt(AStatut,10)){case 200:var lJSONReseau=IE.ObjetJSON.parseJSON(AReponse),LXml=null;if(!lJSONReseau){;this.ComposePageErreur(_getErreurConnexionInterrompue());return;}
else{LXml=_getXmlReponseStatut200.bind(this)(ARequete,AReponse,lJSONReseau);}
if(lJSONReseau.Erreur||(lJSONReseau.donnees&&lJSONReseau.donnees.Erreur)){this.ComposePageErreur(!!lJSONReseau.Erreur?lJSONReseau.Erreur:lJSONReseau.donnees.Erreur);}
else{var lJSONAttente=lJSONReseau.donnees[_ObjetCommunication.cNom_SignatureAttente];var lParametresAttente=lJSONAttente?_recupererParametresAttente.bind(this)(lJSONAttente.Parametres):{};if(lJSONAttente){if(!lParametresAttente.sansBlocageInterface){this._attenteEnCours=lJSONAttente?true:false;}}
else{this._attenteEnCours=false;}
if(this._attenteEnCours){if(ARequete.Parametres.sansBlocageInterface){IE.Invocateur.evenement(IE.Invocateur.events.eventIOAjax,{emission:true,upload:false,message:ARequete.Parametres.messageDetail});delete ARequete.Parametres.sansBlocageInterface;}
_declencherAttente.bind(this)({JSONAttente:lJSONAttente,requeteModele:ARequete,parametresAttente:lParametresAttente});}
else{if(!ARequete.Parametres.sansBlocageInterface){IE.Invocateur.evenement(IE.Invocateur.events.eventIOAjax,{emission:false});}
if(lJSONAttente&&lParametresAttente.sansBlocageInterface){_declencherAttente.bind(this)({JSONAttente:lJSONAttente,requeteModele:ARequete,parametresAttente:lParametresAttente});if(lParametresAttente.deserialisation){this.surReception(ARequete,LXml,lJSONReseau);}
else{ARequete.etat=ObjetRequete.genreEtat.termine;}}
else{this.surReception(ARequete,LXml,lJSONReseau);}
this.EnvoieRequeteSuivante();}}
break;case 500:this.ComposePageErreur(null,AStatut);break;default:GLog.addLog('échec requête ajax. requête = '+ARequete+'. statut = '+AStatut);this.ComposePageErreur(null,AStatut);break;}};_ObjetCommunication.prototype.jouerRequeteSession=function(){this.requeteSession=IE.getXmlHttp();this.requeteSession.open('Post','appelsession',true);this.requeteSession.onreadystatechange=this.OnReadyStateChangeRequeteSession.bind(this);this.requeteSession.send('');};_ObjetCommunication.prototype.OnReadyStateChangeRequeteSession=function(){if(this.requeteSession.readyState===4){if(this.requeteSession.status===200){Invocateur.evenement('Reconnexion_Possible',this.requeteSession.responseText);}
else{window.setTimeout(this.jouerRequeteSession.bind(this),1000);}}};function _declencherAttente(aParametres){var lParametres={JSONAttente:null,requeteModele:null,parametresAttente:{}};$.extend(lParametres,aParametres);if(!lParametres.parametresAttente.sansBlocageInterface){window.clearTimeout(this.Timer);this.Timer=setTimeout(_repeterRequeteAttente.bind(this,lParametres),lParametres.parametresAttente.delai);}
else{var lNomFunction=lParametres.requeteModele.Parametres.nomDeFonction;if(_pileTimerEnAttente[lNomFunction]){if(_pileTimerEnAttente[lNomFunction].timer){clearTimeout(_pileTimerEnAttente[lNomFunction].timer);}
delete _pileTimerEnAttente[lNomFunction];}
if(lParametres.requeteModele.__interruptionReponse){delete lParametres.requeteModele.__interruptionReponse;return;}
var lTimer=setTimeout(_repeterRequeteAttente.bind(this,lParametres),lParametres.parametresAttente.delai);_pileTimerEnAttente[lNomFunction]={timer:lTimer};}}
function _repeterRequeteAttente(aParametres){var lJSON,lNomRequete=aParametres.requeteModele.Parametres.nomDeFonction;if(aParametres.parametresAttente.repeterRequete){lJSON=aParametres.requeteModele.Parametres.jsonOrigine;if(!(lJSON&&lJSON[_ObjetCommunication.cNom_SignatureAttente])&&aParametres.JSONAttente){lJSON[_ObjetCommunication.cNom_SignatureAttente]=MethodesObjet.dupliquer(aParametres.JSONAttente);}}
else{lJSON={};if(aParametres.JSONAttente){lJSON[_ObjetCommunication.cNom_SignatureAttente]=MethodesObjet.dupliquer(aParametres.JSONAttente);}}
var lRequete=this.appel_fonction_asynchrone_xml({xml:null,nom:lNomRequete,json:lJSON,callbackPere:aParametres.requeteModele.Parametres.pereReponse,callbackEvenement:aParametres.requeteModele.Parametres.evenementReponse,numeroRequete:aParametres.parametresAttente.sansBlocageInterface?null:aParametres.requeteModele.Parametres.numeroRequete,sansBlocageInterface:aParametres.parametresAttente.sansBlocageInterface});if(aParametres.parametresAttente.sansBlocageInterface){lRequete.__estUneAttenteNonBloquante=true;_pileTimerEnAttente[lRequete.Parametres.nomDeFonction].requete=lRequete;}}
function _traiterPileAttenteSurReponseRequete(aRequete){if(aRequete&&aRequete.__estUneAttenteNonBloquante){var lNomRequete=aRequete.Parametres.nomDeFonction;if(_pileTimerEnAttente[lNomRequete]){if(_pileTimerEnAttente[lNomRequete].timer){clearTimeout(_pileTimerEnAttente[lNomRequete].timer);}
delete _pileTimerEnAttente[lNomRequete];}
delete aRequete.__estUneAttenteNonBloquante;}}
_ObjetCommunication.prototype._eventInterruptionRequete=function(aParametres){var lParametres={nomRequete:''};$.extend(lParametres,aParametres);if(lParametres.nomRequete&&_pileTimerEnAttente[lParametres.nomRequete]){if(_pileTimerEnAttente[lParametres.nomRequete].timer){clearTimeout(_pileTimerEnAttente[lParametres.nomRequete].timer);delete _pileTimerEnAttente[lParametres.nomRequete].timer;}
if(_pileTimerEnAttente[lParametres.nomRequete].requete){_pileTimerEnAttente[lParametres.nomRequete].requete.__interruptionReponse=true;}
else{delete _pileTimerEnAttente[lParametres.nomRequete];}
GLog.addLog('requete en attente : ['+lParametres.nomRequete+'] interrompu');}};_ObjetCommunication.prototype._eventModificationRequeteAttente=function(aParametres){var lParametres={nomRequete:''};$.extend(lParametres,aParametres);var lRequeteExiste=false;if(lParametres.nomRequete&&lParametres.donnees){for(var i=0,nb=this.Requetes.length;i<nb;i++) if(this.Requetes[i]&&this.Requetes[i].Parametres.nomDeFonction){lRequeteExiste=i;break;}
if(lRequeteExiste!==false) $.extend(this.Requetes[lRequeteExiste].Parametres.jsonOrigine.donnees,lParametres.donnees);}};function _recupererParametresAttente(aParametres){var lParametres={sansBlocageInterface:false,delai:this.FDureeEnCours,repeterRequete:false,deserialisation:false};if(aParametres){if(aParametres.sansBlocageInterface){lParametres.sansBlocageInterface=true;}
if(aParametres.delai&&aParametres.delai>0){lParametres.delai=aParametres.delai*1000;}
if(aParametres.repeterRequete){lParametres.repeterRequete=true;}
if(aParametres.date){lParametres.date=aParametres.date;}
if(aParametres.deserialisation){lParametres.deserialisation=aParametres.deserialisation;}}
return lParametres;}
_ObjetCommunication.prototype.surReception=function(aRequete,aXml,aJSON,aEnEchec){try{if(aRequete.Parametres.pereReponse&&aRequete.Parametres.evenementReponse){aRequete.Parametres.pereReponse._jsonRacine=aJSON.donnees;aRequete.Parametres.evenementReponse.call(aRequete.Parametres.pereReponse,aXml,aEnEchec,aJSON.donnees);}} finally{aRequete.etat=ObjetRequete.genreEtat.termine;}
_requetePresenceDelai.bind(this)();};_ObjetCommunication.prototype.ComposePageErreur=function(aJSONErreur,aStatut){var lParametres={constructionPage:true,statut:aStatut,jsonErreur:aJSONErreur};GApplication.finSession(lParametres);};function _requetePresenceDelai(){window.clearTimeout(this.timerPresence);this.timerPresence=setTimeout(_requeteDePresence.bind(this),this._dureeTimerPresence);}
_ObjetCommunication.prototype.activerPresence=function(){this._requetePresenceActive=true;_requetePresenceDelai.bind(this)();};_ObjetCommunication.prototype.desactiverPresence=function(){this._requetePresenceActive=false;window.clearTimeout(this.timerPresence);};_ObjetCommunication.prototype.setDureeTimerPresence=function(aDureeMs){this._dureeTimerPresence=aDureeMs;if(this._requetePresenceActive){_requetePresenceDelai.bind(this)();}};_ObjetCommunication.prototype.requeteEnCours=function(){return(this.Requetes[this.NumeroRequeteCourante]&&this.Requetes[this.NumeroRequeteCourante].enAttente())||this._attenteEnCours;};function _requeteDePresence(){if(!this.Requetes[this.NumeroRequeteCourante].enAttente()&&!this._attenteEnCours&&this._requetePresenceActive&&this._requetePresenceEnPause!==true){IE.Requetes('Presence').lancerRequete();}
_requetePresenceDelai.bind(this)();}
_ObjetCommunication.prototype._modificationPresenceUtilisateur=function(aPresenceUtilisateur){var lNomRequete;if(aPresenceUtilisateur){delete this._requetePresenceEnPause;_requeteDePresence.bind(this)();}
else{this._requetePresenceEnPause=true;window.clearTimeout(this.timerPresence);for(lNomRequete in _pileTimerEnAttente){if(_pileTimerEnAttente[lNomRequete]){this._eventInterruptionRequete({nomrequete:lNomRequete});}}}};_ObjetCommunication.prototype.composeUrlFichier=function(aPrefix,aNomFichier,aParam){var lResult='';if(aPrefix!==''){lResult+=aPrefix+'/';}
lResult+=this.getChaineChiffreeAES($.toJSON(aParam));lResult+='/'+aNomFichier;lResult+='?Session='+this.NumeroDeSession;return lResult;};_ObjetCommunication.prototype.composeUrlFichierExterne=function(aNomFichier,aParam){return this.composeUrlFichier('FichiersExternes',GChaine.enleverEntites(aNomFichier),aParam);};_ObjetCommunication.prototype.composeUrlGraphique=function(aNomFichier,aParam){return this.composeUrlFichier('Graphique',aNomFichier,aParam);};_ObjetCommunication.prototype.composeUrlImpression=function(aNomFichier,aParam){var lResult='Impression/'+aNomFichier;lResult+='?p='+this.getChaineChiffreeAES($.toJSON(aParam));lResult+='&Session='+this.NumeroDeSession;return lResult;};_ObjetCommunication.prototype.composeUrlIManuel=function(aNomFichier,aParam){var lResult='';lResult+='/'+aNomFichier;lResult+='?Session='+this.NumeroDeSession;return this.composeUrlFichier('IManuel',aNomFichier,aParam);};_ObjetCommunication.prototype.getChaineChiffreeAES=function(aChaine){return GCryptage.encrypter({genreCryptage:EGenreCryptage.AES,chaine:aChaine,cle:this.cleAES,iv:this.ivAES});};_ObjetCommunication.prototype.demarrerPolling=function(){};_ObjetCommunication.prototype.arreterPolling=function(){this.pollingActif=false;Invocateur.desabonner(Invocateur.events.modificationPresenceUtilisateur,this);};}());;
var EGenreEspace={Commun:0,Professeur:1,Parent:2,Eleve:3,Entreprise:4,Academie:5,Mobile_Eleve:6,Mobile_Parent:7,Mobile_Professeur:8,Mobile_Commun:9,Etablissement:13,Mobile_Etablissement:14};;
var EGenreAcces={Espace:0,ConnexionEspace:1,ConnexionDirect:2,ConnexionJetonEspace:3,ConnexionJetonDirect:4};;
function ObjetAcces(aGenreAcces,aGenreEspace,aGenreOnglet,aGenreSousOnglet,aNumeroRessource,aNumeroRessourceSecondaire){this.genre=aGenreAcces;this.genreEspace=aGenreEspace;this.genreOnglet=aGenreOnglet;this.genreSousOnglet=aGenreSousOnglet;this.numeroRessource=aNumeroRessource;this.numeroRessourceSecondaire=aNumeroRessourceSecondaire;this.avecRecherche=false;this.initialisation();}
ObjetAcces.prototype.initialisation=function(){this.utilisateur={};this.utilisateur.nom='';this.utilisateur.libelleRecherche='';this.utilisateur.identifiant='';this.utilisateur.password='';};ObjetAcces.prototype.setNom=function(aNom,aLibelleRecherche){this.utilisateur.nom=aNom;this.utilisateur.libelleRecherche=aLibelleRecherche;};ObjetAcces.prototype.setGenreRecherche=function(){if(!this.estConnexionCAS()&&this.avecRecherche&&GParametres&&GParametres.Espace)
this.genreRecherche=GParametres.Espace.NumeroGenreRecherche;};ObjetAcces.prototype.getNom=function(){return this.utilisateur.nom;};ObjetAcces.prototype.setIdentification=function(aIdentifiant,aPassword){this.utilisateur.identifiant=aIdentifiant;this.utilisateur.password=aPassword?aPassword:'@direct';};ObjetAcces.prototype.estConnexionCAS=function(){return(this.genre===EGenreAcces.ConnexionJetonEspace||this.genre===EGenreAcces.ConnexionJetonDirect);};ObjetAcces.prototype.estConnexionDirect=function(){if(this.genre===EGenreAcces.ConnexionDirect)
;var lResult=(this.genre===EGenreAcces.ConnexionJetonDirect);if(this.avecRecherche)
lResult=(lResult||this.genreEspace===EGenreEspace.EDT||this.genreEspace===EGenreEspace.MobileEDT);return lResult;};ObjetAcces.prototype.estConnexionEspaceEtudiant=function(){if(this.genre===EGenreAcces.ConnexionEspace)
;var lResult=(this.genre===EGenreAcces.ConnexionJetonEspace);if(this.avecRecherche)
lResult=(lResult&&this.genreEspace===EGenreEspace.Etudiants);else lResult=(lResult&&this.genreEspace===EGenreEspace.Eleve);return lResult;};ObjetAcces.prototype.avecAuthentification=function(){if(!this.avecRecherche) return(this.genre!==EGenreAcces.Espace);return(this.genre!==EGenreAcces.Espace&&
MethodesTableau.existe(this.genreEspace,[EGenreEspace.Enseignants,EGenreEspace.Etudiants,EGenreEspace.Parents,EGenreEspace.Entreprise,EGenreEspace.Appariteur,EGenreEspace.Secretariat,EGenreEspace.MobileEnseignants,EGenreEspace.MobileEtudiants,EGenreEspace.MobileAppariteur]));};;
IEEnum.droits={estEnConsultation:1,cours:{domaineConsultationEDT:1,avecRechercheCreneauxLibres:1,avecReservationCreneauxLibres:1,modifierProfesseurs:1,modifierSalles:1,modifierMemo:1,deplacerCours:1,estSemaineModifiable:1},eleves:{consulterIdentiteEleve:1,consulterFichesResponsables:1,consulterPhotosEleves:1},communication:{avecDiscussion:1,avecDiscussionParents:1,avecDiscussionEleves:1,avecContactVS:1,avecDiscussionAvancee:1},absences:{domaineRecapitulatifAbsences:1,avecSaisieAppelEtVS:1,avecSaisieAppel:1,avecSaisieCours:1,avecSaisieAbsenceOuverte:1,avecSaisieHorsCours:1,avecSaisieSurGrille:1,avecSaisieSurGrilleAppelProf:1,avecSaisieAbsence:1,avecSaisieRetard:1,avecSaisiePassageInfirmerie:1,avecSaisieExclusion:1,avecSaisiePunition:1,avecSaisieObservation:1,avecConsultationDefautCarnet:1,avecSaisieDefautCarnet:1,avecSaisieObservationsParents:1,avecAccesAuxEvenementsAutresCours:1,avecGestionGroupesGAEV:1,avecSaisieAbsencesToutesPermanences:1,listeDatesSaisieAbsence:1},competence:{avecSaisieEvaluations:1,avecSaisieItems:1,avecValidationCompetences:1},agenda:{avecSaisieAgenda:1},actualite:{avecSaisieActualite:1,uniquementMesClasses:2},casierNumerique:{avecSaisieDocumentsCasiers:1},dossierVS:{creerDossiersVS:1,modifierDossiersVS:1,saisieMotifsDossiersVS:1,publierDossiersVS:1,saisirMemos:1},incidents:{acces:1,saisie:1,publier:1},punition:{avecPublicationPunitions:1,saisie:1,avecRecapPunitions:1,avecRecapSanctions:1},creerMotifIncidentPunitionSanction:1,stage:{autoriserEditionToutesOffresStages:1},cahierDeTexte:{avecSaisieCahierDeTexte:1,avecSaisiePieceJointe:1,tailleMaxPieceJointe:1},notation:{avecSaisieDevoirs:1,avecSaisieDevoirsNotes:1},compte:{avecSaisieIdentifiant:1,avecSaisieMotDePasse:1,avecSaisieMotDePasseEleve:1,avecInformationsPersonnelles:1,avecSaisieInfosPersoCoordonnees:1,avecSaisieInfosPersoAutorisations:1},avecPDFCertificatScolarite:1,fonctionnalites:{gestionBrevet:1,gestionProgrammesBO:1,gestionStages:1,gestionIPR:1,appelPublierObservations:1,appelSaisirMotifJustifDAbsence:1,gestionTwitter:1,gestionBulletinClasse:1,gestionNathan:1,gestionPunitions:1,gestionPermanence:1,gestionAbsencesDemiPension:1,gestionAbsencesInternat:1},avecSaisieAppreciationsGenerales:1,assistantSaisieAppreciations:1,tailleMaxDocJointEtablissement:1};IE.MethodesObjet.indenterEnumere(IEEnum.droits);IEClasses.ObjetDroitsPN=function(){this.init();this.initDroitsSession();};(function(){IEClasses.ObjetDroitsPN.prototype.get=function(aGenreDroit){var lEstEnConsultation=GApplication.getModeExclusif();switch(aGenreDroit){case IEEnum.droits.estEnConsultation:return lEstEnConsultation;case IEEnum.droits.cours.domaineConsultationEDT:return this._droits.cours.domaineConsultationEDT;case IEEnum.droits.cours.avecRechercheCreneauxLibres:return this._droits.cours.avecRechercheCreneauxLibres;case IEEnum.droits.cours.avecReservationCreneauxLibres:return this._droits.cours.avecReservationCreneauxLibres&&!lEstEnConsultation;case IEEnum.droits.cours.modifierProfesseurs:return this._droits.cours.modifierProfesseurs&&!lEstEnConsultation;case IEEnum.droits.cours.modifierSalles:return this._droits.cours.modifierSalles&&!lEstEnConsultation;case IEEnum.droits.cours.modifierMemo:return this._droits.cours.modifierMemo&&!lEstEnConsultation;case IEEnum.droits.cours.deplacerCours:return this._droits.cours.deplacerCours&&!lEstEnConsultation;case IEEnum.droits.cours.estSemaineModifiable:if(lEstEnConsultation)
return false;if(this._droits.cours.modificationNonLimiteAuxSemaine)
return true;if(!this._droits.cours.domaineModificationCours)
return false;return this._droits.cours.domaineModificationCours.GetValeur(arguments[1]);case IEEnum.droits.eleves.consulterIdentiteEleve:return this._droits.ConsulterIdentiteEleve;case IEEnum.droits.eleves.consulterFichesResponsables:return this._droits.ConsulterFichesResponsables;case IEEnum.droits.eleves.consulterPhotosEleves:return this._droits.ConsulterPhotosEleves;case IEEnum.droits.communication.avecDiscussion:return this._droits.AvecDiscussion;case IEEnum.droits.communication.avecDiscussionParents:return this._droits.AvecDiscussionParents;case IEEnum.droits.communication.avecDiscussionEleves:return this._droits.AvecDiscussionEleves;case IEEnum.droits.communication.avecContactVS:return this._droits.AvecContactVS&&!lEstEnConsultation;case IEEnum.droits.communication.avecDiscussionAvancee:return this._droits.AvecDiscussionAvancee;case IEEnum.droits.absences.domaineRecapitulatifAbsences:return this._droits.DomaineRecapitulatifAbsences;case IEEnum.droits.absences.avecSaisieAppelEtVS:return this._droits.AvecSaisieAppelEtVS;case IEEnum.droits.absences.avecSaisieAppel:return this._droits.AvecSaisieAppel;case IEEnum.droits.absences.avecSaisieCours:return this._droits.AvecSaisieCours;case IEEnum.droits.absences.avecSaisieAbsenceOuverte:return this._droits.AvecSaisieAbsenceOuverte;case IEEnum.droits.absences.avecSaisieHorsCours:return this._droits.AvecSaisieHorsCours;case IEEnum.droits.absences.avecSaisieSurGrille:return this._droits.AvecSaisieSurGrille;case IEEnum.droits.absences.avecSaisieSurGrilleAppelProf:return this._droits.AvecSaisieSurGrilleAppelProf;case IEEnum.droits.absences.avecSaisieAbsence:return this._droits.AvecSaisieAbsence;case IEEnum.droits.absences.avecSaisieRetard:return this._droits.AvecSaisieRetard;case IEEnum.droits.absences.avecSaisiePassageInfirmerie:return this._droits.AvecSaisiePassageInfirmerie;case IEEnum.droits.absences.avecSaisieExclusion:return this._droits.AvecSaisieExclusion;case IEEnum.droits.absences.avecSaisiePunition:return this._droits.AvecSaisiePunition;case IEEnum.droits.absences.avecSaisieObservation:return this._droits.AvecSaisieObservation;case IEEnum.droits.absences.avecConsultationDefautCarnet:return this._droits.AvecConsultationDefautCarnet;case IEEnum.droits.absences.avecSaisieDefautCarnet:return this._droits.AvecSaisieDefautCarnet;case IEEnum.droits.absences.avecSaisieObservationsParents:return this._droits.AvecSaisieObservationsParents;case IEEnum.droits.absences.avecAccesAuxEvenementsAutresCours:return this._droits.AvecAccesAuxEvenementsAutresCours;case IEEnum.droits.absences.avecGestionGroupesGAEV:return this._droits.AvecGestionGroupesGAEV;case IEEnum.droits.absences.avecSaisieAbsencesToutesPermanences:return this._droits.AvecSaisieAbsencesToutesPermanences;case IEEnum.droits.absences.listeDatesSaisieAbsence:return IE.MethodesObjet.dupliquer(this._droits.listeDatesSaisieAbsence)||new ObjetListeElements();case IEEnum.droits.competence.avecSaisieEvaluations:return this._droits.AvecSaisieEvaluations&&!lEstEnConsultation;case IEEnum.droits.competence.avecSaisieItems:return this._droits.AvecSaisieItems&&!lEstEnConsultation;case IEEnum.droits.punition.avecValidationCompetences:return this._droits.AvecValidationCompetences&&!lEstEnConsultation;case IEEnum.droits.agenda.avecSaisieAgenda:return this._droits.AvecSaisieAgenda&&!lEstEnConsultation;case IEEnum.droits.actualite.avecSaisieActualite:return this._droits.AvecSaisieActualite&&!lEstEnConsultation;case IEEnum.droits.actualite.uniquementMesClasses:return this._droits.UniquementMesClasses&&!lEstEnConsultation;case IEEnum.droits.casierNumerique.avecSaisieDocumentsCasiers:return this._droits.avecSaisieDocumentsCasiers&&!lEstEnConsultation;case IEEnum.droits.dossierVS.creerDossiersVS:return this._droits.CreerDossiersVS&&!lEstEnConsultation;case IEEnum.droits.dossierVS.modifierDossiersVS:return this._droits.ModifierDossiersVS&&!lEstEnConsultation;case IEEnum.droits.dossierVS.saisieMotifsDossiersVS:return this._droits.SaisieMotifsDossiersVS&&!lEstEnConsultation;case IEEnum.droits.dossierVS.publierDossiersVS:return this._droits.PublierDossiersVS&&!lEstEnConsultation;case IEEnum.droits.dossierVS.saisirMemos:return this._droits.SaisirMemos&&!lEstEnConsultation;case IEEnum.droits.incidents.acces:return this._droits.incidents.acces;case IEEnum.droits.incidents.saisie:return this._droits.incidents.saisie&&!lEstEnConsultation;case IEEnum.droits.incidents.publier:return this._droits.incidents.publier&&!lEstEnConsultation;case IEEnum.droits.incidents:return{acces:this._droits.incidents.acces,saisie:this._droits.incidents.saisie&&!lEstEnConsultation,publier:this._droits.incidents.publier&&!lEstEnConsultation};case IEEnum.droits.punition.avecPublicationPunitions:return this._droits.AvecPublicationPunitions;case IEEnum.droits.punition.saisie:return this._droits.avecSaisiePunitions&&!lEstEnConsultation;case IEEnum.droits.creerMotifIncidentPunitionSanction:return this._droits.avecCreerMotifIncidentPunitionSanction&&!lEstEnConsultation;case IEEnum.droits.punition.avecRecapPunitions:return this._droits.avecRecapPunitions;case IEEnum.droits.punition.avecRecapSanctions:return this._droits.avecRecapSanctions;case IEEnum.droits.stage.autoriserEditionToutesOffresStages:return this._droits.autoriserEditionToutesOffresStages&&!lEstEnConsultation;case IEEnum.droits.cahierDeTexte.avecSaisieCahierDeTexte:return this._droits.avecSaisieCahierDeTexte&&!lEstEnConsultation;case IEEnum.droits.cahierDeTexte.avecSaisiePieceJointe:return this._droits.avecSaisiePieceJointeCahierDeTexte&&!lEstEnConsultation;case IEEnum.droits.cahierDeTexte.tailleMaxPieceJointe:return this._droits.tailleMaxPieceJointeCahierDeTexte;case IEEnum.droits.notation.avecSaisieDevoirs:return this._droits.AvecSaisieDevoirs&&!lEstEnConsultation;case IEEnum.droits.notation.avecSaisieDevoirsNotes:return this._droits.avecSaisieDevoirsNotes&&!lEstEnConsultation;case IEEnum.droits.compte.avecSaisieIdentifiant:return this._droits.compte.avecSaisieIdentifiant&&!lEstEnConsultation;case IEEnum.droits.compte.avecSaisieMotDePasse:return this._droits.compte.avecSaisieMotDePasse&&!lEstEnConsultation;case IEEnum.droits.compte.avecSaisieMotDePasseEleve:return this._droits.compte.avecSaisieMotDePasseEleve&&!lEstEnConsultation;case IEEnum.droits.compte.avecInformationsPersonnelles:return this._droits.compte.avecInformationsPersonnelles;case IEEnum.droits.compte.avecSaisieInfosPersoCoordonnees:return this._droits.compte.avecSaisieInfosPersoCoordonnees&&!lEstEnConsultation;case IEEnum.droits.compte.avecSaisieInfosPersoAutorisations:return this._droits.compte.avecSaisieInfosPersoAutorisations&&!lEstEnConsultation;case IEEnum.droits.avecSaisieAppreciationsGenerales:return this._droits.avecSaisieAppreciationsGenerales&&!lEstEnConsultation;case IEEnum.droits.assistantSaisieAppreciations:return this._droits.AssistantSaisieAppreciations&&!lEstEnConsultation;case IEEnum.droits.tailleMaxDocJointEtablissement:return this._droits.tailleMaxDocJointEtablissement;case IEEnum.droits.avecPDFCertificatScolarite:return this._droits.avecPDFCertificatScolarite;case IEEnum.droits.fonctionnalites.gestionBrevet:return this._droitsSession.fonctionnalites.gestionBrevet;case IEEnum.droits.fonctionnalites.gestionProgrammesBO:return this._droitsSession.fonctionnalites.gestionProgrammesBO;case IEEnum.droits.fonctionnalites.gestionStages:return this._droitsSession.fonctionnalites.gestionStages;case IEEnum.droits.fonctionnalites.gestionIPR:return this._droitsSession.fonctionnalites.gestionIPR;case IEEnum.droits.fonctionnalites.appelPublierObservations:return this._droitsSession.fonctionnalites.appelPublierObservations;case IEEnum.droits.fonctionnalites.appelSaisirMotifJustifDAbsence:return this._droitsSession.fonctionnalites.appelSaisirMotifJustifDAbsence;case IEEnum.droits.fonctionnalites.gestionTwitter:return this._droitsSession.fonctionnalites.gestionTwitter&&GEtatUtilisateur.GenreEspace===EGenreEspace.Professeur;case IEEnum.droits.fonctionnalites.gestionBulletinClasse:return this._droitsSession.fonctionnalites.gestionBulletinClasse;case IEEnum.droits.fonctionnalites.gestionNathan:return this._droitsSession.fonctionnalites.gestionNathan;case IEEnum.droits.fonctionnalites.gestionPunitions:return this._droitsSession.fonctionnalites.gestionPunitions;case IEEnum.droits.fonctionnalites.gestionPermanence:return this._droitsSession.fonctionnalites.gestionPermanence;case IEEnum.droits.fonctionnalites.gestionAbsencesDemiPension:return this._droitsSession.fonctionnalites.gestionAbsencesDemiPension;case IEEnum.droits.fonctionnalites.gestionAbsencesInternat:return this._droitsSession.fonctionnalites.gestionAbsencesInternat;default:;return false;}};IEClasses.ObjetDroitsPN.prototype.init=function(){this._droits={AssistantSaisieAppreciations:false,ConsulterIdentiteEleve:false,ConsulterFichesResponsables:false,ConsulterPhotosEleves:false,AvecDiscussion:false,AvecDiscussionParents:false,AvecDiscussionEleves:false,AvecContactVS:false,AvecDiscussionAvancee:false,DomaineRecapitulatifAbsences:new TypeDomaine(),AvecSaisieAppelEtVS:false,AvecSaisieAppel:false,AvecSaisieCours:false,AvecSaisieAbsenceOuverte:false,AvecSaisieHorsCours:false,AvecSaisieSurGrille:false,AvecSaisieSurGrilleAppelProf:false,AvecSaisieAbsence:false,AvecSaisieRetard:false,AvecSaisiePassageInfirmerie:false,AvecSaisieExclusion:false,AvecSaisiePunition:false,AvecSaisieObservation:false,AvecConsultationDefautCarnet:false,AvecSaisieDefautCarnet:false,AvecSaisieObservationsParents:false,AvecAccesAuxEvenementsAutresCours:false,AvecGestionGroupesGAEV:false,AvecSaisieAbsencesToutesPermanences:false,DateSaisieAbsence:null,AvecSaisieEvaluations:false,AvecSaisieItems:false,AvecValidationCompetences:false,AvecSaisieAgenda:false,AvecSaisieActualite:false,UniquementMesClasses:false,avecSaisieDocumentsCasiers:false,CreerDossiersVS:false,ModifierDossiersVS:false,SaisieMotifsDossiersVS:false,PublierDossiersVS:false,SaisirMemos:false,incidents:{acces:false,saisie:false,publier:false},AvecPublicationPunitions:false,avecSaisiePunitions:false,avecRecapPunitions:false,avecRecapSanctions:false,avecCreerMotifIncidentPunitionSanction:false,avecSaisieAppreciationsGenerales:false,cours:{domaineConsultationEDT:new TypeDomaine(),avecRechercheCreneauxLibres:false,avecReservationCreneauxLibres:false,modifierProfesseurs:false,modifierSalles:false,modifierMemo:false,deplacerCours:false,modificationNonLimiteAuxSemaine:false,domaineModificationCours:new TypeDomaine()},autoriserEditionToutesOffresStages:false,avecSaisieCahierDeTexte:false,avecSaisiePieceJointeCahierDeTexte:false,tailleMaxPieceJointeCahierDeTexte:0,AvecSaisieDevoirs:false,avecSaisieDevoirsNotes:false,tailleMaxDocJointEtablissement:0,compte:{avecSaisieIdentifiant:false,avecSaisieMotDePasse:false,avecSaisieMotDePasseEleve:false,avecInformationsPersonnelles:false,avecSaisieInfosPersoCoordonnees:false,avecSaisieInfosPersoAutorisations:false},avecPDFCertificatScolarite:false};};IEClasses.ObjetDroitsPN.prototype.initDroitsSession=function(){this._droitsSession={fonctionnalites:{gestionBrevet:true,gestionProgrammesBO:true,gestionStages:true,gestionIPR:true,appelPublierObservations:false,appelSaisirMotifJustifDAbsence:false,gestionTwitter:false,gestionBulletinClasse:true,gestionNathan:true,gestionPunitions:true,gestionPermanence:true,gestionAbsencesDemiPension:true,gestionAbsencesInternat:true}};};IEClasses.ObjetDroitsPN.prototype.chargerJSON=function(aJSON){var I;if(aJSON&&aJSON.autorisationsSession){this.initDroitsSession();$.extend(true ,this._droitsSession,aJSON.autorisationsSession);}
if(aJSON&&aJSON.autorisations){this.init();$.extend(true ,this._droits,aJSON.autorisations);this._droits.listeDatesSaisieAbsence=new ObjetListeElements();for(I=0;this._droits.DateSaisieAbsence&&(I<this._droits.DateSaisieAbsence.length);I++){var lDate=new ObjetElement();lDate.Date=aJSON.autorisations.DateSaisieAbsence[I];lDate.Libelle=GDate.FormatDate(lDate.Date,'%JJJJ %JJ %MMM');this._droits.listeDatesSaisieAbsence.AddElement(lDate);}}};}());;
function Callback(aPere,aEvenement,aIdentifiant){this.pere=aPere;this.evenement=aEvenement;this.identifiant=aIdentifiant;}
Callback.prototype.appel=function(){return this.executerEvenement.apply(this,arguments);};Callback.prototype.executerEvenement=function(){if(this.pere&&this.evenement)
return this.evenement.apply(this.pere,arguments);};;

function ObjetRequeteUploadFichiers(aParametres){this.parametres={idSaisie:GApplication.getCommunication().getIDSaisie(),listeFichiers:null,genreUpload:null,callback:null,filtreFichiers:function(D){return!!D&&((D.Etat===EGenreEtat.Creation)||(D.Etat===EGenreEtat.Modification))&&D.idFichier!== -1&&D.idFichier!==undefined;}};$.extend(this.parametres,aParametres);this.donnees={compteRenduFichiers:[],compteurFichiers:0,listeFichiers:null,timerEchec:3*60*1000,parametresRequeteSaisie:null,callback:null};if(this.parametres.listeFichiers&&this.parametres.filtreFichiers){this.donnees.listeFichiers=this.parametres.listeFichiers.getListeElements(this.parametres.filtreFichiers);}}(function(){function _finUpload(){IE.Invocateur.desabonner(IE.Invocateur.events.eventReponseUpload,this);clearTimeout(this.donnees.timerEchecUpload);if(this.parametres.callback){this.parametres.callback(this.donnees.compteRenduFichiers);}
if(this.donnees.callback){this.donnees.callback(this.donnees.compteRenduFichiers);}}
function _surReponseUpload(aReussite,aContenuReponseUpload){clearTimeout(this.donnees.timerEchecUpload);this.donnees.timerEchecUpload=null;IE.Invocateur.desabonner(IE.Invocateur.events.eventReponseUpload,this);var lCompteRenduEnCours=this.donnees.compteRenduFichiers[this.donnees.compteRenduFichiers.length-1];if(lCompteRenduEnCours){lCompteRenduEnCours.reussite=aReussite;lCompteRenduEnCours.contenuReponseUpload=aContenuReponseUpload;if(aReussite)
lCompteRenduEnCours.fichier.reussiteUpload=true;}
this.donnees.compteurFichiers++;_uploadFichiers.bind(this)();}
function _uploadFichiers(){if(this.donnees.compteurFichiers>=this.donnees.listeFichiers.GetNbrElements()){_finUpload.bind(this)();return;}
var lFichier=this.donnees.listeFichiers.GetElement(this.donnees.compteurFichiers);this.donnees.compteRenduFichiers.push({fichier:lFichier});IE.Invocateur.abonner(IE.Invocateur.events.eventReponseUpload,_surReponseUpload,this);clearTimeout(this.donnees.timerEchecUpload);this.donnees.timerEchecUpload=setTimeout(_surReponseUpload.bind(this,false),this.donnees.timerEchec);GApplication.getCommunication().appel_fonction_fichier(lFichier.idFichier,this.parametres.idSaisie,this.parametres.genreUpload);}
ObjetRequeteUploadFichiers.prototype.finalisation=function(){if(this.donnees.listeFichiers&&this.donnees.listeFichiers.parcourir){this.donnees.listeFichiers.parcourir(function(D){if(D.reussiteUpload)
D.idFichier= -1;});}};ObjetRequeteUploadFichiers.prototype.lancerUpload=function(aCallback){if(aCallback)
this.donnees.callback=aCallback;IE.Invocateur.evenement(IE.Invocateur.events.eventIOAjax,{emission:true,upload:true,nombreFichiers:this.donnees.listeFichiers.GetNbrElements(),init:true});_uploadFichiers.bind(this)();return this;};}());;
var EGenreReponseSaisie={erreur:1,annulation:2,succes:3};function _ObjetRequeteXml(aPere,aEvenementSurReussite,aEvenementSurEchec){this.callbackEchec=new Callback(aPere,aEvenementSurEchec);this.callbackReussite=new Callback(aPere,aEvenementSurReussite);this._avecRefreshHTML=true;this._jsonRacineParametres={};this.JSON={};this.initialiser();}
_ObjetRequeteXml.prototype.initialiser=function(){};_ObjetRequeteXml.prototype.lancerRequete=function(){;};_ObjetRequeteXml.prototype.actionApresRequete=function(){;};_ObjetRequeteXml.prototype._reponseRequete=function(aXmlReponse,aEnEchec){this.JSONReponse={};this.JSONSignature={};if(this._jsonRacine){;if(this._jsonRacine[IE.Enum.c_constantesJSON.Donnees]){this.JSONReponse=this._jsonRacine[IE.Enum.c_constantesJSON.Donnees];}
if(this._jsonRacine[IE.Enum.c_constantesJSON.Signature]){this.JSONSignature=this._jsonRacine[IE.Enum.c_constantesJSON.Signature];}
this.traiterReponseRequete(aXmlReponse,aEnEchec);}
else if(this.estReponsePolling){this.traiterReponseRequete(null,false);}
else{IE.Log.addLog('Erreur reponse requete : jsonracine null',IE.Enum.Log.Erreur);this.callbackEchec.appel();}
this.apresReponseRequete();};_ObjetRequeteXml.prototype.apresReponseRequete=function(){};_ObjetRequeteXml.prototype.serialiserJSON=function(){if(this._jsonRacineParametres){if(this.JSON&&!$.isEmptyObject(this.JSON)){this._jsonRacineParametres[IE.Enum.c_constantesJSON.Donnees]=this.JSON;}}};MethodesObjet.heritagePrototype(_ObjetRequeteXmlSaisie,_ObjetRequeteXml);function _ObjetRequeteXmlSaisie(aPere,aEvenementSurReussite,aEvenementSurEchec){this.inheritedCreate(aPere,aEvenementSurReussite,aEvenementSurEchec);}(function(){function _serialisationJSONEtEnvoieRequete(aParams){this.serialiserJSON();var lParams={nom:this.nom,xml:this.XML,json:this._jsonRacineParametres,estUneSaisie:true,callbackPere:this,callbackEvenement:this._reponseRequete,numeroRequete:undefined,idSaisie:this.upload&&this.upload.parametres&&this.upload.parametres.idSaisie?this.upload.parametres.idSaisie:undefined,messageDetail:GTraductions.getValeur('requete.validationEnCours')};$.extend(lParams,aParams);GApplication.getCommunication().appel_fonction_asynchrone_xml(lParams);}
function _callbackFinUpload(aParams){_serialisationJSONEtEnvoieRequete.bind(this)(aParams);this.upload.finalisation();}
_ObjetRequeteXmlSaisie.prototype.appelAsynchroneSaisie=function(aParams){if(this._avecControleModeExclusif&&GApplication.getModeExclusif()){GApplication.getMessage().Afficher(EGenreBoiteMessage.Information,GTraductions.getValeur('ModeExclusif.UsageExclusif'),GTraductions.getValeur('ModeExclusif.SaisieImpossibleConsultation'));return;}
if(!this._jsonRacineParametres){IE.Log.addLog("La requete n'a pas de json definit !",null,IE.Enum.Log.Avertissement);}
if(this.upload&&this.upload.donnees.listeFichiers&&this.upload.donnees.listeFichiers.GetNbrElements()>0){this.upload.lancerUpload(_callbackFinUpload.bind(this,aParams));}
else{_serialisationJSONEtEnvoieRequete.bind(this)(aParams);}};_ObjetRequeteXmlSaisie.prototype.addUpload=function(aParams){this.upload=new ObjetRequeteUploadFichiers(aParams);return this;};_ObjetRequeteXmlSaisie.prototype.traiterReponseRequete=function(aXmlReponse,aEnEchec){var lGenreReponse=this.traiterReponseSaisie(aXmlReponse,aEnEchec);if(this.avecDeserialisationReponseSaisie(aXmlReponse,aEnEchec)){this.actionApresRequete(aXmlReponse,lGenreReponse);}};_ObjetRequeteXmlSaisie.prototype.avecDeserialisationReponseSaisie=function(aXml,aEnEchec){return true;};_ObjetRequeteXmlSaisie.prototype.traiterReponseSaisie=function(aXml,aEnEchec){return aEnEchec?EGenreReponseSaisie.erreur:EGenreReponseSaisie.succes;};}());MethodesObjet.heritagePrototype(_ObjetRequeteXmlConsultation,_ObjetRequeteXml);function _ObjetRequeteXmlConsultation(aPere,aEvenementSurReussite,aEvenementSurEchec){this.inheritedCreate(aPere,aEvenementSurReussite,aEvenementSurEchec);}
_ObjetRequeteXmlConsultation.prototype.appelAsynchroneConsultation=function(aParams){if(!this._jsonRacineParametres){IE.Log.addLog("La requete n'a pas de json definit !",null,IE.Enum.Log.Avertissement);}
this.serialiserJSON();var lParams={nom:this.nom,json:this._jsonRacineParametres,xml:this.XML,callbackPere:this,callbackEvenement:this._reponseRequete,sansBlocageInterface:false,messageDetail:''};$.extend(lParams,aParams);GApplication.getCommunication().appel_fonction_asynchrone_xml(lParams);};_ObjetRequeteXmlConsultation.prototype.traiterReponseRequete=function(aXmlReponse,aEnEchec){if(this.callbackEchec.evenement&&this.JSONSignature&&this.JSONSignature.Erreur){this.traiterReponseEchecConsultation(aXmlReponse);}
else{this.actionApresRequete(aXmlReponse);}
if(this._avecRefreshHTML&&IE.HTML){IE.HTML.refresh();}};_ObjetRequeteXmlConsultation.prototype.traiterReponseEchecConsultation=function(aXml){var lMessage=this.JSONSignature&&this.JSONSignature.MessageErreur?this.JSONSignature.MessageErreur:'';IE.Log.addLog('Erreur de consultation controlé avec le message : '+lMessage,null,IE.Enum.Log.Avertissement);if(this.callbackEchec.appel(lMessage,aXml)){this.actionApresRequete(aXml);}};IE.Requetes=(function(){var lCollectionRequetes={},lRequetes;lRequetes=function(aIdentRequete){var lClasseRequete,lInstanceRequete;lClasseRequete=lCollectionRequetes[aIdentRequete];if(!lClasseRequete){;return{lancerRequete:function(){}};}
lInstanceRequete=new lClasseRequete(arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]);lInstanceRequete.nom=aIdentRequete;return lInstanceRequete;};lRequetes.inscrire=function(aIdentRequete,aClasse,aClassParent){if(!aIdentRequete){;return this;}
if(!aClasse){;return this;}
if(aClassParent){IE.MethodesObjet.heritagePrototype(aClasse,aClassParent);}
if(lCollectionRequetes[aIdentRequete]){if(lCollectionRequetes[aIdentRequete]!==aClasse)
;return this;}
aClasse.prototype.nom=aIdentRequete;lCollectionRequetes[aIdentRequete]=aClasse;};lRequetes.collection=lCollectionRequetes;return lRequetes;}());;

_ObjetRequeteXml.prototype.initialiser=function(){this.XML=new ObjetXML(this.nom);if(window.GEtatUtilisateur&&GEtatUtilisateur.Identification){var lSignature={};if(MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Parent,EGenreEspace.Entreprise,EGenreEspace.Academie,EGenreEspace.Mobile_Parent])){var lMembre=GEtatUtilisateur.getMembre();if(lMembre)
lSignature.membre=new ObjetElement('',lMembre.GetNumero(),lMembre.GetGenre());}
lSignature.onglet=GEtatUtilisateur.getGenreOnglet()>=0?GEtatUtilisateur.getGenreOnglet():EGenreOnglet.GeneralRacine ;this._jsonRacineParametres[IE.Enum.c_constantesJSON.Signature]=lSignature;}};_ObjetRequeteXml._deserialisationSignature=function(aJSON){if(GApplication.droits){GApplication.droits.chargerJSON(aJSON);}
if(aJSON.notificationsCommunication){IE.Invocateur.evenement('notification_communication',aJSON.notificationsCommunication);}
if(aJSON.actualisationMessage){IE.Invocateur.evenement('notification_actualisationMessage');}
if(aJSON.notificationsChatVS){IE.Invocateur.evenement('notification_chatVS',aJSON.notificationsChatVS);IE.Invocateur.evenement('notification_actualisationMessage',true);}};MethodesObjet.heritagePrototype(_ObjetRequeteXmlConsultationPN,_ObjetRequeteXmlConsultation);function _ObjetRequeteXmlConsultationPN(aPere,aEvenementSurReussite,aEvenementSurEchec){var lEvenementEchec=aEvenementSurEchec===false?null:aEvenementSurEchec?aEvenementSurEchec:this.echecParDefaut;this.inheritedCreate(aPere,aEvenementSurReussite,lEvenementEchec);}
_ObjetRequeteXmlConsultationPN.prototype.traiterReponseRequete=function(aXmlReponse,aEnEchec){this.traiterNoeudSignature();return this.inherited('traiterReponseRequete',aXmlReponse,aEnEchec);};_ObjetRequeteXmlConsultationPN.prototype.echecParDefaut=function(aMessage,aXml){var lMessage=aMessage&&(aMessage.length>0)?aMessage:GTraductions.getValeur('requete.erreur');try{GApplication.getMessage().Afficher(EGenreBoiteMessage.Information,null,lMessage);}
catch(e){;}};_ObjetRequeteXmlConsultationPN.prototype.traiterNoeudSignature=function(){var lModeExclusif=false;if(this.JSONSignature){lModeExclusif=!!this.JSONSignature.ModeExclusif;if(this.JSONSignature.listeDonnees){if(!GEtatUtilisateur.listeDonnees){GEtatUtilisateur.listeDonnees={};}
var lDonnees=new ObjetDeserialiser().getListeDonneesNotifiees(this.JSONSignature.listeDonnees);if(lDonnees){$.extend(GEtatUtilisateur.listeDonnees,lDonnees);}}
_ObjetRequeteXml._deserialisationSignature(this.JSONSignature);}
Invocateur.evenement(Invocateur.events.modificationModeExclusif,lModeExclusif);};function ObjetRequeteJSONConsultationPN(aPere,aEvenementSurReussite,aEvenementSurEchec){this.inheritedCreate(aPere,aEvenementSurReussite,aEvenementSurEchec);}
IE.MethodesObjet.heritagePrototype(ObjetRequeteJSONConsultationPN,_ObjetRequeteXmlConsultationPN);ObjetRequeteJSONConsultationPN.prototype.lancerRequete=function(aParametres){$.extend(this.JSON,aParametres);this.appelAsynchroneConsultation();};ObjetRequeteJSONConsultationPN.prototype.actionApresRequete=function(){this.callbackReussite.appel(this.JSONReponse);};MethodesObjet.heritagePrototype(_ObjetRequeteXmlSaisiePN,_ObjetRequeteXmlSaisie);function _ObjetRequeteXmlSaisiePN(aPere,aEvenementSurReussite,aEvenementSurEchec){this.inheritedCreate(aPere,aEvenementSurReussite,aEvenementSurEchec);this._avecControleModeExclusif=true;}
_ObjetRequeteXmlSaisiePN.prototype.avecDeserialisationReponseSaisie=function(aXml,aEnEchec){if(this._avecControleModeExclusif&&GApplication.getModeExclusif())
return false;return true;};_ObjetRequeteXmlSaisiePN.prototype.actionApresRequete=function(aXml,aGenreReponse,aJSONRapport){this.callbackReussite.appel(aXml,aGenreReponse,aJSONRapport);};_ObjetRequeteXmlSaisiePN.prototype.traiterReponseSaisieMessage=function(aMessagesErreurRapportSaisie){var lDetails='';if(aMessagesErreurRapportSaisie&&aMessagesErreurRapportSaisie.join)
lDetails=aMessagesErreurRapportSaisie.join('\n');GApplication.getMessage().Afficher(EGenreBoiteMessage.Information,null,GTraductions.getValeur('requete.validationEchec')+(lDetails?'\n\n'+lDetails:''));};_ObjetRequeteXmlSaisiePN.prototype.reponseEnErreur=function(){return this.JSONRapportSaisie&&this.JSONRapportSaisie._erreurSaisie_||this.JSONSignature&&this.JSONSignature.Erreur;};_ObjetRequeteXmlSaisiePN.prototype.traiterReponseSaisie=function(aXml,aEnEchec){var lReponse=aEnEchec?EGenreReponseSaisie.erreur:EGenreReponseSaisie.succes;if(!this.JSONRapportSaisie)
this.JSONRapportSaisie=this._jsonRacine&&this._jsonRacine.RapportSaisie?this._jsonRacine.RapportSaisie:{};var lMessagesErreurRapportSaisie=!this.JSONRapportSaisie?null:this.JSONRapportSaisie._messagesErreur_?this.JSONRapportSaisie._messagesErreur_:this.JSONRapportSaisie._erreurSaisie_?[]:null;if(!lMessagesErreurRapportSaisie)
lMessagesErreurRapportSaisie=this.JSONSignature&&this.JSONSignature.Erreur?this.JSONSignature.MessageErreur?[this.JSONSignature.MessageErreur]:[]:null;if(this.reponseEnErreur())
lReponse=EGenreReponseSaisie.erreur;else if(lMessagesErreurRapportSaisie)
lReponse=EGenreReponseSaisie.annulation;if(lMessagesErreurRapportSaisie){this.traiterReponseSaisieMessage(lMessagesErreurRapportSaisie);}
if(this.JSONSignature){if(this.JSONSignature.ModeExclusif)
Invocateur.evenement(Invocateur.events.modificationModeExclusif,true);_ObjetRequeteXml._deserialisationSignature(this.JSONSignature);}
return lReponse;};function ObjetRequeteJSONSaisiePN(aPere,aEvenementSurReussite,aEvenementSurEchec){this.inheritedCreate(aPere,aEvenementSurReussite,aEvenementSurEchec);}
IE.MethodesObjet.heritagePrototype(ObjetRequeteJSONSaisiePN,_ObjetRequeteXmlSaisiePN);ObjetRequeteJSONSaisiePN.prototype.lancerRequete=function(aParametres){$.extend(this.JSON,aParametres);this.appelAsynchroneSaisie();};;

IEClasses.ObjetParametresUtilisateur=function(){this.init();};(function(){IEClasses.ObjetParametresUtilisateur.prototype.get=function(aChaine){switch(aChaine){default:var lValue=IE.MethodesObjet.get(this._parametres,aChaine);if(lValue===undefined)
lValue=false;return lValue;}
return null;};IEClasses.ObjetParametresUtilisateur.prototype.set=function(aChaine,aValeur,aIgnorerSaisie){var lAncienneValeur=IE.MethodesObjet.get(this._parametres,aChaine),lResult=false;if(aChaine.trim&&aChaine.split){var lSplit=aChaine.split('.'),lObjet=this._parametres,i,lLength=lSplit.length;for(i=0;i<lLength-1;i++){if(!IE.MethodesObjet.isObject(lObjet[lSplit[i]])){lObjet[lSplit[i]]={};}
lObjet=lObjet[lSplit[i]];}}
switch(aChaine){case'widgets':this._parametres.widgets=aValeur;lResult=true;break;default:lResult=IE.MethodesObjet.set(this._parametres,aChaine,aValeur);;if(lResult)
lResult=aValeur!==lAncienneValeur;}
if(lResult&&!aIgnorerSaisie){_save.call(this);}};IEClasses.ObjetParametresUtilisateur.prototype.has=function(aChaine){switch(aChaine){default:var lValue=IE.MethodesObjet.get(this._parametres,aChaine);if(lValue!==undefined)
return true;}
return false;};function _save(){new ObjetRequeteSaisieParametresUtilisateur(null,function(){}).lancerRequete(this._parametres);}
IEClasses.ObjetParametresUtilisateur.prototype.init=function(){this._parametres={};};IEClasses.ObjetParametresUtilisateur.prototype.chargerJSON=function(aJSON){if(aJSON){this._parametres=aJSON;}};}());function ObjetRequeteSaisieParametresUtilisateur(aPere,aEvenementSurReussite){this.inheritedCreate(aPere,aEvenementSurReussite,false);}
IE.Requetes.inscrire('SaisieParametresUtilisateur',ObjetRequeteSaisieParametresUtilisateur,_ObjetRequeteXmlConsultationPN);ObjetRequeteSaisieParametresUtilisateur.prototype.lancerRequete=function(aParam){this.JSON.parametres=aParam;this.appelAsynchroneConsultation();};ObjetRequeteSaisieParametresUtilisateur.prototype.actionApresRequete=function(){this.callbackReussite.appel();};;
MethodesObjet.heritagePrototype(ObjetRequeteFonctionParametres,_ObjetRequeteXmlConsultationPN);function ObjetRequeteFonctionParametres(aPere,aEvenementSurReussite,aEvenementSurEchec){this.inheritedCreate(aPere,aEvenementSurReussite,aEvenementSurEchec);}
IE.Requetes.inscrire('FonctionParametres',ObjetRequeteFonctionParametres,_ObjetRequeteXmlConsultationPN);ObjetRequeteFonctionParametres.prototype.lancerRequete=function(aObjet){this.JSON={Uuid:aObjet.uuidRSA};this.serialiserJSON();GApplication.getCommunication().appel_fonction_asynchrone_xml({nom:this.nom,json:this._jsonRacineParametres,callbackPere:this,callbackEvenement:this._reponseRequete});};ObjetRequeteFonctionParametres.prototype.actionApresRequete=function(){this.callbackReussite.appel(this.JSONReponse);};;
var ECouleurDeTheme={Light:0,Legere:1,Legere2:2,Claire:3,Moyen1:4,Moyen2:5,Foncee:6,Sombre:7};;
var C_indiceThemeAccessible=30;var EThemeCouleur={Personnalise:0,Accessible:C_indiceThemeAccessible};;
var GThemesCouleurs=new ObjetThemesCouleurs();function ObjetThemesCouleurs(){}(function(){ObjetThemesCouleurs.prototype.initialiser=function(){this.themeNeutre=['#F9F4F0','#F9F4F0','#EFEAE7','#E3DDD8','#DED6D0','#CBC2BB','#77716B','#595551'];this.themeCouleur=this.themeNeutre;this.nonEditable='#EFEFEF';};ObjetThemesCouleurs.prototype.getThemeNeutre=function(){return{light:this.themeNeutre[ECouleurDeTheme.Light],legere:this.themeNeutre[ECouleurDeTheme.Legere2],legere2:this.themeNeutre[ECouleurDeTheme.Legere2],claire:this.themeNeutre[ECouleurDeTheme.Claire],moyen1:this.themeNeutre[ECouleurDeTheme.Moyen1],moyen2:this.themeNeutre[ECouleurDeTheme.Moyen2],foncee:this.themeNeutre[ECouleurDeTheme.Foncee],sombre:this.themeNeutre[ECouleurDeTheme.Sombre]};};ObjetThemesCouleurs.prototype.getThemeCouleur=function(aGenreThemeCouleur){return{claire:this.getCouleurDuTheme(ECouleurDeTheme.Claire,true,aGenreThemeCouleur),moyen1:this.getCouleurDuTheme(ECouleurDeTheme.Moyen1,true,aGenreThemeCouleur),foncee:this.getCouleurDuTheme(ECouleurDeTheme.Foncee,true,aGenreThemeCouleur),sombre:this.getCouleurDuTheme(ECouleurDeTheme.Sombre,true,aGenreThemeCouleur)};};ObjetThemesCouleurs.prototype.definirThemeCouleur=function(aThemeCouleur,aThemeNeutre,aNonEditable){if(aThemeCouleur)
this.themeCouleur=['','','',aThemeCouleur.claire,aThemeCouleur.moyen1,'',aThemeCouleur.foncee,aThemeCouleur.sombre];if(aThemeNeutre)
this.themeNeutre=[aThemeNeutre.light,aThemeNeutre.legere,aThemeNeutre.legere2,aThemeNeutre.claire,aThemeNeutre.moyen1,aThemeNeutre.moyen2,aThemeNeutre.foncee,aThemeNeutre.sombre];if(aNonEditable){this.nonEditable=aNonEditable;if(window.GHtml&&window.GHtml.modifierRegleCss){GHtml.modifierRegleCss('input:disabled','background',this.nonEditable);GHtml.modifierRegleCss('textarea:disabled','background',this.nonEditable);if(aThemeNeutre){GHtml.modifierRegleCss('input:disabled','color',aThemeNeutre.foncee);GHtml.modifierRegleCss('textarea:disabled','color',aThemeNeutre.foncee);}}}};ObjetThemesCouleurs.prototype.setListeThemes=function(aListeThemes){this.listeThemes=aListeThemes;var lTheme;for(var i=0;i<this.listeThemes.GetNbrElements();i++){lTheme=this.listeThemes.GetElement(i);lTheme.themeCouleur=['','','',lTheme.claire,lTheme.moyen1,'',lTheme.foncee,lTheme.sombre];}};ObjetThemesCouleurs.prototype.getTheme=function(){return this.themeNeutre;};ObjetThemesCouleurs.prototype.getCouleurDuTheme=function(aCouleurDeTheme,aAvecCouleur,aGenreThemeCouleur){var lTheme=this.listeThemes?this.listeThemes.GetElementParGenre(aGenreThemeCouleur):null;var lThemeCouleur=lTheme?lTheme.themeCouleur:this.themeCouleur;var lJeuDeCouleurs=aAvecCouleur&&lThemeCouleur?lThemeCouleur:this.themeNeutre;return lJeuDeCouleurs[aCouleurDeTheme];};ObjetThemesCouleurs.prototype.appliquerChangementTheme=function(aGenreThemeCouleur){var lThemeNeutre=this.getThemeNeutre();var lThemeCouleur=this.getThemeCouleur(aGenreThemeCouleur);if(!window.GHtml||!window.GHtml.modifierRegleCss) return;GHtml.modifierRegleCss('a','color',lThemeCouleur.foncee);GHtml.modifierRegleCss('a:hover','color',lThemeCouleur.sombre);GHtml.modifierRegleCss('.LienAccueil','color',lThemeCouleur.foncee);GHtml.modifierRegleCss('.LienAccueil:hover','color',lThemeCouleur.sombre);GHtml.modifierRegleCss('.CelluleTexte','border-color',lThemeNeutre.legere);GHtml.modifierRegleCss('.Bordure','border-color',lThemeNeutre.moyen1);GHtml.modifierRegleCss('.Bouton','background-color',lThemeNeutre.moyen2);GHtml.modifierRegleCss('.Bouton','border-left-color',lThemeNeutre.legere);GHtml.modifierRegleCss('.Bouton','border-top-color',lThemeNeutre.legere);GHtml.modifierRegleCss('.Scroll','scrollbar-face-color',lThemeNeutre.moyen2);GHtml.modifierRegleCss('.Scroll','scrollbar-shadow-color',lThemeNeutre.foncee);GHtml.modifierRegleCss('.Scroll','scrollbar-highlight-color',lThemeNeutre.claire);GHtml.modifierRegleCss('.Scroll','scrollbar-3dLight-color',lThemeNeutre.legere);GHtml.modifierRegleCss('.Scroll','scrollbar-track-color',lThemeNeutre.legere);_appliquerThemeSkinScroll.call(this,lThemeNeutre);GHtml.modifierRegleCss('.Calendrier_Jour_Domaine','border-top-color' ,lThemeNeutre.sombre);GHtml.modifierRegleCss('.Calendrier_Jour_Domaine','border-right-color' ,lThemeNeutre.sombre);GHtml.modifierRegleCss('.Calendrier_Jour','border-right-color' ,lThemeNeutre.sombre);GHtml.modifierRegleCss('.Calendrier_Mois','border-right-color' ,lThemeNeutre.sombre);GHtml.modifierRegleCss('.Calendrier_Mois','border-top-color' ,lThemeNeutre.sombre);GHtml.modifierRegleCss('.Legende','color','black');};function _appliquerThemeSkinScroll(aCouleur){GHtml.modifierRegleCss('.jspTrack','background',aCouleur.legere);GHtml.modifierRegleCss('.jspVerticalBar .jspDrag','background-color',aCouleur.claire);GHtml.modifierRegleCss(GNavigateur.IsIE?'.jspVerticalBar .jspHover.jspDrag':'.jspVerticalBar .jspDrag.jspHover','background-color',aCouleur.moyen1);GHtml.modifierRegleCss('.jspVerticalBar .jspDrag','border',aCouleur.moyen2+' 1px solid');GHtml.modifierRegleCss('.jspHorizontalBar .jspDrag','background-color',aCouleur.claire);GHtml.modifierRegleCss(GNavigateur.IsIE?'.jspHorizontalBar .jspHover.jspDrag':'.jspHorizontalBar .jspDrag.jspHover','background-color',aCouleur.moyen1);GHtml.modifierRegleCss('.jspHorizontalBar .jspDrag','border',aCouleur.moyen2+' 1px solid');GHtml.modifierRegleCss('.jspArrow','background-color',aCouleur.legere);GHtml.modifierRegleCss('.jspArrow:hover','background-color',aCouleur.moyen1);GHtml.modifierRegleCss(GNavigateur.IsIE?'.jspDisabled.jspArrow:hover':'.jspArrow.jspDisabled:hover','background-color',aCouleur.legere);}
ObjetThemesCouleurs.prototype.getThemeCourant=function(aParam){var lTheme;if(IE.optionsEspaceLocal&&IE.optionsEspaceLocal.getModeAccessible(aParam.genreEspace)){lTheme={theme:EThemeCouleur.Accessible,teinte:false};} else{if(aParam.theme)
lTheme=aParam.theme;else{lTheme={theme:aParam.themeParDefaut,teinte:false};}}
if(lTheme.theme===EThemeCouleur.Personnalise&&$.isNumeric(lTheme.teinte)){this.themeCouleur=this.getCouleursDeTeinte(lTheme.teinte);}
return lTheme;};ObjetThemesCouleurs.prototype.getCouleursDeTeinte=function(aTeinte){var lCouleurs=[],lGenre,i,lSat={};lSat[ECouleurDeTheme.Claire]=20;lSat[ECouleurDeTheme.Moyen1]=40;lSat[ECouleurDeTheme.Foncee]=70;lSat[ECouleurDeTheme.Sombre]=80;for(i in ECouleurDeTheme){lGenre=ECouleurDeTheme[i];if(lSat[lGenre])
lCouleurs[lGenre]=_ObjetCouleur.prototype.HSLToCouleur({h:aTeinte,s:lSat[lGenre],l:-0.0054*lSat[lGenre]*lSat[lGenre]-0.13*lSat[lGenre]+100});else lCouleurs[lGenre]='';}
return lCouleurs;};}());;
var GCouleur;function _ObjetCouleur(aGenreThemeCouleur,aEstAccessible,aAvecNonEditable){GThemesCouleurs.definirThemeCouleur();this.blanc='white';this.noir='black';this.themeNeutre=GThemesCouleurs.getThemeNeutre();if(aEstAccessible){GThemesCouleurs.definirThemeCouleur(GThemesCouleurs.getThemeNeutre());}
this.themeCouleur=GThemesCouleurs.getThemeCouleur(aGenreThemeCouleur);GThemesCouleurs.appliquerChangementTheme(aGenreThemeCouleur);this.fond=this.themeNeutre.light;this.texte=this.noir;this.bordure=this.trait=this.themeNeutre.moyen2;this.cumul=this.themeNeutre.moyen2;this.nonEditable={fond:GThemesCouleurs.nonEditable,texte:this.themeNeutre.foncee,bordure:this.themeNeutre.moyen2};this.intermediaire=GThemesCouleurs.getCouleurDuTheme(ECouleurDeTheme.Claire);this.avecNonEditable=aAvecNonEditable===null||aAvecNonEditable===undefined?true:aAvecNonEditable;this.texteListeCreation='#444444';this.grille={fond:this.fond,texte:this.noir,bordure:this.themeNeutre.sombre};this.fenetre={fond:this.fond,bordure:this.bordure,bandeau:{fond:this.themeNeutre.sombre,texte:this.blanc},nonEditable:this.nonEditable,cumul:this.cumul,texte:GThemesCouleurs.getCouleurDuTheme(ECouleurDeTheme.Foncee),intermediaire:GThemesCouleurs.getCouleurDuTheme(ECouleurDeTheme.Claire)};this.rouge=aEstAccessible?'#666666':'#CC3300';this.rougeClair=aEstAccessible?'#666666':'#FF0000';this.vert=aEstAccessible?'#666666':'#228B22';this.grisTresClair=this.fenetre.nonEditable;this.grisClair=this.fenetre.intermediaire;this.grisFonce=this.fenetre.cumul;this.grisTresFonce=this.fenetre.texte;this.focus=new ObjectCouleurCellule(this.cumul,this.fond,this.bordure);this.standard=new ObjectCouleurCellule(this.blanc,this.noir);this.selection=new ObjectCouleurCellule(aEstAccessible?'#7b7b7b':'#316AC5',this.blanc);this.selection.fondClair=aEstAccessible?'#b3b3b3':'#6699FF';this.inactif=new ObjectCouleurCellule('#F0F0F0','#AAAAAA');this.bandeau={fond:this.themeNeutre.moyen1,texte:this.noir,bordure:this.themeNeutre.light,separateur:this.themeCouleur.foncee};this.liste=new ObjectCouleurCellule();this.liste.bordure=this.bordure;this.liste.titre=new ObjectCouleurCellule(this.themeCouleur.foncee,this.blanc,this.bordure);this.liste.cellule=new ObjectCouleurCellule(this.fond,this.texte,this.bordure);this.liste.editable=new ObjectCouleurCellule(this.blanc,this.noir,this.bordure);this.liste.editableAlternee1=new ObjectCouleurCellule(this.themeNeutre.light,this.noir,this.bordure);this.liste.editableAlternee2=new ObjectCouleurCellule(this.blanc,this.noir,this.bordure);this.liste.nonEditable=new ObjectCouleurCellule(this.avecNonEditable?this.themeNeutre.legere2:this.blanc,this.noir,this.bordure);this.liste.nonEditableAlternee1=new ObjectCouleurCellule(this.themeNeutre.claire,this.noir,this.bordure);this.liste.nonEditableAlternee2=new ObjectCouleurCellule(this.themeNeutre.legere2,this.noir,this.bordure);this.liste.nonApplicable=new ObjectCouleurCellule(this.themeNeutre.moyen1,this.noir,this.bordure);this.liste.colonneFixe=new ObjectCouleurCellule(this.themeNeutre.claire,this.noir,this.bordure);this.liste.colonneFixeAlternee1=new ObjectCouleurCellule(this.themeNeutre.claire,this.noir,this.bordure);this.liste.colonneFixeAlternee2=new ObjectCouleurCellule(this.themeNeutre.legere2,this.noir,this.bordure);this.liste.moyenne=new ObjectCouleurCellule(this.themeNeutre.claire,this.noir,this.bordure);this.liste.moyenneAlternee1=new ObjectCouleurCellule(this.themeNeutre.claire,this.noir,this.bordure);this.liste.moyenneAlternee2=new ObjectCouleurCellule(this.themeNeutre.legere2,this.noir,this.bordure);this.liste.total=new ObjectCouleurCellule(this.themeNeutre.foncee,this.blanc,this.bordure);this.liste.totalAlternee1=new ObjectCouleurCellule(this.themeNeutre.sombre,this.blanc,this.bordure);this.liste.totalAlternee2=new ObjectCouleurCellule(this.themeNeutre.foncee,this.blanc,this.bordure);this.liste.cumul=new ObjectCouleurCellule(this.themeCouleur.claire,this.noir,this.bordure);this.liste.cumul[0]=new ObjectCouleurCellule(this.themeCouleur.moyen1,this.noir,this.bordure);this.liste.cumul[1]=new ObjectCouleurCellule(this.themeCouleur.claire,this.noir,this.bordure);this.liste.cumul[2]=new ObjectCouleurCellule(this.themeNeutre.moyen1,this.noir,this.bordure);this.liste.cumul[3]=new ObjectCouleurCellule(this.themeNeutre.claire,this.noir,this.bordure);this.listeNeutre=MethodesObjet.dupliquer(this.liste);this.listeNeutre.titre.fond=this.themeNeutre.foncee;this.listeNeutre.cumul.fond=this.themeNeutre.claire;this.listeNeutre.cumul[0].fond=this.themeNeutre.claire;this.listeNeutre.cumul[1].fond=this.themeNeutre.claire;this.listeNeutre.cumul[2].fond=this.themeNeutre.claire;this.listeNeutre.cumul[3].fond=this.themeNeutre.claire;this.correspondance={};this.accessible={};this.devoir={commeUnBonus:'#0f0',commeUneNote:'darkorange'};}
_ObjetCouleur.prototype.getCouleurCellule=function(aEditable,aSelectionne,aEstTitre){if(aSelectionne)
return GCouleur.selection;if(aEstTitre)
return GCouleur.liste.titre;return aEditable?GCouleur.liste.editable:GCouleur.liste.nonEditable;};_ObjetCouleur.prototype.getCouleurHSL=function(aCouleur){var R=parseInt(aCouleur.substr(1,2),16)/255;var G=parseInt(aCouleur.substr(3,2),16)/255;var B=parseInt(aCouleur.substr(5,2),16)/255;var L,H,S;var lMin=Math.min(R,G,B);var lMax=Math.max(R,G,B);var lDelta_Max=lMax-lMin;L=(lMax+lMin)/2;if(lDelta_Max===0){H=2/3;S=0;} else{if(L<0.5)
S=lDelta_Max/(lMax+lMin);else S=lDelta_Max/(2-lMax-lMin);var lDelta_R=(((lMax-R)/6)+(lDelta_Max/2))/lDelta_Max;var lDelta_G=(((lMax-G)/6)+(lDelta_Max/2))/lDelta_Max;var lDelta_B=(((lMax-B)/6)+(lDelta_Max/2))/lDelta_Max;if(R===lMax) H=lDelta_B-lDelta_G;else if(G===lMax) H=(1/3)+lDelta_R-lDelta_B;else if(B===lMax) H=(2/3)+lDelta_G-lDelta_R;if(H<0) H+=1;if(H>1) H-=1;}
L*=240;H*=240;S*=240;var lResult={};lResult.L=Math.round(L);lResult.H=Math.round(H);lResult.S=Math.round(S);return lResult;};_ObjetCouleur.prototype.CouleurToRGB=function(aHex){return aHex?{r:parseInt(aHex.substr(1,2),16),g:parseInt(aHex.substr(3,2),16),b:parseInt(aHex.substr(5,2),16)}:{};};_ObjetCouleur.prototype.CouleurToHSL=function(hex){return this.RGBToHSL(this.CouleurToRGB(hex));};_ObjetCouleur.prototype.RGBToCouleur=function(aRGB){var hex=[
parseInt(aRGB.r).toString(16),parseInt(aRGB.g).toString(16),parseInt(aRGB.b).toString(16)
];$.each(hex,function(nr,val){if(val.length===1){hex[nr]='0'+val;}});hex=hex.join('');return'#'+hex;};_ObjetCouleur.prototype.RGBToHSL=function(rgb){var hsl={h:0,s:0,l:0};var min=Math.min(rgb.r,rgb.g,rgb.b);var max=Math.max(rgb.r,rgb.g,rgb.b);var delta=max-min;hsl.l=max;hsl.s=max!==0?255*delta/max:0;if(hsl.s!==0){if(rgb.r===max){hsl.h=(rgb.g-rgb.b)/delta;} else if(rgb.g===max){hsl.h=2+(rgb.b-rgb.r)/delta;} else{hsl.h=4+(rgb.r-rgb.g)/delta;}} else{hsl.h=0;}
hsl.h*=60;if(hsl.h<=0){hsl.h+=360;}
hsl.s*=100/255;hsl.l*=100/255;return hsl;};_ObjetCouleur.prototype.HSLToCouleur=function(hsl){return this.RGBToCouleur(this.HSLToRGB(hsl));};_ObjetCouleur.prototype.HSLToRGB=function(hsl){var rgb={};var h=Math.round(hsl.h);var s=Math.round(hsl.s*255/100);var v=Math.round(hsl.l*255/100);if(s===0){rgb.r=rgb.g=rgb.b=v;} else{var t1=v;var t2=(255-s)*v/255;var t3=(t1-t2)*(h%60)/60;if(h===360) h=0;if(h<60){rgb.r=t1;rgb.b=t2;rgb.g=t2+t3;}
else if(h<120){rgb.g=t1;rgb.b=t2;rgb.r=t1-t3;}
else if(h<180){rgb.g=t1;rgb.r=t2;rgb.b=t2+t3;}
else if(h<240){rgb.b=t1;rgb.r=t2;rgb.g=t1-t3;}
else if(h<300){rgb.b=t1;rgb.g=t2;rgb.r=t2+t3;}
else if(h<360){rgb.r=t1;rgb.g=t2;rgb.b=t1-t3;}
else{rgb.r=0;rgb.g=0;rgb.b=0;}}
return{r:Math.round(rgb.r),g:Math.round(rgb.g),b:Math.round(rgb.b)};};_ObjetCouleur.prototype.getCouleurCorrespondance=function(aCouleur){if(!aCouleur) return aCouleur;if(this.correspondance[aCouleur]!==undefined) return this.correspondance[aCouleur];var lCouleurHSL=this.getCouleurHSL(aCouleur);if(lCouleurHSL.L<=95) this.correspondance[aCouleur]='white';else if(lCouleurHSL.L>160) this.correspondance[aCouleur]='black';else if(lCouleurHSL.H<=120) this.correspondance[aCouleur]='black';else this.correspondance[aCouleur]='white';return this.correspondance[aCouleur];};_ObjetCouleur.prototype.getCouleurAccessible=function(aCouleur){if(!aCouleur||!aCouleur.substr) return aCouleur;if(this.accessible[aCouleur]!==undefined) return this.accessible[aCouleur];var r=parseInt(aCouleur.substr(1,2),16)/255;var g=parseInt(aCouleur.substr(3,2),16)/255;var b=parseInt(aCouleur.substr(5,2),16)/255;var max=Math.max(r,g,b),min=Math.min(r,g,b);var h,s,l=(max+min)/2;if(max===min){h=s=0;}else{var d=max-min;s=l>0.5?d/(2-max-min):d/(max+min);switch(max){case r:h=(g-b)/d+(g<b?6:0);break;case g:h=(b-r)/d+2;break;case b:h=(r-g)/d+4;break;}
h/=6;}
r=g=b=Math.round(l*255);this.accessible[aCouleur]='#'+(r<16?'0':'')+r.toString(16)+(g<16?'0':'')+g.toString(16)+(b<16?'0':'')+b.toString(16);return this.accessible[aCouleur];};_ObjetCouleur.prototype.getCouleurTransparente=function(aColor,aOpacity,aBackground,aBackOpa){if(!aColor||!aColor.substr) return false;if(aOpacity<0||aOpacity>1) return false;if(!aBackOpa||aBackOpa<0||aBackOpa>1) aBackOpa=1;var lDest=[];var lFond=[255,255,255];var lOrig=[];if(aBackground&&aBackground.substr){lFond[0]=parseInt(aBackground.substr(1,2),16);lFond[1]=parseInt(aBackground.substr(3,2),16);lFond[2]=parseInt(aBackground.substr(5,2),16);}
lDest[0]=parseInt(aColor.substr(1,2),16);lDest[1]=parseInt(aColor.substr(3,2),16);lDest[2]=parseInt(aColor.substr(5,2),16);for(var i=0;i<3;i++){lOrig[i]=Math.floor(((lDest[i]*(aOpacity+aBackOpa*(1-aOpacity)))-((lFond[i]*aBackOpa)*(1-aOpacity)))/aOpacity);if(lOrig[i]>255||lOrig[i]<0) return false;}
return'#'+(lOrig[0]<16?'0':'')+lOrig[0].toString(16)+(lOrig[1]<16?'0':'')+lOrig[1].toString(16)+(lOrig[2]<16?'0':'')+lOrig[2].toString(16);};function ObjectCouleurCellule(aFond,aTexte,aBordure){this.fond=aFond;this.texte=aTexte;this.bordure=aBordure;}
ObjectCouleurCellule.prototype.getFond=function(aPourImpression){return aPourImpression?GCouleur.blanc:this.fond;};ObjectCouleurCellule.prototype.getTexte=function(aPourImpression){return aPourImpression?GCouleur.noir:this.texte;};ObjectCouleurCellule.prototype.getBordure=function(aPourImpression){return aPourImpression?GCouleur.noir:this.bordure;};;
MethodesObjet.heritagePrototype(ObjetCouleur,_ObjetCouleur);function ObjetCouleur(aThemeEspace,aEstAccessible,aAvecNonEditable){this.inheritedCreate(aThemeEspace,aEstAccessible,aAvecNonEditable);this.service=this.intermediaire;this.note='#FFFFCC';this.periodesFonce=new Array('','#CC33CC','#399361','#3399FF','#CC33CC','#399361','#CC33CC');this.periodesClair=new Array('','#EBA2D5','#8CE4A3','#A9D4E9','#EBA2D5','#8CE4A3','#EBA2D5');this.suiviAbsence='#F5DEB3';this.suiviAbsenceRepas='#DAFFEF';this.suiviRetard='#DADEFF';this.suiviAbsenceInternat='#F9DFEA';$.extend(this.grille,{indisponibilite:'#D47979',demiPensionActive:'#52E252',demiPensionInactive:'#B54095',indisponibiliteSession:'#0066CC',horsPlageSessionRencontre:'#F0F0F0',recreations:'#F4D217',gabarit:'#00BF00'});this.grilleOccupation={fond:'#808080',placeLibre:'white'};this.grilleSlider={fond:'#D8D8D8',fondBouton:'#F0F0F0',fondBoutonSurvol:'#D0D0D0',fondBoutonSelectionne:'white',boutonBordureFonce:'#A0A0A0',boutonBordureClaire:'white'};this.voeuxRencontres=["#FFFFFF","#F7B95D","#7EECAA","#F95959"];this.diagnostic={placeLibre:'white',occupation:'red',demiPension:'#884605',site:'#FF00CC',absenceRessource:'#CC0033',indisponibilite:'red',gaev:'#CC0033'};this.ficheCours={bandeauEnTete:this.grisFonce,coursSelectionne:'#00BF00'};}
ObjetCouleur.prototype.composeCouleurSelection=function(){return GStyle.composeCouleur(this.selection.fond,this.selection.texte);};ObjetCouleur.prototype.setCouleurSelection=function(aId){GStyle.setCouleur(aId,this.selection.fond,this.selection.texte);};;
var EGenreDomaineFrequence={H:0,QZ1:1,QZ2:2};EGenreDomaineFrequence.getCouleur=function(aGenre){switch(aGenre){case EGenreDomaineFrequence.H:return'white';case EGenreDomaineFrequence.QZ1:return GCouleur.fenetre.cumul;case EGenreDomaineFrequence.QZ2:return GCouleur.fenetre.intermediaire;}
return'white';};;
var EGenrePeriodeDeNotation={Trimestre1:0,Trimestre2:1,Trimestre3:2,Semestre1:3,Semestre2:4,Annuelle:5,Utilisateur:6};EGenrePeriodeDeNotation.estTrimestrielle=function(aGenrePeriodeDeNotation){return MethodesTableau.existe(aGenrePeriodeDeNotation,[this.Trimestre1,this.Trimestre2,this.Trimestre3]);};EGenrePeriodeDeNotation.estSemestrielle=function(aGenrePeriodeDeNotation){return MethodesTableau.existe(aGenrePeriodeDeNotation,[this.Semestre1,this.Semestre2]);};EGenrePeriodeDeNotation.estAnnuelle=function(aGenrePeriodeDeNotation){return MethodesTableau.existe(aGenrePeriodeDeNotation,[this.Annuelle]);};EGenrePeriodeDeNotation.estOfficielle=function(aGenrePeriodeDeNotation){return this.estTrimestrielle(aGenrePeriodeDeNotation)||this.estSemestrielle(aGenrePeriodeDeNotation)||this.estAnnuelle(aGenrePeriodeDeNotation);};;

function ObjetParametres(aJSON){if(aJSON.themeCouleur){this.themeCouleur=aJSON.themeCouleur;GThemesCouleurs.setListeThemes(aJSON.listeThemes);GThemesCouleurs.definirThemeCouleur(aJSON.themeCouleur,aJSON.themeNeutre,aJSON.nonEditable);}
GApplication.initDateServeur(aJSON.DateServeurHttp);GApplication.setDateDemo(aJSON.DateDemo);this.genreImageConnexion=aJSON.genreImageConnexion;this.urlImageConnexion=aJSON.urlImageConnexion;this.avecAccesMobile=aJSON.AvecEspaceMobile;this.URLMobile=aJSON.URLMobile;this.URLEspace=aJSON.URLEspace;var lJGeneral=aJSON.General;this.version=lJGeneral.Version;this.versionPN=lJGeneral.VersionPN;this.millesime=lJGeneral.Millesime;this.langue=lJGeneral.langue;this.urlSiteIndexEducation=lJGeneral.LienSiteIndexEducation;this.urlManuel=lJGeneral.UrlManuel;this.urlTutorial=lJGeneral.UrlTutorial;this.avecBoutonMembre=lJGeneral.AvecBoutonMembre;this.avecLogoConnexion=lJGeneral.AvecLogo;this.logo=lJGeneral.logo;this.avecChoixConnexion=lJGeneral.AvecChoixConnexion;this.conserverNumerosCalendaires=lJGeneral.ConserverNumerosCalendaires;this.anneeScolaire=lJGeneral.AnneeScolaire;this.dateDebutPremierCycle=lJGeneral.dateDebutPremierCycle;this.PremierLundi=lJGeneral.PremierLundi;this.PremiereDate=lJGeneral.PremiereDate;this.DerniereDate=lJGeneral.DerniereDate;this.PremierJourSemaine=GDate.GetJourDeDate(this.PremierLundi);this.DernierJourSemaine=(this.PremierJourSemaine+6)%7;this.listeJoursFeries=lJGeneral.listeJoursFeries;this.JourOuvre=lJGeneral.JourOuvre;this.JoursOuvres=lJGeneral.JoursOuvres;this.DemiJourneesOuvrees=lJGeneral.DemiJourneesOuvrees;this.JoursFeries=this.getJoursFeries();this.PlacesParJour=lJGeneral.PlacesParJour;this.PlacesParHeure=lJGeneral.PlacesParHeure;this.DureeSequence=lJGeneral.DureeSequence;this.PlaceDemiJournee=lJGeneral.PlaceDemiJourneeAbsence;this.joursOuvresParCycle=lJGeneral.joursOuvresParCycle;this.premierJourSemaine=lJGeneral.premierJourSemaine;this.grillesEDTEnCycle=lJGeneral.grillesEDTEnCycle;this.setOfJoursCycleOuvre=lJGeneral.setOfJoursCycleOuvre;this.activationDemiPension=lJGeneral.activationDemiPension;this.debutDemiPension=lJGeneral.debutDemiPension;this.finDemiPension=lJGeneral.finDemiPension;this.recreations=lJGeneral.recreations;this.AvecHeuresPleinesApresMidi=lJGeneral.AvecHeuresPleinesApresMidi;this.LibellesHeures=lJGeneral.ListeHeures;this.PremiereHeure=lJGeneral.PremiereHeure;this.afficherSequences=lJGeneral.afficherSequences;this.sequences=lJGeneral.sequences;this.NomEtablissement=lJGeneral.NomEtablissement;this.NomEspace=aJSON.Nom;this.tailleMaxAppreciation=lJGeneral.TailleMaxAppreciation;this.baremeNotation=lJGeneral.BaremeNotation;if(window.TypeNote){window.TypeNote.baremeNotation=this.baremeNotation;}
this.minBaremeQuestionQCM=lJGeneral.minBaremeQuestionQCM;this.maxBaremeQuestionQCM=lJGeneral.maxBaremeQuestionQCM;this.maxNombrePointsQCM=lJGeneral.maxNbPointQCM;this.afficherAbbreviationNiveauDAcquisition=lJGeneral.AfficherAbbreviationNiveauDAcquisition;this.avecEvaluationHistorique=lJGeneral.AvecEvaluationHistorique;this.B2I=new ObjetElement().fromJSON(lJGeneral.B2I);this.avecLiveEdu=false;this.avecRecuperationInfosConnexion=lJGeneral.AvecRecuperationInfosConnexion;this.police=lJGeneral.Police;this.taillePolice=lJGeneral.TaillePolice+'px';var lDomainesFrequences=lJGeneral.DomainesFrequences;var lLibellesFrequences=lJGeneral.LibellesFrequences;this.frequences=[];for(var lNumeroSemaine=1;lNumeroSemaine<=ObjetCycles.C_MaxDomaineCycle;lNumeroSemaine++){this.frequences[lNumeroSemaine]={};for(var I in EGenreDomaineFrequence){var lGenre=EGenreDomaineFrequence[I];if((lGenre===EGenreDomaineFrequence.QZ1)||(lGenre===EGenreDomaineFrequence.QZ2)){if(lDomainesFrequences[lGenre].GetValeur(lNumeroSemaine)){this.frequences[lNumeroSemaine].genre=lGenre;this.frequences[lNumeroSemaine].libelle=lLibellesFrequences[lGenre];}}}}
this.themeParDefaut=aJSON.Theme;this.initialiserCouleur();this.listePeriodes=new ObjetListeElements().fromJSON(lJGeneral.ListePeriodes,this._ajouterPeriode);}
ObjetParametres.prototype.getLibelleHeure=function(aPlace){try{return this.LibellesHeures.GetLibelle(aPlace);} catch(e){return'';}};ObjetParametres.prototype.getThemeCourant=function(){var lThemeSauvegarde=window.GApplication&&window.GApplication.parametresUtilisateur&&window.GApplication.parametresUtilisateur.get&&window.GApplication.parametresUtilisateur.get('theme');var lTheme=GThemesCouleurs.getThemeCourant({genreEspace:GEtatUtilisateur.GenreEspace,themeParDefaut:this.themeParDefaut,theme:lThemeSauvegarde});return lTheme;};ObjetParametres.prototype.initialiserCouleur=function(aTheme){var lTheme=(aTheme!==undefined)?aTheme:this.getThemeCourant();GCouleur=new ObjetCouleur(lTheme.theme,GEtatUtilisateur.estModeAccessible(),!MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Parent,EGenreEspace.Eleve]));setTimeout(function(){IE.Invocateur.evenement(IE.Invocateur.events.modificationThemeCouleur);},1);GHtml.addClass('id_body','Scroll PageConnexion');};ObjetParametres.prototype.getOngletLibelleMobile=function(aGenreOnglet){if(aGenreOnglet===EGenreOnglet.ParametresMobile)
return GTraductions.getValeur('accueil.ParametresMobile');else if(aGenreOnglet===EGenreOnglet.ListeEleves)
return GTraductions.getValeur('accueil.trombinoscope');else if(aGenreOnglet===EGenreOnglet.Accueil)
return'';else return GTraductions.getValeur('Onglet.Libelle')[aGenreOnglet];};ObjetParametres.prototype.GetNomEspace=function(){return this.NomEspace;};ObjetParametres.prototype.getJoursFeries=function(){var lJoursFeries=new TypeDomaine(null,365);for(var I=0;I<this.listeJoursFeries.GetNbrElements();I++){var lJourFerie=this.listeJoursFeries.GetElement(I);lJoursFeries.SetValeur(true,GDate.getNbrJoursEntreDeuxDates(lJourFerie.dateDebut,this.dateDebutPremierCycle),GDate.getNbrJoursEntreDeuxDates(lJourFerie.dateFin,this.dateDebutPremierCycle));}
return lJoursFeries;};ObjetParametres.prototype.getDomaineCycleFerie=function(){if(!this.domaineCycleFerie){this.domaineCycleFerie=new TypeDomaine();var lCycle,lJourCycle,LSemaineFeriee,lNombreCycles=IE.Cycles.nombreCyclesAnneeScolaire(),lNombreJoursCycle=IE.Cycles.nombreJoursOuvresParCycle();for(lCycle=1;lCycle<=lNombreCycles;lCycle+=1){LSemaineFeriee=true;for(lJourCycle=0;lJourCycle<lNombreJoursCycle&&LSemaineFeriee;lJourCycle+=1){var lJourAnnuel=GDate.getNbrJoursEntreDeuxDates(IE.Cycles.jourCycleEnDate(lJourCycle,lCycle),this.dateDebutPremierCycle);LSemaineFeriee=this.JoursFeries.GetValeur(lJourAnnuel);}
this.domaineCycleFerie.SetValeur(LSemaineFeriee,lCycle);}}
return this.domaineCycleFerie;};ObjetParametres.prototype.getTailleMaxAppreciationParEnumere=function(aGenre){var lTailleMaxAppreciation=255;if(aGenre!==null) lTailleMaxAppreciation=this.tailleMaxAppreciation[aGenre];return lTailleMaxAppreciation?lTailleMaxAppreciation:1000000;};ObjetParametres.prototype._ajouterPeriode=function(aJSON,aElement){aElement.periodeDeNotation=aJSON.PeriodeDeNotation;aElement.dates={};aElement.dates.debut=aJSON.DateDebut;aElement.dates.fin=aJSON.DateFin;};ObjetParametres.prototype.getDatesPeriodeDeNotation=function(aNumeroPeriode){var lPeriode=this.listePeriodes.GetElementParNumero(aNumeroPeriode);return lPeriode?lPeriode.dates:null;};ObjetParametres.prototype.getDateDansPeriodeDeNotation=function(aDate,aNumeroPeriode){var lDates=this.getDatesPeriodeDeNotation(aNumeroPeriode);var lDate=aDate?aDate:GDate.getDateCourante();if(lDates&&(lDate>lDates.fin))
return lDates.fin;if(lDates&&(lDate<lDates.debut))
return lDates.debut;return lDate;};ObjetParametres.prototype.getPeriodeDeNotation=function(aNumeroPeriode){var lPeriode=this.listePeriodes.GetElementParNumero(aNumeroPeriode);return lPeriode?lPeriode.periodeDeNotation:null;};ObjetParametres.prototype.getPeriodeDeNotationParGenre=function(aGenrePeriodeDeNotation){for(var i=0;i<this.listePeriodes.GetNbrElements();i++){var lPeriode=this.listePeriodes.GetElement(i);if(aGenrePeriodeDeNotation===lPeriode.periodeDeNotation)
return lPeriode;}};ObjetParametres.prototype.estPeriodeTrimestrielle=function(aNumeroPeriode){return EGenrePeriodeDeNotation.estTrimestrielle(this.getPeriodeDeNotation(aNumeroPeriode));};ObjetParametres.prototype.estPeriodeSemestrielle=function(aNumeroPeriode){return EGenrePeriodeDeNotation.estSemestrielle(this.getPeriodeDeNotation(aNumeroPeriode));};ObjetParametres.prototype.estPeriodeAnnuelle=function(aNumeroPeriode){return EGenrePeriodeDeNotation.estAnnuelle(this.getPeriodeDeNotation(aNumeroPeriode));};ObjetParametres.prototype.estPeriodeOfficielle=function(aNumeroPeriode){return EGenrePeriodeDeNotation.estOfficielle(this.getPeriodeDeNotation(aNumeroPeriode));};;

MethodesObjet.heritagePrototype(ObjetApplicationProduits,ObjetApplicationPN);function ObjetApplicationProduits(){this.inheritedCreate();}(function(){var uGestionPresence={modeExclusif:false,compteurAffichageMessagerie:0};ObjetApplicationProduits.prototype.lancer=function(aParam){this.setDemo(!!aParam.d);if(window._ObjetCommunication){var lOptionsSecurite={};if(aParam.sCrA)
lOptionsSecurite.sansCryptageAES=true;if(aParam.sCoA)
lOptionsSecurite.sansCompressionAES=true;window._ObjetCommunication.optionsSecurite=lOptionsSecurite;}
if(window.GCryptage&&GCryptage.cryptageRSA)
GCryptage.cryptageRSA.setClePublique(aParam.MR,aParam.ER);else throw'RSA';var lParametres={genreEspace:aParam.a,numeroJeton:aParam.e?aParam.e:-1,cleJeton:aParam.f?aParam.f:'',genreAcces:aParam.g?aParam.g:0,numeroSession:aParam.h,page:aParam.p};this.acces=new ObjetAcces(lParametres.genreAcces,lParametres.genreEspace,0,0,lParametres.numeroJeton,0,'','');if(this.acces.estConnexionCAS()){this.acces.setIdentification(lParametres.numeroJeton,lParametres.cleJeton);}
;this.droits=new IEClasses.ObjetDroitsPN();this.parametresUtilisateur=new IEClasses.ObjetParametresUtilisateur();GNavigateur.Initialiser();IE.deferLoadingScript.setOptions({done:function(){IE.Invocateur.evenement(IE.Invocateur.events.modificationThemeCouleur);},fail:function(aNom){;IE.Requetes('Presence').lancerRequete();}});this.initialisation(lParametres);this.lancerRequeteParametres(lParametres);IE.Invocateur.abonner('affichage_messagerie',_surNotificationAffichageMessagerie.bind(this));};ObjetApplicationProduits.prototype.initialisation=function(aParametres){};ObjetApplicationProduits.prototype.lancerRequeteParametres=function(aParametres){new ObjetRequeteFonctionParametres(this,this.surRequeteParametres.bind(this,aParametres)).lancerRequete({espace:aParametres.genreEspace,uuidRSA:GCryptage.cryptageRSA.encrypter(this.getCommunication().ivAESTemp)});this.getCommunication().setIvAES();};ObjetApplicationProduits.prototype.surRequeteParametres=function(aParametres,aJSON){try{GParametres=new ObjetParametres(aJSON);this.initialisationApresParametres(aParametres);} catch(e){alert("Erreur : "+e.message);}};ObjetApplicationProduits.prototype.initialisationApresParametres=function(aParametres){function _surUnload(){this.getCommunication().desactiverPresence();}
Invocateur.abonner(Invocateur.events.surRechargementPage,_surUnload.bind(this));this.initialisationObjetsPage();GDate.SetDonnees(GParametres.PremierLundi,GParametres.PremiereDate,GParametres.DerniereDate,GParametres.PlacesParJour,GParametres.PlacesParHeure,GParametres.DureeSequence,GParametres.PremiereHeure,GParametres.LibellesHeures,null,GParametres.JoursOuvres);var lJoursFeries=[],lJourFerie,I,lNb,lIndiceJour;lJoursFeries=new TypeEnsembleNombre();for(I=0,lNb=GParametres.listeJoursFeries.GetNbrElements();I<lNb;I++){lJourFerie=GParametres.listeJoursFeries.GetElement(I);for(lIndiceJour=GDate.getNbrJoursEntreDeuxDates(lJourFerie.dateDebut,GParametres.dateDebutPremierCycle);lIndiceJour<=GDate.getNbrJoursEntreDeuxDates(lJourFerie.dateFin,GParametres.dateDebutPremierCycle);lIndiceJour++){lJoursFeries.add(lIndiceJour);}}
IE.Cycles=new ObjetCycles();IE.Cycles.init({premiereDate:GParametres.PremiereDate,derniereDate:GParametres.DerniereDate,dateDebutPremierCycle:GParametres.dateDebutPremierCycle,joursOuvresParCycle:GParametres.joursOuvresParCycle,premierJourSemaine:GParametres.premierJourSemaine,joursOuvres:GParametres.setOfJoursCycleOuvre,grillesEDTEnCycle:GParametres.grillesEDTEnCycle,joursFeries:lJoursFeries});IE.CyclesCompletSemaine=new ObjetCycles();var lJoursOuvres=new TypeEnsembleNombre();lJoursOuvres.add(0);lJoursOuvres.add(1);lJoursOuvres.add(2);lJoursOuvres.add(3);lJoursOuvres.add(4);lJoursOuvres.add(5);lJoursOuvres.add(6);IE.CyclesCompletSemaine.init({premiereDate:GParametres.PremierLundi,derniereDate:GParametres.DerniereDate,joursOuvresParCycle:7,joursOuvres:lJoursOuvres,joursFeries:lJoursFeries});};ObjetApplicationProduits.prototype.destructionInterface=function(){if(window.GInterface&&GInterface._DetruireInstances)
GInterface._DetruireInstances();};ObjetApplicationProduits.prototype.getJeton=function(aFrames){var lJeton;for(var i=0;i<aFrames.length&&(!lJeton);i++){try{lJeton=aFrames[i].frames[0].GJeton;} catch(e){}
try{if(!lJeton&&aFrames[i].frames.length>0)
lJeton=this.getJeton(aFrames[i].frames);} catch(e){}}
return lJeton;};ObjetApplicationProduits.prototype.creerFenetreDebug=function(){if(!IEClasses.ObjetConteneurDebug){return;}
var lOptionsDebug=this.getOptionsDebug();this[this.nomPropConteneurDebug()]=new IEClasses.ObjetConteneurDebug(this.getNom()+'.'+this.nomPropConteneurDebug(),lOptionsDebug,'dev',this.getConstructeursDebug);if(lOptionsDebug&&lOptionsDebug.clesTraduc)
GTraductions._DEBUG_PasserEnCleDeTraductions();};ObjetApplicationProduits.prototype.getOptionsDebug=function(){return null;};ObjetApplicationProduits.prototype.getConstructeursDebug=function(){return{constructeurFenetre:null,constructeurTraitements:null};};ObjetApplicationProduits.prototype.initialisationObjetsPage=function(){};ObjetApplicationProduits.prototype._verificationAjoutObjetDansTableau=function(aTableau,aGenre,aNom){if(this.estDebug()){;;}};ObjetApplicationProduits.prototype.avecGestionModeExclusif=function(){return false;};ObjetApplicationProduits.prototype.entreeModeExclusif=function(){if(!this.avecGestionModeExclusif())
return;this.inherited('entreeModeExclusif');this.getMessage().afficher({type:EGenreBoiteMessage.Information,titre:GTraductions.getValeur('ModeExclusif.UsageExclusif'),message:GTraductions.getValeur('ModeExclusif.EntrerModeExclusif'),delaiFermeture:true});uGestionPresence.modeExclusif=true;_modificationTimerPresence.bind(this)();};ObjetApplicationProduits.prototype.sortieModeExclusif=function(){if(!this.avecGestionModeExclusif())
return;this.inherited('sortieModeExclusif');this.getMessage().afficher({type:EGenreBoiteMessage.Information,titre:GTraductions.getValeur('ModeExclusif.UsageExclusif'),message:GTraductions.getValeur('ModeExclusif.SortieModeExclusif'),delaiFermeture:true});uGestionPresence.modeExclusif=false;_modificationTimerPresence.bind(this)();};function _modificationTimerPresence(){var lTimer=_ObjetCommunication.cDureeTimerPresence;if(uGestionPresence.modeExclusif){lTimer=1000*30;}
else if(uGestionPresence.compteurAffichageMessagerie>0){lTimer=1000*30;}
this.getCommunication().setDureeTimerPresence(lTimer);}
function _surNotificationAffichageMessagerie(aEntreeSurAffichage){uGestionPresence.compteurAffichageMessagerie=Math.max(uGestionPresence.compteurAffichageMessagerie+(aEntreeSurAffichage?1:-1),0);_modificationTimerPresence.bind(this)();}
ObjetApplicationProduits.prototype.finSession=function(aParametres){this.getCommunication().desactiverPresence();this.destructionInterface();this.inherited('finSession',aParametres);GInterface=null;};ObjetApplicationProduits.prototype.construireEnTetePageFinSession=function(aParametres){var T=[];if(window.GParametres&&(GParametres.NomEspace||GParametres.NomEtablissement)){T.push('<div class="Texte" style="font-size:20px; padding:5px;',GStyle.composeCouleurTexte(aParametres.couleur.texte),'">');if(GParametres.NomEspace)
T.push('<div class="Gras" style="float:left;','">',GParametres.NomEspace,'</div>');if(GParametres.NomEtablissement)
T.push('<div style="float:right">',GParametres.NomEtablissement,'</div>');T.push('</div>');}
return T.join('');};}());;
IE.Hint={};(function(){var ldelaiTimer=600,lDelaiFondu=200,uTimeoutFondu=null,uIdConteneur=IE.GUID.getId(),uHintsEnAttente=[],uHintAffiche=null,uHintInitialise=false,uConteneurEventInvocateur={};IE.Hint.start=function(aContenu,aSansDelai){if(!uHintInitialise){uHintInitialise=true;$(document).on('iedown.Hint keydown.Hint',_stopAll);$(window).on('resize.Hint',function(event){if(uHintAffiche&&uHintAffiche.hintTouch) return;_stopAll(event);});if(!IE.Support.supportTouchPointerEvent)
$('body').on('mouseleave.Hint',_stopAll);}
var lHint={actif:false};if(!aContenu||(aContenu==='')){return lHint;}
lHint.actif=true;uHintsEnAttente.push(lHint);if(aSansDelai){_afficher.bind(this)(aContenu,lHint);}
else{lHint.timer=setTimeout(_afficher.bind(this,aContenu,lHint),ldelaiTimer);}
return lHint;};IE.Hint.stop=function(aHint){if(aHint){var lARetirer=!aHint.estAffiche;_stopHint(aHint);if(lARetirer)
setTimeout(function(){_retirerHintPileAttente(aHint);},0);}
else{_stopAll();}};IE.Hint.attach=function(aParam){var lNamespace=aParam.namespace?aParam.namespace='.'+aParam.namespace:'IEHint',lContenu=aParam.contenu,lInterrupt=aParam.interrupt,lMargeDeplacement=50,lHint,lTimeoutTouch,lStop=function(){clearTimeout(lTimeoutTouch);IE.Invocateur.desabonner(GNavigateur.getEventInvocateur('iemove'),uConteneurEventInvocateur);IE.Hint.stop(lHint);lHint=null;};aParam.$Element.off('mouseenter'+lNamespace+' mouseleave'+lNamespace+' destroyed'+lNamespace+' iedown'+lNamespace).on('mouseenter'+lNamespace,function(event){if(GNavigateur.touchEnCours) return;if(lInterrupt&&lInterrupt.call(this,event)) return;lHint=IE.Hint.start(lContenu,false);}).on('destroyed'+lNamespace+' mouseleave'+lNamespace,function(){if(lHint&&lHint.hintTouch) return;lStop();}).on('iedown'+lNamespace,function(event){if(!event.estTouch) return;if(lInterrupt&&lInterrupt.call(this,event)) return;event.originalEvent.hintTouch=true;lHint=IE.Hint.start(lContenu,true);lHint.hintTouch=true;lHint.position={x:event.clientX,y:event.clientY};clearTimeout(lTimeoutTouch);lTimeoutTouch=setTimeout(function(){if(lHint&&lHint.actif&&lHint.estAffiche){lStop();}},1500);var lTestDeplacement=function(event){if(lHint&&lHint.actif&&lHint.estAffiche&&lHint.position&&(Math.abs(event.clientX-lHint.position.x)>lMargeDeplacement||Math.abs(event.clientY-lHint.position.y)>lMargeDeplacement)){lStop();}};IE.Invocateur.desabonner(GNavigateur.getEventInvocateur('iemove'),uConteneurEventInvocateur);IE.Invocateur.abonner(GNavigateur.getEventInvocateur('iemove'),lTestDeplacement,uConteneurEventInvocateur);});aParam.$Element=null;};function _stopHint(aHint){if(!aHint) return;if(aHint.estAffiche){uHintAffiche=null;if(IE.Support.avecSupportTransitions){GStyle.setOpacity(uIdConteneur,0);clearTimeout(uTimeoutFondu);uTimeoutFondu=setTimeout(function(){GHtml.supprimerElementDOM(uIdConteneur);uTimeoutFondu=null;},lDelaiFondu);}
else{GHtml.supprimerElementDOM(uIdConteneur);}}
if(aHint.timer)
clearTimeout(aHint.timer);aHint.estAffiche=false;aHint.actif=false;}
function _stopEnAttente(){var lHintEnAttente;for(var i=0,lNb=uHintsEnAttente.length;i<lNb;i++){lHintEnAttente=uHintsEnAttente[i];if(lHintEnAttente){lHintEnAttente.actif=false;if(lHintEnAttente.timer)
clearTimeout(lHintEnAttente.timer);}}
uHintsEnAttente=[];}
function _stopAll(event){if(event&&event.originalEvent&&event.originalEvent.hintTouch)
return;if(uHintAffiche){_stopHint(uHintAffiche);}
_stopEnAttente();}
function _getContenu(aContenu){var lContenu=aContenu;if(MethodesObjet.isFunction(aContenu)){lContenu=aContenu();}
if(window.GChaine&&window.GChaine.toHTML)
lContenu=GChaine.toHTML();return lContenu;}
function _retirerHintPileAttente(aHint){var lIndice=IE.MethodesTableau.chercher(aHint,uHintsEnAttente);if(lIndice>=0)
IE.MethodesTableau.supprimerElement(uHintsEnAttente,lIndice);}
function _afficher(aContenu,aHint){var lContenu=_getContenu.bind(this)(aContenu);if(!aHint.actif||!lContenu||(lContenu==='')){aHint.timer=null;aHint.actif=false;return;}
_retirerHintPileAttente(aHint);_stopAll();uHintAffiche=aHint;clearTimeout(uTimeoutFondu);aHint.estAffiche=true;aHint.timer=null;var lConteneur=GHtml.getElement(uIdConteneur);if(!GHtml.elementExiste(lConteneur)){lConteneur=GHtml.htmlToDOM('<div id="'+uIdConteneur+'" style="position:absolute; z-index:10000;'+(IE.Support.avecSupportTransitions?GStyle.composeTransitions('opacity',(lDelaiFondu/1000)+'s')+GStyle.composeOpacite(0):'')+'"></div>');GHtml.insererElementDOM(GHtml.getElement(GApplication.getIdConteneur()),lConteneur);}
GHtml.setHtml(lConteneur,compose(lContenu));var lTop=GNavigateur.SourisY;var lLeft=GNavigateur.SourisX;GPosition.placerFicheSource(uIdConteneur,lLeft+5,lLeft+5,lTop+12,lTop+12,false);GStyle.setOpacity(lConteneur,1);}
function compose(aContenu){var lHtml=[];lHtml.push('<div tabindex="-1" class="SansOutline"',' style="width:auto; height:auto; cursor:default;',GStyle.composeCouleur(GCouleur.fond,GCouleur.texte,GCouleur.bordure),GStyle.composeBoxShadow(),'">','<div class="Texte10 PetitEspace">',aContenu,'</div>','</div>');return lHtml.join('');}}());;
(function($){$.fn.jIECheckBox=function(aOptions){var lInputs=[];this.each(function(){var lJqthis=$(this);var lEstCB=lJqthis.is(':checkbox');var lEstRB=lJqthis.is(':radio');if(!lEstCB&&!lEstRB){return;}
var lNodeParent=lJqthis.parent().get(0);if(lJqthis.parent().hasClass('jIECheckBox_Image')){return;}
if(lEstCB){lJqthis.attr('ie-checkbox','');}
else{lJqthis.attr('ie-radio','') ;}
if(aOptions){var lCss={};if(IE.MethodesObjet.isNumber(aOptions.marginLeftMin)) lCss['margin-left']=aOptions.marginLeftMin+'px';if(IE.MethodesObjet.isNumber(aOptions.marginRightMin)) lCss['margin-right']=aOptions.marginRightMin+'px';if(IE.MethodesObjet.isNumber(aOptions.marginTopMin)) lCss['margin-top']=aOptions.marginTopMin+'px';if(IE.MethodesObjet.isNumber(aOptions.marginBottomMin)) lCss['margin-bottom']=aOptions.marginBottomMin+'px';lJqthis.css(lCss);}
var lNode=IE.HTML.injectHTML(lNodeParent,this,null,true,this.nextSibling);var lInput=$(lNode).find('input').get(0);if(lInput){lInputs.push(lInput);lJqthis=$(lInput);lJqthis.parent().parent().addClass(this.className);lJqthis.data('jIECheckBox',{destroy:function(){lJqthis.parent().parent().replaceWith(lJqthis.css('opacity',1).removeData('jIECheckBox').detach());return lJqthis;}});}});return $(lInputs);};$.fn.jIEInterdireSelectionTexte=function(){var lSupport=IE?IE.Support:null,lFunction=function onSelectStart(event){var lName=event.target.tagName.toLowerCase();return lName==='input'||lName==='textarea'||(event.originalEvent&&event.originalEvent.__marqueurAutoriserSelection===true);},lFunctionAutoriser=function onSelectStartAutoriser(event){event.originalEvent.__marqueurAutoriserSelection=true;return true;};if((lSupport&&lSupport.avecUserSelect)||!lSupport){this.addClass('SansSelectionTexte');}
if((lSupport&&!lSupport.avecUserSelect)||!lSupport){this.bind('selectstart',lFunction).on({selectstart:lFunctionAutoriser},'.AvecSelectionTexte');}};$.fn.jIEDesactiverMenuContextuel=function(){return this.bind('contextmenu',$.fn.jIEDesactiverMenuContextuel.accepteContextMenuNatif).on({contextmenu:function(event){event.originalEvent.__marqueurAutoriserMenuContextuel=true;return true;}},'.AvecMenuContextuel');};$.fn.jIEDesactiverMenuContextuel.accepteContextMenuNatif=function(event){if(event.type!=='contextmenu'){return false;}
var lName=event.target&&event.target.tagName?event.target.tagName.toLowerCase():'',lType=event.target.type||'';lType=lType.toLowerCase();var lInputConcerne=(lName==='input'&&lType!=='checkbox'&&lType!=='radio'&&lType!=='button')||(lName==='textarea');return(lInputConcerne&&!$(event.target).hasClass('SansMenuContextuel'))||(event.originalEvent&&event.originalEvent.__marqueurAutoriserMenuContextuel===true)||$(event.target).hasClass('AvecMenuContextuel');};}(jQuery));(function($){$.fn.jIEBracketize=function(aOptions){var lOptions={genre:'bracket',style:'curly',direction:'left',fontSize:25,ratio:0.5,marginBottomMin:0,forced:false,height:undefined};$.extend(lOptions,aOptions);return this.each(function(){var lHeight=$(this).height();if(lOptions.height) lHeight=lOptions.height;if(lHeight<3*lOptions.fontSize){if(!lOptions.forced){;return $(this);} else{lHeight=3*lOptions.fontSize;}}
var lSymbole={top:'&#x23a7;',middle:'&#x23a8;',bottom:'&#x23a9;',line:'&#x23aa;'};if(lOptions.genre==='bracket'){if(lOptions.style==='curly'){if(lOptions.direction==='right'){lSymbole={top:'&#x23ab;',middle:'&#x23ac;',bottom:'&#x23ad;',line:'&#x23aa;'};}} else if(lOptions.style==='square'){if(lOptions.direction==='right'){lSymbole={top:'&#x23a4;',middle:'&#x23a5;',bottom:'&#x23a6;',line:'&#x23a5;'};} else if(lOptions.direction==='left'){lSymbole={top:'&#x23a1;',middle:'&#x23a2;',bottom:'&#x23a3;',line:'&#x23a2;'};}}} else if(lOptions.genre==='parenthesis'){if(lOptions.direction==='left'){lSymbole={top:'&#x239b;',middle:'&#x239c;',bottom:'&#x239d;',line:'&#x239c;'};} else if(lOptions.direction==='right'){lSymbole={top:'&#x239e;',middle:'&#x239f;',bottom:'&#x23a0;',line:'&#x239f;'};}}
var lPositionMiddle=(lHeight*lOptions.ratio)-(lOptions.fontSize/2);var lHeightLineTop=lPositionMiddle-lOptions.fontSize;var lHeightLineBottom=lHeight-lPositionMiddle-(2*lOptions.fontSize);var lHtml=[];var i;lHtml.push('<span style="font-size:',lOptions.fontSize,'px;line-height:',lOptions.fontSize,'px;">');lHtml.push(lSymbole.top,'<br />');if(lHeightLineTop>0){var lNbLineTop=Math.floor(lHeightLineTop/lOptions.fontSize);for(i=0;i<lNbLineTop;i++) lHtml.push(lSymbole.line,'<br />');if(lNbLineTop*lOptions.fontSize<lHeightLineTop){lHtml.push('<span style="line-height:',(lHeightLineTop%lOptions.fontSize),'px">',lSymbole.line,'</span><br />');}}
lHtml.push(lSymbole.middle,'<br />');if(lHeightLineBottom>0){var lNbLineBottom=Math.floor(lHeightLineBottom/lOptions.fontSize);for(i=0;i<lNbLineBottom;i++) lHtml.push(lSymbole.line,'<br />');if(lNbLineBottom*lOptions.fontSize<lHeightLineBottom){lHtml.push('<span style="line-height:',(lHeightLineBottom%lOptions.fontSize),'px">',lSymbole.line,'</span><br />');}}
lHtml.push(lSymbole.bottom);lHtml.push('</span>');$(this).html(lHtml.join(''));return $(this);});};}(jQuery));$.fn.jIEDraggable=function(aOptions){var lOptions,lRestore,lStart,lStop;if($.fn.draggable){lRestore=null;lStart=function(){GStyle.setTransitions(this,'opacity','0.2s');lRestore=null;if(this&&this.style){lRestore={};if(lOptions.axis!=="y"&&$(this).css("right")!=="auto"){lRestore.width=this.style.width;lRestore.right=this.style.right;}
if(lOptions.axis!=="x"&&$(this).css("bottom")!=="auto"){lRestore.height=this.style.height;lRestore.bottom=this.style.bottom;}}};lStop=function(){$(this).css('opacity',1);if(lRestore){try{if(lRestore.width!==undefined)
this.style.width=lRestore.width;if(lRestore.right!==undefined)
this.style.right=lRestore.right;if(lRestore.height!==undefined)
this.style.height=lRestore.height;if(lRestore.bottom!==undefined)
this.style.bottom=lRestore.bottom;} catch(e){}
lRestore=null;}};lOptions={containment:'document',opacity:0.5,start:lStart,stop:lStop};$.extend(lOptions,aOptions);if(lOptions.handle)
$(lOptions.handle).addClass('IE_draggable');else this.addClass('IE_draggable');if(aOptions.start){lOptions.start=function(){lStart.call(this);aOptions.start.call(this);};}
if(aOptions.stop){lOptions.stop=function(){lStop.call(this);aOptions.stop.call(this);};}
return this.draggable(lOptions);}
;return this;};$.fn.jIEHint=function(aContenu){if(IE.Hint){IE.Hint.attach({$Element:this,namespace:'jiehint',contenu:aContenu});this.addClass('jiehint');}
else{;}
return this;};(function($){var lOptions={showArrows:true,verticalGutter:2,horizontalGutter:2,mouseWheelSpeed:30};if($.fn.jScrollPane){$.extend($.fn.jScrollPane.defaults,lOptions);}}(jQuery));(function($,window,document){'use strict';var getType,isNumber;isNumber=function(content){if(typeof content==='string'||typeof content==='number'){if(!isNaN(parseInt(content,10))){return true;} else{return false;}} else{return false;}};getType=function(content){return typeof content;};window.IOSBadge=(function(){function IOSBadge(element,settings){if(!(this instanceof IOSBadge)){return new IOSBadge(element,settings);} else if(!element||!(element.nodeType&&element.nodeType===1)){throw new Error('You need to pass an element as the first argument to iOSBadge');}
this.element=element;this.settings=settings;if(element.length&&element.length>1){this.element=element[0];}
if(settings&&typeof settings==='object'){this.content=settings.content||1;this.size=settings.size||20;this.position=settings.position||'top-right';this.namespace=settings.namespace||'iosb';this.theme=settings.theme||'red';this.hideb=settings.hide||false;} else{this.content=1;this.size=20;this.position='top-right';this.namespace='iosb';this.theme='red';}
this._generate();}
IOSBadge.prototype._generate=function(){this.type=getType(this.content);this.badgeElem=document.createElement('div');this.badgeInner=document.createElement('div');this.badgeContent=document.createElement('div');if(this.hideb)
this.hide();this._setContent(this.content);this._setClasses(this.position,this.size,this.type,this.theme);this.badgeInner.appendChild(this.badgeContent);this.badgeElem.appendChild(this.badgeInner);this.element.appendChild(this.badgeElem);};IOSBadge.prototype._setOptions=function(options){if(options&&typeof options==='object'){if((options.content!==null&&options.content!==undefined)){this.setContent(options.content);}
if((options.position!==null&&options.position!==undefined)){this.setPosition(options.position);}
if((options.theme!==null&&options.theme!==undefined)){this.setTheme(options.theme);}
if((options.size!==null&&options.size!==undefined)){this.setSize(options.size);}
if(options.hide&&options.hide===true){this.hide();} else if(options.show&&options.show===true){this.show();}} else if(typeof options==='string'){if(options.toLowerCase()==='showbadge'){this.show();} else if(options.toLowerCase()==='hidebadge'){this.hide();} else{this.setContent(options);}}};IOSBadge.prototype._setContent=function(content){this.content=content;this.badgeContent.innerHTML=content;};IOSBadge.prototype._setClasses=function(position,size,type,theme){var namespace;namespace=this.namespace;this.badgeElem.className=""+namespace+" "+namespace+"-"+size+" "+namespace+"-"+position;this.badgeInner.className=""+namespace+"-inner "+namespace+"-"+theme;this.badgeContent.className=""+namespace+"-content "+namespace+"-"+type;};IOSBadge.prototype.getContent=function(){var badgeContent,badgeContentInt;badgeContent=this.badgeContent.innerHTML;badgeContentInt=parseInt(badgeContent,10);if(!isNaN(badgeContentInt)){return badgeContentInt;} else{return badgeContent;}};IOSBadge.prototype.setContent=function(content){var amount,firstChar,type;if(!$.isNumeric(content)){content=1;}
type=getType(content);if(type==='object'||type==='function'){return this;} else if(this.badgeElem.style.display==='none'){this.show();}
if(type==='string'){firstChar=content.charAt(0);amount= +content.substring(1)||0;if(content===''){this._setContent('');this.hide();return this;} else if(firstChar==='+'){this.increaseBy(amount);return this;} else if(firstChar==='-'){this.decreaseBy(amount);return this;} else if(isNumber(content)){type='number';} else{type='string';}} else{type='number';}
this.type=type;this._setClasses(this.position,this.size,type,this.theme);this._setContent(content);return this;};IOSBadge.prototype.setPosition=function(position){if(typeof position==='string'){this.position=position;this._setClasses(position,this.size,this.type,this.theme);}
return this;};IOSBadge.prototype.setTheme=function(theme){if(typeof theme==='string'){this.theme=theme;this._setClasses(this.position,this.size,this.type,theme);}
return this;};IOSBadge.prototype.setSize=function(size){if(isNumber(size)){this.size=parseInt(size,10);this._setClasses(this.position,this.size,this.type,this.theme);}
return this;};IOSBadge.prototype.decreaseBy=function(amount){if(isNumber(amount)){this.type='number';this._setClasses(this.position,this.size,this.type,this.theme);this._setContent((parseInt(this.content,10)||0)-parseInt(amount,10));}
return this;};IOSBadge.prototype.increaseBy=function(amount){if(isNumber(amount)){this.type='number';this._setClasses(this.position,this.size,this.type,this.theme);this._setContent((parseInt(this.content,10)||0)+parseInt(amount,10));}
return this;};IOSBadge.prototype.hide=function(){this.badgeElem.style.display='none';return this;};IOSBadge.prototype.show=function(){this.badgeElem.style.display='block';return this;};return IOSBadge;})();if(typeof $==='function'){$.fn.iosbadge=function(options){var iOSBadge;iOSBadge='iosbadge';if(typeof options==='string'&&options.toLowerCase()==='getcontent'&&this.data(iOSBadge)){return this.data(iOSBadge).getContent();} else{return this.each(function(){var $self,pluginData,self;self=this;$self=$(self);pluginData=$self.data(iOSBadge);if(!pluginData){$self.data(iOSBadge,new window.IOSBadge(self,options));} else{pluginData._setOptions(options);}});}};}})(window.jQuery||window.Zepto,window,window.document);;
var GObjetWAI;var EGenreObjet={Aide:1,Tableau:2,AvecValidation:3,BarreOnglets:4,NavigationHorizontal:5,NavigationVertical:6,NavigationHorizontalAvecValidation:7,NavigationVerticalAvecValidation:8,CalendrierNavigation:9,CalendrierPrecedent:10,CalendrierSuivant:11,DetailEvenement:12,TitreDetailEvenement:13,MenuContextuel:14,NavigationMenuContextuel:15,AvecMenuContextuel:16,ItemDesactiver:17,AvecEdition:18,Tabulation:19,Supprimer:20,Fenetre:21,NouvelElement:22,BarreOngletsPrincipal:23,SousOnglets:24,ValidezEvenement:25,RetourDebutFenetre:26,FenetreChoix:27};var EGenreRole={Application:1,Window:2,Textbox:3,Link:5,Combobox:6,Option:7,Checkbox:8,Radio:10,Radiogroup:11,Button:12,Progressbar:13,Tree:17,Treeitem:19,Presentation:20,Group:21,Grid:22,Tab:24,Tabpanel:25,Tablist:26,Rowheader:30,Columnheader:31,List:32,Listitem:33,Menu:34,Menubar:35,Menuitem:36,Alert:37,Alertdialog:38,Dialog:39,Gridcell:40,Log:41,Marquee:42,Menuitemcheckbox:43,Menuitemradio:44,Scrollbar:45,Slider:46,Spinbutton:47,Status:48,Timer:49,Tooltip:50,Listbox:51,Treegrid:52,Article:53,Definition:54,Directory:55,Document:56,Heading:57,Img:58,Math:59,Note:60,Region:61,Row:62,Separator:63,Toolbar:64,Banner:65,Complementary:66,Contentinfo:67,Form:68,Main:69,Navigation:70,Search:71};var EGenreAttribut={activedescendant:0,atomic:1,autocomplete:2,busy:3,checked:4,controls:5,describedby:6,disabled:7,dropeffect:8,expanded:9,flowto:10,grabbed:11,haspopup:12,hidden:13,invalid:14,label:15,labelledby:16,level:17,live:18,multiline:19,multiselectable:20,orientation:21,owns:22,posinset:23,pressed:24,readonly:25,relevant:26,required:27,selected:28,setsize:29,sort:30,valuemax:31,valuemin:32,valuenow:33,valuetext:34};function ObjetWAI(){var i;this.idMessagesAide=IE.GUID.getId();this.InfoWai=[];this.InfoWai[EGenreObjet.Aide]=GTraductions.getValeur('Navigation.Aide');this.InfoWai[EGenreObjet.Tableau]=GTraductions.getValeur('Navigation.Tableau');this.InfoWai[EGenreObjet.AvecValidation]=GTraductions.getValeur('Navigation.AvecValidation');this.InfoWai[EGenreObjet.BarreOnglets]=GTraductions.getValeur('Navigation.BarreOnglets');this.InfoWai[EGenreObjet.NavigationHorizontal]=GTraductions.getValeur('Navigation.NavigationHorizontal');this.InfoWai[EGenreObjet.NavigationVertical]=GTraductions.getValeur('Navigation.NavigationVertical');this.InfoWai[EGenreObjet.NavigationHorizontalAvecValidation]=GTraductions.getValeur('Navigation.NavigationHorizontalAvecValidation');this.InfoWai[EGenreObjet.NavigationVerticalAvecValidation]=GTraductions.getValeur('Navigation.NavigationVerticalAvecValidation');this.InfoWai[EGenreObjet.CalendrierNavigation]=GTraductions.getValeur('Navigation.CalendrierNavigation');this.InfoWai[EGenreObjet.CalendrierPrecedent]=GTraductions.getValeur('Navigation.CalendrierPrecedent');this.InfoWai[EGenreObjet.CalendrierSuivant]=GTraductions.getValeur('Navigation.CalendrierSuivant');this.InfoWai[EGenreObjet.ValidezEvenement]=GTraductions.getValeur('Navigation.ValidezEvenement');this.InfoWai[EGenreObjet.TitreDetailEvenement]=GTraductions.getValeur('Navigation.TitreDetailEvenement');this.InfoWai[EGenreObjet.MenuContextuel]=GTraductions.getValeur('Navigation.MenuContextuel');this.InfoWai[EGenreObjet.NavigationMenuContextuel]=GTraductions.getValeur('Navigation.NavigationMenuContextuel');this.InfoWai[EGenreObjet.ItemDesactiver]=GTraductions.getValeur('Navigation.ItemDesactiver');this.InfoWai[EGenreObjet.AvecEdition]=GTraductions.getValeur('Navigation.AvecEdition');this.InfoWai[EGenreObjet.Tabulation]=GTraductions.getValeur('Navigation.Tabulation');this.InfoWai[EGenreObjet.Supprimer]=GTraductions.getValeur('Navigation.Supprimer');this.InfoWai[EGenreObjet.Fenetre]=GTraductions.getValeur('Navigation.Fenetre');this.InfoWai[EGenreObjet.NouvelElement]=GTraductions.getValeur('Navigation.NouvelElement');this.InfoWai[EGenreObjet.BarreOngletsPrincipal]=GTraductions.getValeur('Navigation.BarreOngletsPrincipal');this.InfoWai[EGenreObjet.SousOnglets]=GTraductions.getValeur('Navigation.SousOnglets');this.InfoWai[EGenreObjet.RetourDebutFenetre]=GTraductions.getValeur('Navigation.RetourDebutFenetre');this.InfoWai[EGenreObjet.FenetreChoix]=GTraductions.getValeur('Navigation.FenetreChoix');this.idInfoWai=[];$('body').append('<div id="'+this.idMessagesAide+'" role="presentation" aria-hidden="true" style="display:none;"></div>');for(i in EGenreObjet){this.idInfoWai[EGenreObjet[i]]=IE.GUID.getId();$('#'+this.idMessagesAide.escapeJQ()).append('<span id="'+this.idInfoWai[EGenreObjet[i]]+'" class="wai_hidden" role="tooltip" aria-hidden="true">'+this.InfoWai[EGenreObjet[i]]+'</span>');}
this.WaiRole=[];this.WaiRole[EGenreRole.Window]='window';this.WaiRole[EGenreRole.Alert]='alert';this.WaiRole[EGenreRole.Alertdialog]='alertdialog';this.WaiRole[EGenreRole.Button]='button';this.WaiRole[EGenreRole.Checkbox]='checkbox';this.WaiRole[EGenreRole.Dialog]='dialog';this.WaiRole[EGenreRole.Gridcell]='gridcell';this.WaiRole[EGenreRole.Link]='link';this.WaiRole[EGenreRole.Log]='log';this.WaiRole[EGenreRole.Marquee]='marquee';this.WaiRole[EGenreRole.Menuitem]='menuitem';this.WaiRole[EGenreRole.Menuitemcheckbox]='menuitemcheckbox';this.WaiRole[EGenreRole.Menuitemradio]='menuitemradio';this.WaiRole[EGenreRole.Option]='option';this.WaiRole[EGenreRole.Progressbar]='progressbar';this.WaiRole[EGenreRole.Radio]='radio';this.WaiRole[EGenreRole.Scrollbar]='scrollbar';this.WaiRole[EGenreRole.Slider]='slider';this.WaiRole[EGenreRole.Spinbutton]='spinbutton';this.WaiRole[EGenreRole.Status]='status';this.WaiRole[EGenreRole.Tab]='tab';this.WaiRole[EGenreRole.Tabpanel]='tabpanel';this.WaiRole[EGenreRole.Textbox]='textbox';this.WaiRole[EGenreRole.Timer]='timer';this.WaiRole[EGenreRole.Tooltip]='tooltip';this.WaiRole[EGenreRole.Treeitem]='treeitem';this.WaiRole[EGenreRole.Combobox]='combobox';this.WaiRole[EGenreRole.Grid]='grid';this.WaiRole[EGenreRole.Listbox]='listbox';this.WaiRole[EGenreRole.Menu]='menu';this.WaiRole[EGenreRole.Menubar]='menubar';this.WaiRole[EGenreRole.Radiogroup]='radiogroup';this.WaiRole[EGenreRole.Tablist]='tablist';this.WaiRole[EGenreRole.Tree]='tree';this.WaiRole[EGenreRole.Treegrid]='treegrid';this.WaiRole[EGenreRole.Article]='article';this.WaiRole[EGenreRole.Columnheader]='columnheader';this.WaiRole[EGenreRole.Definition]='definition';this.WaiRole[EGenreRole.Directory]='directory';this.WaiRole[EGenreRole.Document]='document';this.WaiRole[EGenreRole.Group]='group';this.WaiRole[EGenreRole.Heading]='heading';this.WaiRole[EGenreRole.Img]='img';this.WaiRole[EGenreRole.List]='list';this.WaiRole[EGenreRole.Listitem]='listitem';this.WaiRole[EGenreRole.Math]='math';this.WaiRole[EGenreRole.Note]='note';this.WaiRole[EGenreRole.Presentation]='presentation';this.WaiRole[EGenreRole.Region]='region';this.WaiRole[EGenreRole.Row]='row';this.WaiRole[EGenreRole.Rowheader]='rowheader';this.WaiRole[EGenreRole.Separator]='separator';this.WaiRole[EGenreRole.Toolbar]='toolbar';this.WaiRole[EGenreRole.Application]='application';this.WaiRole[EGenreRole.Banner]='banner';this.WaiRole[EGenreRole.Complementary]='complementary';this.WaiRole[EGenreRole.Contentinfo]='contentinfo';this.WaiRole[EGenreRole.Form]='form';this.WaiRole[EGenreRole.Main]='main';this.WaiRole[EGenreRole.Navigation]='navigation';this.WaiRole[EGenreRole.Search]='search';this.WaiAttribut=[];this.WaiAttribut[EGenreAttribut.activedescendant]='aria-activedescendant';this.WaiAttribut[EGenreAttribut.atomic]='aria-atomic';this.WaiAttribut[EGenreAttribut.autocomplete]='aria-autocomplete';this.WaiAttribut[EGenreAttribut.busy]='aria-busy';this.WaiAttribut[EGenreAttribut.checked]='aria-checked';this.WaiAttribut[EGenreAttribut.controls]='aria-controls';this.WaiAttribut[EGenreAttribut.describedby]='aria-describedby';this.WaiAttribut[EGenreAttribut.disabled]='aria-disabled';this.WaiAttribut[EGenreAttribut.dropeffect]='aria-dropeffect';this.WaiAttribut[EGenreAttribut.expanded]='aria-expanded';this.WaiAttribut[EGenreAttribut.flowto]='aria-flowto';this.WaiAttribut[EGenreAttribut.grabbed]='aria-grabbed';this.WaiAttribut[EGenreAttribut.haspopup]='aria-haspopup';this.WaiAttribut[EGenreAttribut.hidden]='aria-hidden';this.WaiAttribut[EGenreAttribut.invalid]='aria-invalid';this.WaiAttribut[EGenreAttribut.label]='aria-label';this.WaiAttribut[EGenreAttribut.labelledby]='aria-labelledby';this.WaiAttribut[EGenreAttribut.level]='	aria-level';this.WaiAttribut[EGenreAttribut.live]='aria-live';this.WaiAttribut[EGenreAttribut.multiline]='aria-multiline';this.WaiAttribut[EGenreAttribut.multiselectable]='aria-multiselectable';this.WaiAttribut[EGenreAttribut.orientation]='aria-orientation';this.WaiAttribut[EGenreAttribut.owns]='aria-owns';this.WaiAttribut[EGenreAttribut.posinset]='aria-posinset';this.WaiAttribut[EGenreAttribut.pressed]='aria-pressed';this.WaiAttribut[EGenreAttribut.readonly]='aria-readonly';this.WaiAttribut[EGenreAttribut.relevant]='aria-relevant';this.WaiAttribut[EGenreAttribut.required]='aria-required';this.WaiAttribut[EGenreAttribut.selected]='aria-selected';this.WaiAttribut[EGenreAttribut.setsize]='aria-setsize';this.WaiAttribut[EGenreAttribut.sort]='aria-sort';this.WaiAttribut[EGenreAttribut.valuemax]='aria-valuemax';this.WaiAttribut[EGenreAttribut.valuemin]='aria-valuemin';this.WaiAttribut[EGenreAttribut.valuenow]='aria-valuenow';this.WaiAttribut[EGenreAttribut.valuetext]='aria-valuetext';}
ObjetWAI.prototype.getInfo=function(AEnum){return this.InfoWai[AEnum];};ObjetWAI.prototype.getRole=function(AEnum){return'role="'+this.WaiRole[AEnum]+'"';};ObjetWAI.prototype.getAttribut=function(aEnum){return this.WaiAttribut[aEnum]+'=';};ObjetWAI.prototype.composeSpanRetour=function(aId){return'<span tabindex="0" class="wai_hidden" onfocus="'+aId+'.FocusSurPremierElement ()">'+this.getInfo(EGenreObjet.RetourDebutFenetre)+'</span>';};ObjetWAI.prototype.composeSpan=function(AParametre,AId){var LId=AId?'id="'+AId+'" tabIndex="-1" ':'';return typeof(AParametre)==='string'?'<span '+LId+'class="wai_hidden">'+AParametre+'</span>':'<span '+LId+'class="wai_hidden">'+this.getInfo(AParametre)+'</span>';};ObjetWAI.prototype.composeRole=function(AParametre){return typeof(AParametre)==='string'?'':this.getRole(AParametre);};ObjetWAI.prototype.composeAttribut=function(aParametre){if(aParametre.valeur&&typeof(aParametre.valeur)!=='string') GLog.addLog('ObjetWAI.prototype.composeAttribut: mauvais type de parametre '+aParametre.genre+' => '+aParametre.valeur);if(!aParametre.valeur||typeof(aParametre.valeur)!=='string') return'';var lValeur=aParametre.valeur.split("'").join("");lValeur=lValeur.split('"').join("");return typeof(aParametre.genre)==='string'?'':' '+this.getAttribut(aParametre.genre)+'"'+lValeur+'"';};ObjetWAI.prototype.remplace=function(AChaine,ACherche,ARemplace){return AChaine.replace(ACherche,ARemplace);};ObjetWAI.prototype.ajoutePoint=function(AChaine){return AChaine.trim().substring(AChaine.length-1,AChaine.length)==='.'?AChaine:AChaine+'. ';};ObjetWAI.prototype.formatHeure=function(AChaine){var result=AChaine;if(typeof(AChaine)==='string'){var LTemp=AChaine.split(GTraductions.getValeur('date.separateurHeure'));var LHeure=parseInt(LTemp[0]);var LMin=LTemp[1]?parseInt(LTemp[1]):0;result=LHeure+' '+((LHeure===1)?GTraductions.getValeur('WAI.heure'):GTraductions.getValeur('WAI.heures'));if(LMin!==0) result+=' '+(LMin+' '+(LMin===1)?GTraductions.getValeur('WAI.minute'):GTraductions.getValeur('WAI.minutes'));}
return result;};;
var EGenreOnglet={ParametresMobile:-4,MenuOnglets:-3,SelectionRessources:-2,GeneralAccueil:-1,GeneralRacine:0,GeneralVieEtablissement:2,GeneralNotes:3,GeneralBulletins:4,GeneralVieScolaire:5,GeneralCompte:6,Accueil:7,Informations:8,Agenda:9,Menus:10,Vacances:11,Releve:12,Bulletins:13,Orientation:14,SaisieOrientation:15,EmploiDuTemps:16,CahierDeTexte:17,Remplacements:18,General_Absences:19,Dossiers:20,CompteEleve:22,SaisieNotes:23,SaisieAppreciationsBulletin:25,SaisieAppreciationsGenerales:27,SaisieCahierDeTextes:28,SaisieAbsences:29,SaisieAppreciationsReleve:30,FicheBrevet:34,InfoMedicale:36,EquipePedagogique:37,Graphique:38,GeneralResultats:39,GeneralOrientations:40,ConseilDeClasse:41,SaisieAppreciationDeFinDeStage:42,GeneralDansLaClasse:43,SuiviPluriannuel:44,Competences_Releve:45,CahierDeTextes_Contenu:47,CahierDeTextes_TravailAFaire:48,InfosPerso:49,B2I_ParEleve:50,B2I_ParCompetence:51,GeneralStage:52,SaisieAppreciationsFicheBrevet:53,GeneralCompetence:55,Evaluation:56,GeneralBrevet:57,GeneralEquipePedagogique:58,GeneralMesClasses:59,EmploiDuTempsClasse:60,General_CahierDeTextes:61,CahierDeTextesClasse:62,ResultatsClasses:64,ListeEvaluation:65,ListePersonnelEtablissement:66,ListeEvaluationHistorique:67,Punitions:68,Entreprise:69,Competences_Grille:70,CahierDeTexte_Progression:71,Dispenses:72,AbsencesEtRetards:73,SuivisAbsenceRetard:74,Affectation_Progression:75,RecapitulatifAbsences:76,TrombinoscopeClasse:77,Saisie_CarnetCorrespondance:78,IManuels:79,EmploiDuTempsSalle:81,Trombinoscope:82,LivretScolaire_Fiche:83,QCM:84,QCM_Saisie:85,QCM_Bibliotheque:86,QCM_Reponse:87,CDT_TAF:88,CDT_Contenu:89,Rencontre:90,Rencontre_Indisponibilites:91,Rencontre_Desideratas:92,CreneauxLibres:93,General_Rencontre_Planning:94,QCM_BibliothequeNathan:96,EmploiDuTempsProfesseur:97,SaisieOffresStage:98,RessourcePedagogique:99,BulletinCompetences:100,OffresStage:101,Casier:102,Casier_Documents:103,Casier_MonCasier:104,ListeEleves:105,Genral_Classes:106,General_Salles:107,LivretScolaire:108,LivretScolaire_Appreciations:109,LivretScolaire_Competences:110,Graphique_Profil:111,Graphique_Evolution:112,SaisieAbsences_AppelEtSuivi:113,SaisieAbsences_Appel:114,Absences_Recapitulatif:115,Absences_Liste:116,Absences_HeuresManquees:117,Remplacements_Grille:118,Remplacements_Tableau:119,Rencontre_Planning_Liste:120,Rencontre_Planning_Grille:121,GeneralReleveDeNotes:122,ListeProfesseurs:123,ListeClasses:124,ListeGroupes:125,ListeResponsables:126,ListePersonnels:127,Genral_Eleves:128,General_Professeurs:129,EmploiDuTempsEleve:130,Messagerie:131,General_Messagerie:132,BulletinCompetencesClasse:133,EmploiDuTempsPersonnelEtablissement:134,Incidents:135,SaisieAbsences_Appel_Professeur:136,AutorisationSortie:137,RecapAbsences:138,RecapFeuilleAppel:139,RecapPunitions:140,ProgrammesBO:141,Trombinoscope_Professeur:142,Trombinoscope_Personnel:143,ParametresUtilisateur:144,ListeStagiaires:145,CoursNonAssures:146,General_Personnels:147,DocumentsATelecharger:148,General_Progression:149,BibliothequeProgression:150,General_CahierDeTextes_Saisie:151,General_CahierDeTextes_Consultation:152,General_Documentation:153,ListeDevoirSurTable:154};;
function ObjetRequetePresence(){this.inheritedCreate(null,function(){},function(){});}
IE.Requetes.inscrire('Presence',ObjetRequetePresence,_ObjetRequeteXmlConsultationPN);ObjetRequetePresence.prototype.lancerRequete=function(){this.appelAsynchroneConsultation({sansBlocageInterface:true});};ObjetRequetePresence.prototype.actionApresRequete=function(){};;

var GMessageInformatifChargement=new ObjetMessageInformatif('GMessageInformatifChargement');function Outils_Pour_MessageInformatif(ANom){this.Nom=ANom;}
Outils_Pour_MessageInformatif.prototype.SetCellule=function(AId,ACellule){var E=document.getElementById(AId);if(!E) return;E.innerHTML=ACellule;E.scrollLeft=0;E.scrollTop=0;};Outils_Pour_MessageInformatif.prototype.SetVisible=function(AId,AVisible){var E=document.getElementById(AId);if(E&&E.style){E.style.display=AVisible?'':'none';E.style.visibility=AVisible?'visible':'hidden';}};function ObjetMessageInformatif(ANom,aStyleTransparent){this.Nom=ANom;this.Outils=new Outils_Pour_MessageInformatif(this.Nom+'_Outils');this.styleTransparent=aStyleTransparent;this.locked=false;this.DetailMessageInformatif='&nbsp;';this.IdBarre=this.Nom+'_BarreProgression';this.IdDetailMessageInformatif=this.Nom+'_DetailMessageInformatif';this.IdMessageInformatif=this.Nom+'_DetailMessage';if(window.IE&&window.IE.Invocateur){IE.Invocateur.abonner(IE.Invocateur.events.eventIOAjax,this._surEventIOAjax,this);}}
ObjetMessageInformatif.prototype.Compose=function(){return'<div id="'+this.Nom+'" class="MessageInformatif'+(this.styleTransparent?' Transparence_MessageInformatif ':' ')+'PositionAbsolue_MessageInformatif hide_MessageInformatif" style="z-index: 2000; border-color: '+this._getCouleurBordure()+'"></div>';};ObjetMessageInformatif.prototype.ComposePourChargement=function(){var H='';if(window.GOptionsMsgChargement.etat===1){H+='<div id="chargement_fond_bg" class="Image_Connexion_Fond" style="position:absolute;width:100%;height:100%;margin:0;padding:0;">&nbsp;</div>';H+='<div id="chargement_fond_image" style="position:absolute;width:100%;height:100%;margin:0;padding:0;">&nbsp;</div>';}
H+='<div id="chargement" style="position:absolute;width:100%;height:100%;margin:0;padding:0;">';H+='<table role="presentation" style="height:100%; width:100%;margin:0;padding:0;"  border="0" cellpadding="0" cellspacing="0"><tr role="presentation"><td role="presentation" align="center">';H+='<table role="presentation" border="0" cellpadding="0" cellspacing="0">';H+='<tr role="presentation"><td role="presentation" id="'+this.Nom+'" class="MessageInformatif'+(this.styleTransparent?' Transparence_MessageInformatif ':' ')+'hide_MessageInformatif" style="z-index: 2000; border-color: '+this._getCouleurBordure()+'"></td></tr>';H+='</table>';H+='</td></tr></table>';H+='</div>';return H;};ObjetMessageInformatif.prototype._getCouleurBordure=function(){return this.styleTransparent?'black':'#AAAAAA';};ObjetMessageInformatif.prototype.Start=function(){document.write(window.GMessageInformatifChargement.ComposePourChargement());this.SetDonnees(window.GOptionsMsgChargement.traductionsChargementSources,true,window.GOptionsMsgChargement.nbFichiersSources);};ObjetMessageInformatif.prototype.End=function(){document.getElementById('chargement').style.display="none";if(window.GOptionsMsgChargement.etat===1){document.body.removeChild(document.getElementById('chargement_fond_bg'));document.body.removeChild(document.getElementById('chargement_fond_image'));}};ObjetMessageInformatif.prototype.SetDonnees=function(aMessage,aAvecBarreDeProgression,ANbElmtsTotal,ANbElmtsTraites){this.AvecBarreDeProgression=aAvecBarreDeProgression;this.DetailMessageInformatif=aMessage;this.NbElmtsTotal=ANbElmtsTotal;this.NbElmtsTraites=(ANbElmtsTraites?ANbElmtsTraites:0)-1;var lTraduction=window.GTraductions?GTraductions.getValeur('connexion.MessageVeuillezPatienter'):window.GOptionsMsgChargement?window.GOptionsMsgChargement.traductionsVeuillezPatienter:'';this.Afficher(lTraduction,null,true);if(this.AvecBarreDeProgression){this.locked=true;this.Progresser();}};ObjetMessageInformatif.prototype._arreterTimerAffichage=function(){if(this._timerAffichage){clearTimeout(this._timerAffichage);delete this._timerAffichage;}};ObjetMessageInformatif.prototype._afficherContenu=function(aMessage,aDuree,aDetailMessageInformatif){var LContenuMessage=[];LContenuMessage.push('<table role="presentation" class="AlignementMilieu_MessageInformatif" width="100%" height="100px" border="0" cellpadding="0" cellspacing="0">');LContenuMessage.push('<tr role="presentation" class="Texte12_MessageInformatif Gras_MessageInformatif" height="20px"><td  tabindex="-1" role="alert"  id="',this.IdMessageInformatif,'">'+aMessage+'</td></tr>');LContenuMessage.push('<tr role="presentation"><td role="presentation" class="EspaceHaut_MessageInformatif EspaceBas_MessageInformatif Image_Attendre" height="35px"></td></tr>');LContenuMessage.push('<tr role="presentation"><td role="presentation" id="'+this.IdDetailMessageInformatif+'" class="Texte10_MessageInformatif EspaceHaut_MessageInformatif" height="30px">'+(aDetailMessageInformatif?aDetailMessageInformatif:this.DetailMessageInformatif)+'</td></tr>');LContenuMessage.push('<tr role="presentation"><td role="presentation" class="EspaceHaut_MessageInformatif AlignementGauche_MessageInformatif" height="25px">');if(this.AvecBarreDeProgression)
LContenuMessage.push('<table role="presentation" cellpadding="0" cellspacing="0" height="5px" width="100%" ><tr role="presentation"><td role="presentation" class="Bordure_MessageInformatif" id="'+this.IdBarre+'">'+this.ConstruireBarre(0)+'</td></tr></table>');else LContenuMessage.push('&nbsp;');LContenuMessage.push('</td></tr>');LContenuMessage.push('</table>');if(this.EnAffichage)
clearInterval(this.Timer);if(GHtml&&$.isFunction(GHtml.setHtml)) GHtml.setHtml(this.Nom,LContenuMessage.join(''));else this.Outils.SetCellule(this.Nom,LContenuMessage.join(''));try{this.FocusedElement=document.activeElement;} catch(e){}
try{GHtml.setDisplay(this.Nom,true);GPosition.centrer(this.Nom,null,true);GStyle.setVisible(this.Nom,true);GHtml.setFocus(this.IdMessageInformatif);}
catch(E){this.Outils.SetVisible(this.Nom,true);try{document.getElementById(this.IdMessageInformatif).style.outlineWidth="0px";document.getElementById(this.IdMessageInformatif).focus();} catch(e){}}
this.EnAffichage=true;if(aDuree)
this.Timer=setTimeout(this.Masquer.bind(this),aDuree*1000);};ObjetMessageInformatif.prototype.Afficher=function(aMessage,aDuree,aBloquer,aDetailMessageInformatif){this._arreterTimerAffichage();if(!this.locked){this.message=aMessage;this.duree=aDuree;this.bloquer=aBloquer;if(this.bloquer)
try{GNavigateur.BloquerInterfaceAvecCompteur(true,EGenreCurseur.Sablier,false);}catch(E){}
this._afficherContenu(aMessage,aDuree,aDetailMessageInformatif);}};ObjetMessageInformatif.prototype.bloquerAfficherAvecDelai=function(aMessage,aDelaiAffichage,aDetailMessageInformatif){this._arreterTimerAffichage();if(!this.locked){this.message=aMessage;this.duree=null;this.bloquer=true;try{GNavigateur.BloquerInterfaceAvecCompteur(true,EGenreCurseur.Sablier,false);}catch(E){}
if(!aDelaiAffichage)
aDelaiAffichage=0;this._timerAffichage=setTimeout(this._afficherContenu.bind(this,aMessage,null,aDetailMessageInformatif),aDelaiAffichage);}};ObjetMessageInformatif.prototype.Masquer=function(){this._arreterTimerAffichage();if(!this.locked){this.Outils.SetVisible(this.Nom,false);this.DetailMessageInformatif='&nbsp;';if(this.FocusedElement){try{window.$(this.FocusedElement).trigger('focus',{focusMessageInformatif:true});} catch(e){}}
this.FocusedElement=null;if(this.bloquer)
try{GNavigateur.BloquerInterfaceAvecCompteur(false,EGenreCurseur.Defaut,false);}catch(E){}}};ObjetMessageInformatif.prototype.AfficherAvecLock=function(aMessage,aDuree,aBloquer,aDetailMessageInformatif){this._arreterTimerAffichage();if(!this.locked){this.Afficher(aMessage,null,aBloquer,aDetailMessageInformatif);if(aDuree)
this.Timer=setTimeout(this.MasquerAvecLock.bind(this),aDuree*1000);this.locked=true;}};ObjetMessageInformatif.prototype.MasquerAvecLock=function(){this._arreterTimerAffichage();this.locked=false;this.Masquer();};ObjetMessageInformatif.prototype.Progresser=function(AMessageDetail){this._arreterTimerAffichage();if(this.AvecBarreDeProgression){this.NbElmtsTraites++;if(this.NbElmtsTotal!==0){var LPourcentage=(this.NbElmtsTraites*100)/this.NbElmtsTotal;this.Outils.SetCellule(this.IdBarre,this.ConstruireBarre(LPourcentage));this.Outils.SetCellule(this.IdDetailMessageInformatif,this.DetailMessageInformatif+' '+this.NbElmtsTraites+'/'+this.NbElmtsTotal+'<br>'+(AMessageDetail?AMessageDetail:'&nbsp;'));}}};ObjetMessageInformatif.prototype.Debloquer=function(){this._arreterTimerAffichage();var LPourcentage=(this.NbElmtsTraites*100)/this.NbElmtsTotal;if(LPourcentage===100){this.AvecBarreDeProgression=false;this.DetailMessageInformatif='&nbsp;';this.locked=false;}};ObjetMessageInformatif.prototype.ConstruireBarre=function(APourcentage){return'<div style="height:3px; width:'+APourcentage+'%; font-size:1px;" class="FondNoir_MessageInformatif"></div>';};ObjetMessageInformatif.prototype.SetDetailMessageInformatif=function(AMessage){this.DetailMessageInformatif=AMessage;this.Outils.SetCellule(this.IdDetailMessageInformatif,AMessage);};ObjetMessageInformatif.prototype._surEventIOAjax=function(aParametres){if(aParametres.actualisation){if(this.EnAffichage&&!this.locked)
GHtml.setHtml(this.IdDetailMessageInformatif,aParametres.message);return;}
if(aParametres.emission){if(aParametres.upload){if(aParametres.nombreFichiers>0){this.SetDonnees(aParametres.message||GTraductions.getValeur('requete.transfertPJ'),true,aParametres.nombreFichiers);}
else{this.Progresser();}}
else{if(aParametres.message){this.SetDonnees(aParametres.message);}
else{this.bloquerAfficherAvecDelai(GTraductions.getValeur('requete.VeuillezPatienter'),100 ,false);}}}
else{if(aParametres.upload){this.Debloquer();}
this.Masquer();}};if(window.GOptionsMsgChargement){GMessageInformatifChargement.Start();};
var GEtatUtilisateur;(function(){IEClasses.ObjetEtatUtilisateurCP=function(){this.EtatSaisie=false;this.parametres={ratioFicheEleve:1};IE.Invocateur.abonner(IE.Invocateur.events.etatSaisie,this.setEtatSaisie.bind(this),this);};IEClasses.ObjetEtatUtilisateurCP.prototype.setEtatSaisie=function(aEtat){this.EtatSaisie=aEtat;};IEClasses.ObjetEtatUtilisateurCP.prototype.getRatioFicheEleve=function(){return this.parametres.ratioFicheEleve;};IEClasses.ObjetEtatUtilisateurCP.prototype.actualiserRatioFicheEleve=function(){this.parametres.ratioFicheEleve=this.parametres.ratioFicheEleve===1?2:1;return this.parametres.ratioFicheEleve;};}());;
function ObjetNavigation(){this.TableauxRessources=[];this.Classe=null;this.Groupe=null;this.Periode=null;this.Eleve=null;this.Service=null;this.Appreciation=null;this.avecCoursAnnule=true;this.Niveau= -1;this.NumeroMatiereCahierDeTextes=0;this.afficherFicheService=true;this.triDevoirs=false;this.AffichageAgenda=new TypeDomaine('11');}
ObjetNavigation.prototype.SetRessource=function(AGenreRessource,AParametre,ANumero,AGenre){if(MethodesObjet.isObject(AParametre))
this.TableauxRessources[AGenreRessource]=MethodesObjet.dupliquer(AParametre);else this.TableauxRessources[AGenreRessource]=new ObjetElement(AParametre,ANumero,AGenre);};ObjetNavigation.prototype.GetRessource=function(AGenreRessource){return this.TableauxRessources[AGenreRessource];};ObjetNavigation.prototype.GetNumeroRessource=function(AGenreRessource){return this.TableauxRessources[AGenreRessource]?this.TableauxRessources[AGenreRessource].GetNumero():null;};ObjetNavigation.prototype.GetGenreRessource=function(AGenreRessource){return this.TableauxRessources[AGenreRessource]?this.TableauxRessources[AGenreRessource].GetGenre():null;};ObjetNavigation.prototype.GetLibelleRessource=function(AGenreRessource){return this.TableauxRessources[AGenreRessource]?this.TableauxRessources[AGenreRessource].GetLibelle():null;};;
var EGenreDirection={SensInverse:-1,DeuxSenses:0,SensNormal:1};;

var EGenreOrientationAffichage={Vertical:0,Horizontal:1};function Identite(ANom,AIdent,APere,AEvenement){if(IE.MethodesObjet.isObject(ANom)){var lParametres={nomComplet:'',nomObjet:null,pere:null,evenement:null};$.extend(lParametres,ANom);this.Pere=lParametres.pere;this.Evenement=lParametres.evenement;if(lParametres.nomObjet&&lParametres.pere){this.Nom=lParametres.pere.Nom+'.'+lParametres.nomObjet;}
else{this.Nom=lParametres.nomComplet;}}
else{this.Nom=this.ConstruireNom(ANom,AIdent);this.Pere=APere;this.Evenement=AEvenement;}
this.callback=new Callback(this.Pere,this.Evenement);this._callbacksSurDestruction=[];if(this.Pere&&this.Pere.ajouterInstanceADetruire){this.Pere.ajouterInstanceADetruire(this);}
this.Actif=true;this.Visible=true;this.TableauGauche=[];this.TableauDroite=[];this.TableauHaut=[];this.TableauBas=[];this.focusable=true;this.IdPremierElement='';this.idMessageActionRequise=IE.GUID.getId();this.tabIndex=0;this.pileEvenementGlobaux=[];this.instancesADetruire=[];this.avecMarge=true;this.controleur=this.creerControleur();if(this.controleur){this.controleur.instance=this;var lSelf=this;var lRefresh=this.controleur.$refresh;this.controleur.$refresh=function(){lRefresh.bind(this)(lSelf.hashGUIDsControleur());};}}(function(){Identite.prototype.SetParametres=function(){};Identite.prototype.setAvecTabulation=function(AAvecTabIndex){this.tabIndex=(AAvecTabIndex===null||AAvecTabIndex===undefined||AAvecTabIndex)?0:-1;};Identite.prototype.SetDonnees=function(){};Identite.prototype.setTraductions=function(aTraductions){this.traductions=aTraductions;};Identite.prototype.RecupererDonnees=function(){};Identite.prototype.ConstruireAffichage=function(){return'&nbsp;';};Identite.prototype.SetGenre=function(AGenre){this.Genre=AGenre;};Identite.prototype.SetActif=function(AActif){this.Actif=AActif;};Identite.prototype.SetVisible=function(AVisible){GStyle.setDisplay(this.Nom,this.Visible=AVisible);};Identite.prototype.EstUneInteractionUtilisateur=function(){return this.InteractionUtilisateur!==false;};Identite.prototype.SetEtatSaisie=function(aEtatSaisie){this.etatSaisie=aEtatSaisie;IE.Invocateur.evenement(IE.Invocateur.events.etatSaisie,aEtatSaisie);};Identite.prototype.SetControleNavigation=function(AControleNavigation){this.ControleNavigation=AControleNavigation;};Identite.prototype.getEtatSaisie=function(){if(this.Pere){return this.Pere.getEtatSaisie();}};Identite.prototype.getAvecMarge=function(){return this.avecMarge;};Identite.prototype.$refresh=function(){this.controleur.$refresh();return this;};Identite.prototype.$refreshSelf=function(){this.controleur.$refreshSelf();return this;};function _getControleurHeritage(aProto){var lProtoPere=aProto.__pere__,lControleur=null,lControleurPere=null;if(aProto.hasOwnProperty('getControleur')){lControleur=aProto.getControleur.call(this);}
if(lProtoPere){lControleurPere=_getControleurHeritage.call(this,lProtoPere);lControleur=lControleur?$.extend(true,lControleurPere,lControleur):lControleurPere;}
return lControleur;}
Identite.prototype.creerControleur=function(){return IE.HTML.initControleur(_getControleurHeritage.call(this,this.constructor.prototype)||{});};function _hashFilsGUIDsControleur(aGUIDs){if(this.instancesADetruire){var lInstance,i;for(i in this.instancesADetruire){lInstance=this.instancesADetruire[i];if(lInstance){if(lInstance.controleur){aGUIDs[lInstance.controleur.$GUID]=true;}
_hashFilsGUIDsControleur.bind(lInstance)(aGUIDs);}}}}
Identite.prototype.hashGUIDsControleur=function(aGUIDs){aGUIDs=aGUIDs||{};if(this.controleur){aGUIDs[this.controleur.$GUID]=true;}
if(this.Pere&&this.Pere.hashGUIDsControleur){this.Pere.hashGUIDsControleur(aGUIDs);}
_hashFilsGUIDsControleur.bind(this)(aGUIDs);return aGUIDs;};Identite.prototype.avecEventResizeNavigateur=function(){return this.Pere&&this.Pere.avecEventResizeNavigateur?this.Pere.avecEventResizeNavigateur():true;};Identite.prototype.setEvenement=function(aEvenement){this.callback=new Callback(this.Pere,aEvenement);this.Evenement=aEvenement;};Identite.prototype.ConstruireNom=function(ANom,AIdent){return(AIdent===null||AIdent===undefined?ANom:ANom+'['+AIdent+']');};Identite.prototype.GetNom=function(){return this.Nom;};Identite.prototype.effacer=function(aMessage){if(aMessage===null||aMessage===undefined){aMessage='&nbsp;';}
GHtml.setHtml(this.Nom,aMessage);};Identite.prototype.Afficher=function(H){if(H===null||H===undefined){H=this.ConstruireAffichage();}
if(H){GHtml.setHtml(this.Nom,H,{instance:this});}};Identite.prototype.activerFocusable=function(){this.focusable=true;$('#'+this.Nom.escapeJQ()).attr('tabIndex','0').off('focus').on('focus',this.FocusSurPremierElement.bind(this));};Identite.prototype.desactiverFocusable=function(){this.focusable=false;$('#'+this.Nom.escapeJQ()).attr('tabIndex','').off('focus');};Identite.prototype.Initialiser=function(){var H=this.ConstruireAffichage();if(H){GHtml.setHtml(this.Nom,H,{instance:this});}
this.RecupererDonnees();};Identite.prototype.composeMessage=function(aMessage){var H=[];H.push('<table style="width: 100%; height: 100px;"  border="0" cellpadding="0" cellspacing="0">','<tr>','<td class="Texte10 Gras AlignementMilieu" id="',this.idMessageActionRequise,'" tabIndex="-1" ',GObjetWAI?GObjetWAI.composeRole(EGenreRole.Note):'','>',aMessage,'</td>','</tr>','</table>');return H.join('');};Identite.prototype.NavigationClavier=function(AId){if(GNavigateur.IsToucheFleche()){this.FocusSuivant(AId,(GNavigateur.IsToucheFlecheGauche()||GNavigateur.IsToucheFlecheDroite())?(EGenreOrientationAffichage.Horizontal):(EGenreOrientationAffichage.Vertical),(GNavigateur.IsToucheFlecheGauche()||GNavigateur.IsToucheFlecheHaut())?EGenreDirection.SensInverse:EGenreDirection.SensNormal);}
if(GNavigateur.IsToucheSelection()){this._evenementSelectionElmNavigation(AId);}};Identite.prototype._evenementSelectionElmNavigation=function(aID){};Identite.prototype.FocusSuivant=function(AId,AOrientation,ADirection){var LIdSuivant=this.getIdNavigationSuivant(AId,AOrientation,ADirection);if(LIdSuivant){GHtml.setFocus(LIdSuivant);}};Identite.prototype.getIdNavigationSuivant=function(aId,aOrientation,aDirection){return(aOrientation===EGenreOrientationAffichage.Horizontal)?((aDirection===EGenreDirection.SensNormal)?this.TableauDroite[aId]:this.TableauGauche[aId]):((aDirection===EGenreDirection.SensNormal)?this.TableauBas[aId]:this.TableauHaut[aId]);};Identite.prototype.AjouterAuTableaux=function(APremierId,ADeuxiemeId,AHorizontal,AVertical){switch(AHorizontal){case EGenreDirection.DeuxSenses:this.TableauDroite[APremierId]=ADeuxiemeId;this.TableauGauche[ADeuxiemeId]=APremierId;break;case EGenreDirection.SensNormal:this.TableauDroite[APremierId]=ADeuxiemeId;break;case EGenreDirection.SensInverse:this.TableauGauche[ADeuxiemeId]=APremierId;break;}
switch(AVertical){case EGenreDirection.DeuxSenses:this.TableauBas[APremierId]=ADeuxiemeId;this.TableauHaut[ADeuxiemeId]=APremierId;break;case EGenreDirection.SensNormal:this.TableauBas[APremierId]=ADeuxiemeId;break;case EGenreDirection.SensInverse:this.TableauHaut[ADeuxiemeId]=APremierId;break;}};Identite.prototype.ResetTableauxNavigation=function(){this.TableauGauche=[];this.TableauDroite=[];this.TableauHaut=[];this.TableauBas=[];};Identite.prototype.ComposeElementNavigation=function(aID,aContenu,aRole,aOnKeyUp,aOnClick,aOnFocus,aOnBlur,aStyle,aWaiHidden,aWaiLabelId,aWaiLabel){var lRole=aRole?window.GObjetWAI.composeRole(aRole):'';var lOnClick='';if(aOnClick){if(typeof aOnClick==='string'){lOnClick='onclick="'+aOnClick+'"';} else if(aOnClick.length===2){lOnClick=aOnClick[0]+'="'+aOnClick[1]+'"';}}
var lOnKeyUp=aOnKeyUp||this.Nom+'.NavigationClavier (id); if (GNavigateur.IsToucheFleche () || GNavigateur.IsToucheSelection ()) GNavigateur.StopperEvenement (event);' ;var lOnFocus=aOnFocus||this.Nom+'.ActiverBordureNavigation (id, true);' ;var lOnBlur=aOnBlur||this.Nom+'.ActiverBordureNavigation (id, false);' ;var lClass=aWaiHidden?'wai_hidden':'BordureNavigationInactive' ;var lStyle=aStyle?' style="'+aStyle+'"':'';var lWaiLabelId=aWaiLabelId?' '+window.GObjetWAI.composeAttribut({genre:EGenreAttribut.describedby,valeur:aWaiLabelId}):'';var lWaiLabel=aWaiLabel?' '+window.GObjetWAI.composeAttribut({genre:EGenreAttribut.label,valeur:aWaiLabel}):'';var lHTML=[];lHTML.push('<div id="',aID,'" ',lRole,lStyle,' onkeyup="',lOnKeyUp,'" tabIndex="-1" class="',lClass,'" onblur="',lOnBlur,'" onfocus="',lOnFocus,'" ',lOnClick,' ',lWaiLabelId,' ',lWaiLabel,'>',aContenu,'</div>');return lHTML.join('');};Identite.prototype.ActiverBordureNavigation=function(aID,aBool){var lClass=aBool?'BordureNavigationActive':'BordureNavigationInactive';GHtml.setClass(aID,lClass);};Identite.prototype.SetTabId=function(ATabId){this.TabId=ATabId;};Identite.prototype.GetIdSuivant=function(AId){var LNbElt=this.TabId.length,I=0;if(LNbElt>0){for(I=0;I<LNbElt;I++){if(AId===this.TabId[I]){if(I<LNbElt-1){return this.TabId[I+1];}
return this.TabId[0];}}
return this.TabId[LNbElt-1];}};Identite.prototype.GetId=function(APositionId){if(APositionId<this.TabId.length){return this.TabId[APositionId];}};Identite.prototype.FocusSurSuivant=function(AIdElement,AAvecTestRetourChariot){var LAvecTestRetourChariot=AAvecTestRetourChariot||true;if((LAvecTestRetourChariot&&GNavigateur.IsToucheRetourChariot())||GNavigateur.IsToucheTab()){GHtml.setFocus(this.GetIdSuivant(AIdElement));}};Identite.prototype.FocusSurPremierElement=function(){GHtml.setFocus(this.IdPremierElement);};Identite.prototype.SetPremierElement=function(AElement){this.IdPremierElement=AElement;};Identite.prototype.getPremierElement=function(){return this.IdPremierElement;};Identite.prototype.GetPremierElement=function(){return this.IdPremierElement;};Identite.prototype.ajouterInstanceADetruire=function(aInstance){if(aInstance&&aInstance.Nom){this.instancesADetruire[aInstance.Nom]=aInstance;}};Identite.prototype.enleverInstanceADetruire=function(aInstance){if(aInstance&&aInstance.Nom){this.instancesADetruire[aInstance.Nom]=null;}};Identite.prototype.ajouterEvenementGlobal=function(aEvenement,aMethode){if(!GNavigateur.AddEvent){return;}
GNavigateur.AddEvent(aEvenement,this,aMethode);this.pileEvenementGlobaux.push({evenement:aEvenement,methode:aMethode});return this.pileEvenementGlobaux.length-1;};Identite.prototype.viderEvenementGlobaux=function(){var i=0;for(i=0;i<this.pileEvenementGlobaux.length;i++){GNavigateur.DelEvent(this.pileEvenementGlobaux[i].evenement,this);}
this.pileEvenementGlobaux=[];};function _viderEvenements(){Invocateur.desabonner(this);this.viderEvenementGlobaux();}
Identite.prototype.free=function(){this._DetruireInstances();};Identite.prototype._DetruireInstances=function(){;this.__enCoursDeDestruction=true;try{_viderEvenements.bind(this)();if(this.DetruireInstances){this.DetruireInstances();}
if(this.__estFenetreVolante){if(GHtml.elementExiste(this.Nom)){IE.ZoneFenetre.enleverFenetre(this.Nom);}}
else if(!this.Pere||!this.Pere.__enCoursDeDestruction){GHtml.setHtml(this.Nom,'',true);}
this.DetruireInstancesFils();if(this.Pere&&this.Pere.enleverInstanceADetruire){this.Pere.enleverInstanceADetruire(this);}
if(this._callbacksSurDestruction.length>0){IE.MethodesTableau.parcourir(this._callbacksSurDestruction,function(aCallback){aCallback();});}}
catch(e){;}
finally{delete this.__enCoursDeDestruction;this._estDetruite=true;}};Identite.prototype.DetruireInstancesFils=function(){var lNom,lInstance;for(lNom in this.instancesADetruire){if(this.instancesADetruire.hasOwnProperty(lNom)){lInstance=this.instancesADetruire[lNom];if(lInstance&&!lInstance._estDetruite&&lInstance.free){lInstance.free();}
this.instancesADetruire[lNom]=null;}}};Identite.prototype.ajouterCallbackSurDestruction=function(aCallback){this._callbacksSurDestruction.push(aCallback);return this;};var lGenerateurGUID=new IE.GUID.generateur();Identite.collection={};Identite.creerInstance=function(aConstructeur,aParametres){var lNom='';if(!aConstructeur){;return null;}
lNom=lGenerateurGUID.get();$.extend(aParametres,{nomComplet:'Identite.collection.'+lNom});var lInstance=new aConstructeur(aParametres);lInstance.ajouterCallbackSurDestruction(function(){if(Identite.collection[lNom])
delete Identite.collection[lNom];});Identite.collection[lNom]=lInstance;return lInstance;};}());;
var EStructureAffichage={Verticale:1,Horizontale:2,Autre:3};MethodesObjet.heritagePrototype(ObjetAbstraitInterface,Identite);function ObjetAbstraitInterface(ANom,AIdent,APere,AEvenement){this.inheritedCreate(ANom,AIdent,APere,AEvenement);this.EtatIdCourant=true;this.reset();this.NomObjetGraphique=[];this.InitialiserParametresGenerauxParDefaut();this.avecScrollV=false;this.idScrollV=this.Nom+'_scrollV';this.idPremierObjet='';if(this.Nom&&this.avecEventResizeNavigateur()){this.ajouterEvenementGlobal(EEvent.SurResize,this._surResizeInterface);}}(function(){ObjetAbstraitInterface.prototype.reset=function(){this.DetruireInstancesFils();this.Instances=[];this.GenreAffichage=[];this.PositionAffichage=[];this.NombreGenreAffichage=0;this._pileInfosFenetres=[];};ObjetAbstraitInterface.prototype.FocusSurPremierElement=function(){;};ObjetAbstraitInterface.prototype.focusSurPremierObjet=function(){if(this.idPremierObjet) GHtml.setFocus(this.idPremierObjet);else GLog.addLog('['+IE.MethodesObjet.getNomClassDeConstructeur(this.constructor)+'] Il est où mon premierobjet ?','',EGenreLog.Avertissement);};ObjetAbstraitInterface.prototype.addInstance=function(aParametres){var lParametres={objet:null,constructionDecalee:false,evenement:null,init:null,ident:null,traductions:null};$.extend(lParametres,aParametres);var lObjetGraphique=GApplication.getObjetGraphique(lParametres.objet);if(!GApplication.existeObjetGraphique(lParametres.objet)){GLog.addLog('ObjetAbstraitInterface.prototype.addInstance : \"'+(lObjetGraphique?lObjetGraphique.nom:lParametres.objet)+'\" n"existe pas!',null,EGenreLog.Avertissement);return null;}
if((lParametres.ident!==null&&lParametres.ident!==undefined)){this.NombreGenreAffichage=lParametres.ident;}
this.GenreAffichage[this.NombreGenreAffichage]=lParametres.objet;if(!this.PositionAffichage[lParametres.objet]){this.PositionAffichage[lParametres.objet]=[];}
this.PositionAffichage[lParametres.objet].push(this.NombreGenreAffichage);if(lObjetGraphique){if(lParametres.constructionDecalee){if(lObjetGraphique.estFenetre){this._pileInfosFenetres[this.NombreGenreAffichage]=({ident:this.NombreGenreAffichage,genre:lParametres.objet,evenement:lParametres.evenement,init:lParametres.init,traductions:lParametres.traductions,coordonnees:{left:0,top:0}});}
else{;}}
else{var lInstance=_construireObjetGraphique.bind(this)(lObjetGraphique.constructeur,lObjetGraphique.nom,this.NombreGenreAffichage,lParametres.evenement);this.Instances[this.NombreGenreAffichage]=lInstance;if(lParametres.traductions){lInstance.setTraductions(lParametres.traductions);}
if(lParametres.init){lParametres.init.call(this,lInstance);}}}
return this.NombreGenreAffichage++;};ObjetAbstraitInterface.prototype.Add=function(AGenreAffichage,AEvenement,AInitialiser,aTraductions,I){return this.addInstance({objet:AGenreAffichage,evenement:AEvenement,init:AInitialiser,traductions:aTraductions,ident:I});};ObjetAbstraitInterface.prototype.addFenetre=function(AGenreAffichage,AEvenement,AInitialiser,aTraductions,I){return this.addInstance({objet:AGenreAffichage,constructionDecalee:true,evenement:AEvenement,init:AInitialiser,traductions:aTraductions,ident:I});};ObjetAbstraitInterface.prototype.Del=function(){this.Instances[this.NombreGenreAffichage]=null;this.NombreGenreAffichage--;};ObjetAbstraitInterface.prototype.GetInstance=function(AIdent){var lInstance=this.Instances[AIdent];if(!this.Instances[AIdent]&&GApplication.getObjetGraphique(this.GenreAffichage[AIdent])&&GApplication.getObjetGraphique(this.GenreAffichage[AIdent]).estFenetre&&this._pileInfosFenetres[AIdent]&&!this.__enCoursDeDestruction){lInstance=this.creerFenetre(AIdent);}
return lInstance;};function _construireObjetGraphique(aConstructeur,aNom,aIdent,aEvenement){IE.Log.addLog('Interface Construire '+aNom+' ('+aIdent+')','OBJETINTERFACE_LOGNOM');if(aConstructeur){;return new aConstructeur({nomObjet:'Instances['+aIdent+']',pere:this,evenement:aEvenement});}
;return null;}
ObjetAbstraitInterface.prototype.setCallbackInitFenetre=function(aIdent,aCallbackInit){var lInfos=this._pileInfosFenetres[aIdent];if(!lInfos){;return;}
lInfos.init=aCallbackInit;return this;};ObjetAbstraitInterface.prototype.creerFenetre=function(AIdent){var lInstance;if(this._pileInfosFenetres[AIdent]){var lInfosFenetre=this._pileInfosFenetres[AIdent];var lObjetGraphique=GApplication.getObjetGraphique(lInfosFenetre.genre);lInstance=_construireObjetGraphique.bind(this)(lObjetGraphique.constructeur,lObjetGraphique.nom,AIdent,lInfosFenetre.evenement);lInstance.destructionSurFermeture=true;var lSelf=this;lInstance.ajouterCallbackSurDestruction(function(){if(AIdent!==undefined&&lSelf.Instances[AIdent]&&lSelf._pileInfosFenetres[AIdent]){lSelf.Instances[AIdent]=null;var lIndice=IE.MethodesTableau.chercher(lSelf.GetZoneId(AIdent),lSelf._pileFenetre);if(lIndice>=0){lSelf._pileFenetre[lIndice]=null;}}});if(lInfosFenetre.traductions){lInstance.setTraductions(lInfosFenetre.traductions);}
if(!this._pileFenetre){this._pileFenetre=[];}
this._pileFenetre.push(this.GetZoneId(AIdent));IE.ZoneFenetre.ajouterFenetre(this.GetZoneId(AIdent),lInstance.getZIndex?lInstance.getZIndex():'');if(lInfosFenetre.init){lInfosFenetre.init.call(this,lInstance);}
lInstance.Initialiser();lInstance.coordonnees=lInfosFenetre.coordonnees;this.Instances[AIdent]=lInstance;}
return lInstance;};ObjetAbstraitInterface.prototype.GetNomInstance=function(AIdent){return this.GetInstance(AIdent)?this.GetInstance(AIdent).Nom:'';};ObjetAbstraitInterface.prototype.getInstanceParNom=function(aNom){var I;for(I=0;I<this.NombreGenreAffichage;I++){if(this.GetNomInstance(I)===aNom){return this.GetInstance(I);}}};ObjetAbstraitInterface.prototype.GetZoneId=function(AIdent){return this.ConstruireNom(this.Nom+'.Instances',AIdent);};function _construireStructureAffichage(){var lHtml=[];lHtml.push(this.ConstruireStructureFenetres());lHtml.push(this.ConstruireStructureAffichage());return lHtml.join('');}
ObjetAbstraitInterface.prototype.Initialiser=function(aReset){if(aReset){this.reset();}
this.EnConstruction=true;try{this.ConstruireInstances();this.SetParametresGeneraux();GHtml.setHtml(this.Pere===null||this.Pere===undefined?GApplication.getIdConteneur():this.Nom,_construireStructureAffichage.bind(this)(),{instance:this});this.apresConstructionAffichage();this.ConstruireAffichage();}
finally{this.EnConstruction=false;}
this.RecupererDonnees();this.surResizeInterface();if(this.avecScrollV&&!GNavigateur.isTactile){$('#'+this.idScrollV.escapeJQ()).jScrollPane({showArrows:true});}
return this;};ObjetAbstraitInterface.prototype.apresConstructionAffichage=function(){};ObjetAbstraitInterface.prototype.AppartientAZone=function(AIdent){var I;for(I=0;I<this.AddSurZone.length;I++){if((this.AddSurZone[I]===AIdent)&&(this.AddSurZone[I]!=='')){return true;}}
return false;};ObjetAbstraitInterface.prototype.ConstruireStructureAffichageVerticale=function(){var H=[],I,lInfo;var LCadre=this.AvecCadre?5:0;var LStyle=this.couleurFond?GStyle.composeCouleurFond(this.couleurFond):'';H.push('<div style="height:100%">');H.push('<table class="AlignementHaut" style="'+LStyle+'; width:100%; height:100%;" border="0" cellpadding="0" cellspacing="'+LCadre+'" ',GObjetWAI.composeRole(EGenreRole.Presentation),'>');if(this.AddSurZone.length||this.avecBandeau){H.push(this.ConstruireStructureAffichageBandeau());}
var lTabAffichages=[];for(I=0;I<this.NombreGenreAffichage;I++){if(!this.AppartientAZone(I)&&!GApplication.getObjetGraphique(this.GenreAffichage[I]).estFenetre){lInfo={estZoneClient:this.IdentZoneAlClient===I,indice:I};lTabAffichages.push(lInfo);}}
for(I=0;I<lTabAffichages.length;I++){lInfo=lTabAffichages[I];H.push('<tr><td class="AlignementHaut" ');H.push('style="height:'+(lInfo.estZoneClient?'100%':'10px')+'" ');if(lInfo.estZoneClient){this._infoPourResize={id:this.GetZoneId(lInfo.indice),padding:LCadre&&(I>0)?5:0};}
H.push('id="'+this.GetZoneId(lInfo.indice)+'">');H.push(GHtml.composeBlanc());H.push('</td></tr>');}
if(this.NombreGenreAffichage===0){H.push('<tr><td>'+this.composeMessage('')+'</td></tr>');}
H.push('</table>');H.push('</div>');return H.join('');};ObjetAbstraitInterface.prototype.ConstruireStructureAffichageHorizontale=function(){var H=[],I;var LCadre=this.AvecCadre?5:0;var LStyle=this.couleurFond?GStyle.composeCouleurFond(this.couleurFond):'';H.push('<table ',GObjetWAI.composeRole(EGenreRole.Presentation),' style="height:100%; '+(this.AvecLargeurComplete?'width: 100%; ':'')+LStyle+'" ');H.push('border="0" cellpadding="0" cellspacing="'+LCadre+'">');if(this.AddSurZone.length||this.avecBandeau){H.push(this.ConstruireStructureAffichageBandeau());}
H.push('<tr><td style="height: 100%;" class="AlignementHaut">');H.push('<div style="height: 100%;">');H.push('<table style="width: 100%; height: 100%;'+LStyle+'" border="0" cellpadding="0" cellspacing="'+LCadre+'"><tr>');var lZoneResizeDefinie=false;for(I=0;I<this.NombreGenreAffichage;I++){if(!this.AppartientAZone(I)&&!GApplication.getObjetGraphique(this.GenreAffichage[I]).estFenetre){H.push('<td class="AlignementHaut" ');if(this.IdentZoneAlClient!==I){H.push('style="width: 10px; height: 100%;"');}
if(this.IdentZoneAlClient===I){H.push('><div id="'+this.GetZoneId(I)+'" tabindex="-1" style="width:100%; height:100%;"></div>');}
else{H.push(' id="'+this.GetZoneId(I)+'">');}
if(!lZoneResizeDefinie){lZoneResizeDefinie=true;this._infoPourResize={id:this.GetZoneId(I),padding:0};}
H.push('</td>');}}
if(this.NombreGenreAffichage===0){H.push('<tr><td>'+this.composeMessage('Page sans objets graphiques')+'</td></tr>');}
H.push('</tr></table>');H.push('</div>');H.push('</td></tr>');H.push('</table>');return H.join('');};ObjetAbstraitInterface.prototype.ConstruireStructureAffichageAutre=function(){};ObjetAbstraitInterface.prototype.ConstruireStructureFenetres=function(){_effacerFenetres.bind(this)();var H=[],I;for(I=0;I<this.NombreGenreAffichage;I++){if(GApplication.getObjetGraphique(this.GenreAffichage[I]).estFenetre&&this.Instances[I]){if(!this._pileFenetre){this._pileFenetre=[];}
this._pileFenetre.push(this.GetZoneId(I));IE.ZoneFenetre.ajouterFenetre(this.GetZoneId(I),this.Instances[I]&&this.Instances[I].getZIndex?this.Instances[I].getZIndex():'');}}
return H.join('');};ObjetAbstraitInterface.prototype.InitialiserParametresGenerauxParDefaut=function(AStyle,AAvecCadre,AGenreStructure,AAvecHauteurComplete,AAvecLargeurComplete){this.AvecCadre=(AAvecCadre?AAvecCadre:true);this.AvecFondBlanc=false;this.GenreStructure=(AGenreStructure?AGenreStructure:EStructureAffichage.Verticale);this.AvecHauteurComplete=(AAvecHauteurComplete?AAvecHauteurComplete:true);this.AvecLargeurComplete=(AAvecLargeurComplete?AAvecLargeurComplete:true);this.IdentZoneAlClient= -1;this.AddSurZone=[];};ObjetAbstraitInterface.prototype.ConstruireInstances=function(){};ObjetAbstraitInterface.prototype.SetParametresGeneraux=function(){};ObjetAbstraitInterface.prototype.ConstruireStructureAffichage=function(){var lHtml=[];if(this.avecScrollV&&!GNavigateur.isTactile){lHtml.push('<div id="',this.idScrollV,'" style="position:relative; height:100%; overflow-x:hidden; overflow-y:auto;">');if(this.avecEventResizeNavigateur()){this.ajouterEvenementGlobal(EEvent.SurFinResize,_surFinResize);this.ajouterEvenementGlobal(EEvent.SurPreResize,_surPreResize);}}
switch(this.GenreStructure){case EStructureAffichage.Horizontale:lHtml.push(this.ConstruireStructureAffichageHorizontale());break;case EStructureAffichage.Verticale:lHtml.push(this.ConstruireStructureAffichageVerticale());break;default:lHtml.push(this.ConstruireStructureAffichageAutre());break;}
if(this.ConstruireStructureAffichageBandeau&&this.avecBandeau)
this.ConstruireStructureAffichageBandeau();if(this.avecScrollV&&!GNavigateur.isTactile){lHtml.push('</div>');}
return lHtml.join('');};ObjetAbstraitInterface.prototype.ConstruireAffichage=function(){var I;for(I=0;I<this.NombreGenreAffichage;I++){if(this.Instances[I]){if(!GApplication.getObjetGraphique(this.GenreAffichage[I]).estFenetre){this.Instances[I].SetVisible(this.Instances[I].Visible);}
this.Instances[I].Initialiser();}}};ObjetAbstraitInterface.prototype.RecupererDonnees=function(){};ObjetAbstraitInterface.prototype.ConstruireObjetGraphique=function(ANomObjet,AIdent,AEvenement){var lObjetGraphique=GApplication.getObjetGraphique(ANomObjet);return lObjetGraphique?_construireObjetGraphique.bind(this)(lObjetGraphique.constructeur,lObjetGraphique.nom,AIdent,AEvenement):null;};ObjetAbstraitInterface.prototype.EvenementSurNavigation=function(aInstance){var lParametresNavigation=Array.prototype.slice.call(arguments,1);IE.controleSaisieSurEvenement(function(){aInstance.RetourSurNavigation.apply(aInstance,lParametresNavigation);});};ObjetAbstraitInterface.prototype.getSaisiePageEnCours=function(){return null;};ObjetAbstraitInterface.prototype.ActionSurValidation=function(){if(this._callbackNavigation){this._callbackNavigation();delete this._callbackNavigation;} else if(this.AfficherPage){this.AfficherPage.apply(this,arguments);}};ObjetAbstraitInterface.prototype.SetIdCourant=function(AId){if(this.EtatIdCourant){GEtatUtilisateur.IdCourant=AId;}};ObjetAbstraitInterface.prototype.GetIdCourant=function(){return GEtatUtilisateur.IdCourant;};ObjetAbstraitInterface.prototype.SetFocusIdCourant=function(){GHtml.setFocus(this.GetIdCourant());};ObjetAbstraitInterface.prototype.SetEtatIdCourant=function(ABool){this.EtatIdCourant=((ABool!==null&&ABool!==undefined))?ABool:true;};ObjetAbstraitInterface.prototype.skinnerCommande=function(aStr){return'<span class="Texte11 Gras Italique Gris" >'+aStr+'</span>';};ObjetAbstraitInterface.prototype._surResizeInterface=function(){if(GNavigateur.bloquerResize){return;}
this.surResizeInterface();};ObjetAbstraitInterface.prototype.surResizeInterface=function(){if(this.avecScrollV&&!GNavigateur.isTactile){var lReconstruireScroll=false;var lJScroll=$('#'+this.idScrollV.escapeJQ());var lData=lJScroll.data('jsp');if(lData){lData.destroy();lReconstruireScroll=true;}
lJScroll.css('height',0).css('height',$('#'+this.Nom.escapeJQ()).innerHeight()+'px');if(this._infoPourResize){GPosition.declencherResize(this._infoPourResize.id ,GNavigateur.IsIE?-1:0);}
if(lReconstruireScroll){$('#'+this.idScrollV.escapeJQ()).jScrollPane({showArrows:true});}}
else if(this._infoPourResize){GPosition.declencherResize(this._infoPourResize.id);}};function _surPreResize(){if(this.avecScrollV&&!GNavigateur.isTactile){var lData=$('#'+this.idScrollV.escapeJQ()).data('jsp');if(lData){lData.destroy();}
$('#'+this.idScrollV.escapeJQ()).css('overflow-y','hidden');}}
function _surFinResize(){if(this.avecScrollV&&!GNavigateur.isTactile){$('#'+this.idScrollV.escapeJQ()).jScrollPane({showArrows:true}).css('overflow-y','auto');}}
function _effacerFenetres(){if(this._pileFenetre){this._pileFenetre=[];}}
ObjetAbstraitInterface.prototype.DetruireInstancesFils=function(){_effacerFenetres.bind(this)();this.inherited('DetruireInstancesFils');var N=this.Instances?this.Instances.length:0,I,lInstance;for(I=0;I<N;I++){lInstance=this.Instances[I];if(lInstance&&!lInstance._estDetruite&&lInstance.free){GLog.addLog('DetruireInstancesFils instance non detruite : '+lInstance.Nom);lInstance.free();}
this.Instances[I]=null;}};}());IE.controleSaisieSurEvenement=function(aCallback){if(!aCallback||!IE.MethodesObjet.isFunction(aCallback)){;return;}
var lPage=GEtatUtilisateur.GetPageCourante(),lSaisieEnCours=lPage&&IE.MethodesObjet.isFunction(lPage.getSaisiePageEnCours)?lPage.getSaisiePageEnCours():null;if(((window.GEtatUtilisateur&&GEtatUtilisateur.EtatSaisie)||IE.MethodesObjet.isObject(lSaisieEnCours))&&window.GApplication&&!GApplication.getModeExclusif()){lSaisieEnCours=$.extend({titre:GTraductions.getValeur('interface.SaisieNonValidee'),message:GTraductions.getValeur('interface.SouhaitezVousValiderSaisie'),callback:lPage&&lPage.Valider&&lPage.Valider.bind?lPage.Valider.bind(lPage):null},IE.MethodesObjet.isObject(lSaisieEnCours)?lSaisieEnCours:null);;if(lPage.SortirEtatCourantDAffichage)
lPage.SortirEtatCourantDAffichage();IE.Invocateur.evenement(IE.Invocateur.events.etatSaisie,false);delete lPage._callbackNavigation;GApplication.getMessage().afficher({type:EGenreBoiteMessage.Confirmation,titre:lSaisieEnCours.titre,message:lSaisieEnCours.message,callback:function(aGenreBouton){if(aGenreBouton===EGenreAction.Valider){if(lPage.ActionSurValidation){lPage._callbackNavigation=aCallback;}
lSaisieEnCours.callback();lPage.focusSurPremierObjet();}
else if(aGenreBouton===EGenreAction.NePasValider){delete lPage._callbackNavigation;aCallback();}}});} else{aCallback();}};IE.ZoneFenetre={idZoneFenetre:"zone_fenetre"};(function(){IE.ZoneFenetre.getElementZoneFenetre=function(){var lId=IE.ZoneFenetre.idZoneFenetre;var lElement=GHtml.getElement(lId);if(!GHtml.estElement(lElement)){lElement=GHtml.htmlToDOM('<div id="'+lId+'" class="NePasImprimer"></div>');var lDivFrere=GHtml.getElement(GApplication.getIdConteneur());lDivFrere.parentNode.insertBefore(lElement,lDivFrere);$(lElement).jIEDesactiverMenuContextuel();}
return lElement;};IE.ZoneFenetre.ajouterFenetre=function(aId,aZIndex){if(GHtml.elementExiste(aId)){IE.ZoneFenetre.enleverFenetre(aId);GLog.addLog('IE.ZoneFenetre.prototype.ajouterFenetre : la fenetre '+aId+' existe déjà!');}
var lZIndex=aZIndex||1100;GHtml.addHtml(IE.ZoneFenetre.getElementZoneFenetre(),'<div id="'+aId+'" style="position:absolute; display:none; z-index:'+lZIndex+'"></div>');$('#'+aId.escapeJQ()).jIEInterdireSelectionTexte();};IE.ZoneFenetre.enleverFenetre=function(aId){var lElement=GHtml.getElement(aId);if(GHtml.estElement(lElement)&&lElement.parentNode&&(lElement.parentNode.id===IE.ZoneFenetre.idZoneFenetre)){$(lElement).remove();}
else{GLog.addLog('erreur enleverFenetre de '+aId);}};IE.ZoneFenetre.etendreEnFenetre=function(aClass,aParam){if(!aClass||!aClass.prototype){return;}
var lParam=$.extend({zIndex:1000},aParam);aClass.prototype.__estFenetreVolante=true;aClass.prototype.getZIndex=function(){return lParam.zIndex;};aClass.prototype.avecEventResizeNavigateur=function(){return false;};};}());;
(function(){IE.Invocateur.abonner(IE.Invocateur.events.modificationThemeCouleur,function(){if(window.GHtml&&window.GHtml.modifierRegleCss)
GHtml.modifierRegleCss('.jIECheckBox_CouleurTheme','background-color',GCouleur.themeNeutre.sombre);});function lModificationDisabled(aDisabled,aJInput,aJLabel,aData){if(aData.$AvecMain){if(aJLabel)
aJLabel.addClass(aDisabled?'AvecInterdiction':'AvecMain').removeClass(aDisabled?'AvecMain':'AvecInterdiction');aJInput.addClass(aDisabled?'AvecInterdiction':'AvecMain').removeClass(aDisabled?'AvecMain':'AvecInterdiction');}
if(aJLabel)
aJLabel.css('color',aDisabled?aData.$couleurInactif:aData.$couleurActif);}
function _getClassDeJInput(aJInput,aEstCB){var lEtatIndetermine=false;if(aEstCB){lEtatIndetermine=aJInput.cbIndeterminate();}
var lChecked=false;if(!lEtatIndetermine)
lChecked=aJInput.is(':checked');var lDisabled=aJInput.is(':disabled');return lEtatIndetermine?lDisabled?'Image_CheckBox_Indetermine_Inactif':'Image_CheckBox_Indetermine':lChecked?lDisabled?aEstCB?'Image_CheckBox_Coche_Inactif':'Image_RadioB_Coche_Inactif':aEstCB?'Image_CheckBox_Coche':'Image_RadioB_Coche':lDisabled?aEstCB?'Image_CheckBox_Decoche_Inactif':'Image_RadioB_Decoche_Inactif':aEstCB?'Image_CheckBox_Decoche':'Image_RadioB_Decoche';}
function _gererClasseInput(aJInput,aEstCB){var lClassesSuppression=aEstCB?'Image_CheckBox_Coche Image_CheckBox_Decoche Image_CheckBox_Coche_Inactif Image_CheckBox_Decoche_Inactif Image_CheckBox_Indetermine_Inactif Image_CheckBox_Indetermine':'Image_RadioB_Coche Image_RadioB_Decoche Image_RadioB_Coche_Inactif Image_RadioB_Decoche_Inactif';var lClassAjout=_getClassDeJInput(aJInput,aEstCB);lClassesSuppression=lClassesSuppression.replace(lClassAjout,'');aJInput.parent().removeClass(lClassesSuppression).addClass(lClassAjout);}
function _creerCBEtRB(aContexteCourant,aEstCheckBox,aOutils){var lInnerHTML=aContexteCourant.node.innerHTML,lAvecIEHtml=aOutils.hasAttribute(aContexteCourant.node,'ie-html'),lAvecIETexte=aOutils.hasAttribute(aContexteCourant.node,'ie-texte'),lAvecLibelle=lInnerHTML.length>0||lAvecIEHtml||lAvecIETexte,lJModele,lJInput,lRacine,lJLabel=null,llName,lContexteCourant,lNomModele=aOutils.getModel(aContexteCourant),lMap=aOutils.getMapDeNode(aContexteCourant.node),lEventMap,lMarginRight=aContexteCourant.node.style?aContexteCourant.node.style.marginRight:'',lMarginBottom=aContexteCourant.node.style?aContexteCourant.node.style.marginBottom:'',lEtatIndetermine=false,lSubstitution=true,H=[];if(aContexteCourant.node.nodeName.toLowerCase()==='input'){lSubstitution=false;lJInput=$(aContexteCourant.node);var lDivWrap='<div class="InlineBlock jIECheckBox_Conteneur'+(lAvecLibelle?' AlignementMilieuVertical':'')+'">'+'<div class="jIECheckBox_Image OmbreFocus">';lJInput.wrap(lDivWrap).parent().parent().prepend('<div class="jIECheckBox_CouleurTheme"></div>');lJModele=$(aContexteCourant.node).parent().parent();if(lAvecLibelle){lJModele=lJModele.wrap('<label class="InlineBlock">').parent();if(lInnerHTML){lJModele.append('<span class="InlineBlock AlignementMilieuVertical"></span>');}}
if(!lMap.type)
lJInput.attr('type',aEstCheckBox?'checkbox':'radio');lJInput.removeAttr('class').removeAttr('style').css({'margin':0,'padding':0,'opacity':0});}
else{H.push('<div class="InlineBlock jIECheckBox_Conteneur',(lAvecLibelle?' AlignementMilieuVertical':''),'">','<div class="jIECheckBox_CouleurTheme"></div>','<div class="jIECheckBox_Image OmbreFocus">','<input type="'+(aEstCheckBox?'checkbox':'radio')+'" style="margin:0;padding:0;"></input>','</div>','</div>');if(lAvecLibelle){lJModele=lJLabel=$('<label class="InlineBlock">'+
H.join('')+(!lInnerHTML?'<span class="InlineBlock AlignementMilieuVertical"></span>':'')+'</label>');}
else{lJModele=$(H.join(''));}
lJInput=lJModele.find('input');lJInput.css({opacity:0});}
lRacine=lJModele.get(0);lJModele.IEData(aContexteCourant.data);IE.MethodesObjet.etendre(aContexteCourant.data,{$couleurActif:'',$couleurInactif:GCouleur.nonEditable.texte,$AvecMain:true});for(llName in lMap){if(llName!=='type'){try{if(llName==='style'||aOutils.composantsAttributs[llName]){lJModele.attr(llName,lMap[llName]);if(!lSubstitution&&llName!=='style'){lJInput.removeAttr(llName);}}
else if(llName==='class'){lJModele.addClass(lMap[llName]);}
else{if(lSubstitution)
lJInput.attr(llName,lMap[llName]);}} catch(e){;}}}
if(lAvecLibelle||lMarginRight==='')
lJInput.parent().parent().css('margin-right','2px');if(lAvecLibelle&&lMarginBottom==='')
lJInput.parent().parent().css('margin-bottom','1px');lJInput.parent().addClass(_getClassDeJInput($(lJInput),aEstCheckBox));if(!aEstCheckBox&&!lMap.name&&lNomModele&&aContexteCourant.data.$modeleParsed&&aContexteCourant.controleur){lJInput.attr('name',aContexteCourant.controleur.$GUID+'_'+aContexteCourant.data.$modeleParsed.nom);}
if(aEstCheckBox){lEventMap={'change':function(){_gererClasseInput($(this),true);},'IEDisabled':function(){var lJThis=$(this),lJLabel=lAvecLibelle?lJThis.parent().parent().parent():null;_gererClasseInput(lJThis,true);lModificationDisabled(lJThis.is(':disabled'),lJThis,lJLabel,aContexteCourant.data);},'IEChecked':function(){_gererClasseInput($(this),true);},'IECBIndeterminate':function(){_gererClasseInput($(this),true);}};lEtatIndetermine=$(aContexteCourant.node).cbIndeterminate();if(lNomModele&&aContexteCourant.data.$modeleParsed){var lInfosGetIndeterminate=aOutils.getAccesParametres('getIndeterminate',aContexteCourant);if(lInfosGetIndeterminate.estFonction){lEtatIndetermine=!!lInfosGetIndeterminate.callback();aOutils.abonnerRefresh(function(){var lEtat=!!lInfosGetIndeterminate.callback();if(lEtat!==lEtatIndetermine){lEtatIndetermine=lEtat;lJInput.prop('indeterminate',lEtatIndetermine);_gererClasseInput(lJInput,true);}},lJInput,aContexteCourant);}}}
else{var lHandlerEvent=function(){_gererClasseInput($(this),false);var lName=$(this).attr('name');if(lName&&lName.escapeJQ){lName=lName.escapeJQ();}
$(':radio[name="'+lName+'"]').each(function(){_gererClasseInput($(this),false);});};lEventMap={'change':lHandlerEvent,'IEDisabled':function(){lHandlerEvent.call(this);var lJThis=$(this),lJLabel=lAvecLibelle?lJThis.parent().parent().parent():null;lModificationDisabled(lJThis.is(':disabled'),lJThis,lJLabel,aContexteCourant.data);},'IEChecked':lHandlerEvent};}
lEventMap.focus=function(){$(this).parent().triggerHandler('focusin');};lEventMap.blur=function(){$(this).parent().triggerHandler('focusout');};lJInput.on(lEventMap);if(aContexteCourant.data.$modeleValue){lContexteCourant=$.extend({},aContexteCourant);lContexteCourant.node=lJInput.get(0);aOutils.gererInputCB(lContexteCourant,lMap.type);}
lModificationDisabled(lJInput.is(':disabled'),lJInput,lJLabel,aContexteCourant.data);if(lEtatIndetermine){lJInput.prop('indeterminate',lEtatIndetermine);_gererClasseInput(lJInput,true);}
if(lSubstitution)
aContexteCourant.node.parentNode.replaceChild(lRacine,aContexteCourant.node);aOutils.addCommentaireDebug(lRacine,(aEstCheckBox?'ie-checkbox':'ie-radio'));if(lAvecLibelle){if(lInnerHTML){aOutils.injectHTML({element:lRacine,html:'<span class="InlineBlock AlignementMilieuVertical">'+lInnerHTML+'</span>',controleur:aContexteCourant.controleur,ignorerScroll:true,contexte:aContexteCourant.contexte});}
aContexteCourant.transfertContenu=lRacine.lastChild;}
aContexteCourant.node=lRacine;return{node:aContexteCourant.node,avecCompileFils:false};}
IE.HTML.addBalise('ie-checkbox',function(aContexteCourant,aOutils){return _creerCBEtRB(aContexteCourant,true,aOutils);});IE.HTML.addBalise('ie-radio',function(aContexteCourant,aOutils){return _creerCBEtRB(aContexteCourant,false,aOutils);});}());IE.HTML.addBalise('ie-bouton',function(aContexteCourant,aOutils){function _surMouseOver(event){var lJhis=$(this),lData=lJhis.IEData();if(GNavigateur.isTactile){return ;}
if(lData.$disabled){return;}
lJhis.css('background-color',lData.$couleurFondSurvol);}
function _surMouseOut(event){var lJhis=$(this),lData=lJhis.IEData();if(GNavigateur.isTactile){return ;}
if(lData.$disabled){return;}
lJhis.css('background-color',lData.$couleurFond);}
IE.MethodesObjet.etendre(aContexteCourant.data,{$couleurFond:GCouleur.themeNeutre.moyen2,$couleurFondSurvol:GCouleur.themeNeutre.foncee,$couleurFondInactif:GCouleur.nonEditable.fond,$couleurTexteInactif:GCouleur.nonEditable.texte,$couleurBordureInfDroit:GCouleur.themeNeutre.claire,$disabled:false});var lInnerHtml=aContexteCourant.node.innerHTML;var lBouton=GHtml.htmlToDOM('<button '+GObjetWAI.composeRole(EGenreRole.Button)+'>'+'</button>');var lJBouton=$(lBouton);lJBouton.IEData(aContexteCourant.data);var llName,lDisabled=false,lModele=aOutils.getModel(aContexteCourant);if(lModele&&aContexteCourant.data.$modeleParsed){var lInfosEvent=aOutils.getAccesParametres('event',aContexteCourant),lInfosGetDisabled=aOutils.getAccesParametres('getDisabled',aContexteCourant),lAvecControleSaisie=aOutils.getControleSaisieEvent(aContexteCourant);if(lInfosEvent.estFonction){var lRefresh=aContexteCourant.contexte.refresh;lJBouton.on('click',function(event){if(aContexteCourant.data.$disabled){return;}
var lAction=function(){var lResult=lInfosEvent.callback([event,this,aContexteCourant.data]);lRefresh();return lResult;};if(lAvecControleSaisie){IE.controleSaisieSurEvenement(lAction);}
else{return lAction();}});}
if(lInfosGetDisabled.valide){var lGetter=function(){return!!lInfosGetDisabled.callback([lBouton,aContexteCourant.data]);};if(lInfosGetDisabled.estFonction||!lGetter()||lGetter()===true){lDisabled=!!lGetter();aOutils.abonnerRefresh(function(){var lDisabled=!!lGetter();if(lDisabled!==aContexteCourant.data.$disabled){aContexteCourant.data.$disabled=lDisabled;$(lBouton).inputDisabled(lDisabled);}},lBouton,aContexteCourant);}
else{IE.Log.addLog('echec getDisabled de ie-bouton, propriété incorrecte du model "'+lModele+'"');}}}
var lMap=aOutils.getMapDeNode(aContexteCourant.node);for(llName in lMap){try{lJBouton.attr(llName,lMap[llName]);switch(llName){case'disabled':lDisabled=true;break;}}
catch(e){;}}
if(!lBouton.style.height){var lHeight=20+(IE.Support.avecSupportBoxShadow?-1:0);lBouton.style.height=lHeight+'px';}
if(!lDisabled&&aContexteCourant.data.$disabled){lJBouton.attr('disabled','');}
else if(lDisabled){$(lBouton).inputDisabled(true);}
aContexteCourant.data.$disabled=lDisabled;lJBouton.css({'color':aContexteCourant.data.$disabled?aContexteCourant.data.$couleurTexteInactif:GCouleur.noir,'background-color':aContexteCourant.data.$disabled?aContexteCourant.data.$couleurFondInactif:aContexteCourant.data.$couleurFond,'transition-property':'background-color','transition-duration':'0.2s','box-shadow':'0 2px 0 0 rgba(50, 50, 50, 0.15)','border':IE.Support.avecSupportBoxShadow?'':'1px solid '+aContexteCourant.data.$couleurBordureInfDroit}).addClass('Texte10 AvecMain Boutons Gras OmbreFocus NoWrap').on({mouseleave:_surMouseOut,mouseenter:_surMouseOver,IEDisabled:function(event){var lJThis=$(this),lData=lJThis.IEData();lData.$disabled=lJThis.is(':disabled');lJThis.css({'color':lData.$disabled?lData.$couleurTexteInactif:GCouleur.noir,'background-color':lData.$disabled?lData.$couleurFondInactif:lData.$couleurFond});}});var lRacine=lJBouton.get(0);aContexteCourant.node.parentNode.replaceChild(lRacine,aContexteCourant.node);aContexteCourant.node=lJBouton.get(0);if(lInnerHtml){aOutils.injectHTML({element:lRacine,html:lInnerHtml,controleur:aContexteCourant.controleur,ignorerScroll:true,contexte:aContexteCourant.contexte});}
aOutils.addCommentaireDebug(lRacine,'ie-bouton');return{node:aContexteCourant.node,avecCompileFils:false};});IEEnum.GenreEtatBtnImage={NonSelectionne:0,Inactif:1,Selectionne:3,SurvolNonSelectionne:4,SurvolSelectionne:5};IE.HTML.addBalise('ie-btnImage',function(aContexteCourant,aOutils){function _actualiser(aJBouton,aData,aSurvol){if(!aData.$disabled)
aData.$genre=aData.$selection?(aSurvol?IEEnum.GenreEtatBtnImage.SurvolSelectionne:IEEnum.GenreEtatBtnImage.Selectionne):(aSurvol?IEEnum.GenreEtatBtnImage.SurvolNonSelectionne:IEEnum.GenreEtatBtnImage.NonSelectionne);else aData.$genre=IEEnum.GenreEtatBtnImage.Inactif;GPosition.setBackgroundPosition(aJBouton.get(0),-aData.$width*aData.$genre);}
IE.MethodesObjet.etendre(aContexteCourant.data,{$width:20,$selection:false,$genre:IEEnum.GenreEtatBtnImage.NonSelectionne,$disabled:false});var lBouton=GHtml.htmlToDOM('<div '+GObjetWAI.composeRole(EGenreRole.Button)+' tabindex="0">'+'</div>');var lJBouton=$(lBouton);lJBouton.IEData(aContexteCourant.data);var llName,lInfosEvent,lInfosGetSelection,lInfosGetDisabled,lInfosGetTitle,lOuterHTML='',lRefresh,lAvecControleSaisie,lDisabled=false,lModele=aOutils.getModel(aContexteCourant),lAvecLabelAccessible=aOutils.hasAttribute(aContexteCourant.node,GObjetWAI.WaiAttribut[EGenreAttribut.label]),lLabelWAIManquant=!lAvecLabelAccessible,lSetTitle=function(aTitle){aContexteCourant.data.$oldTitle=aTitle;lJBouton.attr('title',aTitle);if(!lAvecLabelAccessible){lJBouton.attr(GObjetWAI.WaiAttribut[EGenreAttribut.label],aTitle);}};if(lModele&&aContexteCourant.data.$modeleParsed){lInfosEvent=aOutils.getAccesParametres('event',aContexteCourant);lInfosGetSelection=aOutils.getAccesParametres('getSelection',aContexteCourant);lInfosGetDisabled=aOutils.getAccesParametres('getDisabled',aContexteCourant);lInfosGetTitle=aOutils.getAccesParametres('getTitle',aContexteCourant);lRefresh=aContexteCourant.contexte.refresh;lAvecControleSaisie=aOutils.getControleSaisieEvent(aContexteCourant);if(lInfosEvent.estFonction){lJBouton.on('click keyup',function(event){if(aContexteCourant.data.$disabled){return;}
if(event.type==='keyup'&&event.which!==ToucheClavier.RetourChariot&&event.which!==ToucheClavier.Espace){return;}
var lAction=function(){var lResult=lInfosEvent.callback([event,this,aContexteCourant.data]);lRefresh();return lResult;};if(lAvecControleSaisie){IE.controleSaisieSurEvenement(lAction);}
else{return lAction();}});}
var lGetSelection,lGetterDisabled,lGetterTitle;if(lInfosGetSelection.valide){lGetSelection=function(){return!!lInfosGetSelection.callback([aContexteCourant.node,aContexteCourant.data]);};aContexteCourant.data.$selection=lGetSelection();}
if(lInfosGetDisabled.valide){lGetterDisabled=function(){return!!lInfosGetDisabled.callback([lBouton,aContexteCourant.data]);};if(lInfosGetDisabled.estFonction||!lGetterDisabled()||lGetterDisabled()===true){lDisabled=!!lGetterDisabled();}
else{lGetterDisabled=null;IE.Log.addLog('echec getDisabled de ie-bouton, propriété incorrecte du model "'+lModele+'"');}}
if(lInfosGetTitle.estFonction){lGetterTitle=function(){return lInfosGetTitle.callback([lBouton,aContexteCourant.data])||'';};lSetTitle(lGetterTitle());lLabelWAIManquant=false;}
if(lGetSelection||lGetterDisabled||lGetterTitle){aOutils.abonnerRefresh(function(){var lActualiser=false;if(lGetSelection){var lSelection=lGetSelection();if(lSelection!==aContexteCourant.data.$selection){aContexteCourant.data.$selection=lSelection;lActualiser=true;}}
if(lGetterDisabled){var lDisabled=!!lGetterDisabled();if(lDisabled!==aContexteCourant.data.$disabled){aContexteCourant.data.$disabled=lDisabled;if(lDisabled)
lJBouton.attr(GObjetWAI.WaiAttribut[EGenreAttribut.disabled],'true');else lJBouton.get(0).removeAttribute(GObjetWAI.WaiAttribut[EGenreAttribut.disabled]);lActualiser=true;}}
if(lActualiser){_actualiser(lJBouton,aContexteCourant.data,false);}
if(lGetterTitle){var lTitle=lGetterTitle();if(lTitle!==aContexteCourant.data.$oldTitle){lSetTitle(lTitle);}}},lBouton,aContexteCourant);}}
var lMap=aOutils.getMapDeNode(aContexteCourant.node);for(llName in lMap){try{lJBouton.attr(llName,lMap[llName]);if(llName==='title'&&lMap[llName]&&(!lInfosGetTitle||!lInfosGetTitle.estFonction)){lJBouton.attr(GObjetWAI.WaiAttribut[EGenreAttribut.label],lMap[llName]);lLabelWAIManquant=false;}}
catch(e){;}}
if(!lBouton.style.width){lBouton.style.width=aContexteCourant.data.$width+'px';}
else{aContexteCourant.data.$width=parseInt(lBouton.style.width,10)||aContexteCourant.data.$width;}
aContexteCourant.data.$disabled=lDisabled;_actualiser(lJBouton,aContexteCourant.data,false);if(lDisabled)
lJBouton.attr(GObjetWAI.WaiAttribut[EGenreAttribut.disabled],'true');lJBouton.addClass((lModele?'AvecMain ':'')+'OmbreFocus').on('focusin mouseover',function(){_actualiser(lJBouton,aContexteCourant.data,true);}).on('focusout mouseout',function(){_actualiser(lJBouton,aContexteCourant.data,false);});var lRacine=lJBouton.get(0);aContexteCourant.node.parentNode.replaceChild(lRacine,aContexteCourant.node);aOutils.addCommentaireDebug(lRacine,'ie-btnImage');return{node:lJBouton.get(0),avecCompileFils:false};});IE.HTML.addAttribut('ie-event',function(aContexteCourant,aNodeName,aAttributValue,aOutils){var lValue=aAttributValue||'';if(!aContexteCourant.controleur){;return;}
var lTab=lValue.split('->');if(lTab.length<2){;return;}
var lMethode,lEvents=lTab[0].trim().split('-'),lSelecteur=null,lInfos;lTab.shift();lMethode=lTab.join('->');if(lMethode.length>2&&lMethode.charAt(0)==='{'){lTab=lMethode.split('}');if(lTab.length<2){;return;}
var lNomSelecteur=lTab[0].slice(1);lTab.shift();lMethode=lTab.join('}');if(aContexteCourant.data&&aContexteCourant.data[lNomSelecteur]){lSelecteur=aContexteCourant.data[lNomSelecteur];}
else{lSelecteur=lNomSelecteur;}}
lInfos=aOutils.getAccesParametres(lMethode,aContexteCourant);if(!lInfos.valide||!lInfos.estFonction){;return;}
if(lInfos){var lCallbackEvent=function(event){return lInfos.callback([event,this,aContexteCourant.node,aContexteCourant.data]);};if(lSelecteur){$(aContexteCourant.node).on(lEvents.join(' '),lSelecteur,{controleur:aContexteCourant.controleur},lCallbackEvent);}
else{$(aContexteCourant.node).on(lEvents.join(' '),{controleur:aContexteCourant.controleur},lCallbackEvent);}
aOutils.addCommentaireDebug(aContexteCourant.node,'ie-event="'+lValue+'"');return true;}
else{aOutils.addCommentaireDebug(aContexteCourant.node,'[ECHEC] ie-event="'+lValue+'"');}
return true;});IE.HTML.addAttribut('ie-title',function(aContexteCourant,aNodeName,aAttributValue,aOutils){var lNom=aAttributValue||'',lGetter,lOldValue=lNom;if(lNom&&aContexteCourant.controleur){var lInfos=aOutils.getAccesParametres(lNom,aContexteCourant,true);if(lInfos.estFonction){lGetter=function(){var lResult=(lInfos.callback([aContexteCourant.node,aContexteCourant.data])||'')+'';return lResult.replace&&window.GChaine&&window.GChaine.enleverEntites?window.GChaine.enleverEntites(lResult):'';};}}
if(lGetter){lOldValue=lGetter();}
else if(lOldValue==='undefined'||lOldValue==='null'){;return false;}
else ;$(aContexteCourant.node).attr('title',lOldValue);if(lGetter){aOutils.abonnerRefresh(function(){var lValue=lGetter().toString();if(lOldValue!==lValue){lOldValue=lValue;$(aContexteCourant.node).attr('title',lOldValue);}},aContexteCourant.node,aContexteCourant);}
aOutils.addCommentaireDebug(aContexteCourant.node,'ie-title'+(lNom?'="'+lNom+'"':''));return true;});IE.HTML.addAttribut('ie-hint',function(aContexteCourant,aNodeName,aAttributValue,aOutils){var lNom=aAttributValue||'',lValue=lNom;if(lValue&&lValue.length>2&&lValue.charAt(0)==='\''&&lValue.charAt(lValue.length-1)==='\''){lValue=lValue.slice(1,lValue.length-1);}
else if(lNom&&aContexteCourant.controleur){var lInfos=aOutils.getAccesParametres(lNom,aContexteCourant,true);if(lInfos.estFonction){lValue=function(){return(lInfos.callback([aContexteCourant.node,aContexteCourant.data])||'')+'';};}}
if(!lValue&&aContexteCourant.data&&aContexteCourant.data.$hint)
lValue=aContexteCourant.data.$hint;if(!lValue){;return true;}
IE.Hint.attach({$Element:$(aContexteCourant.node),namespace:'iehint',contenu:lValue});$(aContexteCourant.node).addClass('jiehint');aOutils.addCommentaireDebug(aContexteCourant.node,'ie-hint'+(lNom?'="'+lNom+'"':''));return true;});(function(){IE.HTML.addAttribut('ie-html',function(aContexteCourant,aNodeName,aAttributValue,aOutils,aParametresCompile){var lValue=aAttributValue||'';if(!lValue){lValue=aContexteCourant.data?aContexteCourant.data.$html:'';}
if(!lValue){;return true;}
if(!aContexteCourant.controleur){;return true;}
var lInfos=aOutils.getAccesParametres(lValue,aContexteCourant);if(!lInfos.valide){;return true;}
var lNodeDestination=aContexteCourant.transfertContenu||aContexteCourant.node;var lGetter=function(){var lResult=lInfos.callback([lNodeDestination,aContexteCourant.data]);if(IE.MethodesObjet.isNumber(lResult))
return lResult+'';return(lResult||'')+'';};var lHtml=lGetter();if(!lInfos.estFonction&&!IE.MethodesObjet.isString(lHtml)){return;}
$(lNodeDestination).IEHtml('');aOutils.injectHTML({element:lNodeDestination,html:lHtml,controleur:aContexteCourant.controleur,contexte:aContexteCourant.contexte});var lOldHtmlValue=lHtml;var lInvocateur=new IEClasses.Invocateur();aOutils.abonnerRefresh(function(aGuidEmetteur,aHashGuidCible){var lHtml=lGetter();if(lHtml!==lOldHtmlValue){lOldHtmlValue=lHtml;$(lNodeDestination).IEHtml('');aOutils.injectHTML({element:lNodeDestination,html:lHtml,controleur:aContexteCourant.controleur,contexte:aContexteCourant.contexte,invocateur:lInvocateur});}
else{lInvocateur.evenement(IE.HTML.C_id_event_iemodel,aGuidEmetteur,aHashGuidCible);}},lNodeDestination,aContexteCourant);aOutils.addCommentaireDebug(lNodeDestination,'ie-html="'+lValue+'"');aParametresCompile.avecCompileFils=false;return true;});}());IE.HTML.addAttribut('ie-texte',function(aContexteCourant,aNodeName,aAttributValue,aOutils,aParametresCompile){var lValue=aAttributValue||'';if(!lValue){;return true;}
if(!aContexteCourant.controleur){;return true;}
var lInfos=aOutils.getAccesParametres(lValue,aContexteCourant);if(!lInfos.valide){;return true;}
var lNodeDestination=aContexteCourant.transfertContenu||aContexteCourant.node;var lGetter=function(){var lResult=lInfos.callback([lNodeDestination,aContexteCourant.data]);if(IE.MethodesObjet.isNumber(lResult))
return lResult+'';return(lResult||'')+'';};var lOldTexte=lGetter();$(lNodeDestination).IEHtml('');lNodeDestination.appendChild(document.createTextNode(lOldTexte));aOutils.abonnerRefresh(function(){var lTexte=lGetter();if(lTexte!==lOldTexte){lOldTexte=lTexte;$(lNodeDestination).IEHtml('');lNodeDestination.appendChild(document.createTextNode(lTexte));}},lNodeDestination,aContexteCourant);aOutils.addCommentaireDebug(lNodeDestination,'ie-texte="'+lValue+'"');return true;});(function(){function _stylesCssIdentiques(aStyle1,aStyle2){if(!aStyle1&&aStyle2||aStyle1&&!aStyle2){return false;}
var i;for(i in aStyle1){if(aStyle1[i]!==aStyle2[i]){return false;}}
for(i in aStyle2){if(aStyle1[i]!==aStyle2[i]){return false;}}
return true;}
IE.HTML.addAttribut('ie-style',function(aContexteCourant,aNodeName,aAttributValue,aOutils){var lValue=aAttributValue||'';if(!lValue){lValue=aContexteCourant.data?aContexteCourant.data.$style:'';}
if(!lValue){;return true;}
if(!aContexteCourant.controleur){;return true;}
var lInfos=aOutils.getAccesParametres(lValue,aContexteCourant);if(!lInfos.valide){;return true;}
var lGetter=function(){var lStyle=lInfos.callback([aContexteCourant.node,aContexteCourant.data])||null;return lStyle||{};};var lObjetCss=lGetter(aContexteCourant.node),lJNode=$(aContexteCourant.node);if(!lInfos.estFonction||!lObjetCss){return;}
lJNode.css(lObjetCss);aOutils.abonnerRefresh(function(){var lNewStyleCss=lGetter(aContexteCourant.node);if(!_stylesCssIdentiques(lNewStyleCss,lObjetCss)){lObjetCss=lNewStyleCss;$(aContexteCourant.node).css(lObjetCss);}},aContexteCourant.node,aContexteCourant);aOutils.addCommentaireDebug(aContexteCourant.node,'ie-style="'+lValue+'"');return true;});}());(function(){IE.HTML.addAttribut('ie-class',function(aContexteCourant,aNodeName,aAttributValue,aOutils){var lValue=aAttributValue||'';if(!lValue||!aContexteCourant.controleur){;return true;}
var lInfos=aOutils.getAccesParametres(lValue,aContexteCourant);if(!lInfos.valide){;return true;}
var lClassCss=lInfos.callback()||'';if(lClassCss.length>0){$(aContexteCourant.node).addClass(lClassCss);}
aOutils.abonnerRefresh(function(){var lNewClassCss=lInfos.callback()||'';if(lNewClassCss!==lClassCss){$(aContexteCourant.node).removeClass(lClassCss).addClass(lNewClassCss);lClassCss=lNewClassCss;}},aContexteCourant.node,aContexteCourant);aOutils.addCommentaireDebug(aContexteCourant.node,'ie-class="'+lValue+'"');return true;});}());(function(){IE.HTML.addAttribut('ie-display',function(aContexteCourant,aNodeName,aAttributValue,aOutils){var lValue=aAttributValue||'';if(!lValue||!aContexteCourant.controleur){;return true;}
var lInfos=aOutils.getAccesParametres(lValue,aContexteCourant);if(!lInfos.valide){;return true;}
var lGetter=function(){return!!lInfos.callback([aContexteCourant.node,aContexteCourant.data]);};var lDisplay=lGetter(aContexteCourant.node);GHtml.setDisplay(aContexteCourant.node,lDisplay);var lOldDisplayValue=lDisplay;aOutils.abonnerRefresh(function(){var lDisplay=lGetter(aContexteCourant.node);if(lDisplay!==lOldDisplayValue){lOldDisplayValue=lDisplay;GHtml.setDisplay(aContexteCourant.node,lDisplay);}},aContexteCourant.node,aContexteCourant);aOutils.addCommentaireDebug(aContexteCourant.node,'ie-display="'+lValue+'"');return true;});}());IE.HTML.addAttribut('ie-ellipsis',function(aContexteCourant,aNodeName,aAttributValue,aOutils){var lNode=aContexteCourant.node,lJElement=$(lNode);lJElement.addClass('ie-ellipsis') ;IE.Hint.attach({$Element:lJElement,namespace:'ellipsis',contenu:function(){return $(lNode).html();},interrupt:function(){if($(this).hasClass('jiehint'))
return true;if($(this).prop('title').length>0)
return true;if($(this).outerWidth()>=$(this).prop('scrollWidth'))
return true;}});lJElement=null;aOutils.addCommentaireDebug(aContexteCourant.node,'ie-ellipsis');return true;});;
var EBoutonFenetre={croixFermeture:-1,mrFiche:-2};MethodesObjet.heritagePrototype(ObjetFenetre,ObjetAbstraitInterface);function ObjetFenetre(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.NomFenetre=this.Nom+'_Fenetre';this.idFenetreContenu=this.Nom+'_FenetreContenu';this.IdTitre=this.Nom+'_Titre';this.IdTitreImage=this.IdTitre+'_image';this.IdBoutons=this.Nom+'_Boutons';this.idValidationAuto=this.Nom+'_ValidationAuto';this.IdContenu=this.Nom+'_Contenu';this.IdPremierElement=this.NomFenetre;this.idLigneBas=this.Nom+'_Bas';this.idCroixFermeture=this.Nom+'_CroixFerme';this.idRetaillage=this.Nom+'_Retaillage';this.Titre='';this.ListeBoutons=[];this.avecTailleSelonContenu=false;this.initialiserOptionsFenetre();this.resetCoordonnees();if(this.Nom){this.ajouterEvenementGlobal(EEvent.SurPreResize,this.preResizePositionnement);this.ajouterEvenementGlobal(EEvent.SurPostResize,this.postResizePositionnement);if(GNavigateur.IsIE){this.ajouterEvenementGlobal(EEvent.SurPostResize,this.postResizeIE);}}
this.avecAnimation=false;}(function(){IE.ZoneFenetre.etendreEnFenetre(ObjetFenetre,{zIndex:1100});ObjetFenetre.prototype.DetruireInstances=function(){_enleverEventsRetaillage.bind(this)();if(!this.__surDestructionApresFermeture_){this.Fermer({sansAnimation:true});}};ObjetFenetre.prototype.SetParametresGeneraux=function(){this.GenreStructure=EStructureAffichage.Autre;GHtml.setDisplay(this.Nom,false);};ObjetFenetre.prototype.initialiserOptionsFenetre=function(){this.optionsFenetre={modale:true,titre:'',avecAbonnementBlocage:true,avecAbonnementPremierPlan:true,avecAbonnementFermetureFenetreGenerale:true,bloquerFocus:false,largeur:100,hauteur:100,avecPaddingContenu:true,avecCroixFermeture:true,avecScroll:false,avecMrFiche:false,avecRetaillage:false,largeurMin:0,hauteurMin:0,avecMessageValidationAuto:false,callback:null,callbackDeplacer:null,tailleBandeRetaillage:3,listeBoutonsInvisibles:[],listeBoutonsInactifs:[]};return this;};ObjetFenetre.prototype.setOptionsFenetre=function(aOptions){$.extend(this.optionsFenetre,aOptions);this.$refreshSelf();return this;};ObjetFenetre.prototype.getControleur=function(){return{$off:function(){return!this.instance.EnAffichage;},eventSurFenetre:function(aEvent){switch(aEvent.type){case'keyup':if(GNavigateur.IsToucheEchap&&GNavigateur.IsToucheEchap()){this.instance.SurValidation(EBoutonFenetre.croixFermeture);}
return;case'mousedown':this.instance.EnPremierPlan();return;}},getTitre:function(){return this.instance.optionsFenetre.titre?this.instance.optionsFenetre.titre:this.instance.Titre||'';},croixFermeture:{click:function(){this.instance.SurValidation(EBoutonFenetre.croixFermeture);},keyup:function(){if(GNavigateur.IsToucheSelection()){this.instance.SurValidation(EBoutonFenetre.croixFermeture);}}},fenetreBtn:{event:function(aIndiceBouton,event,aNode,aData){this.instance.SurValidation(aIndiceBouton);},getDisabled:function(aIndiceBouton,aNode,aData){return this.instance.optionsFenetre.listeBoutonsInactifs[aIndiceBouton]===true;},getDisplay:function(aIndiceBouton){return this.instance.optionsFenetre.listeBoutonsInvisibles[aIndiceBouton]!==true;},fenetreBtn_getLibelle:function(aIndice){return this.instance.ListeBoutons[aIndice];}}};};ObjetFenetre.prototype.RecupererDonnees=function(){var lInstance=this;$('#'+this.Nom.escapeJQ()).jIEDraggable({handle:'#'+this.IdTitre.escapeJQ()+',#'+this.IdTitreImage.escapeJQ(),stop:function(){lInstance.setCoordonnees();}});IE.Invocateur.desabonner(IE.Invocateur.events.fermerFenetres,this);if(this.optionsFenetre.avecAbonnementFermetureFenetreGenerale){IE.Invocateur.abonner(IE.Invocateur.events.fermerFenetres,this.Fermer.bind(this,{sansAnimation:true}),this);}
if(this.optionsFenetre.avecRetaillage){var lJDroit=$('<div style="position:absolute; right:0px; top : 0; bottom:0;'+GStyle.composeWidth(this.optionsFenetre.tailleBandeRetaillage)+'" class="AvecResizeHorizontal"></div>').on('iedown',{instance:this,droit:true},_surMouseDownRetaillage),lJBas=$('<div style="position:absolute; right:0; bottom:0px;left:0;'+GStyle.composeHeight(this.optionsFenetre.tailleBandeRetaillage)+'" class="AvecResizeVertical"></div>').on('iedown',{instance:this,bas:true},_surMouseDownRetaillage),lJGauche=$('<div style="position:absolute; left:-'+this.optionsFenetre.tailleBandeRetaillage+'px; bottom:0;top:0;'+GStyle.composeWidth(this.optionsFenetre.tailleBandeRetaillage)+'" class="AvecResizeHorizontal"></div>').on('iedown',{instance:this,gauche:true},_surMouseDownRetaillage),lJHaut=$('<div style="position:absolute; right:0; left:0;top:-'+this.optionsFenetre.tailleBandeRetaillage+'px;'+GStyle.composeHeight(this.optionsFenetre.tailleBandeRetaillage)+'" class="AvecResizeVertical"></div>').on('iedown',{instance:this,haut:true},_surMouseDownRetaillage),lJCoin=$('<div style="position:absolute; right:1px; bottom:0; z-index:1;" class="AvecResize Fenetre_ImageFondResize Image_Retailler"></div>').on('iedown',{instance:this,bas:true,droit:true},_surMouseDownRetaillage);$('#'+this.Nom.escapeJQ()).append(lJDroit,[lJCoin,lJBas,lJGauche,lJHaut]);}};ObjetFenetre.prototype.FocusSurPremierElement=function(){GHtml.setFocus(this.IdTitre);};ObjetFenetre.prototype.ConstruireStructureAffichageAutre=function(){var lHTML=[];var LStyle=this.optionsFenetre.largeur?GStyle.composeWidth(this.optionsFenetre.largeur):'';LStyle+=(this.optionsFenetre.largeurMin>0)?'min-width: '+this.optionsFenetre.largeurMin+'px;':'';LStyle+=this.optionsFenetre.hauteur?GStyle.composeHeight(this.optionsFenetre.hauteur):GStyle.composeHeight(100,'%');LStyle+=(this.optionsFenetre.hauteurMin>0)?'min-height: '+this.optionsFenetre.hauteurMin+'px;':'';LStyle+=GStyle.composeBoxShadow();LStyle+=GStyle.composeCouleurFond(GCouleur.fond);lHTML.push('<span class="wai_hidden" tabindex="0" onfocus="'+this.Nom+'.FocusSurPremierElement();"></span>','<div id="',this.NomFenetre,'"',' ie-event="mousedown-keyup->eventSurFenetre" ',GObjetWAI.composeAttribut({genre:EGenreAttribut.labelledby,valeur:this.IdTitre}),' class="SansOutline" tabIndex="-1" ',GObjetWAI.composeRole(EGenreRole.Dialog),'>',this.composeFenetre(),'<table id="',this.idFenetreContenu,'" class="Fenetre_Cadre Fenetre_Scroll" style="',LStyle,'" border="0" cellpadding="0" cellspacing="0">');var lHtmlBas=this.ComposeBas();var lHtmlBoutons=this.ComposeBoutons();var lHtmlMrFiche=this.optionsFenetre.avecMrFiche?'<td class="AvecMain" width="1px" onclick="'+this.Nom+'.SurValidation ('+EBoutonFenetre.mrFiche+', false)" >'+'<div class="Image_MrFicheFenetre" style="width: 18px"></div>'+'</td>':'';lHTML.push('<tr class="NePasImprimer"><td style="height: '+GApplication.hauteurBandeau+'px;">','<table class="Texte10 Gras Fenetre_Titre" style="','height: '+GApplication.hauteurBandeau+'px; ',GStyle.composeCouleur(GCouleur.fenetre.bandeau.fond,GCouleur.fenetre.bandeau.texte),'" border="0" cellpadding="0" cellspacing="0">','<tr>','<td id="',this.IdTitreImage,'" width="1px" class="EspaceGauche AvecMove">','</td>','<td id="',this.IdTitre,'" class="EspaceGauche AvecMove" ie-html="getTitre" tabindex="0">','</td>',lHtmlMrFiche,'<td id="'+this.idCroixFermeture+'" class="AvecMain EspaceDroit PetitEspaceGauche" width="1px"',' ie-display="optionsFenetre.avecCroixFermeture"',' ie-event="click->croixFermeture.click"',' ie-event="keyup->croixFermeture.keyup">','<div tabIndex="0" class="Image_CroixFermetureMasque OmbreFocus"></div>','</td>','</tr>','</table>','</td></tr>','<tr><td id="',this.Nom+'_Res"',(this.optionsFenetre.avecPaddingContenu?' class="Fenetre_Espace" ':''),' style="height:100%">','<div id="',this.IdContenu,'" ','style="',this.avecTailleSelonContenu?'':'height:100%; ',(this.optionsFenetre.avecScroll)?'overflow:auto;':'','">',GHtml.nettoyerHtml(this.ComposeContenu()),'</div>','</td></tr>');lHTML.push('<tr id="',this.idLigneBas,'" class="NePasImprimer"',lHtmlBas||lHtmlBoutons?'':' style="display: none;"','><td>','<table style="width:100%" border="0" cellpadding="0" cellspacing="0">','<tr>','<td ie-if="optionsFenetre.avecMessageValidationAuto">'+'<div style="width:200px">'+this.composeValidationAuto()+'</div>'+'</td>','<td width="100%">',lHtmlBas,'</td>','<td id="',this.IdBoutons,'">',lHtmlBoutons,'</td>','</tr>','</table>','</td></tr>');lHTML.push('</table>');lHTML.push('</div>','<span class="wai_hidden" tabindex="0"  onfocus="'+this.Nom+'.FocusSurPremierElement();"></span>');return lHTML.join('');};ObjetFenetre.prototype.composeFenetre=function(){return'';};ObjetFenetre.prototype.setVisibleValidationAuto=function(aVisible){this.setOptionsFenetre({avecMessageValidationAuto:!!aVisible});};ObjetFenetre.prototype.composeValidationAuto=function(){var lHtml=[];lHtml.push('<table class="Texte10" border="0" cellpadding="0" cellspacing="0">','<tr>','<td style="padding-left:10px;">',GImage.composeImage('Image_CommandeValider_MenuContext',20),'</td>','<td class="EspaceGauche">',GTraductions.getValeur('fenetre.SaisieValide'),'</td>','</tr>','</table>');return lHtml.join('');};ObjetFenetre.prototype.ComposeBoutons=function(){var lHTML=[];var I;if(this.ListeBoutons){lHTML.push('<table border="0" cellpadding="0" cellspacing="5">','<tr>');for(I=0;I<this.ListeBoutons.length;I++){if(this.ListeBoutons[I]){lHTML.push('<td>','<ie-bouton id="',this._getIdBoutons(I),'" ',' ie-model="fenetreBtn('+I+')"',' ie-display="getDisplay"',' ie-html="fenetreBtn_getLibelle">','</ie-bouton>','</td>');}}
lHTML.push('</tr>','</table>');}
return lHTML.join('');};ObjetFenetre.prototype.ComposeContenu=function(){return'';};ObjetFenetre.prototype.ComposeBas=function(){return'';};ObjetFenetre.prototype.existeCoordonnees=function(){return((this.coordonnees!==null&&this.coordonnees!==undefined))&&this.coordonnees.left&&this.coordonnees.top ;};ObjetFenetre.prototype.resetCoordonnees=function(){if(!this.coordonnees){this.coordonnees={};}
this.coordonnees.left=null;this.coordonnees.top=null;};ObjetFenetre.prototype.setCoordonnees=function(){this.coordonnees.left=GPosition.getLeft(this.Nom);this.coordonnees.top=GPosition.getTop(this.Nom);if(this.optionsFenetre.callbackDeplacer)
this.optionsFenetre.callbackDeplacer(this,this.coordonnees);};ObjetFenetre.prototype.SetParametres_Fenetre=function(aTitre,aLongueur,aHauteur,aListeBoutons,aModale,aAvecRetaillage,aAvecScroll,aLongueurMinimal,aHauteurMinimal,aAvecMrFiche){this.Titre=aTitre;this._setBoutons(aListeBoutons);this.setOptionsFenetre({modale:aModale!==false,largeur:aLongueur,hauteur:aHauteur,avecRetaillage:(aAvecRetaillage!==null&&aAvecRetaillage!==undefined)?aAvecRetaillage:undefined,largeurMin:MethodesObjet.isNumber(aLongueurMinimal)?aLongueurMinimal:undefined,hauteurMin:MethodesObjet.isNumber(aHauteurMinimal)?aHauteurMinimal:undefined,avecScroll:(aAvecScroll!==null&&aAvecScroll!==undefined)?aAvecScroll:undefined,avecMrFiche:(aAvecMrFiche!==null&&aAvecMrFiche!==undefined)?aAvecMrFiche:undefined});};ObjetFenetre.prototype.SetListeBoutons=function(AListeBoutons){this._setBoutons(AListeBoutons);GHtml.setDisplay(this.idLigneBas,true);GHtml.setHtml(this.IdBoutons ,this.ComposeBoutons(),{controleur:this.controleur});};ObjetFenetre.prototype._setBoutons=function(AListeBoutons){this.ListeBoutons=AListeBoutons;};ObjetFenetre.prototype._getIdBoutons=function(aIndice){return this.Nom+'_btns_'+aIndice;};ObjetFenetre.prototype.SurValidation=function(ANumeroBouton,aFermer){if(aFermer!==false){this.Fermer();}
if(this.optionsFenetre.callback){this.optionsFenetre.callback(ANumeroBouton);}
this.callback.appel(ANumeroBouton);};ObjetFenetre.prototype.positionnerFenetre=function(){if(this.existeCoordonnees()&&GPosition.placer){GPosition.placer(this.Nom,this.coordonnees.left,this.coordonnees.top);}
else{GPosition.centrer(this.Nom,null,true);}};ObjetFenetre.prototype.Afficher=function(aHtml){if(!this.EnAffichage){if(!GHtml.elementExiste(this.Nom)){;return;}
if(this.optionsFenetre.modale){GNavigateur.BloquerInterfaceAvecCompteur(true);this._interfaceEstBloquee=true;}
var lIdZIndex=this.getIdZIndex();if(GNavigateur.abonnementPremierPlan&&(this.optionsFenetre.avecAbonnementPremierPlan||this.optionsFenetre.modale)){GNavigateur.abonnementPremierPlan(lIdZIndex);this.EnPremierPlan();}
if(this.optionsFenetre.avecAbonnementBlocage){GNavigateur.abonnementBlocageInterface(lIdZIndex);}
;GHtml.setDisplay(this.Nom,true);if(this.avecAnimation){GStyle.setTransitions(this.Nom,'opacity','0');if(GStyle.setOpacity)
GStyle.setOpacity(this.Nom,0);}
if(aHtml){GHtml.setHtml(this.IdContenu,aHtml,{controleur:this.controleur});}
this.positionnerFenetre();this.EnAffichage=true;this.surFixerTaille();if(this.SurAfficher) this.SurAfficher();if(this.avecAnimation){GStyle.setTransitions(this.Nom,'opacity','0.5s');$('#'+this.Nom.escapeJQ()).css('opacity',1);}
this.$refreshSelf();}
try{if(!this.optionsFenetre.bloquerFocus){this.FocusSurPremierElement();}}catch(e){}};ObjetFenetre.prototype.Actualiser=function(){this.surFixerTaille();GHtml.setHtml(this.IdContenu,this.ComposeContenu(),{controleur:this.controleur});};ObjetFenetre.prototype.Fermer=function(aParam){var lParam={sansAnimation:false};$.extend(lParam,aParam);if(this.optionsFenetre.avecAbonnementBlocage){GNavigateur.desabonnementBlocageInterface(this.Nom);}
if(this._interfaceEstBloquee){GNavigateur.BloquerInterfaceAvecCompteur(false);delete this._interfaceEstBloquee;}
if(GNavigateur.desabonnementPremierPlan&&(this.optionsFenetre.avecAbonnementPremierPlan||this.optionsFenetre.modale)){GNavigateur.desabonnementPremierPlan(this.getIdZIndex());}
if(this.EstAffiche()){if(this.avecAnimation&&!lParam.sansAnimation){var lBloquant=GHtml.htmlToDOM('<div style="position:absolute; top:0; left:0; right:0; bottom:0;'+(GStyle.composeOpacite?GStyle.composeOpacite(0):'')+'"></div>');GHtml.insererElementDOM(GHtml.getElement(this.Nom),lBloquant);GStyle.setTransitions(this.Nom,'opacity','0.5s');var lThis=this;$('#'+this.Nom.escapeJQ()).queue(function(){$(this).css('opacity',0);$(this).dequeue();}).delay(500).queue(function(){lThis.apresFermer();GHtml.supprimerElementDOM(lBloquant);lBloquant=null;$(this).dequeue();});} else{this.apresFermer();}}};ObjetFenetre.prototype.apresFermer=function(){if(this.SurFermer){this.SurFermer();}
GHtml.setDisplay(this.Nom,false);this.EnAffichage=false;if(this.destructionSurFermeture&&!this.__enCoursDeDestruction){this.__surDestructionApresFermeture_=true;this.free();}};ObjetFenetre.prototype.EstAffiche=function(){return this.EnAffichage===true;};ObjetFenetre.prototype.SetBoutonActif=function(I,AActif){this.optionsFenetre.listeBoutonsInactifs[I]=AActif?false:true;this.$refreshSelf();};ObjetFenetre.prototype.FocusSurAffichage=function(){GHtml.setFocus(this.NomFenetre);};ObjetFenetre.prototype.SetTitre=function(ATitre){this.Titre=ATitre;this.$refreshSelf();};ObjetFenetre.prototype.setTitre=function(aTitre){return this.SetTitre(aTitre);};ObjetFenetre.prototype.setBoutonLibelle=function(I,aLibelle){this.ListeBoutons[I]=aLibelle;this.$refreshSelf();};ObjetFenetre.prototype.setBoutonFocus=function(I,aFocus){GHtml.setFocus(this._getIdBoutons(I),true);};ObjetFenetre.prototype.setBoutonVisible=function(I,aVisible){this.optionsFenetre.listeBoutonsInvisibles[I]=!aVisible;this.$refreshSelf();};ObjetFenetre.prototype.setCroixVisible=function(aVisible){this.setOptionsFenetre({avecCroixFermeture:!!aVisible});};ObjetFenetre.prototype.setLargeurBouton=function(aIndexBouton,aTaille){$('#'+this._getIdBoutons(aIndexBouton).escapeJQ()).css('width',aTaille);};ObjetFenetre.prototype.EnPremierPlan=function(){if(GNavigateur.EnPremierPlan)
GNavigateur.EnPremierPlan(this.getIdZIndex());};ObjetFenetre.prototype.getIdZIndex=function(){if(this._idZIndex){return this._idZIndex;}
if($('#'+this.Nom.escapeJQ()).css('z-index')){this._idZIndex=this.Nom;}
else{;this._idZIndex=1100;}
return this._idZIndex;};ObjetFenetre.prototype.positionnerSousId=function(aId){if(GHtml.elementExiste(aId)){GPosition.placer(this.Nom,GPosition.getLeft(aId)+5,GPosition.getTop(aId)+GPosition.getHeight(aId)+7);this.setCoordonnees();}};ObjetFenetre.prototype.postResizeIE=function(){if(this.EstAffiche()&&GNavigateur.IsIE){GStyle.setVisible(this.Nom,false);GStyle.setVisible(this.Nom,true);}};ObjetFenetre.prototype.preResizePositionnement=function(){if(!this.EstAffiche()){return;}
this._tempResize={left:GPosition.getLeft(this.Nom),top:GPosition.getTop(this.Nom)};GHtml.setDisplay(this.Nom,false);};ObjetFenetre.prototype.postResizePositionnement=function(){if(!this.EstAffiche()||!this._tempResize){return;}
GPosition.placer(this.Nom,0,0);GHtml.setDisplay(this.Nom,true);GPosition.placer(this.Nom,this._tempResize.left,this._tempResize.top);this.setCoordonnees();delete this._tempResize;};ObjetFenetre.prototype.surFixerTaille=function(){if(this.optionsFenetre.hauteur){var lDiv=$('#'+this.IdContenu.escapeJQ());var lElement=GHtml.getElement(this.Nom+'_Res');var lTable=GHtml.getElement(this.idFenetreContenu);$(lElement).height(1);lDiv.css('height','0px');if(this.optionsFenetre.hauteurMin>0){lTable.style.minHeight='0px';}
$(lTable).height(1);var lHeightTable=$(lTable).outerHeight();var lHeight=this.optionsFenetre.hauteur-lHeightTable+$(lElement).height();$(lElement).height(lHeight);$(lTable).height(this.optionsFenetre.hauteur);if(this.optionsFenetre.hauteurMin>0){lTable.style.minHeight=this.optionsFenetre.hauteurMin+'px';}
if(this.avecTailleSelonContenu)
lDiv.css('height','auto');else{if(IE.Support.div100PourcentDansTDGardeHauteurTD){lDiv.css('height','auto');if($(lDiv).height()<=lHeight){lDiv.css('height','100%');}}
else lDiv.css('height','100%');}}};function _enleverEventsRetaillage(){$(document).off('ieup.ObjetFenetre iemove.ObjetFenetre');}
function _mouseMoveRetaillage(event){var lData=event.data,lInstance=lData.instance;if(!lData.actif){lInstance.debutRetaillage();lData.actif=true;}
var lDeplacementX;var lDeplacementY;if(lData.droit){lDeplacementX=Math.borner(event.pageX-event.data.OriginX,lInstance.optionsFenetre.largeurMin-event.data.OriginLargeur,GNavigateur.EcranL-10-event.data.OriginLargeur-GPosition.getLeft(lInstance.idFenetreContenu));lInstance.optionsFenetre.largeur=lData.OriginLargeur+lDeplacementX;GPosition.setWidth(lInstance.IdContenu,lData.largeur+lDeplacementX);}
if(lData.gauche){lDeplacementX=Math.borner(event.pageX-event.data.OriginX,-lData.Originleft,event.data.OriginLargeur-lInstance.optionsFenetre.largeurMin);lInstance.optionsFenetre.largeur=lData.OriginLargeur-lDeplacementX;GPosition.setWidth(lInstance.IdContenu,lData.largeur-lDeplacementX);}
if(lData.bas){lDeplacementY=Math.borner(event.pageY-event.data.OriginY,lInstance.optionsFenetre.hauteurMin-event.data.OriginHauteur,GNavigateur.EcranH-10-event.data.OriginHauteur-GPosition.getTop(lInstance.idFenetreContenu));lInstance.optionsFenetre.hauteur=lData.OriginHauteur+lDeplacementY;GPosition.setHeight(lInstance.IdContenu,lData.hauteur+lDeplacementY);}
if(lData.haut){lDeplacementY=Math.borner(event.pageY-event.data.OriginY,-lData.OriginTop,event.data.OriginHauteur-lInstance.optionsFenetre.hauteurMin);lInstance.optionsFenetre.hauteur=lData.OriginHauteur-lDeplacementY;GPosition.setHeight(lInstance.IdContenu,lData.hauteur-lDeplacementY);}
if(lInstance.surFixerTaille){lInstance.surFixerTaille();}
if(lData.droit)
GPosition.setWidth(lInstance.idFenetreContenu,lData.OriginLargeur+lDeplacementX,true);if(lData.gauche){lInstance.coordonnees.left=lData.Originleft+lDeplacementX;GPosition.setLeft(lInstance.Nom,lInstance.coordonnees.left);GPosition.setWidth(lInstance.idFenetreContenu,lData.OriginLargeur-lDeplacementX,true);}
if(lData.bas)
GPosition.setHeight(lInstance.idFenetreContenu,lData.OriginHauteur+lDeplacementY,true);if(lData.haut){lInstance.coordonnees.top=lData.OriginTop+lDeplacementY;GPosition.setTop(lInstance.Nom,lInstance.coordonnees.top);GPosition.setHeight(lInstance.idFenetreContenu,lData.OriginHauteur-lDeplacementY,true);}}
ObjetFenetre.prototype.debutRetaillage=function(){this.surFixerTaille();GStyle.setTransitions(this.Nom,'opacity','0.2s');$('#'+this.Nom.escapeJQ()).css('opacity',0.5);GPosition.setHeight(this.IdContenu,GPosition.getHeight(this.Nom+'_Res')-10);GPosition.setWidth(this.IdContenu,GPosition.getWidth(this.Nom+'_Res')-10);};ObjetFenetre.prototype.finRetaillage=function(){$('#'+this.Nom.escapeJQ()).css('opacity',1);this.surFixerTaille();};function _mouseUpRetaillage(event){var lInstance=event.data.instance;if(event.data.divBloquant){GHtml.supprimerElementDOM(event.data.divBloquant);}
_enleverEventsRetaillage();if(event.data.actif)
lInstance.finRetaillage();return false;}
function _surMouseDownRetaillage(event){var lInstance=event.data.instance;var lBloquant=null;if(IE.Support.avecSupportOpacity){var lClassCurseur=event.data.bas&&event.data.droit?'AvecResize':event.data.droit||event.data.gauche?'AvecResizeHorizontal':'AvecResizeVertical';lBloquant=GHtml.htmlToDOM('<div style="position:absolute; top:0; left:0; right:0; bottom:0;'+GStyle.composeOpacite(0)+'" class="'+lClassCurseur+'"></div>');GHtml.insererElementDOM(GHtml.getElement(lInstance.Nom),lBloquant);}
var lData={instance:lInstance,OriginX:event.pageX,OriginY:event.pageY,OriginLargeur:GPosition.getWidth(lInstance.idFenetreContenu),OriginHauteur:GPosition.getHeight(lInstance.idFenetreContenu),Originleft:GPosition.getLeft(lInstance.Nom),OriginTop:GPosition.getTop(lInstance.Nom),largeur:GPosition.getWidth(lInstance.IdContenu),hauteur:GPosition.getHeight(lInstance.IdContenu),divBloquant:lBloquant,actif:false};$.extend(lData,event.data);$(document).on({'ieup.ObjetFenetre':_mouseUpRetaillage,'iemove.ObjetFenetre':_mouseMoveRetaillage},lData);return false;}
ObjetFenetre.creerInstance=function(aClassFenetre,aParametres,aOptionsFenetre){if(!aParametres||!aParametres.pere){;return;}
var lInstance=Identite.creerInstance(aClassFenetre,aParametres);var lParametres=$.extend({initialiser:true},aParametres);lInstance.destructionSurFermeture=true;IE.ZoneFenetre.ajouterFenetre(lParametres.nomComplet,lInstance.getZIndex?lInstance.getZIndex():'');if(aOptionsFenetre){lInstance.setOptionsFenetre(aOptionsFenetre);}
if(lParametres.initialiser)
lInstance.Initialiser();return lInstance;};}());;
var EGenreSaisie={Zone:1,Liste:2,ZoneEtListe:3,Combo:4};;
var EGenreBoutonCellule={Aucun:0,Fleche:1,Loupe:2,Points:3};MethodesObjet.heritagePrototype(ObjetCelluleBouton,Identite);function ObjetCelluleBouton(ANom,AIdent,APere,AEvenement){this.inheritedCreate(ANom,AIdent,APere,AEvenement);this.idZone=this.Nom+'_Zone';this.NomEdit=this.Nom+'_Edit';this.NomDescr=this.Nom+'_Descr';this.idTexte=this.NomEdit;this.idBouton=this.Nom+'_Bouton';this.libelle='';this._options={hauteur:18,largeur:80,largeurBouton:null,genreBouton:EGenreBoutonCellule.Aucun,avecBordures:true,couleurFondSurvol:null,avecCouleurFondBouton:true,avecFocusVisibleTexte:true,avecZoneSaisie:true,estSaisissable:false,taillePolice:10,classTexte:'',classBackground:'',styleZoneTexte:'',styleBouton:'',placeHolder:'',avecTextOverflowEllipsis:false,withTabulation:true,roleWAIZone:'',labelWAIEdit:'',desactiverAideSaisie:false,titleForce:''};this.setParametres(true,EGenreBoutonCellule.Fleche,true,null,null);this.IdPremierElement=this.NomEdit;}
ObjetCelluleBouton.prototype.getControleur=function(){return{surZoneMouseenterMouseleave:function(aEvent){if(!this.instance.Actif) return;this.instance._enSurvol=aEvent.type==='mouseenter';this.controleur.$refreshSelf();},getClassZone:function(){return'Texte'+this.instance._options.taillePolice+' FondBlanc CelluleBoutonZoneJQ'+(this.instance.Actif?' AvecMain':'');},getStyleZone:function(){return{'background-color':this.instance.Actif&&this.instance._options.couleurFondSurvol?this.instance._enSurvol?this.instance._options.couleurFondSurvol:'':'','width':(this.instance._options.largeur&&this.instance._options.largeur!=='100%'?this.instance._options.largeur+'px':'')};},getTitleDescriptionEdit:function(){return!this.instance._options.titleForce?this.instance.estLibelleHTML?'':(this.instance.libelle&&GChaine.GetLongueurChaineDansDiv(this.instance.libelle,this.instance._options.taillePolice,false)>=this.instance._getLargeurTexte())?GChaine.enleverEntites(this.instance.libelle):'':this.instance._options.titleForce;},edit:{getValue:function(){return this.instance.libelle;},setValue:function(aValue){this.instance.libelle=aValue;},getDisabled:function(){return!this.instance.Actif;},surEventEdit:function(aEvent){if(!this.instance.Actif) return;var lEvent=null;switch(aEvent.type){case'keyup':lEvent=EEvent.SurKeyUp;break;case'blur':lEvent=EEvent.SurBlur;break;case'mousedown':lEvent=EEvent.SurMouseDown;break;case'click':lEvent=EEvent.SurClick;break;}
if(lEvent){this.instance.callback.appel(lEvent,aEvent,true);if(this.Pere&&this.Pere.$refreshSelf) this.Pere.$refreshSelf();}},getClassEdit:function(){return'CelluleBoutonNomEditJQ Texte'+this.instance._options.taillePolice+' '+
this.instance._options.classTexte+(this.instance.Actif?(this.instance._options.estSaisissable?' AvecTexte':' AvecMain'):'')+' '+
this.instance._options.classBackground;},getStylePourBoutonNonEditable:function(){return{'background-color':this.instance.Actif?'':GCouleur.nonEditable.fond};}},getHtmlConsult:function(){return this.instance.libelle||!this.instance._options.placeHolder?GChaine.AvecEspaceSiVide(this.instance.estLibelleHTML?this.instance.libelle:GChaine.Insecable(this.instance.libelle)):'<span style="color:'+GCouleur.grisTresFonce+'">'+this.instance._options.placeHolder||''+'</span>';},htmlBouton:function(){switch(this.instance._options.genreBouton){case EGenreBoutonCellule.Aucun:return'';case EGenreBoutonCellule.Fleche:return'<img src="images/fle_bas.gif" alt=""></img>';case EGenreBoutonCellule.Loupe:return GImage.compose('Image_Loupe');case EGenreBoutonCellule.Points:return'<span class="PetitEspaceGauche PetitEspaceDroit Gras" ie-style="styleBoutonPoints">'+'...'+'</span>';}
return'';},getStyleBouton:function(){return{'background-color':this.instance._options.avecCouleurFondBouton?this.instance.Actif?this.instance._enSurvol?GCouleur.themeNeutre.moyen2:GCouleur.blanc:GCouleur.nonEditable.fond:''};},getClassBouton:function(){return'AlignementMilieu'+(this.instance.Actif?' AvecMain':'');},surEventBouton:function(aEvent){if(!this.instance.Actif) return;var lEvent=null;switch(aEvent.type){case'mousedown':lEvent=EEvent.SurMouseDown;break;case'click':lEvent=EEvent.SurClick;break;case'keyup':lEvent=EEvent.SurKeyUp;break;}
if(lEvent!==null){this.instance.callback.appel(lEvent,aEvent,false);if(this.Pere&&this.Pere.$refreshSelf) this.Pere.$refreshSelf();}},styleBoutonPoints:function(){return{color:this.instance.Actif?GCouleur.noir:GCouleur.themeNeutre.moyen2};}};};ObjetCelluleBouton.prototype.setParametresSaisie=function(aAvecZoneSaisie,aEstSaisissable){this.setOptions_ObjetCelluleBouton({avecZoneSaisie:!!aAvecZoneSaisie,estSaisissable:!!aEstSaisissable});};ObjetCelluleBouton.prototype.setWithTabulation=function(aValeur){this.setOptions_ObjetCelluleBouton({withTabulation:aValeur});GHtml.setTabIndex(this.idTexte,aValeur?0:-1);};ObjetCelluleBouton.prototype.setParametres=function(aEstSaisissable,aGenreBouton,aAvecStyleSite,aLargeur,aHauteur,aLabelFor,aTexteEdit,aClassTexte,aClassBackground,aPlaceHolder,aDesactiverAideSaisie){this.setOptions_ObjetCelluleBouton({estSaisissable:aEstSaisissable,hauteur:aHauteur||undefined,largeur:aLargeur||undefined,genreBouton:aGenreBouton===null||aGenreBouton===undefined?EGenreBoutonCellule.Aucun:aGenreBouton,labelWAIZone:aLabelFor||undefined,classTexte:aClassTexte||'',classBackground:aClassBackground||'',placeHolder:aPlaceHolder||'',desactiverAideSaisie:aDesactiverAideSaisie||false});};ObjetCelluleBouton.prototype.setParametres_PN=function(aAvecBouton,aAvecStyleSite,aLargeur,aHauteur,aClassTexte){this.setOptions_ObjetCelluleBouton({genreBouton:aAvecBouton?EGenreBoutonCellule.Fleche:EGenreBoutonCellule.Aucun,largeur:aLargeur,hauteur:aHauteur?aHauteur:15,classTexte:aClassTexte?aClassTexte:'Gras',estSaisissable:false,avecZoneSaisie:false});};ObjetCelluleBouton.prototype.setOptions_ObjetCelluleBouton=function(aOptions){$.extend(this._options,aOptions);this.avecBouton=this._options.genreBouton!==EGenreBoutonCellule.Aucun;this.$refreshSelf();};ObjetCelluleBouton.prototype.SetInformationWAI=function(aGenreRoleWAI,aLabelFor){;this._options.roleWAIZone=aGenreRoleWAI===null||aGenreRoleWAI===undefined?'':aGenreRoleWAI;this._options.labelWAIZone=aLabelFor===null||aLabelFor===undefined?'':aLabelFor;};ObjetCelluleBouton.prototype.ConstruireAffichage=function(){this.largeurBouton=this._options.largeurBouton?this._options.largeurBouton:this._options.hauteur+(this._options.avecZoneSaisie?-1:0);var H=[];H.push('<div id="'+this.idZone+'" tabindex="-1" ',' ie-event="mouseenter-mouseleave->surZoneMouseenterMouseleave" ',' ie-style="getStyleZone" ',' ie-class="getClassZone" ',' style="'+GStyle.composeCouleurTexte(GCouleur.noir)+' '+(this._options.avecBordures?GStyle.composeCouleurBordure(GCouleur.themeNeutre.claire):'')+(this._options.couleurFondSurvol?GStyle.composeTransitions('background-color','0.25s'):''),';line-height:100%;" ','>');H.push('<table class="Texte'+this._options.taillePolice,'" style="width:100%; border-collapse:separate;" border="0" cellspacing="0" cellpadding="0"><tr>');if(this._options.avecZoneSaisie){H.push('<td style="padding:1px;',GStyle.composeHeight(this._options.hauteur-2),'" ie-event="mousedown-click->edit.surEventEdit">','<div ie-title="getTitleDescriptionEdit">','<input type="text" ie-model="edit"',' id="'+this.NomEdit+'"',this._options.desactiverAideSaisie?'autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"':'',' ie-event="keyup-blur->surEventEdit"',' ie-class="getClassEdit"',' style="',GStyle.composeWidth(this._getLargeurTexte()),' border:0px; margin:0px;',(this._options.classBackground?'':' padding-left: 3px; padding-right: 3px; '),GStyle.composeHeight(this._options.hauteur+(GNavigateur.IsIE?-2:0)-2),this._options.styleZoneTexte||'','" ',(!this._options.estSaisissable?'readonly  aria-readonly="true" ':''),(this._options.estSaisissable?'':'onfocus="GHtml.setFocus (this, false);" '),(this._options.roleWAIZone?GObjetWAI.composeRole(this._options.roleWAIZone)+' ':''),(this._options.labelWAIEdit?GObjetWAI.composeAttribut({genre:EGenreAttribut.label,valeur:this._options.labelWAIEdit})+' ':''),(this._options.roleWAIZone?GObjetWAI.composeAttribut({genre:EGenreAttribut.describedby,valeur:GObjetWAI.idInfoWai[EGenreObjet.NavigationVerticalAvecValidation]})+' '+
GObjetWAI.composeAttribut({genre:EGenreAttribut.live,valeur:'polite'}):''),' placeholder="',this._options.placeHolder||'' ,'" />','</div>','</td>');}
else{H.push('<td class="AlignementGauche" style="'+GStyle.composeHeight(this._options.hauteur)+GStyle.composeTransitions('background-color','0.2s'),'" ie-event="mousedown-click->edit.surEventEdit" ',' ie-style="edit.getStylePourBoutonNonEditable">','<div class="PetitEspaceGauche PetitEspaceDroit ',this._options.classBackground,'" style="overflow:hidden;height:100%;',this._options.styleZoneTexte||'','">','<div class="InlineBlock" style="height:100%;vertical-align:middle;"></div>','<div',(this._options.withTabulation?' tabIndex="0"':''),' id="',this.idTexte,'"',' ie-html="getHtmlConsult" ',' ie-title="getTitleDescriptionEdit"',' ie-event="keyup-blur->edit.surEventEdit"',' style="'+GStyle.composeWidth(this._getLargeurTexte()),'vertical-align:middle;',(this._options.avecTextOverflowEllipsis?'text-overflow:ellipsis; overflow:hidden;':''),'" ','class="InlineBlock CelluleBoutonNomEditJQ Insecable ',this._options.classTexte,'" ',(this._options.roleWAIZone?GObjetWAI.composeRole(this._options.roleWAIZone)+' ':''),(this._options.labelWAIEdit?GObjetWAI.composeAttribut({genre:EGenreAttribut.label,valeur:this._options.labelWAIEdit})+' ':''),(this._options.roleWAIZone?GObjetWAI.composeAttribut({genre:EGenreAttribut.describedby,valeur:GObjetWAI.idInfoWai[EGenreObjet.NavigationVerticalAvecValidation]})+' '+
GObjetWAI.composeAttribut({genre:EGenreAttribut.live,valeur:'polite'})+' ':''),(this._options.owns?GObjetWAI.composeAttribut({genre:EGenreAttribut.owns,valeur:this._options.owns})+' ':''),'>','</div>','</div>','</td>');}
H.push('<td id="'+this.idBouton+'"',' ie-if="avecBouton"',' ie-event="mousedown-click-keyup->surEventBouton"',' ie-html="htmlBouton"',' ie-class="getClassBouton"',' ie-style="getStyleBouton"',' style="',GStyle.composeHeight(this._options.hauteur)+
GStyle.composeWidth(this.largeurBouton),this._options.avecCouleurFondBouton?GStyle.composeTransitions('background-color','0.2s'):'',this._options.avecBordures?GStyle.composeCouleurBordure(GCouleur.themeNeutre.claire,1,EGenreBordure.gauche):'',this._options.styleBouton||'',(this.avecBouton?'':'display:none;'),'" '+'>');H.push('</td>');H.push('</tr>','</table>','</div>');return H.join('');};ObjetCelluleBouton.prototype.RecupererDonnees=function(){if(!GHtml.elementExiste(this.idZone)) return;var lEventMap={};if(this._options.avecFocusVisibleTexte){lEventMap={'focusin':function(event){$(this).find('.CelluleBoutonNomEditJQ').css('outline',GCouleur.texte+' dotted 1px');},'focusout':function(event){$(this).find('.CelluleBoutonNomEditJQ').css('outline','none');}};}
$('#'+this.Nom.escapeJQ()).on(lEventMap,{instance:this}).addClass('OmbreFocus').data('couleurFocus',GCouleur.texte);};ObjetCelluleBouton.prototype.SetActif=function(AActif){this.inherited('SetActif',AActif);this.$refreshSelf();};ObjetCelluleBouton.prototype.setLibelle=function(aLibelle){this.libelle=aLibelle;this.estLibelleHTML=false;this.$refreshSelf();};ObjetCelluleBouton.prototype.setLibelleHtml=function(aLibelleHtml){if(this._options.avecZoneSaisie) return;this.estLibelleHTML=true;this.libelle=aLibelleHtml;this.$refreshSelf();};ObjetCelluleBouton.prototype.getLibelle=function(){return this.libelle;};ObjetCelluleBouton.prototype.setLargeur=function(aLargeur){this.setOptions_ObjetCelluleBouton({largeur:aLargeur?aLargeur:undefined});};ObjetCelluleBouton.prototype.setTitle=function(aTitle){this.setOptions_ObjetCelluleBouton({titleForce:aTitle});};ObjetCelluleBouton.prototype.setFocus=function(){GHtml.setFocus(this.NomEdit);};ObjetCelluleBouton.prototype.setAvecBouton=function(aAvecBouton){if(this.avecBouton===aAvecBouton) return;this.avecBouton=aAvecBouton;GPosition.setWidth(this.NomEdit,this._getLargeurTexte());this.$refreshSelf();};ObjetCelluleBouton.prototype._getLargeurTexte=function(){if(this._options.largeur==='100%'){return'100%';} else{return this._options.largeur-6-(this.avecBouton?this.largeurBouton+(this._options.avecBordures?1:0):0);}};;
var EGenreEvenementObjetSaisie={selection:0,deploiement:1,fermeture:2};MethodesObjet.heritagePrototype(ObjetSaisie,Identite);function ObjetSaisie(ANom,AIdent,APere,AEvenement){this.inheritedCreate(ANom,AIdent,APere,AEvenement);this.NomListe=this.Nom+'_Liste';this.idContenu=this.Nom+'_Contenu';this.NomLabel=this.Nom+'_Label';this.withTabulation=true;this.Survolee= -1;this.Selection= -1;this.largeurBouton=25;this.Timer=null;this.init();}(function(){var lClasseJQ=window.GUID.getClassCss(),c_decalageTopOuvertureInverse=3;ObjetSaisie.prototype.init=function(){_initParseur.bind(this)();this.bouton=new ObjetCelluleBouton(this.Nom+'.bouton',null,this,_surEvenementBouton.bind(this));this.IdPremierElement=this.bouton.NomEdit;this.initialiserOptions_ObjetSaisie();};ObjetSaisie.prototype.DetruireInstances=function(){$('#'+this.idContenu.escapeJQ()).stop(true,true);clearTimeout(this._timerInitParseur);};ObjetSaisie.prototype.initialiserOptions_ObjetSaisie=function(){this._options={mode:EGenreSaisie.Combo,longueur:125,hauteur:null,largeurListe:null,avecBouton:true,couleur:GCouleur,controlerNbrElements:false,accepterUnElement:false,avecGestionUnElement:true,avecTriListeElements:false,nbrLignes:25,classTexte:null,classBackground:null,placeHolder:'',desactiverAideSaisie:false,classTexteReference:'Texte10',couleurFondDeroulant:null,celluleAvecTexteHtml:false,texteEdit:'',couleurTexteEdit:null,styleTexteEdit:null,classTexteEdit:null,largeurTexteEdit:null,avecEventSurFermetureListe:false,avecFondSelectionSurSurvol:true,avecGrasSurSurvol:false,modifierContenuCelluleSurSelection:true,avecReservationPlaceBarreScroll:true,avecTextOverflowEllipsis:false,labelWAIZone:'',roleWAIZone:'',labelWAIEdit:'',roleWAIEdit:'',labelWAIList:GObjetWAI.getInfo(EGenreObjet.NavigationVertical),roleWAIList:EGenreRole.Listbox,avecBoutonsPrecSuiv:false,avecBoutonsPrecSuivVisiblesInactifs:true,optionsBouton:{}};};ObjetSaisie.prototype.setOptions_ObjetSaisie=function(aOptions){$.extend(this._options,aOptions);this._options.couleur=GCouleur;var lEstListeOuCombo=MethodesTableau.existe(this._options.mode,[EGenreSaisie.Liste,EGenreSaisie.Combo]);var lOptionsBouton=$.extend({estSaisissable:!lEstListeOuCombo,avecZoneSaisie:!lEstListeOuCombo,genreBouton:this._options.avecBouton?lEstListeOuCombo?EGenreBoutonCellule.Fleche:EGenreBoutonCellule.Loupe:EGenreBoutonCellule.Aucun,largeur:$.isNumeric(this._options.longueur)?this._options.longueur+this.largeurBouton:this._options.longueur,hauteur:this._options.hauteur||undefined,classTexte:this._options.classTexte,classBackground:this._options.classBackground,placeHolder:this._options.placeHolder,desactiverAideSaisie:this._options.desactiverAideSaisie,roleWAIZone:this._options.roleWAIZone||undefined,roleWAIEdit:this._options.roleWAIEdit||undefined,labelWAIZone:this._options.labelWAIZone||undefined,avecTextOverflowEllipsis:this._options.avecTextOverflowEllipsis},aOptions.optionsBouton);this.bouton.setOptions_ObjetCelluleBouton(lOptionsBouton);};function _chercherIndiceSelectionSelonSens(aIndice,aPrecedent){if(!this.ListeElements||!this.ListeElements.GetNbrElements)
return-1;var lIndice=aIndice,lNbr=this.ListeElements.GetNbrElements();if(lIndice!==null&&lIndice!==undefined){while(lIndice<lNbr&&lIndice>=0&&(this.ListeElements.GetElement(lIndice).AvecSelection===false)){lIndice+=aPrecedent?-1:1;}}
else lIndice= -1;if(lIndice>=lNbr)
lIndice= -1;return lIndice;}
function _boutonPrecSuivOK(aPrecedent){var lListe=this.ListeElements;if(!lListe||!lListe.GetElement)
return false;var lElement=lListe.GetElement(this.Selection);if(!lElement)
return false;if(aPrecedent&&lListe.GetElement(_chercherIndiceSelectionSelonSens.call(this,this.Selection-1,true)))
return true;if(!aPrecedent&&lListe.GetElement(_chercherIndiceSelectionSelonSens.call(this,this.Selection+1,false)))
return true;return false;}
ObjetSaisie.prototype.getControleur=function(){return{getTitleHtml:function(aChaine){return aChaine;},btnSuivPrec:{event:function(aPrecedent){var lIndice=this.instance.Selection,lListe=this.instance.ListeElements;if(IE.MethodesObjet.isNumber(lIndice)&&lListe&&lListe.GetElement){if(aPrecedent&&lListe.GetElement(lIndice-1))
lIndice=_chercherIndiceSelectionSelonSens.call(this.instance,lIndice-1,true);else if(!aPrecedent&&lListe.GetElement(this.instance.Selection+1))
lIndice=_chercherIndiceSelectionSelonSens.call(this.instance,lIndice+1,false);if(lIndice>=0)
this.instance.SurValidation(true,lIndice);}},getDisabled:function(aPrecedent){return!_boutonPrecSuivOK.call(this.instance,aPrecedent);},getStyle:function(aPrecedent){if(this.instance._options.avecBoutonsPrecSuivVisiblesInactifs)
return;return{visibility:_boutonPrecSuivOK.call(this.instance,aPrecedent)?'':'hidden'};}}};};ObjetSaisie.prototype.SetParametres=function(AMode,ALongueur,AAvecBouton,aAvecStyleSite,aControlerNbrElements,aHauteur,aClassTexte){this.setOptions_ObjetSaisie({mode:AMode,longueur:ALongueur===null||ALongueur===undefined?undefined:ALongueur,hauteur:aHauteur,avecBouton:AAvecBouton===null||AAvecBouton===undefined?undefined:AAvecBouton,controlerNbrElements:aControlerNbrElements,classTexte:aClassTexte});};ObjetSaisie.prototype.SetTraductions=function(ATexteEdit,aCouleurTexteEdit,aClassTexteEdit,aLargeurTexteEdit){;this.setOptions_ObjetSaisie({texteEdit:ATexteEdit?ATexteEdit:'',couleurTexteEdit:aCouleurTexteEdit?aCouleurTexteEdit:undefined,classTexteEdit:aClassTexteEdit?aClassTexteEdit:undefined,largeurTexteEdit:aLargeurTexteEdit?aLargeurTexteEdit:undefined});};ObjetSaisie.prototype.setLabel=function(aTexte,aClass,aStyle){this._options.texteEdit=aTexte;$.extend(this._options,{classTexteEdit:aClass?aClass:undefined,styleTexteEdit:aStyle?aStyle:undefined});var lElementLabel=GHtml.getElement(this.NomLabel);if(GHtml.estElement(lElementLabel)){GHtml.setHtml(lElementLabel,GChaine.Insecable(this._options.texteEdit)+'&nbsp;');if(this._options.classTexteEdit)
GHtml.setClass(lElementLabel,this._options.classTexteReference+' '+this._options.classTexteEdit);if(this._options.styleTexteEdit)
GStyle.setStyle(lElementLabel,this._options.styleTexteEdit);}};ObjetSaisie.prototype.SetInformationWAI=function(ALabelFor){;this.setOptions_ObjetSaisie({labelWAIZone:ALabelFor===null||ALabelFor===undefined?'':ALabelFor});};ObjetSaisie.prototype.setNbrLignes=function(aNbrLignes){this.setOptions_ObjetSaisie({nbrLignes:aNbrLignes?aNbrLignes:(this.ListeElements?this.ListeElements.GetNbrElements():undefined)});};ObjetSaisie.prototype.setWithTabulation=function(aValeur){this.withTabulation=aValeur;this.bouton.setWithTabulation(aValeur);};ObjetSaisie.prototype.RecupererDonnees=function(){this.bouton.Initialiser();};function _getLargeurListe(){return this._options.largeurListe?this._options.largeurListe:$.isNumeric(this._options.longueur)?this._options.longueur+this.largeurBouton:$('#'+this.bouton.GetNom().escapeJQ()).width()-2 ;}
ObjetSaisie.prototype.ConstruireAffichage=function(){$('#'+this.idContenu.escapeJQ()).stop(true,true);var H='';H+='<table '+GObjetWAI.composeRole(EGenreRole.Presentation)+' class="Maigre" style="'+GStyle.composeCouleurTexte(GCouleur.noir)+(this._options.longueur==='100%'?'width:100%;':'')+'" border="0" cellspacing="0" cellpadding="0">';H+='<tr>';var LFor=(this._options.labelWAIZone||MethodesTableau.existe(this._options.mode,[EGenreSaisie.Liste,EGenreSaisie.Combo]))?'':'for="'+this.bouton.NomEdit+'"';if(this._options.texteEdit){H+='<td>';if(this._options.largeurTexteEdit)
H+='<div style="'+GStyle.composeWidth(this._options.largeurTexteEdit)+'">';var lStyleTextEdit=this._options.couleurTexteEdit?'style="'+GStyle.composeCouleurTexte(this._options.couleurTexteEdit)+'"':this._options.styleTexteEdit?'style="'+this._options.styleTexteEdit+'"':'';H+='<label id="'+this.NomLabel+'" class="'+this._options.classTexteReference+' '+((this._options.classTexteEdit!==null&&this._options.classTexteEdit!==undefined)?this._options.classTexteEdit:' Gras')+'" '+LFor+' '+lStyleTextEdit+'>'+GChaine.Insecable(this._options.texteEdit)+'&nbsp;</label>';if(this._options.largeurTexteEdit)
H+='</div>';H+='</td>';}
if(this._options.avecBoutonsPrecSuiv){H+='<td>';H+='<ie-btnimage class="Image_PassageAuPrecedentPourBandeau" ie-model="btnSuivPrec(true)" ie-style="getStyle" title="'+GChaine.toTitle(GTraductions.getValeur('Precedent'))+'"></ie-btnImage>';H+='</td>';}
H+='<td>';H+='<div style="position:relative;">';H+='<div id="'+this.bouton.GetNom()+'" style="border: 1px solid height:auto; width:auto;"></div>';H+='<div '+GObjetWAI.composeRole(this._options.roleWAIList)+' '+GObjetWAI.composeAttribut({genre:EGenreAttribut.label,valeur:this._options.labelWAIList})+' id="'+this.NomListe+'"'+' class="Ombre_MenuDeroulant" tabIndex="-1"'+' style="position:absolute;display:none; width:'+(_getLargeurListe.bind(this)())+'px;"></div>';H+='</div>';H+='</td>';if(this._options.avecBoutonsPrecSuiv){H+='<td>';H+='<ie-btnimage class="Image_PassageAuSuivantPourBandeau" ie-model="btnSuivPrec(false)" ie-style="getStyle" title="'+GChaine.toTitle(GTraductions.getValeur('Suivant'))+'"></ie-btnImage>';H+='</td>';}
H+='</tr>';H+='</table>';return H;};function _surEvenementBouton(aGenreEvent,aEvent,aEvenementSurEdit){switch(aGenreEvent){case EEvent.SurMouseDown:if(aEvenementSurEdit){if(MethodesTableau.existe(this._options.mode,[EGenreSaisie.Liste,EGenreSaisie.Combo]))
this.SurSelection();}
else this.SurSelection();break;case EEvent.SurKeyDown:GNavigateur.SetCodeTouche(aEvent);if(MethodesTableau.existe(this._options.mode,[EGenreSaisie.Liste,EGenreSaisie.Combo])&&(GNavigateur.IsToucheFlecheBas()||GNavigateur.IsToucheFlecheHaut())){this.SurSelection();}
break;case EEvent.SurKeyUp:GNavigateur.SetCodeTouche(aEvent);if(MethodesTableau.existe(this._options.mode,[EGenreSaisie.Liste,EGenreSaisie.Combo])){if(GNavigateur.IsToucheRetourChariot()){this.SurSelection();}}
else{_defiler.bind(this)();if(GNavigateur.IsToucheRetourChariot())
this.SurSelection();}
break;case EEvent.SurBlur:if(this._options.mode===EGenreSaisie.Zone)
this.SurValidation(false,-1);else if(this._options.mode===EGenreSaisie.Combo)
if(!this.listeDeroulee&&GNavigateur.IsToucheFlecheBas()){this.SurSelection();}
break;}}
ObjetSaisie.prototype.SurSelection=function(){if((MethodesTableau.existe(this._options.mode,[EGenreSaisie.Liste,EGenreSaisie.Combo]))&&this.ListeElements&&this.ListeElements.GetNbrElements()&&!this.ActualiserListe)
this.DeroulerListe();else this.SurValidation(false);};ObjetSaisie.prototype.SurValidation=function(aInteractionUtilisateur,ASelection){this.InteractionUtilisateur=aInteractionUtilisateur;if((this.ListeElements===null)||this.ListeElements===undefined||!this.ListeElements.GetElement(ASelection)||(this.ListeElements.GetElement(ASelection).AvecSelection!==false)){this.FermerListe(true);this.Selection=ASelection;this.$refreshSelf();var LValeur;if(ASelection>=0){var lElement=this.ListeElements.GetElement(this.Selection);LValeur=lElement?lElement.GetLibelle():'';if(this._options.modifierContenuCelluleSurSelection){if(this._options.celluleAvecTexteHtml&&lElement&&lElement.libelleHtml)
this.bouton.setLibelleHtml(lElement.libelleHtml);else this.SetContenu(LValeur);}} else{LValeur=MethodesTableau.existe(this._options.mode,[EGenreSaisie.Liste,EGenreSaisie.Combo])?'*':this.GetContenu();}
if((ASelection>=0)&&this.ControleNavigation&&IE.controleSaisieSurEvenement)
IE.controleSaisieSurEvenement(_retourSurNavigation.bind(this,LValeur,true));else _retourSurNavigation.bind(this)(LValeur,false);}};function _retourSurNavigation(aValeur,aRetourSaisieAnnule){if(aRetourSaisieAnnule)
this.SetEtatSaisie(false);var lSurSetDonnes=this._surSetDonnnes;delete this._surSetDonnnes;this.callback.appel(EGenreEvenementObjetSaisie.selection,this.Selection>=0?this.ListeElements.GetElement(this.Selection):null,Math.max(this.Selection||0,0),this.Genre,aValeur,lSurSetDonnes);if(this.Pere&&this.Pere.$refreshSelf)
this.Pere.$refreshSelf();}
function _defilerFleches(){if(this.listeDeroulee){if(GNavigateur.IsToucheFlecheBas()&&(_chercherSuivantSelectionnable.bind(this)(this.Survolee,true)<this.ListeElements.GetNbrElements())){this.SurLigne(_chercherSuivantSelectionnable.bind(this)(this.Survolee,true));return true;}
if(GNavigateur.IsToucheFlecheHaut()){if(_chercherSuivantSelectionnable.bind(this)(this.Survolee,false)> -1){this.SurLigne(_chercherSuivantSelectionnable.bind(this)(this.Survolee,false));}
else{this.FermerListe(true);}
return true;}}
return false;}
function _defiler(aIgnorerFleches){if(!this.listeDeroulee&&(MethodesTableau.existe(this._options.mode,[EGenreSaisie.Liste,EGenreSaisie.Combo]))){if(GNavigateur.IsToucheRetourChariot()||GNavigateur.IsToucheFlecheBas())
this.DeroulerListe();}
if(this.listeDeroulee){if(GNavigateur.IsToucheRetourChariot()||GNavigateur.IsToucheEspace()){this.SurValidation(true,this.Survolee);}
else if(GNavigateur.IsToucheEchap()){this.FermerListe(true);}
else if(!(!aIgnorerFleches&&_defilerFleches.call(this))&&GNavigateur.estCaractereAlphaNumerique()){clearTimeout(this._timerInitParseur);this._timerInitParseur=setTimeout(_initParseur.bind(this),500);this._parseur=this._parseur+GNavigateur.CaractereTouche;var lIndice=this.ListeElements.GetIndiceParParsingLibelle(this._parseur);if(lIndice>=0)
this.SurLigne(lIndice);}}}
function _initParseur(){this._parseur='';}
function _chercherSuivantSelectionnable(aIndice,aSensSuivant){var lSens=aSensSuivant?1:-1;aIndice=aIndice+lSens;var N=this.ListeElements.GetNbrElements();while((this.Survolee> -1)&&(this.Survolee<N)&&this.ListeElements&&this.ListeElements.GetElement(aIndice)&&(this.ListeElements.GetElement(aIndice).AvecSelection===false))
aIndice+=lSens;return aIndice;}
ObjetSaisie.prototype._remplirListe=function(){var lHeightEcran=GNavigateur.EcranH;var N=this.ListeElements?this.ListeElements.GetNbrElements():0;var M=0;var P= -1,lLargeurListe=_getLargeurListe.bind(this)();if(N<2&&!this._options.accepterUnElement)
return;if(this._options.avecTriListeElements&&this.ListeElements){if(this.ListeElements.getTri()){this.ListeElements.trier();}
else{this.ListeElements.Trier();}}
var T=[];T.push('<div id="'+this.idContenu+'" tabIndex="-1" class="',this._options.classTexteReference ,' AvecMain FondBlanc"',' style="overflow-y: auto; overflow-x: hidden;'+GStyle.composeWidth(lLargeurListe),GStyle.composeCouleurBordure(GCouleur.bordure),GStyle.composeBoxShadow()+';height:0px;',this._options.couleurFondDeroulant?GStyle.composeCouleurFond(this._options.couleurFondDeroulant):'','">');for(var I=0;I<N;I++)
if(this.ListeElements.Existe(I)&&(this.ListeElements.GetElement(I).Visible!==false)){var lElement=this.ListeElements.GetElement(I);var LLibelle=lElement.Libelle;var lLibelleTitle=!lElement.libelleHtmlTitle&&GChaine.GetLongueurChaine(LLibelle,10,true,null)>=(lLargeurListe-this.largeurBouton)?LLibelle:(lElement.libelleHtmlTitle&&lElement.libelleHtmlTitle!==''?lElement.libelleHtmlTitle:'');LLibelle=GChaine.AvecEspaceSiVide(GChaine.Insecable(LLibelle));if(lElement.ClassAffichage||lElement.StyleAffichage){LLibelle='<div '+(lElement.ClassAffichage?'class="'+lElement.ClassAffichage+'" ':'')+(lElement.StyleAffichage?'style="'+lElement.StyleAffichage+'"':'')+'>'+LLibelle+'</div>';}
T.push('<div id="'+this.Nom+'_'+I+'" '+GObjetWAI.composeRole(EGenreRole.Option),lLibelleTitle?lElement.libelleHtmlTitle?' ie-hint="'+GChaine.toTitle(lLibelleTitle)+'" ':' title="'+GChaine.toTitle(lLibelleTitle)+'" ':'','class="PetitEspaceGauche ',lClasseJQ,'" '+'style="line-height: '+(this._options.hauteur?this._options.hauteur:18)+'px; outline:none;overflow: hidden;'+(this._options.avecTextOverflowEllipsis?'text-overflow:ellipsis;':''),GStyle.composeWidth(lLargeurListe-(this._options.avecReservationPlaceBarreScroll?GNavigateur.GetLargeurBarreDeScroll():6))+'" tabindex="-1">');T.push((lElement.libelleHtml?lElement.libelleHtml:LLibelle)+'</div>');M++;if(P=== -1)
P=I;}
T.push('</div>');GHtml.setDisplay(this.NomListe,true);GHtml.setHtml(this.NomListe,T.join(''),{controleur:this.controleur,ignorerScroll:true});if(GHtml.elementExiste(this.NomListe)){var lEventMap={'focus':_surFocusLigne,'blur':_surBlurLigne,'touchstart':function(event){var T=this.id.split('_');var lIndice=parseInt(T[T.length-1]);event.data.instance.SurLigne(lIndice);},'mouseup':_surMouseDownListe,'mousemove':_surMouseMoveListe};if(GNavigateur.isTactile)
lEventMap.touchend=_surMouseDownListe;$('#'+this.Nom.escapeJQ()+' .'+lClasseJQ).off(lEventMap).on(lEventMap,{instance:this});lEventMap={focusin:_surFocusLigne,focusout:_surBlurLigne,keydown:_surKeyDownListe,keyup:_surKeyUpListe};$('#'+this.NomListe.escapeJQ()).off(lEventMap).on(lEventMap,{instance:this});}
this.hauteurContenu=GPosition.getHeight(this.Nom+'_'+P)*Math.min(M,this._options.nbrLignes);this._ouvertureInverse=false;var lDecalageOmbre=1,lJBouton=$('#'+this.bouton.GetNom().escapeJQ()),lHeightBouton=lJBouton.height(),lPositionBouton=lJBouton.position(),lTopAbsolueBouton=GPosition.getTop(this.bouton.GetNom()),lJListe=$('#'+this.NomListe.escapeJQ());if(!lPositionBouton)
lPositionBouton={top:0,left:0};if(lTopAbsolueBouton+lHeightBouton+this.hauteurContenu+lDecalageOmbre>lHeightEcran&&lTopAbsolueBouton-this.hauteurContenu>0){this._ouvertureInverse=true;}
else{lJListe.css({top:(lHeightBouton+lDecalageOmbre)+'px'});this.hauteurContenu=Math.min(this.hauteurContenu,lHeightEcran-lTopAbsolueBouton-lHeightBouton-lDecalageOmbre);}
lJListe.css({left:lPositionBouton.left+'px'});if(this._options.longueur===0){this._options.longueur=GHtml.getElement(this.NomListe).scrollWidth;this.bouton.setLargeur(this._options.longueur+this.largeurBouton);GPosition.setWidth(this.NomListe ,this._options.longueur+this.largeurBouton);}
GHtml.setDisplay(this.NomListe,false);};function _surFocusLigne(event){event.data.instance.ArreterFermetureListe();}
function _surBlurLigne(event){event.data.instance.DeclencherFermetureListe();}
function _surKeyDownListe(event){GNavigateur.SetCodeTouche(event.originalEvent);GNavigateur.SetCaractereTouche(event.originalEvent);_defilerFleches.bind(event.data.instance)();}
function _surKeyUpListe(event){_defiler.bind(event.data.instance)(true);if(GNavigateur.IsToucheEchap()){GNavigateur.StopperEvenement(event);}}
function _surMouseDownListe(event){if(event.type==='touchend'&&event.originalEvent.changedTouches&&event.originalEvent.changedTouches[0]&&document.elementFromPoint){if(document.elementFromPoint(event.originalEvent.changedTouches[0].pageX,event.originalEvent.changedTouches[0].pageY).id!==this.id) return;}
var T=this.id.split('_');var lIndice=parseInt(T[T.length-1]);event.data.instance.SurValidation(true,lIndice);}
function _surMouseMoveListe(event){var T=this.id.split('_');var lIndice=parseInt(T[T.length-1]);event.data.instance.SurLigne(lIndice);}
ObjetSaisie.prototype.getNbElementsVisible=function(){var lResult=0;for(var i=0;i<this.ListeElements.GetNbrElements();i++){var lElement=this.ListeElements.GetElement(i);if(lElement.Existe()&&lElement.Visible!==false)
lResult++;}
return lResult;};ObjetSaisie.prototype.DeroulerListe=function(ASurvolee,aListeDejaRemplie){if(this.listeDeroulee){this.FermerListe();this.listeDeroulee=false;return;}
if(this.callback.appel(EGenreEvenementObjetSaisie.deploiement)===false){if(this.Pere&&this.Pere.$refreshSelf)
this.Pere.$refreshSelf();return;}
if(this.getNbElementsVisible()>1||(this._options.accepterUnElement&&this.getNbElementsVisible()>0)){this.ArreterFermetureListe();if(!aListeDejaRemplie)
this._remplirListe();var lElementListe=GHtml.getElement(this.NomListe);var lElementContenuListe=GHtml.getElement(this.idContenu);GHtml.setDisplay(lElementListe,true);lElementContenuListe.style.overflowY='hidden';GStyle.setZindex(lElementListe,500);this.listeDeroulee=true;var lObjet=this;$(lElementContenuListe).css({height:0}).animate({height:lObjet.hauteurContenu+'px'},150);if(this._ouvertureInverse){$(lElementListe).css({top:-c_decalageTopOuvertureInverse}).animate({top:-(lObjet.hauteurContenu+c_decalageTopOuvertureInverse)+'px'},150);}
$(lElementContenuListe).queue(function(){_eventAnimationOuvertureFin.bind(lObjet)(ASurvolee);$(this).dequeue();});}
else _gererCasUnSeulElement.bind(this)();};function _eventAnimationOuvertureFin(ASurvolee){GHtml.getElement(this.idContenu).style.overflowY='auto';$('#'+this.idContenu.escapeJQ()).jScrollPane({showArrows:true,verticalGutter:0});this.SurLigne(ASurvolee===null||ASurvolee===undefined?this.Selection===null||this.Selection===undefined?0:this.Selection:ASurvolee);}
ObjetSaisie.prototype.DeclencherFermetureListe=function(){if(this.Timer===null||this.Timer===undefined)
this.Timer=setTimeout(this.FermerListe.bind(this,false),100);};ObjetSaisie.prototype.ArreterFermetureListe=function(){if((this.Timer!==null&&this.Timer!==undefined)){clearTimeout(this.Timer);this.Timer=null;}};ObjetSaisie.prototype.FermerListe=function(AAvecFocus){if(this.listeDeroulee){this.ArreterFermetureListe();_selectionLigne.bind(this)(this.Survolee,false);this.Survolee= -1;if(AAvecFocus)
this.bouton.setFocus();this.listeDeroulee=false;var lElementListe=GHtml.getElement(this.NomListe);var lElementContenuListe=GHtml.getElement(this.idContenu);if(GHtml.estElement(lElementListe)&&GHtml.estElement(lElementContenuListe)){lElementContenuListe.style.overflowY='hidden';GStyle.setZindex(lElementListe,200);var lObjet=this;if(this._ouvertureInverse){var lJElementListe=$(lElementListe);lJElementListe.css({top:-lObjet.hauteurContenu-c_decalageTopOuvertureInverse});$(lElementContenuListe).css({height:lObjet.hauteurContenu}).animate({height:0},{duration:150,step:_etapeFermetureInverse.bind(this,lJElementListe)});}
else{$(lElementContenuListe).css({height:lObjet.hauteurContenu}).animate({height:0},150);}
$(lElementContenuListe).queue(function(){_eventAnimationFermetureFin.bind(lObjet)();$(this).dequeue();});}
else _eventAnimationFermetureFin.bind(this)();}};function _etapeFermetureInverse(aJElement ,aNow){aJElement.css({top:-aNow-c_decalageTopOuvertureInverse});}
function _eventAnimationFermetureFin(){setTimeout(GHtml.setDisplay.bind(GHtml,this.NomListe,false),5);if(this._options.avecEventSurFermetureListe){this.callback.appel(EGenreEvenementObjetSaisie.fermeture,null,0,this.Genre);if(this.Pere&&this.Pere.$refreshSelf)
this.Pere.$refreshSelf();}}
ObjetSaisie.prototype.SurLigne=function(ASurvolee){if(this.Survolee!==ASurvolee){var N=this.ListeElements.GetNbrElements();if(this.ListeElements.GetElement(ASurvolee)&&(this.ListeElements.GetElement(ASurvolee).AvecSelection!==false)){if((this.Survolee> -1)&&(this.Survolee<N)){_selectionLigne.bind(this)(this.Survolee,false);}
this.Survolee=ASurvolee;_selectionLigne.bind(this)(this.Survolee,true);}
var lContenuJsp=$('#'+this.idContenu.escapeJQ());var lContenuJspAPI=lContenuJsp.data('jsp');var lContenuElement=$('#'+this.Nom.escapeJQ()+'_'+this.Survolee);if(lContenuJspAPI&&lContenuElement.length===1)
if(this.Survolee===0)
lContenuJspAPI.scrollToY(0);else lContenuJspAPI.scrollToElement(lContenuElement);GHtml.setFocus(this.Nom+'_'+this.Survolee);}
else if(ASurvolee=== -1){GHtml.setFocus(this.NomListe);}};function _selectionLigne(aLigne,aSelectionner){if((aLigne> -1)&&(aLigne<this.ListeElements.GetNbrElements())){var lElement=GHtml.getElement(this.Nom+'_'+aLigne);if(this._options.avecFondSelectionSurSurvol){GStyle.setCouleur(lElement,aSelectionner?GCouleur.selection.fond:GCouleur.standard.fond);GStyle.setCouleurTexte(lElement,aSelectionner?GCouleur.selection.texte:GCouleur.standard.texte);}
if(this._options.avecGrasSurSurvol){if(aSelectionner){$(lElement).addClass('Gras');}
else{$(lElement).removeClass('Gras');}}}}
ObjetSaisie.prototype.SetDonnees=function(AListeElements,ASelection,ADeroulerListe,AActualiserListe){this.ListeElements=AListeElements;this.ActualiserListe=AActualiserListe;if(this._options.avecTriListeElements&&this.ListeElements){if(this.ListeElements.getTri()){this.ListeElements.trier();}
else{this.ListeElements.Trier();}}
if(!MethodesTableau.existe(this._options.mode,[EGenreSaisie.Liste,EGenreSaisie.Combo]))
this.SetContenu('');this.listeDeroulee=false;this._remplirListe();if(this._options.avecGestionUnElement&&!_gererCasUnSeulElement.bind(this)())
this.SetSelection(ASelection);if(ADeroulerListe&&(this.ListeElements.GetNbrElements()>1))
this.DeroulerListe(ASelection?null:0,true);};function _gererCasUnSeulElement(){var lResult=false;if(this._options.accepterUnElement)
return false;if(this.ListeElements&&(this.ListeElements.GetNbrElements()===1||this.ListeElements.getListeElements(function(aEl){return aEl.Visible!==false;}).GetNbrElements()===1)){var LLibelle='',lEstHtml=false;var lIndex=0;if(this.ListeElements.GetNbrElements()!==1){lIndex=this.ListeElements.getIndiceElementParFiltre(function(aEl){return aEl.Visible!==false;});}
if(this.ListeElements.GetLibelle(lIndex)&&this.ListeElements.GetLibelle(lIndex).length){this.Selection=lIndex;var lElement=this.ListeElements.GetElement(this.Selection);if(lElement)
if(this._options.celluleAvecTexteHtml&&lElement.libelleHtml){LLibelle=lElement.libelleHtml;lEstHtml=true;}
else LLibelle=lElement.GetLibelle();if(this._options.controlerNbrElements)
GHtml.setHtml(this.Nom,'<span class="'+this._options.classTexteReference+' Gras Insecable">'+LLibelle+'</span>');this.SurValidation(false,this.Selection);lResult=true;}
else{this.Selection= -1;}
if(this._options.modifierContenuCelluleSurSelection){if(lEstHtml)
this.bouton.setLibelleHtml(LLibelle);else this.SetContenu(LLibelle);}}
this.$refreshSelf();return lResult;}
ObjetSaisie.prototype.SetFocus=function(){this.bouton.setFocus();};ObjetSaisie.prototype.ViderContenu=function(){this.SetContenu('');};ObjetSaisie.prototype.SetContenu=function(AContenu){this.bouton.setLibelle(AContenu);};ObjetSaisie.prototype.GetContenu=function(){if(MethodesTableau.existe(this._options.mode,[EGenreSaisie.Liste,EGenreSaisie.Combo])) return this.Selection> -1?this.ListeElements.GetElement(this.Selection).GetLibelle():'';else return this.bouton.getLibelle();};ObjetSaisie.prototype.Reset=function(){this.SetDonnees(new ObjetListeElements());this.ViderContenu();};ObjetSaisie.prototype.SetSelection=function(ASelection){var lIndice=_chercherIndiceSelectionSelonSens.call(this,ASelection,false);if(lIndice>=0)
this.SurValidation(false,lIndice);};ObjetSaisie.prototype.initSelectionParNumeroEtGenre=function(ANumero,AGenre,AIndice){if((ANumero===null||ANumero===undefined)&&(AGenre===null||AGenre===undefined))
ANumero=0;if(this.ListeElements){var LIndice=this.ListeElements.GetIndiceParNumeroEtGenre(ANumero,AGenre);if(LIndice===null||LIndice===undefined)
LIndice=AIndice;this.initSelection(LIndice);}};ObjetSaisie.prototype.initSelection=function(aSelection){this.Selection=aSelection>=0?aSelection:-1;if(this.Selection>=0&&this._options.modifierContenuCelluleSurSelection){var lElement=this.ListeElements.GetElement(this.Selection);if(lElement)
if(this._options.celluleAvecTexteHtml&&lElement.libelleHtml)
this.bouton.setLibelleHtml(lElement.libelleHtml);else this.SetContenu(lElement.GetLibelle());}
this.$refreshSelf();};ObjetSaisie.prototype.SetSelectionParNumeroEtGenre=function(ANumero,AGenre,AIndice){if((ANumero===null||ANumero===undefined)&&(AGenre===null||AGenre===undefined))
ANumero=0;if(this.ListeElements){var LIndice=this.ListeElements.GetIndiceParNumeroEtGenre(ANumero,AGenre);if(LIndice===null||LIndice===undefined)
LIndice=AIndice;this.SetSelection(LIndice);}};ObjetSaisie.prototype.setSelectionParIndice=function(aIndice){if(this.ListeElements.GetNbrElementsExistes()<=1)
return;this.SetSelection(aIndice);};ObjetSaisie.prototype.setSelectionParElement=function(aElement,aIndice){if(aElement)
this.SetSelectionParNumeroEtGenre(aElement.GetNumero(),aElement.GetGenre(),aIndice);else this.SetSelectionParNumeroEtGenre(null,null,aIndice);};ObjetSaisie.prototype.SetActif=function(AActif){this.inherited('SetActif',AActif);this.bouton.SetActif(AActif);};})();;
var EGenreImpression={Aucune:0,Normale:1,Format:2,Proportion:3,ProportionTempSaisieNotes:4,GenerationPDF:5};MethodesObjet.heritagePrototype(ObjetFenetre_Impression,ObjetFenetre);function ObjetFenetre_Impression(ANom,AIdent,APere,AEvenement){this.inheritedCreate(ANom,AIdent,APere,AEvenement);this.IdImpression=this.Nom+'_Impression';this.idZoneImpression='zone_impression';Invocateur.abonner('LargeurZoneImpression',this._getLargeurZoneImpression,this);}(function(){ObjetFenetre_Impression.prototype.ConstruireInstances=function(){this.IdentFormat=this.Add(window.ObjetSaisie,this.EvenementFormat,this.InitialiserFormat);};ObjetFenetre_Impression.prototype.InitialiserFormat=function(aInstance){aInstance.SetParametres(EGenreSaisie.Liste,8*10,null,false);aInstance.setOptions_ObjetSaisie({roleWAIEdit:EGenreRole.Combobox,labelWAIZone:GTraductions.getValeur('fenetreImpression.FormatDImpression')});};ObjetFenetre_Impression.prototype.ComposeContenu=function(){var T=[];T.push('<div id="'+this.Nom+'_Format" class="NePasImprimer EspaceBas">');T.push('<span class="Texte10 EspaceHaut" style="float: left;">'+GChaine.Insecable(GTraductions.getValeur('fenetreImpression.FormatDImpression')+' : ')+'</span>');T.push('<span  id="'+this.GetNomInstance(this.IdentFormat)+'"></span>');T.push('</div>');T.push('<div ',GObjetWAI.composeAttribut({genre:EGenreAttribut.label,valeur:GTraductions.getValeur("WAI.ZoneDImpression")}),' id="'+this.IdImpression+'" class="Fenetre_Impression FondBlanc" style="width:'+(this.optionsFenetre.largeur-14)+'px;"></div>');return T.join('');};function _construirePageImpression(aParametres){var lParams=$.extend({titre1:'',titre2:'',contenu:'',proportion:100},aParametres);var lHTML=[];lHTML.push('<table class="FondBlanc" style="width: ',lParams.proportion,'%; height: 100%;" border="0" cellpadding="0" cellspacing="0">');if(lParams.titre1){lHTML.push('<tr><td style="height: 10px;" class="Texte12 Gras AlignementMilieu"><font style="font-size:',lParams.proportion,'%" >',lParams.titre1,'<br>',lParams.titre2?'':'<br>','</font></td></tr>');}
if(lParams.titre2){lHTML.push('<tr><td style="height: 10px;" class="Texte10 Gras AlignementMilieu EspaceHaut"><font style="font-size:',lParams.proportion,'%" >',lParams.titre2,'<br><br></font></td></tr>');}
lHTML.push('<tr><td valign="top">',lParams.contenu,'</td></tr>');return lHTML.join('');}
ObjetFenetre_Impression.prototype.ComposePage=function(AFormat){AFormat=IE.MethodesObjet.isNumber(AFormat)?AFormat:100;var lInstance=this._parametresImpression.instance;if(GEtatUtilisateur.ModeAccessibleActif&&lInstance.AvecImpressionListeArborescente){GHtml.setHtml(this.IdImpression,'');var LNoeud=lInstance.GetRacineListeArborescente();var LNoeudImpression=GHtml.getElement(this.IdImpression);LNoeudImpression.appendChild(LNoeud);}
else{GHtml.setHtml(this.IdImpression,_construirePageImpression(lInstance.GetPageImpression(AFormat)).replace(/(id|onkeyup|onkeydown|onclick|onmouseup|onmousedown|tabindex)=".*?"/gi,''));if(lInstance.completerImpression)
lInstance.completerImpression(AFormat);}
GHtml.setHtml(this.idZoneImpression,GHtml.getHtml(this.IdImpression));};ObjetFenetre_Impression.prototype.SurValidation=function(ANumeroBouton){if(ANumeroBouton===1){window.print();setTimeout(this.Fermer.bind(this),2000);GHtml.setHtml(this.idZoneImpression,GTraductions.getValeur('MessageImpression'));} else this.Fermer();this.callback.appel(ANumeroBouton);};ObjetFenetre_Impression.prototype.Fermer=function(){GHtml.setHtml(this.idZoneImpression,GTraductions.getValeur('MessageImpression'));delete this._parametresImpression;this.inherited('Fermer');};ObjetFenetre_Impression.prototype.Imprimer=function(aParametresImpression){this._parametresImpression={etat:EGenreImpression.Aucune,instance:null};$.extend(this._parametresImpression,aParametresImpression);var LListeFormats=new ObjetListeElements(),I;switch(this._parametresImpression.etat){case EGenreImpression.Proportion:{for(I=10;I>0;I--)
LListeFormats.AddElement(new ObjetElement(I*10+'%',null,I*10));break;}
case EGenreImpression.ProportionTempSaisieNotes:{for(I=2;I>=0;I--)
LListeFormats.AddElement(new ObjetElement((50+I*25)+'%',null,(50+I*25)));break;}
case EGenreImpression.Format:{LListeFormats.AddElement(new ObjetElement(GTraductions.getValeur('fenetreImpression.GrandFormat'),null,0));LListeFormats.AddElement(new ObjetElement(GTraductions.getValeur('fenetreImpression.MoyenFormat'),null,1));LListeFormats.AddElement(new ObjetElement(GTraductions.getValeur('fenetreImpression.PetitFormat'),null,2));LListeFormats.AddElement(new ObjetElement(GTraductions.getValeur('fenetreImpression.TresPetitFormat'),null,3));break;}}
this._surInit=true;this.GetInstance(this.IdentFormat).SetDonnees(LListeFormats,0);delete this._surInit;GHtml.setDisplay(this.Nom+'_Format',LListeFormats.GetNbrElements());if(LListeFormats.GetNbrElements()===0)
this.ComposePage();this.Afficher();$('#'+this.IdImpression.escapeJQ()).jScrollPane({showArrows:true});};ObjetFenetre_Impression.prototype.EvenementFormat=function(aGenreEvenement,aElement){if(aGenreEvenement===EGenreEvenementObjetSaisie.selection){if(!this._surInit){var lDataJScrollPane=$('#'+this.IdImpression.escapeJQ()).data('jsp');if(lDataJScrollPane)
lDataJScrollPane.destroy();}
this.ComposePage(aElement.GetGenre());if(!this._surInit)
$('#'+this.IdImpression.escapeJQ()).jScrollPane({showArrows:true});}};ObjetFenetre_Impression.prototype._getLargeurZoneImpression=function(aObjet){if(aObjet)
aObjet.width=$('#'+this.IdImpression.escapeJQ()).innerWidth();};}());IE.GestionImpression={surActivationImpression:function(aEtatImpression,aInstance,aCallback){if(aEtatImpression!==EGenreImpression.Aucune){if(!aInstance){;aEtatImpression=EGenreImpression.Aucune;}
if(aEtatImpression===EGenreImpression.GenerationPDF){if(!aCallback){;aEtatImpression=EGenreImpression.Aucune;}}
else{if(GEtatUtilisateur.ModeAccessibleActif&&aInstance.AvecImpressionListeArborescente){if(!aInstance.GetRacineListeArborescente){;aEtatImpression=EGenreImpression.Aucune;}}
else if(!aInstance.GetPageImpression){;aEtatImpression=EGenreImpression.Aucune;}}}
if(aEtatImpression!==EGenreImpression.Aucune){GEtatUtilisateur.impressionCourante={etat:aEtatImpression,instance:aInstance,callback:aCallback};}
else{delete GEtatUtilisateur.impressionCourante;}}};;
function ObjetIdentification(aRessource,aListeRessources){this.ressource=aRessource;this.NumeroRessource=aRessource.GetNumero();this.GenreRessource=aRessource.GetGenre();this.LibelleRessource=aRessource.GetLibelle();this.SetListeRessources(aListeRessources);}
ObjetIdentification.prototype.getMembre=function(){return this.ListeRessources.GetElementParNumero(this.NumeroEleve);};ObjetIdentification.prototype.getNbrMembres=function(){return this.ListeRessources.GetNbrElements();};ObjetIdentification.prototype.GetEleve=function(ANumeroEleve){return this.ListeRessources.GetElementParNumero(ANumeroEleve===null||ANumeroEleve===undefined?this.NumeroEleve:ANumeroEleve);};ObjetIdentification.prototype.SetListeRessources=function(AListeRessources){this.ListeRessources=AListeRessources;this.NumeroEleve=null;for(var I=0;(I<this.ListeRessources.GetNbrElements())&&(this.NumeroEleve===null||this.NumeroEleve===undefined);I++)
if(this.ListeRessources.GetElement(I).AvecSelection!==false)
this.NumeroEleve=this.ListeRessources.GetNumero(I);};ObjetIdentification.prototype.GetLibelleEleve=function(){return this.GetEleve()?this.GetEleve().GetLibelle():'';};ObjetIdentification.prototype.GetLibelleClasse=function(ANumeroEleve){var LEleve=this.GetEleve(ANumeroEleve);return(LEleve&&LEleve.Classe)?LEleve.Classe.GetLibelle():'';};ObjetIdentification.prototype.GetNumeroClasse=function(ANumeroEleve){var LEleve=this.GetEleve(ANumeroEleve);return(LEleve&&LEleve.Classe)?LEleve.Classe.GetNumero():'';};ObjetIdentification.prototype.GetLibelleGroupes=function(ANumeroEleve){var LEleve=this.GetEleve(ANumeroEleve);if(LEleve){var LListeGroupes=LEleve.ListeGroupes;var N=LListeGroupes.GetNbrElements();var T=[];for(var I=0;I<N;I++)
T.push(LListeGroupes.GetLibelle(I));return T.join(', ');}
return'';};;
var EGenreSanction={Avertissement:0,Blame:1,ExclusionTemporaireEtablissement:2,ExclusionTemporaireClasse:3,ExclusionDefinitive:4,Autre_Exclusion:5,ExclusionInternat:6,ExclusionDP:7,Autre_Sanction:8,Responsabilisation:9,MesureConservatoire:10};EGenreSanction.getSanctionsDansLOrdre=function(){return[EGenreSanction.ExclusionDefinitive,EGenreSanction.ExclusionTemporaireEtablissement,EGenreSanction.ExclusionTemporaireClasse,EGenreSanction.ExclusionDP,EGenreSanction.ExclusionInternat,EGenreSanction.Autre_Exclusion,EGenreSanction.Responsabilisation,EGenreSanction.Avertissement,EGenreSanction.Blame,EGenreSanction.Autre_Sanction];};EGenreSanction.estUneExclusion=function(aGenre){switch(aGenre){case EGenreSanction.ExclusionDP:case EGenreSanction.ExclusionDefinitive:case EGenreSanction.ExclusionInternat:case EGenreSanction.ExclusionTemporaireClasse:case EGenreSanction.ExclusionTemporaireEtablissement:case EGenreSanction.Autre_Exclusion:return true;}
return false;};EGenreSanction.estUneExclusionTemporaire=function(aGenre){switch(aGenre){case EGenreSanction.ExclusionDP:case EGenreSanction.ExclusionInternat:case EGenreSanction.ExclusionTemporaireClasse:case EGenreSanction.ExclusionTemporaireEtablissement:case EGenreSanction.Autre_Exclusion:return true;}
return false;};;
var EGenrePunition={Exclusion:0,Retenues:1,TIG:2,Devoir:3,Autre:4};EGenrePunition.getPunitionsDansLOrdre=function(){return[EGenrePunition.Exclusion,EGenrePunition.Retenues,EGenrePunition.Devoir,EGenrePunition.TIG,EGenrePunition.Autre];};;
var EGenreRessource={Aucune:0,Classe:1,Groupe:2,Enseignant:3,Eleve:4,Responsable:5,Niveau:6,Orientation:7,Specialite:8,OptionSpecialite:9,Etablissement:10,Periode:11,Service:12,Absence:13,Retard:14,Exclusion:15,Matiere:16,Salle:17,CoEnseignant:18,Suivis:19,Cours:20,Infirmerie:21,AbsenceRepas:22,Pilier:23,ElementPilier:24,Competence:25,DisciplineBrevet:26,Palier:27,SousItem:28,Evaluation:29,Stage:30,SousMatiere:31,MaitreDeStage:32,InspecteurPedagogique:33,Personnel:34,EvaluationHistorique:35,DossierProgression:36,ContenuDeCours:37,TravailAFaire:38,Progression:39,Dispense:40,Punition:41,Sanction:42,Communication:43,AbsenceInternat:44,Observation:45,ObservationProfesseurEleve:46,ConvocationVS:47,DocumentJoint:48,InternetCategorie:49,DocJointEtablissement:50,Option:51,ProgrammationPunition:52,ReportPunition:53,DisciplineLivretScolaire:54,QCM:55,ExecutionQCM:56,QCMEditeur:57,PartieDeClasse:58,DocJointEleve:59,Devoir:60,InternetEnumere:61,AppreciationBulletinCompetence:62,Entreprise:63,DomaineProfessionnel:64,OffreDeStage:65,SujetDeStage:66,DocumentCasier:67,Message:68,PossessionMessage:69,RelationMessageFichierExterne:70,Engagement:71,MesureConservatoire:72,SousCategorieObjetDossier:73,Incident:74,ProtagonisteIncident:75,RelationIncidentFichierExterne:76,RegimeEleve:77,RepasAPreparer:78,SessionDeStage:79};EGenreRessource.correspondAuGenreUtilisateurEspaceCourant=function(aGenre){switch(GEtatUtilisateur.GenreEspace){case EGenreEspace.Academie:return(aGenre===EGenreRessource.InspecteurPedagogique);case EGenreEspace.Eleve:case EGenreEspace.Mobile_Eleve:return(aGenre===EGenreRessource.Eleve);case EGenreEspace.Entreprise:return(aGenre===EGenreRessource.MaitreDeStage);case EGenreEspace.Etablissement:return(aGenre===EGenreRessource.Personnel);case EGenreEspace.Parent:case EGenreEspace.Mobile_Parent:return(aGenre===EGenreRessource.Responsable);case EGenreEspace.Professeur:case EGenreEspace.Mobile_Professeur:return(aGenre===EGenreRessource.Enseignant);default:return false;}};EGenreRessource.getNiveauDeploiementCompetence=function(aCompetence){switch(aCompetence.GetGenre()){case EGenreRessource.Pilier:return 4;case EGenreRessource.ElementPilier:return 3;case EGenreRessource.Competence:return 2;case EGenreRessource.SousItem:return 1;case EGenreRessource.Evaluation:case EGenreRessource.EvaluationHistorique:return 0;}};EGenreRessource.getGenrePereCompetence=function(aGenre,aGenrePourEvaluation){switch(aGenre){case EGenreRessource.ElementPilier:return null;case EGenreRessource.Competence:return EGenreRessource.ElementPilier;case EGenreRessource.SousItem:return EGenreRessource.Competence;case EGenreRessource.Evaluation:return aGenrePourEvaluation;}};EGenreRessource.getNiveauDeploiementSelectionQCM=function(aObjet){switch(aObjet.GetGenre()){case EGenreRessource.Matiere:return 3;case EGenreRessource.Niveau:return 2;case EGenreRessource.QCM:return 1;case EGenreRessource.Aucune:return 0;}};EGenreRessource.getNomImageAbsence=function(aObjet){switch(aObjet.genre){case EGenreRessource.ObservationProfesseurEleve:if(aObjet.estLue)
return'Image_RecapVS_ObservationLue';return'Image_RecapVS_ObservationNonLue';case EGenreRessource.Absence:if(aObjet.justifie)
return'Image_RecapVS_AbsenceCours';return'Image_RecapVS_AbsenceCoursNonJustifie';case EGenreRessource.AbsenceRepas:return'Image_RecapVS_AbsenceRepas';case EGenreRessource.AbsenceInternat:return'Image_RecapVS_AbsenceInternat';case EGenreRessource.Retard:return'Image_RecapVS_Retard';case EGenreRessource.Infirmerie:return'Image_RecapVS_Infirmerie';case EGenreRessource.Incident:return'Image_RecapVS_Incident';case EGenreRessource.Exclusion:return'Image_RecapVS_PunitionExclusion';case EGenreRessource.Punition:if(aObjet.estProgrammation)
return'Image_RecapVS_Programmation';switch(aObjet.genreNature){case EGenrePunition.Exclusion:return'Image_RecapVS_PunitionExclusion';case EGenrePunition.Retenues:case EGenrePunition.TIG:case EGenrePunition.Devoir:case EGenrePunition.Autre:return'Image_RecapVS_PunitionAutre';default:return'';}
break;case EGenreRessource.Sanction:case EGenreRessource.MesureConservatoire:if(!aObjet.avecSursis)
return'Image_RecapVS_Sanction';else return'Image_RecapVS_SanctionAvecSursis';}
return'';};EGenreRessource.getPositionAbsence=function(aObjet){var lResult=0;switch(aObjet.genre){case EGenreRessource.ObservationProfesseurEleve:if(aObjet.estLue)
lResult=1;else lResult=0;break;case EGenreRessource.Absence:if(aObjet.justifie)
lResult=11;else lResult=10;break;case EGenreRessource.AbsenceRepas:lResult=12;break;case EGenreRessource.AbsenceInternat:lResult=13;break;case EGenreRessource.Retard:lResult=21;break;case EGenreRessource.Infirmerie:lResult=20;break;case EGenreRessource.Incident:switch(aObjet.genreNature){case EGenreRessource.Punition:lResult=25;break;case EGenreRessource.Sanction:lResult=26;break;case EGenreRessource.MesureConservatoire:lResult=27;break;default:lResult=28;break;}
break;case EGenreRessource.Exclusion:lResult=30;break;case EGenreRessource.Punition:switch(aObjet.genreNature){case EGenrePunition.Exclusion:lResult=30;break;case EGenrePunition.Retenues:lResult=32;break;case EGenrePunition.TIG:lResult=34;break;case EGenrePunition.Devoir:lResult=33;break;case EGenrePunition.Autre:lResult=35;break;default:lResult=35;break;}
break;case EGenreRessource.MesureConservatoire:lResult=40;break;case EGenreRessource.Sanction:switch(aObjet.genreNature){case EGenreSanction.ExclusionDefinitive:lResult=50;break;case EGenreSanction.ExclusionTemporaireClasse:lResult=51;break;case EGenreSanction.ExclusionTemporaireEtablissement:lResult=52;break;case EGenreSanction.ExclusionDP:lResult=53;break;case EGenreSanction.ExclusionInternat:lResult=54;break;case EGenreSanction.Autre_Exclusion:lResult=55;break;case EGenreSanction.Avertissement:lResult=56;break;case EGenreSanction.Blame:lResult=57;break;case EGenreSanction.Responsabilisation:lResult=58;break;case EGenreSanction.MesureConservatoire:lResult=59;break;case EGenreSanction.Autre_Sanction:lResult=60;break;default:lResult=65;break;}
break;default:lResult=9999;break;}
return lResult;};EGenreRessource.getTitreFenetreSelectionRessource=function(aGenre){switch(aGenre){case EGenreRessource.Eleve:return GTraductions.getValeur('Fenetre_SelectionRessource.CocherEleves') ;case EGenreRessource.Enseignant:return GTraductions.getValeur('Fenetre_SelectionRessource.CocherProfesseurs') ;case EGenreRessource.Responsable:return GTraductions.getValeur('Fenetre_SelectionRessource.CocherResponsables') ;case EGenreRessource.Personnel:return GTraductions.getValeur('Fenetre_SelectionRessource.CocherPersonnel') ;case EGenreRessource.MaitreDeStage:return GTraductions.getValeur('Fenetre_SelectionRessource.CocherMaitresDeStage');case EGenreRessource.InspecteurPedagogique:return GTraductions.getValeur('Fenetre_SelectionRessource.CocherInspecteurs') ;case EGenreRessource.Periode:return GTraductions.getValeur('Fenetre_SelectionRessource.CocherPeriodes') ;default:return null;}};;
function _ObjetEtatUtilisateur(aGenreEspace){this.inheritedCreate();this.GenreEspace=aGenreEspace;this.genreConnexion=EGenreConnexion.Normale;this.Navigation=new ObjetNavigation();this.parametres=[];this.liveEdu={};this.page={};this.widgets=[];this.reglesSaisieMotDePasse={min:0,max:0,regles:new TypeEnsembleNombre(),init:false};this._indiceProgressionSelection=0;this._domaineConsultation=new TypeDomaine();}
IE.MethodesObjet.heritagePrototype(_ObjetEtatUtilisateur,IEClasses.ObjetEtatUtilisateurCP);_ObjetEtatUtilisateur.prototype.initialiserEtatsParDefaut=function(){this.ModeAccessibleActif=false;this.Aide=true;};_ObjetEtatUtilisateur.prototype.Initialiser=function(){this.initialiserEtatsParDefaut();this.SetSemaineSelectionnee(IE.Cycles.cycleCourant());this.IdCourant='';};_ObjetEtatUtilisateur.prototype.estModeAccessible=function(){return this.ModeAccessibleActif;};_ObjetEtatUtilisateur.prototype.getModeAccessible=function(){return this.ModeAccessibleActif;};_ObjetEtatUtilisateur.prototype.setModeAccessible=function(aActif){this.ModeAccessibleActif=aActif;if(IE.optionsEspaceLocal)
IE.optionsEspaceLocal.setModeAccessible(aActif,this.GenreEspace);};_ObjetEtatUtilisateur.prototype.getAvecSaisie=function(){return GEtatUtilisateur.GenreEspace===EGenreEspace.Professeur||GEtatUtilisateur.GenreEspace===EGenreEspace.Entreprise||GEtatUtilisateur.GenreEspace===EGenreEspace.Parent||GEtatUtilisateur.GenreEspace===EGenreEspace.Eleve||GEtatUtilisateur.GenreEspace===EGenreEspace.Etablissement||GEtatUtilisateur.GenreEspace===EGenreEspace.Mobile_Professeur;};_ObjetEtatUtilisateur.prototype.avecCommunication=function(){if((GEtatUtilisateur.GenreEspace===EGenreEspace.Professeur)&&(this.genreConnexion===EGenreConnexion.Allegee))
return false;if(GEtatUtilisateur.GenreEspace===EGenreEspace.Eleve){return GApplication.droits.get(IEEnum.droits.communication.avecDiscussion);}
else return MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Professeur,EGenreEspace.Parent,EGenreEspace.Etablissement]);};_ObjetEtatUtilisateur.prototype.avecFenetreKiosque=function(){return this.avecKiosque&&MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Eleve]);};_ObjetEtatUtilisateur.prototype.avecKiosque=function(){return this.autorisationKiosque&&MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Professeur,EGenreEspace.Eleve]);};_ObjetEtatUtilisateur.prototype.estEspaceEleve=function(){return GEtatUtilisateur.GenreEspace===EGenreEspace.Eleve;};_ObjetEtatUtilisateur.prototype.estEspacePourEleve=function(){return MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Parent,EGenreEspace.Eleve,EGenreEspace.Entreprise,EGenreEspace.Mobile_Parent,EGenreEspace.Mobile_Eleve]);};_ObjetEtatUtilisateur.prototype.estEspacePourProf=function(){return MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Professeur,EGenreEspace.Academie,EGenreEspace.Mobile_Professeur]);};_ObjetEtatUtilisateur.prototype.estEspaceAvecMembre=function(){return MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Parent,EGenreEspace.Entreprise,EGenreEspace.Academie,EGenreEspace.Mobile_Parent]);};_ObjetEtatUtilisateur.prototype.setGenreConnexion=function(aGenreConnexion){this.genreConnexion=this.GenreEspace===EGenreEspace.Professeur?aGenreConnexion:EGenreConnexion.Normale;if(GApplication.acces.estConnexionCAS()){this.genreConnexion=EGenreConnexion.Normale;}
if(IE.optionsEspaceLocal)
IE.optionsEspaceLocal.setGenreConnexion(aGenreConnexion);};_ObjetEtatUtilisateur.prototype.GetSemaineSelectionnee=function(){return this.SemaineSelectionnee;};_ObjetEtatUtilisateur.prototype.SetSemaineSelectionnee=function(aSemaine){this.SemaineSelectionnee=aSemaine;if(!this.DomaineSelectionne||this.DomaineSelectionne.EstUnNombre())
this.DomaineSelectionne=new TypeDomaine(this.SemaineSelectionnee);};_ObjetEtatUtilisateur.prototype.setPage=function(aPage){this.page=aPage;if(this.page&&this.page.Onglet>0)
this.setGenreOnglet(this.page.Onglet);};_ObjetEtatUtilisateur.prototype.getPage=function(){return this.page;};_ObjetEtatUtilisateur.prototype.resetPage=function(){this.page=null;};_ObjetEtatUtilisateur.prototype.GetDomaineSelectionne=function(){return this.DomaineSelectionne;};_ObjetEtatUtilisateur.prototype.SetDomaineSelectionne=function(aDomaine){this.DomaineSelectionne=aDomaine;if(this.DomaineSelectionne.EstUnNombre())
this.SemaineSelectionnee=this.DomaineSelectionne.GetPremierePosition();};_ObjetEtatUtilisateur.prototype.GetPageCourante=function(){return this.PageCourante;};_ObjetEtatUtilisateur.prototype.SetPageCourante=function(aInstancePage){this.PageCourante=aInstancePage;this.EtatImpression=EGenreImpression.Aucune;};_ObjetEtatUtilisateur.prototype.GetNiveau=function(){return this.Navigation.Niveau;};_ObjetEtatUtilisateur.prototype.SetNiveau=function(aNiveau){this.Navigation.Niveau=aNiveau;};_ObjetEtatUtilisateur.prototype.getGenreAffichageAccessible=function(){return this.Navigation.genreAffichageAccessible;};_ObjetEtatUtilisateur.prototype.setNavigationDate=function(aDate){this.Navigation.Date=aDate;};_ObjetEtatUtilisateur.prototype.getNavigationDate=function(){return this.Navigation.Date;};_ObjetEtatUtilisateur.prototype.setNavigationCours=function(aCours){this.Navigation.cours=aCours;};_ObjetEtatUtilisateur.prototype.getNavigationCours=function(){return this.Navigation.cours;};_ObjetEtatUtilisateur.prototype.getAfficherFicheService=function(){return this.Navigation.afficherFicheService;};_ObjetEtatUtilisateur.prototype.inverserAfficherFicheService=function(){this.Navigation.afficherFicheService=!this.Navigation.afficherFicheService;};_ObjetEtatUtilisateur.prototype.getTriDevoirs=function(){return this.Navigation.triDevoirs;};_ObjetEtatUtilisateur.prototype.inverserTriDevoirs=function(){this.Navigation.triDevoirs=!this.Navigation.triDevoirs;};_ObjetEtatUtilisateur.prototype.getCategorie=function(){return this.Navigation.categorie;};_ObjetEtatUtilisateur.prototype.setCategorie=function(aCategorie){this.Navigation.categorie=aCategorie;};_ObjetEtatUtilisateur.prototype.getUniquementNonLues=function(){return this.Navigation.uniquementNonLues||false;};_ObjetEtatUtilisateur.prototype.setUniquementNonLues=function(aBoolean){this.Navigation.uniquementNonLues=aBoolean;};_ObjetEtatUtilisateur.prototype.getNumeroActuSelectionnee=function(){return this.Navigation.numeroActuSelectionnee;};_ObjetEtatUtilisateur.prototype.setNumeroActuSelectionnee=function(aNumeroSelectionnee){this.Navigation.numeroActuSelectionnee=aNumeroSelectionnee;};_ObjetEtatUtilisateur.prototype.getUniquementMesIncidents=function(){return this.Navigation.uniquementMesIncidents===false?false:true;};_ObjetEtatUtilisateur.prototype.setUniquementMesIncidents=function(aBoolean){this.Navigation.uniquementMesIncidents=aBoolean;};_ObjetEtatUtilisateur.prototype.getIndiceIncidentSelectionne=function(){return this.Navigation.indiceIncidentSelectionne;};_ObjetEtatUtilisateur.prototype.setIndiceIncidentSelectionne=function(aNumeroSelectionne){this.Navigation.indiceIncidentSelectionne=aNumeroSelectionne;};_ObjetEtatUtilisateur.prototype.getAvecCoursAnnule=function(){if(this.getAvecChoixCoursAnnule())
return GApplication.parametresUtilisateur.get('EDT.afficherCoursAnnules');return this.Navigation.avecCoursAnnule;};_ObjetEtatUtilisateur.prototype.setAvecCoursAnnule=function(aAvecCoursAnnule){if(this.getAvecChoixCoursAnnule())
GApplication.parametresUtilisateur.set('EDT.afficherCoursAnnules',aAvecCoursAnnule);else this.Navigation.avecCoursAnnule=aAvecCoursAnnule;};_ObjetEtatUtilisateur.prototype.getAvecChoixCoursAnnule=function(){return MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Professeur,EGenreEspace.Etablissement,EGenreEspace.Academie]);};_ObjetEtatUtilisateur.prototype.getGenreOnglet=function(){return this.genreOnglet;};_ObjetEtatUtilisateur.prototype.setGenreOnglet=function(aGenreOnglet){this.genreOnglet=aGenreOnglet;};_ObjetEtatUtilisateur.prototype.getGenreOngletPere=function(){this.genreOngletPere=this.listeOnglets.GetElementParGenre(this.genreOnglet);return this.genreOngletPere&&this.genreOngletPere.onglet?this.genreOngletPere.onglet.Genre:null;};_ObjetEtatUtilisateur.prototype.existeGenreOnglet=function(aGenreOnglet){var lGenreOnglet=this.listeOnglets.GetElementParGenre(aGenreOnglet);return lGenreOnglet&&lGenreOnglet.Actif;};_ObjetEtatUtilisateur.prototype.getLibelleOnglet=function(aGenreOnglet){var lOnglet=this.listeOnglets.GetElementParGenre(aGenreOnglet?aGenreOnglet:this.genreOnglet);return lOnglet?lOnglet.GetLibelle():'';};_ObjetEtatUtilisateur.prototype.getGenreAffichageOnglet=function(){};_ObjetEtatUtilisateur.prototype.SetIdentification=function(aRessource ,aListeRessources){this.Identification=new ObjetIdentification(aRessource,aListeRessources);if(this.page&&this.page.membre)
this.SetNumeroEleve(this.page.membre.GetNumero());};_ObjetEtatUtilisateur.prototype.getDomainePresence=function(aElementRessource){var lOnglet=this.getOnglet();if(!lOnglet.domaineDePresenceRessources) return null;var lElement=lOnglet.domaineDePresenceRessources.GetElementParNumeroEtGenre(aElementRessource.GetNumero(),aElementRessource.GetGenre());if(lElement)
return lElement.domaineDePresence;else return null;};_ObjetEtatUtilisateur.prototype.getJoursStageDEleve=function(aElementRessource){if(aElementRessource.GetGenre()!==EGenreRessource.Eleve)
return null;var lOnglet=this.getOnglet();if(!lOnglet.domaineDePresenceRessources) return null;var lElement=lOnglet.domaineDePresenceRessources.GetElementParNumeroEtGenre(aElementRessource.GetNumero(),aElementRessource.GetGenre());if(lElement)
return lElement.joursStage;else return null;};_ObjetEtatUtilisateur.prototype.setDomainePresence=function(aElementRessource,aDomainePresence,aJoursStage){var lOnglet=this.getOnglet();if(!lOnglet.domaineDePresenceRessources)
lOnglet.domaineDePresenceRessources=new ObjetListeElements();var lElement=lOnglet.domaineDePresenceRessources.GetElementParNumeroEtGenre(aElementRessource.GetNumero(),aElementRessource.GetGenre());if(!lElement){lElement=MethodesObjet.dupliquer(aElementRessource,true);lOnglet.domaineDePresenceRessources.AddElement(lElement);}
lElement.domaineDePresence=aDomainePresence;lElement.joursStage=aJoursStage;};_ObjetEtatUtilisateur.prototype.getRessource=function(){return this.Identification?this.Identification.GetEleve():null;};_ObjetEtatUtilisateur.prototype.getOnglet=function(aGenreOnglet){var lGenreOnglet=aGenreOnglet?aGenreOnglet:this.getGenreOnglet();if(!this.getRessource().tableauOnglets[lGenreOnglet])
this.getRessource().tableauOnglets[lGenreOnglet]={};return this.getRessource().tableauOnglets[lGenreOnglet];};_ObjetEtatUtilisateur.prototype.avecOngletPilier=function(){return(this.getOnglet().listePiliers!==null&&this.getOnglet().listePiliers!==undefined);};_ObjetEtatUtilisateur.prototype.avecOngletPeriode=function(){return!(this.avecOngletPilier()||MethodesTableau.existe(this.getGenreOnglet(),[EGenreOnglet.B2I_ParEleve,EGenreOnglet.Evaluation,EGenreOnglet.FicheBrevet,EGenreOnglet.SaisieAppreciationDeFinDeStage,EGenreOnglet.SuiviPluriannuel,EGenreOnglet.FicheScolaire,EGenreOnglet.LivretScolaire_Fiche,EGenreOnglet.Saisie_CarnetCorrespondance]));};_ObjetEtatUtilisateur.prototype.getOngletListePiliers=function(){return this.getOnglet().listePiliers;};_ObjetEtatUtilisateur.prototype.getOngletListeClasses=function(){return this.avecOngletPilier()?this.getPilier().listeClasses:this.getOnglet().listeClasses;};_ObjetEtatUtilisateur.prototype.setOngletListeClasses=function(aListeClasses){(this.avecOngletPilier()?this.getPilier():this.getOnglet()).listeClasses=aListeClasses;};_ObjetEtatUtilisateur.prototype.getListeSalles=function(){return this.listeSalles;};_ObjetEtatUtilisateur.prototype.setListeSalles=function(aListeSalles){this.listeSalles=aListeSalles;};_ObjetEtatUtilisateur.prototype.getOngletListePeriodes=function(){return this.getClasse().listePeriodes;};_ObjetEtatUtilisateur.prototype.getDisciplinesBrevetDeClasse=function(){return this.getClasseDOnglet().listeDisciplinesBrevet;};_ObjetEtatUtilisateur.prototype.getDisciplinesLivretDeClasse=function(){return this.getClasseDOnglet().listeDisciplinesLivret;};_ObjetEtatUtilisateur.prototype.getOngletListeMatieres=function(){return this.getClasse().listeMatieres;};_ObjetEtatUtilisateur.prototype.getOngletListeEleves=function(aAvecPeriode){return(aAvecPeriode!==false?this.getPeriode():this.getClasse()).listeEleves;};_ObjetEtatUtilisateur.prototype.getOngletListeCompetences=function(){return this.getClasse().listeCompetences;};_ObjetEtatUtilisateur.prototype.getOngletListeServices=function(){return this.getPeriode().listeServices;};_ObjetEtatUtilisateur.prototype.getOngletListeAppreciations=function(){return this.getPeriode().listeAppreciations;};_ObjetEtatUtilisateur.prototype.getOngletListePaliers=function(){return this.getClasse().listePaliers;};_ObjetEtatUtilisateur.prototype.setOngletListeEleves=function(aListeEleves,aAvecPeriode){(aAvecPeriode!==false?this.getPeriode():this.getClasse()).listeEleves=aListeEleves;};_ObjetEtatUtilisateur.prototype.setOngletListeCompetences=function(aListeCompetences){this.getClasse().listeCompetences=aListeCompetences;};_ObjetEtatUtilisateur.prototype.setOngletListeServices=function(aListeServices){this.getPeriode().listeServices=aListeServices;};_ObjetEtatUtilisateur.prototype.setOngletListeAppreciations=function(aListeAppreciations){this.getPeriode().listeAppreciations=aListeAppreciations;};_ObjetEtatUtilisateur.prototype.setOngletListePaliers=function(aListePaliers){this.getClasse().listePaliers=aListePaliers;};_ObjetEtatUtilisateur.prototype.setOngletListeMatieres=function(aListeMatieres){this.getClasse().listeMatieres=aListeMatieres;};_ObjetEtatUtilisateur.prototype.setOngletListePeriodes=function(aListePeriodes){this.getClasse().listePeriodes=aListePeriodes;};_ObjetEtatUtilisateur.prototype.setOngletPeriodeParDefaut=function(aPeriodeParDefaut){this.getClasse().periodeParDefaut=aPeriodeParDefaut;};_ObjetEtatUtilisateur.prototype.getOngletPeriodeParDefaut=function(){return this.getClasse().periodeParDefaut;};_ObjetEtatUtilisateur.prototype.getPilier=function(){return this.getOnglet().listePiliers?this.getOnglet().listePiliers.GetElementParNumeroEtGenre(this.Navigation.GetNumeroRessource(EGenreRessource.Pilier),this.Navigation.GetGenreRessource(EGenreRessource.Pilier)):null;};_ObjetEtatUtilisateur.prototype.getClasseDOnglet=function(){return this.getOnglet().listeClasses?this.getOnglet().listeClasses.GetElementParNumeroEtGenre(this.Navigation.GetNumeroRessource(EGenreRessource.Classe),this.Navigation.GetGenreRessource(EGenreRessource.Classe)):null;};_ObjetEtatUtilisateur.prototype.getServiceDePilier=function(){return this.getPilier()&&this.getPilier().avecService?this.Navigation.GetRessource(EGenreRessource.Service):null;};_ObjetEtatUtilisateur.prototype.getClasse=function(){var lRef=this.avecOngletPilier()?this.getPilier():this.getRessource();var lListeClasses=lRef.listeClassesBase||lRef.listeClasses;return lListeClasses.GetElementParNumeroEtGenre(this.Navigation.GetNumeroRessource(EGenreRessource.Classe),this.Navigation.GetGenreRessource(EGenreRessource.Classe));};_ObjetEtatUtilisateur.prototype.getPeriode=function(){return this.avecOngletPeriode()?this.getClasse().listePeriodes.GetElementParNumeroEtGenre(this.Navigation.GetNumeroRessource(EGenreRessource.Periode),this.Navigation.GetGenreRessource(EGenreRessource.Periode)):this.getOngletListeClasses();};_ObjetEtatUtilisateur.prototype.getListeClasses=function(aAvecClasse,aAvecGroupe,aSeuleMesClasse){var lListeClasses=new ObjetListeElements();for(var I=0;I<this.getRessource().listeClasses.GetNbrElements();I++){var lClasse=this.getRessource().listeClasses.GetElement(I);if(((aAvecClasse&&(lClasse.GetGenre()===EGenreRessource.Classe))||(aAvecGroupe&&(lClasse.GetGenre()===EGenreRessource.Groupe)))&&(!aSeuleMesClasse||lClasse.estResponsable||lClasse.enseigne)){lListeClasses.AddElement(lClasse);}}
return lListeClasses;};_ObjetEtatUtilisateur.prototype.getIndiceDateSaisieAbsence=function(aDate){var lListeDatesSaisieAbsence=GApplication.droits.get(IEEnum.droits.absences.listeDatesSaisieAbsence);var lDate=aDate?aDate:this.getNavigationDate();if(lDate)
for(var I=0;lListeDatesSaisieAbsence&&(I<lListeDatesSaisieAbsence.GetNbrElements());I++){var lDateSaisieAbsence=lListeDatesSaisieAbsence.GetElement(I);if(GDate.estJourEgal(lDateSaisieAbsence.Date,lDate))
return I;}
return-1;};_ObjetEtatUtilisateur.prototype.GetNumeroEleve=function(){return this.Identification.NumeroEleve;};_ObjetEtatUtilisateur.prototype.SetNumeroEleve=function(aNumeroEleve){this.Identification.NumeroEleve=aNumeroEleve;this.Navigation.SetRessource(EGenreRessource.Eleve ,GEtatUtilisateur.Identification.GetLibelleEleve(),aNumeroEleve);this.Navigation.SetRessource(EGenreRessource.Classe,GEtatUtilisateur.Identification.GetLibelleClasse(),GEtatUtilisateur.Identification.GetNumeroClasse(),EGenreRessource.Classe);};_ObjetEtatUtilisateur.prototype.SetListeRessources=function(aListeRessources){this.Identification.SetListeRessources(aListeRessources);};_ObjetEtatUtilisateur.prototype.GetLibelleEleve=function(aNumeroEleve){var LEleve=this.Identification.GetEleve(aNumeroEleve);return LEleve?LEleve.GetLibelle():'';};_ObjetEtatUtilisateur.prototype.GetLibelleRessource=function(){return this.Identification.LibelleRessource;};_ObjetEtatUtilisateur.prototype.getUtilisateur=function(){return this.Identification.ressource;};_ObjetEtatUtilisateur.prototype.getMembre=function(){return this.Identification.getMembre();};_ObjetEtatUtilisateur.prototype.getNbrMembres=function(){return this.Identification.getNbrMembres();};_ObjetEtatUtilisateur.prototype.getProfesseur=function(){switch(this.GenreEspace){case EGenreEspace.Professeur:return this.getUtilisateur();case EGenreEspace.Academie:return this.getMembre();}};_ObjetEtatUtilisateur.prototype.getIndiceProgressionSelection=function(){return this._indiceProgressionSelection;};_ObjetEtatUtilisateur.prototype.setIndiceProgressionSelection=function(aIndice){this._indiceProgressionSelection=aIndice;};_ObjetEtatUtilisateur.prototype.GetNumeroRessource=function(aPourUtilisateur){return(aPourUtilisateur?this.getUtilisateur():this.getMembre()).GetNumero();};_ObjetEtatUtilisateur.prototype.getLibelleImpression=function(aMessage,aAvecPeriode,aAvecClasse,aAvecEleve,aAvecMatiere,aAvecProfesseur,aAvecDisciplineBrevet){var lLibelle=aMessage;if(aAvecPeriode)
lLibelle+=' ('+GEtatUtilisateur.Navigation.GetLibelleRessource(EGenreRessource.Periode)+')';if(aAvecDisciplineBrevet)
lLibelle+=' ('+GEtatUtilisateur.Navigation.GetLibelleRessource(EGenreRessource.DisciplineBrevet)+')';if(aAvecClasse){var lGenreRessource=GEtatUtilisateur.Navigation.GetGenreRessource(EGenreRessource.Classe);var lLibelleRessource=GEtatUtilisateur.Navigation.GetLibelleRessource(EGenreRessource.Classe);if(lGenreRessource===null||lGenreRessource===undefined){lGenreRessource=EGenreRessource.Classe;lLibelleRessource=GEtatUtilisateur.Identification.GetLibelleClasse();}
lLibelle+=' / '+(lGenreRessource===EGenreRessource.Classe?GTraductions.getValeur('Classe'):GTraductions.getValeur('Groupe'))+' : '+lLibelleRessource;}
if(aAvecEleve){var lLibelleEleve=GEtatUtilisateur.Navigation.GetLibelleRessource(EGenreRessource.Eleve);if(lLibelleEleve===null||lLibelleEleve===undefined)
lLibelleEleve=this.getMembre().GetLibelle();lLibelle+=' / '+GTraductions.getValeur('Eleve')+' : '+lLibelleEleve;}
if(aAvecMatiere)
lLibelle+=' / '+GTraductions.getValeur('Matiere')+' : '+GEtatUtilisateur.Navigation.GetLibelleRessource(EGenreRessource.Matiere);if(aAvecProfesseur)
lLibelle+=' / '+GTraductions.getValeur('Professeur')+' : '+GEtatUtilisateur.Navigation.GetLibelleRessource(EGenreRessource.Enseignant);return lLibelle;};_ObjetEtatUtilisateur.prototype.avecPageAccueil=function(){var lOnglet=this.listeOnglets.GetElementParGenre(EGenreOnglet.Accueil);return MethodesTableau.existe(this.GenreEspace,[EGenreEspace.Parent,EGenreEspace.Eleve,EGenreEspace.Professeur,EGenreEspace.Etablissement])&&lOnglet&&lOnglet.Actif;};_ObjetEtatUtilisateur.prototype.avecTutoriel=function(){return GParametres.urlTutorial&&GParametres.urlTutorial.length>0;};_ObjetEtatUtilisateur.prototype.avecLiveEdu=function(){return GParametres.avecLiveEdu&&MethodesTableau.existe(this.GenreEspace,[EGenreEspace.Parent,EGenreEspace.Eleve,EGenreEspace.Professeur,EGenreEspace.Etablissement]);};_ObjetEtatUtilisateur.prototype.avecIManuel=function(){return this.autorisationIManuel&&MethodesTableau.existe(this.GenreEspace,[EGenreEspace.Parent,EGenreEspace.Eleve]);};_ObjetEtatUtilisateur.prototype.avecOngletIManuel=function(){return this.autorisationIManuel&&this.GenreEspace===EGenreEspace.Professeur&&this.genreConnexion===EGenreConnexion.Normale;};_ObjetEtatUtilisateur.prototype.existeTutoriel=function(){return!!this.getUrlTutoriel();};_ObjetEtatUtilisateur.prototype.getUrlTutoriel=function(){return GParametres.urlTutorial;};_ObjetEtatUtilisateur.prototype.setParametres=function(aParametres){this.parametres[this.getGenreOnglet()]=aParametres;};_ObjetEtatUtilisateur.prototype.getParametres=function(){return this.parametres[this.getGenreOnglet()];};_ObjetEtatUtilisateur.prototype.setGraphe=function(agraphe){this.graphe={};$.extend(this.graphe,agraphe);};_ObjetEtatUtilisateur.prototype.getGraphe=function(){return this.graphe;};_ObjetEtatUtilisateur.prototype.getListeComboPeriodes=function(aGenres){if(!aGenres)
return GEtatUtilisateur.getRessource().listeComboPeriodes;var lListePeriodes=new ObjetListeElements();for(var I=0;I<GEtatUtilisateur.getRessource().listeComboPeriodes.GetNbrElements();I++){var lPeriode=GEtatUtilisateur.getRessource().listeComboPeriodes.GetElement(I);if(MethodesTableau.existe(lPeriode.GetGenre(),aGenres))
lListePeriodes.AddElement(lPeriode);}
return lListePeriodes;};_ObjetEtatUtilisateur.prototype.getAcces=function(){var lMembre=this.getMembre();if(lMembre&&lMembre.acces){return lMembre.acces;}
return{autorise:true,autoriseSurDate:true,dateDebut:null,dateFin:null};};;
MethodesObjet.heritagePrototype(ObjetEtatUtilisateur,_ObjetEtatUtilisateur);function ObjetEtatUtilisateur(aGenreEspace,aENT){this.inheritedCreate(aGenreEspace,aENT);}
ObjetEtatUtilisateur.prototype.getOngletListePeriodes=function(){return this.getOnglet().listePeriodes;};ObjetEtatUtilisateur.prototype.getOngletListePiliers=function(){return this.getOnglet().listePiliers;};ObjetEtatUtilisateur.prototype.getOngletPeriodeParDefaut=function(){var lPeriode=this.Navigation.GetRessource(EGenreRessource.Periode);return lPeriode?lPeriode:this.getOnglet().periodeParDefaut;};ObjetEtatUtilisateur.prototype.getPeriode=function(){return this.page&&this.page.periode?this.page.periode:this.getOngletPeriodeParDefaut();};ObjetEtatUtilisateur.prototype.getIndiceCompetence=function(){if(this.page&&this.page.competence){for(var I=0;I<this.getOnglet().listePiliers.GetNbrElements();I++){var lCompetence=this.getOnglet().listePiliers.GetElement(I);if((lCompetence.GetNumero()===this.page.competence.GetNumero())&&(lCompetence.service.GetNumero()===this.page.service.GetNumero())){return I;}}}
return null;};ObjetEtatUtilisateur.prototype.getCompetence=function(){return this.getOnglet().listePiliers(this.getIndiceCompetence());};ObjetEtatUtilisateur.prototype.getDate=function(){return this.page&&this.page.Date?this.page.Date:GDate.getDateCourante();};;
var GTableau=new ObjetTableau();function ObjetTableau(aAvecStyleSite,aPourImpression){this.editable=true;this.pourImpression=aPourImpression===null||aPourImpression===undefined?false:aPourImpression;}
ObjetTableau.prototype._getCouleur=function(){return GCouleur.liste;};ObjetTableau.prototype._styleCouleur=function(aCouleur,aPourImpression,aAvecCadre,aGenreBordure,aCouleurTexte){aAvecCadre=aAvecCadre===null||aAvecCadre===undefined?true:aAvecCadre;if(aCouleur){var lCouleurFond=aCouleur.getFond(aPourImpression);var lCouleurTexte=aCouleurTexte?aCouleurTexte:aCouleur.getTexte(aPourImpression);var lCouleurBordure=aCouleur.getBordure(aPourImpression);if(aAvecCadre){if(aGenreBordure)
return GStyle.composeCouleur(lCouleurFond,lCouleurTexte)+' '+GStyle.composeCouleurBordure(lCouleurBordure,1,aGenreBordure);else return GStyle.composeCouleur(lCouleurFond,lCouleurTexte)+' '+GStyle.composeCouleurBordure(lCouleurBordure,1);}
return GStyle.composeCouleur(lCouleurFond,lCouleurTexte);} else return'';};ObjetTableau.prototype.styleTableau=function(aPourImpression,aAvecCadre,aGenreBordure){var lCouleurBordure=aPourImpression?GCouleur.noir:this._getCouleur().bordure;if(aAvecCadre){if(aGenreBordure)
return GStyle.composeCouleurBordure(lCouleurBordure,1,aGenreBordure);else return GStyle.composeCouleurBordure(lCouleurBordure);}
return'';};ObjetTableau.prototype.styleTitre=function(aPourImpression,aAvecCadre,aGenreBordure,aCouleurTexte){return this._styleCouleur(this._getCouleur().titre,aPourImpression,aAvecCadre,aGenreBordure,aCouleurTexte);};ObjetTableau.prototype.styleColonneFixe=function(aPourImpression,aAvecCadre,aGenreBordure,aCouleurTexte){return this._styleCouleur(this._getCouleur().colonneFixe,aPourImpression,aAvecCadre,aGenreBordure,aCouleurTexte);};ObjetTableau.prototype.styleTotal=function(aPourImpression,aAvecCadre,aGenreBordure,aCouleurTexte){return this._styleCouleur(this._getCouleur().total,aPourImpression,aAvecCadre,aGenreBordure,aCouleurTexte);};ObjetTableau.prototype.getCouleurCellule=function(aEditable){var lObjetCouleur=aEditable?this._getCouleur().editable:this._getCouleur().nonEditable;return lObjetCouleur.getFond(this.pourImpression);};ObjetTableau.prototype.styleCellule=function(aPourImpression,aAvecCadre,aGenreBordure,aEditable){aEditable=aEditable===null||aEditable===undefined?true:aEditable;return this._styleCouleur(aEditable?this._getCouleur().editable:this._getCouleur().nonEditable,aPourImpression,aAvecCadre,aGenreBordure);};ObjetTableau.prototype.styleMoyenne=function(aPourImpression,aAvecCadre,aGenreBordure,aEstMoyGenerale){return this._styleCouleur(aEstMoyGenerale?this._getCouleur().total:this._getCouleur().moyenne,aPourImpression,aAvecCadre,aGenreBordure);};ObjetTableau.prototype.styleCumul=function(aPourImpression,aAvecCadre,aGenreBordure){return this._styleCouleur(this._getCouleur().cumul,aPourImpression,aAvecCadre,aGenreBordure);};ObjetTableau.prototype.styleCouleur=function(aPourImpression,aAvecCadre,aGenreBordure,aCouleur){return this._styleCouleur(aCouleur,aPourImpression,aAvecCadre,aGenreBordure);};ObjetTableau.prototype.styleTitreLeger=function(aPourImpression,aAvecBordureGauche){var lCouleurFond=GCouleur.blanc;var lCouleurTexte=aPourImpression?GCouleur.noir:GCouleur.texte;var lCouleurBordure=aPourImpression?GCouleur.texte:GCouleur.texte;return GStyle.composeCouleurFond(lCouleurFond)+' '+GStyle.composeCouleurTexte(lCouleurTexte)+' '+(aAvecBordureGauche?'border-left: 1px solid '+lCouleurBordure+';':'')+' border-right : 1px solid '+lCouleurBordure+';';};;
MethodesObjet.heritagePrototype(ObjetCheckBox,Identite);function ObjetCheckBox(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this._options={estRB:false,orientation:EGenreOrientationAffichage.Vertical,liste:new ObjetListeElements(),Selection:new TypeDomaine(),labelGroup:'',labelledby:'',classCss:'',style:null,styleTable:null};}
ObjetCheckBox.prototype.setOptions_ObjetCheckBox=function(aOptions){$.extend(this._options,aOptions);};ObjetCheckBox.prototype.ConstruireAffichage=function(){var I,lNb=this._options.liste.GetNbrElements();if(this._options.orientation!==EGenreOrientationAffichage.Horizontal&&this._options.orientation!==EGenreOrientationAffichage.Vertical){for(I=0;I<lNb;I++)
GHtml.setHtml(this.GetNom(I),this.Compose_CheckBox(I));}
else{var H=[];H.push('<table border="0" cellspacing="0" cellpadding="0" '+(this._options.styleTable?'style="'+this._options.styleTable+'"':'')+'>');if(this._options.orientation===EGenreOrientationAffichage.Horizontal){H.push('<tr>');for(I=0;I<lNb;I++)
H.push('<td>'+this.Compose_CheckBox(I)+'</td>');H.push('</tr>');}
else{for(I=0;I<lNb;I++)
H.push('<tr><td>'+this.Compose_CheckBox(I)+'</td></tr>');}
H.push('</table>');return H.join('');}};ObjetCheckBox.prototype.RecupererDonnees=function(){var I,lNb=this._options.liste.GetNbrElements();for(I=0;I<lNb;I++)
$('#'+this.GetIdInput(I).escapeJQ()).jIECheckBox({marginRightMin:0});};ObjetCheckBox.prototype.Compose_CheckBox=function(I){var LTypeBouton=this._options.estRB?'radio':'checkbox';var LTabIndex=I?-1:0;var lClassEtStlyle='';if(this._options.classCss)
lClassEtStlyle+=' class="'+this._options.classCss+'"';if(this._options.style)
lClassEtStlyle+=' style="'+this._options.style+'"';var H=[];H.push('<table border="0" cellspacing="0" cellpadding="0" style="margin:2px;">');H.push('<tr class="AvecMain EspaceDroit Texte10">');if(this._options.labelGroup) H.push(GObjetWAI.composeSpan(this._options.labelGroup+' : '+(I+1)+GTraductions.getValeur('WAI.Sur')+' '+this._options.liste.GetNbrElements() ,this.Nom+'_labelGroup'+I));H.push('<td class="PetitEspaceDroit" onkeyup="'+this.Nom+'.SurKeyUp (true, '+I+')" onclick="'+this.Nom+'.SurSelection (true, '+I+')">','<input type="'+LTypeBouton+'" tabindex="'+LTabIndex+'"',GObjetWAI.composeAttribut({genre:EGenreAttribut.describedby,valeur:this.Nom+'_labelGroup'+I+' '+this.GetIdLibelle(I)}),' ',this._options.labelledby?GObjetWAI.composeAttribut({genre:EGenreAttribut.labelledby,valeur:this._options.labelledby}):'',' ' ,' id="'+this.GetIdInput(I)+'" class="AvecMain" style="padding:0px; margin:0px;" '+(this._options.Selection.GetValeur(I+1)?' checked':'')+'></input>');H.push('<td',lClassEtStlyle,' id="'+this.GetIdLibelle(I)+'" onclick="'+this.Nom+'.SurSelection (true, '+I+')">'+GChaine.Insecable(this._options.liste.GetLibelle(I))+'</td>');H.push('</tr>');H.push('</table>');return H.join('');};ObjetCheckBox.prototype.GetNom=function(I){return I===null||I===undefined?this.Nom:this.Nom+'_'+I;};ObjetCheckBox.prototype.GetIdInput=function(I){return this.Nom+'_Input_'+I;};ObjetCheckBox.prototype.GetIdLibelle=function(I){return this.Nom+'_Libelle_'+I;};ObjetCheckBox.prototype.SurKeyUp=function(AInteractionUtilisateur,I,AValeur){if(GNavigateur.IsToucheSelection())
this.SurSelection(AInteractionUtilisateur,I,AValeur);else if((GNavigateur.IsToucheFlecheDroite()||GNavigateur.IsToucheFlecheBas())&&I<this._options.liste.GetNbrElements()-1)
GHtml.setFocus(this.GetIdInput(I+1));else if((GNavigateur.IsToucheFlecheGauche()||GNavigateur.IsToucheFlecheHaut())&&I>0)
GHtml.setFocus(this.GetIdInput(I-1));};ObjetCheckBox.prototype.SurSelection=function(AInteractionUtilisateur,I,AValeur){this.InteractionUtilisateur=AInteractionUtilisateur;if(!(!this.Actif&&this.InteractionUtilisateur)){if(this._options.estRB)
this._options.Selection=new TypeDomaine();if(!this._options.Selection)
return;this._options.Selection.SetValeur(AValeur===null||AValeur===undefined?!this._options.Selection.GetValeur(I+1):AValeur,I+1);if(this._options.estRB)
if(this._options.Selection.GetNbrValeurs(true)===0)
this._options.Selection.SetValeur(true,I+1);var i,lNb=this._options.liste.GetNbrElements();for(i=0;i<lNb;i++){var lChecked=this._options.Selection.GetValeur(i+1),lJInput=$('#'+this.GetIdInput(i).escapeJQ());if(lJInput.inputChecked()!==lChecked){lJInput.inputChecked(lChecked);}
lJInput=null;}
if(this._options.Selection)
this.callback.appel(this._options.Selection,this.InteractionUtilisateur);}};ObjetCheckBox.prototype.SetActif=function(AActif,I){this.Actif=AActif;GHtml.setDisabled(this.GetIdInput(I===null||I===undefined?0:I),!this.Actif);};ObjetCheckBox.prototype.setVisible=function(aVisible,I){GStyle.setVisible(GHtml.getParent(this.GetIdInput(I===null||I===undefined?0:I)),aVisible);GStyle.setVisible(GHtml.getParent(this.GetIdLibelle(I===null||I===undefined?0:I)),aVisible);};ObjetCheckBox.prototype.setLibelle=function(aLibelle,I){GHtml.setHtml(this.GetIdLibelle(I===null||I===undefined?0:I),aLibelle);};ObjetCheckBox.prototype.SetSelection=function(AValeur,I){this.SurSelection(false,I=I===null||I===undefined?0:I,AValeur);};ObjetCheckBox.prototype.SetSelectionParNumeroEtGenre=function(AValeur,ANumero,AGenre){this.SetSelection(AValeur,this._options.liste.GetIndiceParNumeroEtGenre(ANumero,AGenre));};ObjetCheckBox.prototype.setParametres_Affichage=function(aClass,aStyle,aStyleTable){this.setOptions_ObjetCheckBox({classCss:aClass,style:aStyle,styleTable:aStyleTable});};;
var EGenreConnexionActionErreur={Rien:0,ViderMdp:1,ResetSelection:2,ViderTout:3,Selection:4};var EGenreConnexionEvenement={Identifiant:0,FocusMdp:1,Connexion:2,Checkbox:3,RecupIdMdp:4};var EGenreConnexionPositionWrapperLien={Centrer:0,AlignementBas:1};MethodesObjet.heritagePrototype(ObjetConnexion,Identite);function ObjetConnexion(ANom,AIdent,APere,AEvenement){this.inheritedCreate(ANom,AIdent,APere,AEvenement);this.idWrapper=this.Nom+'_wrapper';this.idWrapperLien=this.Nom+'_wrapperlien';this.idConnect=this.Nom+'_connect';this.idWrapperConnect=this.Nom+'_wrapperconnect';this.idLoginBox=this.Nom+'_loginbox';this.idLoginInfo=this.Nom+'_logininfo';this.idImage=this.Nom+'_image';this.idCarte=this.Nom+'_carte';this.idBoutonCarte=this.Nom+'_boutoncarte';this.IdZoneIdent=this.Nom+'_identifiant';this.IdZonePwd=this.Nom+'_password';this.largeurMin=420;this.largeurMax=650;this.largeurLogo=100;this.taillePoliceTitre=18;this._bloquageRequeteAuthentification=false;this._lancementRequeteAuthentification=false;this.contenuIdent='';this.options={avecAnimation:true,titreEtablissement:'',sousTitre:'',urlLien:'http://www.index-education.fr',titreLien:'',texteLien:'',nomEspace:'',styleWrapperLien:'position:absolute;width:640px;height:585px;',classWrapperLien:'',positionWrapperLien:EGenreConnexionPositionWrapperLien.Centrer,styleLien:'position:absolute;bottom:2px;right:2px; text-decoration:none;'+GStyle.composeCouleurTexte(GCouleur.themeNeutre.sombre),classLien:'',avecOmbreConnexion:true,couleurConnexion:GCouleur.blanc,bordureConnexion:4,classImageEspace:'',genreFondImage:TypeArrierePlanAuthentification.neutre,classFondBg:'',classWrapperBg:'',imageFondBg:'',couleurFondBg:'transparent',classFondImage:'',classFondImageCarte:'',htmlLogo:'',modeJeton:false,modeDemo:true,avecModeConnexion:false,modeConnexionListe:null,modeConnexionSelection:null,avecRecupIdMdp:false,genreRecherche:3,genreSaisie:EGenreSaisie.Zone,largeurSaisie:'100%',infoWAIident:'',identListeNbLignes:10};this.traductions={texteModeConnexion:'',texteExplicatifModeConnexion:'',texteIdentifiant:'',texteTitreIdentifiant:'',texteExplicatifIdentifiant:'',texteMotdepasse:'',texteTitreMotdepasse:'',texteExplicatifMotdepasse:'',texteBouton:'',titreBouton:'',texteExplicatifValidation:'',texteRecupIdMdp:'',texteExplicatifRecupIdMdp:'',demoIdentifiant:'',demoMotdepasse:'',erreurTitre:null,erreurMessage:null,erreurBandeau:null};}
ObjetConnexion.prototype.free=function(){this.inherited('free');$('body').off('keyup',this.switchModeAccessible);};ObjetConnexion.prototype.getControleur=function(){return{getHint:function(aMessage){return this.instance[aMessage];}};};ObjetConnexion.prototype.SetDonnees=function(aListeRessources){this.idIdentification.SetDonnees(aListeRessources,null,true);};ObjetConnexion.prototype.SetParametres=function(options){$.extend(this.options,options);if(this.options.genreFondImage===TypeArrierePlanAuthentification.Photo){this.options.classFondImageCarte='';this.options.classFondBg=this.options.classFondImage;this.options.imageFondBg='';this.options.classFondImage='';this.options.couleurFondBg='transparent';this.options.classWrapperBg='';} else if(this.options.genreFondImage===TypeArrierePlanAuthentification.Rebus){this.options.imageFondBg='';this.options.couleurFondBg='transparent';this.options.htmlLogo='';this.options.classWrapperBg=this.options.classFondBg;} else if(this.options.genreFondImage===TypeArrierePlanAuthentification.Personnalise){this.options.classFondImage='';this.options.classFondImageCarte='';this.options.classFondBg='';this.options.couleurFondBg='transparent';this.options.couleurConnexion=GCouleur.blanc;this.options.htmlLogo='';this.options.classWrapperBg='';} else{this.options.classFondImage='';this.options.classFondImageCarte='';this.options.classFondBg=GImageConnexion.getClassFond();this.options.imageFondBg='';this.options.couleurFondBg='transparent';this.options.couleurConnexion=GCouleur.blanc;this.options.htmlLogo='';this.options.classWrapperBg='';}
if(this.options.avecModeConnexion){this.idCheckBox=new ObjetCheckBox(this.Nom+'.idCheckBox',null,this,this.evenementSurCheckBox);this.idCheckBox.setOptions_ObjetCheckBox({estRB:true,orientation:EGenreOrientationAffichage.Horizontal,liste:this.options.modeConnexionListe,Selection:this.options.modeConnexionSelection});}
this.idIdentification=new ObjetSaisie(this.Nom+'.idIdentification',null,this,this.evenementSurIdent);this.initialiserIdentification(this.idIdentification);this.IdPremierElement=this.idIdentification.getPremierElement();this.idBtnConnexion=this.Nom+'.idBtnConnexion';};ObjetConnexion.prototype.SetTraductions=function(aTraduc){$.extend(this.traductions,aTraduc);};ObjetConnexion.prototype.RecupererDonnees=function(){this.idIdentification.RecupererDonnees();if(this.options.classFondImageCarte!==''){$('#'+this.idBoutonCarte.escapeJQ()).on('click',{targetIds:[this.idBoutonCarte],toggleIds:[this.idImage,this.idCarte]},function(event){if($.inArray(event.target.id,event.data.targetIds)> -1){$('#'+event.data.toggleIds.join(', #').escapeJQ()).toggle();}
$(this).toggleClass('Image_BtnReponseRebus Image_BtnRetourRebus');});}
if(this.idCheckBox)
this.idCheckBox.RecupererDonnees();$('#'+this.IdZonePwd.escapeJQ()).on('focusin',{couleur:GCouleur.fenetre.texte},function(event){$(this).css('box-shadow','0 0 5px -1px '+event.data.couleur);}).on('focusout',{couleur:GCouleur.fenetre.texte},function(){$(this).css('box-shadow','');});$('#'+this.idBtnConnexion.escapeJQ()).on('mouseover focus',{aObjet:this},function(event){$(this).css(event.data.aObjet.styleBoutonHover);}).on('mouseout blur',{aObjet:this},function(event){$(this).css(event.data.aObjet.styleBouton);});$('body').on('keyup',this.switchModeAccessible);};ObjetConnexion.prototype.switchModeAccessible=function(event){if(event.which===ToucheClavier.Q&&event.originalEvent.ctrlKey&&event.originalEvent.shiftKey){GEtatUtilisateur.setModeAccessible(!IE.optionsEspaceLocal.getModeAccessible(GEtatUtilisateur.GenreEspace));setTimeout(function(){window.location.reload();},500);}};ObjetConnexion.prototype.validerIdentifiant=function(){this.idIdentification.SurValidation(this.indiceSelection);};ObjetConnexion.prototype.resetIdentifiant=function(){this.idIdentification.FocusSurPremierElement();this.idIdentification.Reset();this._lancementRequeteAuthentification=false;};ObjetConnexion.prototype.viderIdentifiant=function(){if(this.options.modeDemo) return;this.idIdentification.ViderContenu();this.idIdentification.SetFocus();this._lancementRequeteAuthentification=false;};ObjetConnexion.prototype.setFocusIdent=function(){this.idIdentification.SetFocus();};ObjetConnexion.prototype.setFocusMdp=function(){GHtml.setFocus(this.IdZonePwd);};ObjetConnexion.prototype.setFocusValid=function(){GHtml.setFocus(this.idBtnConnexion);};ObjetConnexion.prototype.viderMotDePasse=function(){if(this.options.modeDemo) return;GHtml.setValue(this.IdZonePwd,'');GHtml.setFocus(this.IdZonePwd);this._lancementRequeteAuthentification=false;};ObjetConnexion.prototype.viderTout=function(){this.viderIdentifiant();this.viderMotDePasse();};ObjetConnexion.prototype.setMessageErreur=function(aMessage){$.extend(this.traductions,aMessage);};ObjetConnexion.prototype.afficherFenetreErreur=function(aAction){var lAction=null;if(aAction===EGenreConnexionActionErreur.ViderMdp){lAction=this.viderMotDePasse;} else if(aAction===EGenreConnexionActionErreur.ViderTout){lAction=this.viderTout;} else if(aAction===EGenreConnexionActionErreur.ResetSelection||aAction===EGenreConnexionActionErreur.Selection){lAction=this.resetIdentifiant;}
GApplication.getMessage().Afficher(EGenreBoiteMessage.Information,this.traductions.erreurTitre,this.traductions.erreurMessage,this.traductions.erreurBandeau,this,lAction);};ObjetConnexion.prototype.erreurConnexion=function(aAction){if(this.options.avecAnimation&&$('#'+this.idConnect.escapeJQ()).length>0){var lObject=this;$('#'+this.idConnect.escapeJQ()).animate({left:'-=15'},{duration:100,easing:'linear'}).animate({left:'+=30'},{duration:200,easing:'linear'}).animate({left:'-=15'},{duration:100,easing:'linear'}).delay(500).queue(function(){lObject.afficherFenetreErreur(aAction);$(this).dequeue();});} else this.afficherFenetreErreur(aAction);};ObjetConnexion.prototype.centrer=function(){if(this.options.positionWrapperLien===EGenreConnexionPositionWrapperLien.Centrer) GPosition.centrer(this.idWrapperLien,this.idWrapper);else if(this.options.positionWrapperLien===EGenreConnexionPositionWrapperLien.AlignementBas){var lJqIdConnect=$('#'+this.idConnect.escapeJQ());$('#'+this.idWrapperLien.escapeJQ()).css('top',lJqIdConnect.position().top+lJqIdConnect.height());}};ObjetConnexion.prototype._echecChargementLogo=function(e){GStyle.setDisplay(e,false);};ObjetConnexion.prototype.surEvenementOnFocusZonePwd=function(){this.contenuIdent=GChaine.enleverEntites(this.idIdentification.GetContenu());this.callback.appel(EGenreConnexionEvenement.FocusMdp,{identifiant:this.idIdentification.GetContenu()});};ObjetConnexion.prototype.evenementSurIdent=function(aGenreEvenement,aRessource,aIndice,ANumeroGenreRecherche,ANomRessource){this.contenuIdent=GChaine.enleverEntites(ANomRessource);if(aGenreEvenement!==EGenreEvenementObjetSaisie.selection) return;if(this.options.genreSaisie===EGenreSaisie.Liste) this.indiceSelection=aIndice;this.callback.appel(EGenreConnexionEvenement.Identifiant,{genreEvenement:aGenreEvenement,ressource:aRessource,indice:aIndice,numeroRecherche:ANumeroGenreRecherche,nomRessource:ANomRessource});};ObjetConnexion.prototype.evenementSurBtnConnexion=function(){if(this._bloquageRequeteAuthentification) return;if(this.options.modeDemo) this.contenuIdent=this.traductions.demoIdentifiant;if(this.contenuIdent!==''&&GHtml.getElement(this.IdZonePwd).value!==''){this._lancementRequeteAuthentification=true;$('body').off('keyup',this.switchModeAccessible);this.callback.appel(EGenreConnexionEvenement.Connexion,{identifiant:this.contenuIdent,motdepasse:GHtml.getElement(this.IdZonePwd).value});this._bloquageRequeteAuthentification=true;}};ObjetConnexion.prototype.evenementSurCheckBox=function(aSelection){this.callback.appel(EGenreConnexionEvenement.Checkbox,{selection:aSelection});};ObjetConnexion.prototype.evenementSurRecup=function(){this.callback.appel(EGenreConnexionEvenement.RecupIdMdp,null);};ObjetConnexion.prototype.debloquerAuthentification=function(){this._bloquageRequeteAuthentification=false;};ObjetConnexion.prototype.initialiserIdentification=function(aInstance){aInstance.SetGenre(this.options.genreRecherche);aInstance.SetParametres(this.options.genreSaisie,this.options.largeurSaisie,this.options.genreSaisie===EGenreSaisie.Liste,false,null,19);aInstance.setOptions_ObjetSaisie({labelWAIZone:this.options.infoWAIident,labelWAIEdit:this.traductions.texteTitreIdentifiant,placeHolder:this.traductions.texteIdentifiant,desactiverAideSaisie:true});aInstance.setNbrLignes(this.options.identListeNbLignes);};ObjetConnexion.prototype.initialiserBtnConnexion=function(aInstance){aInstance.SetParametres_BoutonNormal([this.traductions.texteBouton],'100%',null,null,true,this.traductions.titreBouton);};ObjetConnexion.prototype.ConstruireAffichage=function(){var H=[];var lAnneeScol=this.options.sousTitre;var lLargeurLogo=(GParametres.avecLogoConnexion?this.largeurLogo+5:0);var lInfo=' Mode accessible '+(IE.optionsEspaceLocal.getModeAccessible(GEtatUtilisateur.GenreEspace)?'activé.':'desactivé.');H.push('<div class="',this.options.classFondBg,'" style="position:absolute;z-index:-20;width:100%;height:100%;'+(this.options.imageFondBg?'background-image:url(\''+this.options.imageFondBg+'\');background-size:cover;background-position:center center;':'')+'"></div>');H.push('<div id="',this.idWrapper,'" class="" style="text-align:center;position:absolute;height:100%;min-height:255px;width:100%;">');H.push('<div id="WAIModeAccessible" class="wai_hidden" role="command">cliquer CTRL+MAJ+Q pour basculer le mode accessible. ',lInfo,'</div>');H.push('<div '+GObjetWAI.composeRole(EGenreRole.Presentation)+' style="position:relative;width: 100%; height:35px;margin-bottom:-35px;'+GStyle.composeCouleurTexte(GCouleur.noir)+GStyle.composeTaillePolice(20)+'box-shadow:0 2px 10px -6px '+GCouleur.noir+';z-index:101;" class="Texte18 FondBlanc">');H.push('<div style="width:0;height:100%;" class="InlineBlock AlignementMilieuVertical"></div>');H.push('<div style="width: 99.5%;" class="InlineBlock AlignementMilieu AlignementMilieuVertical">'+GChaine.Insecable(GParametres.NomEtablissement)+'</div>');H.push('<div style="position:absolute;top:0;left:0;height:100%;" class="NoWrap">');H.push('<div style="width:0;height:100%;" class="InlineBlock AlignementMilieuVertical"></div>');H.push('<span class="InlineBlock ',this.options.classImageEspace,' AlignementMilieuVertical" style="background-color:',GCouleur.noir,';margin:0 10px 0 3px;">&nbsp;</span><span class="AlignementMilieuVertical">'+GChaine.Insecable(GParametres.NomEspace)+'</span>');H.push('</div>');H.push('</div>');H.push('<div class="InlineBlock AlignementMilieuVertical" style="height:100%;"></div>');H.push('<div id="',this.idWrapperConnect,'" class="InlineBlock AlignementMilieuVertical ',this.options.classWrapperBg,'" style="width:100%;">');H.push('<div id="',this.idConnect,'" class="InlineBlock" style="position:relative;padding-bottom:22px;margin-top:40px;',(this.options.avecOmbreConnexion?'box-shadow:5px 5px 10px -8px '+GCouleur.noir+';':''),'">');H.push('<div class="InlineBlock" style="position:absolute;top:0;left:0;right:0;bottom:0;background-color:#ffffff;'+GStyle.composeOpacite(0.7)+'">&nbsp;</div>');H.push('<div class="InlineBlock Texte10" style="text-align:right;padding:5px;margin:',this.options.bordureConnexion,'px;background-color:transparent;">');H.push('<div class="InlineBlock" style="position:relative;text-align:left;margin:0 0 3px;">');if(GParametres.avecLogoConnexion) H.push('<div class="InlineBlock AlignementMilieuVertical" style="width:'+this.largeurLogo+'px;text-align:center;margin-right:9px;"><img src="data:image/png;base64,',GParametres.logo,'" alt="" style="max-width:'+this.largeurLogo+'px;max-height:'+this.largeurLogo+'px;" onload="if('+this.Nom+' && '+this.Nom+'.centrer) '+this.Nom+'.centrer();" onerror="'+this.Nom+'._echecChargementLogo (this)" /></div>');H.push(this.ConstruirePage());H.push('</div>');H.push('<a href="',this.options.urlLien,'" title="',this.options.titreLien,'" target="_blank" class="',this.options.classLien,'" style="',this.options.styleLien,'">',this.options.texteLien,'</a></div>');H.push('</div>');if(this.options.classFondImage) H.push('<div id="',this.idImage,'" class="',this.options.classFondImage,'" style="z-index:-15;width:940px;height:400px;margin:20px auto;',(this.options.classFondImage?'':''),'"></div>');if(this.options.classFondImage&&this.options.classFondImageCarte){H.push('<div id="',this.idCarte,'" class="',this.options.classFondImageCarte,'" style="z-index:-15;width:940px;height:400px;margin:20px auto 0;display:none;"></div>');H.push('<div id="',this.idBoutonCarte,'" class="Image_BtnReponseRebus" style="z-index:-15;width:120px;height:35px;margin:20px auto;"></div>');}
H.push('</div>');if(this.options.htmlLogo) H.push(this.options.htmlLogo);H.push('</div>');return H.join('');};ObjetConnexion.prototype.ConstruirePage=function(){var H=[];var lInput='';var lHint='';H.push('<div id="',this.idLoginBox,'" class="InlineBlock AlignementMilieuVertical" style="color:',GCouleur.themeNeutre.sombre,';">');H.push('<table id="',this.idLoginInfo,'" class="Texte10 EspaceHaut" style="width:255px;'+GStyle.composeCouleurTexte(GCouleur.themeNeutre.sombre)+'margin:0 auto;text-align:left;position:relative;padding:0;" border="0" cellspacing="0" cellpadding="0" '+GObjetWAI.composeRole(EGenreRole.Form)+'>');if(!this.options.modeJeton){if(this.options.avecModeConnexion){this.messageModeConnexion=this.traductions.texteExplicatifModeConnexion;this.idCheckBox.setOptions_ObjetCheckBox({labelGroup:this.traductions.texteModeConnexion});this.idCheckBox.setParametres_Affichage('GrandEspaceDroit');H.push('<tr><td class="Gras EspaceDroit" style="" colspan="2"><label for="'+this.idCheckBox.Nom+'"> ',this.traductions.texteModeConnexion,'</label></td></tr>');H.push('<tr><td id="',this.idCheckBox.Nom,'" tabindex="-1"  class="">',this.idCheckBox.ConstruireAffichage(),'</td><td class="AideConnexion" ie-hint="getHint(\'messageModeConnexion\')"><div class="Image_i_information">&nbsp;</div></td></tr>');}
H.push('<tr><td>&nbsp;</td><td>&nbsp;</td></tr>');var lStyle='width:100%;padding:3px'+';'+GStyle.composeBordureArrondi(3)+GStyle.composeCouleurBordure(GCouleur.grisClair)+GStyle.composeHeight(21);if(this.options.modeDemo)
lInput='<td class="Gras"><input name="'+this.IdZoneIdent+'" id="'+this.IdZoneIdent+'" type="text"  value="'+this.traductions.demoIdentifiant+'"title="'+this.traductions.texteTitreIdentifiant+'" class="CelluleTexte Texte10 FondGrisClair" style="'+lStyle+'" tabindex="0" '+' readonly></td>';else lInput='<td class="" id="'+this.idIdentification.Nom+'" title="'+this.traductions.texteTitreIdentifiant+'">'+this.idIdentification.ConstruireAffichage()+'</td>';lHint='';if(this.traductions.texteExplicatifIdentifiant!==''){this.messageIdentifiant=this.traductions.texteExplicatifIdentifiant;lHint=' ie-hint="getHint(\'messageIdentifiant\')"';}
H.push('<tr>');H.push('<td class="Gras EspaceDroit" style="" colspan="2"><label for="'+this.IdZoneIdent+'" >'+this.traductions.texteIdentifiant+'</label></td>');H.push('</tr>');H.push('<tr>');H.push(lInput);H.push('<td class="AideConnexion"',lHint,'>');if(lHint!=='') H.push('<div class="Image_i_information">&nbsp;</div>');H.push('</td>');H.push('</tr>');H.push('<tr><td>&nbsp;</td><td>&nbsp;</td></tr>');lInput=this.options.modeDemo?'<input name="'+this.IdZonePwd+'" id="'+this.IdZonePwd+'" type="password" value="'+this.traductions.demoMotdepasse+'" title="'+this.traductions.texteTitreMotdepasse+'" class="Texte10 FondGrisClair" style="'+lStyle+'" tabindex="0" '+' onkeyup="if (GNavigateur.IsToucheRetourChariot ()) GHtml.setFocus('+this.idBtnConnexion.AvecQuotes()+');" readonly />':'<input name="'+this.IdZonePwd+'" id="'+this.IdZonePwd+'" type="password" title="'+this.traductions.texteTitreMotdepasse+'" class="Texte10" style="'+lStyle+'" tabindex="0" '+' onfocus="'+this.Nom+'.surEvenementOnFocusZonePwd()" onkeyup="if (!IE.optionsEspaceLocal.getModeAccessible(GEtatUtilisateur.GenreEspace) && GNavigateur.IsToucheRetourChariot () && !'+this.Nom+'._lancementRequeteAuthentification) '+this.Nom+'.evenementSurBtnConnexion()'+';" placeholder="'+this.traductions.texteMotdepasse+'" />';lHint='';if(this.traductions.texteExplicatifMotdepasse!==''){this.messagePwd=this.traductions.texteExplicatifMotdepasse;lHint=' ie-hint="getHint(\'messagePwd\')"';}
H.push('<tr>');H.push('<td class="Gras EspaceDroit" style="" colspan="2"><label for="'+this.IdZonePwd+'">'+this.traductions.texteMotdepasse+'</label></td>');H.push('</tr>');H.push('<tr>');H.push('<td class="">');H.push(lInput);H.push('</td>');H.push('<td class="AideConnexion"',lHint,'>');if(lHint!=='') H.push('<div class="Image_i_information">&nbsp;</div>');H.push('</td>');H.push('</tr>');H.push('<tr><td>&nbsp;</td><td>&nbsp;</td></tr>');lHint='';if(!this.options.modeDemo&&this.traductions.texteExplicatifValidation!==''){this.messageValidation=(this.options.modeDemo?'':this.traductions.texteExplicatifValidation);lHint=' ie-hint="getHint(\'messageValidation\')"';}
H.push('<tr>');this.styleBouton={color:GCouleur.themeNeutre.sombre,background:GStyle.composeDegradeVertical(GCouleur.blanc,GCouleur.grisTresClair.fond).replace(/^.*background\s?:(.*);$/i,'$1'),filter:GStyle.composeDegradeVertical(GCouleur.blanc,GCouleur.grisTresClair.fond).replace(/^.*filter\s?:(.*);$/i,'$1')};this.styleBoutonHover={color:GCouleur.themeNeutre.sombre,background:GStyle.composeDegradeVertical(GCouleur.grisTresClair.fond,GCouleur.blanc).replace(/^.*background\s?:(.*);$/i,'$1'),filter:GStyle.composeDegradeVertical(GCouleur.grisTresClair.fond,GCouleur.blanc).replace(/^.*filter\s?:(.*);$/i,'$1')};H.push('<td class="" style="">','<input type="button"  id="'+this.idBtnConnexion+'"','title=\''+this.traductions.titreBouton+'\'','class="Texte11 AvecMain" style="'+'padding:2px 10px;margin:0 auto;'+GStyle.composeCouleurTexte(GCouleur.themeNeutre.sombre)+'font-weight:bold;'+GStyle.composeBordureArrondi(5)+GStyle.composeCouleurBordure(GCouleur.grisClair)+GStyle.composeDegradeVertical(GCouleur.blanc,GCouleur.grisTresClair.fond)+'box-shadow:5px 5px 5px -3px '+GCouleur.grisClair+';'+GStyle.composeTransitions('background-color',0.25)+'"','onkeydown="if(GNavigateur.IsToucheRetourChariot()){'+this.Nom+'.evenementSurBtnConnexion();}"','onclick="'+this.Nom+'.evenementSurBtnConnexion()"','value="'+this.traductions.texteBouton+'"','/>','</td>');H.push('<td class="AlignementMilieuVertical AideConnexion"',lHint,'>');if(lHint!=='') H.push('<div class="Image_i_information">&nbsp;</div>');H.push('</td>');H.push('</tr>');if(this.options.avecRecupIdMdp){H.push('<tr><td>&nbsp;</td><td>&nbsp;</td></tr>');lHint='';if(this.traductions.texteExplicatifRecupIdMdp!==''){this.messageRecupIdMdp=this.traductions.texteExplicatifRecupIdMdp;lHint=' ie-hint="getHint(\'messageRecupIdMdp\')"';}
H.push('<tr><td class="Italique AvecMain SouligneSurvol" style="color:'+GCouleur.texte+';"><span onclick="',this.Nom,'.evenementSurRecup();">',this.traductions.texteRecupIdMdp,'</span></td><td class="AideConnexion"',lHint,'>');if(lHint!=='') H.push('<div class="Image_i_information">&nbsp;</div>');H.push('</td></tr>');}}
H.push('</table>');H.push('</div>');return H.join('');};;
var GImageConnexion=new ObjetImageConnexion();function ObjetImageConnexion(){}
ObjetImageConnexion.prototype.getClassImage=function(){return'';};ObjetImageConnexion.prototype.getObjetImagePronote=function(){var lImages=[
[{classeImage:'PhotoFond1',couleurConnexion:'#ffffff',classeLogo:'Image_LogoPhotoFond',lienLogo:'http://wimipix.com'},{classeImage:'PhotoFond2',couleurConnexion:'#ffffff',classeLogo:'Image_LogoPhotoFond',lienLogo:'http://wimipix.com'},{classeImage:'PhotoFond3',couleurConnexion:'#ffffff',classeLogo:'Image_LogoPhotoFond',lienLogo:'http://wimipix.com'},{classeImage:'PhotoFond4',couleurConnexion:'#ffffff',classeLogo:'Image_LogoPhotoFond',lienLogo:'http://wimipix.com'},{classeImage:'PhotoFond5',couleurConnexion:'#ffffff',classeLogo:'Image_LogoPhotoFond',lienLogo:'http://wimipix.com'},{classeImage:'PhotoFond6',couleurConnexion:'#ffffff',classeLogo:'Image_LogoPhotoFond',lienLogo:'http://wimipix.com'}],[{classeImage:'RebusFond1',classeImageCarte:'RebusFond1Rep',classeFond:'BG_Rebus',couleurConnexion:'#ffffff'},{classeImage:'RebusFond2',classeImageCarte:'RebusFond2Rep',classeFond:'BG_Rebus',couleurConnexion:'#ffffff'},{classeImage:'RebusFond3',classeImageCarte:'RebusFond3Rep',classeFond:'BG_Rebus',couleurConnexion:'#ffffff'},{classeImage:'RebusFond4',classeImageCarte:'RebusFond4Rep',classeFond:'BG_Rebus',couleurConnexion:'#ffffff'},{classeImage:'RebusFond5',classeImageCarte:'RebusFond5Rep',classeFond:'BG_Rebus',couleurConnexion:'#ffffff'},{classeImage:'RebusFond6',classeImageCarte:'RebusFond6Rep',classeFond:'BG_Rebus',couleurConnexion:'#ffffff'},{classeImage:'RebusFond7',classeImageCarte:'RebusFond7Rep',classeFond:'BG_Rebus',couleurConnexion:'#ffffff'},{classeImage:'RebusFond8',classeImageCarte:'RebusFond8Rep',classeFond:'BG_Rebus',couleurConnexion:'#ffffff'},{classeImage:'RebusFond9',classeImageCarte:'RebusFond9Rep',classeFond:'BG_Rebus',couleurConnexion:'#ffffff'},{classeImage:'RebusFond10',classeImageCarte:'RebusFond10Rep',classeFond:'BG_Rebus',couleurConnexion:'#ffffff'},{classeImage:'RebusFond11',classeImageCarte:'RebusFond11Rep',classeFond:'BG_Rebus',couleurConnexion:'#ffffff'},{classeImage:'RebusFond12',classeImageCarte:'RebusFond12Rep',classeFond:'BG_Rebus',couleurConnexion:'#ffffff'}],[{}],[{}]
];var lDate=new Date();var lIndice=GParametres.genreImageConnexion===TypeArrierePlanAuthentification.Photo?Math.floor(lDate.getTime()/1000):GParametres.genreImageConnexion===TypeArrierePlanAuthentification.Rebus?lDate.getMonth():0;var lImagesMois=lImages[GParametres.genreImageConnexion];var lResult=lImagesMois[lIndice%lImagesMois.length];if(GParametres.genreImageConnexion===TypeArrierePlanAuthentification.Rebus&&lDate.getDate()<15) lResult.classeImageCarte='';return lResult;};ObjetImageConnexion.prototype.getClassFond=function(){return'Image_Connexion_Fond';};;
var EGenreErreurAcces={Aucune:0,Identification:1,Autorisation:2,ConnexionClasse:3,AucuneRessource:4,Connexion:5,PersonnalisationMDP:6};;
var TValidationMotDePasse=(function(){function _construireLigneValidateur(aEchec,aTraduction,aOptions){var H=[];H.push('<div class="NoWrap',aOptions.avecEspace?' PetitEspaceBas':'','">');if(aEchec!==undefined){H.push('<div class="InlineBlock AlignementMilieuVertical ',!aEchec?'Image_CocheVerte':'Image_CocheRouge','"></div>');}
else{H.push('<div class="InlineBlock AlignementMilieuVertical" style="',GStyle.composeWidth(16),'"></div>');}
H.push('<div class="InlineBlock AlignementMilieuVertical PetitEspaceGauche">',aTraduction,'</div>');H.push('</div>');return H.join('');}
return{construire:function(aErreursMDP,aOptions){var H=[],lErreursMDP,lOptions={avecEspace:true};$.extend(lOptions,aOptions);if(aErreursMDP){lErreursMDP={erreurTailleMDP:false,reglesNonRespectes:new TypeEnsembleNombre()};$.extend(lErreursMDP,aErreursMDP);}
H.push('<div>');H.push('<div class="',lOptions.avecEspace?'EspaceBas':'',' Gras">',GTraductions.getValeur('SaisieMotDePasse.validation.titre')+' :','</div>');H.push(_construireLigneValidateur(lErreursMDP?lErreursMDP.erreurTailleMDP:undefined,GChaine.Format(GTraductions.getValeur('SaisieMotDePasse.validation.longueur'),[GEtatUtilisateur.reglesSaisieMotDePasse.min,GEtatUtilisateur.reglesSaisieMotDePasse.max]),lOptions));if(GEtatUtilisateur.reglesSaisieMotDePasse.regles.contains(TypeOptionGenerationMotDePasse.OGMDP_AvecAuMoinsUnChiffre)){H.push(_construireLigneValidateur(lErreursMDP?lErreursMDP.reglesNonRespectes.contains(TypeOptionGenerationMotDePasse.OGMDP_AvecAuMoinsUnChiffre):undefined,GTraductions.getValeur('SaisieMotDePasse.validation.chiffre'),lOptions));}
if(GEtatUtilisateur.reglesSaisieMotDePasse.regles.contains(TypeOptionGenerationMotDePasse.OGMDP_AvecAuMoinsUneLettre)){H.push(_construireLigneValidateur(lErreursMDP?lErreursMDP.reglesNonRespectes.contains(TypeOptionGenerationMotDePasse.OGMDP_AvecAuMoinsUneLettre):undefined,GTraductions.getValeur('SaisieMotDePasse.validation.lettre'),lOptions));}
if(GEtatUtilisateur.reglesSaisieMotDePasse.regles.contains(TypeOptionGenerationMotDePasse.OGMDP_AvecAuMoinsUnCaractereSpecial)){H.push(_construireLigneValidateur(lErreursMDP?lErreursMDP.reglesNonRespectes.contains(TypeOptionGenerationMotDePasse.OGMDP_AvecAuMoinsUnCaractereSpecial):undefined,GTraductions.getValeur('SaisieMotDePasse.validation.special'),lOptions));}
if(GEtatUtilisateur.reglesSaisieMotDePasse.regles.contains(TypeOptionGenerationMotDePasse.OGMDP_AvecMelangeMinusculeMajuscule)){H.push(_construireLigneValidateur(lErreursMDP?lErreursMDP.reglesNonRespectes.contains(TypeOptionGenerationMotDePasse.OGMDP_AvecMelangeMinusculeMajuscule):undefined,GTraductions.getValeur('SaisieMotDePasse.validation.MajMin'),lOptions));}
if(GEtatUtilisateur.reglesSaisieMotDePasse.regles.contains(TypeOptionGenerationMotDePasse.OGMDP_AvecControleIdentifiantDifferent)){H.push(_construireLigneValidateur(lErreursMDP?lErreursMDP.reglesNonRespectes.contains(TypeOptionGenerationMotDePasse.OGMDP_AvecControleIdentifiantDifferent):undefined,GTraductions.getValeur('SaisieMotDePasse.validation.login'),lOptions));}
H.push('</div>');return H.join('');}};}());;
function ObjetRequeteRecupIdMDP(aPere,aEvenementSurReussite,aEvenementSurEchec){this.inheritedCreate(aPere,aEvenementSurReussite,aEvenementSurEchec);}
IE.Requetes.inscrire('RecupererInfosConnexion',ObjetRequeteRecupIdMDP,_ObjetRequeteXmlConsultationPN);ObjetRequeteRecupIdMDP.prototype.lancerRequete=function(aObjet){var lXml=this.XML;var lEtape=aObjet.etape;delete(aObjet.etape);lXml.CreerVariable(null,'etape',EGenreType.Cardinal,lEtape);lXml.CreerVariable(null,'donnee',EGenreType.String,lEtape===3?GCryptage.cryptageRSA.encrypter($.toJSON(aObjet)):$.toJSON(aObjet));this.appelAsynchroneConsultation({messageDetail:GTraductions.getValeur('EnregistrementEnCours')});};ObjetRequeteRecupIdMDP.prototype.actionApresRequete=function(aXml){var lResult={};lResult.etape=aXml.GetVariable(null,'Etape');switch(lResult.etape){case 1:lResult.mailEnvoye=aXml.GetVariable(null,'MailEnvoye');lResult.erreurSMTP=aXml.GetVariable(null,'ErreurSMTP');var lNoeudUtilisateurs=aXml.GetCategorie(null,'ListeUtilisateurs');lResult.listeUtilisateurs=aXml.GetListeElements(lNoeudUtilisateurs,'Utilisateur',false);new ObjetDeserialiser().reglesSaisieMotDePasse(this.JSONReponse);break;case 2:lResult.estEchec=aXml.GetVariable(null,'EstEchec');break;case 3:if(this.JSONReponse.erreurMDP){lResult.erreurMDP=this.JSONReponse.erreurMDP;new ObjetDeserialiser().reglesSaisieMotDePasse(this.JSONReponse);}
break;}
this.callbackReussite.appel(lResult);};;
IE.Invocateur.abonner(IE.Invocateur.events.modificationThemeCouleur,function(){GHtml.modifierRegleCss(".ObjetFenetreRecupIdMdp_Stage_Actif",'color',GCouleur.texte);GHtml.modifierRegleCss(".ObjetFenetreRecupIdMdp_Stage_Actif",'border-color',GCouleur.texte);GHtml.modifierRegleCss(".ObjetFenetreRecupIdMdp_Stage_Actif",'box-shadow','0 0 5px 1px '+GCouleur.texte);GHtml.modifierRegleCss(".ObjetFenetreRecupIdMdp_Stage_Actif",'border-top-color',GCouleur.bordure);GHtml.modifierRegleCss(".ObjetFenetreRecupIdMdp_Stage_Actif",'border-left-color',GCouleur.bordure);GHtml.modifierRegleCss(".ObjetFenetreRecupIdMdp_Stage_Inactif",'color',GCouleur.intermediaire);GHtml.modifierRegleCss(".ObjetFenetreRecupIdMdp_Stage_Inactif",'border-color',GCouleur.bordure);GHtml.modifierRegleCss(".ObjetFenetreRecupIdMdp_Stage_Inactif",'border-top-color',GCouleur.texte);GHtml.modifierRegleCss(".ObjetFenetreRecupIdMdp_Stage_Inactif",'border-left-color',GCouleur.texte);GHtml.modifierRegleCss('.ObjetFenetreRecupIdMdp_table input[type="text"]:focus','box-shadow','0 0 5px 1px '+GCouleur.texte);GHtml.modifierRegleCss('.ObjetFenetreRecupIdMdp_table input[type="password"]:focus','box-shadow','0 0 5px 1px '+GCouleur.texte);});MethodesObjet.heritagePrototype(ObjetFenetreRecupIdMDP,ObjetFenetre);function ObjetFenetreRecupIdMDP(ANom,AIdent,APere,AEvenement){this.inheritedCreate(ANom,AIdent,APere,AEvenement);this.stage=1;this.idWrapper=this.Nom+'_wrapper';this.idHeader=this.Nom+'_header';this.idStage=this.Nom+'_stage';this.idStage1=this.idStage+'_1';this.idStage2=this.idStage+'_2';this.idStage3=this.idStage+'_3';this.idCourriel=this.Nom+'_courriel';this.idCode=this.Nom+'_codesec';this.idMdp=this.Nom+'_mdp';this.idMdpbis=this.Nom+'_mdpbis';this.idValidationMdp=this.Nom+'_validMdp';this.classTable='ObjetFenetreRecupIdMdp_table';this.classTrDisabled='ObjetFenetreRecupIdMdp_tr_disabled';this.classStage='ObjetFenetreRecupIdMdp_Stage';this.classStageActif='ObjetFenetreRecupIdMdp_Stage_Actif';this.classStageInactif='ObjetFenetreRecupIdMdp_Stage_Inactif';this.texteHeader=GTraductions.getValeur('fenetreRecupIdMDP.header');this.texteStage1=GTraductions.getValeur('fenetreRecupIdMDP.stage1');this.texteStage1_bis=GTraductions.getValeur('fenetreRecupIdMDP.stage1_bis');this.texteStage2=GTraductions.getValeur('fenetreRecupIdMDP.stage2');this.texteStage3=GTraductions.getValeur('fenetreRecupIdMDP.stage3');this.texteStage=GTraductions.getValeur('fenetreRecupIdMDP.stage');this.texteStage2_ok=GTraductions.getValeur('fenetreRecupIdMDP.stage2_ok');this.texteStage2_ko_multi=GTraductions.getValeur('fenetreRecupIdMDP.stage2_ko_multi');this.texteStage2_ko_zero=GTraductions.getValeur('fenetreRecupIdMDP.stage2_ko_zero');this.texteStage3_ok=GTraductions.getValeur('fenetreRecupIdMDP.stage3_ok');this.texteStage3_ko=GTraductions.getValeur('fenetreRecupIdMDP.stage3_ko');this.texteMailOk=GTraductions.getValeur('fenetreRecupIdMDP.mailOk');this.texteMdp=GTraductions.getValeur('fenetreRecupIdMDP.motdepasse');this.texteConfirmation=GTraductions.getValeur('fenetreRecupIdMDP.confirmation');this.texteTerminer=GTraductions.getValeur('fenetreRecupIdMDP.terminer');this.setOptionsFenetre({avecCroixFermeture:false});}
ObjetFenetreRecupIdMDP.prototype.ConstruireInstances=function(){this.idBouton=this.Add(window.ObjetBouton,this.evenementBouton,this.initialiserBouton);};ObjetFenetreRecupIdMDP.prototype.initialiserBouton=function(aInstance){aInstance.SetParametres_BoutonNormal([GTraductions.getValeur('Valider')],'75px',null,false,false);};ObjetFenetreRecupIdMDP.prototype.ComposeContenu=function(){var lHtml=[];lHtml.push('<div style="position:relative;">','<p class="Texte12" style="margin:0 0 10px 0;">',this.texteHeader,'</p>','<table class="AlignementHaut AlignementGauche Texte12 '+this.classTable+'" style="height:100%;width:630px;margin-right:75px;">','<tr>','<td>','<span id="',this.idStage1,'" class="Texte16 '+this.classStage+' '+this.classStageActif+'">1</span>','</td>','<td>','<strong>'+this.texteStage+' 1 : </strong>','</td>','<td>','<strong>'+this.texteStage1+'</strong> '+this.texteStage1_bis+'<br />','<span><input name="courriel" id="'+this.idCourriel+'" type="text" '+' /><div id="'+this.idCourriel+'_valide" class="InlineBlock GrandEspaceGauche">&nbsp;&nbsp;&nbsp;</div></span>','</td>','</tr>','<tr class="',this.classTrDisabled,'">','<td>','<span id="',this.idStage2,'" class="Texte16 '+this.classStage+' '+this.classStageInactif+'">2</span>','</td>','<td>','<strong>'+this.texteStage+' 2 : </strong>','</td>','<td>','<strong>'+this.texteStage2+'</strong><br />','<span><input id="'+this.idCode+'" type="text" '+' disabled="disabled"/><div id="'+this.idCode+'_valide" class="InlineBlock GrandEspaceGauche">&nbsp;&nbsp;&nbsp;</div></span>','</td>','</tr>','<tr class="',this.classTrDisabled,'">','<td>','<span id="',this.idStage3,'" class="Texte16 '+this.classStage+' '+this.classStageInactif+'">3</span>','</td>','<td>','<strong>'+this.texteStage+' 3 : </strong>','</td>','<td>','<div class="InlineBlock AlignementHaut" style="width:270px;">','<span style="position:relative"><strong>'+this.texteStage3+'</strong></span><br />','<span><span>'+this.texteMdp+'</span><input id="'+this.idMdp+'" type="password" '+' disabled="disabled" /></span>','<br />','<span><span>'+this.texteConfirmation+'</span><input id="'+this.idMdpbis+'" type="password" '+' disabled="disabled"/><div id="'+this.idMdpbis+'_valide" class="InlineBlock GrandEspaceGauche">&nbsp;&nbsp;&nbsp;</div></span>','<br />','</div>','<div id="',this.idValidationMdp,'" class="Texte9 InlineBlock AlignementHaut" style="line-height:15px;margin-top:25px;"></div>','</td>','</tr>','</table>','<div id="',this.GetInstance(this.idBouton).Nom,'" style="position:absolute;top:0;right:0;"></div>','</div>');return lHtml.join('');};ObjetFenetreRecupIdMDP.prototype.evenementBouton=function(){var lData={};var lEnvoyer=false;lData.etape=this.stage;if(this.stage===1){lData.courriel=$('#'+this.idCourriel.escapeJQ()).val();lEnvoyer=true;Invocateur.desabonner(Invocateur.events.autorisationRechargementPage);Invocateur.abonner(Invocateur.events.autorisationRechargementPage,function(aData){alert(GTraductions.getValeur('fenetreRecupIdMDP.header'));aData.message=GTraductions.getValeur('fenetreRecupIdMDP.header');});} else if(this.stage===2){this.actionSurRecupererDonnees();} else if(this.stage===3){lData.codeSecurite=$('#'+this.idCode.escapeJQ()).val();lData.iv=GApplication.getCommunication().ivAES;lData.mdp=forge.util.encodeUtf8($('#'+this.idMdp.escapeJQ()).val().trim());lEnvoyer=true;} else{location.reload();}
if(lEnvoyer) new ObjetRequeteRecupIdMDP(this,this.actionSurRecupererDonnees,this.actionSurErreur).lancerRequete(lData);};ObjetFenetreRecupIdMDP.prototype.SurValidation=function(){if(this.stage===1){this.Fermer();} else location.reload();};ObjetFenetreRecupIdMDP.prototype.actionSurErreur=function(aMessage){var lMessage=aMessage&&(aMessage.length>0)?aMessage:GTraductions.getValeur('requete.erreur');try{GApplication.getMessage().Afficher(EGenreBoiteMessage.Information,null,lMessage);}
catch(e){;}
$('.'+this.classTable+' tr:eq(0)').addClass(this.classTrDisabled).find('input').attr('disabled',true);$('.'+this.classTable+' tr:eq(1)').addClass(this.classTrDisabled).find('input').attr('disabled',true);$('.'+this.classTable+' tr:eq(2)').addClass(this.classTrDisabled).find('input').attr('disabled',true);$('#'+this.idMdp.escapeJQ()).val('');$('#'+this.idMdpbis.escapeJQ()).val('');$('#'+this.GetInstance(this.idBouton).Nom.escapeJQ()).css('display','none');Invocateur.desabonner(Invocateur.events.autorisationRechargementPage);this.SetListeBoutons([GTraductions.getValeur('principal.fermer')]);this.SetBoutonActif(0,true);};ObjetFenetreRecupIdMDP.prototype.actionSurRecupererDonnees=function(aResult){if(GApplication.getModeExclusif()){return;}
this.erreurSMTP=aResult&&aResult.erreurSMTP;if(this.stage===1){if(this.erreurSMTP){GApplication.getMessage().Afficher(EGenreBoiteMessage.Information,'',GTraductions.getValeur('fenetreRecupIdMDP.erreurSMTP'));Invocateur.desabonner(Invocateur.events.autorisationRechargementPage);this.Fermer();} else if(aResult.mailEnvoye){$('#'+this.idStage1.escapeJQ()).removeClass(this.classStageActif).addClass(this.classStageInactif);$('#'+this.idStage2.escapeJQ()).removeClass(this.classStageInactif).addClass(this.classStageActif);$('.'+this.classTable+' tr:eq(0)').addClass(this.classTrDisabled).find('input').attr('disabled',true);$('.'+this.classTable+' tr:eq(1)').removeClass(this.classTrDisabled).find('input').attr('disabled',false);this.GetInstance(this.idBouton).SetLibelle(GTraductions.getValeur('Valider'),false);this.SetBoutonActif(0,false);this.stage=2;GApplication.getMessage().Afficher(EGenreBoiteMessage.Information,null,this.texteMailOk,null,this,function(){$('#'+this.GetInstance(this.idBouton).Nom.escapeJQ()).animate({top:$('#'+this.idCode.escapeJQ()).position().top+5},500);$('#'+this.idCode.escapeJQ()).focus();});} else if(aResult.listeUtilisateurs&&aResult.listeUtilisateurs.GetNbrElements()>1){$('.'+this.classTable+' tr:eq(0)').addClass(this.classTrDisabled).find('input').attr('disabled',true);$('#'+this.GetInstance(this.idBouton).Nom.escapeJQ()).css('display','none');this.SetListeBoutons([GTraductions.getValeur('Fermer')]);this.SetBoutonActif(0,true);this.stage= -1;} else{GApplication.getMessage().Afficher(EGenreBoiteMessage.Information,'',this.texteStage2_ko_zero);Invocateur.desabonner(Invocateur.events.autorisationRechargementPage);this.Fermer();}
if(GEtatUtilisateur.reglesSaisieMotDePasse.init){$('#'+this.idValidationMdp.escapeJQ()).html(TValidationMotDePasse.construire(null,{avecEspace:false}));}} else if(this.stage===2){$('#'+this.idStage2.escapeJQ()).removeClass(this.classStageActif).addClass(this.classStageInactif);$('#'+this.idStage3.escapeJQ()).removeClass(this.classStageInactif).addClass(this.classStageActif);$('.'+this.classTable+' tr:eq(1)').addClass(this.classTrDisabled).find('input').attr('disabled',true);$('.'+this.classTable+' tr:eq(2)').removeClass(this.classTrDisabled).find('input').attr('disabled',false);this.GetInstance(this.idBouton).SetActif(false);$('#'+this.GetInstance(this.idBouton).Nom.escapeJQ()).animate({top:$('#'+this.idMdpbis.escapeJQ()).position().top+5},500);$('#'+this.idMdp.escapeJQ()).focus();this.stage=3;} else if(this.stage===3){if(aResult.erreurMDP){var lJMdp=$('#'+this.idMdp.escapeJQ());GApplication.getMessage().afficher({titre:GTraductions.getValeur('SaisieMotDePasse.EchecModification'),message:TValidationMotDePasse.construire(aResult.erreurMDP),callback:function(){lJMdp.focus();}});$('#'+this.idValidationMdp.escapeJQ()).html(TValidationMotDePasse.construire(aResult.erreurMDP,{avecEspace:false}));$('#'+this.idMdp.escapeJQ()).val('');$('#'+this.idMdpbis.escapeJQ()).val('');$('#'+this.idMdpbis.escapeJQ()+'_valide').removeClass('Image_CocheVerte').addClass('Image_CocheRouge');}
else{$('#'+this.idStage3.escapeJQ()).removeClass(this.classStageActif).addClass(this.classStageInactif);$('.'+this.classTable+' tr:eq(2)').addClass(this.classTrDisabled).find('input').attr('disabled',true);this.stage= -1;$('#'+this.GetInstance(this.idBouton).Nom.escapeJQ()).css('display','none');if(!aResult.estEchec){this.SetListeBoutons([this.texteTerminer]);this.SetBoutonActif(0,true);GApplication.getMessage().Afficher(EGenreBoiteMessage.Information,null,this.texteStage3_ok,null,this,null);Invocateur.desabonner(Invocateur.events.autorisationRechargementPage);} else{this.SetListeBoutons([GTraductions.getValeur('principal.fermer')]);this.SetBoutonActif(0,true);}}}};ObjetFenetreRecupIdMDP.prototype.RecupererDonnees=function(){this.inherited('RecupererDonnees');$('#'+this.idCourriel.escapeJQ()).on('keyup blur',{aObjet:this},this.estMailValide).focus();$('#'+this.idCode.escapeJQ()).on('keyup blur',{aObjet:this},this.estCodeValide);$('#'+this.idMdp.escapeJQ()+', #'+this.idMdpbis.escapeJQ()).on('keyup blur',{aObjet:this},this.estMdpValide);this.setLargeurBouton(0,'75px');};ObjetFenetreRecupIdMDP.prototype.Afficher=function(){if(this.erreurSMTP){GApplication.getMessage().Afficher(EGenreBoiteMessage.Information,'',GTraductions.getValeur('fenetreRecupIdMDP.erreurSMTP'));Invocateur.desabonner(Invocateur.events.autorisationRechargementPage);this.Fermer();} else{this.inherited('Afficher');$('#'+this.GetInstance(this.idBouton).Nom.escapeJQ()).css('top',$('#'+this.idCourriel.escapeJQ()).position().top+5);}};ObjetFenetreRecupIdMDP.prototype.estCodeValide=function(event){var lIsOkCode=false;var lCode=$('#'+event.data.aObjet.idCode.escapeJQ()).val();if(RegExp("[a-zA-Z0-9]{4}-[a-zA-Z0-9]{4}-[a-zA-Z0-9]{4}-[a-zA-Z0-9]{4}").test(lCode)){var lTabAlpha='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';var lTotal=0;for(var i in lCode) if(lCode[i]!=='-'&&!$.isFunction(lCode[i])){lTotal+=lTabAlpha.indexOf(lCode[i])+1;}
if(lTotal%62===0) lIsOkCode=true;}
$('#'+event.data.aObjet.idCode.escapeJQ()+'_valide').removeClass(lIsOkCode?'Image_CocheRouge':'Image_CocheVerte').addClass(lIsOkCode?'Image_CocheVerte':'Image_CocheRouge');event.data.aObjet.GetInstance(event.data.aObjet.idBouton).SetActif(lIsOkCode);if(lIsOkCode&&event.type==='keyup'&&event.which===ToucheClavier.RetourChariot) event.data.aObjet.evenementBouton();};ObjetFenetreRecupIdMDP.prototype.estMdpValide=function(event){var lIsOkMdp=false;var lMdp=$('#'+event.data.aObjet.idMdp.escapeJQ()).val();var lMdpBis=$('#'+event.data.aObjet.idMdpbis.escapeJQ()).val();if(lMdp!==''&&lMdpBis!==''&&lMdp===lMdpBis){lIsOkMdp=true;}
if(lMdp!==''||lMdpBis!=='') $('#'+event.data.aObjet.idMdpbis.escapeJQ()+'_valide').removeClass(lIsOkMdp?'Image_CocheRouge':'Image_CocheVerte').addClass(lIsOkMdp?'Image_CocheVerte':'Image_CocheRouge');event.data.aObjet.GetInstance(event.data.aObjet.idBouton).SetActif(lIsOkMdp);if(lIsOkMdp&&event.type==='keyup'&&event.which===ToucheClavier.RetourChariot) event.data.aObjet.evenementBouton();};ObjetFenetreRecupIdMDP.prototype.estMailValide=function(event){var lIsOkMail=RegExp("^[a-zA-Z0-9._-]{3,}@[a-zA-Z0-9._-]{3,}\\.[a-zA-Z]{2,4}$").test($(this).val());event.data.aObjet.GetInstance(event.data.aObjet.idBouton).SetActif(lIsOkMail);if(lIsOkMail&&event.type==='keyup'&&event.which===ToucheClavier.RetourChariot) event.data.aObjet.evenementBouton();};;
function ObjetAuthentifiant(aLogin,aMotDePasse,aPourENT,aDemandeConexionAuto,aEnConnexionAuto){this.login=new ObjetElement(aLogin);this.motDePasse=new ObjetElement(aMotDePasse);this.pourENT=aPourENT;this.demandeConnexionAuto=aDemandeConexionAuto;this.enConnexionAuto=aEnConnexionAuto;}
ObjetAuthentifiant.prototype.setMode=function(aModeLogin,aModeMotDePasse){this.login.Genre=aModeLogin;this.motDePasse.Genre=aModeMotDePasse;};ObjetAuthentifiant.prototype.getPourENT=function(){return this.pourENT;};ObjetAuthentifiant.prototype.getLogin=function(){var lLogin=this.login.GetLibelle();if(!this.pourENT&&(this.getModeLogin()>0))
lLogin=lLogin.toLowerCase();return lLogin;};ObjetAuthentifiant.prototype.getMotDePasse=function(){var lMotDePasse=this.motDePasse.GetLibelle();if(!this.pourENT&&(this.getModeMotDePasse()>0))
lMotDePasse=lMotDePasse.toLowerCase();return lMotDePasse;};ObjetAuthentifiant.prototype.getModeLogin=function(){return this.login.GetGenre();};ObjetAuthentifiant.prototype.getModeMotDePasse=function(){return this.motDePasse.GetGenre();};ObjetAuthentifiant.prototype.getCle=function(){return(this.pourENT?'':this.getLogin())+this.getMotDePasse();};;
function ObjetRequeteIdentification(aPere,aEvenementSurReussite,aEvenementSurEchec){this.inheritedCreate(aPere,aEvenementSurReussite,aEvenementSurEchec);}
IE.Requetes.inscrire('Identification',ObjetRequeteIdentification,_ObjetRequeteXmlConsultationPN);ObjetRequeteIdentification.prototype.lancerRequete=function(aAuthentifiant){this.JSON={Identifiant:aAuthentifiant.getLogin(),PourENT:aAuthentifiant.getPourENT(),enConnexionAuto:aAuthentifiant.enConnexionAuto,demandeConnexionAuto:aAuthentifiant.demandeConnexionAuto};this.appelAsynchroneConsultation({messageDetail:GTraductions.getValeur('Identification')});};ObjetRequeteIdentification.prototype.actionApresRequete=function(){this.callbackReussite.appel(this.JSONReponse.Challenge||null,this.JSONReponse.Login,this.JSONReponse.MotDePasse);};;
var EGenreTAF={ASaisir:0,QCM:1};;
function UtilitaireDeserialiserPiedBulletin(){}
UtilitaireDeserialiserPiedBulletin.prototype.creerAbsences=function(aXml){var lNoeud=aXml.GetCategorie(null,'ListeAbsences');return{strAbsences:aXml.GetVariable(lNoeud,'StrAbsences'),strRetards:aXml.GetVariable(lNoeud,'StrRetards'),strPunitions:aXml.GetVariable(lNoeud,'StrPunitions'),strSanctions:aXml.GetVariable(lNoeud,'StrSanctions')};};UtilitaireDeserialiserPiedBulletin.prototype.creerPiedDePage=function(aXml){var lResult={};if(aXml.Existe(null,'ListeOrientations')){lResult.ListeOrientations=new ObjetListeElements();aXml.Parcourir(aXml.GetCategorie(null,'ListeOrientations'),'Orientation',this,this.ajouterElement,false,lResult.ListeOrientations);}
if(aXml.Existe(null,'ListeAttestations')){lResult.ListeAttestations=new ObjetListeElements();aXml.Parcourir(aXml.GetCategorie(null,'ListeAttestations'),'Attestation',this,this.ajouterElement,false,lResult.ListeAttestations);}
if(aXml.Existe(null,'ListeAppreciations')){var lNoeudAG=aXml.GetCategorie(null,'ListeAppreciations');lResult.ListeAppreciations={general:new ObjetListeElements(),conseilDeClasse:new ObjetListeElements(),commentaires:new ObjetListeElements(),cpe:new ObjetListeElements()};lResult.avecSaisieAG=aXml.GetVariable(lNoeudAG,'Editable');var lCloture=aXml.GetVariable(lNoeudAG,'Cloture');aXml.Parcourir(lNoeudAG,'Appreciation',this,this.ajouterAppreciation.bind(this,lResult.avecSaisieAG,lCloture),false,lResult.ListeAppreciations);}
if(aXml.Existe(null,'ListePaliers')){lResult.listePaliers=new ObjetListeElements();aXml.Parcourir(aXml.GetCategorie(null,'ListePaliers'),'Palier',this,this.ajouterPalier,false,lResult.listePaliers);lResult.listePaliers.Trier();}
lResult.Signataire=aXml.GetVariable(null,'Signataire');if(aXml.Existe(null,'Mentions')){var lNoeudMentions=aXml.GetCategorie(null,'Mentions');lResult.listeMentions=new ObjetListeElements();aXml.Parcourir(lNoeudMentions,'Mention',this,this.ajouterMention,false,lResult.listeMentions);}
if(aXml.Existe(null,'ListeStages')){var lNoeudStages=aXml.GetCategorie(null,'ListeStages');lResult.listeStages=new ObjetListeElements();aXml.Parcourir(lNoeudStages,'Stage',this,this._ajouterStage,false,lResult.listeStages);}
if(aXml.Existe(null,'ListeOrientationsClasse')){lResult.ListeOrientationsClasse=new ObjetListeElements();aXml.Parcourir(aXml.GetCategorie(null,'ListeOrientationsClasse'),'Orientation',this,this.ajouterElement,false,lResult.ListeOrientationsClasse);}
if(aXml.Existe(null,'ListeMentionsClasse')){lResult.ListeMentionsClasse=new ObjetListeElements();aXml.Parcourir(aXml.GetCategorie(null,'ListeMentionsClasse'),'Mention',this,this.ajouterElement,false,lResult.ListeMentionsClasse);}
return lResult;};UtilitaireDeserialiserPiedBulletin.prototype._ajouterStage=function(aXml,aNoeud,I,aParametre){var lStage=aXml.GetElement(aNoeud);lStage.listeDemandeurs=new ObjetListeElements();aXml.Parcourir(aNoeud,'Demandeur',this,this._ajouterStage_demandeur,false,lStage.listeDemandeurs);aParametre.AddElement(lStage);};UtilitaireDeserialiserPiedBulletin.prototype._ajouterStage_demandeur=function(aXml,aNoeud,I,aParametre){var lDemandeur=aXml.GetElement(aNoeud);lDemandeur.appreciation=aXml.GetVariable(aNoeud,'Appreciation');aParametre.AddElement(lDemandeur);};UtilitaireDeserialiserPiedBulletin.prototype.ajouterMention=function(aXml,aNoeud,I,aParametre){var lElt=aXml.GetElement(aNoeud);lElt.imprimee=aXml.GetVariable(aNoeud,'Imprimee');aParametre.AddElement(lElt);};UtilitaireDeserialiserPiedBulletin.prototype.ajouterElement=function(aXml,aNoeud,I,aParametre){var lElt=aXml.GetElement(aNoeud);lElt.Nombre=aXml.GetListeVariables(aNoeud,'Nombre');lElt.Intitule=aXml.GetListeVariables(aNoeud,'Intitule');aParametre.AddElement(lElt);};UtilitaireDeserialiserPiedBulletin.prototype.ajouterPalier=function(aXml,aNoeud,I,aParametre){var lElt=aXml.GetElement(aNoeud);lElt.validation=aXml.GetVariable(aNoeud,'Validation');lElt.listePiliers=new ObjetListeElements();aXml.Parcourir(aNoeud,'Pilier',this,this.ajouterPilier,false,lElt.listePiliers);lElt.listePiliers.Trier();aParametre.AddElement(lElt);};UtilitaireDeserialiserPiedBulletin.prototype.ajouterPilier=function(aXml,aNoeud,I,aParametre){var lPilier=aXml.GetElement(aNoeud);lPilier.date=aXml.GetVariable(aNoeud,'Date');lPilier.service=aXml.GetElement(aNoeud,'Service');lPilier.AddTri(lPilier.Position);lPilier.AddTri(lPilier.service?lPilier.service.GetLibelle():'');aParametre.AddElement(lPilier);};UtilitaireDeserialiserPiedBulletin.prototype.ajouterAppreciation=function(aEditable,aCloture,aXml,aNoeud,I,aParametre){var lAppreciation=aXml.GetElement(aNoeud);var lElement=new ObjetElement();lElement.Intitule=aXml.GetListeVariables(aNoeud,'Intitule');lElement.Editable=aEditable;lElement.Cloture=aCloture;lElement.Genre=lAppreciation.GetGenre();lElement.ListeAppreciations=new ObjetListeElements();lElement.ListeAppreciations.AddElement(lAppreciation);switch(lElement.Genre){case 0:aParametre.general.AddElement(lElement);break;case 1:case 2:case 3:case 8:aParametre.conseilDeClasse.AddElement(lElement);break;case 4:case 5:case 6:aParametre.commentaires.AddElement(lElement);break;case 7:aParametre.cpe.AddElement(lElement);break;}};function ObjetDeserialiser(){}(function(){ObjetDeserialiser.prototype.listeAbsences=function(aXml,aNoeud){var lListeAbsences=new ObjetListeElements();aXml.Parcourir(aNoeud,'Absence',this,this._ajouterAbsence,false,lListeAbsences);lListeAbsences.Trier();return lListeAbsences;};ObjetDeserialiser.prototype.listeDispenses=function(aXml,aNoeud){var lListeDispenses=new ObjetListeElements();aXml.Parcourir(aNoeud,'Dispense',this,this._ajouterDispense,false,lListeDispenses);lListeDispenses.Trier();return lListeDispenses;};ObjetDeserialiser.prototype.listePunitions=function(aXml,aNoeud){var lListePunitions=new ObjetListeElements();for(var i=0,lListeNoeudsPunition=aXml.listeFils(aNoeud,'Absence');i<lListeNoeudsPunition.length;i++){var lNoeudPunition=lListeNoeudsPunition[i];this._ajouterPunition(aXml,lNoeudPunition,lListePunitions);}
lListePunitions.Trier();return lListePunitions;};ObjetDeserialiser.prototype.listeCommunications=function(aXml,aNoeud){var lListeCommunications=new ObjetListeElements();lListeCommunications=aXml.GetListeElements(aNoeud,'Communication',false,this._ajouterCommunication.bind(this));lListeCommunications.setTri([ObjetTri.init('date',true),ObjetTri.init('Libelle',true)]);lListeCommunications.trier();return lListeCommunications;};ObjetDeserialiser.prototype.listeEvenementsVS=function(aListe,aPourAccueil){this.pourAccueil=aPourAccueil;aListe.parcourir(_enrichirEvenementVS.bind(this,aListe));aListe.setTri([ObjetTri.init('aRegulariser',EGenreTriElement.Decroissant),ObjetTri.init(function(D){return D.dateDebut?D.dateDebut:D.dateDemande;},EGenreTriElement.Decroissant)]);aListe.trier();return aListe;};function _enrichirEvenementVS(aListe,aElement){new ObjetDeserialiser()._formaterEvenementVS({element:aElement,pourAccueil:this.pourAccueil,liste:aListe});}
ObjetDeserialiser.prototype._formaterEvenementVS=function(aParam){aParam.element.avecSaisie=aParam.element.avecSaisie?true:false;if(aParam.element.date){aParam.element.dateDebut=aParam.element.date;aParam.element.dateFin=aParam.element.date;}
if(!aParam.element.dateFin)
aParam.element.dateFin=aParam.element.dateDebut;aParam.element.estDemiJournee=aParam.element.estMatin?true:false;if(aParam.element.GetGenre()===EGenreRessource.Punition&&((aParam.element.nature.GetGenre()===EGenrePunition.Exclusion)||!aParam.pourAccueil)){aParam.element.dateDebut=aParam.element.dateDemande;aParam.element.dateFin=aParam.element.dateDemande;aParam.element.place=aParam.element.placeDemande;if(!aParam.pourAccueil&&aParam.liste){for(var I=0;aParam.element.programmation&&(I<aParam.element.programmation.GetNbrElements());I++){var lNewElement=MethodesObjet.dupliquer(aParam.element);var lProg=aParam.element.programmation.GetElement(I);lNewElement.dateDebut=lProg.date;lNewElement.dateFin=lProg.date;lNewElement.estProgrammation=true;if((lProg.place!==null&&lProg.place!==undefined))
lNewElement.place=lProg.place;if(lProg.duree)
lNewElement.duree=lProg.duree;else lNewElement.duree=aParam.element.duree;lNewElement.Position=EGenreRessource.getPositionAbsence({genre:lNewElement.GetGenre(),genreNature:lNewElement.nature.GetGenre()});aParam.liste.AddElement(lNewElement);}}}
if(aParam.element.programmation){aParam.element.programmation.setTri([ObjetTri.init('date')]);aParam.element.programmation.trier();}
var lObjet={genre:aParam.element.GetGenre(),estLue:aParam.element.estLue};if((aParam.element.nature!==null&&aParam.element.nature!==undefined))
lObjet.genreNature=aParam.element.nature.GetGenre();if(aParam.element.GetGenre()===EGenreRessource.Absence)
lObjet.justifie=aParam.element.justifie;aParam.element.Position=EGenreRessource.getPositionAbsence(lObjet);aParam.element.aRegulariser=this._evenementVSARegulariser(aParam.element);};ObjetDeserialiser.prototype._evenementVSARegulariser=function(aElement){switch(aElement.GetGenre()){case(EGenreRessource.Absence):case(EGenreRessource.Retard):return aElement.avecSaisie&&!aElement.motifParent;case(EGenreRessource.ObservationProfesseurEleve):return!aElement.estLue;case(EGenreRessource.Punition):return aElement.nature&&aElement.nature.estAvecARParent&&!aElement.parentAAccuseDeReception?true:false;default:return false;}};ObjetDeserialiser.prototype.listeDossiersVieScolaire=function(aXml,aNoeud){var lListeDossiers=new ObjetListeElements();lListeDossiers=aXml.GetListeElements(aNoeud,'Dossier',false,this._ajouterDossierVieScolaire.bind(this));lListeDossiers.setTri([ObjetTri.init('date',EGenreTriElement.Decroissant),ObjetTri.init('Libelle',EGenreTriElement.Decroissant)]);lListeDossiers.trier();return lListeDossiers;};ObjetDeserialiser.prototype.listePJEleve=function(aXml,aNoeud){var lListePJEleve=new ObjetListeElements();lListePJEleve=aXml.GetListeElements(aNoeud,'PieceJointe',false,this._ajouterPJEleve.bind(this));return lListePJEleve;};ObjetDeserialiser.prototype.listeCours=function(aJSON){var lListe=new ObjetListeElements().fromJSON(aJSON.ListeCours,this._ajouterCours.bind(this));lListe.setTri([ObjetTri.init('DateDuCours')]);lListe.trier();return lListe;};ObjetDeserialiser.prototype._ajouterCours=function(aJSON,aElement){aElement.Statut=aJSON.Statut;aElement.estAnnule=!!aJSON.estAnnule;aElement.estPermanence=!!aJSON.estPermanence;aElement.Debut=aJSON.Debut;aElement.Fin=aJSON.Fin;aElement.CouleurFond=aJSON.CouleurFond;aElement.CouleurTexte=GCouleur.getCouleurCorrespondance(aJSON.CouleurFond);aElement.DateDuCours=aJSON.DateDuCours;aElement.NomImageAppelFait=aJSON.NomImageAppelFait;aElement.AppelFait=(aElement.NomImageAppelFait==='AppelFait')||(aElement.NomImageAppelFait==='AppelVerrouFait');aElement.estAppelVerrouille=(aElement.NomImageAppelFait==='AppelVerrouNonFait')||(aElement.NomImageAppelFait==='AppelVerrouFait');aElement.cahierDeTextes=aJSON.cahierDeTextes;aElement.AvecCdT=aElement.cahierDeTextes&&aElement.cahierDeTextes.existeNumero();aElement.memo=aJSON.memo;aElement.utilisable=aJSON.utilisable===false?false:true;aElement.deplacable=!!aJSON.deplacable;aElement.nbrSalles=aJSON.nbrSalles;aElement.salleRemplacee=aJSON.salleRemplacee;aElement.supprimable=!!aJSON.supprimable;aElement.modifAnnulable=!!aJSON.modifAnnulable;aElement.cdtAffecte=aJSON.CahierDeTextes&&aJSON.CahierDeTextes.Affecte;if(aJSON.CahierDeTextes){aElement.nbLecons=aJSON.CahierDeTextes.NbLecons;aElement.nbDevoirs=aJSON.CahierDeTextes.NbDevoirs;aElement.nbContenus=aJSON.CahierDeTextes.NbContenus;if(aJSON.CahierDeTextes.C)
aElement.cahierDeTextes.listeContenus=new ObjetListeElements().fromJSON(aJSON.CahierDeTextes.C,this._ajouterDetailsDeContenusDeCours.bind(this));}
aElement.AvecCdTPublie=aJSON.AvecCdTPublie;aElement.avecTafPublie=aJSON.AvecTafPublie;aElement.AvecVisa=aJSON.AvecVisa;aElement.avecChargeTAF=!!aJSON.AvecChargeTAF;aElement.estGAEV=!!aJSON.estGAEV;aElement.estCoEnseignement=!!aJSON.estCoEnseignement;aElement.dispenseEleve=!!aJSON.dispenseEleve;aElement.ListeContenus=new ObjetListeElements().fromJSON(aJSON.Contenus,this._ajouterContenu.bind(this,aElement));if(aElement.matiere){aElement.matiere.CouleurFond=aElement.CouleurFond;aElement.matiere.CouleurTexte=aElement.CouleurTexte;}
aElement.avecFicheCours=!!aJSON.avecFicheCours;};ObjetDeserialiser.prototype._ajouterDetailsDeContenusDeCours=function(aJSON,aElement){if(aJSON.CProg)
aElement.progressionAssocie=new ObjetElement().fromJSON(aJSON.CProg);};ObjetDeserialiser.prototype._ajouterContenu=function(aElementPere,aJSON,aElement){if(aElement.GetGenre()===EGenreRessource.Matiere)
aElementPere.matiere=aElement;if(aElement.GetGenre()===EGenreRessource.Service&&aJSON.classe){aElement.classe=new ObjetElement().fromJSON(aJSON.classe);}};ObjetDeserialiser.prototype.listePiliers=function(aXml,aNoeud){var lNoeudListePiliers=aXml.GetCategorie(aNoeud,'ListePiliers');var lListePiliers=new ObjetListeElements();lListePiliers.pilierParDefaut=aXml.GetElement(lNoeudListePiliers,'PilierParDefaut');aXml.Parcourir(lNoeudListePiliers,'Pilier',this,this._ajouterPilier.bind(this),false,lListePiliers);return lListePiliers;};ObjetDeserialiser.prototype.listePeriodes=function(aXml,aNoeud){return aXml.GetListeElements(aXml.GetCategorie(aNoeud,'ListePeriodes'),'Periode',false,this._addDatePeriode);};ObjetDeserialiser.prototype.listeElevesPourEvaluation=function(aXml,aNoeud){this.listeClasses=new ObjetListeElements();aXml.Parcourir(aXml.GetCategorie(aNoeud,'ListeClasses'),'Classe',this,this._ajouterClassePourEvaluation,false,this.listeClasses);var lListeEleves=new ObjetListeElements();aXml.Parcourir(aXml.GetCategorie(aNoeud,'ListeEleves'),'Eleve',this,this._ajouterElevePourEvaluation,false,lListeEleves);lListeEleves.Trier();return lListeEleves;};ObjetDeserialiser.prototype.listeTravailAFaire=function(aXml,aAvecCouleurs){var lParam=[new ObjetListeElements(),aAvecCouleurs];aXml.Parcourir(aXml.GetCategorie(null,'ListeTravauxAFaire'),'TravailAFaire',this,this._ajouterDonneeTravailAFaire,false,lParam);lParam[0].Trier();return lParam[0];};ObjetDeserialiser.prototype.listeContenusDeCours=function(aXml,aNoeud){var lListeContenus=new ObjetListeElements();aXml.Parcourir(aXml.GetCategorie(aNoeud,'Contenus'),'ContenuDeCours',this,this._ajouterContenus,false,lListeContenus);return lListeContenus;};ObjetDeserialiser.prototype.listeCahierDeTextes=function(aXml,aAvecCouleurs){var lParam=[new ObjetListeElements(),aAvecCouleurs];aXml.Parcourir(aXml.GetCategorie(null,'ListeCahierDeTextes'),'CahierDeTextes',this,this._ajouterDonneeCahierDeTextes,false,lParam);return lParam[0];};ObjetDeserialiser.getUrls=function(aGenre,aAvecLien,aSeparateur,aGenreRessource,aIEModelBoutonSuppression){if(!aSeparateur)
aSeparateur=', ';if(!aGenreRessource)
aGenreRessource=EGenreRessource.DocumentJoint;var T=[],lLibelle,lBtnSupp;for(var I=0;I<this.GetNbrElements();I++){var lElement=this.GetElement(I);if(lElement.Existe())
if(lElement.GetGenre()===aGenre){var lAvecLien=(lElement.Etat!==EGenreEtat.Creation)&&(aAvecLien||lElement.GetGenre()===EGenreDocumentJoint.Url||lElement.GetGenre()===EGenreDocumentJoint.Cloud);lBtnSupp='';if(aIEModelBoutonSuppression){lBtnSupp='<ie-btnImage class="Image_CroixFermer InlineBlock AlignementBas"'+' ie-model="'+aIEModelBoutonSuppression+'('+I+')"'+' style="width:16px; margin-left:3px;"'+' title="'+GChaine.toTitle(GTraductions.getValeur('CahierDeTexte.SupprimerDocumentJoint'))+'">'+'</ie-btnimage>';}
if(aGenre===EGenreDocumentJoint.Fichier&&lAvecLien){lLibelle=GChaine.composerURL(GApplication.getCommunication().composeUrlFichierExterne(lElement.GetLibelle(),{"N":lElement.Numero,"G":aGenreRessource}),lElement.GetLibelle(),true);T.push(lLibelle+lBtnSupp);}
else T.push((lAvecLien?GChaine.composerURL(lElement.Url,lElement.GetLibelle()):lElement.GetLibelle())+lBtnSupp);}}
return T.join(aSeparateur);};ObjetDeserialiser.prototype._getListePJ=function(aParam){var lListePiecesJointes=new ObjetListeElements();lListePiecesJointes.getUrls=ObjetDeserialiser.getUrls;aParam.xml.Parcourir(aParam.noeud,'PieceJointe',this,aParam.methodeTraitement,false,lListePiecesJointes);lListePiecesJointes.Trier();return lListePiecesJointes;};ObjetDeserialiser.prototype.getListePJEleve=function(aXml,aNoeud){return this._getListePJ({xml:aXml,noeud:aNoeud,methodeTraitement:this._ajouterDonneePJEleve});};ObjetDeserialiser.prototype.getListePiecesJointes=function(aXml,aNoeud){return this._getListePJ({xml:aXml,noeud:aNoeud,methodeTraitement:this._ajouterDonneePieceJointe});};ObjetDeserialiser.prototype.cahierDeTextes=function(aXml,aNoeud,aAvecCouleurs){var lElement=aXml.GetElement(aNoeud);lElement.listeContenus=this.listeContenusDeCours(aXml,aNoeud);lElement.listeContenus.aUnElementVide=ObjetDeserialiser._aUnElementVide;lElement.listeContenus.verifierAvantValidation=ObjetDeserialiser._verifierAvantValidation;lElement.Matiere=aXml.GetElement(aNoeud,'Matiere');if(aXml.Existe(aNoeud,'Groupe'))
lElement.groupe=aXml.GetElement(aNoeud,'Groupe');if(aAvecCouleurs){lElement.CouleurFond=aXml.GetVariable(aNoeud,'CouleurFond');lElement.CouleurTexte=aXml.GetVariable(aNoeud,'CouleurTexte');lElement.Matiere.CouleurFond=aXml.GetVariable(aNoeud,'CouleurFond');lElement.Matiere.CouleurTexte=aXml.GetVariable(aNoeud,'CouleurTexte');}
lElement.Date=aXml.GetVariable(aNoeud,'Date');lElement.publie=aXml.GetVariable(aNoeud,'Publie');lElement.verrouille=aXml.GetVariable(aNoeud,'Verrouille');lElement.dateVisa=aXml.GetVariable(aNoeud,'DateVisa')||0;lElement.individuVisa=aXml.GetVariable(aNoeud,'IndividuVisa')||null;lElement.dateVisaI=aXml.GetVariable(aNoeud,'DateVisaI')||0;lElement.individuVisaI=aXml.GetVariable(aNoeud,'IndividuVisaI')||null;var lParam=[new ObjetListeElements(),aAvecCouleurs];aXml.Parcourir(aNoeud,'TravailAFaire',this,this._ajouterDonneeTravailAFaire,false,lParam);lElement.ListeTravailAFaire=lParam[0];lElement.ListeTravailAFaire.aUnElementVide=ObjetDeserialiser._aUnElementVide;lElement.ListeTravailAFaire.verifierAvantValidation=ObjetDeserialiser._verifierAvantValidation;return lElement;};ObjetDeserialiser._aUnElementVide=function(){var lResult=false;for(var I=0;I<this.GetNbrElements()&&!lResult;I++)
if(this.Existe(I)&&(this.GetElement(I).estVide))
lResult=true;return lResult;};ObjetDeserialiser._verifierAvantValidation=function(){for(var I=0;I<this.GetNbrElements();I++)
if(this.Existe(I)&&(this.GetElement(I).estVide)){var lEstUnTAFQCM=this.GetElement(I).genreTAF&&(this.GetElement(I).genreTAF===EGenreTAF.QCM);if(!lEstUnTAFQCM)
this.GetElement(I).SetEtat(EGenreEtat.Suppression);}};ObjetDeserialiser.prototype.fichesContactResponsables=function(aXml,aNoeud){var lListeResponsables=aXml.GetListeElements(aXml.GetCategorie(aNoeud,'ListeResponsables'),'R',false,this._getDetailsFicheResponsable);return lListeResponsables;};ObjetDeserialiser.prototype._ajouterDonneeCahierDeTextes=function(aXml,aNoeud,I,aParametre){aParametre[0].AddElement(this.cahierDeTextes(aXml,aNoeud,aParametre[1]));};ObjetDeserialiser.prototype._ajouterContenus=function(aXml,aNoeud,I,aParametre){var lElement=aXml.GetElement(aNoeud);lElement.descriptif=GChaine.nettoyerCommentaire(aXml.GetVariable(aNoeud,'Descriptif',''));lElement.categorie=aXml.Existe(aNoeud,'Categorie')?aXml.GetElement(aNoeud,'Categorie'):new ObjetElement('',0);if(aXml.Existe(aNoeud,'genreLienDS')){lElement.categorie.genreLienDS=aXml.GetVariable(aNoeud,'genreLienDS');}
lElement.estVide=false;lElement.ListePieceJointe=this.getListePiecesJointes(aXml,aNoeud);var lTraining=aXml.GetVariable(aNoeud,'Training');lElement.listeExecutionQCM=new ObjetListeElements().fromJSON(lTraining.ListeExecutionsQCM,this._ajouterQCM.bind(this));aParametre.AddElement(lElement);};ObjetDeserialiser.prototype._ajouterDonneePJ=function(aParam){var lElement=aParam.xml.GetElement(aParam.noeud);lElement.url=aParam.xml.GetVariable(aParam.noeud,'url');lElement.Url=EGenreDocumentJoint.getUrl(lElement,aParam.genrePJ);lElement.AddTri(lElement.GetGenre()!==EGenreDocumentJoint.Fichier);lElement.AddTri(lElement.GetNumero());aParam.parametre.AddElement(lElement);};ObjetDeserialiser.prototype._ajouterDonneePieceJointe=function(aXml,aNoeud,I,aParametre){this._ajouterDonneePJ({xml:aXml,noeud:aNoeud,parametre:aParametre,genrePJ:EGenreRessource.DocumentJoint});};ObjetDeserialiser.prototype._ajouterDonneePJEleve=function(aXml,aNoeud,I,aParametre){this._ajouterDonneePJ({xml:aXml,noeud:aNoeud,parametre:aParametre,genrePJ:EGenreRessource.DocJointEleve});};ObjetDeserialiser.prototype._ajouterDonneeTravailAFaire=function(aXml,aNoeud,I,aParametre){var lElement=aXml.GetElement(aNoeud);lElement.descriptif=GChaine.nettoyerCommentaire(aXml.GetVariable(aNoeud,'Descriptif',''));lElement.Matiere=aXml.GetElement(aNoeud,'Matiere');lElement.PourLe=aXml.Existe(aNoeud,'PourLe')?aXml.GetVariable(aNoeud,'PourLe'):aXml.GetVariable(aNoeud,'Date');lElement.pourTousLesEleves=aXml.Existe(aNoeud,'PourTousLesEleves')?aXml.GetVariable(aNoeud,'PourTousLesEleves'):true;lElement.groupe=aXml.Existe(aNoeud,'Groupe')?aXml.GetElement(aNoeud,'Groupe'):null;lElement.DonneLe=aXml.GetVariable(aNoeud,'DonneLe');lElement.nomPublic=aXml.Existe(aNoeud,'nomPublic')?aXml.GetVariable(aNoeud,'nomPublic'):'';lElement.estVide=false;if(aParametre[1]){lElement.CouleurFond=aXml.GetVariable(aNoeud,'CouleurFond');lElement.CouleurTexte=aXml.GetVariable(aNoeud,'CouleurTexte');}
lElement.ListePieceJointe=this.getListePiecesJointes(aXml,aNoeud);lElement.AddTri(lElement.DonneLe);lElement.AddTri(lElement.GetGenre());aParametre[0].AddElement(lElement);if(!lElement.pourTousLesEleves)
aParametre[0].avecDevoirPersonalise=true;try{var lExecutionQCM=aXml.GetVariable(aNoeud,'ExcecutionQCM');lElement.executionQCM=lExecutionQCM?new ObjetElement().fromJSON(lExecutionQCM):null;this._ajouterQCM(lExecutionQCM,lElement.executionQCM);} catch(e){}};ObjetDeserialiser.prototype._ajouterQCM=function(aJSON,aElement){aElement.copieJSON(aJSON);if(aElement.GetGenre()===EGenreRessource.ExecutionQCM){aElement.QCM=new ObjetElement().fromJSON(aJSON.QCM);aElement.QCM.copieJSON(aJSON.QCM);if(aJSON.service) aElement.service=new ObjetElement().fromJSON(aJSON.service);if((GEtatUtilisateur.GenreEspace===EGenreEspace.Parent||GEtatUtilisateur.GenreEspace===EGenreEspace.Mobile_Parent||GEtatUtilisateur.GenreEspace===EGenreEspace.Entreprise)&&(aElement.etatCloture===undefined||aElement.etatCloture===TypeEtatExecutionQCMPourRepondant.EQR_EnCours)){aElement.modeDiffusionCorrige=TypeModeCorrectionQCM.FBQ_CorrigeSans;GLog.addLog('modification modeDiffusionCorrige');}} else{aElement.niveau=new ObjetElement().fromJSON(aJSON.niveau);aElement.proprietaire=new ObjetElement().fromJSON(aJSON.proprietaire);}
if(!aElement.matiere||!$.isFunction(aElement.matiere.existeNumero)) aElement.matiere=new ObjetElement().fromJSON(aJSON.matiere);};ObjetDeserialiser.prototype._ajouterAbsence=function(aXml,aNoeud,I,aParametre){var lElement=aXml.GetElement(aNoeud);lElement.eleve=aXml.GetElement(aNoeud,'Eleve');lElement.classe=aXml.GetElement(aNoeud,'Classe');lElement.matiere=aXml.GetElement(aNoeud,'Matiere');lElement.regime=aXml.GetElement(aNoeud,'Regime');lElement.motif=aXml.GetElement(aNoeud,'Motif');lElement.ouverte=aXml.GetElement(aNoeud,'Ouverte');lElement.reglee=aXml.GetVariable(aNoeud,'Reglee');lElement.dateDebut=aXml.GetVariable(aNoeud,'DateDebut');lElement.dateFin=aXml.GetVariable(aNoeud,'DateFin');lElement.justifie=aXml.GetVariable(aNoeud,'justifie');lElement.AddTri(lElement.eleve.GetLibelle());lElement.AddTri(lElement.dateDebut);aParametre.AddElement(lElement);};ObjetDeserialiser.prototype._ajouterDispense=function(aXml,aNoeud,I,aParametre){var lElement=aXml.GetElement(aNoeud);lElement.eleve=aXml.GetElement(aNoeud,'Eleve');lElement.classe=aXml.GetElement(aNoeud,'Classe');lElement.matiere=aXml.GetElement(aNoeud,'Matiere');lElement.dateDebut=aXml.GetVariable(aNoeud,'DateDebut');lElement.dateFin=aXml.GetVariable(aNoeud,'DateFin');lElement.commentaire=aXml.GetVariable(aNoeud,'Commentaire');lElement.heuresPerdues=aXml.GetVariable(aNoeud,'HeuresPerdues');lElement.heuresPerduesTotales=aXml.GetVariable(aNoeud,'HeuresPerduesTotales');aParametre.AddElement(lElement);};ObjetDeserialiser.prototype._ajouterPunition=function(AXml,ANoeud,aParametre){var lPunition=AXml.GetElement(ANoeud);lPunition.naturePunition=AXml.GetElement(ANoeud,'Nature');lPunition.listeMotifs=AXml.GetListeElements(ANoeud,'Motif',true);lPunition.estTypeDevoir=lPunition.naturePunition.GetGenre()===3;if(AXml.Existe(ANoeud,'Demandeur'))
lPunition.demandeur=AXml.GetElement(ANoeud,'Demandeur');if(AXml.Existe(ANoeud,'Circonstance'))
lPunition.circonstance=AXml.GetVariable(ANoeud,'Circonstance');if(AXml.Existe(ANoeud,'Commentaire'))
lPunition.commentaire=AXml.GetVariable(ANoeud,'Commentaire');if(AXml.Existe(ANoeud,'Duree'))
lPunition.duree=AXml.GetVariable(ANoeud,'Duree');if(AXml.Existe(ANoeud,'DureeModifiable'))
lPunition.DureeModifiable=AXml.GetVariable(ANoeud,'DureeModifiable');if(AXml.Existe(ANoeud,'DateProgrammation'))
lPunition.dateProgrammation=AXml.GetVariable(ANoeud,'DateProgrammation');if(AXml.Existe(ANoeud,'PlaceExecution'))
lPunition.placeExecution=AXml.GetVariable(ANoeud,'PlaceExecution');if(AXml.Existe(ANoeud,'DateRealisation'))
lPunition.dateRealisation=AXml.GetVariable(ANoeud,'DateRealisation');if(AXml.Existe(ANoeud,'DateDemande'))
lPunition.dateDemande=AXml.GetVariable(ANoeud,'DateDemande');if(AXml.Existe(ANoeud,'PresentDansDossier'))
lPunition.presentDansDossier=AXml.GetVariable(ANoeud,'PresentDansDossier');if(AXml.Existe(ANoeud,'EstPubliee'))
lPunition.estPubliee=AXml.GetVariable(ANoeud,'EstPubliee');aParametre.AddElement(lPunition);};ObjetDeserialiser.prototype._ajouterCommunication=function(aXml,aNoeud,aCommunication){aCommunication.nature=aXml.GetElement(aNoeud,'Nature');aCommunication.nature=aXml.GetVariable(aXml.GetCategorie(aNoeud,'Nature'),'Code');aCommunication.interlocuteur=aXml.GetVariable(aNoeud,'Interlocuteur');aCommunication.estReponse=aXml.GetVariable(aNoeud,'EstReponse');aCommunication.date=aXml.GetVariable(aNoeud,'Date');};ObjetDeserialiser.prototype._ajouterPJEleve=function(aXml,aNoeud,aPJ){aPJ.estDuGenre=aXml.GetVariable(aNoeud,'EstDuGenreEvnt');aPJ.dateCreation=aXml.GetVariable(aNoeud,'DateCreation');aPJ.Date=aPJ.dateCreation;aPJ.nbRelations=aXml.GetVariable(aNoeud,'NbRelations');aPJ.genreEvntVS=aXml.GetVariable(aNoeud,'GenreEvntVS');};ObjetDeserialiser.prototype._ajouterDossierVieScolaire=function(aXml,aNoeud,aDossier){aDossier.commentaire=aXml.GetVariable(aNoeud,'Commentaire');aDossier.couleur=aXml.GetVariable(aNoeud,'Couleur');aDossier.date=aXml.GetVariable(aNoeud,'Date');aDossier.listeMotifs=aXml.GetListeElements(aXml.GetCategorie(aNoeud,'ListeMotifs'),'Motif');aDossier.respAdmin=aXml.GetElement(aNoeud,'RespAdmin');aDossier.professeur=aXml.GetElement(aNoeud,'Professeur');aDossier.lieu=aXml.GetElement(aNoeud,'Lieu');aDossier.victime=aXml.GetElement(aNoeud,'Victime');aDossier.temoin=aXml.GetElement(aNoeud,'Temoin');aDossier.publie=aXml.GetVariable(aNoeud,'Publie');aDossier.listePJ=this.getListePJEleve(aXml,aNoeud);aDossier.listeElements=aXml.GetListeElements(aNoeud,'ElementDossier',false,this._ajouterElementDossier.bind(this,aDossier.Numero));aDossier.listeElements.setTri([ObjetTri.init('date',EGenreTriElement.Decroissant),ObjetTri.init('Numero',EGenreTriElement.Decroissant)]);aDossier.listeElements.trier();aDossier.avecDeploiement=aDossier.listeElements?aDossier.listeElements.GetNbrElements()>0:false;aDossier.deploye=aDossier.avecDeploiement;};ObjetDeserialiser.prototype._ajouterElementDossier=function(aNumeroDossier,aXml,aNoeud,aElementDossier){aElementDossier.numeroDossier=aNumeroDossier;aElementDossier.genreElement=aXml.GetVariable(aNoeud,'Genre');aElementDossier.titre=aXml.GetVariable(aNoeud,'Titre');aElementDossier.couleur=aXml.GetVariable(aNoeud,'Couleur');aElementDossier.strDate=aXml.GetVariable(aNoeud,'ChaineDate');aElementDossier.date=aXml.GetVariable(aNoeud,'Date');aElementDossier.element=aXml.GetElement(aNoeud,'Element');aElementDossier.element.necessiteLaCreationDUnDossier=aXml.GetVariable(aXml.GetCategorie(aNoeud,'Element'),'NecessiteLaCreationDUnDossier');aElementDossier.element.type=aXml.GetElement(aXml.GetCategorie(aNoeud,'Element'),'Nature');aElementDossier.element.commentaire=aXml.GetVariable(aNoeud,'Commentaire');aElementDossier.element.date=aElementDossier.date;aElementDossier.element.responsable=aXml.GetVariable(aNoeud,'Responsable');aElementDossier.element.professeur=aXml.GetElement(aNoeud,'Professeur');aElementDossier.element.respAdmin=aXml.GetElement(aNoeud,'RespAdmin');aElementDossier.element.interlocuteur=aXml.GetVariable(aNoeud,'Interlocuteur');aElementDossier.element.avecReponseCourrier=aXml.GetVariable(aNoeud,'EstReponseCourrier');aElementDossier.publie=aXml.GetVariable(aNoeud,'Publie');aElementDossier.listePJ=this.getListePJEleve(aXml,aNoeud);};ObjetDeserialiser.prototype._ajouterPilier=function(aXml,aNoeud,I,aParametre){var lElement=aXml.GetElement(aNoeud);lElement.listeCompetences=new ObjetListeElements();this.tableauPeres=[];lElement.avecSousItems=aXml.GetVariable(aNoeud,'AvecSousItems');lElement.pilierLVE=aXml.GetVariable(aNoeud,'PilierLVE');aXml.Parcourir(aNoeud,'Competence',this,this._ajouterCompetence,false,lElement.listeCompetences);aParametre.AddElement(lElement);};ObjetDeserialiser.prototype._ajouterCompetence=function(aXml,aNoeud,I,aParametre){var lElement=aXml.GetElement(aNoeud);lElement.code=aXml.GetVariable(aNoeud,'Code');this.tableauPeres[lElement.GetGenre()]=lElement;if(lElement.GetGenre()!==EGenreRessource.Evaluation)
this.evaluationPere=lElement;lElement.pere=this.tableauPeres[EGenreRessource.getGenrePereCompetence(lElement.GetGenre(),this.evaluationPere.GetGenre())];lElement.estUnDeploiement=true;lElement.estDeploye=true;if(lElement.GetGenre()!==EGenreRessource.Evaluation)
this.competencePere=lElement;else lElement.competencePere=this.competencePere;aParametre.AddElement(lElement);};ObjetDeserialiser.prototype._addDatePeriode=function(AXml,ANoeud,aElementCree){aElementCree.dateDebut=AXml.GetVariable(ANoeud,'DateDebut');aElementCree.dateFin=AXml.GetVariable(ANoeud,'DateFin');if(AXml.Existe(ANoeud,'PeriodeNotation'))
aElementCree.periodeNotation=AXml.GetElement(ANoeud,'PeriodeNotation');};ObjetDeserialiser.prototype._ajouterElevePourEvaluation=function(aXml,aNoeud,I,aParametre){var lElement=aXml.GetElement(aNoeud);lElement.classe=aXml.GetElement(aNoeud,'Classe');lElement.dateDebut=aXml.GetListeVariables(aNoeud,'DateDebut');lElement.dateFin=aXml.GetListeVariables(aNoeud,'DateFin');lElement.estSortiDeLEtablissement=aXml.GetVariable(aNoeud,'EstSortiDeLEtablissement');var lClasse=this.listeClasses.GetElementParNumero(lElement.classe.GetNumero());if(lClasse)
lElement.listePiliers=lClasse.listePiliers;aParametre.AddElement(lElement);};ObjetDeserialiser.prototype._ajouterClassePourEvaluation=function(aXml,aNoeud,I,aParametre){var lElement=aXml.GetElement(aNoeud);lElement.listePiliers=aXml.GetListeElements(aNoeud,'Pilier');aParametre.AddElement(lElement);};ObjetDeserialiser.prototype._getDetailsFicheResponsable=function(aXml,aNoeud,aElement){aElement.telephoneFixe=aXml.GetVariable(aNoeud,'TelFixe');aElement.telephonePortable=aXml.GetVariable(aNoeud,'TelP');aElement.indicatifPortable=aXml.GetVariable(aNoeud,'IndP');aElement.telephoneAutre=aXml.GetVariable(aNoeud,'TelAutre');aElement.accepteSMS=aXml.GetVariable(aNoeud,'AccepteSMS');aElement.index_RespLegal=aXml.GetVariable(aNoeud,'I_RLegal');};ObjetDeserialiser.prototype.getListeDonneesNotifiees=function(aJSON){var lDonnees={};if(aJSON[TypeHttpNotificationDonnes.THND_ListeClasseNiveau])
lDonnees[TypeHttpNotificationDonnes.THND_ListeClasseNiveau]=aJSON[TypeHttpNotificationDonnes.THND_ListeClasseNiveau];if(aJSON[TypeHttpNotificationDonnes.THND_ListeGroupe])
lDonnees[TypeHttpNotificationDonnes.THND_ListeGroupe]=aJSON[TypeHttpNotificationDonnes.THND_ListeGroupe];if(aJSON[TypeHttpNotificationDonnes.THND_ListeProfesseur])
lDonnees[TypeHttpNotificationDonnes.THND_ListeProfesseur]=aJSON[TypeHttpNotificationDonnes.THND_ListeProfesseur];if(aJSON[TypeHttpNotificationDonnes.THND_ListeDocJointEtablissement])
lDonnees[TypeHttpNotificationDonnes.THND_ListeDocJointEtablissement]=aJSON[TypeHttpNotificationDonnes.THND_ListeDocJointEtablissement];if(aJSON[TypeHttpNotificationDonnes.THND_ListeDocJointEtablissement])
lDonnees[TypeHttpNotificationDonnes.THND_ListeDocJointEtablissement]=aJSON[TypeHttpNotificationDonnes.THND_ListeDocJointEtablissement];return lDonnees;};ObjetDeserialiser.prototype.getListeEvenements=function(aJSON){var lListeEvenements=new ObjetListeElements().fromJSON(aJSON,_ajouterEvenement);lListeEvenements.setTri([ObjetTri.init(function(D){return D.sansHoraire?new Date(D.DateDebut.getFullYear(),D.DateDebut.getMonth(),D.DateDebut.getDate()):D.DateDebut;}),ObjetTri.init(function(D){return D.sansHoraire?new Date(D.DateFin.getFullYear(),D.DateFin.getMonth(),D.DateFin.getDate()):D.DateFin;})]);lListeEvenements.trier();lListeEvenements._getLibelleEvenement=_getLibelleEvenement;lListeEvenements._getDateEvenement=_getDateEvenement;return lListeEvenements;};function _ajouterEvenement(aJSON,aElement){aElement.DateDebut=aJSON.DateDebut;aElement.DateFin=aJSON.DateFin;aElement.sansHoraire=aJSON.sansHoraire;aElement.Commentaire=aJSON.Commentaire;aElement.CouleurCellule=aJSON.CouleurCellule;aElement.salle=aJSON.salle;aElement.president=aJSON.president;aElement.listeParentsDelegues=aJSON.listeParentsDelegues;aElement.listeElevesDelegues=aJSON.listeElevesDelegues;aElement.publie=!aJSON.nonPublie;aElement.proprietaire=aJSON.Proprietaire;aElement.listeEleves=aJSON.listeEleves;if(aJSON.Public){aElement.Public={avecParent:aJSON.Public.avecParent,avecEleve:aJSON.Public.avecEleve,avecProf:aJSON.Public.avecProf,avecMDS:aJSON.Public.avecMDS,listeClassesGroupes:new ObjetListeElements().fromJSON(aJSON.Public.ListeClassesGroupes),listeProfs:new ObjetListeElements().fromJSON(aJSON.Public.ListeProfs)};}
aElement.listeDocJoints=new ObjetListeElements().fromJSON(aJSON.PiecesJointes,_ajouterDocJoint);}
function _ajouterDocJoint(aJSON,aElement){aElement.url=aJSON.url;aElement.Url=EGenreDocumentJoint.getUrl(aElement,EGenreRessource.DocJointEtablissement);}
function _composeListeDelegues(aTitre,aListe){var lResult='';lResult+=aTitre+' : ';var lArrayDelegues=[];for(var I=0;I<aListe.GetNbrElements()&&I<2;I++){var lElement=aListe.GetElement(I);lArrayDelegues.push(lElement.GetLibelle());}
lResult+=lArrayDelegues.join(', ');if(aListe.GetNbrElements()>2)
lResult+=', ...';return lResult;}
function _getLibelleEvenement(aParam){var lTab=[],lParam={evenement:null,avecTitre:false,avecDetailConseil:false,avecDateDuJour:true,formatDateDuJour:'['+GTraductions.getValeur('Le').ucfirst()+' %J %MMMM'+']'};$.extend(lParam,aParam);if(lParam.avecTitre){lTab.push(lParam.evenement.GetLibelle());}
var lChaine='';if(GDate.estJourEgal(lParam.evenement.DateDebut,lParam.evenement.DateFin)){if(lParam.avecDateDuJour){lChaine=GDate.FormatDate(lParam.evenement.DateDebut,lParam.formatDateDuJour);}
if(!lParam.evenement.sansHoraire){if(GDate.estHeureIdentique(lParam.evenement.DateDebut,lParam.evenement.DateFin))
lChaine=lChaine+' '+GTraductions.getValeur('A')+' '+GDate.FormatDate(lParam.evenement.DateDebut,'%xhh%mm');else lChaine=lChaine+' '+GTraductions.getValeur('Agenda.De')+' '+GDate.FormatDate(lParam.evenement.DateDebut,'%xhh%mm')+' '+GTraductions.getValeur('A')+GDate.FormatDate(lParam.evenement.DateFin,' %xhh%mm');}}
else{lChaine=GTraductions.getValeur('Agenda.Du')+GDate.FormatDate(lParam.evenement.DateDebut,' %J %MMMM')+' ';if(lParam.evenement.sansHoraire)
lChaine=lChaine+
GTraductions.getValeur('Au')+' '+GDate.FormatDate(lParam.evenement.DateFin,' %J %MMMM');else lChaine=lChaine+
GTraductions.getValeur('A')+' '+GDate.FormatDate(lParam.evenement.DateDebut,'%xhh%mm')+' '+
GTraductions.getValeur('Au')+' '+GDate.FormatDate(lParam.evenement.DateFin,' %J %MMMM')+' '+
GTraductions.getValeur('A')+GDate.FormatDate(lParam.evenement.DateFin,' %xhh%mm');}
lTab.push(lChaine.trim());lTab.push(lParam.evenement.Commentaire);if(lParam.avecDetailConseil){if(lParam.evenement.salle)
lTab.push(GTraductions.getValeur('Agenda.Salle')+' : '+lParam.evenement.salle);if(lParam.evenement.president&&lParam.evenement.president.GetLibelle())
lTab.push(GTraductions.getValeur('Agenda.President')+' : '+lParam.evenement.president.GetLibelle());if(lParam.evenement.listeParentsDelegues&&lParam.evenement.listeParentsDelegues.GetNbrElements()>0)
lTab.push(_composeListeDelegues(GTraductions.getValeur('Agenda.ParentsDelegues'),lParam.evenement.listeParentsDelegues));if(lParam.evenement.listeElevesDelegues&&lParam.evenement.listeElevesDelegues.GetNbrElements()>0)
lTab.push(_composeListeDelegues(GTraductions.getValeur('Agenda.ElevesDelegues'),lParam.evenement.listeElevesDelegues));}
return lTab;}
function _getDateEvenement(aParam){var lParam={evenement:null,avecDateDuJour:true,formatDateDuJour:'['+GTraductions.getValeur('Le')+' %J %MMM'+']'};$.extend(lParam,aParam);var lChaine='';if(GDate.estJourEgal(lParam.evenement.DateDebut,lParam.evenement.DateFin)){if(lParam.avecDateDuJour){lChaine=GDate.FormatDate(lParam.evenement.DateDebut,lParam.formatDateDuJour);}
if(!lParam.evenement.sansHoraire){if(GDate.estHeureIdentique(lParam.evenement.DateDebut,lParam.evenement.DateFin))
lChaine=lChaine+' '+GTraductions.getValeur('A')+' '+GDate.FormatDate(lParam.evenement.DateDebut,'%xhh%mm');else lChaine=lChaine+' '+GTraductions.getValeur('Agenda.De')+' '+GDate.FormatDate(lParam.evenement.DateDebut,'%xhh%mm')+' '+GTraductions.getValeur('A')+GDate.FormatDate(lParam.evenement.DateFin,' %xhh%mm');}}
else{lChaine=GTraductions.getValeur('Agenda.Du')+GDate.FormatDate(lParam.evenement.DateDebut,' %J %MMM')+' ';if(lParam.evenement.sansHoraire)
lChaine=lChaine+
GTraductions.getValeur('Au')+' '+GDate.FormatDate(lParam.evenement.DateFin,' %J %MMM');else lChaine=lChaine+
GTraductions.getValeur('A')+' '+GDate.FormatDate(lParam.evenement.DateDebut,'%xhh%mm')+' '+
GTraductions.getValeur('Au')+' '+GDate.FormatDate(lParam.evenement.DateFin,' %J %MMM')+' '+
GTraductions.getValeur('A')+GDate.FormatDate(lParam.evenement.DateFin,' %xhh%mm');}
return lChaine.toLowerCase().ucfirst();}
ObjetDeserialiser.prototype.reglesSaisieMotDePasse=function(aJSON){if(aJSON&&aJSON.reglesSaisieMDP){$.extend(GEtatUtilisateur.reglesSaisieMotDePasse,aJSON.reglesSaisieMDP);GEtatUtilisateur.reglesSaisieMotDePasse.init=true;}};}());;
MethodesObjet.heritagePrototype(ObjetRequeteAuthentificationPN,_ObjetRequeteXmlConsultationPN);function ObjetRequeteAuthentificationPN(aPere,aEvenementSurReussite,aEvenementSurEchec,aActionAvantDeserialisation){this.inheritedCreate(aPere,aEvenementSurReussite,aEvenementSurEchec);if(aActionAvantDeserialisation)
this.callbackAvantDeserialisation=new Callback(aPere,aActionAvantDeserialisation);}
IE.Requetes.inscrire('Authentification',ObjetRequeteAuthentificationPN,_ObjetRequeteXmlConsultationPN);(function(){ObjetRequeteAuthentificationPN.prototype.lancerRequete=function(aGenreConnexion,aChallenge,aAuthentifiant,aIv){this.authentifiant=aAuthentifiant;this.challenge=aChallenge;this.iv=aIv;var lXml=this.XML;lXml.CreerCategorie(null,'Connexion' ,aGenreConnexion);this.challenge=GCryptage.decrypter({genreCryptage:EGenreCryptage.AES,chaine:this.challenge,cle:this.authentifiant.getCle(),iv:this.iv,avecAlea:true});lXml.CreerVariable(null,'Challenge',EGenreType.String,GCryptage.encrypter({genreCryptage:EGenreCryptage.AES,chaine:this.challenge,cle:this.authentifiant.getCle(),iv:this.iv}));this.appelAsynchroneConsultation({messageDetail:GTraductions.getValeur('Authentification')});};ObjetRequeteAuthentificationPN.prototype.actionApresRequete=function(aXml){if(this.callbackAvantDeserialisation)
this.callbackAvantDeserialisation.appel();this.XML=aXml;if(aXml.Existe(null,'Acces'))
this.callbackEchec.appel(aXml.GetGenre(null,'Acces'));else{this._deserialiserReussite(aXml);}};ObjetRequeteAuthentificationPN.prototype._deserialiserReussite=function(aXml){if(aXml.Existe(null,'Cle')){GApplication.getCommunication().cleAES=GCryptage.decrypter({genreCryptage:EGenreCryptage.AES,chaine:aXml.GetVariable(null,'Cle'),cle:this.authentifiant.getCle(),iv:this.iv});}
if(this.JSONReponse.parametresUtilisateur){GApplication.parametresUtilisateur.chargerJSON(this.JSONReponse.parametresUtilisateur);}
if(this.JSONReponse){GApplication.droits.chargerJSON(this.JSONReponse);}
this.deserialiserOnglets();this.deserialiserRessources(aXml);this.deserialiserInfosSupp(aXml);this.deserialiserPage(aXml);this.deserialiserJetonConnexionAuto(this.JSONReponse);new ObjetDeserialiser().reglesSaisieMotDePasse(this.JSONReponse);GParametres.domaineVerrou=this.JSONReponse.domaineVerrou?this.JSONReponse.domaineVerrou:new TypeDomaine();this.callbackReussite.appel(null,this.ressource,this.listeRessources,this.infosSupp);};ObjetRequeteAuthentificationPN.prototype.deserialiserJetonConnexionAuto=function(aJSON){};ObjetRequeteAuthentificationPN.prototype.deserialiserRessources=function(aXml){this.ressource=aXml.GetElement(null,'Ressource');this.ressource.libelleLong=this.ressource.Libelle;var lNoeud=aXml.GetCategorie(null,'Ressource');this.listeRessources=new ObjetListeElements();if(aXml.Existe(lNoeud,'GroupeRessources'))
aXml.Parcourir(lNoeud,'GroupeRessources',this,this.addGroupeRessources,false,{liste:this.listeRessources});else aXml.Parcourir(lNoeud,'Ressource' ,this,this.addRessource ,false,{liste:this.listeRessources});this.listeRessources.setTri([
ObjetTri.init(function(D){return D.pere?D.pere.GetLibelle():D.Position>0?D.Position:D.GetLibelle();}),ObjetTri.init(function(D){return!D.estGroupeDeRessource;}),ObjetTri.init(function(D){return D.Position>0?D.Position:D.GetLibelle();})
]);this.listeRessources.trier();if(this.JSONReponse.ressource){var lJUtilisateur=this.JSONReponse.ressource;var lUtilisateur=new ObjetElement().fromJSON(lJUtilisateur),lElementOrigine;if(lJUtilisateur.listeRessources){for(var i=0;i<lJUtilisateur.listeRessources.length;i++){var lJMembre=lJUtilisateur.listeRessources[i];var LMembre=new ObjetElement().fromJSON(lJMembre);lElementOrigine=this.listeRessources.GetElementParElement(LMembre);this.deserialiserRessourceJSON(lJMembre,lElementOrigine);}}
else{lElementOrigine=this.listeRessources.GetElementParElement(lUtilisateur);this.deserialiserRessourceJSON(lJUtilisateur,lElementOrigine);}}};ObjetRequeteAuthentificationPN.prototype.deserialiserPage=function(aXml){};function _ajouterOnglet(aJSON,aProfondeur,aOngletPere){var lOnglet=new ObjetElement().fromJSON(aJSON);if(GEtatUtilisateur.listeOngletsInvisibles&&IE.MethodesTableau.existe(lOnglet.GetGenre(),GEtatUtilisateur.listeOngletsInvisibles)){lOnglet.Actif=false;}
lOnglet.Libelle=GChaine.ToHTML(GTraductions.getValeur('Onglet.Libelle')[lOnglet.GetGenre()]);lOnglet.libelleLong=GTraductions.getValeur('Onglet.LibelleLong')[lOnglet.GetGenre()]!==' '?GTraductions.getValeur('Onglet.LibelleLong')[lOnglet.GetGenre()]:lOnglet.Libelle;if(lOnglet.Actif!==false&&GEtatUtilisateur.listeGenreOngletsNotification&&IE.MethodesTableau.existe(lOnglet.GetGenre(),GEtatUtilisateur.listeGenreOngletsNotification)){var lElementNotification=MethodesObjet.dupliquer(lOnglet);lElementNotification.profondeur=0;lElementNotification.avecClic=true;GEtatUtilisateur.listeOngletsNotification.AddElement(lElementNotification);}
lOnglet.profondeur=aProfondeur;if(aOngletPere) lOnglet.onglet=aOngletPere;GEtatUtilisateur.listeOnglets.AddElement(lOnglet);var i,lAvecFilsActifs=false;if(aJSON.Onglet){for(i=0;i<aJSON.Onglet.length;i++){lAvecFilsActifs=_ajouterOnglet(aJSON.Onglet[i],aProfondeur+1,lOnglet)||lAvecFilsActifs;}
if(!lAvecFilsActifs){lOnglet.Actif=false;}}
return lOnglet.Actif;}
ObjetRequeteAuthentificationPN.prototype.deserialiserOnglets=function(){var i;GEtatUtilisateur.listeOngletsInvisibles=this.JSONReponse.listeOngletsInvisibles;GEtatUtilisateur.listeGenreOngletsNotification=this.JSONReponse.listeOngletsNotification;if(this.JSONReponse.listeOnglets){GEtatUtilisateur.listeOnglets=new ObjetListeElements();GEtatUtilisateur.listeOngletsNotification=new ObjetListeElements();for(i=0;i<this.JSONReponse.listeOnglets.length;i++){_ajouterOnglet(this.JSONReponse.listeOnglets[i],0,null);}}};ObjetRequeteAuthentificationPN.prototype.deserialiserInfosSupp=function(aXml){};ObjetRequeteAuthentificationPN.prototype.addGroupeRessources=function(aXml,aNoeud,I,aParametre,P){;};ObjetRequeteAuthentificationPN.prototype.addRessource=function(aXml,aNoeud,I,aParametre,P){;};}());;
MethodesObjet.heritagePrototype(ObjetRequeteAuthentificationEspace,ObjetRequeteAuthentificationPN);function ObjetRequeteAuthentificationEspace(aPere,aEvenementSurReussite,aEvenementSurEchec,aActionAvantDeserialisation){this.inheritedCreate(aPere,aEvenementSurReussite,aEvenementSurEchec,aActionAvantDeserialisation);}(function(){ObjetRequeteAuthentificationEspace.prototype.deserialiserPage=function(aXml){var lPage=aXml.GetVariable(null,'Page');if(lPage){lPage.membre=lPage.Membre?new ObjetElement('',lPage.Membre):null;lPage.periode=new ObjetElement('',lPage.Periode);lPage.competence=new ObjetElement('',lPage.Competence);lPage.service=new ObjetElement('',lPage.Service);}
GEtatUtilisateur.setPage(lPage);};ObjetRequeteAuthentificationEspace.prototype.deserialiserInfosSupp=function(){this.infosSupp={};GEtatUtilisateur.urlInstallClient=this.JSONReponse.UrlInstallClient;GEtatUtilisateur.urlParamClient=this.JSONReponse.UrlParamClient;GEtatUtilisateur.designationClient=this.JSONReponse.designationClient;var LJEnvoiEmail=this.JSONReponse.EnvoiEmailEtablissement;if(LJEnvoiEmail&&LJEnvoiEmail.AvecEnvoiEmailEtablissement){this.infosSupp.emailWebmaster=LJEnvoiEmail.Webmaster;this.infosSupp.emailSecretariat=LJEnvoiEmail.Secretariat;} else{this.infosSupp.emailWebmaster=false;this.infosSupp.emailSecretariat=false;}
this.infosSupp.listeMotifsAbsences=this.JSONReponse.listeMotifsAbsences;this.infosSupp.listeMotifsRetards=this.JSONReponse.listeMotifsRetards;GEtatUtilisateur.autorisationIManuel=!!this.JSONReponse.autorisationIManuel;GEtatUtilisateur.autorisationKiosque=!!this.JSONReponse.autorisationKiosque;GEtatUtilisateur.autorisationCloud=!!this.JSONReponse.autorisationCloud;GEtatUtilisateur.derniereConnexion=this.JSONReponse.derniereConnexion;GEtatUtilisateur.listeCloud=this.JSONReponse.listeCloud||new ObjetListeElements();this.infosSupp.listeMatieres=this.JSONReponse.listeMatieres;this.infosSupp.listeNiveaux=this.JSONReponse.listeNiveaux;this.infosSupp.existeCDTsDetaches=this.JSONReponse.existeCDTsDetaches;};ObjetRequeteAuthentificationEspace.prototype.addGroupeRessources=function(aXml,aNoeud,I,aParametre,P){var LElement=this.XML.GetElement(aNoeud);LElement.ClassAffichage='Gras';LElement.AvecSelection=false;LElement.estGroupeDeRessource=true;LElement.Numero=0;aParametre.liste.AddElement(LElement);aXml.Parcourir(aNoeud,'Ressource',this,this.addRessource,false,{liste:aParametre.liste,pere:LElement},LElement.Position);};ObjetRequeteAuthentificationEspace.prototype.deserialiserRessourceJSON=function(aJSON,aElement){if(aJSON.listeSessions){aElement.listeSessionsRencontreDesiderataIndispo=aJSON.listeSessions.getListeElements(function(D){return D.visibleDesiderataIndispo;});aElement.listeSessionsRencontrePlanning=aJSON.listeSessions.getListeElements(function(D){return D.visiblePlanning;});}
aElement.autoriserConnexionIManuel=aJSON.autoriserConnexionIManuel;if(aJSON.listeProfesseurs&&aElement.listeClasses){aElement.listeProfesseurs=aJSON.listeProfesseurs;aElement.listeProfesseurs.parcourir(_traiterListeProfesseurs.bind(this,aElement.listeClasses));aElement.listeProfesseurs.trier();}
if(MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Parent,EGenreEspace.Eleve,EGenreEspace.Entreprise])){aElement.Classe=new ObjetElement().fromJSON(aJSON.classeDEleve);if(aElement.Classe.GetLibelle())
aElement.libelleLong=aElement.GetLibelle()+' ('+aElement.Classe.GetLibelle()+')';aElement.listeClasseHistorique=aJSON.listeClassesHistoriques;aElement.ListeGroupes=aJSON.listeGroupes;}
if(GEtatUtilisateur.GenreEspace===EGenreEspace.Eleve)
this.ressource.libelleLong=aElement.libelleLong;};function _traiterListeProfesseurs(aListeClasses ,aProfesseur){var lArrayClasse=aProfesseur.listeClasses;aProfesseur.listeClasses=new ObjetListeElements();var lClasse,lClasseCopie,i;if(aProfesseur.GetGenre()===0)
aProfesseur.Position=0;if(lArrayClasse){for(i=0;i<lArrayClasse.length;i++){lClasse=aListeClasses.GetElement(lArrayClasse[i]);if(lClasse){lClasseCopie=new ObjetElement(lClasse.GetLibelle(),lClasse.GetNumero(),lClasse.GetGenre());lClasseCopie.estResponsable=lClasse.estResponsable;aProfesseur.listeClasses.AddElement(lClasseCopie);}}}}
ObjetRequeteAuthentificationEspace.prototype.addRessource=function(AXml,ANoeud,aI,AParametre,P){var LElement=this.XML.GetElement(ANoeud);if(AParametre.pere){LElement.pere=AParametre.pere;LElement.ClassAffichage='GrandEspaceGauche';}
LElement.autorisations={};LElement.libelleLong=LElement.Libelle;LElement.ListeGroupes=this.XML.GetListeElements(ANoeud,'Groupe');LElement.listeClasses=new ObjetListeElements();AXml.Parcourir(ANoeud,'Classe',this,this.addClasse,false,LElement.listeClasses);if(AXml.Existe(ANoeud,'ListeClassesBase')){LElement.listeClassesBase=new ObjetListeElements();AXml.Parcourir(AXml.GetCategorie(ANoeud,'ListeClassesBase'),'Classe',this,this.addClasse,false,LElement.listeClassesBase);LElement.listeClasses=new ObjetListeElements();for(var I=0;I<LElement.listeClassesBase.GetNbrElements();I++){var lClasse=LElement.listeClassesBase.GetElement(I);LElement.listeClasses.AddElement(MethodesObjet.dupliquer(lClasse));}}
if(AXml.Existe(ANoeud,'ListePeriodes'))
LElement.listeComboPeriodes=new ObjetDeserialiser().listePeriodes(AXml,ANoeud);if(AXml.Existe(ANoeud,'ListeAnneesPrecedentes'))
LElement.listeAnneesPrecedentes=AXml.GetListeElements(AXml.GetCategorie(ANoeud,'ListeAnneesPrecedentes'),'Annee',true,this._ajouterAnneePrecedente);LElement.tableauOnglets=[];AXml.Parcourir(ANoeud,'Onglet',this,this.addOnglet,false,LElement.tableauOnglets);if(AXml.Existe(ANoeud,'accesAutorise')){LElement.acces={autorise:AXml.GetVariable(ANoeud,'accesAutorise'),autoriseSurDate:AXml.GetVariable(ANoeud,'accesAutoriseSurDate'),dateDebut:AXml.GetVariable(ANoeud,'accesDateDebut'),dateFin:AXml.GetVariable(ANoeud,'accesDateFin')};}
if(AXml.Existe(ANoeud,'dateDebutConsultation'))
LElement.dateDebutConsultation=AXml.GetVariable(ANoeud,'dateDebutConsultation');if(AXml.Existe(ANoeud,'dateFinConsultation'))
LElement.dateFinConsultation=AXml.GetVariable(ANoeud,'dateFinConsultation');AParametre.liste.AddElement(LElement);};ObjetRequeteAuthentificationEspace.prototype.addPilier=function(AXml,ANoeud,I,AParametre,P){var lElement=AXml.GetElement(ANoeud);lElement.listeClasses=AXml.GetListeElements(ANoeud,'Classe');lElement.avecService=AXml.GetVariable(ANoeud,'AvecService');lElement.service=AXml.GetElement(ANoeud,'Service');lElement.listePaliers=AXml.GetListeElements(ANoeud,'Palier');lElement.AddTri(lElement.Position);lElement.AddTri(lElement.service?lElement.service.GetLibelle():'');AParametre.AddElement(lElement);};ObjetRequeteAuthentificationEspace.prototype.addClasseDOnglet=function(AXml,ANoeud,I,AParametre,P){var lElement=AXml.GetElement(ANoeud);lElement.avecFiliere=AXml.Existe(ANoeud,'avecFiliere')?AXml.GetVariable(ANoeud,'avecFiliere'):false;if(AXml.Existe(ANoeud,'DisciplineBrevet')){lElement.listeDisciplinesBrevet=AXml.GetListeElements(ANoeud,'DisciplineBrevet');lElement.listeDisciplinesBrevet.Trier();}
else{lElement.listeDisciplinesBrevet=new ObjetListeElements();}
if(AXml.Existe(ANoeud,'DisciplineLivret')){lElement.listeDisciplinesLivret=AXml.GetListeElements(ANoeud,'DisciplineLivret',true,this._ajouterInfoDiscipline);}
else{lElement.listeDisciplinesLivret=new ObjetListeElements();}
AParametre.AddElement(lElement);};ObjetRequeteAuthentificationEspace.prototype._addDatePublication=function(AXml,ANoeud,aElementCree){if(AXml.Existe(ANoeud,'DatePublication'))
aElementCree.datePublication=AXml.GetVariable(ANoeud,'DatePublication');};ObjetRequeteAuthentificationEspace.prototype.addClasse=function(AXml,ANoeud,I,AParametre,P){var lElement=AXml.GetElement(ANoeud);lElement.niveau=AXml.GetElement(ANoeud,'Niveau');lElement.enseigne=AXml.GetVariable(ANoeud,'enseigne');lElement.estResponsable=AXml.GetVariable(ANoeud,'estResponsable');lElement.listePeriodes=AXml.GetListeElements(ANoeud,'Periode',false,this._addDatePublication);lElement.periodeParDefaut=AXml.GetElement(ANoeud,'PeriodeParDefaut');AParametre.AddElement(lElement);};ObjetRequeteAuthentificationEspace.prototype.addOnglet=function(AXml,ANoeud,I,AParametre,P){AParametre[AXml.GetGenre(ANoeud)]={};if(AXml.Existe(ANoeud,'Pilier')){AParametre[AXml.GetGenre(ANoeud)].listePiliers=new ObjetListeElements();AXml.Parcourir(ANoeud,'Pilier',this,this.addPilier,false,AParametre[AXml.GetGenre(ANoeud)].listePiliers);}
if(AXml.Existe(ANoeud,'Classe')){AParametre[AXml.GetGenre(ANoeud)].listeClasses=new ObjetListeElements();AXml.Parcourir(ANoeud,'Classe',this,this.addClasseDOnglet,false,AParametre[AXml.GetGenre(ANoeud)].listeClasses);}
if(AXml.Existe(ANoeud,'Periode'))
AParametre[AXml.GetGenre(ANoeud)].listePeriodes=AXml.GetListeElements(ANoeud,'Periode',false,this._addDatePublication);AParametre[AXml.GetGenre(ANoeud)].periodeParDefaut=AXml.GetElement(ANoeud,'PeriodeParDefaut');};ObjetRequeteAuthentificationEspace.prototype._ajouterAnneePrecedente=function(aXml,aNoeud,aElement){aElement.dateDebut=aXml.GetVariable(aNoeud,'DateDebut');aElement.dateFin=aXml.GetVariable(aNoeud,'DateFin');};ObjetRequeteAuthentificationEspace.prototype._ajouterInfoDiscipline=function(aXml,aNoeud,aElement){aElement.typeEnseignement=aXml.GetVariable(aNoeud,'TypeEnseignement');aElement.horsLivret=aXml.Existe(aNoeud,'HorsLivret')?aXml.GetVariable(aNoeud,'HorsLivret'):false;aElement.horsService=aXml.Existe(aNoeud,'HorsService')?aXml.GetVariable(aNoeud,'HorsService'):false;aElement.service=aXml.GetElement(aNoeud,'Service');aElement.AddTri(aElement.horsLivret?'1_':'0_');aElement.AddTri(aElement.GetLibelle());};})();;
MethodesObjet.heritagePrototype(ObjetInterfaceIdentification,ObjetAbstraitInterface);function ObjetInterfaceIdentification(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.LibelleOngletCompte=GTraductions.getValeur('Onglet.Libelle')[EGenreOnglet.InfosPerso];}(function(){ObjetInterfaceIdentification.prototype.SetParametresGeneraux=function(){this.GenreStructure=EStructureAffichage.Autre;};ObjetInterfaceIdentification.prototype.ConstruireInstances=function(){this.idConnexion=this.Add(window.ObjetConnexion ,this.evenementConnexion ,this.initialiserConnexion);if(window.ObjetFenetreRecupIdMDP)
this.identFenetreRecupIdMDP=this.addFenetre(window.ObjetFenetreRecupIdMDP,null ,this.initialiserRecupIdMDP);};ObjetInterfaceIdentification.prototype.initialiserConnexion=function(aInstance){var lNumerotation=0;var lImageEspace='Image_EspaceInvites';switch(GEtatUtilisateur.GenreEspace){case EGenreEspace.Professeur:lImageEspace='Image_EspaceEnseignants';break;case EGenreEspace.Eleve:lImageEspace='Image_EspaceEtudiants';break;case EGenreEspace.Etablissement:lImageEspace='Image_EspaceSecretariat';break;case EGenreEspace.Parent:lImageEspace='Image_EspaceParents';break;case EGenreEspace.Entreprise:lImageEspace='Image_EspaceEntreprise';break;case EGenreEspace.Academie:lImageEspace='Image_EspaceAcademie';break;}
var lModeConnexionListe=null;var lModeConnexionSelection=null;if(GParametres.avecChoixConnexion){lNumerotation=1;lModeConnexionListe=new ObjetListeElements();lModeConnexionListe.AddElement(new ObjetElement(GTraductions.getValeur('connexion.modeConnexion1')));lModeConnexionListe.AddElement(new ObjetElement(GTraductions.getValeur('connexion.modeConnexion2')));lModeConnexionSelection=new TypeDomaine(1);if(IE.optionsEspaceLocal&&(IE.optionsEspaceLocal.getGenreConnexion()===1)){lModeConnexionSelection=new TypeDomaine(IE.optionsEspaceLocal.getGenreConnexion()+1);GEtatUtilisateur.setGenreConnexion(IE.optionsEspaceLocal.getGenreConnexion());}}
var lRecupIdMdp=MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Parent,EGenreEspace.Eleve])&&GParametres.avecRecuperationInfosConnexion;aInstance.SetTraductions({texteBouton:GTraductions.getValeur('connexion.seConnecter'),titreBouton:GTraductions.getValeur('connexion.seConnecterTitre'),texteModeConnexion:GParametres.avecChoixConnexion?GTraductions.getValeur('connexion.modeConnexion'):'',texteExplicatifModeConnexion:GParametres.avecChoixConnexion?(lNumerotation)+'. <strong>'+GTraductions.getValeur('connexion.modeConnexionTitre')+'</strong><br />'+GTraductions.getValeur('connexion.modeConnexionMessage'):'',demoIdentifiant:GApplication.getDemo()?GTraductions.getValeur('Demo.Identifiant'):'',demoMotdepasse:GApplication.getDemo()?GTraductions.getValeur('Demo.MotDePasse'):'',texteExplicatifIdentifiant:(lNumerotation+1)+'. <strong>'+GTraductions.getValeur('connexion.identifiantTitre'+(GApplication.getDemo()?'Demo':''))+'</strong><br />'+GTraductions.getValeur('connexion.identifiantMessage'),texteIdentifiant:GTraductions.getValeur('connexion.identifiant'),texteTitreIdentifiant:GTraductions.getValeur('connexion.identifiantInfo'+(GApplication.getDemo()?'Demo':'')),texteTitreMotdepasse:GTraductions.getValeur('connexion.motDePasseInfo'+(GApplication.getDemo()?'Demo':'')),texteExplicatifMotdepasse:(lNumerotation+2)+'. <strong>'+GTraductions.getValeur('connexion.motDePasseTitre'+(GApplication.getDemo()?'Demo':''),[GParametres.GetNomEspace()])+'</strong><br />'+GTraductions.getValeur('connexion.motDePasseMessage'+(GApplication.getDemo()?'Demo':''),[this.LibelleOngletCompte]),texteMotdepasse:GTraductions.getValeur('connexion.motDePasse'),texteRecupIdMdp:lRecupIdMdp?GTraductions.getValeur('connexion.RecuperationMDP.texte'):'',texteExplicatifRecupIdMdp:lRecupIdMdp?GTraductions.getValeur('connexion.RecuperationMDP.titre'):''});var lObjetImage=GImageConnexion.getObjetImagePronote();aInstance.SetParametres({titreEtablissement:GChaine.AvecEspaceSiVide(GParametres.NomEtablissement),sousTitre:GTraductions.getValeur('AnneeScolaire')+' '+GParametres.anneeScolaire,urlLien:GParametres.urlSiteIndexEducation,titreLien:GParametres.version,texteLien:'<div class="Texte10" style="float: right; padding-top: 6px;margin-right:2px;">&copy; '+GParametres.millesime+'</div><div class="Image_Logo_Pronote" style="float: right;">&nbsp;</div>',classImageEspace:lImageEspace,genreFondImage:GParametres.genreImageConnexion,classFondImage:lObjetImage.classeImage,classFondImageCarte:lObjetImage.classeImageCarte,classFondBg:lObjetImage.classeFond||GImageConnexion.getClassFond(),imageFondBg:GParametres.urlImageConnexion,couleurFondBg:lObjetImage.couleurFond,couleurConnexion:lObjetImage.couleurConnexion,htmlLogo:lObjetImage.classeLogo?'<div style="position:absolute;bottom:5px;right:5px;" class="'+lObjetImage.classeLogo+'">'+(lObjetImage.lienLogo?'<a onclick="$.get(\'https://www.index-education.com/swie/tl.php?ln=w\');" href="'+lObjetImage.lienLogo+'" style="width:100%;height:100%;" class="InlineBlock"></a>':'')+'</div>':'',nomEspace:GParametres.GetNomEspace(),modeDemo:GApplication.getDemo(),avecModeConnexion:GParametres.avecChoixConnexion,modeConnexionListe:lModeConnexionListe,modeConnexionSelection:lModeConnexionSelection,avecRecupIdMdp:lRecupIdMdp,infoWAIident:GTraductions.getValeur('connexion.identifiant')});};ObjetInterfaceIdentification.prototype.evenementConnexion=function(aElement,aParam){switch(aElement){case EGenreConnexionEvenement.Identifiant:if(GNavigateur.IsToucheRetourChariot()||GNavigateur.IsToucheOnlyTab())this.GetInstance(this.idConnexion).setFocusMdp();break;case EGenreConnexionEvenement.Connexion:this.traiterEvenementValidation(aParam.identifiant,aParam.motdepasse);break;case EGenreConnexionEvenement.Checkbox:this.evenementCheckBox(aParam.selection);break;case EGenreConnexionEvenement.RecupIdMdp:this.evenementRecupIdMDP();break;default:break;}};ObjetInterfaceIdentification.prototype.initialiserRecupIdMDP=function(aInstance){aInstance.SetParametres_Fenetre(GTraductions.getValeur('fenetreRecupIdMDP.titre'),675,330,[GTraductions.getValeur('principal.annuler')],true,false,false,550,323,false);};ObjetInterfaceIdentification.prototype.RecupererDonnees=function(){if(GApplication.getDemo())
this.GetInstance(this.idConnexion).setFocusValid();else{if(!GNavigateur.isIpad) this.GetInstance(this.idConnexion).setFocusIdent();}};ObjetInterfaceIdentification.prototype.evenementCheckBox=function(aSelection){GEtatUtilisateur.setGenreConnexion(aSelection.getNombre()-1);};ObjetInterfaceIdentification.prototype.ConstruireStructureAffichageAutre=function(){if(GApplication.acces&&GApplication.acces.estConnexionCAS())
return'<div class="GrandEspaceHaut GrandEspaceGauche Gras">'+GTraductions.getValeur('connexion.ConnexionCAS')+'</div>';else{var H=[];H.push(GMessageInformatif.Compose());H.push('<div id="'+this.GetInstance(this.idConnexion).GetNom()+'" class="PageEspace" style="position : relative;min-height:100%;"></div>');return H.join('');}};ObjetInterfaceIdentification.prototype.DeclencherConnexionAutomatique=function(){this.traiterEvenementValidation(this.authentifiant.login,this.authentifiant.motDePasse);};ObjetInterfaceIdentification.prototype.traiterEvenementValidation=function(aLogin,aMotDePasse,aPourENT){this.authentifiant=new ObjetAuthentifiant(aLogin.trim(),aMotDePasse.trim(),aPourENT);if((this.authentifiant.getLogin().length>0)&&(this.authentifiant.getMotDePasse().length>0)&&!this.GetInstance(this.idConnexion)._bloquageRequeteAuthentification){new ObjetRequeteIdentification(this,this.ActionApresReponseEvenementIdentification).lancerRequete(this.authentifiant);} else this.GetInstance(this.idConnexion).debloquerAuthentification();};ObjetInterfaceIdentification.prototype.evenementRecupIdMDP=function(){this.GetInstance(this.identFenetreRecupIdMDP).Afficher();};ObjetInterfaceIdentification.prototype.ActionApresReponseEvenementIdentification=function(aChallenge,aModeLogin,aModeMotDePasse){if(aChallenge)
this.Challenge=aChallenge;this.authentifiant.setMode(aModeLogin,aModeMotDePasse);this.TraiterEvenementAuthentification();};ObjetInterfaceIdentification.prototype.TraiterEvenementAuthentification=function(){var lRequete=new ObjetRequeteAuthentificationEspace(this,this._reussiteAuthentification,this._echecAuthentification,this._avantDeserialisation);lRequete.lancerRequete(GEtatUtilisateur.genreConnexion,this.Challenge,this.authentifiant,GApplication.getCommunication().ivAES);};function _ongletAutorise(aGenreOnglet){var lOK=false;GEtatUtilisateur.listeOnglets.parcourir(function(aOnglet){if(aOnglet.GetGenre()===aGenreOnglet&&aOnglet.Actif){lOK=true;return false;}});return lOK;}
function _getOngletDemarrage(){var lOnglet=null;if(GEtatUtilisateur.getGenreOnglet()!==undefined)
return lOnglet;if(GApplication.parametresUtilisateur.has('onglet')&&_ongletAutorise(GApplication.parametresUtilisateur.get('onglet'))&&(GEtatUtilisateur.GenreEspace!==EGenreEspace.Professeur||GEtatUtilisateur.genreConnexion===EGenreConnexion.Normale)){lOnglet=GApplication.parametresUtilisateur.get('onglet');}
if(GEtatUtilisateur.avecPageAccueil()&&_ongletAutorise(EGenreOnglet.Accueil)&&((GApplication.parametresUtilisateur.has('demarrerSurPageAccueil')&&GApplication.parametresUtilisateur.get('demarrerSurPageAccueil'))||
lOnglet===null)){lOnglet=EGenreOnglet.Accueil;}
return lOnglet;}
ObjetInterfaceIdentification.prototype._avantDeserialisation=function(){this.GetInstance(this.idConnexion).debloquerAuthentification();};ObjetInterfaceIdentification.prototype._reussiteAuthentification=function(aBidonXiti,aRessource,aListeRessources,aInfosSupp){var lOnglet;GEtatUtilisateur.SetIdentification(aRessource,aListeRessources);for(var I=0;I<GEtatUtilisateur.listeOnglets.GetNbrElements();I++){lOnglet=GEtatUtilisateur.listeOnglets.GetElement(I);lOnglet.Actif=lOnglet.Actif!==false;lOnglet.Visible=(lOnglet.Genre!==EGenreOnglet.Accueil);lOnglet.estUnOnglet=lOnglet.onglet===null||lOnglet.onglet===undefined;if(!lOnglet.estUnOnglet&&lOnglet.Actif)
lOnglet.onglet.avecSousOnglet=true;}
lOnglet=_getOngletDemarrage();if(lOnglet!==null){GEtatUtilisateur.setGenreOnglet(lOnglet);}
else{IE.Requetes('Presence').lancerRequete();}
GEtatUtilisateur.listeMotifsAbsences=aInfosSupp.listeMotifsAbsences;GEtatUtilisateur.listeMotifsRetards=aInfosSupp.listeMotifsRetards;GEtatUtilisateur.emailWebmaster=aInfosSupp.emailWebmaster;GEtatUtilisateur.emailSecretariat=aInfosSupp.emailSecretariat;GEtatUtilisateur.listeMatieres=aInfosSupp.listeMatieres;GEtatUtilisateur.listeNiveaux=aInfosSupp.listeNiveaux;var lParametres={libelle:aRessource.libelleLong,listeRessource:aListeRessources};GApplication.afficherEspaceApresAuthentification(lParametres);};ObjetInterfaceIdentification.prototype._echecAuthentification=function(aAcces){if(!MethodesObjet.isUndefined(aAcces)){this.messageErreur(aAcces);}};ObjetInterfaceIdentification.prototype.messageErreur=function(AGenreErreur){var lErreur={erreurTitre:null,erreurMessage:null,erreurBandeau:null};switch(AGenreErreur){case EGenreErreurAcces.Identification:lErreur={erreurMessage:GTraductions.getValeur('connexion.ErreurIdentification')};break;case EGenreErreurAcces.Autorisation:lErreur={erreurMessage:GTraductions.getValeur('connexion.ErreurAutorisation',[GParametres.NomEspace]),erreurTitre:GTraductions.getValeur('connexion.AccesRefuse')};break;case EGenreErreurAcces.ConnexionClasse:lErreur={erreurMessage:GTraductions.getValeur('connexion.ErreurConnexionClasse')};break;case EGenreErreurAcces.AucuneRessource:lErreur={erreurMessage:GTraductions.getValeur('connexion.ErreurAucuneRessource',[GParametres.NomEspace]),erreurTitre:GTraductions.getValeur('connexion.AccesRefuse')};break;case EGenreErreurAcces.Connexion:lErreur={erreurMessage:GTraductions.getValeur('connexion.ErreurConnexion')};break;case EGenreErreurAcces.PersonnalisationMDP:lErreur={erreurMessage:GTraductions.getValeur('connexion.ErreurPersonnalisationMDP'),erreurTitre:GTraductions.getValeur('connexion.AccesRefuse')};break;default:break;}
this.GetInstance(this.idConnexion).setMessageErreur(lErreur);if(GApplication.getDemo()) this.GetInstance(this.idConnexion).erreurConnexion(EGenreConnexionActionErreur.Rien);else this.GetInstance(this.idConnexion).erreurConnexion(EGenreConnexionActionErreur.ViderMdp);};ObjetInterfaceIdentification.prototype.surResizeInterface=function(){this.GetInstance(this.idConnexion).centrer();};}());;
IE.optionsEspaceLocal={genreCle:{Racine:'OPTIONS_ESPACE_',ModeAccessible:'modeA'},getOptionsJSON:function(){var lJSON=IE.localStorage.getItemJSON(this.genreCle.Racine+(window.GApplication&&GApplication.nomProduit?GApplication.nomProduit:''));if(!lJSON){lJSON={};}
return lJSON;},setOptionsJSON:function(aJSON){IE.localStorage.setItemJSON(this.genreCle.Racine+(window.GApplication&&GApplication.nomProduit?GApplication.nomProduit:''),aJSON);},getModeAccessible:function(aEspace){return!!this.getOptionsJSON()[this.genreCle.ModeAccessible+'_'+aEspace];},setModeAccessible:function(aModeAccessible,aEspace){var lJSON=this.getOptionsJSON();if(aModeAccessible){lJSON[this.genreCle.ModeAccessible+'_'+aEspace]=true;}
else{delete lJSON[this.genreCle.ModeAccessible+'_'+aEspace];}
this.setOptionsJSON(lJSON);}};;

IE.optionsEspaceLocal.genreCle.GenreConnexion='genreConnexion';IE.optionsEspaceLocal.getGenreConnexion=function(){return this.getOptionsJSON()[this.genreCle.GenreConnexion];};IE.optionsEspaceLocal.setGenreConnexion=function(aGenreConnexion){var lJSON=this.getOptionsJSON();lJSON[this.genreCle.GenreConnexion]=aGenreConnexion;this.setOptionsJSON(lJSON);};;
MethodesObjet.heritagePrototype(ObjetFenetre_LienPdf,ObjetFenetre);function ObjetFenetre_LienPdf(ANom,AIdent,APere,AEvenement){this.inheritedCreate(ANom,AIdent,APere,AEvenement);this.SetParametres_Fenetre(GTraductions.getValeur('GenerationPDF.Lien.TitreLienPDF'),300,110,[GTraductions.getValeur('Fermer')]);this._delaiFermeture=2*60;}(function(){function _actualiserTimer(aNombreSecondes){var lNombreSecondes=aNombreSecondes-1;this._timerActualisation=setTimeout(_actualiserTimer.bind(this,lNombreSecondes),1000);GHtml.setHtml(this.Nom+'_timer',GChaine.Format(GTraductions.getValeur('GenerationPDF.Lien.LienValidePendant'),[aNombreSecondes]));}
ObjetFenetre_LienPdf.prototype.DetruireInstances=function(){this.inherited('DetruireInstances');clearTimeout(this._timerFermeture);clearTimeout(this._timerActualisation);};ObjetFenetre_LienPdf.prototype.setDonnees_LienPDF=function(aUrl){var H=[];H.push('<div class="Texte10 AlignementMilieu EspaceHaut">','<a href="'+aUrl+'" target="_blank" onclick="'+this.GetNom()+'.Fermer()">',GTraductions.getValeur('GenerationPDF.Lien.CliquerIci'),'</a>','</br>','</br>','<label id="',this.Nom+'_timer','"></label>','</div>');this.Afficher(H.join(''));this._timerFermeture=setTimeout(this.Fermer.bind(this),this._delaiFermeture*1000);_actualiserTimer.bind(this)(this._delaiFermeture);};}());;

function _ObjetInterfaceEspaceCP(ANom,AIdent,APere,AEvenement){this.inheritedCreate(ANom,AIdent,APere,AEvenement);$(document).keydown({instance:this},this.controleTouche);IE.Invocateur.abonner(Invocateur.events.autorisationRechargementPage,this.confirmationDeconnexion,this);}
IE.MethodesObjet.heritagePrototype(_ObjetInterfaceEspaceCP,ObjetAbstraitInterface);(function(){_ObjetInterfaceEspaceCP.prototype.DetruireInstances=function(){IE.Invocateur.desabonner(Invocateur.events.autorisationRechargementPage);$(document).unbind('keydown',this.controleTouche);};function _initialiserFenetreImpression(AInstance){AInstance.SetParametres_Fenetre(GTraductions.getValeur('ApercuAvantImpression'),800,550,new Array(GTraductions.getValeur('Annuler'),GTraductions.getValeur('Imprimer')));}
function _ouvrirFenetreLienPDF(aUrl){this.GetInstance(this.identFenetreLienPDF).setDonnees_LienPDF(aUrl);}
_ObjetInterfaceEspaceCP.prototype.construireInstancesPDFEtImpression=function(){this.IdentFenetreImpression=this.addFenetre(window.ObjetFenetre_Impression ,this.surEvenementFenetreImpression ,_initialiserFenetreImpression.bind(this));this.identFenetreLienPDF=this.addFenetre(window.ObjetFenetre_LienPdf);IE.Invocateur.abonner('OuvrirFenetreLienPDF',_ouvrirFenetreLienPDF.bind(this),this);};function _surEvenementSurImpression_ApresConfirmation(AAccepte){if(AAccepte===EGenreAction.Valider){if(GEtatUtilisateur.impressionCourante.etat===EGenreImpression.GenerationPDF){this.GetInstance(this.identFenetreGenerationPdf).Afficher(GEtatUtilisateur.impressionCourante.callback());} else{this.GetInstance(this.IdentFenetreImpression).Imprimer(GEtatUtilisateur.impressionCourante);}}
else this.surEvenementFenetreImpression();}
_ObjetInterfaceEspaceCP.prototype.surEvenementSurImpression=function(){if(!GEtatUtilisateur.impressionCourante){;return;}
if(GEtatUtilisateur.EtatSaisie){if(GEtatUtilisateur.impressionCourante.instance.SortirEtatCourantDAffichage)
GEtatUtilisateur.impressionCourante.instance.SortirEtatCourantDAffichage();GApplication.getMessage().afficher({type:EGenreBoiteMessage.Confirmation,message:GEtatUtilisateur.impressionCourante.etat===EGenreImpression.GenerationPDF?GTraductions.getValeur('GenerationPDF.MessageAlerteGenerationPdf'):GTraductions.getValeur('fenetreImpression.MessageAlerteImpression') ,callback:_surEvenementSurImpression_ApresConfirmation.bind(this)});} else _surEvenementSurImpression_ApresConfirmation.bind(this)(EGenreAction.Valider);};_ObjetInterfaceEspaceCP.prototype.estPageIdentification=function(){return false;};_ObjetInterfaceEspaceCP.prototype.confirmationDeconnexion=function(aData){if(!GApplication.getDemo()&&GNavigateur.interactionUtilisateur&&window.GEtatUtilisateur&&GEtatUtilisateur.EtatSaisie){aData.message=GTraductions.getValeur('connexion.DeconnexionSaisieNonValidee');}
else{return;}};_ObjetInterfaceEspaceCP.prototype.actualisationF5=function(){this.EvenementSurNavigation(this);};_ObjetInterfaceEspaceCP.prototype.controleTouche=function(aEvent){var lInstance=aEvent.data.instance;GNavigateur.SetCodeTouche(aEvent.originalEvent);if(GNavigateur.IsToucheActualisation()){if(this.estPageIdentification())
return true;GNavigateur.bloquerValeurEvenement(aEvent);if(GNavigateur.IsIE){GNavigateur.getEvenement(aEvent).keyCode=0;}
if(GNavigateur.getBloquerClavier())
return true;if(lInstance.__blocageDelaiF5__){return true;}
lInstance.__blocageDelaiF5__=true;setTimeout(function(){delete lInstance.__blocageDelaiF5__;},1000);var lParametres={};IE.Invocateur.evenement(IE.Invocateur.events.actualisationAffichage,lParametres);if(lParametres.interruptionActualisation!==true){this.actualisationF5();}}
if(GNavigateur.IsToucheAide()){if(this.estPageIdentification())
return true;GNavigateur.bloquerValeurEvenement(aEvent.originalEvent);window.onhelp=function(){return false;};lInstance.EvenementSurAide();}};})();;
var GClass=new ObjetClass();function ObjetClass(){this.modeAccessible=false;}
ObjetClass.prototype.setModeAccessible=function(aModeAccessible){this.modeAccessible=aModeAccessible;};ObjetClass.prototype.composeAlignement=function(aGenreAlignementHorizontal,aGenreAlignementVertical){var lClassHorizontal=new Array('AlignementGauche','AlignementMilieu','AlignementDroit');var lClassVertical=new Array('AlignementHaut','AlignementMilieuVertical','AlignementBas');return lClassHorizontal[aGenreAlignementHorizontal]+' '+lClassVertical[aGenreAlignementVertical];};ObjetClass.prototype.getBordure=function(){return'Bordure';};ObjetClass.prototype.getBouton=function(){return'Bouton';};ObjetClass.prototype.getCelluleTexte=function(){return'Texte10 CelluleTexte';};ObjetClass.prototype.getCelluleTexteFine=function(){return'Texte10 CelluleTexteFine';};ObjetClass.prototype.getCelluleZoneTexte=function(){return'FondBlanc Texte10 CelluleZoneTexte';};ObjetClass.prototype.getLegende=function(){return'Texte10 Legende';};ObjetClass.prototype.getMenu=function(){return'Texte12 Gras Image_Menu';};ObjetClass.prototype.getMenuFlecheOnglet=function(){return'Image_Menu_FlecheOnglet';};ObjetClass.prototype.getScroll=function(){return'Scroll';};ObjetClass.prototype.getZone=function(){return'Espace AlignementGauche Bordure';};;
IE.Notification={settings:{permissionRequested:false,idFenetreNotif:'fenetreNotif',fenetreCree:false,autoClose:30},afficher:function(aParam){var lAutoClose;if(!GApplication.notificationActive) return;if(IE.Support.supportNotification===IE.Support.permissionNotification.defaut&&this.settings.permissionRequested===false){this.requestPermission(this.afficher.bind(this,aParam));} else{if(IE.Support.supportNotification===IE.Support.permissionNotification.granted){lAutoClose=aParam.autoClose||this.settings.autoClose;var notification=this.getNotification(aParam.title||'',{icon:aParam.icon||'',body:aParam.msg||'',tag:new Date().getTime()});if(aParam.autoClose!==false){notification.addEventListener("show",function(){window.setTimeout(function(){notification.close();},lAutoClose*1000);});}
if(aParam.onclick){notification.addEventListener("click",aParam.onclick);}} else{if(this.settings.fenetreCree===false){this.settings.fenetreCree=true;IE.ZoneFenetre.ajouterFenetre(this.settings.idFenetreNotif,999999);$('#'+this.settings.idFenetreNotif.escapeJQ()).css({position:'absolute',bottom:'2px',right:'2px'}).show();}
var lIdNotif=this.settings.idFenetreNotif+'_'+new Date().getTime();var lNotif='<div id="'+lIdNotif+'" style="position:relative;background-color:'+GCouleur.grisTresClair.fond+';color:'+GCouleur.texte+';border:'+GCouleur.texte+' 2px solid;width:330px;height:50px;padding:10px;overflow:hidden;">'+'<div class="AvecMain WidgetFermer" style="position:absolute;top:0;right:0;" onclick="$(this).parent().remove();event.stopImmediatePropagation();">&nbsp;</div>'+(aParam.icon?'<div class="InlineBlock" style="width:50px;height:50px;"><div class="InlineBlock AlignementMilieuVertical" style="height:100%;"></div><img src="'+aParam.icon+'" class="AlignementMilieuVertical" /></div>':'')+'<div class="InlineBlock">'+(aParam.title?'<div class="Gras">'+aParam.title+'</div>':'')+(aParam.msg?'<div>'+aParam.msg+'</div>':'')+'</div>'+'</div>';lAutoClose=aParam.autoClose||this.settings.autoClose;$('#'+this.settings.idFenetreNotif.escapeJQ()).append(lNotif);if(aParam.autoClose!==false){setTimeout(function(){$('#'+lIdNotif.escapeJQ()).fadeOut().queue(function(){$(this).remove().dequeue();});},lAutoClose*1000);}
if(aParam.onclick){$('#'+lIdNotif.escapeJQ()).on("click",aParam.onclick);}}}},getNotification:function(title,options){var notification;if(window.Notification){try{notification=new window.Notification(title,{icon:options.icon,body:options.body||'',tag:options.tag||''});} catch(e){}}
if(!notification){if(window.webkitNotifications){notification=window.webkitNotifications.createNotification(options.icon,title,options.body);notification.show();} else if(navigator.mozNotification){notification=navigator.mozNotification.createNotification(title,options.body,options.icon);notification.show();}}
return notification;},requestPermission:function(callback){this.settings.permissionRequested=true;if(IE.Support.supportNotification===false){return;}
if(window.webkitNotifications&&window.webkitNotifications.checkPermission){window.webkitNotifications.requestPermission(function(){IE.Support.refreshNotification();if(callback) callback();});} else if(window.Notification&&window.Notification.requestPermission){window.Notification.requestPermission(function(){IE.Support.refreshNotification();if(callback) callback();});}}};;

IE.HTML.addBalise('ie-combo',function(aContexteCourant,aOutils){var lModele=aOutils.getModel(aContexteCourant);if(!lModele){;return;}
var lInfosEvent=aOutils.getAccesParametres('event',aContexteCourant),lInfosInit=aOutils.getAccesParametres('init',aContexteCourant),lInfosGetDonnees=aOutils.getAccesParametres('getDonnees',aContexteCourant),lInfosGetIndice=aOutils.getAccesParametres('getIndiceSelection',aContexteCourant),lInfosSetIndice=aOutils.getAccesParametres('setIndiceSelection',aContexteCourant),lInfosGetLibelle=aOutils.getAccesParametres('getLibelle',aContexteCourant),lInfosDestroy=aOutils.getAccesParametres('destroy',aContexteCourant),lInfosGetDisabled=aOutils.getAccesParametres('getDisabled',aContexteCourant),lAvecControleSaisie=aOutils.getControleSaisieEvent(aContexteCourant),lRefresh=aContexteCourant.contexte.refresh;if(!lInfosInit.estFonction){;return;}
var lInfosInstance=aOutils.creerInstanceIdentite(window.ObjetSaisie,{pere:aContexteCourant.controleur,evenement:function(){var lParametres={genreEvenement:arguments[0],element:arguments[1],indice:arguments[2],genreCombo:arguments[3],valeur:arguments[4],surSetDonnees:arguments[5]};var lCallback=function(){if(lParametres.genreEvenement===EGenreEvenementObjetSaisie.selection&&IE.MethodesObjet.isNumber(lParametres.indice)){if(lParametres.indice!==aContexteCourant.data.$indice){if(lInfosSetIndice.estFonction){lInfosSetIndice.callback([lParametres.indice,lInstanceCombo,aContexteCourant.data]);}
aContexteCourant.data.$indice=lParametres.indice;}}
if(lInfosEvent.estFonction){lInfosEvent.callback([lParametres,lInstanceCombo,aContexteCourant.data]);}
lRefresh();};if(lAvecControleSaisie){IE.controleSaisieSurEvenement(lCallback);}
else{lCallback();}}});var lInstanceCombo=lInfosInstance.instance;var lRacine=GHtml.htmlToDOM('<div id="'+lInstanceCombo.GetNom()+'"></div>'),lJRacine=$(lRacine);if(lInfosInit.estFonction)
lInfosInit.callback([lInstanceCombo,aContexteCourant.data]);aOutils.injectHTML({element:lRacine,html:lInstanceCombo.ConstruireAffichage(),controleur:aContexteCourant.controleur,ignorerScroll:true,contexte:aContexteCourant.contexte});lJRacine.IEData(aContexteCourant.data);lJRacine.bind('destroyed',function(){if(lInfosDestroy.estFonction){lInfosDestroy.callback([lInstanceCombo,aContexteCourant.data]);}
lInfosInstance.callbackDestruction();lInstanceCombo.free();lInstanceCombo=null;});aContexteCourant.controleur.$invocateur.abonnerUnique(aOutils.nomEventInjectionHTML,function(){lInstanceCombo.RecupererDonnees();var lDemarrerGetIndice=function(){if(lInfosGetIndice.estFonction){var lGetterIndice=function(){return lInfosGetIndice.callback([lInstanceCombo,aContexteCourant.data])||0;};var lIndice=lGetterIndice();aContexteCourant.data.$indice=lIndice;if(lIndice>=0)
lInstanceCombo.SetSelection(lIndice);aOutils.abonnerRefresh(function(){var lIndice=lGetterIndice();if(lIndice!==aContexteCourant.data.$indice){aContexteCourant.data.$indice=lIndice;if(lIndice>=0)
lInstanceCombo.SetSelection(lIndice);}},lRacine,aContexteCourant);}};if(lInfosGetDonnees.estFonction){var lGetterDonnees=function(){return lInfosGetDonnees.callback([lInstanceCombo.ListeElements,lInstanceCombo,aContexteCourant.data])||null;};var lDonnees=lGetterDonnees(),lComboInitialise=false;if(lDonnees&&lDonnees.GetNbrElements){lInstanceCombo.SetDonnees(lDonnees);lDemarrerGetIndice();lComboInitialise=true;}
aOutils.abonnerRefresh(function(){var lDonnees=lGetterDonnees();if(lDonnees&&lDonnees.GetNbrElements&&lInstanceCombo.ListeElements!==lDonnees){lInstanceCombo.SetDonnees(lDonnees);if(!lComboInitialise){lDemarrerGetIndice();lComboInitialise=true;}}},lRacine,aContexteCourant);}
if(lInfosGetLibelle.estFonction){var lGetterLibelle=function(){return lInfosGetLibelle.callback([lInstanceCombo,aContexteCourant.data])||'';};var lLibelle=lGetterLibelle();aContexteCourant.data.$oldLibelle=lLibelle;if(lLibelle.length>0)
lInstanceCombo.SetContenu(lLibelle);aOutils.abonnerRefresh(function(){var lLibelle=lGetterLibelle();if(lLibelle!==aContexteCourant.data.$oldLibelle){aContexteCourant.data.$oldLibelle=lLibelle;if(lLibelle.length>0)
lInstanceCombo.SetContenu(lLibelle);}},lRacine,aContexteCourant);}});if(lInfosGetDisabled.estFonction){var lGetterDisabled=function(){return!!lInfosGetDisabled.callback([lInstanceCombo,aContexteCourant.data]);};var lEstDisabled=lGetterDisabled();aContexteCourant.data.$disabled=lEstDisabled;if(lEstDisabled)
lInstanceCombo.SetActif(false);aOutils.abonnerRefresh(function(){var lEstDisabled=lGetterDisabled();if(lEstDisabled!==aContexteCourant.data.$disabled){aContexteCourant.data.$disabled=lEstDisabled;lInstanceCombo.SetActif(!lEstDisabled);}},lRacine,aContexteCourant);}
var llName,lNodeValue;for(var attr,nAttrs=aOutils.getAttributesDeNode(aContexteCourant.node),j=0,jj=nAttrs&&nAttrs.length;j<jj;j++){attr=nAttrs[j];if(attr.name){llName=attr.name.toLowerCase();lNodeValue=attr.value;try{lJRacine.attr(attr.name,lNodeValue);}
catch(e){;}}}
aContexteCourant.node.parentNode.replaceChild(lRacine,aContexteCourant.node);aOutils.addCommentaireDebug(lRacine,'ie-combo ie-model="'+lModele+'"');return{node:lRacine,avecCompileFils:false};});;
MethodesObjet.heritagePrototype(ObjetFenetre_GenerationPdf,ObjetFenetre);function ObjetFenetre_GenerationPdf(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.avecTailleSelonContenu=true;this.SetParametres_Fenetre('',null,null,[GTraductions.getValeur('Annuler'),GTraductions.getValeur('GenerationPDF.Generer')],true);this.setOptionsFenetre({largeur:200});}(function(){ObjetFenetre_GenerationPdf.prototype.ComposeContenu=function(){var T=[];T.push('<div id="',this.GetNom()+'_zonepdf','" style="',GStyle.composeCouleurTexte(GCouleur.noir),'"></div>');return T.join('');};ObjetFenetre_GenerationPdf.prototype.Afficher=function(aParametres){this._parametresAffichage=aParametres;this.instance=this.creerInstance(aParametres,this.GetNom()+'_zonepdf');this.Titre=this.instance.getTitreFenetre();this.inherited('Afficher');};ObjetFenetre_GenerationPdf.prototype.SurValidation=function(aGenreBouton,aFermer){var lParametres={};this.instance.serialiserParametres(lParametres);this.Fermer();delete this._parametresAffichage.PARAMETRE_FENETRE;this.callback.appel(aGenreBouton,this._parametresAffichage,lParametres);};})();MethodesObjet.heritagePrototype(ObjetParametrageGenerationPdf,Identite);function ObjetParametrageGenerationPdf(aNom,aPere){this.inheritedCreate(aNom,null,aPere,null);this.ecartCombo=75;this._parametres={};this._optionsPDF={portrait:false};this.avecPolices=true;}(function(){ObjetParametrageGenerationPdf.prototype.getControleur=function(){return{rbPortrait:{getValue:function(aPortrait){return this.instance._optionsPDF.portrait===aPortrait;},setValue:function(aPortrait,aValue){this.instance._optionsPDF.portrait=aPortrait;}},comboPolice:{init:function(aPoliceSouhait,aInstance){aInstance.setOptions_ObjetSaisie($.extend(this.instance.getOptionsDefautCombo(),{labelWAIZone:this.instance.getLibellePolice()+' '+(aPoliceSouhait?GTraductions.getValeur('GenerationPDF.TaillePoliceSouhaitee'):GTraductions.getValeur('GenerationPDF.TaillePoliceMinAutorisee'))}));if(aPoliceSouhait)
this.instance.cbPolice=aInstance;else this.instance.cbPoliceMin=aInstance;},getDonnees:function(aPoliceSouhait,aDonnees){if(!aDonnees)
return this.instance.getListePolice();},getIndiceSelection:function(aPoliceSouhait,aInstance){return this.instance.getIndiceDansListe(aInstance.ListeElements,aPoliceSouhait?this.instance._optionsPDF.taillePolice:this.instance._optionsPDF.taillePoliceMin);},event:function(aPoliceSouhait,aParams){_evenementSurComboTaillePolice.bind(this.instance)(aPoliceSouhait,aParams.genreEvenement,aParams.element);}}};};ObjetParametrageGenerationPdf.prototype.getTitreFenetre=function(){return GChaine.Insecable(GTraductions.getValeur('GenerationPDF.Titre'));};ObjetParametrageGenerationPdf.prototype.initialiser=function(aId){var T=[];this.composePage(T);GHtml.setHtml(aId,T.join(''),{controleur:this.controleur});if(this.initialiserInstances){this.initialiserInstances();}};ObjetParametrageGenerationPdf.prototype.setParametres=function(aParametres,aOptionsPDF){$.extend(this._parametres,aParametres);$.extend(this._optionsPDF,aOptionsPDF);$.extend(aOptionsPDF,this._optionsPDF);this._optionsPDF=aOptionsPDF;};ObjetParametrageGenerationPdf.prototype.serialiserParametres=function(aParametres){$.extend(aParametres,{portrait:this._optionsPDF.portrait,taillePolice:this._optionsPDF.taillePolice,taillePoliceMin:this._optionsPDF.taillePoliceMin});};ObjetParametrageGenerationPdf.prototype.composePage=function(aHtml){aHtml.push(this.composeGroupe(GTraductions.getValeur('GenerationPDF.Orientation'),'<ie-radio ie-model="rbPortrait(true)" class="Texte10" style="margin:2px;">'+GTraductions.getValeur('GenerationPDF.Portrait')+'</ie-radio>'+'<br />'+'<ie-radio ie-model="rbPortrait(false)" class="Texte10" style="margin:2px;">'+GTraductions.getValeur('GenerationPDF.Paysage')+'</ie-radio>',true));if(this.avecPolices){aHtml.push(this.composeGroupe(this.getLibellePolice(),_composeChoixPolice.bind(this)()));}};ObjetParametrageGenerationPdf.prototype.getLibellePolice=function(){return GTraductions.getValeur('GenerationPDF.EDT.TaillePoliceCours');};ObjetParametrageGenerationPdf.prototype.getListePolice=function(){var lListePolice=new ObjetListeElements(),i,lElement;for(i=1;i<=20;i++){lElement=new ObjetElement(''+i);lElement.valeur=i;lListePolice.AddElement(lElement);}
return lListePolice;};ObjetParametrageGenerationPdf.prototype.getOptionsDefautCombo=function(){return{mode:EGenreSaisie.Combo,longueur:25};};ObjetParametrageGenerationPdf.prototype.initialiserCombo=function(aInstance){aInstance.SetParametres(EGenreSaisie.Combo,25,null,false);};ObjetParametrageGenerationPdf.prototype.getIndiceDansListe=function(aListe,aValeur){for(var i=0;i<aListe.GetNbrElements();i++){if(aListe.GetElement(i).valeur===aValeur){return i;}}
return null;};ObjetParametrageGenerationPdf.prototype.composeGroupe=function(aTitre,aContenu,aPremier){var T=[];var lMargin=aPremier?'margin:0px;':'margin:3px 0 0 0;';T.push('<fieldset class="AlignementGauche" style="padding:0px 3px 3px 5px;',lMargin,GStyle.composeCouleurBordure(GCouleur.fenetre.bordure),'">','<legend class="Texte10 Gras Insecable" style="',GStyle.composeCouleurTexte(GCouleur.fenetre.texte),'">',aTitre,'</legend>',aContenu,'</fieldset>');return T.join('');};function _composeChoixPolice(){var T=[];T.push('<div class="NoWrap EspaceHaut PetitEspaceBas" style="position:relative;">');T.push('<div>');T.push('<div class="Texte9 Insecable">',GTraductions.getValeur('GenerationPDF.TaillePoliceSouhaitee')+' :','</div>');T.push('<ie-combo ie-model="comboPolice(true)"></ie-combo>');T.push('</div>');T.push('<div style="position:absolute; top:5px; left:',this.ecartCombo ,'px;">');T.push('<div class="Texte9 Insecable">',GTraductions.getValeur('GenerationPDF.TaillePoliceMinAutorisee')+' :','</div>');T.push('<ie-combo ie-model="comboPolice(false)"></ie-combo>');T.push('</div>');T.push('</div>');return T.join('');}
function _evenementSurComboTaillePolice(aSurTaillePolice,aGenreEvenement,aElement){switch(aGenreEvenement){case EGenreEvenementObjetSaisie.selection:if(!aElement) return;if(aSurTaillePolice){this._optionsPDF.taillePolice=aElement.valeur;if(this._optionsPDF.taillePolice<this._optionsPDF.taillePoliceMin){this._optionsPDF.taillePoliceMin=this._optionsPDF.taillePolice;}}
else{this._optionsPDF.taillePoliceMin=aElement.valeur;if(this._optionsPDF.taillePoliceMin>this._optionsPDF.taillePolice){this._optionsPDF.taillePolice=this._optionsPDF.taillePoliceMin;}}
break;}}})();MethodesObjet.heritagePrototype(ObjetParametrageGenerationPdf_SansPolice,ObjetParametrageGenerationPdf);function ObjetParametrageGenerationPdf_SansPolice(aNom,aPere){this.inheritedCreate(aNom,aPere);this.avecPolices=false;this._optionsPDF.portrait=true;}
MethodesObjet.heritagePrototype(ObjetParametrageGenerationPdf_EDT,ObjetParametrageGenerationPdf);function ObjetParametrageGenerationPdf_EDT(aNom,aPere){this.inheritedCreate(aNom,aPere);$.extend(this._optionsPDF,{taillePolice:8,taillePoliceMin:3,couleur:ObjetParametrageGenerationPdf_EDT.EGenreCouleurTexte.fond,renvoi:TypeGestionRenvoisImp.impRenvoisAucun,uneGrilleParSemaine:false});}(function(){ObjetParametrageGenerationPdf_EDT.EGenreCouleurTexte={aucune:0,fond:1,texte:2};ObjetParametrageGenerationPdf_EDT.prototype.getControleur=function(){return{rbGrilleAImprimer:{getValue:function(aUneGrilleParSemaine){return this.instance._optionsPDF.uneGrilleParSemaine===aUneGrilleParSemaine;},setValue:function(aUneGrilleParSemaine,aValue){this.instance._optionsPDF.uneGrilleParSemaine=aUneGrilleParSemaine;}},rbCouleur:{getValue:function(aGenreCouleurTexte){return this.instance._optionsPDF.couleur===aGenreCouleurTexte;},setValue:function(aGenreCouleurTexte,aValue){this.instance._optionsPDF.couleur=aGenreCouleurTexte;}},rbRenvois:{getValue:function(aGenreRenvoi){return this.instance._optionsPDF.renvoi===aGenreRenvoi;},setValue:function(aGenreRenvoi,aValue){this.instance._optionsPDF.renvoi=aGenreRenvoi;}}};};ObjetParametrageGenerationPdf_EDT.prototype.serialiserParametres=function(aParametres){this.inherited('serialiserParametres',aParametres);$.extend(aParametres,{couleur:this._optionsPDF.couleur,renvoi:this._optionsPDF.renvoi,uneGrilleParSemaine:this._optionsPDF.uneGrilleParSemaine});};ObjetParametrageGenerationPdf_EDT.prototype.composePage=function(aHtml){this.inherited('composePage',aHtml);if(this._parametres.PARAMETRE_FENETRE.avecChoixGrilleAImprimer){aHtml.push(this.composeGroupe(GTraductions.getValeur('GenerationPDF.EDT.Agencement'),'<ie-radio ie-model="rbGrilleAImprimer(false)" class="Texte10" style="margin:2px;">'+GTraductions.getValeur('GenerationPDF.EDT.GrilleDomaine')+'</ie-radio>'+'<br />'+'<ie-radio ie-model="rbGrilleAImprimer(true)" class="Texte10" style="margin:2px;">'+GTraductions.getValeur('GenerationPDF.EDT.GrilleParSemaine')+'</ie-radio>'));}
aHtml.push(this.composeGroupe(GTraductions.getValeur('GenerationPDF.EDT.CouleurCours'),'<ie-radio ie-model="rbCouleur('+ObjetParametrageGenerationPdf_EDT.EGenreCouleurTexte.aucune+')" class="Texte10" style="margin:2px;">'+GTraductions.getValeur('GenerationPDF.EDT.Aucune')+'</ie-radio>'+'<br />'+'<ie-radio ie-model="rbCouleur('+ObjetParametrageGenerationPdf_EDT.EGenreCouleurTexte.fond+')" class="Texte10" style="margin:2px;">'+GTraductions.getValeur('GenerationPDF.EDT.FondCouleur')+'</ie-radio>'+'<br />'+'<ie-radio ie-model="rbCouleur('+ObjetParametrageGenerationPdf_EDT.EGenreCouleurTexte.texte+')" class="Texte10" style="margin:2px;">'+GTraductions.getValeur('GenerationPDF.EDT.TexteCouleur')+'</ie-radio>'));var lHtml=[];if(MethodesTableau.existe(TypeGestionRenvoisImp.impRenvoisAucun,this._parametres.PARAMETRE_FENETRE.choixRenvois))
lHtml.push('<ie-radio ie-model="rbRenvois('+TypeGestionRenvoisImp.impRenvoisAucun+')" class="Texte10" style="margin:2px;">'+GTraductions.getValeur('GenerationPDF.EDT.AucunRenvoi')+'</ie-radio>');if(MethodesTableau.existe(TypeGestionRenvoisImp.impRenvoisSousBloc,this._parametres.PARAMETRE_FENETRE.choixRenvois))
lHtml.push('<ie-radio ie-model="rbRenvois('+TypeGestionRenvoisImp.impRenvoisSousBloc+')" class="Texte10" style="margin:2px;">'+GTraductions.getValeur('GenerationPDF.EDT.RenvoiSousChaqueGrille')+'</ie-radio>');if(MethodesTableau.existe(TypeGestionRenvoisImp.impRenvoisApresPage,this._parametres.PARAMETRE_FENETRE.choixRenvois))
lHtml.push('<ie-radio ie-model="rbRenvois('+TypeGestionRenvoisImp.impRenvoisApresPage+')" class="Texte10" style="margin:2px;">'+GTraductions.getValeur('GenerationPDF.EDT.RenvoiApresChaquePage')+'</ie-radio>');if(MethodesTableau.existe(TypeGestionRenvoisImp.impRenvoisCumulesALaFin,this._parametres.PARAMETRE_FENETRE.choixRenvois))
lHtml.push('<ie-radio ie-model="rbRenvois('+TypeGestionRenvoisImp.impRenvoisCumulesALaFin+')" class="Texte10" style="margin:2px;">'+GTraductions.getValeur('GenerationPDF.EDT.RenvoiRegroupeFin')+'</ie-radio>');aHtml.push(this.composeGroupe(GTraductions.getValeur('GenerationPDF.EDT.Renvois'),lHtml.join('<br />')));};})();MethodesObjet.heritagePrototype(ObjetParametrageGenerationPdf_BulletinReleve,ObjetParametrageGenerationPdf);function ObjetParametrageGenerationPdf_BulletinReleve(aNom,aPere){this.inheritedCreate(aNom,aPere);$.extend(this._optionsPDF,{portrait:true,taillePolice:6.5,taillePoliceMin:5,taillePolicePied:6.5,taillePolicePiedMin:5,hauteurServiceMin:10,hauteurServiceMax:15});this.ecartCombo=85;}(function(){ObjetParametrageGenerationPdf_BulletinReleve.prototype.getControleur=function(){return{cbPolicePied:{init:function(aPoliceSouhait,aInstance){aInstance.setOptions_ObjetSaisie($.extend(this.instance.getOptionsDefautCombo(),{labelWAIZone:GTraductions.getValeur('GenerationPDF.ReleveNotes.TaillePolicePied')+' '+(aPoliceSouhait?GTraductions.getValeur('GenerationPDF.TaillePoliceSouhaitee'):GTraductions.getValeur('GenerationPDF.TaillePoliceMinAutorisee'))}));if(aPoliceSouhait)
this.instance.cbPolicePied=aInstance;else this.instance.cbPolicePiedMin=aInstance;},getDonnees:function(aPoliceSouhait,aDonnees){if(!aDonnees)
return this.instance.getListePolice();},getIndiceSelection:function(aPoliceSouhait,aInstance){return this.instance.getIndiceDansListe(aInstance.ListeElements,aPoliceSouhait?this.instance._optionsPDF.taillePolicePied:this.instance._optionsPDF.taillePolicePiedMin);},event:function(aPoliceSouhait,aParams){_evenementSurComboTaillePolicePied.bind(this.instance)(aPoliceSouhait,aParams.genreEvenement,aParams.element);}},cbHautService:{init:function(aMini,aInstance){aInstance.setOptions_ObjetSaisie($.extend(this.instance.getOptionsDefautCombo(),{labelWAIZone:GTraductions.getValeur('GenerationPDF.ReleveNotes.HauteurService')+' '+(aMini?GTraductions.getValeur('GenerationPDF.ReleveNotes.Minimum'):GTraductions.getValeur('GenerationPDF.ReleveNotes.Maximum'))+'(mm)'}));if(aMini)
this.instance.cbHautServiceMin=aInstance;else this.instance.cbHautServiceMax=aInstance;},getDonnees:function(aMini,aDonnees){if(!aDonnees){var lListeHauteursMin=new ObjetListeElements();for(var i=6;i<=40;i++){var lElement=new ObjetElement(''+i);lElement.valeur=i;lListeHauteursMin.AddElement(lElement);}
return lListeHauteursMin;}},getIndiceSelection:function(aMini,aInstance){return this.instance.getIndiceDansListe(aInstance.ListeElements,aMini?this.instance._optionsPDF.hauteurServiceMin:this.instance._optionsPDF.hauteurServiceMax);},display:function(aMini,aInstance){var lListeHauteursMin=new ObjetListeElements();for(var i=6;i<=40;i++){var lElement=new ObjetElement(''+i);lElement.valeur=i;lListeHauteursMin.AddElement(lElement);}
aInstance.SetDonnees(lListeHauteursMin,this.instance.getIndiceDansListe(lListeHauteursMin,aMini?this.instance._optionsPDF.hauteurServiceMin:this.instance._optionsPDF.hauteurServiceMax));},event:function(aMini,aParams){_evenementSurcbHautService.bind(this.instance)(aMini,aParams.genreEvenement,aParams.element);}}};};ObjetParametrageGenerationPdf_BulletinReleve.prototype.serialiserParametres=function(aParametres){this.inherited('serialiserParametres',aParametres);$.extend(aParametres,{taillePolicePied:this._optionsPDF.taillePolicePied,taillePolicePiedMin:this._optionsPDF.taillePolicePiedMin,hauteurServiceMin:this._optionsPDF.hauteurServiceMin,hauteurServiceMax:this._optionsPDF.hauteurServiceMax});};ObjetParametrageGenerationPdf_BulletinReleve.prototype.getLibellePolice=function(){return GTraductions.getValeur('GenerationPDF.ReleveNotes.TaillePoliceNotes');};ObjetParametrageGenerationPdf_BulletinReleve.prototype.composePage=function(aHtml){this.inherited('composePage',aHtml);aHtml.push(this.composeGroupe(GTraductions.getValeur('GenerationPDF.ReleveNotes.TaillePolicePied'),this._composeChoixPolicePied()));aHtml.push(this.composeGroupe(GTraductions.getValeur('GenerationPDF.ReleveNotes.HauteurService'),this.composeChoixHauteurService()));};ObjetParametrageGenerationPdf_BulletinReleve.prototype.getListePolice=function(){var lListePolice=new ObjetListeElements(),i,lElement,lValeur,lTailleMax=12;for(i=1;i<=lTailleMax;i++){lValeur=i;lElement=new ObjetElement(''+lValeur);lElement.valeur=lValeur;lListePolice.AddElement(lElement);if(i<lTailleMax){lValeur=i+0.5;lElement=new ObjetElement(''+lValeur);lElement.valeur=lValeur;lListePolice.AddElement(lElement);}}
return lListePolice;};function _evenementSurComboTaillePolicePied(aSurTaillePolice,aGenreEvenement,aElement){switch(aGenreEvenement){case EGenreEvenementObjetSaisie.selection:if(!aElement) return;if(aSurTaillePolice){this._optionsPDF.taillePolicePied=aElement.valeur;if(this._optionsPDF.taillePolicePied<this._optionsPDF.taillePolicePiedMin){this._optionsPDF.taillePolicePiedMin=this._optionsPDF.taillePolicePied;this.cbPolicePiedMin.SetSelection(this.getIndiceDansListe(this.cbPolicePiedMin.ListeElements,this._optionsPDF.taillePolicePiedMin));}}
else{this._optionsPDF.taillePolicePiedMin=aElement.valeur;if(this._optionsPDF.taillePolicePiedMin>this._optionsPDF.taillePolicePied){this._optionsPDF.taillePolicePied=this._optionsPDF.taillePolicePiedMin;this.cbPolicePied.SetSelection(this.getIndiceDansListe(this.cbPolicePied.ListeElements,this._optionsPDF.taillePolicePied));}}
break;}}
function _evenementSurcbHautService(aSurMin,aGenreEvenement,aElement){switch(aGenreEvenement){case EGenreEvenementObjetSaisie.selection:if(!aElement) return;var lInstance;if(aSurMin){this._optionsPDF.hauteurServiceMin=aElement.valeur;if(this._optionsPDF.hauteurServiceMin>this._optionsPDF.hauteurServiceMax){this._optionsPDF.hauteurServiceMax=this._optionsPDF.hauteurServiceMin;lInstance=this.cbHautServiceMax;lInstance.SetSelection(this.getIndiceDansListe(lInstance.ListeElements,this._optionsPDF.hauteurServiceMax));}}
else{this._optionsPDF.hauteurServiceMax=aElement.valeur;if(this._optionsPDF.hauteurServiceMin>this._optionsPDF.hauteurServiceMax){this._optionsPDF.hauteurServiceMin=this._optionsPDF.hauteurServiceMax;lInstance=this.cbHautServiceMin;lInstance.SetSelection(this.getIndiceDansListe(lInstance.ListeElements,this._optionsPDF.hauteurServiceMin));}}
break;}}
ObjetParametrageGenerationPdf_BulletinReleve.prototype._composeChoixPolicePied=function(){var T=[];T.push('<div class="NoWrap EspaceHaut PetitEspaceBas" style="position:relative;">');T.push('<div>');T.push('<div class="Texte9 Insecable">',GTraductions.getValeur('GenerationPDF.TaillePoliceSouhaitee')+' :','</div>');T.push('<ie-combo ie-model="cbPolicePied(true)"></ie-combo>');T.push('</div>');T.push('<div style="position:absolute; top:5px; left:',this.ecartCombo ,'px;">');T.push('<div class="Texte9 Insecable">',GTraductions.getValeur('GenerationPDF.TaillePoliceMinAutorisee')+' :','</div>');T.push('<ie-combo ie-model="cbPolicePied(false)"></ie-combo>');T.push('</div>');T.push('</div>');return T.join('');};ObjetParametrageGenerationPdf_BulletinReleve.prototype.composeChoixHauteurService=function(){var lStyleMM='position:relative; top:-6px; left:2px;';var T=[];T.push('<div class="NoWrap EspaceHaut PetitEspaceBas" style="position:relative;">');T.push('<div>');T.push('<div class="Texte9 Insecable">',GTraductions.getValeur('GenerationPDF.ReleveNotes.Minimum')+' :','</div>');T.push('<div>');T.push('<ie-combo ie-model="cbHautService(true)" class="InlineBlock"></ie-combo>');T.push('<div class="InlineBlock Insecable Texte9" style="',lStyleMM,'">','(mm)','</div>');T.push('</div>');T.push('</div>');T.push('<div style="position:absolute; top:5px; left:',this.ecartCombo ,'px;">');T.push('<div class="Texte9 Insecable">',GTraductions.getValeur('GenerationPDF.ReleveNotes.Maximum')+' :','</div>');T.push('<div>');T.push('<ie-combo ie-model="cbHautService(false)" class="InlineBlock"></ie-combo>');T.push('<div class="InlineBlock Insecable Texte9" style="',lStyleMM,'">','(mm)','</div>');T.push('</div>');T.push('</div>');T.push('</div>');return T.join('');};})();MethodesObjet.heritagePrototype(ObjetParametrageGenerationPdf_Bulletin,ObjetParametrageGenerationPdf_BulletinReleve);function ObjetParametrageGenerationPdf_Bulletin(aNom,aPere){this.inheritedCreate(aNom,aPere);$.extend(this._optionsPDF,{adapterHauteurService:false});}(function(){ObjetParametrageGenerationPdf_Bulletin.prototype.serialiserParametres=function(aParametres){this.inherited('serialiserParametres',aParametres);$.extend(aParametres,{adapterHauteurService:this._optionsPDF.adapterHauteurService});};ObjetParametrageGenerationPdf_Bulletin.prototype.composeChoixHauteurService=function(){var T=[];T.push(this.inherited('composeChoixHauteurService'));T.push('<ie-checkbox ie-model="_optionsPDF.adapterHauteurService" class="PetitEspaceBas Insecable Texte10" style="margin:2px;">',GTraductions.getValeur('GenerationPDF.ReleveNotes.AdapterHauteurApp'),'</ie-checkbox>');return T.join('');};})();MethodesObjet.heritagePrototype(ObjetParametrageGenerationPdf_ReleveDeNotes,ObjetParametrageGenerationPdf_BulletinReleve);function ObjetParametrageGenerationPdf_ReleveDeNotes(aNom,aPere){this.inheritedCreate(aNom,aPere);};
function ObjetFenetre_GenerationPdfSco(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);}
MethodesObjet.heritagePrototype(ObjetFenetre_GenerationPdfSco,ObjetFenetre_GenerationPdf);(function(){ObjetFenetre_GenerationPdfSco.prototype.creerInstance=function(aParametres,aId){var lGenreGenerationPDF=aParametres?aParametres.genreGenerationPDF:TypeHttpGenerationPDF.EDT;if(!GEtatUtilisateur.parametresGenerationPDF)
GEtatUtilisateur.parametresGenerationPDF=[];if(!GEtatUtilisateur.parametresGenerationPDF[lGenreGenerationPDF])
GEtatUtilisateur.parametresGenerationPDF[lGenreGenerationPDF]={};var lInstance=null;switch(lGenreGenerationPDF){case TypeHttpGenerationPDF.EDT:lInstance=Identite.creerInstance(window.ObjetParametrageGenerationPdf_EDT,{pere:this});break;case TypeHttpGenerationPDF.ReleveDeNotes:lInstance=Identite.creerInstance(window.ObjetParametrageGenerationPdf_ReleveDeNotes,{pere:this});break;case TypeHttpGenerationPDF.Bulletin:lInstance=Identite.creerInstance(window.ObjetParametrageGenerationPdf_Bulletin,{pere:this});break;case TypeHttpGenerationPDF.LivretScolaire:lInstance=Identite.creerInstance(window.ObjetParametrageGenerationPdf_LivretScolaire,{pere:this});break;case TypeHttpGenerationPDF.BulletinDeCompetences:lInstance=Identite.creerInstance(window.ObjetParametrageGenerationPdf_BulletinDeCompetences,{pere:this});break;case TypeHttpGenerationPDF.ListeStagiaires:case TypeHttpGenerationPDF.EquipePedagogique:case TypeHttpGenerationPDF.ListeRessources:lInstance=Identite.creerInstance(window.ObjetParametrageGenerationPdf_SansPolice,{pere:this});break;case TypeHttpGenerationPDF.ResultatsQCM:lInstance=Identite.creerInstance(window.ObjetParametrageGenerationPdf_ResultatQCM,{pere:this});break;default:;return null;}
lInstance.setParametres(aParametres,GEtatUtilisateur.parametresGenerationPDF[lGenreGenerationPDF]);lInstance.initialiser(aId);return lInstance;};}());MethodesObjet.heritagePrototype(ObjetParametrageGenerationPdf_LivretScolaire,ObjetParametrageGenerationPdf);function ObjetParametrageGenerationPdf_LivretScolaire(aNom,aPere){this.inheritedCreate(aNom,aPere);this.avecPolices=false;this._optionsPDF.avecGraphe=false;}
ObjetParametrageGenerationPdf_LivretScolaire.prototype.serialiserParametres=function(aParametres){this.inherited('serialiserParametres',aParametres);$.extend(aParametres,{avecGraphe:this._optionsPDF.avecGraphe});};ObjetParametrageGenerationPdf_LivretScolaire.prototype.composePage=function(aHtml){this.inherited('composePage',aHtml);aHtml.push('<ie-checkbox ie-model="_optionsPDF.avecGraphe" class="NoWrap PetitEspaceHaut PetiEspaceGauche Insecable Texte10" style="margin:2px;">',GTraductions.getValeur('ficheScolaire.optionPDFGraphe'),'</ie-checkbox>');};MethodesObjet.heritagePrototype(ObjetParametrageGenerationPdf_BulletinDeCompetences,ObjetParametrageGenerationPdf);function ObjetParametrageGenerationPdf_BulletinDeCompetences(aNom,aPere){this.inheritedCreate(aNom,aPere);this.avecPolices=false;$.extend(this._optionsPDF,{portrait:true,adapterHauteur:false,avecGraphe:false,grapheClasse:true});}
ObjetParametrageGenerationPdf_BulletinDeCompetences.prototype.getControleur=function(){return{rbGrapheClasse:{getValue:function(aSurClasse){return this.instance._optionsPDF.grapheClasse===aSurClasse;},setValue:function(aSurClasse){this.instance._optionsPDF.grapheClasse=aSurClasse;},getDisabled:function(){return!this.instance._optionsPDF.avecGraphe;}}};};ObjetParametrageGenerationPdf_BulletinDeCompetences.prototype.serialiserParametres=function(aParametres){this.inherited('serialiserParametres',aParametres);$.extend(aParametres,{adapterHauteur:this._optionsPDF.adapterHauteur,avecGraphe:this._parametres.avecChoixGraphe&&this._optionsPDF.avecGraphe,grapheClasse:this._optionsPDF.grapheClasse});};ObjetParametrageGenerationPdf_BulletinDeCompetences.prototype.composePage=function(aHtml){this.inherited('composePage',aHtml);aHtml.push(this.composeGroupe(GTraductions.getValeur('GenerationPDF.ReleveNotes.HauteurService'),'<ie-checkbox ie-model="_optionsPDF.adapterHauteur" class="PetitEspaceHaut PetiEspaceGauche Insecable Texte10" style="margin:2px;">'+
GTraductions.getValeur('GenerationPDF.ReleveNotes.AdapterHauteurApp')+'</ie-checkbox>'));var T=[];T.push('<div class="EspaceHaut PetitEspaceGauche PetitEspaceDroit Insecable Texte10">',GTraductions.getValeur('competences.titreGraphe'),'</div>');T.push('<ie-radio ie-model="rbGrapheClasse(true)" class="PetitEspaceHaut PetitEspaceGauche Insecable Texte10" style="margin:2px;">',GTraductions.getValeur('competences.choixGrapheClasse'),'</ie-radio>','<ie-radio ie-model="rbGrapheClasse(false)" class="PetitEspaceHaut PetitEspaceGauche Insecable Texte10" style="margin:2px;">',GTraductions.getValeur('competences.choixGrapheNiveau'),'</ie-radio>');if(this._parametres.avecChoixGraphe)
aHtml.push(this.composeGroupe('<ie-checkbox ie-model="_optionsPDF.avecGraphe" class="PetitEspaceHaut PetiEspaceGauche Insecable Texte10" style="margin:2px;">'+
GTraductions.getValeur('competences.GrapheAraignee')+'</ie-checkbox>',T.join('')));};function ObjetParametrageGenerationPdf_ResultatQCM(aNom,aPere){this.inheritedCreate(aNom,aPere);}
IE.MethodesObjet.heritagePrototype(ObjetParametrageGenerationPdf_ResultatQCM,ObjetParametrageGenerationPdf_SansPolice);ObjetParametrageGenerationPdf_ResultatQCM.prototype.getTitreFenetre=function(){return GChaine.Insecable(GTraductions.getValeur('QCM_Divers.TitrePDF_ResultatsQCM'));};;
var EGenreCommande={ChangerRessource:0,Impression:1,Validation:2,Accessibilite:3,Aide:4,Communication:5,ChangerOnglet:6,AccesMobile:7,LiveEdu:8,SkyDrive:9,TelechargerClient:10,Accueil:12,IManuel:13,Tutoriel:14,OngletIManuel:15,Twitter:16,ExportFichierProf:17,ImportFichierProf:18,CompteEnfant:19,Kiosque:20};;
var EGenreEtatBouton={Actif:0,Inactif:1};var EGenreTypeBouton={Normal:0,ImageAvecTexte:1};var EGenreAlignementBouton={Gauche:0,Droite:1};MethodesObjet.heritagePrototype(ObjetBouton,Identite);function ObjetBouton(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.IdBouton=this.Nom+'_Bouton';this.Etat=EGenreEtatBouton.Actif;this.IdPremierElement=this.IdBouton;this._initOptionsBouton();this.setParametresCouleurs({});this.setParametresSurvol();}(function(){ObjetBouton.prototype.getIdDivBouton=function(){return'div_'+this.IdBouton;};ObjetBouton.prototype.getIdLabelBouton=function(){return'label_'+this.IdBouton;};ObjetBouton.prototype._initOptionsBouton=function(){this._optionsBouton={TypeBouton:EGenreTypeBouton.Normal,Actif:true,Libelles:[],TexteImg:'',hint:'',espaceNormal:true,Width:null,Height:null,RaccourciClavier:null,DescriptionAccessible:null,labelWAI:'',TabImages:[],TabCurseurs:[],alignementTexte:null,alignementImage:null};this.paramCouleurDefaut={couleurFond:GCouleur.themeNeutre.moyen2,texteGras:true,couleurFondInactif:GCouleur.nonEditable.fond,couleurTexteInactif:GCouleur.nonEditable.texte,couleurBordureInfDroit:GCouleur.themeNeutre.claire};};ObjetBouton.prototype.setOptionsBouton=function(aOptions){$.extend(this._optionsBouton,aOptions);if(this._optionsBouton.TypeBouton===EGenreTypeBouton.Normal)
this._initBoutonNormal();this.Actif=this._optionsBouton.Actif;};ObjetBouton.prototype.SetParametres=function(ALibelles,AWidth,AHeight,ARaccourciClavier,ATypeBouton,ATabImages,ATabCurseurs,AReference,AActif,ATexteImg,aAlignementTexte,aAlignementImage,aStyleSite,aDescriptionAccessible,aLabelWAI){this.setOptionsBouton({Libelles:ALibelles,Actif:((AActif!==null&&AActif!==undefined)?AActif:true),TypeBouton:ATypeBouton?ATypeBouton:EGenreTypeBouton.Normal,Width:AWidth,Height:AHeight,RaccourciClavier:ARaccourciClavier,TabImages:ATabImages,TabCurseurs:ATabCurseurs,TexteImg:ATexteImg,alignementTexte:aAlignementTexte?aAlignementTexte:EGenreAlignementBouton.Gauche,alignementImage:aAlignementImage?aAlignementImage:EGenreAlignementBouton.Gauche,DescriptionAccessible:aDescriptionAccessible,labelWAI:aLabelWAI});};ObjetBouton.prototype.SetParametres_BoutonNormal=function(ALibelles,AWidth,AHeight,AActif,aStyleSite,aHint,ARaccourciClavier,AEspaceNormal,aDescriptionAccessible,aLabelWAI){this.setOptionsBouton({Libelles:ALibelles,Actif:((AActif!==null&&AActif!==undefined)?AActif:true),Width:AWidth,Height:AHeight,RaccourciClavier:ARaccourciClavier,TabImages:[],TabCurseurs:[],hint:aHint,espaceNormal:AEspaceNormal===null||AEspaceNormal===undefined?true:AEspaceNormal,DescriptionAccessible:aDescriptionAccessible,labelWAI:aLabelWAI}) ;};ObjetBouton.prototype.setParametresCouleurs=function(aParam){this.couleurFond=aParam.couleurFond||GCouleur.blanc;this.couleurBordure=aParam.couleurBordureSupGauche||GCouleur.blanc;this.couleurBordureSupGauche=aParam.couleurBordureSupGauche||GCouleur.blanc;this.couleurBordureInfDroit=aParam.couleurBordureInfDroit||GCouleur.blanc;this.couleurTexteActif=aParam.couleurTexteActif||GCouleur.noir;this.couleurFondInactif=aParam.couleurFondInactif||GCouleur.fenetre.nonEditable.fond;this.couleurTexteInactif=aParam.couleurTexteInactif||GCouleur.fenetre.cumul;this.texteGras=aParam.texteGras!==false;};ObjetBouton.prototype.setParametresSurvol=function(aCouleurFond,aCouleurBordureSupGauche,aCouleurBordureInfDroit,aTexteGras){this.couleurFondOnMouseOver=aCouleurFond||GCouleur.fond;this.couleurBordureOnMouseOver=aCouleurBordureSupGauche||GCouleur.intermediaire;this.couleurBordureSupGaucheOnMouseOver=aCouleurBordureSupGauche||GCouleur.intermediaire;this.couleurBordureInfDroitOnMouseOver=aCouleurBordureInfDroit||GCouleur.intermediaire;this.texteGrasOnMouseOver=aTexteGras!==false;};ObjetBouton.prototype._initBoutonNormal=function(){if(this._optionsBouton.TypeBouton!==EGenreTypeBouton.Normal) return;this.setParametresCouleurs(this.paramCouleurDefaut);this.setParametresSurvol(GCouleur.themeNeutre.foncee,null,null,true);};ObjetBouton.prototype.ConstruireAffichage=function(){var lIndex=this._optionsBouton.Height===null||this._optionsBouton.Height===undefined?0:this._optionsBouton.Height.toString().indexOf("px")+this._optionsBouton.Height.toString().indexOf("%")+this._optionsBouton.Height.toString().indexOf("em")+2;var lHeight;var lWidth;if(lIndex> -1)
lHeight=this._optionsBouton.Height;else lHeight=parseInt(this._optionsBouton.Height,10);lIndex=this._optionsBouton.Width===null||this._optionsBouton.Width===undefined?0:this._optionsBouton.Width.toString().indexOf("px")+this._optionsBouton.Width.toString().indexOf("%")+this._optionsBouton.Width.toString().indexOf("em")+2;if(lIndex> -1)
lWidth=this._optionsBouton.Width;else lWidth=parseInt(this._optionsBouton.Width)+'px';var LStyleWidth=this._optionsBouton.Width===null||this._optionsBouton.Width===undefined?'':'width:'+lWidth+'; ';var LStyleHeight=this._optionsBouton.Height===null||this._optionsBouton.Height===undefined?'':'overflow:hidden; height:'+lHeight+'; ';var LStyleLineHeight=this._optionsBouton.Height===null||this._optionsBouton.Height===undefined?'':'line-height:'+lHeight+'; ';var LStyleLineHeightTexte=this._optionsBouton.Height===null||this._optionsBouton.Height===undefined?'':'line-height:'+(parseInt(lHeight)-2)+'px; ';var LAccessKey=this._optionsBouton.RaccourciClavier===null||this._optionsBouton.RaccourciClavier===undefined?'':'accesskey="'+this._optionsBouton.RaccourciClavier+'" ',lCorrecteurHeight=IE.Support.avecSupportBoxShadow?-1:0;var lHtml;switch(this._optionsBouton.TypeBouton){case EGenreTypeBouton.Normal:{var lClass=this._optionsBouton.espaceNormal?'':'PetitEspaceGauche PetitEspaceDroit ';lHtml=[];var lHint=this._optionsBouton.hint?'title="'+this._optionsBouton.hint+'"':'';lHtml.push('<button '+(this.Actif?'':' disabled ')+' tabindex="0" '+(this._optionsBouton.labelWAI?GObjetWAI.composeAttribut({genre:EGenreAttribut.label ,valeur:this._optionsBouton.labelWAI}):'')+' '+(this._optionsBouton.DescriptionAccessible?GObjetWAI.composeAttribut({genre:EGenreAttribut.describedby ,valeur:this._optionsBouton.DescriptionAccessible}):'')+' '+GObjetWAI.composeRole(EGenreRole.Button)+' '+lHint+' '+LAccessKey+' id="'+this.IdBouton+'"',' style="',LStyleWidth+(this._optionsBouton.Height===null||this._optionsBouton.Height===undefined?GStyle.composeHeight((this._optionsBouton.Height?this._optionsBouton.Height:20)+lCorrecteurHeight):'overflow:hidden;'+GStyle.composeHeight(lHeight+lCorrecteurHeight)),GStyle.composeCouleurFond(this.Actif?this.couleurFond:this.couleurFondInactif),GStyle.composeCouleurTexte(this.Actif?this.couleurTexteActif:this.couleurTexteInactif),(IE.Support.avecSupportBoxShadow?GStyle.composeBoxShadow({x:0,y:2,blur:0,spread:0,opacity:0.15,r:50,g:50,b:50}):GStyle.composeCouleurBordure(this.couleurBordureInfDroit,1)),GStyle.composeTransitions('background-color','0.2s'),'"'+' class="Boutons Texte10 NoWrap '+lClass+(this.Actif?'AvecMain':'SansMain')+(this.texteGras?' Gras':' Maigre')+'"',' onmouseup="',this.Nom,'.SurValidation ()"','>',GChaine.ToHTML(this._optionsBouton.Libelles[this.Etat]),'</button>');return lHtml.join('');}
case EGenreTypeBouton.ImageAvecTexte:{var LStyleCouleurLabel='color:'+(this.Actif?GCouleur.texte:this.couleurTexteInactif)+'; ';var lLibelle=this._optionsBouton.Libelles[this.Etat]?this._optionsBouton.Libelles[this.Etat]:'';var lAlt='';if(GNavigateur.IsIE){lHtml=[];lHtml.push('<div id="',this.getIdDivBouton(),'" tabindex="0" ',window.GObjetWAI.composeRole(EGenreRole.Button),' class="',this._optionsBouton.TabCurseurs[this.Etat],'"',' style="border-left:1px solid '+this.couleurBordureSupGauche+'; border-top:1px solid '+this.couleurBordureSupGauche+';border-right:1px solid '+this.couleurBordureInfDroit+';border-bottom:1px solid '+this.couleurBordureInfDroit+'; ',LStyleWidth,LStyleHeight,LStyleCouleurLabel,'" ',LAccessKey,' onclick="',this.Nom,'.SurValidation ()"',' title="',lLibelle,'" alt="',lAlt,'">');lHtml.push('<img tabIndex="-1" style="',this._optionsBouton.alignementImage===EGenreAlignementBouton.Gauche?'float: left; padding-left: 3px;':'float: right; padding-right: 3px;',';" id="',this.IdBouton,'" src="',this._optionsBouton.TabImages[this.Etat],'"></img>','<div id="',this.getIdLabelBouton(),'"',' class="Texte10 EspaceGauche EspaceDroit"',' style="',LStyleLineHeightTexte,' float:',this._optionsBouton.alignementTexte===EGenreAlignementBouton.Gauche?'left':'right','; font-weight: '+(this.texteGras?'bold':'normal')+'; ',LStyleCouleurLabel,'" >',(this._optionsBouton.TexteImg),'</div>');lHtml.push('</div>');return lHtml.join('');}
else{var H=[];H.push('<div id="'+this.getIdDivBouton()+'"',' tabindex="0" '+window.GObjetWAI.composeRole(EGenreRole.Button),' class="'+this._optionsBouton.TabCurseurs[this.Etat]+'"',' style="border-left:1px solid '+this.couleurBordureSupGauche+'; border-top:1px solid '+this.couleurBordureSupGauche+';border-right:1px solid '+this.couleurBordureInfDroit+';border-bottom:1px solid '+this.couleurBordureInfDroit+'; '+
LStyleWidth+LStyleHeight+LStyleLineHeight+LStyleCouleurLabel+'"',' alt="'+this._optionsBouton.Libelles[this.Etat]+'. "',' title="'+this._optionsBouton.Libelles[this.Etat]+'"',' onclick="'+this.Nom+'.SurValidation ()">');H.push('<input id="'+this.IdBouton+'" type="image"',' tabindex="-1" '+window.GObjetWAI.composeRole(EGenreRole.Button)+' style="margin:0; ',this._optionsBouton.alignementImage===EGenreAlignementBouton.Gauche?'float: left; padding-left: 3px;':'float: right; padding-right: 3px;','; border:none;" '+
LAccessKey+' onclick="'+this.Nom+'.SurValidation (); GNavigateur.StopperEvenement (event);"',' src="'+this._optionsBouton.TabImages[this.Etat]+'"',' alt="'+lAlt+'" title="'+lLibelle+'"/>');H.push('<div id="'+this.getIdLabelBouton()+'"',' class="Texte10 EspaceGauche EspaceDroit"',' style="',LStyleLineHeightTexte,' float: ',this._optionsBouton.alignementTexte===EGenreAlignementBouton.Gauche?'left':'right','; font-weight: '+(this.texteGras?'bold':'normal')+';'+LStyleCouleurLabel+'" >'+
GChaine.Insecable(this._optionsBouton.TexteImg)+'</div>');H.push('</div>');return H.join('');}}}};ObjetBouton.prototype.SetLibelle=function(ALibelle,AEtat){AEtat=AEtat===null||AEtat===undefined?EGenreEtatBouton.Actif:EGenreEtatBouton.Inactif;if(this._optionsBouton.TypeBouton===EGenreTypeBouton.Normal)
GHtml.setHtml(this.IdBouton,GChaine.ToHTML(this._optionsBouton.Libelles[AEtat]=ALibelle));else GHtml.setValue(this.IdBouton,this._optionsBouton.Libelles[AEtat]=ALibelle);};ObjetBouton.prototype.setWidth=function(aWidth){GPosition.setWidth(this.IdBouton,aWidth);};ObjetBouton.prototype.setHeight=function(aHeight){GPosition.setHeight(this.IdBouton,aHeight);};ObjetBouton.prototype.setFocus=function(aAvecDecalage){GHtml.setFocus(this.IdBouton,true,aAvecDecalage);};ObjetBouton.prototype.SetEtat=function(AEtat){GHtml.setImage(this.IdBouton,this._optionsBouton.TabImages[AEtat?EGenreEtatBouton.Actif:EGenreEtatBouton.Inactif]);GHtml.setClass(this.IdBouton,this._optionsBouton.TabCurseurs[AEtat?EGenreEtatBouton.Actif:EGenreEtatBouton.Inactif]);if(this._optionsBouton.TypeBouton===EGenreTypeBouton.ImageAvecTexte){GHtml.setClass(this.getIdDivBouton(),this._optionsBouton.TabCurseurs[AEtat?EGenreEtatBouton.Actif:EGenreEtatBouton.Inactif]);GHtml.setAlt(this.getIdDivBouton(),this._optionsBouton.Libelles[AEtat?EGenreEtatBouton.Actif:EGenreEtatBouton.Inactif]);GHtml.setTitle(this.getIdDivBouton(),this._optionsBouton.Libelles[AEtat?EGenreEtatBouton.Actif:EGenreEtatBouton.Inactif]);}
GHtml.setTitle(this.IdBouton,this._optionsBouton.Libelles[AEtat?EGenreEtatBouton.Actif:EGenreEtatBouton.Inactif]);};ObjetBouton.prototype.SetActif=function(AActif){this.Actif=AActif;GHtml.setDisabled(this.IdBouton,!this.Actif);switch(this._optionsBouton.TypeBouton){case EGenreTypeBouton.Normal:GHtml.delClass(this.IdBouton,this.Actif?'SansMain':'AvecMain');GHtml.addClass(this.IdBouton,this.Actif?'AvecMain':'SansMain');GStyle.setCouleurTexte(this.IdBouton,this.Actif?this.couleurTexteActif:this.couleurTexteInactif);GStyle.setCouleurFond(this.IdBouton,this.Actif?this.couleurFond:this.couleurFondInactif);break;case EGenreTypeBouton.ImageAvecTexte:GStyle.setCouleurTexte(this.getIdLabelBouton(),this.Actif?GCouleur.texte:this.couleurTexteInactif);break;default:break;}};ObjetBouton.prototype.IsActif=function(){return this.Actif;};ObjetBouton.prototype.RecupererDonnees=function(){this.SetVisible(this.Visible);var lJqBouton=null;switch(this._optionsBouton.TypeBouton){case EGenreTypeBouton.Normal:lJqBouton=$('#'+this.IdBouton.escapeJQ());break;default:lJqBouton=$('#'+this.getIdDivBouton().escapeJQ());break;}
lJqBouton.addClass('OmbreFocus').on({mouseleave:_surMouseOut,mouseenter:_surMouseOver,keyup:_navigationClavier},{aObjet:this});};ObjetBouton.prototype.SurValidation=function(){if(this.Actif){if(this.ControleNavigation&&this.Pere&&this.Pere.EvenementSurNavigation)
this.Pere.EvenementSurNavigation(this);else this.RetourSurNavigation();}};function _surMouseOver(event){var lThis=event.data.aObjet;if(GNavigateur.isTactile){return ;}
if(!lThis.Actif){return;}
if(lThis._optionsBouton.TypeBouton===EGenreTypeBouton.Normal){GStyle.setCouleurFond(lThis.IdBouton,lThis.couleurFondOnMouseOver);GStyle.setGras(lThis.IdBouton,lThis.texteGrasOnMouseOver);}
else{var lIdDiv=lThis.getIdDivBouton();var lIdLabel=lThis.getIdLabelBouton();GStyle.setCouleurBordureGauche(lIdDiv,lThis.couleurBordureSupGaucheOnMouseOver);GStyle.setCouleurBordureHaut(lIdDiv,lThis.couleurBordureSupGaucheOnMouseOver);GStyle.setCouleurBordureDroit(lIdDiv,lThis.couleurBordureInfDroitOnMouseOver);GStyle.setCouleurBordureBas(lIdDiv,lThis.couleurBordureInfDroitOnMouseOver);GStyle.setCouleurFond(lIdDiv,lThis.couleurFondOnMouseOver);GStyle.setCouleurFond(lIdLabel,lThis.couleurFondOnMouseOver);GStyle.setGras(lIdLabel,lThis.texteGrasOnMouseOver);}}
function _surMouseOut(event){var lThis=event.data.aObjet;if(GNavigateur.isTactile){return ;}
if(!lThis.Actif){return;}
if(lThis._optionsBouton.TypeBouton===EGenreTypeBouton.Normal){GStyle.setCouleurFond(lThis.IdBouton,lThis.couleurFond);GStyle.setGras(lThis.IdBouton,lThis.texteGras);}
else{var lIdDiv=lThis.getIdDivBouton();var lIdLabel=lThis.getIdLabelBouton();GStyle.setCouleurBordureGauche(lIdDiv,lThis.couleurBordureSupGauche);GStyle.setCouleurBordureHaut(lIdDiv,lThis.couleurBordureSupGauche);GStyle.setCouleurBordureDroit(lIdDiv,lThis.couleurBordureInfDroit);GStyle.setCouleurBordureBas(lIdDiv,lThis.couleurBordureInfDroit);GStyle.setCouleurFond(lIdDiv,lThis.couleurFond);GStyle.setCouleurFond(lIdLabel,lThis.couleurFond);GStyle.setGras(lIdLabel,lThis.texteGras);}}
ObjetBouton.prototype.RetourSurNavigation=function(){this.callback.appel(this.Genre);};function _navigationClavier(event){if(GNavigateur.IsToucheSelection())
event.data.aObjet.SurValidation();}
ObjetBouton.prototype.setHint=function(aHint){$.extend(this._optionsBouton,{hint:aHint});$('#'+this.IdBouton.escapeJQ()).attr('title',GChaine.toTitle(aHint));};}());;
var EGenreBoutonBandeau={NonSelectionne:0,Inactif:1,NonSelectionne2:2,Selectionne:3,SurvolNonSelectionne:4,SurvolSelectionne:5};function ObjetBoutonBandeau(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.withTabulation=true;this.idBouton=this.Nom+'_Bouton';this.IdPremierElement=this.idBouton;this.selection=false;this._options={nomClass:'',avecEtat:false,actif:true,taille:20,tableauLibelles:null,avecSelection:true,avecEspaceGauche:true,raccourciClavier:'',describedby:'',roleWAI:'',labelWAI:'',attributWAI:''};}
MethodesObjet.heritagePrototype(ObjetBoutonBandeau,Identite);(function(){ObjetBoutonBandeau.prototype.setOptions_ObjetBoutonBandeau=function(aOptions){var lTaille=this._options.taille;$.extend(this._options,aOptions);if(lTaille!==this._options.taille){var lElement=GHtml.getElement(this.idBouton);if(lElement){GPosition.setWidth(lElement,this._options.taille);}}};ObjetBoutonBandeau.prototype.ConstruireAffichage=function(){var H=[];H.push('<div',this._options.avecEspaceGauche?' class="EspaceGauche"':'','>');H.push('<div id="',this.idBouton,'"',' style="outline: 0px;',GStyle.composeWidth(this._options.taille),'"',' class="Texte10 AvecMain ',this._options.nomClass,'"',' tabIndex="0"',this._options.roleWAI?GObjetWAI.composeRole(this._options.roleWAI):GObjetWAI.composeRole(EGenreRole.Button),' ',this._options.labelWAI?GObjetWAI.composeAttribut({genre:EGenreAttribut.label,valeur:this._options.labelWAI})+' ':'',this._options.attributWAI?GObjetWAI.composeAttribut(this._options.attributWAI):'',(this._options.actif&&this.withTabulation&&this._options.describedby)?GObjetWAI.composeAttribut({genre:EGenreAttribut.describedby,valeur:this._options.describedby}):'',GObjetWAI.composeAttribut({genre:EGenreAttribut.disabled,valeur:''+!this._options.actif}),'></div>');H.push('</div>');return H.join('');};function _surKeyUp(event){if(GNavigateur.IsToucheSelection()){event.data.instance.surSelection(true);}}
function _surClick(event){event.data.instance.surSelection(true);}
ObjetBoutonBandeau.prototype.RecupererDonnees=function(){$('#'+this.idBouton.escapeJQ()).on('focusin mouseover',{aObjet:this,aSurvol:true},_surSurvolJQ).on('focusout mouseout',{aObjet:this,aSurvol:false},_surSurvolJQ).on({keyup:_surKeyUp,click:_surClick},{instance:this});this.actualiser();};ObjetBoutonBandeau.prototype.SetParametres=function(aNomClass,aAvecEtat,aSelection,aActif,aTableauLibelles,aTaille,aAvecSelection,aAvecEspaceGauche,aRaccourciClavier){this.setOptions_ObjetBoutonBandeau({nomClass:aNomClass,avecEtat:aAvecEtat,actif:aActif,tableauLibelles:aTableauLibelles,taille:aTaille?aTaille:undefined,avecSelection:aAvecSelection!==null&&aAvecSelection!==undefined?aAvecSelection:undefined,avecEspaceGauche:aAvecEspaceGauche!==null&&aAvecEspaceGauche!==undefined?aAvecEspaceGauche:undefined,raccourciClavier:aRaccourciClavier?aRaccourciClavier:undefined});this.selection=aSelection;};ObjetBoutonBandeau.prototype.getPosition=function(aGenre){return this._options.avecEtat?-1*this._options.taille*aGenre:0;};ObjetBoutonBandeau.prototype.getLibelle=function(aGenre){var lResult=this._options.tableauLibelles?this._options.tableauLibelles[this._options.actif?!this._options.avecEtat||this.selection?0:1:2]:'';if(lResult&&this._options.raccourciClavier&&this._options.actif)
lResult=lResult+' - ';if(this._options.actif&&this._options.raccourciClavier)
lResult=lResult+this._options.raccourciClavier;;return lResult||'';};ObjetBoutonBandeau.prototype.actualiser=function(){var lGenre;if(this._options.actif)
lGenre=this.selection?(this.survol?EGenreBoutonBandeau.SurvolSelectionne:EGenreBoutonBandeau.Selectionne):(this.survol?EGenreBoutonBandeau.SurvolNonSelectionne:EGenreBoutonBandeau.NonSelectionne);else lGenre=EGenreBoutonBandeau.Inactif;GPosition.setBackgroundPosition(this.idBouton,this.getPosition(lGenre));GHtml.setTitle(this.idBouton,this.getLibelle());$('#'+this.idBouton.escapeJQ()).attr(GObjetWAI.WaiAttribut[EGenreAttribut.label],this._options.labelWAI||this.getLibelle());};function _surSurvolJQ(event){var lThis=event.data.aObjet;var lSurvol=event.data.aSurvol;if(!GNavigateur.isTactile){lThis.survol=lSurvol;lThis.actualiser();if(!lThis._options.avecEtat){if(lThis.survol)
$('#'+lThis.idBouton.escapeJQ()).css('box-shadow','0 0 5px -1px '+GCouleur.noir);else $('#'+lThis.idBouton.escapeJQ()).css('box-shadow','none');}}}
ObjetBoutonBandeau.prototype.surSelection=function(aInteractionUtilisateur,aSelection){if(this._options.actif){if(this._options.avecSelection)
this.selection=aSelection===null||aSelection===undefined?!this.selection:aSelection;this.actualiser();this.InteractionUtilisateur=aInteractionUtilisateur;if(this.ControleNavigation&&this.Pere&&this.Pere.EvenementSurNavigation&&this.InteractionUtilisateur)
this.Pere.EvenementSurNavigation(this);else this.RetourSurNavigation();}};ObjetBoutonBandeau.prototype.setSelection=function(aSelection){this.surSelection(false,aSelection);};ObjetBoutonBandeau.prototype.setActif=function(aActif){this._options.actif=aActif;var lJqBouton=$('#'+this.idBouton.escapeJQ());if(this._options.actif) lJqBouton.removeClass('SansMain').addClass('AvecMain');else lJqBouton.removeClass('AvecMain').addClass('SansMain');if(this.withTabulation) lJqBouton.attr('tabIndex',0);lJqBouton.attr(GObjetWAI.WaiAttribut[EGenreAttribut.disabled],''+!this._options.actif);this.actualiser();};ObjetBoutonBandeau.prototype.getActif=function(){return this._options.actif;};ObjetBoutonBandeau.prototype.setLibelles=function(aTableauLibelles){this.setOptions_ObjetBoutonBandeau({tableauLibelles:aTableauLibelles});this.actualiser();};ObjetBoutonBandeau.prototype.setNomClass=function(aNomClass){this.nomClass=aNomClass;GHtml.setClass(this.idBouton,this.nomClass);this.actualiser();};ObjetBoutonBandeau.prototype.RetourSurNavigation=function(){this.callback.appel(this.Genre,this.selection,this.InteractionUtilisateur);};}());;
var EGenreLigneMenu={Separateur:0,Commande:1,Liste:2,Deploiement:3,SelecteurFichier:4};MethodesObjet.heritagePrototype(ObjetMenuContextuel,Identite);function ObjetMenuContextuel(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.ListeLignes=new ObjetListeElements();this.IdNomMenuContextuel=this.Nom+'_MenuContextuel';this.IdZoneMenuContextuel=this.Nom+'_ZoneMC';this.IdPremierElement=this.IdNomMenuContextuel;this.IdPrecedent='';this.couleurBarre=GCouleur.themeNeutre.legere;this.ajouterEvenementGlobal(EEvent.SurPreResize,this.Fermer);IE.Invocateur.abonner(GNavigateur.getEventInvocateur('mousedown'),this._fermerMenuContextuelSurMouseDown,this);IE.Invocateur.abonner(GNavigateur.getEventInvocateur('touchstart'),this._fermerMenuContextuelSurMouseDown,this);}(function(){IE.ZoneFenetre.etendreEnFenetre(ObjetMenuContextuel,{zIndex:1200});ObjetMenuContextuel.afficher=function(aParametres){var lParametres={pere:null,evenement:null,initCommandes:null,affichageSurInitCommandes:false,id:null};$.extend(lParametres,aParametres);if(!lParametres.pere){;return null;}
if(!lParametres.evenement){;return null;}
if(!lParametres.initCommandes){;return null;}
var lInstance=Identite.creerInstance(window.ObjetMenuContextuel,{pere:lParametres.pere,evenement:lParametres.evenement});lInstance.destructionSurFermeture=true;IE.ZoneFenetre.ajouterFenetre(lInstance.GetNom());lParametres.initCommandes(lInstance);if(lInstance.ListeLignes.GetNbrElements()===0){lInstance.free();return;}
if(!lParametres.affichageSurInitCommandes){lInstance.SetDonnees(lParametres.id);}
return lInstance;};var c_delaiFermetureSousMenu=300,c_delaiOuvertureSousMenu=200;ObjetMenuContextuel.prototype.getControleur=function(){return{eventSurLigne:function(aActif,aPositionLigne,aEvent,aElement){var lElement=this.instance.ListeLignes.GetElement(aPositionLigne),lInstance=this.instance;switch(aEvent.type){case'touchstart':this.instance.SurSelection(aElement.id,aActif,aPositionLigne);if(_avecSousMenu.call(lInstance,lElement)&&!lInstance._instanceSousMenu){_ouvertureSousMenu.call(lInstance,lElement,false);}
break;case'pointerdown':if(_avecSousMenu.call(lInstance,lElement)&&!lInstance._instanceSousMenu){_ouvertureSousMenu.call(lInstance,lElement,false);}
break;case'mouseenter':_ouvertureSousMenu.call(this.instance,lElement,true);break;case'mouseover':if(lInstance.estSousMenu)
_stopperTimeoutsSousMenus(lInstance);break;case'mouseleave':_stopperTimeoutsSousMenus(lInstance);if(lInstance._instanceSousMenu)
lInstance._instanceSousMenu._timeoutFermetureSousMenu=setTimeout(function(){lInstance._instanceSousMenu.Fermer();delete lInstance._instanceSousMenu;},c_delaiFermetureSousMenu);if(lInstance.estSousMenu){lInstance._timeoutFermetureSousMenu=setTimeout(function(){var lRacineSousMenu=lInstance,i=0;while(lRacineSousMenu._pereMenu&&lRacineSousMenu._pereMenu.estSousMenu&&i<100){lRacineSousMenu=lRacineSousMenu._pereMenu;i++;}
lRacineSousMenu.Fermer();},c_delaiFermetureSousMenu);}
break;}}};};function _ouvertureSousMenu(aElement,aAvecDelai){if(aElement&&this._instanceSousMenu){clearTimeout(this._instanceSousMenu._timeoutFermetureSousMenu);this._instanceSousMenu.Fermer();delete this._instanceSousMenu;}
_stopperTimeoutsSousMenus(this);var lThis=this;if(_avecSousMenu.call(this,aElement)){this._timeoutOuvertureSousMenu=setTimeout(function(){_afficherSousMenu.call(lThis,aElement);},aAvecDelai?c_delaiOuvertureSousMenu:0);}}
function _stopperTimeoutsSousMenus(aInstance){if(aInstance._timeoutFermetureSousMenu)
clearTimeout(aInstance._timeoutFermetureSousMenu);if(aInstance._timeoutOuvertureSousMenu)
clearTimeout(aInstance._timeoutOuvertureSousMenu);aInstance._timeoutFermetureSousMenu=null;aInstance._timeoutOuvertureSousMenu=null;if(aInstance._pereMenu){_stopperTimeoutsSousMenus(aInstance._pereMenu);}}
function _avecSousMenu(aElement){return aElement&&aElement.GetGenre()===EGenreLigneMenu.Deploiement&&aElement._initSousMenu;}
function _afficherSousMenu(aElement){var lThis=this;this._instanceSousMenu=ObjetMenuContextuel.afficher({pere:this,evenement:function(aLigne,aElement){lThis.callback.appel(aLigne,aElement);},initCommandes:aElement._initSousMenu,affichageSurInitCommandes:true});this._instanceSousMenu._pereMenu=this;this._instanceSousMenu.estSousMenu=true;this._instanceSousMenu.Afficher(aElement.id,true);if(aElement.apresAfficher)
aElement.apresAfficher(this._instanceSousMenu,aElement);}
ObjetMenuContextuel.prototype.ConstruireAffichage=function(){this._calculerPremiereDerniereLigne();var H=[];H.push('<span class="wai_hidden" tabindex="0"  onfocus="'+this.Nom+'.FocusSurPremierElement();"></span>');H.push('<div id="'+this.IdNomMenuContextuel+'" ',window.GObjetWAI.composeRole(EGenreRole.Listbox),' onmouseout="'+this.Nom+'.surSortieMenu ()"',' class="SansOutline" tabIndex="-1"',' onkeyup="if (GNavigateur.IsToucheFleche () || GNavigateur.IsToucheEchap ()) {'+this.Nom+'.ActionSurKey (id); GNavigateur.StopperEvenement (event);}">');H.push(window.GObjetWAI.composeSpan(EGenreObjet.MenuContextuel)+window.GObjetWAI.composeSpan(EGenreObjet.NavigationMenuContextuel));H.push('<table id="',this.IdZoneMenuContextuel,'" class="Texte10" ',' style="' ,(this.minLargeur?'width: '+this.minLargeur+'px; ':''),GStyle.composeBoxShadow(),GStyle.composeCouleurBordure(GCouleur.bordure) ,'"',' border="0" cellspacing="0" cellpadding="0">');for(var I=0;I<this.ListeLignes.GetNbrElements();I++)
H.push(this.ComposeLigne(I));H.push('</table>');H.push('</div>');H.push('<span class="wai_hidden" tabindex="0" onfocus="'+this.Nom+'.FocusSurPremierElement();"></span>');return H.join('');};ObjetMenuContextuel.prototype.ActionSurKey=function(AId){if(GNavigateur.IsToucheEchap()){this.Fermer(true);this.callback.appel();}
if(GNavigateur.IsToucheFleche()){this.NavigationClavier(AId);}};ObjetMenuContextuel.prototype.ComposeLigne=function(aPositionLigne){switch(this.ListeLignes.GetGenre(aPositionLigne)){case EGenreLigneMenu.Separateur:return this.ComposeSeparateur(aPositionLigne);case EGenreLigneMenu.Commande:return this.ComposeTexte(aPositionLigne);case EGenreLigneMenu.Liste:return this.ComposeListeElements(aPositionLigne);case EGenreLigneMenu.Deploiement:return this.ComposeTexte(aPositionLigne);case EGenreLigneMenu.SelecteurFichier:return this.ComposeTexte(aPositionLigne);}};ObjetMenuContextuel.prototype.ComposeListeElements=function(aPositionLigne){var H=[];if(this.ListeElements)
for(var I=0;I<this.ListeElements.GetNbrElements();I++)
if(this.ListeElements.Existe(I))
if((this.Genre===null||this.Genre===undefined)||(this.Genre===this.ListeElements.GetGenre(I)))
H.push(this.ComposeTexte(aPositionLigne,I));return H.join('');};ObjetMenuContextuel.prototype.ComposeSeparateur=function(aPositionLigne){var lLigne=this.ListeLignes.GetElement(aPositionLigne);var H=[];if(lLigne.Afficher!==false){H.push('<tr>');H.push('<td class="PetitEspaceGauche" style="width: 25px; ',this._getStyleArrondi(aPositionLigne,null,false),GStyle.composeCouleur(this.couleurBarre),'"></td>');H.push('</td>');H.push('<td class="PetitEspaceGauche PetitEspaceDroit" style="',this._getStyleArrondi(aPositionLigne,null,true),GStyle.composeCouleur(GCouleur.blanc),'"><div style="font-size: 1px; ',GStyle.composeCouleurBordure(GCouleur.bordure,1,EGenreBordure.haut) ,'">&nbsp:</div></td>');H.push('</td>');H.push('</tr>');}
return H.join('');};ObjetMenuContextuel.prototype.getIdCelluleTexte=function(aPositionLigne,aPositionElement){return aPositionElement===null||aPositionElement===undefined?this.Nom+'_'+aPositionLigne:this.Nom+'_'+aPositionLigne+'_'+aPositionElement;};ObjetMenuContextuel.prototype.getIdCelluleTexteParCommande=function(aGenreCommande){var lIndice=this.ListeLignes.GetIndiceParNumeroEtGenre(aGenreCommande,EGenreLigneMenu.Commande);return lIndice>=0?this.getIdCelluleTexte(lIndice):false;};ObjetMenuContextuel.prototype.ComposeTexte=function(aPositionLigne,aPositionElement){var lLigne=this.ListeLignes.GetElement(aPositionLigne);var H=[];if(lLigne.Afficher!==false){var lId=this.getIdCelluleTexte(aPositionLigne,aPositionElement);var lLibelle=aPositionElement===null||aPositionElement===undefined?this.ListeLignes.GetLibelle(aPositionLigne):this.ListeElements.GetLibelle(aPositionElement);var lImage=aPositionElement===null||aPositionElement===undefined?this.ListeLignes.GetElement(aPositionLigne).image:this.ListeElements.GetElement(aPositionElement).image;var lLargeurImage=aPositionElement===null||aPositionElement===undefined?this.ListeLignes.GetElement(aPositionLigne).largeurImage:this.ListeElements.GetElement(aPositionElement).largeurImage;var lActif=aPositionElement===null||aPositionElement===undefined?this.ListeLignes.GetElement(aPositionLigne).actif:this.ListeElements.GetElement(aPositionElement).actif;if(lActif===null||lActif===undefined) lActif=true;var lOnClick=lActif===true?'onclick="'+this.Nom+'.SurValidation ('+aPositionLigne+', '+aPositionElement+')"':'';var lOnKeyUp=lActif===true?'onkeyup="if (GNavigateur.IsToucheSelection()) '+this.Nom+'.SurValidation ('+aPositionLigne+', '+aPositionElement+')"':'';var lOnKeyNav=this.Nom+'.NavigationClavier (id); if (GNavigateur.IsToucheFleche ()) GNavigateur.StopperEvenement (event);';var lOnFocus=lActif===true?this.Nom+'.selectionnerLigneParPosition (\''+lId+'\', true , '+aPositionLigne+')':'';var lOnBlur=lActif===true?this.Nom+'.selectionnerLigneParPosition (\''+lId+'\', false , '+aPositionLigne+')':'';var lInfoLibelle=(this.ListeLignes.GetGenre(aPositionLigne)===EGenreLigneMenu.Deploiement?'<div id="'+lId+'_flechedroite" style="float:right;" class="FlecheDroiteMenuContextuel"></div>':'')+lLibelle+(lActif===true?'':window.GObjetWAI.composeSpan(' : ')+window.GObjetWAI.composeSpan(EGenreObjet.ItemDesactiver));var lPopupWAI=this.ListeLignes.GetGenre(aPositionLigne)===EGenreLigneMenu.Deploiement?GObjetWAI.composeAttribut({genre:EGenreAttribut.haspopup,valeur:'true'}):'';H.push('<tr id="'+lId+'" '+lOnClick+' '+lOnKeyUp+' onmousemove="'+this.Nom+'.SurSelection (id, '+lActif+', '+aPositionLigne+')" ie-event="touchstart-pointerdown-mouseenter-mouseover-mouseleave->eventSurLigne('+lActif+', '+aPositionLigne+')">');H.push('<td id="'+lId+'_image" style="width: '+(this.afficherAbbreviation?30:25)+'px; '+GStyle.composeCouleurBordure(this.couleurBarre,2,EGenreBordure.haut+EGenreBordure.bas+EGenreBordure.gauche)+' '+GStyle.composeCouleur(this.couleurBarre)+this._getStyleArrondi(aPositionLigne,aPositionElement,true)+'" class="AvecMain AlignementMilieu">'+(this.afficherAbbreviation?lImage?lImage:'':'<div style="width: 25px; height: 20px;">'+GImage.compose(lImage,lLargeurImage?lLargeurImage:16)+'</div>')+'</td>');H.push('<td id="'+lId+'_texte" style="height: 15px; '+GStyle.composeCouleurBordure(GCouleur.blanc ,2,EGenreBordure.haut+EGenreBordure.bas+EGenreBordure.droite)+' '+GStyle.composeCouleur(GCouleur.blanc,lActif?GCouleur.noir:GCouleur.inactif.texte)+this._getStyleArrondi(aPositionLigne,aPositionElement,false)+'" class="AvecMain Insecable PetitEspace">');H.push(this.ComposeElementNavigation(lId+'_',lInfoLibelle,EGenreRole.Listitem,lOnKeyNav,null,lOnFocus,lOnBlur));H.push('</td>');H.push('</tr>');if(this.IdPrecedent==='')
this.AjouterAuTableaux(this.IdPremierElement,lId+'_',null,EGenreDirection.SensNormal);else this.AjouterAuTableaux(this.IdPrecedent+'_',lId+'_',null,EGenreDirection.DeuxSenses);this.IdPrecedent=lId;}
return H.join('');};ObjetMenuContextuel.prototype._getStyleArrondi=function(aPositionLigne,aPositionElement,aGauche){var lPremiereLigne=!this._premiereLigne||((this._premiereLigne.positionLigne===aPositionLigne)&&(this._premiereLigne.positionElement===aPositionElement));var lDerniereLigne=!this._derniereLigne||((this._derniereLigne.positionLigne===aPositionLigne)&&(this._derniereLigne.positionElement===aPositionElement));var lCoins=0;lCoins+=lPremiereLigne?aGauche?0:EGenreCoin.hautD:0;lCoins+=lDerniereLigne?aGauche?EGenreCoin.basG:EGenreCoin.basD:0;return lCoins===0?'':GStyle.composeBordureArrondi(7,lCoins);};ObjetMenuContextuel.prototype.RecupererDonnees=function(){GStyle.setDisplay(this.Nom,false);};ObjetMenuContextuel.prototype.SetParametres=function(aMinLargeur,aAfficherAbbreviation){this.minLargeur=aMinLargeur;this.afficherAbbreviation=aAfficherAbbreviation;};ObjetMenuContextuel.prototype.SetDonnees=function(aID,aListeElements,aGenre,aAfficher){this.ListeElements=aListeElements;this.Genre=aGenre;if(aAfficher!==false)
this.Afficher(aID);};ObjetMenuContextuel.prototype.vider=function(){this.ListeLignes=new ObjetListeElements();};ObjetMenuContextuel.prototype.addDeploiement=function(aGenreDeploiement,aLibelle,aSousMenu,aAvecFiltreSurGenre){var lElement=new ObjetElement(aLibelle,aGenreDeploiement,EGenreLigneMenu.Deploiement);lElement.sousMenu=aSousMenu;lElement.sousMenu.avecFiltreSurGenre=aAvecFiltreSurGenre;this.ListeLignes.AddElement(lElement);return lElement;};ObjetMenuContextuel.prototype.addSousMenu=function(aLibelle,aInitialisationSousMenu,aApresAfficher){var lElement=new ObjetElement(aLibelle,null,EGenreLigneMenu.Deploiement);lElement._initSousMenu=aInitialisationSousMenu;lElement.apresAfficher=aApresAfficher;this.ListeLignes.AddElement(lElement);return lElement;};ObjetMenuContextuel.prototype.AddCommande=function(ANumeroCommande,ALibelle,AActif,aData){var LElement=new ObjetElement(ALibelle,ANumeroCommande,EGenreLigneMenu.Commande);LElement.actif=((AActif!==null&&AActif!==undefined)?AActif:true);LElement.data=aData;this.ListeLignes.AddElement(LElement);return LElement;};ObjetMenuContextuel.prototype.AddSeparateur=function(){this.ListeLignes.AddElement(new ObjetElement('',-1,EGenreLigneMenu.Separateur));};ObjetMenuContextuel.prototype.AddListe=function(){this.ListeLignes.AddElement(new ObjetElement('',-1,EGenreLigneMenu.Liste));};ObjetMenuContextuel.prototype.ActiverCommande=function(ANumeroCommande,AActiver){var LElement=this.ListeLignes.GetElementParNumeroEtGenre(ANumeroCommande,EGenreLigneMenu.Commande);if(LElement){LElement.actif=AActiver;GHtml.setHtml(this.Nom,this.ConstruireAffichage(),{controleur:this.controleur});}};ObjetMenuContextuel.prototype.setLibelleCommande=function(ANumeroCommande,ALibelle){var LElement=this.ListeLignes.GetElementParNumeroEtGenre(ANumeroCommande,EGenreLigneMenu.Commande);if(LElement){LElement.Libelle=ALibelle;GHtml.setHtml(this.Nom,this.ConstruireAffichage(),{controleur:this.controleur});}};ObjetMenuContextuel.prototype.AfficherCommande=function(aNumeroCommande,aAfficher){this.afficherLigne(aNumeroCommande,EGenreLigneMenu.Commande,aAfficher);};ObjetMenuContextuel.prototype.afficherLigne=function(aNumeroCommande,aGenreCommande,aAfficher){var lElement=this.ListeLignes.GetElementParNumeroEtGenre(aNumeroCommande,aGenreCommande);lElement.Afficher=aAfficher;GHtml.setHtml(this.Nom,this.ConstruireAffichage(),{controleur:this.controleur});};ObjetMenuContextuel.prototype.getNumerosCommande=function(){var lResult=[];this.ListeLignes.parcourir(function(aElement){if(aElement&&aElement.GetGenre()===EGenreLigneMenu.Commande)
lResult.push(aElement.GetNumero());});return lResult;};ObjetMenuContextuel.prototype._attacherEvenements=function(){for(var I=0;I<this.ListeLignes.GetNbrElements();I++)
if(this.ListeLignes.GetGenre(I)===EGenreLigneMenu.SelecteurFichier){var lElt=this.ListeLignes.GetElement(I);var lId=this.getIdCelluleTexte(I);$('#'+lId.escapeJQ()).on('mousemove',{aObjet:lElt.callbackSurSurvol.pere},lElt.callbackSurSurvol.evenement);}};ObjetMenuContextuel.prototype.Afficher=function(AId,aEstUnSousMenu){;if(!this.EstAffiche){this.ligne=null;if(!this.ListeLignes||this.ListeLignes.GetNbrElements()===0){IE.Log.addLog('ObjetMenuContextuel.prototype.Afficher : aucun élément à afficher');return;}
GHtml.setHtml(this.Nom,this.ConstruireAffichage(),{controleur:this.controleur});GStyle.setDisplay(this.Nom,true);this._attacherEvenements();if(AId){if(IE.MethodesObjet.isNumber(AId.x)&&IE.MethodesObjet.isNumber(AId.y))
GPosition.placer(this.Nom,AId.x,AId.y);else if(aEstUnSousMenu)
GPosition.placer(this.Nom,GPosition.getLeft(AId)+GPosition.getWidth(AId),GPosition.getTop(AId));else GPosition.placerFiche(this.Nom,AId);} else GPosition.placer(this.Nom,GNavigateur.SourisX+5,GNavigateur.SourisY+5);this.EstAffiche=true;GNavigateur.abonnementPremierPlan(this.Nom);GNavigateur.EnPremierPlan(this.Nom);this.FocusSurPremierElement();$('#'+this.Nom.escapeJQ()).off('mousedown touchstart',_mouseDownSurMenu).on('mousedown touchstart',{instance:this},_mouseDownSurMenu);}};function _mouseDownSurMenu(event){event.data.instance._marqueurMouseDownMenu=true;}
ObjetMenuContextuel.prototype._fermerMenuContextuelSurMouseDown=function(event){var lChercherMarqueur=_avecMarqueurMouseDown.call(this);if(this._marqueurMouseDownMenu){delete this._marqueurMouseDownMenu;}
else if(!lChercherMarqueur){this.Fermer();}};function _avecMarqueurMouseDown(){if(this._marqueurMouseDownMenu){return true;}
if(this._instanceSousMenu){return _avecMarqueurMouseDown.call(this._instanceSousMenu);}}
ObjetMenuContextuel.prototype.Fermer=function(aToutFermer){if(this.EstAffiche){this.EstAffiche=false;_stopperTimeoutsSousMenus(this);if(this._instanceSousMenu){this._instanceSousMenu.Fermer();delete this._instanceSousMenu;}
GStyle.setDisplay(this.Nom,false);this.effacer();this.ResetTableauxNavigation();this.IdPrecedent='';GNavigateur.desabonnementPremierPlan(this.Nom);if(this.destructionSurFermeture){this.free();}
if(aToutFermer&&this._pereMenu)
this._pereMenu.Fermer(true);}};ObjetMenuContextuel.prototype.SurSelection=function(aId,aActif,aPositionLigne){clearTimeout(this.timer);if(this.ligne){this.selectionnerLigne(false,this.ligne);this.afficherSousMenu(false,this.ligne);}
this.ligne=this.ListeLignes.GetElement(aPositionLigne);this.ligne.id=aId;this.ligne.actif=aActif;this.selectionnerLigne(true,this.ligne);this.afficherSousMenu(true,this.ligne);};ObjetMenuContextuel.prototype.surSortieMenu=function(){clearTimeout(this.timer);if(this.ligne&&!this.ligne.sousMenu)
this.selectionnerLigne(false,this.ligne);};ObjetMenuContextuel.prototype.selectionnerLigne=function(aSelectionner,aLigne){if(!aLigne)
return;GStyle.setCouleur(aLigne.id+'_image',aSelectionner?GCouleur.selection.fond:this.couleurBarre,aSelectionner?GCouleur.selection.texte:GCouleur.noir);GStyle.setCouleur(aLigne.id+'_texte',aSelectionner?GCouleur.selection.fond:GCouleur.blanc,aSelectionner?(aLigne.actif?GCouleur.selection.texte:GCouleur.inactif.texte):(aLigne.actif?GCouleur.noir:GCouleur.inactif.texte));GHtml.modifierClass(aLigne.id+'_flechedroite',aSelectionner?'FlecheDroiteMenuContextuel':'FlecheDroiteMenuContextuelSurvol',aSelectionner?'FlecheDroiteMenuContextuelSurvol':'FlecheDroiteMenuContextuel');};ObjetMenuContextuel.prototype.selectionnerLigneParPosition=function(aId,aSelectionner,aPosition){var lLigne=this.ListeLignes.GetElement(aPosition);lLigne.id=aId;lLigne.actif=true;this.selectionnerLigne(aSelectionner,lLigne);};ObjetMenuContextuel.prototype.afficherSousMenu=function(aAfficher,aLigne){;if(!aLigne||!aLigne.sousMenu)
return;if(aAfficher){if((aLigne.GetGenre()===EGenreLigneMenu.Deploiement)&&aLigne.sousMenu){if(aLigne.sousMenu.avecFiltreSurGenre)
aLigne.sousMenu.Genre=aLigne.Numero;aLigne.sousMenu.Afficher(aLigne.id,true);}} else{aLigne.sousMenu.Fermer();}};ObjetMenuContextuel.prototype.SurValidation=function(aPositionLigne,aPositionElement){this.ligne=this.ListeLignes.GetElement(aPositionLigne);this.ligne.id=this.getIdCelluleTexte(aPositionLigne,aPositionElement);if(this.ligne.GetGenre()===EGenreLigneMenu.Deploiement){this.afficherSousMenu(true,this.ligne);} else{this.Fermer(true);this.callback.appel(this.ligne,aPositionElement===null||aPositionElement===undefined?null:this.ListeElements.GetElement(aPositionElement));}};ObjetMenuContextuel.prototype._calculerPremiereDerniereLigne=function(){var lLigne;delete this._premiereLigne;for(var I=0;I<this.ListeLignes.GetNbrElements();I++){lLigne=this.ListeLignes.GetElement(I);if(this.ListeLignes.GetGenre(I)===EGenreLigneMenu.Liste){if(this.ListeElements)
for(var J=0;J<this.ListeElements.GetNbrElements();J++)
if(this.ListeElements.Existe(J))
if((this.Genre===null||this.Genre===undefined)||(this.Genre===this.ListeElements.GetGenre(J))){if(lLigne.Afficher!==false){this._derniereLigne={positionLigne:I,positionElement:J};if(!this._premiereLigne)
this._premiereLigne={positionLigne:I,positionElement:J};}}} else{if(lLigne.Afficher!==false){this._derniereLigne={positionLigne:I,positionElement:null};if(!this._premiereLigne)
this._premiereLigne={positionLigne:I,positionElement:null};}}}};}());;
MethodesObjet.heritagePrototype(ObjetSaisiePN,ObjetSaisie);function ObjetSaisiePN(ANom,AIdent,APere,AEvenement){this.inheritedCreate(ANom,AIdent,APere,AEvenement);this.largeurBouton=17;this.ListeElements=new ObjetListeElements();}
ObjetSaisiePN.prototype.initialiserOptions_ObjetSaisie=function(){this.inherited('initialiserOptions_ObjetSaisie');$.extend(this._options,{hauteur:15,classTexte:'Gras',avecEventSurFermetureListe:true,forcerBoutonDeploiement:false});};ObjetSaisiePN.prototype.SetParametres=function(AAvecTri,AAvecLigneVide,ALongueur,aAvecStyleSite,aForcerBoutonDeploiement,aLargeurListe,aHauteurCombo,aContenuHtml){this.setOptions_ObjetSaisie({longueur:ALongueur===null||ALongueur===undefined?150-this.largeurBouton:ALongueur,hauteur:aHauteurCombo?aHauteurCombo:undefined,largeurListe:aLargeurListe?aHauteurCombo:undefined,celluleAvecTexteHtml:aContenuHtml===null||aContenuHtml===undefined?false:aContenuHtml,forcerBoutonDeploiement:aForcerBoutonDeploiement===null||aForcerBoutonDeploiement===undefined?false:aForcerBoutonDeploiement,avecTriListeElements:AAvecTri===null||AAvecTri===undefined?false:AAvecTri});};ObjetSaisiePN.prototype.SetDonnees=function(AListeElements,ASelection,aSansSelection){this.ListeElements=AListeElements?AListeElements:new ObjetListeElements();if(this._options.avecTriListeElements){if(this.ListeElements.getTri()){this.ListeElements.trier();}
else{this.ListeElements.Trier();}}
this.listeDeroulee=false;this._remplirListe();var LLibelle='&nbsp;';if(this._options.avecGestionUnElement){if(this.ListeElements&&this.ListeElements.GetNbrElements()===1){var lElement=this.ListeElements.GetElement(0);if(lElement.Existe()&&lElement.GetLibelle()&&lElement.GetLibelle().length){ASelection=this.Selection=0;LLibelle=this.ListeElements.GetLibelle(this.Selection);}
else{this.Selection= -1;}}
if(this._options.celluleAvecTexteHtml)
this.bouton.setLibelleHtml(LLibelle);else this.bouton.setLibelle(LLibelle);}
if(!aSansSelection){this._surSetDonnnes=true;this.SetSelection(ASelection);}
if((this.ListeElements&&(this.ListeElements.GetNbrElementsExistes()>1))||this._options.forcerBoutonDeploiement){this.bouton.setAvecBouton(true);this.bouton.SetActif(true);}
else{this.bouton.setAvecBouton(false);this.bouton.SetActif(false);}};;
MethodesObjet.heritagePrototype(ObjetTabOnglets,Identite);function ObjetTabOnglets(ANom,AIdent,APere,AEvenement){this.inheritedCreate(ANom,AIdent,APere,AEvenement);this.listeOnglets=new ObjetListeElements();this.donneesRecues=false;this.donneesActualisees=false;this.idOnglets=this.Nom+'_Onglets';this.IdPremierElement=this.idOnglets;this.classDivBordure=IE.GUID.getClassCss();this.ongletSelectionne=0;this._initOptions();}
ObjetTabOnglets.prototype._initOptions=function(){this._options={espaceOnglets:4,hauteur:19,padding:3,largeur:0,couleur:new ObjectCouleurCellule(GCouleur.themeNeutre.moyen1,GCouleur.themeNeutre.foncee,GCouleur.bordure),couleurSelect:new ObjectCouleurCellule(GCouleur.fond,GCouleur.texte,GCouleur.bordure),largeurOnglets:0};};ObjetTabOnglets.prototype.setOptions=function(aOptions){$.extend(this._options,aOptions);};ObjetTabOnglets.prototype.SetParametres=function(aListeOnglets,aAvecStyleSite,aLargeurAffichage,aHauteurOnglets,aLargeurOnglets){this.setOptions({hauteur:(aHauteurOnglets?(aHauteurOnglets>12)?aHauteurOnglets:13:19),largeur:(aLargeurAffichage?aLargeurAffichage:0),largeurOnglets:(aLargeurOnglets?aLargeurOnglets:0)});this._options.padding=Math.floor((this._options.hauteur-13)/2);this.listeOnglets=aListeOnglets;};ObjetTabOnglets.prototype.ConstruireAffichage=function(aIdWAI){if(this.listeOnglets&&(this.listeOnglets.GetNbrElements()>0))
return this.composePage(aIdWAI);else return'';};ObjetTabOnglets.prototype.SetDonnees=function(aListeOnglets){this.listeOnglets=aListeOnglets;this.Afficher();};ObjetTabOnglets.prototype.composePage=function(aIdWAI){var lHtml=[];lHtml.push('<div id="',this.idOnglets,'" tabIndex="0" onkeyup="if (GNavigateur.IsToucheFleche ()) ',this.Nom,'.setFocusSurOnglet (event)" ',GObjetWAI.composeRole(EGenreRole.Tablist),'>',this.composeOnglets(aIdWAI),'</div>');return lHtml.join('');};ObjetTabOnglets.prototype.composeOnglets=function(aIdWAI){var lHtml=[];var i=0;var idPrecedent='';var idCourant='';var lTaille=this._options.largeurOnglets;for(i=0;i<this.listeOnglets.GetNbrElements();i++){var lElmOnglet=this.listeOnglets.GetElement(i);if(!lElmOnglet.invisible){if(this._options.largeurOnglets===0)
lTaille=this.getTaille(lElmOnglet.Libelle,10);var lTitle=this.estTailleMax(lTaille)?' title="'+lElmOnglet.Libelle+'"':'';var lLibelle=lElmOnglet.Libelle;var lCouleur=i===this.ongletSelectionne?this._options.couleurSelect:this._options.couleur;idCourant=this.getIdOnglet(i);lHtml.push('<div style="float:left;',GStyle.composeHeight(this._options.hauteur+(IE.Support.bordureExterneDIV?0:1)),GStyle.composeWidth(lTaille+this._options.espaceOnglets+(IE.Support.bordureExterneDIV?0:2)),'">','<div id="',idCourant,'" tabIndex="-1" onmousedown="',this.Nom,'.selectOnglet (',i,')" class="Texte10 AlignementMilieu SansOutline AlignementGauche AvecMain"',lTitle,' style="position: relative; ',GStyle.composeCouleur(lCouleur.fond,lCouleur.texte),GStyle.composeWidth(lTaille),GStyle.composeHeight(this._options.hauteur),GStyle.composeCouleurBordure(lCouleur.bordure,1,EGenreBordure.gauche+EGenreBordure.haut+EGenreBordure.droite),'">',this.ComposeElementNavigation('nav_'+idCourant,lLibelle,EGenreRole.Tab,null,null,null,null,'padding: '+this._options.padding+'px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;',null,aIdWAI?aIdWAI:idCourant),'</div>','</div>');if(idPrecedent!=='')
this.AjouterAuTableaux('nav_'+idPrecedent,'nav_'+idCourant,EGenreDirection.DeuxSenses);idPrecedent=idCourant;}}
return lHtml.join('');};ObjetTabOnglets.prototype.setLibelleOngletDIndice=function(aIndice,aLibelle){var lID=this.getIdOnglet(aIndice);var lElmOnglet=this.listeOnglets.GetElement(aIndice);lElmOnglet.SetLibelle(aLibelle);var lTaille=this._options.largeurOnglets;if(this._options.largeurOnglets===0)
lTaille=this.getTaille(lElmOnglet.Libelle,10);var lTitle=this.estTailleMax(lTaille)?' title="'+lElmOnglet.Libelle+'"':'';var lLibelle=GChaine.GetLongueurChaine(lElmOnglet.Libelle,10,true,lTaille);if(this._options.largeurOnglets===0){$('#'+lID.escapeJQ()).width(lTaille).parent().width(lTaille+this._options.espaceOnglets+(IE.Support.bordureExterneDIV?0:2));}
GHtml.setTitle(lID,lTitle);GHtml.setHtml('nav_'+lID,lLibelle);};ObjetTabOnglets.prototype.NavigationClavier=function(aId){if(GNavigateur.IsToucheFleche()){this.FocusSuivant(aId,(GNavigateur.IsToucheFlecheGauche()||GNavigateur.IsToucheFlecheDroite())?EGenreOrientationAffichage.Horizontal:EGenreOrientationAffichage.Vertical,(GNavigateur.IsToucheFlecheGauche()||GNavigateur.IsToucheFlecheHaut())?EGenreDirection.SensInverse:EGenreDirection.SensNormal);var lId=this.getIdNavigationSuivant(aId,(GNavigateur.IsToucheFlecheGauche()||GNavigateur.IsToucheFlecheDroite())?EGenreOrientationAffichage.Horizontal:EGenreOrientationAffichage.Vertical,(GNavigateur.IsToucheFlecheGauche()||GNavigateur.IsToucheFlecheHaut())?EGenreDirection.SensInverse:EGenreDirection.SensNormal);if(lId)
this.selectOnglet(this.getNumeroId(lId));else GHtml.setFocus(aId);}};ObjetTabOnglets.prototype.ActiverBordureNavigation=function(aId,aSouligne){};ObjetTabOnglets.prototype.setFocusSurOnglet=function(aEvent){this.NavigationClavier('nav_'+this.getIdOnglet(this.ongletSelectionne));if(GNavigateur.IsToucheFleche()||GNavigateur.IsToucheSelection()) GNavigateur.StopperEvenement(aEvent);};ObjetTabOnglets.prototype.getIdOnglet=function(i){return this.Nom+'_Tab_'+i;};ObjetTabOnglets.prototype.getIdPanel=function(i){return this.Nom+'_Panel_'+i;};ObjetTabOnglets.prototype.getNumeroId=function(aId){var lSegmentsId=aId.split('_');var lNumero=parseInt(lSegmentsId[lSegmentsId.length-1]);return lNumero;};ObjetTabOnglets.prototype.selectOnglet=function(i,aInitialisation){var lIdCourant=this.getIdOnglet(this.ongletSelectionne);var lIdNouveau=this.getIdOnglet(i);var lElement=this.listeOnglets.GetElement(i);GHtml.delClass('nav_'+lIdCourant,'Gras');GStyle.setCouleur(lIdCourant,this._options.couleur.fond,this._options.couleur.texte);$('.'+this.classDivBordure).remove();this.ongletSelectionne=i;GHtml.addClass('nav_'+lIdNouveau,'Gras');GStyle.setCouleur(lIdNouveau,this._options.couleurSelect.fond,this._options.couleurSelect.texte);var lJQ=$('#'+lIdNouveau.escapeJQ());var lWidth=lJQ.width();lJQ.append('<div class="'+this.classDivBordure+'" style="position: absolute; bottom : -1px; height: 1px; width: '+lWidth+'px; '+GStyle.composeCouleurFond(this._options.couleurSelect.fond)+'"></div>');if(!aInitialisation)
this.callback.appel(lElement);};ObjetTabOnglets.prototype.getElementSectionne=function(){return this.listeOnglets.GetElement(this.ongletSelectionne);};ObjetTabOnglets.prototype.getTailleFixe=function(aFontSize){var lResult=0;var lTaille=0;for(var i=0;i<this.listeOnglets.GetNbrElements();i++){lTaille=this.getTaille(this.listeOnglets.GetLibelle(i),aFontSize);if(lTaille>lResult)
lResult=lTaille;}
return lResult;};ObjetTabOnglets.prototype.getTaille=function(aLibelle,aFontSize){var lLargeur=GChaine.GetLongueurChaine(aLibelle,aFontSize,true)+6+2;var lMin=GChaine.GetLongueurChaine("XXXXXXXX",aFontSize,true)+6;var lWidth=(this._options.largeur>0?this._options.largeur:GPosition.getWidth(this.Nom))-(this.listeOnglets.GetNbrElements()*18);var lMax=Math.floor(lWidth/this.listeOnglets.GetNbrElements());lMax=Math.max(lMax,lMin);lLargeur=Math.max(lLargeur,lMin);lLargeur=Math.min(lLargeur,lMax);return lLargeur;};ObjetTabOnglets.prototype.estTailleMax=function(aTaille){var lWidth=(this._options.largeur>0?this._options.largeur:GPosition.getWidth(this.Nom))-(this.listeOnglets.GetNbrElements()*18);var lMax=Math.floor(lWidth/this.listeOnglets.GetNbrElements());return aTaille===lMax;};;

var EGenreDomaineInformation={Aucun:0,AvecContenu:1,Feriee:2,Cloturee:4,Cours:5,CoursPere:6,CoursPotentiel:7};function ObjetCalendrier(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.Selection=new TypeDomaine();this.InteractionUtilisateur=false;this.ajouterEvenementGlobal(EEvent.SurMouseUp,this.SurDeselection);this.ajouterEvenementGlobal(EEvent.SurKeyUp,this.SurDeselection.bind(this,true));if(this.avecEventResizeNavigateur()){this.ajouterEvenementGlobal(EEvent.SurResize ,this.SurPostResize);this.ajouterEvenementGlobal(EEvent.SurPostResize,this.SurPostResize);}
this.maxNombreSemaines=GDate.nombresSemainesDansLAnnee();this.ClassJour='Texte8';this.JourComplet=false;this.idTable=this.Nom+'_table';this.avecDonnees=false;this.cssSelectJour=IE.GUID.getClassCss();this.IdPremierElement=this.Nom+'_Div_Calendrier';this.cycles=IE.Cycles;}
MethodesObjet.heritagePrototype(ObjetCalendrier,Identite);(function(){ObjetCalendrier.prototype.DetruireInstances=function(){clearTimeout(this._timeoutRefresh);};ObjetCalendrier.prototype.SetParametres=function(APremiereDate,ADerniereDate,AAvecMultiSelection,AConserverNumerosCalendaires,aAvecDomaineCours,aAvecStyleSite,aCyclesReference){if(aCyclesReference){this.cycles=aCyclesReference;}
this.NombreSemaines=this.cycles.nombreCyclesAnneeScolaire();this.AvecMultiSelection=AAvecMultiSelection;this.ConserverNumerosCalendaires=AConserverNumerosCalendaires;this.avecDomaineCours=aAvecDomaineCours;this.tableauInformations=[];this.PeriodeDeConsultation=new TypeDomaine(true,this.NombreSemaines);this.Position= -1;this.EnSelection=false;this.LongueurMin=400;this._indicePeriodeCombo= -1;};ObjetCalendrier.prototype.setAvecComboPeriodes=function(aAvecComboPeriodes,aAvecPeriodePersonnalise,aAvecPeriodeCours){this.avecComboPeriodes=aAvecComboPeriodes;this.avecPeriodeCours=aAvecPeriodeCours;};ObjetCalendrier.prototype._getListePeriodes=function(aListePeriodes){var lLlistePeriodes=aListePeriodes?MethodesObjet.dupliquer(aListePeriodes):new ObjetListeElements();if(this.avecPeriodeCours){var lPeriode=new ObjetElement(GTraductions.getValeur('AjusterCours'),-1,-1);lPeriode.ClassAffichage='Gras';lPeriode.periodeCours=true;lLlistePeriodes.insererElement(lPeriode,0);}
return lLlistePeriodes;};ObjetCalendrier.prototype.setListePeriodes=function(aListePeriodes,aPeriodeParDefaut){if(this.avecComboPeriodes){this.listePeriodes=this._getListePeriodes(aListePeriodes);if(aPeriodeParDefaut&&this.listePeriodes){var lIndicePeriode=this.listePeriodes.GetIndiceParNumeroEtGenre(aPeriodeParDefaut.GetNumero(),aPeriodeParDefaut.GetGenre());if(lIndicePeriode>=0){this._indicePeriodeCombo=lIndicePeriode;}}
this.$refreshSelf();}};function _cycleDansDomaineDeGenre(aNumeroCycle,aGenreDomaine){return this.tableauInformations[aGenreDomaine]&&this.tableauInformations[aGenreDomaine].afficher&&this.tableauInformations[aGenreDomaine].domaine&&this.tableauInformations[aGenreDomaine].domaine.GetValeur(aNumeroCycle);}
ObjetCalendrier.prototype.getControleur=function(){return{eventsCalendrier:function(event,aElement){var lCycle=$(aElement).IEData().cycle;switch(event.type){case'iedown':this.instance.SurSelection(lCycle,true);break;case'iemove':if(this.instance.EnSelection){if(event.ietype==='touchmove'){for(var I=1;I<=this.instance.NombreSemaines;I++){var lElement=GHtml.getElement(this.instance.Nom+'_j_'+I);if(GPosition.positionDansZone({x:event.pageX,y:event.pageY},lElement)){lCycle=$(lElement).IEData().cycle;this.instance.SurSelection(lCycle);return;}}
return;}
this.instance.SurSelection(lCycle);}
break;case'touchend':this.instance.SurDeselection();break;}},getHtmlSemaine:function(aCycle){var lInstance=this.instance;if(lInstance.tableauInformations[EGenreDomaineInformation.Cloturee]&&lInstance.tableauInformations[EGenreDomaineInformation.Cloturee].domaine.GetValeur(aCycle)){return'<div class="Image_VerrouPeriodeActiveGris" style="position:relative; top:5px;"></div>';}
if(lInstance.tableauInformations[EGenreDomaineInformation.Feriee]&&lInstance.tableauInformations[EGenreDomaineInformation.Feriee].domaine.GetValeur(aCycle)){return GTraductions.getValeur('calendrier.ferieAbr');}
var LNumeroSemaine=lInstance.ConserverNumerosCalendaires?((aCycle-1)+(GDate.GetSemaineCalendaire()-1))%lInstance.maxNombreSemaines+1:aCycle;return lInstance.JourComplet?LNumeroSemaine:LNumeroSemaine%10;},getClassSemaine:function(aCycle){return _getClassDuJour.bind(this.instance)(aCycle);},getStyleSemaine:function(aCycle){return{'background-color':_getCouleurJour.bind(this.instance)(aCycle),'color':this.instance.PeriodeDeConsultation.GetValeur(aCycle)?GCouleur.getCouleurCorrespondance(_getCouleurJour.bind(this.instance)(aCycle)):'','line-height':'17px'};},getTitleSemaine:function(aCycle){return _composeTitleSemaine.bind(this.instance)(aCycle);},getWAIInfoSemaine:function(){return IE.MethodesObjet.isNumber(this.instance.Position)?_composeTitleSemaine.bind(this.instance)(this.instance.Position,true):'';},getStyleSemaineCours:function(aCycle){var lCouleurFond='',lCouleurTexte='';var lInstance=this.instance;if(_cycleDansDomaineDeGenre.bind(lInstance)(aCycle,EGenreDomaineInformation.Cours)){if(lInstance.tableauInformations[EGenreDomaineInformation.CoursPotentiel]&&lInstance.tableauInformations[EGenreDomaineInformation.CoursPotentiel].afficher&&lInstance.tableauInformations[EGenreDomaineInformation.CoursPotentiel].domaine){lCouleurFond='#648EEA';lCouleurTexte=GCouleur.blanc;}
else{lCouleurFond='#00FF00';}}
else if(_cycleDansDomaineDeGenre.bind(lInstance)(aCycle,EGenreDomaineInformation.CoursPere)){lCouleurFond='#C0FAC0';}
else if(_cycleDansDomaineDeGenre.bind(lInstance)(aCycle,EGenreDomaineInformation.CoursPotentiel)){lCouleurFond='#93B7FF';}
if(GEtatUtilisateur.getModeAccessible()){lCouleurFond=GCouleur.getCouleurAccessible(lCouleurFond);}
return{'background-color':lCouleurFond,'color':lCouleurTexte};},getLibelleSemaineCours:function(aCycle){var lInstance=this.instance;if(_cycleDansDomaineDeGenre.bind(lInstance)(aCycle,EGenreDomaineInformation.Cours)){if(lInstance.tableauInformations[EGenreDomaineInformation.CoursPotentiel]&&lInstance.tableauInformations[EGenreDomaineInformation.CoursPotentiel].afficher&&lInstance.tableauInformations[EGenreDomaineInformation.CoursPotentiel].domaine){var lItems=lInstance.tableauInformations[EGenreDomaineInformation.Cours].domaine.getSemaines();return IE.MethodesTableau.chercher(aCycle,lItems)+1;}}
return'';},getTitleSemaineCours:function(aCycle){var lInstance=this.instance;if(_cycleDansDomaineDeGenre.bind(lInstance)(aCycle,EGenreDomaineInformation.Cours)){return GTraductions.getValeur('DomaineCours');}
else if(_cycleDansDomaineDeGenre.bind(lInstance)(aCycle,EGenreDomaineInformation.CoursPere)){return GTraductions.getValeur('DomainePere');}
return'';},comboPeriode:{init:function(aCombo){aCombo.setOptions_ObjetSaisie({mode:EGenreSaisie.Liste,longueur:120,accepterUnElement:true});this.instance.comboP=aCombo;},getDonnees:function(){return this.instance.listePeriodes;},getIndiceSelection:function(){return this.instance._indicePeriodeCombo;},setIndiceSelection:function(aIndice,aInstance){if(aIndice>=0&&this.instance.listePeriodes){var lPeriode=this.instance.listePeriodes.GetElement(aIndice);if(lPeriode&&lPeriode.periodeCours){aIndice= -1;aInstance.SetContenu(GTraductions.getValeur('Personnalisee'));}}
this.instance._indicePeriodeCombo=aIndice;},getLibelle:function(){return this.instance._indicePeriodeCombo<0?GTraductions.getValeur('Personnalisee'):'';},event:function(aParametresCombo){_evenementSurComboPeriode.bind(this.instance)(aParametresCombo.genreEvenement,aParametresCombo.element,aParametresCombo.indice);}}};};ObjetCalendrier.prototype.Initialiser=function(){this.ConstruireAffichage();};function _getClassDuJour(I){if(!this.PeriodeDeConsultation.GetValeur(I)){return this.ClassJour+' Calendrier_JourInactif'+' '+this.cssSelectJour;}
var LClass=this.Selection.GetValeur(I)?'Calendrier_Jour_Selection':'Calendrier_Jour';if(this.PeriodeDeConsultation.GetValeur(I)){if(GCouleur.getCouleurCorrespondance(_getCouleurJour.bind(this)(I))==="white"){LClass+=" Blanc";}}
if(_cycleDansDomaineDeGenre.bind(this)(I,EGenreDomaineInformation.AvecContenu)){return this.ClassJour+' '+LClass+' '+'Calendrier_Jour_AvecContenu'+' '+this.cssSelectJour;}
return this.ClassJour+' '+LClass+' '+this.cssSelectJour;}
function _getGenreDomaine(aDomaine){var lAvecContenu=this.tableauInformations[EGenreDomaineInformation.AvecContenu]&&(this.tableauInformations[EGenreDomaineInformation.AvecContenu].domaine)&&!aDomaine.GetIntersection(this.tableauInformations[EGenreDomaineInformation.AvecContenu].domaine).EstVide();return lAvecContenu?EGenreDomaineInformation.AvecContenu:EGenreDomaineInformation.Aucun;}
function _getCouleurJour(I){if(this.frequences){if(this.frequences[I].genre===EGenreDomaineFrequence.QZ1){return this.Selection.GetValeur(I)?GCouleur.themeCouleur.claire:GCouleur.themeNeutre.legere;}
if(this.frequences[I].genre===EGenreDomaineFrequence.QZ2){return this.Selection.GetValeur(I)?GCouleur.themeCouleur.moyen1:GCouleur.themeNeutre.moyen2;}}
if(this.tableauInformations[EGenreDomaineInformation.Feriee]&&this.tableauInformations[EGenreDomaineInformation.Feriee].domaine.GetValeur(I)){return GCouleur.themeNeutre.claire;}
return this.Selection.GetValeur(I)?GCouleur.themeCouleur.moyen1:GCouleur.themeNeutre.moyen2;}
function _getNumeroSemaine(APosition){if(this.tableauInformations[EGenreDomaineInformation.Cloturee]&&this.tableauInformations[EGenreDomaineInformation.Cloturee].domaine.GetValeur(APosition)){return'<div class="Image_VerrouPeriodeActiveGris" style="position:relative; top:5px;"></div>';}
if(this.tableauInformations[EGenreDomaineInformation.Feriee]&&this.tableauInformations[EGenreDomaineInformation.Feriee].domaine.GetValeur(APosition)){return GTraductions.getValeur('calendrier.ferieAbr');}
var LNumeroSemaine=this.ConserverNumerosCalendaires?((APosition-1)+(GDate.GetSemaineCalendaire()-1))%this.maxNombreSemaines+1:APosition;return this.JourComplet?LNumeroSemaine:LNumeroSemaine%10;}
function _estSemaineFeriee(aPosition){return _getNumeroSemaine.bind(this)(aPosition)===GTraductions.getValeur('calendrier.ferieAbr');}
function _actualiser(){if(this.EstUneInteractionUtilisateur()&&!GNavigateur.isTactile){GHtml.setFocus(this.Nom+'_InfoSemaine',true,true);}
if(this.$refreshSelf){this.$refreshSelf();}}
ObjetCalendrier.prototype.setMultiSelection=function(AAvecMultiSelection){this.AvecMultiSelection=AAvecMultiSelection;};ObjetCalendrier.prototype.setMultiSemainesContinues=function(aAvecMultiSemainesContinues){if(aAvecMultiSemainesContinues)
this.AvecMultiSelection=false;this.avecMultiSemainesContinues=aAvecMultiSemainesContinues;};ObjetCalendrier.prototype.SetSelection=function(ASelection){this.InteractionUtilisateur=false;ASelection=ASelection>=1?ASelection<=this.NombreSemaines?ASelection:this.NombreSemaines:1;this.SetDomaine(new TypeDomaine(ASelection));};ObjetCalendrier.prototype.SetDomaine=function(ADomaine,aSansEvenement){this.InteractionUtilisateur=false;this.avecDonnees=true;this.Selection=ADomaine.GetIntersection(this.PeriodeDeConsultation);delete this._donneesActualisation;this.Position=this.Selection.GetPremierePosition();_actualiser.bind(this)();if(!aSansEvenement)
this.DeclencherEvenement();};ObjetCalendrier.prototype.SetDomaineInformation=function(aDomaine,aGenre,aAfficher,aActualiser){this.tableauInformations[aGenre]={};this.tableauInformations[aGenre].domaine=MethodesObjet.dupliquer(aDomaine);this.tableauInformations[aGenre].afficher=aAfficher===null||aAfficher===undefined?true:aAfficher;if(this.avecPeriodeCours&&this.afficherPeriodeCours&&this.avecComboPeriodes&&this.listePeriodes&&aGenre===EGenreDomaineInformation.Cours){_actualiserElementPeriodeCoursDuCombo.bind(this)(!this.tableauInformations[aGenre].afficher||!aDomaine||aDomaine.EstVide());this.comboP.SetDonnees(this.listePeriodes);}
if(aActualiser!==false){_actualiser.bind(this)();}};ObjetCalendrier.prototype.setDates=function(aDateDeb,aDateFin,aSansEvenement){var lSemaineDeb=this.cycles.cycleDeLaDate(aDateDeb);var lSemaineFin=this.cycles.cycleDeLaDate(aDateFin);var lDomaine=new TypeDomaine();lDomaine.SetValeur(true,lSemaineDeb,lSemaineFin);this.SetDomaine(lDomaine,aSansEvenement);};ObjetCalendrier.prototype.getDates=function(){var lDates={};lDates.dateDebut=this.cycles.dateDebutCycle(this.Selection.GetPremierePosition());lDates.dateFin=this.cycles.dateDernierJourOuvreCycle(this.Selection.GetDernierePosition());return lDates;};function _actualiserElementPeriodeCoursDuCombo(aSansDomaineCours){var lPeriode=null,i,lNb;for(i=0,lNb=this.listePeriodes.GetNbrElements();i<lNb;i++){if(this.listePeriodes.GetElement(i).periodeCours){lPeriode=this.listePeriodes.GetElement(i);break;}}
if(lPeriode){lPeriode.Visible=!aSansDomaineCours;}
return lPeriode;}
ObjetCalendrier.prototype.setFrequences=function(aFrequences,aFeries){this.frequences=aFrequences;if(aFeries){this.SetDomaineInformation(this.cycles.getDomaineFerie(),EGenreDomaineInformation.Feriee);}};ObjetCalendrier.prototype.setDomaineCours=function(aDomaineCours,aDomaineCoursPere,aAfficherPeriodeCours,aDomaineCoursPotentiel){this.afficherPeriodeCours=aAfficherPeriodeCours===null||aAfficherPeriodeCours===undefined?true:aAfficherPeriodeCours;this.SetDomaineInformation(aDomaineCours ,EGenreDomaineInformation.Cours,null,false);this.SetDomaineInformation(aDomaineCoursPere,EGenreDomaineInformation.CoursPere,null,false);this.SetDomaineInformation(aDomaineCoursPotentiel,EGenreDomaineInformation.CoursPotentiel,null,false);_actualiser.bind(this)();};ObjetCalendrier.prototype.resetDomaineCours=function(){this.InteractionUtilisateur=false;this.setDomaineCours();};ObjetCalendrier.prototype.SetPeriodeDeConsultation=function(APeriodeDeConsultation){this.PeriodeDeConsultation=APeriodeDeConsultation;_actualiser.bind(this)();};ObjetCalendrier.prototype.ConstruireAffichage=function(){var H='';H+='<div id="'+this.IdPremierElement+'" '+window.GObjetWAI.composeRole(EGenreRole.Tabpanel)+' tabindex="0" class="wai_hidden Calendrier_Boutons" onkeyup="'+this.Nom+'.SelectionSemaine ()" '+GObjetWAI.composeAttribut({genre:EGenreAttribut.label,valeur:window.GObjetWAI.getInfo(EGenreObjet.CalendrierNavigation)+window.GObjetWAI.getInfo(EGenreObjet.NavigationHorizontal)})+'>';H+='<span tabindex="-1" id="'+this.Nom+'_InfoSemaine" class="Calendrier_Boutons" '+window.GObjetWAI.composeRole(EGenreRole.Tab)+' ie-html="getWAIInfoSemaine"'+' ></span>';H+='</div>';H+='<div tabIndex="-1" id="'+this.Nom+'_Boutons" class="Calendrier_Boutons" onkeyup="'+this.Nom+'.SelectionSemaine ()">';H+='<table id="'+this.idTable+'" width="100%; height: 70px;" border="0" cellspacing="0" cellpadding="0">';H+='<tr>';if(this.avecComboPeriodes){H+='<td tyle="width:auto;" class="EspaceDroit AlignementHaut">'+'<ie-combo ie-model="comboPeriode"></ie-combo>'+'</td>';}
H+='<td id="'+this.Nom+'_Calendrier" width="100%" '+' ie-event="iedown-iemove-touchend->{.'+this.cssSelectJour+'}eventsCalendrier" '+'>'+'&nbsp;</td>';H+='</tr>';H+='</table>';H+='</div>';H+='<div class="hide" style="width:'+this.LongueurMin+'px;font-size:0px;"></div>';GHtml.setHtml(this.Nom,H,{controleur:this.controleur});var lLargeurCalendrier=GPosition.getWidth(this.Nom+'_Calendrier');this.Zoom=Math.max(8,Math.floor(lLargeurCalendrier/this.NombreSemaines));this.ClassJour=this.Zoom>17?'Texte10':(this.Zoom>15?'Texte9':'Texte8');this.JourComplet=this.Zoom>13;GHtml.setHtml(this.Nom+'_Calendrier',this.ComposeJours()+this.ComposeMois(this.Zoom*this.NombreSemaines),{controleur:this.controleur});};ObjetCalendrier.prototype.ComposeJours=function(){var H='',I;H+='<table class="IE_draggable" style="'+GStyle.composeCouleurFond(GCouleur.bordure)+'" border="0" cellspacing="0" cellpadding="0">';H+='<tr height="20px" align="center" valign="middle">';for(I=1;I<=this.NombreSemaines;I++){H+=this.ComposeUnJour(I,this.Zoom-4);}
H+='</tr>';H+='</table>';return H;};ObjetCalendrier.prototype.ComposeUnJour=function(I,ADimension){var T=[];T.push('<td>');T.push('<div id="',this.Nom+'_j_',I,'" ie-class="getClassSemaine('+I+')"',' style="overflow-x:hidden;',GStyle.composeWidth(ADimension),(GNavigateur.bordureExterneDiv?'height:23px;':''),'"',' ie-style="getStyleSemaine(',I,')" ',IE.HTML.ieData({cycle:I}),' ie-hint="getTitleSemaine(',I,')"',' ie-html="getHtmlSemaine(',I,')"','>'+'</div>');if(this.avecDomaineCours){T.push('<div class="Calendrier_Jour_Domaine Texte8" ',' ie-hint="getTitleSemaineCours(',I,')" ',' ie-style="getStyleSemaineCours(',I,')"',' ie-html="getLibelleSemaineCours(',I,')"','></div>');}
T.push('</td>');return T.join('');};function _composeTitleSemaine(APosition,AWai){var LNumeroSemaine=this.ConserverNumerosCalendaires?((APosition-1)+(GDate.GetSemaineCalendaire()-1))%this.maxNombreSemaines+1:APosition;var LDateDeb=AWai?GDate.FormatDate(this.cycles.dateDebutCycle(APosition),'%J %MMMM %AAAA'):GDate.FormatDate(this.cycles.dateDebutCycle(APosition),'%JJ/%MM/%AAAA');var LDateFin=AWai?GDate.FormatDate(this.cycles.dateDernierJourOuvreCycle(APosition),'%J %MMMM %AAAA'):GDate.FormatDate(this.cycles.dateDernierJourOuvreCycle(APosition),'%JJ/%MM/%AAAA');var lFrequence=_estSemaineFeriee.bind(this)(APosition)?GTraductions.getValeur('Feriee').toLowerCase():(this.frequences&&this.frequences[APosition]?this.frequences[APosition].libelle:'');return GTraductions.getValeur('Semaine')+' '+(lFrequence||LNumeroSemaine)+', '+GTraductions.getValeur('Du')+' '+LDateDeb+' '+GTraductions.getValeur('Au')+' '+LDateFin;}
function _getTraductionsMois(aIndice){var lTraductions=GTraductions.ListeMoisCourt||GTraductions.MoisCourt;return lTraductions?lTraductions[aIndice]:'';}
ObjetCalendrier.prototype.ComposeMois=function(aLargeurMax){var H='';H+='<table border="0" cellspacing="0" cellpadding="0">';H+='<tr align=center valign=middle>';var LRapport=this.Zoom/this.cycles.nombreJoursOuvresParCycle();var LTaille;var LChaine;var LResidu=0;var lLargeurTotal=0;var lMarges=2,LMois;var lCycle=1,lJourCycle=0,lNombreCycles=this.cycles.nombreCyclesAnneeScolaire(),lNombreJoursCycle=this.cycles.nombreJoursOuvresParCycle(),lDate,lMoisPrecedent=null,lEstDernierJour=false,lNbJoursCycleCourant=0;while(lCycle<=lNombreCycles){while(lJourCycle<lNombreJoursCycle){lDate=this.cycles.jourCycleEnDate(lJourCycle,lCycle);LMois=lDate.getMonth();if(lMoisPrecedent===null||lMoisPrecedent===undefined){lMoisPrecedent=LMois;}
lEstDernierJour=lJourCycle===lNombreJoursCycle-1&&lCycle===lNombreCycles;if(LMois!==lMoisPrecedent||lEstDernierJour){if(lEstDernierJour){lNbJoursCycleCourant+=1;}
LTaille=lNbJoursCycleCourant*LRapport-2+LResidu;LTaille=Math.min(LTaille,aLargeurMax-lLargeurTotal-lMarges);LResidu=LTaille-Math.round(LTaille);lLargeurTotal+=Math.round(LTaille)+lMarges;if(GChaine.GetLongueurChaine(_getTraductionsMois(lMoisPrecedent%12),10,true)>LTaille){LChaine='<font style="font-size:1px">&nbsp;</font>';}
else{LChaine=GChaine.AvecEspaceSiVide(_getTraductionsMois(lMoisPrecedent%12));}
if(LTaille>0){H+='<td width='+Math.round(LTaille)+'px class="Texte10 Gras FondBlanc Calendrier_Mois">'+LChaine+'</td>';}
lMoisPrecedent=LMois;lNbJoursCycleCourant=0;}
lJourCycle+=1;lNbJoursCycleCourant+=1;}
lCycle+=1;lJourCycle=0;}
H+='</tr>';H+='</table>';return H;};ObjetCalendrier.prototype.SelectionSemaine=function(){if(GNavigateur.IsToucheFlecheGauche()){if(this.Param_Position===undefined) this.Param_Position=this.Position;_SurPrecedent.bind(this)();}
if(GNavigateur.IsToucheFlecheDroite()){if(this.Param_Position===undefined) this.Param_Position=this.Position;_SurSuivant.bind(this)();}
if(GNavigateur.IsToucheSelection()){this.DeclencherEvenement(true);}};ObjetCalendrier.prototype.FocusBoutons=function(ABool){};ObjetCalendrier.prototype.DeclencherEvenement=function(ASurClavier){if(GNavigateur.CtrlTouche&&!this.avecMultiSemainesContinues){this.bloquerEvenement=true;} else{this.bloquerEvenement=false;this._surClavier=ASurClavier;if(this.ControleNavigation&&IE.controleSaisieSurEvenement){IE.controleSaisieSurEvenement(_retourSurNavigation.bind(this));}
else{_retourSurNavigation.bind(this)(true);}}};function _retourSurNavigation(){var LPosition=this.Selection.GetPremierePosition();IE.Invocateur.evenement('modificationDomaineCalendrier',{domaine:this.Selection,interactionUtilisateur:this.EstUneInteractionUtilisateur()});this.callback.appel(LPosition,this.Selection,_getGenreDomaine.bind(this)(this.Selection),!this.Selection.GetIntersection(this.PeriodeDeConsultation).EstVide(),this._surClavier,this.avecComboPeriodes&&(this._indicePeriodeCombo>=0)?this.listePeriodes.GetElement(this._indicePeriodeCombo):null);delete this._surClavier;}
ObjetCalendrier.prototype.SurDeplacement=function(APosition){if(this.EnSelection){this.SurSelection(APosition,true);}};function _evenementSurComboPeriode(aGenreEvenement,aPeriode,aIndice){if(!aPeriode){return;}
if(aPeriode&&aPeriode.periodeCours){var lTabInfosCours=this.tableauInformations[EGenreDomaineInformation.Cours];if(lTabInfosCours&&lTabInfosCours.afficher&&lTabInfosCours.domaine&&!lTabInfosCours.domaine.EstVide()){this.SetDomaine(new TypeDomaine(lTabInfosCours.domaine.toString()));} else{;}}
else{if((aIndice>0)&&aPeriode.domaine){this.SetDomaine(MethodesObjet.dupliquer(aPeriode.domaine));}}}
function _initDonneesActualisation(){this._donneesActualisation={valeur:this.Selection.GetValeur(this.Position),domaine:IE.MethodesObjet.dupliquer(this.Selection),debut:this.Param_Position,fin:this.Param_Position};}
function _actualiserCalendrierSurPosition(ASansDeselection,aInitialisationDeplacement){this.EnSelection=true;var lAvecRefresh=false;var lDeb,lFin,I,lAncienneValeur,lNouvelleValeur,lSurAjoutMultiSelection=this.AvecMultiSelection&&!this.avecMultiSemainesContinues&&(GNavigateur.CtrlTouche||GNavigateur.isTactile);if((this.Param_Position>=1)&&(this.Param_Position<=this.NombreSemaines)&&(this.PeriodeDeConsultation.GetValeur(this.Param_Position))){if((!this.AvecMultiSelection&&!this.avecMultiSemainesContinues)||(aInitialisationDeplacement&&(GNavigateur.isTactile||(!this.avecMultiSemainesContinues&&!GNavigateur.ShiftTouche)||(this.avecMultiSemainesContinues&&!GNavigateur.CtrlTouche&&!GNavigateur.ShiftTouche)))){this.Position=this.Param_Position;_initDonneesActualisation.call(this);}
else{if(!this._donneesActualisation){if(this.Param_Position<this.Selection.GetPremierePosition())
this.Position=this.Selection.GetDernierePosition();_initDonneesActualisation.call(this);}
this._donneesActualisation.debut=Math.min(this.Param_Position,this._donneesActualisation.debut);this._donneesActualisation.fin=Math.max(this.Param_Position,this._donneesActualisation.fin);}
var LPositionDeb=Math.min(this.Position,this.Param_Position);var LPositionFin=Math.max(this.Position,this.Param_Position);if(this.avecMultiSemainesContinues){lDeb=Math.min(this.Selection.GetPremierePosition(),this._donneesActualisation.debut);lFin=Math.max(this.Selection.GetDernierePosition(),this._donneesActualisation.fin);}
else if(lSurAjoutMultiSelection){lDeb=this._donneesActualisation.debut;lFin=this._donneesActualisation.fin;} else{lDeb=1;lFin=this.NombreSemaines;}
for(I=lDeb;I<=lFin;I++){lAncienneValeur=this.Selection.GetValeur(I);if(lSurAjoutMultiSelection){if(I>=LPositionDeb&&I<=LPositionFin)
lNouvelleValeur=!this._donneesActualisation.valeur&&this.PeriodeDeConsultation.GetValeur(I);else lNouvelleValeur=this._donneesActualisation.domaine.GetValeur(I);}
else{lNouvelleValeur=(I>=LPositionDeb)&&(I<=LPositionFin)&&this.PeriodeDeConsultation.GetValeur(I);}
this.Selection.SetValeur(lNouvelleValeur,I);lAvecRefresh=lAvecRefresh||lAncienneValeur!==lNouvelleValeur;}
this.periodePersonnalisee=true;if(this.avecComboPeriodes)
if(this._indicePeriodeCombo!== -1||this.avecPeriodeCours){if(this._indicePeriodeCombo!== -1)
lAvecRefresh=true;this._indicePeriodeCombo= -1;}
if(lAvecRefresh)
_actualiser.bind(this)();if(!ASansDeselection){this.SurDeselection();}}}
ObjetCalendrier.prototype.SurSelection=function(APosition,aInitialisationDeplacement){if(this.Actif&&this.PeriodeDeConsultation.GetValeur(APosition)){this.InteractionUtilisateur=true;if(!GNavigateur.isTactile)
GHtml.setFocus(this.Nom+'_InfoSemaine',false);this.Param_Position=APosition;_actualiserCalendrierSurPosition.bind(this)(true,aInitialisationDeplacement);}};ObjetCalendrier.prototype.SurDeselection=function(aSurKeyUp){if(this.bloquerEvenement&&!GNavigateur.CtrlTouche&&!this.avecMultiSemainesContinues){this.DeclencherEvenement(false);}
else if(this.EnSelection){this.DeclencherEvenement();this.EnSelection=false;}
if(aSurKeyUp){GNavigateur.ResetCodeTouche();}};function _SurSuivant(){var LPosition=this.Param_Position;do{LPosition++;}
while((LPosition<=this.NombreSemaines)&&!this.PeriodeDeConsultation.GetValeur(LPosition));this.SurSelection(LPosition,true);}
function _SurPrecedent(){var LPosition=this.Param_Position;do{LPosition--;}
while((LPosition>=1)&&!this.PeriodeDeConsultation.GetValeur(LPosition));this.SurSelection(LPosition,true);}
ObjetCalendrier.prototype.SurPostResize=function(){GHtml.setHtml(this.Nom,'&nbsp;');this.ConstruireAffichage();};}());;
function ObjetFenetre_Date(ANom,AIdent,APere,AEvenement){this.inheritedCreate(ANom,AIdent,APere,AEvenement);this.SetParametres_Fenetre(GTraductions.getValeur('Fenetre_Date.Titre'),200,100,null);this.nbrLignes=6;this.nbrColonnes=7;this.idCouleur=this.Nom+'_Couleur';this.idCode=this.Nom+'_Code';this.idJours=this.Nom+'_Jours';this.afficherPremiereDateSaisissable=false;this.afficherDateCourante=true;this.tailleCellule=20;this.margeCellule=5;this.avecTailleSelonContenu=true;this.parametres={listeMois:new ObjetListeElements(),indiceMoisCourant:-1};}
MethodesObjet.heritagePrototype(ObjetFenetre_Date,ObjetFenetre);(function(){function _initSurSelecMois(aInstance){aInstance.setOptions_ObjetSaisie({longueur:145,classTexte:'AlignementMilieu'});}
function _eventSurSelecMois(aGenre,aElement,aIndice){if(aGenre===EGenreEvenementObjetSaisie.selection){this.parametres.indiceMoisCourant=aIndice;_acualiserSelonMoisCourant.bind(this)();}}
ObjetFenetre_Date.prototype.ConstruireInstances=function(){this.IdentBoutonInferieur=this.Add(window.ObjetBoutonBandeau,changerDeMois.bind(this,-1),this._initBoutonInferieur.bind(this,-1));this.IdentBoutonSuperieur=this.Add(window.ObjetBoutonBandeau,changerDeMois.bind(this,1),this._initBoutonInferieur.bind(this,1));this.identSelecMois=this.Add(window.ObjetSaisie,_eventSurSelecMois.bind(this),_initSurSelecMois.bind(this));};ObjetFenetre_Date.prototype._initBoutonInferieur=function(aIndice,aInstance){var lLibelle=aIndice=== -1?GTraductions.getValeur('Fenetre_Date.MoisPrecedent'):GTraductions.getValeur('Fenetre_Date.MoisSuivant');aInstance.SetParametres(aIndice=== -1?'Image_PassageAuPrecedentPourBandeau':'Image_PassageAuSuivantPourBandeau',true,false,true,[lLibelle,lLibelle,lLibelle],20,false,false);};function _getIndiceMoisDeDate(aDate){var lAnnee=aDate.getFullYear(),lMois=aDate.getMonth(),lIndice= -1;this.parametres.listeMois.parcourir(function(D,aIndex){if(D.mois===lMois&&D.annee===lAnnee){lIndice=aIndex;return false;}});return lIndice;}
ObjetFenetre_Date.prototype.setParametres=function(aPremierLundi,aPremiereDate,aDerniereDate,aActifJour,aActifSemaine,aJoursFeries,aAvecAucuneDate){this.premierLundi=aPremierLundi;this.premiereDate=aPremiereDate;this.derniereDate=aDerniereDate;this.actifJour=aActifJour?aActifJour:new TypeDomaine(true,7);this.actifSemaine=aActifSemaine?aActifSemaine:new TypeDomaine(true,52);this.joursFeries=aJoursFeries?aJoursFeries:new TypeDomaine(false,365);this.parametres.listeMois=GDate.getListeMoisAPartirDeDate(this.premiereDate);if(aAvecAucuneDate)
this.SetListeBoutons([GTraductions.getValeur('Fenetre_Date.AucuneDate')]);};ObjetFenetre_Date.prototype.setPremiereDateSaisissable=function(aPremiereDateSaisissable,aAfficher){this.premiereDateSaisissable=aPremiereDateSaisissable?this._getDateBornee(aPremiereDateSaisissable):this.premiereDate;this.afficherPremiereDateSaisissable=aAfficher?aAfficher:false;};ObjetFenetre_Date.prototype.setJoursMarques=function(aJoursMarques){if(aJoursMarques)
this.joursMarques=aJoursMarques;};ObjetFenetre_Date.prototype.setAfficherDateCourante=function(aAfficher){this.afficherDateCourante=aAfficher;};function _acualiserSelonMoisCourant(){var lElement=this.parametres.listeMois.GetElement(this.parametres.indiceMoisCourant);this.mois=lElement.mois;this.annee=lElement.annee;this.premierJourDuMois=GDate.GetPremierJourDuMois(lElement.annee,lElement.mois);this.premierLundiDuMois=GDate.GetPremierLundiDuMois(lElement.annee,lElement.mois);this.premiereSemaineDuMois=1+Math.floor(GDate.GetDifferenceJours(this.premierLundiDuMois,this.premierLundi)/7);this.GetInstance(this.IdentBoutonInferieur).setActif(this.parametres.indiceMoisCourant>0);this.GetInstance(this.IdentBoutonSuperieur).setActif(this.parametres.indiceMoisCourant<this.parametres.listeMois.GetNbrElements()-1);_afficherJoursDeMoisCourant.bind(this)();}
function _getLigneEtColonne(aElement){return{i:GHtml.extraireNombreDId(aElement.id,1),j:GHtml.extraireNombreDId(aElement.id)};}
ObjetFenetre_Date.prototype.SetDonnees=function(aDate){this.dateCourante=GDate.getDateCourante();this.avecDate=(aDate!==null&&aDate!==undefined);this.date=this.avecDate?this._getDateBornee(aDate):this.dateCourante;this.Actualiser();this.Afficher();this.GetInstance(this.IdentBoutonInferieur).Initialiser();this.GetInstance(this.IdentBoutonSuperieur).Initialiser();this.GetInstance(this.identSelecMois).Initialiser();this.parametres.indiceMoisCourant=_getIndiceMoisDeDate.bind(this)(this.date);this.GetInstance(this.identSelecMois).SetDonnees(this.parametres.listeMois,this.parametres.indiceMoisCourant);$('#'+this.idJours.escapeJQ()).on({focusin:function(event){var lInfo=_getLigneEtColonne(this);event.data.instance.surSurvol(lInfo.i,lInfo.j,true);},focusout:function(event){var lInfo=_getLigneEtColonne(this);event.data.instance.surSurvol(lInfo.i,lInfo.j,false);},keyup:function(event){var lInfo=_getLigneEtColonne(this);_surKeyUp.bind(event.data.instance)(lInfo.i,lInfo.j);}},'td.AvecMain>div',{instance:this}).on({mouseover:function(event){var lInfo=_getLigneEtColonne(this);event.data.instance.surSurvol(lInfo.i,lInfo.j,true);},mouseout:function(event){var lInfo=_getLigneEtColonne(this);event.data.instance.surSurvol(lInfo.i,lInfo.j,false);},touchstart:function(event){var lInfo=_getLigneEtColonne(this);event.data.instance.surSurvol(lInfo.i,lInfo.j,true);},touchend:function(event){var lInfo=_getLigneEtColonne(this);event.data.instance.surSurvol(lInfo.i,lInfo.j,false);},click:function(event){var lInfo=_getLigneEtColonne(this);event.data.instance.surSelection(lInfo.i,lInfo.j);}},'td.AvecMain',{instance:this});};ObjetFenetre_Date.prototype.ComposeContenu=function(){if(this.dateCourante===null||this.dateCourante===undefined)
return'';this.GetInstance(this.IdentBoutonInferieur).setOptions_ObjetBoutonBandeau({labelWAI:GDate.FormatDate(this.premierJourDuMois,'%MMM %AAAA')});this.GetInstance(this.IdentBoutonSuperieur).setOptions_ObjetBoutonBandeau({labelWAI:GDate.FormatDate(this.premierJourDuMois,'%MMM %AAAA')});var T=[];T.push('<table class="Texte10 AvecMain" style="'+GStyle.composeCouleurTexte(GCouleur.noir)+' width:100%;" border="0" cellpadding="0" cellspacing="0">','<tr>','<td id="',this.GetInstance(this.IdentBoutonInferieur).GetNom(),'">',this.GetInstance(this.IdentBoutonInferieur).ConstruireAffichage(),'</td>','<td id="',this.GetInstance(this.identSelecMois).GetNom(),'">','</td>','<td id="',this.GetInstance(this.IdentBoutonSuperieur).GetNom(),'">',this.GetInstance(this.IdentBoutonSuperieur).ConstruireAffichage(),'</td>','</tr>','</table>');T.push('<div id="',this.idJours,'"></div>');return T.join('');};function _afficherJoursDeMoisCourant(){var T=[],I,J;T.push('<table class="Texte10 EspaceHaut" style="'+GStyle.composeCouleurTexte(GCouleur.noir)+'" border="0" cellpadding="0" cellspacing="0">');T.push('<tr>');for(J=0;J<this.nbrColonnes;J++){var lJour=(J+GDate.GetJourDeDate(GDate.PremierLundi))%7;T.push('<td class="AlignementMilieu" '+(!this.estJourSemaineOuvre(lJour)?'style="'+GStyle.composeCouleurTexte(GCouleur.grisClair)+'"':'')+'>',GTraductions.getValeur('JoursCourt')[lJour],'</td>');}
T.push('</tr>');for(I=0;I<this.nbrLignes;I++){T.push('<tr>');for(J=0;J<this.nbrColonnes;J++)
T.push(this.composeJour(I,J));T.push('</tr>');}
T.push('</table>');GHtml.setHtml(this.idJours,T.join(''),true);}
ObjetFenetre_Date.prototype.composeJour=function(I,J){var lHtml=[];var lDate=GDate.GetJourSuivant(this.premierLundiDuMois,I*7+J);var lEstJourActif=this.estJourActif(I,J);var lCouleurFond=this.getCouleurFond(I,J);var lCouleurTexte=this.getCouleurTexte(I,J);var lCouleurBordure=this.getCouleurBordure(I,J);var lLargeurBordure=this.getLargeurBordure(I,J);var lId=this.Nom+'_'+I+'_'+J,lIdTD=this.Nom+'_td_'+I+'_'+J;var lClass=lEstJourActif?'AvecMain':'SansMain';lClass+=lEstJourActif&&this.estJourDuMois(I,J)?' Gras':' Italique';var lBordure=(I===0?EGenreBordure.haut:0)+(I===this.nbrLignes-1?EGenreBordure.bas:0)+(J===0?EGenreBordure.gauche:0)+(J===this.nbrColonnes-1?EGenreBordure.droite:0);var lStyle=' style="'+GStyle.composeCouleurFond(lCouleurFond)+(lBordure>0?GStyle.composeCouleurBordure(GCouleur.fenetre.bordure,1,lBordure):'')+'"';var lTabIndex=GDate.estJourEgal(lDate,this._getPremiereDateSaisissable())||(I===0&&J===0&&GDate.GetDifferenceJours(lDate,this._getPremiereDateSaisissable())>0)?' tabindex="0"':' tabindex="-1"';var lLabelWAI=' '+GObjetWAI.composeAttribut({genre:EGenreAttribut.label,valeur:GDate.FormatDate(lDate,'%JJJJ %J %MMM %AAAA')});lHtml.push('<td id=',lIdTD,'" class="'+lClass+'"',lStyle,'>');lHtml.push('<div id="'+lId+'"'+lTabIndex+lLabelWAI+' style="margin: '+(this.margeCellule-lLargeurBordure)+'px; line-height:'+this.tailleCellule+'px;',GStyle.composeHeight(this.tailleCellule),GStyle.composeWidth(this.tailleCellule),GStyle.composeCouleur(lCouleurFond,lCouleurTexte,lCouleurBordure,lLargeurBordure)+'" class="AlignementMilieu ">'+GDate.FormatDate(lDate,'%J')+'</div>');lHtml.push('</td>');return lHtml.join('');};function changerDeMois(aSens){this.parametres.indiceMoisCourant+=aSens;this.GetInstance(this.identSelecMois).setSelectionParIndice(this.parametres.indiceMoisCourant);}
ObjetFenetre_Date.prototype._moisCourantValide=function(){return this.existeJour()&&(GDate.GetDernierJourDuMois(this.annee,this.mois)>=this._getPremiereDateSaisissable());};ObjetFenetre_Date.prototype.surSurvol=function(I,J,aSurvol){var lCouleurFond=aSurvol?GCouleur.selection.fond:this.getCouleurFond(I,J);var lCouleurTexte=aSurvol?GCouleur.selection.texte:this.getCouleurTexte(I,J);var lId=this.Nom+'_'+I+'_'+J;GStyle.setCouleurFond(lId,lCouleurFond);GStyle.setCouleurTexte(lId,lCouleurTexte);if(this.ICourant&&this.JCourant&&this.JCourant!== -1&&(this.ICourant!==I||this.JCourant!==J)){this.surSurvol(this.ICourant,this.JCourant,false);}
if(aSurvol){this.ICourant=I;this.JCourant=J;GHtml.setFocus(lId);}};ObjetFenetre_Date.prototype.surSelection=function(I,J){this.date=GDate.GetJourSuivant(this.premierLundiDuMois,I*7+J);this.SurValidation(1);};function _surKeyUp(I,J){var lId ;if(GNavigateur.IsToucheSelection()||GNavigateur.IsToucheEspace())
this.surSelection(I,J);else if(GNavigateur.IsToucheEchap())
this.Fermer();else if(GNavigateur.IsToucheFlecheHaut()&&I>0&&this.estJourValide(I-1,J)){lId=this.Nom+'_'+(I-1)+'_'+J;this.surSurvol(I,J,false);this.surSurvol(I-1,J,true);}
else if(GNavigateur.IsToucheFlecheBas()&&I+1<this.nbrLignes&&this.estJourValide(I+1,J)){lId=this.Nom+'_'+(I+1)+'_'+J;this.surSurvol(I,J,false);this.surSurvol(I+1,J,true);}
else if(GNavigateur.IsToucheFlecheGauche()&&J>0&&this.estJourValide(I,J-1)){lId=this.Nom+'_'+I+'_'+(J-1);this.surSurvol(I,J,false);this.surSurvol(I,J-1,true);}
else if(GNavigateur.IsToucheFlecheDroite()&&J+1<this.nbrColonnes&&this.estJourValide(I,J+1)){lId=this.Nom+'_'+I+'_'+(J+1);this.surSurvol(I,J,false);this.surSurvol(I,J+1,true);}}
ObjetFenetre_Date.prototype.SurValidation=function(aGenreBouton){if((aGenreBouton=== -1)||(aGenreBouton===0)||((GDate.GetDifferenceJours(this.date,this.premiereDate)>=0)&&(GDate.GetDifferenceJours(this.date,this.derniereDate)<=0))){this.Fermer();this.callback.appel(aGenreBouton,aGenreBouton===0?null:this.date);}};ObjetFenetre_Date.prototype.existeJour=function(){for(var I=0;I<this.nbrLignes;I++)
for(var J=0;J<this.nbrColonnes;J++)
if(this.estJourDuMois(I,J))
return true;return false;};ObjetFenetre_Date.prototype.estJourDuMois=function(I,J){var lDate=GDate.GetJourSuivant(this.premierLundiDuMois,I*7+J);var lMois=lDate.getMonth();return lMois===this.mois&&(GDate.GetDifferenceJours(lDate,this.premiereDate)>=0)&&(GDate.GetDifferenceJours(lDate,this.derniereDate)<=0);};ObjetFenetre_Date.prototype.estJourActif=function(I,J){return this.estJourValide(I,J)&&
this.actifSemaine.GetValeur(I+this.premiereSemaineDuMois);};ObjetFenetre_Date.prototype.estJourValide=function(I,J){var lDate=GDate.GetJourSuivant(this.premierLundiDuMois,I*7+J);return this.estJourOuvre(I,J)&&(GDate.GetDifferenceJours(lDate,this.premiereDate)>=0)&&(GDate.GetDifferenceJours(lDate,this.derniereDate)<=0)&&(GDate.GetJourSuivant(this.premierLundiDuMois,I*7+J)>=this._getPremiereDateSaisissable());};ObjetFenetre_Date.prototype.estJourSemaineOuvre=function(J){return this.actifJour.GetValeur(J+1);};ObjetFenetre_Date.prototype.estJourOuvre=function(I,J){var lDate=GDate.GetJourSuivant(this.premierLundiDuMois,I*7+J);var lJour=(J+GDate.GetJourDeDate(GDate.PremierLundi))%7;return this.estJourSemaineOuvre(lJour)&&
!this.joursFeries.GetValeur(GDate.nombreJoursSurPeriode(IE.Cycles.dateDebutPremierCycle(),lDate)+1);};ObjetFenetre_Date.prototype.estJourMarque=function(aDate){return this.joursMarques?this.joursMarques.GetValeur(GDate.nombreJoursSurPeriode(IE.Cycles.dateDebutPremierCycle(),aDate)+1):false;};ObjetFenetre_Date.prototype.getCouleurFond=function(I,J){var lDate=GDate.GetJourSuivant(this.premierLundiDuMois,I*7+J);return lDate<this.dateCourante?GCouleur.fenetre.fond:GCouleur.blanc;};ObjetFenetre_Date.prototype.getCouleurTexte=function(I,J){return this.estJourActif(I,J)&&this.estJourDuMois(I,J)?GCouleur.noir:this.estJourValide(I,J)?GCouleur.grisTresFonce:GCouleur.grisClair;};ObjetFenetre_Date.prototype.getCouleurBordure=function(I,J){var lDate=GDate.GetJourSuivant(this.premierLundiDuMois,I*7+J);return!(GDate.estJourEgal(lDate,this.date)&&this.avecDate)?!GDate.estJourCourant(lDate)||!this.afficherDateCourante?this.estJourMarque(lDate)?GCouleur.fenetre.bordure:this.afficherPremiereDateSaisissable&&GDate.estJourEgal(lDate,this._getPremiereDateSaisissable())?GCouleur.fenetre.bordure:this.getCouleurFond(I,J):GCouleur.rouge:GCouleur.selection.fond;};ObjetFenetre_Date.prototype.getLargeurBordure=function(I,J){var lDate=GDate.GetJourSuivant(this.premierLundiDuMois,I*7+J);return(GDate.estJourCourant(lDate)&&this.afficherDateCourante)||(GDate.estJourEgal(lDate,this.date)&&this.avecDate)||(this.afficherPremiereDateSaisissable&&GDate.estJourEgal(lDate,this._getPremiereDateSaisissable()))?2:this.estJourMarque(lDate)?1:0;};ObjetFenetre_Date.prototype._getPremiereDateSaisissable=function(){return this.premiereDateSaisissable?this.premiereDateSaisissable:this.premiereDate;};ObjetFenetre_Date.prototype._getDateBornee=function(aDate){if(aDate<this.premiereDate)
return this.premiereDate;if(aDate>this.derniereDate)
return this.derniereDate;else return aDate;};}());;
MethodesObjet.heritagePrototype(ObjetCelluleDate,Identite);function ObjetCelluleDate(ANom,AIdent,APere,AEvenement){this.inheritedCreate(ANom,AIdent,APere,AEvenement);this.SetParametres();this._parametres_Fenetre={};this.setParametres_Fenetre(GParametres.PremierLundi,GParametres.PremiereDate,GParametres.DerniereDate);this._options={labelWAIEdit:''};}
ObjetCelluleDate.prototype.DetruireInstances=function(){this._fermerFenetreDate();};ObjetCelluleDate.prototype.getControleur=function(){return{btn:{event:function(aPrecedent){this.instance.actualiserDonnees(aPrecedent?-1:+1);},getDisabled:function(aPrecedent){if(!this.instance.Actif) return true;if(aPrecedent)
return this.instance.date<this.instance._parametres_Fenetre.premiereDate||GDate.estJourEgal(this.instance.date,this.instance._parametres_Fenetre.premiereDate);else return this.instance.date>this.instance._parametres_Fenetre.derniereDate||GDate.estJourEgal(this.instance.date,this.instance._parametres_Fenetre.derniereDate);},getTitle:function(aPrecedent){return this.controleur.btn.getDisabled.call(this,aPrecedent)?'':aPrecedent?GTraductions.getValeur('Precedent'):GTraductions.getValeur('Suivant');}}};};ObjetCelluleDate.prototype.SetParametres=function(aAvecStyleSite,aLargeurBouton,aHauteurBouton,aClassTexte,aAvecBoutons,aAvecFleche,aFormatDate){this.largeurBouton=aLargeurBouton?aLargeurBouton:80;this.hauteurBouton=aHauteurBouton?aHauteurBouton:17;this.classTexte=aClassTexte?aClassTexte:'Gras';this.avecBoutonsPrecedentSuivant=aAvecBoutons;this.genreBoutonCellule=(aAvecFleche===null||aAvecFleche===undefined)||aAvecFleche?EGenreBoutonCellule.Fleche:EGenreBoutonCellule.Aucun;this.formatDate=aFormatDate?aFormatDate:'%JJ/%MM/%AAAA';};ObjetCelluleDate.prototype.setOptions_ObjetCelluleDate=function(aOptions){$.extend(this._options,aOptions);};ObjetCelluleDate.prototype.setParametres_Fenetre=function(aPremierLundi,aPremiereDate,aDerniereDate,aActifJour,aActifSemaine,aJoursFeries,aAvecAucuneDate,aJoursMarques){this._parametres_Fenetre.premierLundi=aPremierLundi;this._parametres_Fenetre.premiereDate=aPremiereDate;this._parametres_Fenetre.derniereDate=aDerniereDate;this._parametres_Fenetre.actifJour=aActifJour?aActifJour:new TypeDomaine(true,7);this._parametres_Fenetre.actifSemaine=aActifSemaine?aActifSemaine:new TypeDomaine(true,52);this._parametres_Fenetre.joursFeries=aJoursFeries?aJoursFeries:new TypeDomaine(false,365);this._parametres_Fenetre.avecAucuneDate=aAvecAucuneDate;this._parametres_Fenetre.joursMarques=aJoursMarques;};ObjetCelluleDate.prototype.setActifSemaine=function(aActifSemaine){this._parametres_Fenetre.actifSemaine=aActifSemaine;};ObjetCelluleDate.prototype.setPremiereDateSaisissable=function(aPremiereDateSaisissable,aAfficher){this._parametres_Fenetre.premiereDateSaisissable=aPremiereDateSaisissable;this._parametres_Fenetre.afficherPremiereDateSaisissable=aAfficher;};ObjetCelluleDate.prototype.Initialiser=function(){this.cellule=new ObjetCelluleBouton(this.Nom+'.cellule',null,this,this.surCellule);this.SetPremierElement(this.cellule.NomEdit);this.cellule.setOptions_ObjetCelluleBouton(this._options) ;this.cellule.setParametres(false,this.genreBoutonCellule,null,this.largeurBouton,this.hauteurBouton,null,null,this.classTexte);this.cellule.setParametresSaisie(false,false);this.Afficher();this.cellule.Initialiser();this.cellule.SetActif(this.Actif);};ObjetCelluleDate.prototype.SetDonnees=function(aDate){this.date=aDate;this._actualiserDate();};ObjetCelluleDate.prototype.ConstruireAffichage=function(){var H=[];if(this.avecBoutonsPrecedentSuivant)
H.push('<div>','<table tabindex="-1" border="0" cellspacing="0" cellpadding="0"><tr>','<td><ie-btnimage ie-model="btn(true)" class="Image_PassageAuPrecedentPourBandeau"></ie-btnimage></td>','<td id="'+this.cellule.GetNom()+'"></td>','<td><ie-btnimage ie-model="btn(false)" class="Image_PassageAuSuivantPourBandeau"></ie-btnimage></td>','</tr></table></div>');else H.push('<div id="',this.cellule.GetNom(),'"></div>');return H.join('');};ObjetCelluleDate.prototype._actualiserDate=function(){this.cellule.setLibelle(this._getChaineDate());};ObjetCelluleDate.prototype._getChaineDate=function(){return this.date?GDate.FormatDate(this.date,this.formatDate):'&nbsp;';};ObjetCelluleDate.prototype.actualiserDonnees=function(aDecalage){var lCount=0;var lDate=aDecalage?GDate.GetJourSuivant(this.date,aDecalage):this.date;if(this._parametres_Fenetre.actifJour&&aDecalage)
while(!this._parametres_Fenetre.actifJour.GetValeur(GDate.GetJourDeSemaine(lDate)+1)&&lCount<7){lDate=GDate.GetJourSuivant(lDate,aDecalage);lCount++;}
if(lCount===7)
lDate=this.date;if(aDecalage&&GDate.dateEstDansLaPeriode(lDate,this._parametres_Fenetre.premiereDate,this._parametres_Fenetre.derniereDate)&&this._parametres_Fenetre.actifSemaine.GetValeur(GDate.GetSemaine(lDate))){this.surFenetreDate(null,lDate);}};ObjetCelluleDate.prototype.surCellule=function(aGenreEvent){if(!this.Actif) return;switch(aGenreEvent){case EEvent.SurClick:{this._ouvrirFenetreDate();break;}
case EEvent.SurKeyUp:{if(GNavigateur.IsToucheRetourChariot()||GNavigateur.IsToucheFlecheBas())
this._ouvrirFenetreDate();}}};ObjetCelluleDate.prototype._ouvrirFenetreDate=function(){if(this.fenetreDate)
this._fermerFenetreDate();this.fenetreDate=ObjetFenetre.creerInstance(window.ObjetFenetre_Date,{pere:this,evenement:this.surFenetreDate,initialiser:false});var lSelf=this;this.fenetreDate.ajouterCallbackSurDestruction(function(){lSelf.fenetreDate=null;});this.fenetreDate.setParametres(this._parametres_Fenetre.premierLundi,this._parametres_Fenetre.premiereDate,this._parametres_Fenetre.derniereDate,this._parametres_Fenetre.actifJour,this._parametres_Fenetre.actifSemaine,this._parametres_Fenetre.joursFeries,this._parametres_Fenetre.avecAucuneDate);if(this._parametres_Fenetre.joursMarques)
this.fenetreDate.setJoursMarques(this._parametres_Fenetre.joursMarques);this.fenetreDate.setPremiereDateSaisissable(this._parametres_Fenetre.premiereDateSaisissable,this._parametres_Fenetre.afficherPremiereDateSaisissable);this.fenetreDate.Initialiser();this.fenetreDate.SetDonnees(this.date);this.fenetreDate.positionnerSousId(this.Nom);};ObjetCelluleDate.prototype._fermerFenetreDate=function(){if(this.fenetreDate)
this.fenetreDate.Fermer();};ObjetCelluleDate.prototype.surFenetreDate=function(aGenreBouton,aDate){this.date=aDate;this._actualiserDate();this._fermerFenetreDate();if(this.ControleNavigation&&this.Pere&&this.Pere.EvenementSurNavigation)
this.Pere.EvenementSurNavigation(this);else this.RetourSurNavigation();};ObjetCelluleDate.prototype.RetourSurNavigation=function(){this.callback.appel(this.date);};ObjetCelluleDate.prototype.getDate=function(){return this.date;};ObjetCelluleDate.prototype.SetActif=function(AActif){this.inherited('SetActif',AActif);if(this.cellule)
this.cellule.SetActif(AActif);this.$refreshSelf();};;
(function($){$.fn.jIEScrollTextarea=function(aOptions){var hCheck=!(GNavigateur.IsIE||GNavigateur.IsOpera);if(!aOptions) aOptions={};if(aOptions.showArrows!==false) aOptions.showArrows=true;function ResizeTextarea(e){e=e.target||e;var vlen=e.value.length,ewidth=$(e).innerWidth();if(vlen!==e.valLength||ewidth!==e.boxWidth){if(hCheck&&(vlen<e.valLength||ewidth!==e.boxWidth)) e.style.height="0px";var h=Math.max(e.expandMin,e.scrollHeight);e.style.overflow=(e.scrollHeight>h?"auto":"hidden");e.style.height=h+"px";e.style.margin=0;e.valLength=vlen;e.boxWidth=ewidth;if(h!==$(e).parents('.jspContainer:eq(0)').height()){$(e).parents('.jspContainer:eq(0)').parent().data('jsp').reinitialise();$(e).off('focus.jsp');}}
var lPosition=_calculator.getCaretPosition($(e));$(e).parent().parent().scrollTop(0);var lJspApi=$(e).parents('.jspContainer:eq(0)').parent().data('jsp');if(lPosition.top+lPosition.heightLigne>=$(e).parents('.jspContainer:eq(0)').innerHeight()+lJspApi.getContentPositionY()){lJspApi.scrollToY(lPosition.top+lPosition.heightLigne-$(e).parents('.jspContainer:eq(0)').innerHeight());} else if(lPosition.top<=lJspApi.getContentPositionY()){lJspApi.scrollToY(Math.floor(lPosition.top));}
return true;}
this.each(function(){if(this.nodeName.toLowerCase()!=="textarea") return;var lBackgroundColor=$(this).css('background-color');$(this).wrap('<div style="width:'+$(this).innerWidth()+'px;height:'+($(this).innerHeight())+'px;"></div>').parent().css('background-color',lBackgroundColor);$(this).parent().jScrollPane(aOptions);$(this).off('focus.jsp');var p=this.className.match(/expand(\d+)\-*(\d+)*/i);this.expandMin=$(this).innerHeight()-1||(p?parseInt('0'+p[1],10):0);this.calcLineHeight=this.rows?$(this).innerHeight()/this.rows:parseInt($(this).css('lineHeight'));this.jspOptions=aOptions;ResizeTextarea(this);if(!this.Initialized){this.Initialized=true;$(this).css("padding-top",0).css("padding-bottom",0);$(this).on("focus keydown input paste cut change",ResizeTextarea);$(this).parent().parent().on('scroll',function(){$(this).children(':first').children(':first').trigger('keyup');});}});return this;};var _calculator={primaryStyles:['fontFamily','fontSize','fontWeight','fontVariant','fontStyle','paddingLeft','paddingTop','paddingBottom','paddingRight','marginLeft','marginTop','marginBottom','marginRight','borderLeftColor','borderTopColor','borderBottomColor','borderRightColor','borderLeftStyle','borderTopStyle','borderBottomStyle','borderRightStyle','borderLeftWidth','borderTopWidth','borderBottomWidth','borderRightWidth','line-height','outline'],specificStyle:{'overflow-x':'hidden','overflow-y':'auto'},simulator:null,toHtml:function(text){return GChaine.ajouterEntites(text).replace(/\n/g,'<br>');},getCaretPosition:function(aElement){var cal=_calculator,self=aElement,element=self[0],elementOffset=self.offset();if(GNavigateur.IsIE&&document.selection){element.focus();var range=document.selection.createRange();$('#hskeywords').val(element.scrollTop);return{top:parseInt(range.boundingTop)-elementOffset.top+element.scrollTop+document.documentElement.scrollTop,heightLigne:parseInt(_getComputedStyle(self,"fontSize"))};}
if(!cal.simulator) cal.simulator=$('<div id="textarea_simulator" style="z-index:-1;"/>').css({position:'absolute',top:0,left:0,visibility:'hidden'}).appendTo(document.body);try{cal.simulator.empty();$.each(cal.primaryStyles,function(index,styleName){_cloneStyle(self,cal.simulator,styleName);});cal.simulator.css($.extend({'width':self.width(),'height':self.height()},cal.specificStyle));var value=self.val(),cursorPosition=getCaret(self[0]);var beforeText=value.substring(0,cursorPosition),afterText=value.substring(cursorPosition);var before=$('<span style="white-space:pre-wrap;"/>').html(cal.toHtml(beforeText)),focus=$('<span style="height:0px;">&nbsp;</span>'),after=$('<span style="white-space:pre-wrap"/>').html(cal.toHtml(afterText));cal.simulator.append(before).append(focus).append(after);var focusOffset=focus.offset(),simulatorOffset=cal.simulator.offset();return{top:focusOffset.top-simulatorOffset.top-element.scrollTop,heightLigne:parseInt(_getComputedStyle(self,"fontSize"))+6};} finally{cal.simulator.remove();cal.simulator=null;}}};function _cloneStyle(aElement,target,styleName){var styleVal=_getComputedStyle(aElement,styleName);if(!!styleVal){$(target).css(styleName,styleVal);}}
function _getComputedStyle(aJQuery,styleName){if(aJQuery.length===0) return;var thiz=aJQuery[0];var result=aJQuery.css(styleName);result=result||(GNavigateur.IsIE?thiz.currentStyle[styleName]:document.defaultView.getComputedStyle(thiz,null)[styleName]);return result;}
function getCaret(el){if(el.selectionStart){return el.selectionStart;} else if(document.selection){el.focus();var r=document.selection.createRange();if(r===null||r===undefined){return 0;}
var re=el.createTextRange(),rc=re.duplicate();re.moveToBookmark(r.getBookmark());rc.setEndPoint('EndToStart',re);return rc.text.length;}
return 0;}})(jQuery);;
var EGenreScroll={Vertical:0,Horizontal:1};var EGenreScrollEvenement={Deplacement:0,TailleZone:1,TailleContenu:2};MethodesObjet.heritagePrototype(ObjetScroll,Identite);function ObjetScroll(aNom,aIdent,aPere,aEvenement,aGenre,aEvenementDecalage){if(IE.MethodesObjet.isObject(aNom)){this.Genre=aNom.genre;this.EvenementDecalage=aNom.evenementDecalage;}
else{this.Genre=aGenre;this.EvenementDecalage=aEvenementDecalage;}
this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.Largeur=9+4;this.Position=0;this.nbLigneScroll=2;this.pas=0;this.jscrollAPI=null;this.callBackDecalage=new Callback(aPere,aEvenementDecalage);}(function(){ObjetScroll.prototype.GetLargeur=function(){return this.Largeur;};function surMouseWheelV(event,delta,deltaX,deltaY){if(isNaN(deltaY)) deltaY=delta;if(isNaN(deltaX)) deltaX=0;var lRatioDelta=deltaY> -1&&deltaY<1?10:1;if(event.data.aObjet.jscrollAPI){event.data.aObjet.jscrollAPI.scrollToY(event.data.aObjet.callback.appel(EGenreScrollEvenement.Deplacement,event.data.aObjet.jscrollAPI.getContentPositionY()+((deltaY>0?-1:1)*event.data.aObjet.nbLigneScroll*event.data.aObjet.pas*Math.floor(Math.abs(deltaY*lRatioDelta)))));return false;}
return true;}
function surTouchStartV(event){event.data.aObjet.scrollStartPosY=event.originalEvent.touches[0].pageY;}
function surTouchMoveV(event){event.originalEvent.preventDefault();if(event.data.aObjet.jscrollAPI){var lDecalage=(event.data.aObjet.scrollStartPosY-event.originalEvent.touches[0].pageY);if(Math.abs(lDecalage)>event.data.aObjet.nbLigneScroll*event.data.aObjet.pas){event.data.aObjet.jscrollAPI.scrollToY(event.data.aObjet.callback.appel(EGenreScrollEvenement.Deplacement,event.data.aObjet.jscrollAPI.getContentPositionY()+(event.data.aObjet.scrollStartPosY-event.originalEvent.touches[0].pageY)));event.data.aObjet.scrollStartPosY=event.originalEvent.touches[0].pageY;}
return false;}
return true;}
function surMouseWheelH(event,delta,deltaX,deltaY){if(isNaN(deltaY)) deltaY=delta;if(isNaN(deltaX)) deltaX=0;if(event.data.aObjet.jscrollAPI){event.data.aObjet.jscrollAPI.scrollToX(event.data.aObjet.callback.appel(EGenreScrollEvenement.Deplacement,event.data.aObjet.jscrollAPI.getContentPositionX()+((deltaX>0?1:-1)*event.data.aObjet.nbLigneScroll*event.data.aObjet.pas*Math.floor(Math.abs(deltaX)))));return false;}
return true;}
function surTouchStartH(event){event.data.aObjet.scrollStartPosX=event.originalEvent.touches[0].pageX;}
function surTouchMoveH(event){event.originalEvent.preventDefault();if(event.data.aObjet.jscrollAPI){var lDecalage=(event.data.aObjet.scrollStartPosX-event.originalEvent.touches[0].pageX);if(Math.abs(lDecalage)>event.data.aObjet.nbLigneScroll*event.data.aObjet.pas){event.data.aObjet.jscrollAPI.scrollToX(event.data.aObjet.callback.appel(EGenreScrollEvenement.Deplacement,event.data.aObjet.jscrollAPI.getContentPositionX()+(event.data.aObjet.scrollStartPosX-event.originalEvent.touches[0].pageX)));event.data.aObjet.scrollStartPosX=event.originalEvent.touches[0].pageX;}
return false;}
return true;}
ObjetScroll.prototype.SetDonnees=function(){var I,lElement;this.Position=0;this.Zones=[];for(I=0;I<arguments.length;I++)
if(GHtml.elementExiste(this.GetIdZone(arguments[I])))
this.Zones.push(arguments[I]);if(this.Zones.length===0){if(arguments.length>0)
return;else this.Zones.push(0);}
this.TailleZone=this.callback.appel(EGenreScrollEvenement.TailleZone);this.TailleContenu=this.callback.appel(EGenreScrollEvenement.TailleContenu);if(!this.TailleContenu)
this.TailleContenu=this.GetTaille(this.GetIdContenu(this.Zones[0]));if(!this.TailleZone||GNavigateur.isTactile&&(this.TailleContenu<this.TailleZone||this.TailleContenu>this.TailleZone))
this.TailleZone=this.TailleContenu;this.TailleZone=Math.min(this.TailleZone,this.TailleContenu);this.TailleZone=Math.max(this.TailleZone,0);this.TailleContenu=Math.max(this.TailleContenu,0);for(I=0;I<this.Zones.length;I++)
this.SetTaille(this.GetIdZone(this.Zones[I]),this.TailleZone);if(this.TailleContenu>this.TailleZone){if(this.pas===0) while(this.callback.appel(EGenreScrollEvenement.Deplacement,++this.pas)===0&&this.pas<this.TailleContenu) continue;if(this.pas<3) this.pas=this.callback.appel(EGenreScrollEvenement.Deplacement,this.pas);GHtml.setHtml(this.GetIdScroll(),this.Compose());lElement=$('#'+this.Nom.escapeJQ()).jScrollPane({showArrows:true,arrowButtonSpeed:this.pas}).bind(this.Genre===EGenreScroll.Vertical?'jsp-scroll-y':'jsp-scroll-x',{aObjet:this},function(event,scrollPosition){event.data.aObjet.EvenementSurScroll(scrollPosition);});$('#'+this.Nom.escapeJQ()).attr('tabIndex','-1');this.jscrollAPI=lElement.data('jsp');if(this.Genre===EGenreScroll.Vertical){for(I=0;I<this.Zones.length;I++){$('#'+this.GetIdZone(this.Zones[I]).escapeJQ()).bind('mousewheel',{aObjet:this},surMouseWheelV);if(GNavigateur.isTactile){$('#'+this.GetIdZone(this.Zones[I]).escapeJQ()).bind('touchstart',{aObjet:this},surTouchStartV);$('#'+this.GetIdZone(this.Zones[I]).escapeJQ()).bind('touchmove',{aObjet:this},surTouchMoveV);}}} else{for(I=0;I<this.Zones.length;I++){$('#'+this.GetIdZone(this.Zones[I]).escapeJQ()).bind('mousewheel',{aObjet:this},surMouseWheelH);if(GNavigateur.isTactile){$('#'+this.GetIdZone(this.Zones[I]).escapeJQ()).bind('touchstart',{aObjet:this},surTouchStartH);$('#'+this.GetIdZone(this.Zones[I]).escapeJQ()).bind('touchmove',{aObjet:this},surTouchMoveH);}}}} else if(this.jscrollAPI){if($('#'+this.Nom.escapeJQ()).length===1) this.jscrollAPI.destroy();$('#'+this.GetIdZone(this.Zones[I]).escapeJQ()).unbind('mousewheel');}
for(I=0;I<this.Zones.length;I++){lElement=GHtml.getElement(this.GetIdZone(this.Zones[I]));if(lElement&&lElement.style)
lElement.style.position='relative';}};ObjetScroll.prototype.Compose=function(){var LStyleScroll,LStyleContenu,lWaiDescr;if(this.Genre===EGenreScroll.Horizontal){LStyleScroll='width:'+this.TailleZone+'px; height:'+this.Largeur+'px;';LStyleContenu='width:'+this.TailleContenu+'px; height:'+this.Largeur+'px;';lWaiDescr='';}
else{LStyleScroll='height:'+this.TailleZone+'px; width:'+this.Largeur+'px;';LStyleContenu='height:'+this.TailleContenu+'px; width:'+this.Largeur+'px;';lWaiDescr='';}
var H=[];H.push('<div ',GObjetWAI.composeRole(EGenreRole.Scrollbar),' ',GObjetWAI.composeAttribut({genre:EGenreAttribut.label,valeur:lWaiDescr}),' ','tabindex="-1" id="'+this.Nom+'" style="'+LStyleScroll+'">');H.push('<div style="'+LStyleContenu+'"></div>');H.push('</div>');return H.join('');};ObjetScroll.prototype.Vider=function(){GHtml.setDisplay(this.GetIdScroll(),false);};ObjetScroll.prototype.EvenementSurScroll=function(APosition){if(IE.MethodesObjet.isNumber(APosition))
APosition=Math.round(APosition);var LPosition=this.callback.appel(EGenreScrollEvenement.Deplacement,APosition===null||APosition===undefined?this.GetPosition():APosition);for(var I=0;I<this.Zones.length;I++)
if(LPosition!==this.GetPosition(this.GetIdZone(this.Zones[I])))
this.SetPosition(this.GetIdZone(this.Zones[I]),LPosition);this.callBackDecalage.appel(this.Position-LPosition);if(this.Position!==LPosition)
this.SetPosition(this.Nom,LPosition);};ObjetScroll.prototype.Actualiser=function(I){this.SetPosition(this.Nom,this.GetPosition(this.GetIdZone(I)));};ObjetScroll.prototype.GetPosition=function(ANom){if((ANom===null||ANom===undefined)&&this.jscrollAPI) return this.Genre===EGenreScroll.Horizontal?this.jscrollAPI.getContentPositionX():this.jscrollAPI.getContentPositionY();ANom=(ANom===null||ANom===undefined)?this.Nom:ANom;var lElement=GHtml.getElement(ANom);return this.Genre===EGenreScroll.Horizontal?lElement?lElement.scrollLeft:0:lElement?lElement.scrollTop:0;};ObjetScroll.prototype.SetPosition=function(ANom,APosition){if(!$.isNumeric(APosition))
return false;this.Position=APosition;if(ANom===this.Nom&&this.jscrollAPI){if(this.Genre===EGenreScroll.Horizontal)
this.jscrollAPI.scrollToX(APosition);else this.jscrollAPI.scrollToY(APosition);}
else{var lElement=GHtml.getElement(ANom);if(!lElement) return;if(this.Genre===EGenreScroll.Horizontal)
lElement.scrollLeft=APosition;else lElement.scrollTop=APosition;}};ObjetScroll.prototype.GetTaille=function(ANom){return this.Genre===EGenreScroll.Horizontal?GPosition.getWidth(ANom):GPosition.getHeight(ANom);};ObjetScroll.prototype.SetTaille=function(ANom,ATaille){return this.Genre===EGenreScroll.Horizontal?GPosition.setWidth(ANom,ATaille):GPosition.setHeight(ANom,ATaille);};ObjetScroll.prototype.GetIdScroll=function(){return this.Nom+'_Scroll';};ObjetScroll.prototype.GetIdZone=function(I){return this.Pere.Nom+'_Zone_'+(I===null||I===undefined?0:I);};ObjetScroll.prototype.GetIdContenu=function(I){return this.Pere.Nom+'_Contenu_'+(I===null||I===undefined?0:I);};ObjetScroll.prototype.scrollTo=function(aScroll){if(this.Genre===EGenreScroll.Vertical){GPosition.setScrollTop(this.GetIdZone(),aScroll);}
else{var lElement=GHtml.getElement(this.GetIdZone());if(lElement){lElement.scrollLeft=aScroll;}}
var lData=$('#'+this.Nom.escapeJQ()).data('jsp');if(lData){if(this.Genre===EGenreScroll.Vertical){lData.scrollToY(aScroll);}
else{lData.scrollToX(aScroll);}}};}());;

function ObjetDonneesListe(ADonnees){if(!ADonnees)
return;this.traductionsListe={};this.Donnees=ADonnees===null||ADonnees===undefined?[]:ADonnees;this.Compteur= -1;this._enCreation=false;this.ECouleurCellule=ObjetDonneesListe.ECouleurCellule;this.ETypeCellule=ObjetDonneesListe.ETypeCellule;this.EGenreCoche=ObjetDonneesListe.EGenreCoche;this.SurCreerObjet();}(function(){ObjetDonneesListe.ECouleurCellule={Blanc:0,Gris:1,Deploiement:2};ObjetDonneesListe.ETypeCellule={Texte:0,ZoneTexte:1,Html:2,Date:3,Note:4,Coche:5,CocheTriple:6,CocheDeploiement:7,Image:8,DateCalendrier:9};ObjetDonneesListe.EGenreCoche={Verte:true,Grise:null,Aucune:false};ObjetDonneesListe.prototype.getControleurDonneesListe=function(){return null;};ObjetDonneesListe.prototype.SurCreerObjet=function(){};ObjetDonneesListe.prototype.AvecSelection=function(I,D){return true;};ObjetDonneesListe.prototype.avecDeselection=function(aLigne,aColonne,aElement){return this.AvecMultiSelection();};ObjetDonneesListe.prototype.AvecEdition=function(I,D){return true;};ObjetDonneesListe.prototype.AvecSuppression=function(D){return true;};ObjetDonneesListe.prototype.AvecEtatSaisie=function(D){return true;};ObjetDonneesListe.prototype.AvecTri=function(){return true;};ObjetDonneesListe.prototype.AvecMenuContextuel=function(aColonne,D,aLigne){return D&&aLigne>=0?this.AvecSelection(aColonne,D):false;};ObjetDonneesListe.prototype.avecContenuTronque=function(I,D){return false;};ObjetDonneesListe.prototype.AvecDeploiement=function(){return false;};ObjetDonneesListe.prototype.AvecDeploiementSurColonne=function(I,D){return true;};ObjetDonneesListe.prototype.surDeploiement=function(I,J,D){D.estDeploye=!D.estDeploye;};ObjetDonneesListe.prototype.AvecEvenement_Selection=function(I,D){return false;};ObjetDonneesListe.prototype.AvecEvenement_SelectionClick=function(I,D){return false;};ObjetDonneesListe.prototype.AvecEvenement_Creation=function(I){return false;};ObjetDonneesListe.prototype.AvecEvenement_Edition=function(I,D){return false;};ObjetDonneesListe.prototype.AvecEvenement_Suppression=function(D){return false;};ObjetDonneesListe.prototype.AvecEvenement_Deploiement=function(I,D){return false;};ObjetDonneesListe.prototype.AvecEvenement_ApresCreation=function(){return false;};ObjetDonneesListe.prototype.AvecEvenement_ApresErreurCreation=function(){return false;};ObjetDonneesListe.prototype.AvecEvenement_ApresEdition=function(aLigne,aColonne,aDonnee){return false;};ObjetDonneesListe.prototype.AvecEvenement_ApresSuppression=function(){return false;};ObjetDonneesListe.prototype.SurSelectionLigne=function(J,D,aSelectionner){};ObjetDonneesListe.prototype.SurSelection=function(I,D,aLigne,aSelectionner){};ObjetDonneesListe.prototype.SurCreation=function(D,V,J){};ObjetDonneesListe.prototype.SurApresCreation=function(I,D){};ObjetDonneesListe.prototype.SurEdition=function(I,D,V){};ObjetDonneesListe.prototype.SurSuppression=function(D){};ObjetDonneesListe.prototype.AvecDragLigne=function(D){return false;};ObjetDonneesListe.prototype.AvecInputFile=function(I,D){return false;};ObjetDonneesListe.prototype.getDragInfoLigne=function(D){return D.GetNumero();};ObjetDonneesListe.prototype.getDraggableHelper=function(D){return function(event){return $('<div class="drag-row"><table class="Texte10" cellpadding="0" cellspacing="0"></table></div>').find('table').append($(event.target).closest('tr').clone()).end();};};ObjetDonneesListe.prototype.getDraggableZIndex=function(){return 1000000;};ObjetDonneesListe.prototype.getDraggableDelay=function(){return 300;};ObjetDonneesListe.prototype.getDraggableDistance=function(){return 1;};ObjetDonneesListe.prototype.getDraggableScroll=function(){return false;};ObjetDonneesListe.prototype.getDraggableCursor=function(){return'move';};ObjetDonneesListe.prototype.getDraggableCursorAt=function(){return{top:5,left:5};};ObjetDonneesListe.prototype.getDraggableCallbackStart=function(){return null;};ObjetDonneesListe.prototype.getDraggableCallbackStop=function(){return null;};ObjetDonneesListe.prototype.GetEtatSurEdition=function(I,D){return EGenreEtat.Modification;};ObjetDonneesListe.prototype.Edition_Confirmation=function(I,D){return false;};ObjetDonneesListe.prototype.Suppression_Impossible=function(D){return false;};ObjetDonneesListe.prototype.Suppression_Confirmation=function(D){return true;};ObjetDonneesListe.prototype.getTri=function(aColonneDeTri,aGenreTri){};ObjetDonneesListe.prototype.GetVisible=function(D){return true;};ObjetDonneesListe.prototype.GetNbrValeurs=function(I){return 1;};ObjetDonneesListe.prototype.GetValeur=function(I,D,K,aSurEdition,aSurProportion,aLigne){return'';};ObjetDonneesListe.prototype.GetValeurPourAffichage=function(I,D,K,aSurEdition){return this.GetValeur(I,D,K,aSurEdition);};ObjetDonneesListe.prototype.getHintHtmlForce=function(aColonne,aLigne,aElement){return'';};ObjetDonneesListe.prototype.getHintForce=function(I,D){return'';};ObjetDonneesListe.prototype.getHintConteneur=function(I,J,D){return'';};ObjetDonneesListe.prototype.GetValeurParDefaut=function(I){return'';};ObjetDonneesListe.prototype.GetTypeValeur=function(I,D){return this.ETypeCellule.Texte;};ObjetDonneesListe.prototype.GetTailleTexteMax=function(I,D){return 0;};ObjetDonneesListe.prototype.autoriserChaineVideSurEdition=function(I,D){return false;};ObjetDonneesListe.prototype.GetCouleurCellule=function(I,D){};ObjetDonneesListe.prototype.getCouleurCelluleSelection=function(aColonne,aLigne,aElement){return GCouleur.selection;};ObjetDonneesListe.prototype.getClass=function(I,D){return'';};ObjetDonneesListe.prototype.getClassCelluleConteneur=function(aColonne,aLigne,aDonnee){return'AlignementMilieuVertical';};ObjetDonneesListe.prototype.getStyle=function(I,D){return'';};ObjetDonneesListe.prototype.getPadding=function(I,D){return false;};ObjetDonneesListe.prototype.getNiveauDeploiement=function(I,D){return 1;};ObjetDonneesListe.prototype.GetLibelleSupression=function(D){return null;};ObjetDonneesListe.prototype.estCelluleDeFusionEnLigne=function(I,D){return false;};ObjetDonneesListe.prototype.estCelluleDeFusionEnColonne=function(aLigne,aColonne,aDonnee){return false;};ObjetDonneesListe.prototype.initialiserObjetGraphique=function(I,D,aInstance){return null;};ObjetDonneesListe.prototype.setDonneesObjetGraphique=function(I,D,aInstance){return null;};ObjetDonneesListe.prototype.AvecMultiSelection=function(){return false;};ObjetDonneesListe.prototype.avecMultiSelectionSurCtrl=function(){return true;};ObjetDonneesListe.prototype.getStyleTotal=function(aColonne){return'';};ObjetDonneesListe.prototype.getClassTotal=function(aColonne){return'';};ObjetDonneesListe.prototype.getContenuTotal=function(aColonne){return'';};ObjetDonneesListe.prototype.apresConstruction=function(aListe){};ObjetDonneesListe.prototype.GetMessage_Doublon=function(){return this.traductionsListe.doublon;};ObjetDonneesListe.prototype.GetMessage_Creation_Impossible=function(I){return this.traductionsListe.creationImpossible;};ObjetDonneesListe.prototype.GetMessage_Edition_Impossible=function(I,D){return this.traductionsListe.editionImpossible;};ObjetDonneesListe.prototype.GetMessage_Edition_Confirmation=function(I,D){return'';};ObjetDonneesListe.prototype.GetMessage_Suppression_Impossible=function(D){return this.traductionsListe.suppressionImpossible;};ObjetDonneesListe.prototype.GetMessage_Suppression_Confirmation=function(D){return this.traductionsListe.suppressionSelection;};ObjetDonneesListe.prototype.GetMessage_TailleMaximaleSaisie=function(I,D){return this.traductionsListe.tailleMaxSaisie;};ObjetDonneesListe.prototype.initialisationObjetContextuel=function(aColonne,D,aInstance,aAvecCreation,aNonEditable,aLigne){if(!aInstance) return;if(aAvecCreation)
aInstance.AddCommande(EGenreCommandeMenu.Creation,this.traductionsListe.creer,!aNonEditable);aInstance.AddCommande(EGenreCommandeMenu.Edition,this.traductionsListe.modifier,this.AvecEdition(aColonne,D)&&!aNonEditable);aInstance.AddCommande(EGenreCommandeMenu.Suppression,this.traductionsListe.supprimer,this.AvecSuppression(D)&&!aNonEditable);aInstance.SetDonnees();};ObjetDonneesListe.prototype.evenementMenuContextuel=function(aColonne,aLigne,aElement,aLigneMenuContextuel,aElementMenuContextuel,aParametres){return false;};ObjetDonneesListe.prototype.EnModification=function(I){return true;};ObjetDonneesListe.prototype.getMaskInputEdition=function(I,D){return null;};ObjetDonneesListe.prototype.getControleCaracteresInput=function(I,D){return null;};ObjetDonneesListe.prototype._AvecDeploiement=function(I){return this.AvecDeploiement(I);};ObjetDonneesListe.prototype._AvecDeploiementSurColonne=function(I,J){return this.AvecDeploiementSurColonne(I,this.Donnees.GetElement(J));};ObjetDonneesListe.prototype._AvecSelection=function(I,J){return this.AvecSelection(I,this.Donnees.GetElement(J));};ObjetDonneesListe.prototype._avecDeselection=function(aLigne,aColonne){return this.avecDeselection(aLigne,aColonne,this.Donnees.GetElement(aLigne));};ObjetDonneesListe.prototype._AvecEdition=function(I,J){return this.AvecEdition(I,this.Donnees.GetElement(J));};ObjetDonneesListe.prototype._AvecSuppression=function(J){return this.AvecSuppression(this.Donnees.GetElement(J));};ObjetDonneesListe.prototype._AvecEtatSaisie=function(J){return this.AvecEtatSaisie(this.Donnees.GetElement(J));};ObjetDonneesListe.prototype._AvecMenuContextuel=function(aColonne,aLigne){return this.AvecMenuContextuel(aColonne,aLigne>=0?this.Donnees.GetElement(aLigne):null,aLigne);};ObjetDonneesListe.prototype._avecContenuTronque=function(I,J){return this.avecContenuTronque(I,this.Donnees.GetElement(J));};ObjetDonneesListe.prototype._AvecEvenement_Selection=function(I,J){return this.AvecEvenement_Selection(I,this.Donnees.GetElement(J));};ObjetDonneesListe.prototype._AvecEvenement_SelectionClick=function(I,J){return this.AvecEvenement_SelectionClick(I,this.Donnees.GetElement(J));};ObjetDonneesListe.prototype._AvecEvenement_Creation=function(I){return this.AvecEvenement_Creation(I);};ObjetDonneesListe.prototype._AvecEvenement_Edition=function(I,J){return this.AvecEvenement_Edition(I,this.Donnees.GetElement(J));};ObjetDonneesListe.prototype._AvecEvenement_Suppression=function(J){return this.AvecEvenement_Suppression(this.Donnees.GetElement(J));};ObjetDonneesListe.prototype._AvecEvenement_Deploiement=function(I,J){return this.AvecEvenement_Deploiement(I,this.Donnees.GetElement(J));};ObjetDonneesListe.prototype._AvecEvenement_ApresCreation=function(){return this.AvecEvenement_ApresCreation();};ObjetDonneesListe.prototype._AvecEvenement_ApresErreurCreation=function(){return this.AvecEvenement_ApresErreurCreation();};ObjetDonneesListe.prototype._AvecEvenement_ApresEdition=function(aLigne,aColonne){return this.AvecEvenement_ApresEdition(aLigne,aColonne,this.Donnees.GetElement(aLigne));};ObjetDonneesListe.prototype._AvecEvenement_ApresSuppression=function(){return this.AvecEvenement_ApresSuppression();};ObjetDonneesListe.prototype._AvecDrag=function(){var lReturn=false;for(var J=0,lNb=this.GetNbrLignes();J<lNb;J++){if(this.AvecDragLigne(this.Donnees.GetElement(J))){lReturn=true;break;}}
return lReturn;};ObjetDonneesListe.prototype._AvecDragLigne=function(J){return this.AvecDragLigne(this.Donnees.GetElement(J));};ObjetDonneesListe.prototype._AvecInputFile=function(I,J){return this.AvecInputFile(I,this.Donnees.GetElement(J));};ObjetDonneesListe.prototype._getDragInfoLigne=function(J){return this.getDragInfoLigne(this.Donnees.GetElement(J));};ObjetDonneesListe.prototype._getDraggableHelper=function(J){return this.getDraggableHelper(this.Donnees.GetElement(J));};ObjetDonneesListe.prototype._SurSelectionLigne=function(J,aSelectionner){return this.SurSelectionLigne(J,this.Donnees.GetElement(J),aSelectionner);};ObjetDonneesListe.prototype._SurSelection=function(I,J,aSelectionner){return this.SurSelection(I,this.Donnees.GetElement(J),I,aSelectionner);};ObjetDonneesListe.prototype._GetTypeValeur=function(I,J){return this.GetTypeValeur(I,this.Donnees.GetElement(J));};ObjetDonneesListe.prototype._getHintForce=function(I,J){return this.getHintForce(I,this.Donnees.GetElement(J));};ObjetDonneesListe.prototype._getHintConteneur=function(I,J){return this.getHintConteneur(I,J,this.Donnees.GetElement(J));};ObjetDonneesListe.prototype._getMaskInputEdition=function(I,J){return this.getMaskInputEdition(I,this.Donnees.GetElement(J));};ObjetDonneesListe.prototype._getControleCaracteresInput=function(I,J){return this.getControleCaracteresInput(I,this.Donnees.GetElement(J));};ObjetDonneesListe.prototype._getDonnee=function(J){return this.Donnees.GetElement(J);};ObjetDonneesListe.prototype._estCelluleDeFusionEnLigne=function(I,J){return I>0&&this.estCelluleDeFusionEnLigne(I,this.Donnees.GetElement(J));};ObjetDonneesListe.prototype._estCelluleDeFusionEnColonne=function(aLigne,aColonne){return aLigne>0&&this.estCelluleDeFusionEnColonne(aLigne,aColonne,this.Donnees.GetElement(aLigne));};ObjetDonneesListe.prototype._GetTailleTexteMax=function(I,J){var lDonnee=this.Donnees.GetElement(J);switch(this.GetTypeValeur(I,lDonnee)){case this.ETypeCellule.Texte:case this.ETypeCellule.ZoneTexte:return this.GetTailleTexteMax(I,lDonnee);default:return 0;}};ObjetDonneesListe.prototype._autoriserChaineVideSurEdition=function(I,J){return this.autoriserChaineVideSurEdition(I,this.Donnees.GetElement(J));};ObjetDonneesListe.prototype._GetCouleurCellule=function(I,J){return this.GetCouleurCellule(I,this.Donnees.GetElement(J));};ObjetDonneesListe.prototype._getCouleurCelluleSelection=function(I,J){return this.getCouleurCelluleSelection(I,J,this.Donnees.GetElement(J));};ObjetDonneesListe.prototype._getClass=function(I,J){return this.getClass(I,this.Donnees.GetElement(J));};ObjetDonneesListe.prototype._getClassCelluleConteneur=function(aColonne,aLigne){return this.getClassCelluleConteneur(aColonne,aLigne,this.Donnees.GetElement(aLigne));};ObjetDonneesListe.prototype._getStyle=function(I,J){return this.getStyle(I,this.Donnees.GetElement(J));};ObjetDonneesListe.prototype._getPadding=function(I,J){return this.getPadding(I,this.Donnees.GetElement(J));};ObjetDonneesListe.prototype._estUnDeploiement=function(J){return this.Donnees.GetElement(J).estUnDeploiement;};ObjetDonneesListe.prototype._estDeploye=function(J){return this.Donnees.GetElement(J).estDeploye;};ObjetDonneesListe.prototype._getNiveauDeploiement=function(I,J){return this.getNiveauDeploiement(I,this.Donnees.GetElement(J));};ObjetDonneesListe.prototype._GetMessage_TailleMaximaleSaisie=function(I,J){return this.GetMessage_TailleMaximaleSaisie(I,this.Donnees.GetElement(J));};ObjetDonneesListe.prototype._GetLibelleSupression=function(J){return this.GetLibelleSupression(this.Donnees.GetElement(J));};ObjetDonneesListe.prototype._initialiserObjetGraphique=function(I,J,aInstance){return this.initialiserObjetGraphique(I,this.Donnees.GetElement(J),aInstance);};ObjetDonneesListe.prototype._setDonneesObjetGraphique=function(I,J,aInstance){return this.setDonneesObjetGraphique(I,this.Donnees.GetElement(J),aInstance);};ObjetDonneesListe.prototype._initialisationObjetContextuel=function(aColonne,aLigne,aInstance,aAvecCreation,aNonEditable){this.initialisationObjetContextuel(aColonne,this.Donnees.GetElement(aLigne),aInstance,aAvecCreation,aNonEditable,aLigne);};ObjetDonneesListe.prototype._evenementMenuContextuel=function(aColonne,aLigne,aLigneMenuContextuel,aElementMenuContextuel,aParametres){return this.evenementMenuContextuel(aColonne,aLigne,this.Donnees.GetElement(aLigne),aLigneMenuContextuel,aElementMenuContextuel,aParametres);};ObjetDonneesListe.prototype.GetIndice=function(ADonnee){for(var J=0;J<this.GetNbrLignes();J++)
if(this.Donnees.GetElement(J)===ADonnee)
return J;return-1;};ObjetDonneesListe.prototype.GetMessage=function(){return this.Message;};ObjetDonneesListe.prototype._GetNbrValeurs=function(I,J){return this.GetNbrValeurs(I,this.Donnees.GetElement(J));};ObjetDonneesListe.prototype._GetValeur=function(I,J,K,aSurEdition,aProportion){var LDonnee=J===null||J===undefined?null:this.Donnees.GetElement(J);var LValeur=J===null||J===undefined?this.GetValeurParDefaut(I):this.GetValeur(I,LDonnee,K,aSurEdition,aProportion,J);switch(this.GetTypeValeur(I,LDonnee)){case this.ETypeCellule.Texte:return LValeur;case this.ETypeCellule.ZoneTexte:return LValeur;case this.ETypeCellule.Html:return LValeur;case this.ETypeCellule.Date:case this.ETypeCellule.DateCalendrier:return this._getChaineDeDate(LValeur);case this.ETypeCellule.Coche:return LValeur;case this.ETypeCellule.CocheTriple:return LValeur;case this.ETypeCellule.CocheDeploiement:return'';case this.ETypeCellule.Image:return LValeur;}
return LValeur;};ObjetDonneesListe.prototype._GetContenuAffichage=function(I,J,K,aTaille,aProportion){var lContenu={};lContenu.valeur=this._GetValeur(I,J,K,false,aProportion);lContenu.title='';var LDonnee=J===null||J===undefined?null:this.Donnees.GetElement(J);if(this.avecContenuTronque(I,LDonnee))
switch(this.GetTypeValeur(I,LDonnee)){case this.ETypeCellule.Texte:case this.ETypeCellule.ZoneTexte:{var lChaineValeur=lContenu.valeur;var lChaineAffichage=this.GetValeurPourAffichage(I,LDonnee,K,false);lContenu.valeur=lChaineAffichage;if(GChaine.GetChaine(lChaineAffichage,10,false,null,true)>aTaille)
lContenu.title=lChaineValeur;}}
var lHintForce=this.getHintHtmlForce(I,J,this.Donnees.GetElement(J));if(lHintForce)
lContenu.titleHtml=lHintForce;else{lHintForce=this._getHintForce(I,J);if(lHintForce)
lContenu.title=lHintForce;}
return lContenu;};ObjetDonneesListe.prototype.getValeurPourParsing=function(aLigne,aColonne){return this._GetValeur(aColonne,aLigne);};ObjetDonneesListe.prototype._getValeurPourParsing=function(aLigne,aColonne){var lValeur=this.getValeurPourParsing(aLigne,aColonne,this.Donnees.GetElement(aLigne));if(lValeur&&lValeur.toString)
return lValeur.toString();return null;};ObjetDonneesListe.prototype._getChaineDeDate=function(aDate){return GDate.FormatDate(aDate,'%JJ/%MM/%AA');};ObjetDonneesListe.prototype.changerCoche=function(I,J){var lValeur=this.GetValeur(I,this.Donnees.GetElement(J),null,true,null,J);if(lValeur===this.EGenreCoche.Verte)
return this.EGenreCoche.Aucune;if(lValeur===this.EGenreCoche.Grise)
return this.EGenreCoche.Verte;if(lValeur===this.EGenreCoche.Aucune||lValeur===undefined)
return this.EGenreCoche.Verte;};ObjetDonneesListe.prototype.SetValeur=function(I,J,AValeur){var LDonnee=this.Donnees.GetElement(J);switch(this.GetTypeValeur(I,LDonnee)){case this.ETypeCellule.Texte:return AValeur;case this.ETypeCellule.ZoneTexte:return AValeur;case this.ETypeCellule.Html:return AValeur;case this.ETypeCellule.Date:case this.ETypeCellule.DateCalendrier:{if(AValeur===null||AValeur===undefined)
return'';var LValeur=AValeur.split('/');if(LValeur[2].length===2) LValeur[2]='20'+LValeur[2];var LDate=new Date(LValeur[2],LValeur[1]-1,LValeur[0]);if(!isNaN(LDate)&&(LValeur[0].charAt(0)==='0'))
LValeur[0]=LValeur[0].charAt(1);return isNaN(LDate)||!((LDate.getFullYear()===parseInt(LValeur[2]))&&(LDate.getMonth()===parseInt(LValeur[1]-1))&&(LDate.getDate()===parseInt(LValeur[0])))?null:LDate;}
case this.ETypeCellule.Coche:return this.changerCoche(I,J);case this.ETypeCellule.CocheTriple:return this.changerCoche(I,J);}
return AValeur;};ObjetDonneesListe.prototype.GetMessage_Format=function(I,J){switch(this.GetTypeValeur(I,this.Donnees.GetElement(J))){case this.ETypeCellule.Date:case this.ETypeCellule.DateCalendrier:return this.traductionsListe.erreurDate;}
return null;};ObjetDonneesListe.prototype.EstunDoublon=function(ADonnee){if(this._indexsUnique&&this._indexsUnique.existeIndex()){var J,lNb,LDonnee;for(J=0,lNb=this.GetNbrLignes();J<lNb;J++){LDonnee=this.Donnees.GetElement(J);if((LDonnee!==ADonnee)&&(LDonnee.Etat!==EGenreEtat.Suppression)){if(this._indexsUnique.estDoublon(ADonnee,LDonnee))
return true;}}}
return false;};ObjetDonneesListe.prototype._SurCreation=function(AListeValeurs,ALigneCreation){this.Message=null;var J= -1;var LErreur_Format= -1;var LListeValeurs=[];LListeValeurs[-1]=AListeValeurs[-1];for(var I=0;I<AListeValeurs.length;I++)
if((AListeValeurs[I]!==null&&AListeValeurs[I]!==undefined)){LListeValeurs[I]=this.SetValeur(I,J,AListeValeurs[I]);if(LListeValeurs[I]===null||LListeValeurs[I]===undefined)
LErreur_Format=I;}
if(LErreur_Format=== -1){var LDonnee=new ObjetElement();LDonnee.Numero=ObjetElement.getNumeroCreation();var LErreur=this.SurCreation(LDonnee,LListeValeurs,ALigneCreation);if(LErreur===null||LErreur===undefined){if(!this.EstunDoublon(LDonnee)){LDonnee.SetEtat(EGenreEtat.Creation);this.Donnees.AddElement(LDonnee);this.Trier();J=this.GetIndice(LDonnee);}
else this.Message=this.GetMessage_Doublon();}
else this.Message=this.GetMessage_Creation_Impossible(LErreur);}
else this.Message=this.GetMessage_Format(LErreur_Format,J);return J;};ObjetDonneesListe.prototype.setEnCreation=function(aValeur){this._enCreation=aValeur;};ObjetDonneesListe.prototype._SurApresCreation=function(aLigneCreation){var LDonnee;if(aLigneCreation!== -1)
LDonnee=this.Donnees.GetElement(aLigneCreation);this.SurApresCreation(aLigneCreation,LDonnee);};ObjetDonneesListe.prototype._SurEdition=function(I,J,AValeur){this.Message=null;var LValeur=this.SetValeur(I,J,AValeur);if((LValeur!==null&&LValeur!==undefined)){var LDonnee=this.Donnees.GetElement(J);var LValeurPrecedente=this.GetValeur(I,LDonnee,null,true,null,J);var LErreur=this.SurEdition(I,LDonnee,LValeur);if(LErreur===null||LErreur===undefined){if(!this.EstunDoublon(LDonnee)){if(this.EnModification(I))
LDonnee.SetEtat(this.GetEtatSurEdition(I,LDonnee));this.Trier();J=this.GetIndice(LDonnee);}
else{this.Message=this.GetMessage_Doublon();LDonnee=this.SurEdition(I,LDonnee,LValeurPrecedente);}}
else{this.Message=this.GetMessage_Edition_Impossible(I,LDonnee,LErreur);this.SurEdition(I,LDonnee,LValeurPrecedente);}}
else this.Message=this.GetMessage_Format(I,J);return J;};ObjetDonneesListe.prototype._Edition_Confirmation=function(I,J){this.Message=null;var LDonnee=this.Donnees.GetElement(J);if(this.Edition_Confirmation(I,LDonnee)){this.Message=this.GetMessage_Edition_Confirmation(LDonnee);return true;}};ObjetDonneesListe.prototype._SurSuppression=function(J){var LDonnee=this.Donnees.GetElement(J);this.SurSuppression(LDonnee);LDonnee.SetEtat(EGenreEtat.Suppression);this.Trier();return-1;};ObjetDonneesListe.prototype._Suppression_Impossible=function(J){this.Message=null;var LDonnee=this.Donnees.GetElement(J);if(this.Suppression_Impossible(LDonnee)){this.Message=this.GetMessage_Suppression_Impossible(LDonnee);return true;}};ObjetDonneesListe.prototype._Suppression_Confirmation=function(J){this.Message=null;var LDonnee=this.Donnees.GetElement(J);if(this.Suppression_Confirmation(LDonnee)){this.Message=this.GetMessage_Suppression_Confirmation(LDonnee);return true;}};ObjetDonneesListe.prototype._pereEstDeploye=function(aDonnees){return aDonnees.pere?(aDonnees.pere.estDeploye!==false)&&this._pereEstDeploye(aDonnees.pere):true;};ObjetDonneesListe.prototype.estVisible=function(J){var lDonnee=this.Donnees.GetElement(J);return this.GetVisible(lDonnee)&&(lDonnee.Etat!==EGenreEtat.Suppression)&&(!this.AvecDeploiement()||this._pereEstDeploye(lDonnee));};ObjetDonneesListe.prototype._deploiementAutorise=function(){};ObjetDonneesListe.prototype.Trier=function(){if(this.AvecTri()&&this.Donnees){var lColonne=this.triCourant?this.triCourant.colonne.length===1?this.triCourant.colonne[0]:this.triCourant.colonne:null,lGenre=this.triCourant?this.triCourant.genre.length===1?this.triCourant.genre[0]:this.triCourant.genre:null,lTri=this.getTri(lColonne,lGenre);if(lTri){this.Donnees.setTri(lTri);this.Donnees.trier();}
else{if(!this.GetTri){this.Donnees.trier();return;}
for(var J=0,lNb=this.GetNbrLignes();J<lNb;J++){var LDonnee=this.Donnees.GetElement(J);LDonnee.Tri=GChaine.FormatPourTri(this.GetTri(LDonnee));}
this.Donnees.Trier();}}};ObjetDonneesListe.prototype.GetNbrLignes=function(){return this.Donnees?this.Donnees.GetNbrElements():0;};ObjetDonneesListe.prototype.creerIndexUnique=function(aChamps){if(!this._indexsUnique)
this._indexsUnique=new IEClasses.ObjetIndexsUnique();this._indexsUnique.ajouterIndex(aChamps);};ObjetDonneesListe.prototype.getEtatCocheTitre=function(aColonne){var lNb=this.Donnees.GetNbrElements(),lNbCoche=0,i,lValeur,lNombreVisible=0;for(i=0;i<lNb;i++){if(this.GetVisible(this.Donnees.GetElement(i))){lNombreVisible+=1;lValeur=this._GetValeur(aColonne,i);if(lValeur===true||lValeur===ObjetDonneesListe.EGenreCoche.Verte){lNbCoche+=1;}}}
switch(lNbCoche){case 0:return ObjetDonneesListe.EGenreCoche.Aucune;case lNombreVisible:return ObjetDonneesListe.EGenreCoche.Verte;default:return ObjetDonneesListe.EGenreCoche.Grise;}};ObjetDonneesListe.prototype.getTableauLignesModifieesCocheTitre=function(aColonne,aValeur){var T=[],i,lNb=this.Donnees.GetNbrElements();for(i=0;i<lNb;i++){if(this.GetVisible(this.Donnees.GetElement(i))){T.push(i);}}
return T;};})();;
(function(){var lIdFantome=IE.GUID.getId();function _demarrer(){this.donnees={actif:false};IE.ZoneFenetre.ajouterFenetre(lIdFantome,-1);this.element=GHtml.getElement(lIdFantome);$(this.element).jIEInterdireSelectionTexte();GHtml.setDisplay(this.element,true);GHtml.setClass(this.element,'Liste_Suppression Texte10 Blanc Liste_Bleu hide');GHtml.setHtml(this.element,GChaine.Insecable(this.parametres.libelle));var lPositionX=Math.min(this.parametres.positionX,GNavigateur.ClientL-GPosition.getWidth(this.element));GPosition.setPosition(this.element,lPositionX+8,this.parametres.positionY,true);this.donnees.decalageX=this.parametres.positionX-GPosition.getLeft(lIdFantome);this.donnees.decalageY=this.parametres.positionY-GPosition.getTop(lIdFantome);this.Timer=setTimeout(_activer.bind(this),500);$(document).bind('mousemove',{instance:this},_surMouseMove);$(document).bind('mouseup',{instance:this},_surMouseUp);}
function _detruire(){IE.ZoneFenetre.enleverFenetre(lIdFantome);if(this.donnees.actif){GNavigateur.BloquerInterfaceAvecCompteur(false);if(window.getSelection&&window.getSelection()&&window.getSelection().removeAllRanges)
window.getSelection().removeAllRanges();}
this.element=null;this.parametres=null;this.donnees=null;clearTimeout(this.Timer);$(document).unbind('mousemove',_surMouseMove);$(document).unbind('mouseup',_surMouseUp);}
function _activer(){if(this.donnees.actif){return;}
this.donnees.actif=true;clearTimeout(this.Timer);GStyle.setZindex(this.element,this.parametres.zIndex);GNavigateur.BloquerInterfaceAvecCompteur(true,null,false);GStyle.setVisible(this.element,true);}
function _surMouseMove(event){var lInstance=event.data.instance;if(!lInstance.donnees.actif){var lDiffX=Math.abs(lInstance.parametres.positionX-event.pageX),lDiffY=Math.abs(lInstance.parametres.positionY-event.pageY);if(lDiffX>lInstance.parametres.deplacementActivation||lDiffY>lInstance.parametres.deplacementActivation){_activer.bind(lInstance)();}}
if(lInstance.donnees.actif){var lSurZone=GPosition.positionDansZone({x:event.pageX,y:event.pageY},lInstance.parametres.id);GHtml.setClass(lInstance.element,'Liste_Suppression Texte10 Blanc '+(!lSurZone?'Liste_Rouge':'Liste_Bleu'));$(lInstance.element).jIEInterdireSelectionTexte();GPosition.placer(lIdFantome,event.pageX-lInstance.donnees.decalageX,event.pageY-lInstance.donnees.decalageY);}}
function _surMouseUp(event){_surFin.bind(event.data.instance)({x:event.pageX,y:event.pageY});}
function _surFin(aPosition){if(this.parametres.callbackFin){this.parametres.callbackFin(GPosition.positionDansZone(aPosition,this.parametres.id),this.donnees.actif);}
_detruire.bind(this)();}
IEClasses.Fantome=function(aParametres){this.parametres={id:'',libelle:'',callbackFin:null,deplacementActivation:25,zIndex:2000,positionX:-100,positionY:-100};$.extend(this.parametres,aParametres);;;_demarrer.bind(this)();};IEClasses.Fantome.id=lIdFantome;}());;

IE.HTML.addAttribut('ie-draggable',function(aContexteCourant,aNodeName,aAttributValue,aOutils){var lNom=aAttributValue,lInfos=aOutils.getAccesParametres(lNom,aContexteCourant);if(!lNom||!aContexteCourant.controleur||!lInfos.estFonction){;return true;}
$(aContexteCourant.node).draggable(lInfos.callback());aOutils.addCommentaireDebug(aContexteCourant.node,'ie-draggable="'+lNom+'"');return true;});IE.HTML.addAttribut('ie-droppable',function(aContexteCourant,aNodeName,aAttributValue,aOutils){var lNom=aAttributValue,lInfos=aOutils.getAccesParametres(lNom,aContexteCourant);if(!lNom||!aContexteCourant.controleur||!lInfos.estFonction){;return true;}
$(aContexteCourant.node).droppable(lInfos.callback());aOutils.addCommentaireDebug(aContexteCourant.node,'ie-droppable="'+lNom+'"');return true;});;
var EFusionTitre={FusionGauche:1,FusionHaute:2};var EGenreCommandeMenu={Creation:-3,Edition:-2,Suppression:-1};var EGenreEvenementListe={Selection:0,Creation:1,Edition:2,Suppression:3,Deploiement:4,ApresCreation:5,ApresEdition:6,ApresSuppression:7,SelectionClick:8,ApresErreurCreation:9};MethodesObjet.heritagePrototype(ObjetListe,Identite);function ObjetListe(ANom,AIdent,APere,AEvenement){this.inheritedCreate(ANom,AIdent,APere,AEvenement);var lClassRef=IE.GUID.getClassCss();this.classDraggableTri=lClassRef+'_dragTri';this.IdEdition=this.Nom+'_Edition';this.idZone=this.Nom+'_Zone';this.IdZoneTexte=this.Nom+'_ZoneTexte';this.IdPremierElement=this.Nom+'_ObjetListe';this.idMenuContextuel=this.Nom+'.menuContextuel';this.idTotaux=this.Nom+'_totaux';this.ids={titre:this.Nom+'_titreTout',colonneDeTri:this.Nom+'_triCol_',curseurTri:this.Nom+'_curseurTri_',cocheTitre:this.Nom+'_cocheT_'};this.SelectionLigne= -1;this.SelectionColonne= -1;this.lignesSelectionnees=[];this.colonnesCachees=[];this.IdPrecedent='';this._initialiserOptions();this._donneesColonnes={largeurPage:null,avecPourcentage:false,largeurTotalFixe:0,numeroDerniereColVisible:0,tableauColonnesCachees:[],nbColonnesCachees:0,tableauVisibiliteColonnes:[],descripteursTri:[],reserverPlaceScrollHorizontal:false,calculsPreRenduAFaire:true,calculsTailleColonnesAFaire:true,listeNonInitialisee:true};if(this.Nom){if(this.avecEventResizeNavigateur()){this.ajouterEvenementGlobal(EEvent.SurPreResize,this.SurPreResize);this.ajouterEvenementGlobal(EEvent.SurPostResize,this.SurPostResize);}
this.ScrollV=new ObjetScroll(this.Nom+'.ScrollV',null,this,this._evenementScroll,EGenreScroll.Vertical);this.ScrollV.pas=5;this.ScrollH=new ObjetScroll(this.Nom+'.ScrollH',null,this,this._evenementScrollH,EGenreScroll.Horizontal);this.ScrollH.pas=5;}
this.idsInputFile=[];}(function(){ObjetListe._CONST_hauteurImageTri=4;ObjetListe._CONST_nbMaxLignes=200;ObjetListe._CONST_hauteurZonePagination=20;ObjetListe._CONST_largeurMinColonne=10;ObjetListe._CONST_largeurBoutonScroll=17;ObjetListe._genreBtnPage={Premier:1,Precedent:2,Suivant:3,Dernier:4};ObjetListe.initColonne=function(aPourcentage,aMinPx,aMaxPx){return{valeur:aPourcentage,min:aMinPx,max:aMaxPx};};var EGenreZoneScroll={contenu:0,titre:1,tri:2,total:3};ObjetListe.skin={classique:'classique',moderne:'moderne'};ObjetListe.prototype._initialiserOptions=function(){this._options={listeTailles:[],listeTitres:null,hintTitres:null,titreCreation:GTraductions.getValeur('liste.nouveau'),listeCreations:[],creationLigne:null,colonnesCachees:null,parsingSurColonne:-1,skin:ObjetListe.skin.classique,avecListeNeutre:undefined,avecFondBlanc:false,couleursListe:GCouleur.liste,avecScrollHorizontal:false,avecReservationPlaceScrollHorizontal:false,tailleScrollV:null,tailleScrollH:null,colonnesTriables:false,numeroColonneTriDefaut:undefined,editionApresSelection:true,ignorerEditionApresSelectionPourCoche:true,nonEditable:false,AvecSuppression:true,hauteurAdapteContenu:false,hauteurLimiteContenu:true,avecLigneTotal:false,nbLignesMax:ObjetListe._CONST_nbMaxLignes,colonnesSansBordureDroit:[],paddingCellule:2,hauteurCelluleStandard:21,hauteurCelluleTitreStandard:20,hauteurTriSimple:GNavigateur.isTactile?13:8,hauteurTriMultiple:13,hauteurContenuListeMin:22,largeurImage:18,borduresTitre_couleur:null,borduresTitre_top:1,borduresTitre_bottom:0,borduresTitre_left:1,borduresTitre_right:1,couleursTitre_getCouleurFond:function(aOptions){return aOptions.couleursListe.titre.getFond(false);},couleursTitre_getCouleurFondSurvol:function(){return GCouleur.intermediaire;},couleursTitre_getCouleurTexte:function(aOptions){return aOptions.couleursListe.titre.getTexte(false);},borduresContenu_couleur:null,borduresContenu_top:1,borduresContenu_bottom:1,borduresContenu_left:1,borduresContenu_right:1,borduresCellule_couleur:null,borduresCellule_right:1,borduresCellule_bottom:1,alternanceCouleurLigneContenu:false,instanceInputFile:null,guidInpuFile:null};};ObjetListe.prototype.setOptionsListe=function(aOptions,aAvecActualisation){if(aOptions&&aOptions.skin){_affecterOptionsSkin.bind(this)(aOptions.skin);}
if(aOptions.colonnesCachees) this._options.colonnesCachees=[];$.extend(this._options,aOptions);this._options.couleursListe=this._options.avecListeNeutre?GCouleur.listeNeutre:GCouleur.liste;this.setEditable(!this._options.nonEditable);if(this._options.tailleScrollV>0){this.ScrollV.Largeur=this._options.tailleScrollV;}
if(this._options.tailleScrollH>0){this.ScrollH.Largeur=this._options.tailleScrollH;}
this._donneesColonnes.calculsPreRenduAFaire=true;this._donneesColonnes.calculsTailleColonnesAFaire=true;if(aAvecActualisation===true){this._donneesColonnes.largeurPage=_getLargeurPage.bind(this)();this.Actualiser(true,true);}
return this;};var uParseur='',uTimerParseur= -1;function _initParseur(){uParseur='';clearTimeout(uTimerParseur);}
function _affecterOptionsSkin(aSkin){if(aSkin===ObjetListe.skin.moderne){$.extend(true,this._options,{nonEditable:true,hauteurAdapteContenu:true,alternanceCouleurLigneContenu:true,borduresTitre_couleur:null,borduresTitre_top:0,borduresTitre_bottom:0,borduresTitre_left:0,borduresTitre_right:0,couleursTitre_getCouleurFond:function(){return GCouleur.liste.titre.fond;},couleursTitre_getCouleurTexte:function(){return GCouleur.liste.titre.texte;},borduresContenu_couleur:GCouleur.blanc,borduresContenu_top:5,borduresContenu_bottom:5,borduresContenu_left:5,borduresContenu_right:5,borduresCellule_couleur:null,borduresCellule_right:0,borduresCellule_bottom:0,tailleScrollV:9,tailleScrollH:9});}}
ObjetListe.prototype.getControleur=function(){return{keypressListe:function(event){gererParsingSurEventKey.call(this.instance,event);},eventScrollZone:function(){this.instance.ScrollV.Actualiser(EGenreZoneScroll.contenu);if(this.instance._options.avecScrollHorizontal){this.instance.ScrollH.Actualiser(EGenreZoneScroll.contenu);}},surEventColonneTri:function(aColonne,aEvent){switch(aEvent.type){case'mouseenter':case'mouseleave':if($('#'+this.instance.ids.curseurTri.escapeJQ()).data('dragEnCours')){return;}
_surSurvolTriTitre.bind(this.instance)(this.node,aEvent.type==='mouseenter');break;case'contextmenu':afficherMenuContextuelTri.bind(this.instance)(aColonne);break;case'click':var lGenreTri=EGenreTriElement.Croissant,lNumeroTri=IE.MethodesTableau.chercher(aColonne,this.instance._triCourant.colonne);if(lNumeroTri=== -1){lNumeroTri=0;}
if(this.instance._triCourant.colonne[lNumeroTri]===aColonne){lGenreTri=this.instance._triCourant.genre[lNumeroTri]===EGenreTriElement.Croissant?EGenreTriElement.Decroissant:EGenreTriElement.Croissant;}
this.instance.setColonneTri(aColonne,lGenreTri,lNumeroTri);}},getColonneTriDroppable:function(aColonne){var lInstance=this.instance;return{accept:'.'+this.instance.classDraggableTri,drop:function(event,ui){var lNumeroTri=ui.draggable.IEData().numeroTri;lInstance.setColonneTri(aColonne,lInstance._triCourant.genre[lNumeroTri],lNumeroTri);},over:function(){_surSurvolTriTitre.bind(lInstance)(this,true);},out:function(){_surSurvolTriTitre.bind(lInstance)(this,false);},tolerance:"intersect"};},eventSurCurseurTri:function(aNumeroTri,aEvent){switch(aEvent.type){case'ieclick':if($(this.node).data('dragEnCours')){return;}
var lGenreTri=this.instance._triCourant.genre[aNumeroTri]===EGenreTriElement.Croissant?EGenreTriElement.Decroissant:EGenreTriElement.Croissant;this.instance.setColonneTri(this.instance._triCourant.colonne[aNumeroTri],lGenreTri,aNumeroTri);break;case'contextmenu':afficherMenuContextuelTri.bind(this.instance)(this.instance._triCourant.colonne[aNumeroTri]);break;}},getCurseurTriDraggable:function(){return{containment:'#'+this.instance.ScrollH.GetIdZone(EGenreZoneScroll.tri).escapeJQ(),axis:'x',distance:4,revert:'invalid',start:function(){$(this).data('dragEnCours',true);},stop:function(){$(this).data('dragEnCours',null);}};},surClickCocheTitre:function(aColonne){_clickSurCocheTitre.bind(this.instance)(aColonne);},getTitleCocheTitre:function(aColonne){if(this.instance.Donnees){var lEtatCoche=this.instance.Donnees.getEtatCocheTitre(aColonne);switch(lEtatCoche){case ObjetDonneesListe.EGenreCoche.Aucune:return GTraductions.getValeur('liste.toutCocher');case ObjetDonneesListe.EGenreCoche.Verte:return GTraductions.getValeur('liste.toutDecocher');}
return GTraductions.getValeur('liste.toutCocher');}
return'';},getStyleCocheTitre:function(aColonne){if(this.instance.Donnees){var lEtatCoche=this.instance.Donnees.getEtatCocheTitre(aColonne);return{'background-position':lEtatCoche===ObjetDonneesListe.EGenreCoche.Aucune?0:lEtatCoche===ObjetDonneesListe.EGenreCoche.Verte?-16:-32};}
return null;},eventSurLigneCreationUnique:function(aLigne,aEvent){_surLigneCreationUnique.bind(this.instance)(aEvent.type==='click',aLigne);},eventSurLigneCreation:function(aEvent){switch(aEvent.type){case'click':_SurCreationDeb.bind(this.instance)(false);break;case'keyup':if(GNavigateur.IsToucheEdition())
_SurCreationDeb.bind(this.instance)(false);break;}},saisieTexte:{getValue:function(){return this.instance._valeurEnEdition;},setValue:function(aLigne,aColonne,aEnCreation,aValue){var lInstance=this.instance,lNode=this.node;if(lInstance._fenetreInformationAffichee) return;if(aEnCreation){if(lInstance._messageEnCoursSurCreation) return;if(!lInstance.EnCreation) return;aColonne=lInstance.CreationColonne;aLigne= -1;}
else{if(!lInstance.EnEdition&&!lInstance.enEditionEvenement) return;}
this.instance._valeurEnEdition=_toString(aValue);var lControle=GChaine.controleTailleTexte({chaine:this.instance._valeurEnEdition,tailleTexteMax:lInstance.Donnees._GetTailleTexteMax(aColonne,aLigne)});if(!lControle.controleOK){this.instance._valeurEnEdition=lControle.chaine;lInstance._fenetreInformationAffichee=true;GApplication.getMessage().afficher({type:EGenreBoiteMessage.Information,message:lInstance.Donnees._GetMessage_TailleMaximaleSaisie(aColonne,aLigne),callback:function(){lInstance._fenetreInformationAffichee=false;GHtml.setFocus(lNode);}});}},eventSaisieTexte:function(aLigne,aColonne,aEnCreation ,aEvent){switch(aEvent.type){case'keydown':GNavigateur.SetCodeTouche(aEvent.originalEvent);if(GNavigateur.IsToucheRetourChariot()||GNavigateur.IsToucheEchap()){GNavigateur.StopperEvenement(aEvent.originalEvent);GNavigateur.bloquerValeurEvenement(aEvent.originalEvent);return false;}
return;case'keyup':GNavigateur.SetCodeTouche(aEvent.originalEvent);if(GNavigateur.IsToucheRetourChariot()||GNavigateur.IsToucheEchap()){if(aEnCreation){_SurCreation.bind(this.instance)(this.instance._valeurEnEdition);}
else{_SurEdition.bind(this.instance)(aColonne,aLigne,this.instance._valeurEnEdition);}
GNavigateur.StopperEvenement(aEvent.originalEvent);return false;}
return;case'blur':if(aEnCreation){_SurCreation.bind(this.instance)(this.instance._valeurEnEdition);}
else{_SurEdition.bind(this.instance)(aColonne,aLigne,this.instance._valeurEnEdition);}
GNavigateur.ResetCodeTouche();return;}}},btnPagination:{event:function(aGenre){_evenementBtnPage.call(this.instance,aGenre);},getDisabled:function(aGenre){switch(aGenre){case ObjetListe._genreBtnPage.Premier:case ObjetListe._genreBtnPage.Precedent:return this.instance.pageCourante<=1;default:return this.instance.pageCourante>=_getPageMax.call(this.instance);}}}};};ObjetListe.prototype.setTraductions=function(){;};ObjetListe.prototype.RecupererDonnees=function(){this._donneesColonnes.listeNonInitialisee=true;};function _getLigneElementParParseur(aListe,aParseur,aColonne){var lLigne= -1;var lParseur=GChaine.latinize(aParseur.toLowerCase()),lValeur;IE.MethodesTableau.every(aListe._lignesVisibles,function(aLigne){lLigne=aLigne;lValeur=aListe.Donnees._getValeurPourParsing(aLigne,aColonne);if(lValeur&&GChaine.latinize(lValeur.toLowerCase())>=lParseur){return false;}
return true;});return lLigne;}
function gererParsingSurEventKey(event){var lColonne=this._options.parsingSurColonne;if(lColonne==='tri'){if(this._triCourant.nombreTri>0){lColonne=this._triCourant.colonne[0];}
else{return;}}
if(lColonne=== -1)
return;if(!this.Donnees)
return;var lCar=GChaine.latinize(String.fromCharCode(event.which));if(!event.altKey&&!event.ctrlKey&&event.which!==0&&lCar.search(/[a-z0-9 ]/gi)>=0){uParseur+=lCar;clearTimeout(uTimerParseur);uTimerParseur=setTimeout(_initParseur,500);if(!_estColonneVisible.call(this,lColonne)){return;}
var lLigne=_getLigneElementParParseur(this,uParseur,lColonne);if(lLigne<0){_initParseur();return;}
if(this.Donnees.AvecMultiSelection())
for(var iLigne=0;iLigne<this.lignesSelectionnees.length;iLigne++)
if(this.lignesSelectionnees[iLigne]){this.SelectionnerLigne({ligne:iLigne,selectionner:false});}
this.SurSelection(lColonne,lLigne);_SurSelectionEvenement.call(this,lColonne,lLigne,false);}
else{_initParseur();}}
function _avecSelection(){if(this.CreationLigne=== -1)
return true;if(this.ListeTailles&&this.Donnees){for(var J=0;J<this.Donnees.GetNbrLignes();J++)
if(this.Donnees.estVisible(J))
for(var I=0;I<this.ListeTailles.length;I++)
if(this.Donnees._AvecSelection(I,J))
return true;}
return false;}
ObjetListe.prototype.ConstruireAffichage=function(ASansDonnees){if(!GHtml.elementExiste(this.Nom))
return'';if(!this._donneesColonnes.largeurPage&&this._donneesColonnes.avecPourcentage)
return'';this.nbLignesVisibles=0;var T=[];this.IdPrecedent='';if(this.ListeTailles)
this.VIdPrecedent=new Array(this.ListeTailles.length);this.ResetTableauxNavigation();if(this._options.avecListeNeutre===undefined){this._options.avecListeNeutre=$('#'+this.Nom.escapeJQ()).parents('#'+IE.ZoneFenetre.idZoneFenetre.escapeJQ()).length>0;this._options.couleursListe=this._options.avecListeNeutre?GCouleur.listeNeutre:GCouleur.liste;}
var lLargeurTable=0;if(!this._donneesColonnes.largeurTotalCalcule){lLargeurTable='100%';}
else{lLargeurTable=_getLargeurConteneur.bind(this)()+'px';}
var lSansDonnees=ASansDonnees||!this.Donnees||(this.Donnees.Donnees.GetNbrElements()===0);var lAvecSelection=_avecSelection.bind(this)();T.push('<div id="',this.IdZoneTexte,'" class="Liste_Cellule_ZoneTexte FondBlanc hide"></div>');T.push('<div id="',this.IdPremierElement,'_pere" ie-event="keypress->keypressListe" tabindex="-1" class="SansOutline SansOverflow OmbreFocus" style="width:',lLargeurTable,';height:100%;',(this._donneesColonnes.listeNonInitialisee?'visibility:hidden;':''),'">','<div id="',this.IdPremierElement,'" ',lAvecSelection?GObjetWAI.composeAttribut({genre:EGenreAttribut.describedby,valeur:this.IdPremierElement+"_infoNavWAI"})+' ':'',(this._options.labelWAI?GObjetWAI.composeAttribut({genre:EGenreAttribut.label,valeur:this._options.labelWAI}):''),' tabindex="0" class="wai_hidden SansOutline" ',window.GObjetWAI.composeRole(EGenreRole.List),' ',(lSansDonnees?window.GObjetWAI.composeAttribut({genre:EGenreAttribut.describedby,valeur:this.IdPremierElement+'_span_wai'}):''),' onkeyup="',this.Nom,'.NavigationClavier (id); if (GNavigateur.IsToucheFleche () || GNavigateur.IsToucheSelection ()) GNavigateur.StopperEvenement (event);">',(lSansDonnees?window.GObjetWAI.composeSpan(GTraductions.getValeur('WAI.AucuneDonnee'),this.IdPremierElement+'_span_wai'):''));if(lAvecSelection)
T.push('<span id="',this.IdPremierElement,'_infoNavWAI"',' class="wai_hidden" >',GObjetWAI.getInfo(EGenreObjet.AvecValidation),' ',GObjetWAI.getInfo(EGenreObjet.AvecEdition),' ',GObjetWAI.getInfo(EGenreObjet.Supprimer),' ','</span>');T.push('</div>');T.push('<div id="',this.idZone,'" class="Table Maigre" ','>');T.push(_construireTitre.bind(this)(ASansDonnees));T.push(_construireContenuListe.bind(this)(ASansDonnees));if(this._options.avecLigneTotal){T.push(_construireLigneTotal.bind(this)());}
if(this._options.avecScrollHorizontal&&this._donneesColonnes.reserverPlaceScrollHorizontal){T.push('<div id="',this.ScrollH.GetIdScroll(),'" class="AlignementGauche" style="',GStyle.composeHeight(this.ScrollH.Largeur),this._options.borduresContenu_left>0?'padding-left:'+this._options.borduresContenu_left+'px;':'','"></div>');}
if(this.nbLignesVisibles>this._options.nbLignesMax)
T.push(_construireZonePagination.bind(this)());T.push('</div>');T.push('<div class="wai_hidden"><textarea rows="2" tabIndex="-1" id="',this.Nom,'_recupnavigation"></textarea></div>','</div>');return T.join('');};function _construireTitre(ASansDonnees){var T=[],I,lITri,lAvecTri=this.Donnees&&!ASansDonnees&&this.ListeTitres&&!!this._colonnesTri,lHtmlTri=[],lOrdreHtmlTri=[],lTempHtml,lCouleurBorduresTitre=this._options.borduresTitre_couleur||this._options.couleursListe.titre.getBordure(false);this._donneesColonnes.descripteursTri=[];if(lAvecTri){lHtmlTri.push('<div id="',this.ScrollH.GetIdZone(EGenreZoneScroll.tri),'" style="overflow:hidden;position:relative;">','<div id="',this.ScrollH.GetIdContenu(EGenreZoneScroll.tri),'" class="NoWrap" style="position:relative;">');for(lITri=0;lITri<this._triCourant.nombreTri;lITri++){lHtmlTri.push('<div id="',this.ids.curseurTri+lITri,'"',IE.HTML.ieData({numeroTri:lITri}),' ie-event="ieclick-contextmenu->eventSurCurseurTri(',lITri,')"',' ie-draggable="getCurseurTriDraggable"',' style="position:absolute; z-index:1;"',' class="AvecMain NoWrap IE_draggable ',this.classDraggableTri,'"','>');if(this._triCourant.nombreTri>1){lHtmlTri.push('<div class="InlineBlock AlignementMilieuVertical ',(this._triCourant.genre[lITri]===EGenreTriElement.Croissant?'Image_CurseurDeTri_Bas':'Image_CurseurDeTri_Haut'),'"></div>','<div class="InlineBlock AlignementMilieuVertical PetitEspaceGauche Texte10">',GTraductions.getValeur('liste.tri'),' '+(lITri+1),'</div>');}
else{lHtmlTri.push('<div style="position:relative; top:2px;" class="',(this._triCourant.genre[lITri]===EGenreTriElement.Croissant?'Image_CurseurDeTri_Bas':'Image_CurseurDeTri_Haut'),'"></div>');}
lHtmlTri.push('</div>');}}
var lAvecLigneCreation=!this._options.nonEditable&&this.CreationLigne=== -1;T.push('<div id="',this.ScrollH.GetIdZone(EGenreZoneScroll.titre),'"',' style="overflow:hidden;position:relative;',this._options.borduresTitre_top>0?GStyle.composeCouleurBordure(lCouleurBorduresTitre,this._options.borduresTitre_top,EGenreBordure.haut):'',this._options.borduresTitre_right>0?GStyle.composeCouleurBordure(lCouleurBorduresTitre,this._options.borduresTitre_right,EGenreBordure.droite):'',this._options.borduresTitre_bottom>0?GStyle.composeCouleurBordure(lCouleurBorduresTitre,this._options.borduresTitre_bottom,EGenreBordure.bas):'',this._options.borduresTitre_left>0?GStyle.composeCouleurBordure(lCouleurBorduresTitre,this._options.borduresTitre_left,EGenreBordure.gauche):'','"',(this.ListeTitres||lAvecLigneCreation?'':'class="hide"'),'>','<div id="',this.ScrollH.GetIdContenu(EGenreZoneScroll.titre),'">','<table class="Texte10 SansMain" style="width:100%; background-color:'+GCouleur.fond+'" border="0" cellpadding="0" cellspacing="0">');if(!this.ListeTitres&&this.ListeTailles){T.push('<tr style="font-size:0px;">');var lTailles=this.Tailles;for(I=0;I<lTailles.length;I++)
if(_estColonneVisible.bind(this)(I))
T.push('<td class="hide" style="padding-left:2px; padding-right:3px; height: 0px;">','<div style="width:',lTailles[I],'px;">','</div>','</td>');T.push('<td class="hide" style="padding-left:2px; padding-right:2px; height:0px;"><div style="width:',this.ScrollV.Largeur-2,'px">','</td>');T.push('</tr>');}
else if(this.ListeTitres)
for(var iLigne=0;iLigne<this.ListeTitres.length;iLigne++){T.push('<tr class="AlignementMilieu">');var lTitresLigne=this.ListeTitres[iLigne];for(I=0;lTitresLigne&&(I<lTitresLigne.length);I++){var lDescripteurTitre=lTitresLigne[I];if(!lDescripteurTitre.fusion&&(_estColonneVisible.bind(this)(I)||(lTitresLigne[I+1]&&lTitresLigne[I+1].fusion===EFusionTitre.FusionGauche))){var lNbCol=_estColonneVisible.bind(this)(I)?1:0;var lNbLigne=1;for(var j=iLigne+1;j<this.ListeTitres.length;j++)
if(this.ListeTitres[j][I].fusion!==EFusionTitre.FusionHaute) break;else lNbLigne++;var lTailleTotalColonne=this.Tailles[I];for(var iColonne=I+1;iColonne<lTitresLigne.length;iColonne++){if(lTitresLigne[iColonne].fusion===EFusionTitre.FusionGauche&&_estColonneVisible.bind(this)(iColonne)){lNbCol++;lTailleTotalColonne+=this.Tailles[iColonne]+(lNbLigne===1?4+1:0);} else if(lTitresLigne[iColonne].fusion===EFusionTitre.FusionGauche&&!_estColonneVisible.bind(this)(I)) continue;else break;}
if(lNbCol===0) continue;var lColSpan=lNbCol===1?'':' colspan="'+lNbCol+'"';var lRowSpan=lNbLigne===1?'':' rowspan="'+lNbLigne+'"';var lHint=lDescripteurTitre.title?'title="'+GChaine.toTitle(lDescripteurTitre.title)+'"':'';var lChaineTitre=ASansDonnees?'':lDescripteurTitre.libelle;var lClassImage=lDescripteurTitre.classeCssImage;var lChaineHtml=lDescripteurTitre.libelleHtml;if(lChaineTitre&&!lClassImage&&!lChaineHtml){lChaineTitre=GChaine.GetLongueurChaine(lChaineTitre,10,true,lTailleTotalColonne-5);if((lHint==='')&&(lChaineTitre!==lDescripteurTitre.libelle))
lHint='title="'+lDescripteurTitre.libelle+'"';}
T.push('<td '+lHint+' class="Titre" style="padding:'+this._options.paddingCellule+'px; ',GStyle.composeWidth(lNbCol===1||lNbLigne===1?lTailleTotalColonne:null),_getStyleTitre.bind(this)(I,iLigne),'"'+lRowSpan+lColSpan,'>');if(lAvecTri&&(lNbCol===1||lNbLigne===1)&&((iLigne===this.ListeTitres.length-1)||(lNbLigne+iLigne===this.ListeTitres.length))){this._donneesColonnes.descripteursTri[I]=lDescripteurTitre;var lColonneCouranteAvecTri=this._colonnesTri[I];lTempHtml=[];lTempHtml.push('<div class="InlineBlock"',' style="padding-right:1px;',this._donneesColonnes.tableauVisibiliteColonnes[0]===I&&this._options.borduresTitre_left>0?'padding-left:'+this._options.borduresTitre_left+'px;':'',GStyle.composeHeight(this._triCourant.nombreTri>1?this._options.hauteurTriMultiple:this._options.hauteurTriSimple),GStyle.composeWidth(lTailleTotalColonne+this._options.paddingCellule*2),'"','>');if(lColonneCouranteAvecTri){lTempHtml.push('<div class="AvecMain"',' id="'+this.ids.colonneDeTri+I+'"',' ie-event="click-mouseenter-mouseleave-contextmenu->surEventColonneTri(',I,')"',' ie-droppable="getColonneTriDroppable(',I,')"',' style="','height:100%;',GStyle.composeTransitions('background-color','0.3s'),'" ','>');lTempHtml.push('</div>');}
lTempHtml.push('</div>');lOrdreHtmlTri[I]=lTempHtml.join('');}
T.push('<div ',(lNbCol===1||lNbLigne===1?' style="width:'+lTailleTotalColonne+'px"':'')+'>',lChaineHtml?lChaineHtml:'<div style="font-size:0px; height:0px;">&nbsp;</div>',lClassImage?'<div class="'+lClassImage+'" style="width:18px">&nbsp;</div>':lChaineHtml?'':lDescripteurTitre.estCoche?'<div class="AvecMain" style="position:relative; left: 1px; width:16px; overflow:hidden;">'+'<div ie-event="click->surClickCocheTitre('+I+')" id="'+(this.ids.cocheTitre+I)+'" class="Image_CochePourTitre" ie-style="getStyleCocheTitre('+I+')" ie-title="getTitleCocheTitre('+I+')"></div></div>':'<span>'+lChaineTitre+'</span>','</div>','</td>');}}
if(iLigne===0)
T.push('<td rowspan="'+this.ListeTitres.length+'" style="padding:'+this._options.paddingCellule+'px;"><div style="width:',this.ScrollV.Largeur-2,'px;">&nbsp;</div></td>');T.push('</tr>');}
T.push(lAvecLigneCreation?_ComposeCreation.bind(this)(this.CreationLigne):'','</table>','</div>','</div>');if(lAvecTri){lHtmlTri.push(lOrdreHtmlTri.join(''),'</div>','</div>');}
var lResult=[];lResult.push('<div id="',this.ids.titre,'"',' style="',((this._options.borduresContenu_left-this._options.borduresTitre_left)>0?'padding-left:'+(this._options.borduresContenu_left-this._options.borduresTitre_left)+'px;':''),'padding-right:',this.ScrollV.Largeur+this._options.borduresContenu_right+this._options.borduresTitre_right,'px;','">',lHtmlTri.join(''),T.join(''),'</div>');return lResult.join('');}
function _chercherLignesFusionVertical(aLigne,aColonne,aIndiceDebut,aIndiceFin){var lNombreLignesEnFusion=1,lLigneSuivante,lIndiceFusionLigne;for(lIndiceFusionLigne=aIndiceDebut;lIndiceFusionLigne<aIndiceFin;lIndiceFusionLigne++){lLigneSuivante=this._lignesVisibles[lIndiceFusionLigne];if(this.Donnees.estCelluleDeFusionEnColonne(lLigneSuivante,aColonne,this.Donnees.Donnees.GetElement(lLigneSuivante))){this._lignesFusionParColonne[aColonne+'_'+lLigneSuivante]={ligneOrigine:aLigne};if(!this._lignesFusionParColonne[aColonne+'_'+aLigne]){this._lignesFusionParColonne[aColonne+'_'+aLigne]={ligneOrigine:aLigne,lignesCumuls:{}};}
this._lignesFusionParColonne[aColonne+'_'+aLigne].lignesCumuls[lLigneSuivante]=true;lNombreLignesEnFusion+=1;}
else{return lNombreLignesEnFusion;}}
return lNombreLignesEnFusion;}
function _construireContenuListe(ASansDonnees){var T=[],lDepart=0,lFin=0,I,J,lNb,lCelluleFusionAvecPrecedente,iIndice,iTaille,lTaille,LContenu,lPadding,lJeuxCouleurs,lDerniereLigne,lStyleBordures,lCouleurBorduresCellules,lDerniereColonne,lCelluleFusion,lNombreColonnesFusion,LId,lPremiereColonne,lAvecEvenement,lHintConteneur,lTitleConteneur,lNombreLignesEnFusion,lCouleurBorduresContenu=this._options.borduresContenu_couleur||this._options.couleursListe.editable.getBordure(false);this._lignesFusionParColonne={};if(this.ListeTailles&&this.Donnees&&!ASansDonnees){this._lignesVisibles=[];for(J=0,lNb=this.Donnees.GetNbrLignes();J<lNb;J++)
if(this.Donnees.estVisible(J)){this._lignesVisibles.push(J);this.nbLignesVisibles++;}
this.pageCourante=Math.min(this.pageCourante,_getPageMax.bind(this)());lDepart=(this.pageCourante-1)*this._options.nbLignesMax;lFin=Math.min(this.pageCourante*this._options.nbLignesMax,this._lignesVisibles.length);}
T.push('<div id="',this.Nom,'_Liste" class="NoWrap" style="position:relative">','<div class="InlineBlock AlignementHaut WhiteSpaceNormal'+(this._options.avecFondBlanc?'':'')+'"',' style="',this._options.borduresContenu_top>0?GStyle.composeCouleurBordure(lCouleurBorduresContenu,this._options.borduresContenu_top,EGenreBordure.haut):'',this._options.borduresContenu_right>0?GStyle.composeCouleurBordure(lCouleurBorduresContenu,this._options.borduresContenu_right,EGenreBordure.droite):'',this._options.borduresContenu_bottom>0&&(lFin>lDepart||!this._options.hauteurAdapteContenu)?GStyle.composeCouleurBordure(lCouleurBorduresContenu,this._options.borduresContenu_bottom,EGenreBordure.bas):'',this._options.borduresContenu_left>0?GStyle.composeCouleurBordure(lCouleurBorduresContenu,this._options.borduresContenu_left,EGenreBordure.gauche):'','">');if(this.ListeTailles&&!ASansDonnees){T.push('<div id="',this.ScrollV.GetIdZone(EGenreZoneScroll.contenu),'" tabIndex="-1" style="overflow:hidden;position:relative;" ','ie-event="scroll->eventScrollZone" ',window.GObjetWAI.composeRole(EGenreRole.Presentation),'>');T.push('<table id="',this.ScrollV.GetIdContenu(EGenreZoneScroll.contenu),'" ',window.GObjetWAI.composeRole(EGenreRole.Presentation),'class="Texte10 SansMain" style="width:10px;" border="0" cellpadding="0" cellspacing="0">');if(this.Donnees){for(iIndice=lDepart;iIndice<lFin;iIndice++){J=this._lignesVisibles[iIndice];lPremiereColonne=true;T.push('<tr valign="top">');for(I=0;I<this.ListeTailles.length;I++)
if(_estColonneVisible.bind(this)(I)){lDerniereColonne=this._donneesColonnes.numeroDerniereColVisible===I;lCelluleFusion=this.Donnees._estCelluleDeFusionEnLigne(I,J);if(lCelluleFusion)
continue;else{lTaille=parseInt(this.Tailles[I]);lNombreColonnesFusion=1;for(iTaille=I+1;iTaille<this.ListeTailles.length;iTaille++)
if(this.Donnees._estCelluleDeFusionEnLigne(iTaille,J)){lTaille+=parseInt(this.Tailles[iTaille])+4+1;lNombreColonnesFusion++;if(this._donneesColonnes.numeroDerniereColVisible===iTaille)
lDerniereColonne=true;}
else break;}
lCelluleFusionAvecPrecedente=iIndice===lDepart?false:this.Donnees._estCelluleDeFusionEnColonne(J,I);if(lCelluleFusionAvecPrecedente){continue;}
lJeuxCouleurs=_getJeuxCouleur.bind(this)(I,J,iIndice,this.lignesSelectionnees[J]&&this.Donnees&&this.Donnees._AvecSelection(I,J));lDerniereLigne=(iIndice===lFin-1);lCouleurBorduresCellules=this._options.borduresCellule_couleur||lJeuxCouleurs.getBordure(false);lStyleBordures=((lDerniereLigne&&this._options.hauteurAdapteContenu)||(this._options.borduresCellule_bottom<=0)?'':GStyle.composeCouleurBordure(lCouleurBorduresCellules,this._options.borduresCellule_bottom,EGenreBordure.bas))+((lDerniereColonne||this._options.colonnesSansBordureDroit[I])||(this._options.borduresCellule_right<=0)?'':GStyle.composeCouleurBordure(lCouleurBorduresCellules,this._options.borduresCellule_droite,EGenreBordure.droite));lNombreLignesEnFusion=_chercherLignesFusionVertical.bind(this)(J,I,iIndice+1,lFin);LContenu=_composeContenu.bind(this)(I,J,lTaille);lPadding=this.Donnees._getPadding(I,J);lAvecEvenement=this.Donnees._AvecEvenement_Edition(I,J);lHintConteneur=this.Donnees._getHintConteneur(I,J);lTitleConteneur=lHintConteneur?' title="'+GChaine.toTitle(lHintConteneur)+'"':'';var lClassLigne=(lAvecEvenement?'AvecMain ':'')+(this.Donnees._getClassCelluleConteneur(I,J)||'');LId=_GetIdCellule.bind(this)(I,J);var lElementsInputFile=$.map(this.idsInputFile,function(aVal){return aVal.id;});if(this.Donnees._AvecInputFile(I,J)&&$.inArray(LId,lElementsInputFile)===-1){this.idsInputFile.push({id:LId,redirect:['click','contextmenu']});}
T.push('<td id="',LId,'"',lClassLigne?' class="'+lClassLigne+'"':'',lNombreLignesEnFusion>1?' rowspan="'+lNombreLignesEnFusion+'"':'',' style="padding:'+(lPadding&&$.isNumeric(lPadding)?lPadding:this._options.paddingCellule)+'px;',_getStyleCellule.bind(this)(I,J,lJeuxCouleurs),lStyleBordures,'" ',lTitleConteneur,lNombreColonnesFusion>1?' colspan="'+lNombreColonnesFusion+'"':'','>','<div ',window.GObjetWAI.composeRole(EGenreRole.Listitem),' id="',LId,'_div" class="OmbreFocus" tabIndex="-1" style="overflow:hidden; width:',lTaille,'px;"','>',LContenu,'</div>','</td>');lPremiereColonne=false;if(_HasNavigationClavier.bind(this)(I,J)){if(this.IdPrecedent==='')
this.AjouterAuTableaux(this.IdPremierElement,LId+'_div',EGenreDirection.SensNormal,EGenreDirection.SensNormal);else this.AjouterAuTableaux(this.IdPrecedent,LId+'_div',EGenreDirection.DeuxSenses);if((this.VIdPrecedent[I]!==null&&this.VIdPrecedent[I]!==undefined)){this.AjouterAuTableaux(this.VIdPrecedent[I],LId+'_div',null,EGenreDirection.DeuxSenses);}
this.VIdPrecedent[I]=LId+'_div';this.IdPrecedent=LId+'_div';}}
T.push('</tr>');if(this.CreationLigneBis===J)
T.push(_ComposeCreation.bind(this)(J));}}
T.push('<tr class="hide">');for(I=0;I<this.ListeTailles.length;I++){if(_estColonneVisible.bind(this)(I)){lDerniereColonne=this._donneesColonnes.numeroDerniereColVisible===I;lTaille=this.Tailles[I]+this._options.paddingCellule*2 ;if(this._options.borduresCellule_right<=0){lTaille+=1;}
else{if(!lDerniereColonne){lTaille+=1;}}
T.push('<td class="Liste_Cellule_Vide" style="height:0px;"><div style="height:0px;',GStyle.composeWidth(lTaille),'"><font style="font-size:1px">&nbsp;</font></div></td>');}}
T.push('</tr>');T.push('</table>','</div>');}
else{T.push('<div tabIndex="-1" style="width:100%; height:100%; overflow:auto">','</div>');}
T.push('</div>');T.push('<div id="',this.ScrollV.GetIdScroll(),'" class="AlignementGauche InlineBlock" ',' style="',GStyle.composeWidth(this.ScrollV.Largeur),(this._options.borduresContenu_top?'padding-top:'+this._options.borduresContenu_top+'px;':''),'">&nbsp;</div>');T.push('</div>');return T.join('');}
ObjetListe.prototype.composeImpression=function(aProportion){var lObjetLargeur={};Invocateur.evenement('LargeurZoneImpression',lObjetLargeur);var lDonneesColonnes={largeurPage:lObjetLargeur.width};var lTaillesColonnes=_calculerTaillesColonnes.bind(this)(lDonneesColonnes,true);var lRatio=aProportion/100;var T=[],I,iColonne,lTaille,lNombreColonnesFusion;T.push('<table border="0" cellpadding="0" cellspacing="0" style="font-family:Arial;border-left:#000 1px solid;border-top:#000 1px solid;">');if(!this.ListeTitres&&this.ListeTailles){T.push('<tr style="font-size:0px;">');var lTailles=lTaillesColonnes;for(I=0;I<lTailles.length;I++)
if(_estColonneVisible.bind(this)(I))
T.push('<td style="padding-left:2px; padding-right:3px; height: 0px; width:',lTailles[I],'px;">','</td>');T.push('</tr>');}
else if(this.ListeTitres) for(var iLigne=0;iLigne<this.ListeTitres.length;iLigne++){T.push('<tr class="AlignementMilieu">');var lTitresLigne=this.ListeTitres[iLigne];for(I=0;lTitresLigne&&(I<lTitresLigne.length);I++)
if(!lTitresLigne[I].fusion&&(_estColonneVisible.bind(this)(I)||lTitresLigne[I+1].fusion===EFusionTitre.FusionGauche)){var lNbCol=_estColonneVisible.bind(this)(I)?1:0;var lNbLigne=1;var lTailleTotalColonne=lTaillesColonnes[I]*lRatio;for(iColonne=I+1;iColonne<lTitresLigne.length;iColonne++)
if(lTitresLigne[iColonne].fusion===EFusionTitre.FusionGauche&&_estColonneVisible.bind(this)(I)){lNbCol++;lTailleTotalColonne+=lTaillesColonnes[iColonne]*lRatio;} else if(lTitresLigne[iColonne].fusion===EFusionTitre.FusionGauche&&!_estColonneVisible.bind(this)(I)) continue;else break;if(lNbCol===0) break;for(var j=iLigne+1;j<this.ListeTitres.length;j++){if(this.ListeTitres[j][I]&&this.ListeTitres[j][I].fusion===EFusionTitre.FusionHaute){lNbLigne+=1;}
else{break;}}
var lColSpan=lNbCol===1?'':' colspan="'+lNbCol+'"';var lRowSpan=lNbLigne===1?'':' rowspan="'+lNbLigne+'"';var lChaineTitre=lTitresLigne[I].libelle;var lChaineHtml=lTitresLigne[I].libelleHtml;if(lChaineTitre&&!lChaineHtml){lChaineTitre=GChaine.GetLongueurChaine(lChaineTitre,10,true,lTailleTotalColonne);}
var lAvecTri=this.Donnees&&!!this._colonnesTri;var lEstTriColonne=lAvecTri&&this._colonnesTri[I]&&(lNbCol===1)&&((iLigne===this.ListeTitres.length-1)||(lNbLigne+iLigne===this.ListeTitres.length));T.push('<td style="font-size:',11*lRatio,'px;font-weight:700;border-right:#000 1px solid;border-bottom:#000 1px solid;"'+lRowSpan+lColSpan,'>');if(lEstTriColonne){var lNumeroTri=IE.MethodesTableau.chercher(I,this._triCourant.colonne);var lCarTri=lNumeroTri>=0&&(this._triCourant.colonne[lNumeroTri]===I)?this._triCourant.genre[lNumeroTri]===EGenreTriElement.Croissant?'&#x25BC;':'&#x25B2;':'';var lLeft=lTaillesColonnes[I]*lRatio/2-(9*lRatio)/2;T.push('<div style="position:relative; top:0px; height:'+lRatio*ObjetListe._CONST_hauteurImageTri+'px;">','<div style="position:absolute; z-index:1; top:-1px; left:',lLeft,'px; font-size:',8*lRatio,'px;line-height:',8*lRatio,'px;">',lCarTri,'</div>','&nbsp;</div>');}
T.push('<div ',(lNbCol===1?' style="width:'+lTaillesColonnes[I]*lRatio+'px;"':'')+'>',lChaineHtml?lChaineHtml:'<span>'+lChaineTitre+'</span>','</div>','</td>');}
T.push('</tr>');}
if(this.ListeTailles&&this.Donnees){var lLignesVisibles=[];for(var J=0,lNb=this.Donnees.GetNbrLignes();J<lNb;J++) if(this.Donnees.estVisible(J)){lLignesVisibles.push(J);this.nbLignesVisibles++;}
for(var iIndice=0;iIndice<lLignesVisibles.length;iIndice++){J=lLignesVisibles[iIndice];T.push('<tr valign="top">');for(I=0;I<this.ListeTailles.length;I++)
if(_estColonneVisible.bind(this)(I)){var lCelluleFusion=this.Donnees._estCelluleDeFusionEnLigne(I,J);lTaille=0;lNombreColonnesFusion=0;if(lCelluleFusion) continue;else{lTaille=lTaillesColonnes[I]*lRatio;lNombreColonnesFusion=1;for(var iTaille=I+1;iTaille<this.ListeTailles.length;iTaille++)
if(this.Donnees._estCelluleDeFusionEnLigne(iTaille,J)){lTaille+=(parseInt(lTaillesColonnes[iTaille])*lRatio)+4;lNombreColonnesFusion++;} else break;lTaille=lTaille-2;}
var LContenu=_composeContenu.bind(this)(I,J,lTaille,aProportion);T.push('<td valign="middle" style="font-size:',11*lRatio,'px;border-right:#000 1px solid;border-bottom:#000 1px solid;"',lNombreColonnesFusion>1?' colspan="'+lNombreColonnesFusion+'"':'','>','<div style="display:inline-block;width:',lTaille,'px;','">',LContenu,'</div></td>');}
T.push('</tr>');}
T.push('<tr>');for(I=0;I<this.ListeTailles.length;I++)
if(_estColonneVisible.bind(this)(I))
T.push('<td style="height:0px;line-height:0px;padding-top: 0px; padding-bottom: 0px;"><div style="',GStyle.composeWidth(lTaillesColonnes[I]*lRatio+(IE.Support.bordureExterneTD?+1:0)),'">&nbsp;</div></td>');T.push('</tr>');}
T.push('</table>');return T.join('');};function _construireLigneTotal(){if(!this.ListeTailles){return'';}
var T=[];T.push('<div ',(this.Donnees?'':'class="hide"'),' style="',GStyle.composeCouleurBordure(this._options.couleursListe.editable.getBordure(false),1,EGenreBordure.gauche),'">');T.push('<div id="',this.idTotaux,'" class="NoWrap Texte10">');T.push('<div id="',this.ScrollH.GetIdZone(EGenreZoneScroll.total),'" style="overflow:hidden;position:relative;">','<div id="',this.ScrollH.GetIdContenu(EGenreZoneScroll.total),'" class="NoWrap" style="position:relative;">');var lStyleLigneTotal=GStyle.composeCouleurBordure(this._options.couleursListe.editable.getBordure(false),1,EGenreBordure.droite+EGenreBordure.bas),lSansBordureDroite;for(var I=0;I<this.ListeTailles.length;I++){if(_estColonneVisible.bind(this)(I)){lSansBordureDroite=this._options.colonnesSansBordureDroit[I];var lClassTotal=this.Donnees?this.Donnees.getClassTotal(I):'';var lStyleTotal=GStyle.composeCouleurBordure(this._options.couleursListe.editable.getBordure(false),1,(lSansBordureDroite?0:EGenreBordure.droite)+EGenreBordure.bas)+(this.Donnees?this.Donnees.getStyleTotal(I):'');var lContenuTotal=this.Donnees?this.Donnees.getContenuTotal(I):'';T.push('<div class="InlineBlock AlignementMilieuVertical Liste_Cellule_Total '+lClassTotal+'" style="',lStyleTotal,'">');T.push('<div style="',GStyle.composeWidth(this.Tailles[I]+(lSansBordureDroite?1:0)),'">',lContenuTotal?lContenuTotal:'&nbsp;','</div>');T.push('</div>');}}
T.push('</div>');T.push('</div>');T.push('</div>');T.push('</div>');return T.join('');}
function _construireZonePagination(){var T=[];var lStyleLigne=GStyle.composeHeight(ObjetListe._CONST_hauteurZonePagination);var lStyleTable='width:1px; margin-left:auto; margin-right:auto; margin-top:1px; padding-top:2px; padding-bottom:2px;'+
GStyle.composeCouleurFond(GCouleur.themeNeutre.claire)+
GStyle.composeCouleurTexte(GCouleur.noir)+
GStyle.composeBordureArrondi(6);T.push('<div style="',lStyleLigne,'">');T.push('<table class="Texte10" style="',lStyleTable,'" cellpadding="0" cellspacing="0" border="0"><tr>');T.push('<td class="EspaceGauche">','<ie-btnImage ie-model="btnPagination(',ObjetListe._genreBtnPage.Premier,')" class="Image_FlechePrecedent_Debut" style="width:14px;" title="',GTraductions.getValeur('liste.premierePage'),'"></ie-btnimage></td>');T.push('<td class="EspaceGauche">','<ie-btnImage ie-model="btnPagination(',ObjetListe._genreBtnPage.Precedent,')" class="Image_FlechePrecedent" style="width:14px;" title="',GTraductions.getValeur('liste.pagePrecedente'),'"></ie-btnimage>','</td>');T.push('<td class="Gras EspaceGauche SansMain">',GChaine.Insecable(GChaine.Format(GTraductions.getValeur('liste.numerotationPage'),[this.pageCourante,_getPageMax.bind(this)()])),'</td>');T.push('<td class="EspaceGauche">','<ie-btnImage ie-model="btnPagination(',ObjetListe._genreBtnPage.Suivant,')" class="Image_FlecheSuivant" style="width:14px;" title="',GTraductions.getValeur('liste.pageSuivante'),'"></ie-btnimage>','</td>');T.push('<td class="EspaceGauche EspaceDroit">','<ie-btnImage ie-model="btnPagination(',ObjetListe._genreBtnPage.Dernier,')" class="Image_FlecheSuivant_Fin" style="width:14px;" title="',GTraductions.getValeur('liste.dernierePage'),'"></ie-btnimage>','</td>');T.push('</tr></table>');T.push('</div>');return T.join('');}
function _getPageMax(){return Math.floor(this.nbLignesVisibles/this._options.nbLignesMax)+1;}
function _evenementBtnPage(aGenre){var lPageCourante=this.pageCourante;switch(aGenre){case ObjetListe._genreBtnPage.Premier:this.pageCourante=1;break;case ObjetListe._genreBtnPage.Precedent:this.pageCourante=Math.max(1,this.pageCourante-1);break;case ObjetListe._genreBtnPage.Suivant:this.pageCourante=Math.min(_getPageMax.bind(this)(),this.pageCourante+1);break;case ObjetListe._genreBtnPage.Dernier:this.pageCourante=_getPageMax.bind(this)();break;}
if(this.pageCourante!==lPageCourante)
this.Actualiser(false,true);}
ObjetListe.getTitreCreation=function(aTitre){var T=[];T.push('<div class="Image_ListeCreation InlineBlock AlignementMilieuVertical PetitEspaceGauche"></div>');T.push('<div class="Italique PetitEspaceGauche InlineBlock AlignementMilieuVertical" style="',GStyle.composeCouleurTexte(GCouleur.texteListeCreation),'">',aTitre,'</div>');return T.join('');};function _ComposeCreation(J){var T=[];var LOnKeyUpNav=this.Nom+'.NavigationClavier (id); if (GNavigateur.IsToucheFleche ()) GNavigateur.StopperEvenement (event);' ;var lNbColonnesVisible=this.ListeTailles.length-this._donneesColonnes.nbColonnesCachees;var N=this.ListeCreations.length===1?1:lNbColonnesVisible,LId;this._avecLigneCreationUnique=false;if(N>0){this._avecLigneCreationUnique=true;LId=this.GetIdCreation(-1,J);T.push('<tr id="',LId+'_Creation" tabindex="-1" ie-event="click-keyup->eventSurLigneCreationUnique(',J,')" class="AvecMain">');T.push('<td id="',LId,'" colspan="',lNbColonnesVisible,'" class="',_GetClassCreation(),'" '+'style="padding:'+this._options.paddingCellule+'px;',_getHeightCellule.bind(this)(1),(J=== -1?this.ListeTitres?GStyle.composeCouleurBordure(this._options.couleursListe.editable.getBordure(false),1,EGenreBordure.haut):'':GStyle.composeCouleurBordure(this._options.couleursListe.editable.getBordure(false),1,EGenreBordure.bas)),'"'+'>','<div id="',LId,'_div" tabIndex="-1" class="OmbreFocus" onkeyup="',LOnKeyUpNav,'"',GObjetWAI.composeAttribut({genre:EGenreAttribut.label,valeur:GObjetWAI.getInfo(EGenreObjet.NouvelElement)+' '+GObjetWAI.getInfo(EGenreObjet.AvecEdition)}),'>',ObjetListe.getTitreCreation(this._options.titreCreation),'</div>','</td>');if(this.IdPrecedent==='')
this.AjouterAuTableaux(this.IdPremierElement,LId+'_div',EGenreDirection.SensNormal,EGenreDirection.SensNormal);else this.AjouterAuTableaux(this.IdPrecedent,LId+'_div',EGenreDirection.DeuxSenses);this.IdPrecedent=LId+'_div';T.push('</tr>');}
T.push('<tr id="',LId+'_Creation_Edit" tabindex="-1" ie-event="click-keyup->eventSurLigneCreation"',(this._avecLigneCreationUnique?' style="display:none"':''),' class="AvecMain">');for(var I=0;I<N;I++){LId=this.GetIdCreation(I,J);T.push('<td id="',LId,'" colspan="',N===1?lNbColonnesVisible:1,'" class="',_GetClassCreation(),' Maigre" '+'style="padding:'+this._options.paddingCellule+'px;',_getHeightCellule.bind(this)(1),(J=== -1?GStyle.composeCouleurBordure(this._options.couleursListe.editable.getBordure(false),1,EGenreBordure.haut+(I<N-1?EGenreBordure.droite:0)):GStyle.composeCouleurBordure(this._options.couleursListe.editable.getBordure(false),1,EGenreBordure.bas+(I<N-1?EGenreBordure.droite:0))),'"'+'>','<div id="',LId,'_div" tabIndex="-1" class="OmbreFocus" onkeyup="',LOnKeyUpNav,'"',!this._avecLigneCreationUnique?GObjetWAI.composeAttribut({genre:EGenreAttribut.label,valeur:GObjetWAI.getInfo(EGenreObjet.NouvelElement)+' '+GObjetWAI.getInfo(EGenreObjet.AvecEdition)}):'','>',((N===1))?ObjetListe.getTitreCreation(this._options.titreCreation):'','</div>','</td>');if(!this._avecLigneCreationUnique){if(this.IdPrecedent==='')
this.AjouterAuTableaux(this.IdPremierElement,LId+'_div',EGenreDirection.SensNormal,EGenreDirection.SensNormal);else this.AjouterAuTableaux(this.IdPrecedent,LId+'_div',EGenreDirection.DeuxSenses);this.VIdPrecedent[I]=LId+'_div';this.IdPrecedent=LId+'_div';}}
T.push('<td></td>');T.push('</tr>');return T.join('');}
function _composeCoche(I,J){var lValeur=this.Donnees._GetValeur(I,J);var lHintHtml=this.Donnees.getHintHtmlForce(I,J,this.Donnees.Donnees.GetElement(J));var lHint=this.Donnees._getHintForce(I,J);var lTitle=lHintHtml?' ie-hint="\''+lHintHtml+'\'"':lHint?' title="'+GChaine.toTitle(lHint)+'"':'';if(typeof(lValeur)==='string'&&lValeur!=='')
return'<div class="'+lValeur+'" style="width:18px; margin:0 auto;" '+lTitle+'>&nbsp;</div>';if(lValeur===true||lValeur===this.Donnees.EGenreCoche.Verte)
return'<div class="Image_CocheVerte" style="width:18px; margin:0 auto;" '+lTitle+'>&nbsp;</div>';if(lValeur===this.Donnees.EGenreCoche.Grise)
return'<div class="Image_CocheGrise" style="width:18px; margin:0 auto;" '+lTitle+'>&nbsp;</div>';if(!lValeur||lValeur===this.Donnees.EGenreCoche.Aucune)
return'<div style="width: 18px; height:16px; margin:0 auto;" '+lTitle+'>'+window.GObjetWAI.composeSpan('élément désactivé')+'</div>';return'';}
function _composeImage(I,J){var lValeur=this.Donnees._GetValeur(I,J);var lHintHtml=this.Donnees.getHintHtmlForce(I,J,this.Donnees.Donnees.GetElement(J));var lHint=this.Donnees._getHintForce(I,J);var lTitle=lHintHtml?' ie-hint="\''+lHintHtml+'\'"':lHint?' title="'+GChaine.toTitle(lHint)+'"':'';return'<div style="width: 100%" class="AlignementMilieu"'+lTitle+'>'+'<div class="'+lValeur+'" style="width:'+this._options.largeurImage+'px">&nbsp;</div>'+'</div>';}
function _composeContenu(I,J,ATaille,aProportion){var LNbrValeurs=this.Donnees._GetNbrValeurs(I,J);switch(this.Donnees._GetTypeValeur(I,J)){case this.Donnees.ETypeCellule.Image:return _composeImage.bind(this)(I,J);case this.Donnees.ETypeCellule.Coche:case this.Donnees.ETypeCellule.CocheTriple:return _composeCoche.bind(this)(I,J);case this.Donnees.ETypeCellule.CocheDeploiement:return this.Donnees._estUnDeploiement(J)?'<div class="'+(this.Donnees._estDeploye(J)?'Image_DeploiementListe_Deploye':'Image_DeploiementListe_NonDeploye')+'">&nbsp;</div>':'<div style="height:13px;">'+window.GObjetWAI.composeSpan('élément désactivé')+'&nbsp;</div>';}
var H='',K;for(K=0;K<LNbrValeurs;K++){H+=_composeValeur.bind(this)(this.Donnees._GetContenuAffichage(I,J,K,ATaille,aProportion),this.Donnees._GetTypeValeur(I,J),ATaille,this.Donnees._getStyle(I,J),this.Donnees._getClass(I,J)+(this.Donnees._avecContenuTronque(I,J)?' Insecable':''),K<LNbrValeurs-1);}
return GChaine.AvecEspaceSiVide(H);}
function _composeValeur(aContenu,aType,ATaille,aStyle,aClass,AAvecEspaceBas){var lChaine=GChaine.AvecEspaceSiVide(aContenu.valeur+'');if(aType!==this.Donnees.ETypeCellule.Html){lChaine=lChaine.replace(/\r\n/g,'<br>').replace(/\n/g,'<br>');}
var lClass=aClass+(AAvecEspaceBas?' EspaceBas':'');return'<div tabIndex="-1" style="'+aStyle+' width:'+ATaille+'px; overflow:hidden;"'+(lClass?' class="'+lClass+'"':'')+(aContenu.titleHtml?' ie-html="\''+aContenu.titleHtml+'\'"':aContenu.title?' title="'+GChaine.toTitle(aContenu.title)+'"':'')+'>'+
lChaine+'</div>';}
ObjetListe.prototype.SetTitres=function(AListeTitres,aHintTitres){this.setOptionsListe({listeTitres:AListeTitres!==null?AListeTitres:undefined,hintTitres:aHintTitres!==null?aHintTitres:undefined});};function _calculerTitres(){if(this._options.listeTitres&&(this._options.listeTitres.length>0)&&!MethodesObjet.isArray(this._options.listeTitres[0])){this.ListeTitres=[];this.ListeTitres[0]=IE.MethodesObjet.dupliquer(this._options.listeTitres);}
else this.ListeTitres=IE.MethodesObjet.dupliquer(this._options.listeTitres);var lHintTitres=[];if(this._options.hintTitres&&(this._options.hintTitres.length>0)&&!MethodesObjet.isArray(this._options.hintTitres[0])){lHintTitres[0]=this._options.hintTitres;}
else lHintTitres=this._options.hintTitres;var lDescripteurSkin={getCouleurFond:this._options.couleursTitre_getCouleurFond,getCouleurFondSurvol:this._options.couleursTitre_getCouleurFondSurvol,getCouleurTexte:this._options.couleursTitre_getCouleurTexte,estCoche:false};for(var iLigne in this.ListeTitres){for(var iColonne in this.ListeTitres[iLigne]){var lDescripteur=this.ListeTitres[iLigne][iColonne],lDescripteurModele=$.extend({},lDescripteurSkin);if(!lDescripteur){lDescripteurModele.libelle='';}
else if(MethodesObjet.isObject(lDescripteur)){$.extend(lDescripteurModele,lDescripteur);}
else if(MethodesObjet.nomProprieteDeValeur(EFusionTitre,lDescripteur)!==''){lDescripteurModele.fusion=lDescripteur;}
else if((lDescripteur.charAt(0)==='[')&&(lDescripteur.charAt(lDescripteur.length-1)===']')){lDescripteurModele.classeCssImage=lDescripteur.substr(1,lDescripteur.length-2);}
else if((lDescripteur.charAt(0)==='{')&&(lDescripteur.charAt(lDescripteur.length-1)==='}')){lDescripteurModele.libelleHtml=lDescripteur.substr(1,lDescripteur.length-2);}
else if(MethodesObjet.isString(lDescripteur)){lDescripteurModele.libelle=lDescripteur;}
else{lDescripteurModele.libelle='';GLog.addLog('ObjetListe.prototype.SetTitres : pas de descripteur de colonnes',null,EGenreLog.Avertissement);}
if(!lDescripteurModele.title&&lHintTitres&&lHintTitres[iLigne]&&lHintTitres[iLigne][iColonne])
lDescripteurModele.title=lHintTitres[iLigne][iColonne];this.ListeTitres[iLigne][iColonne]=lDescripteurModele;}}}
ObjetListe.prototype.setTailles=function(AListeTailles){this.setOptionsListe({listeTailles:AListeTailles});};function _calculerTailles(){this.ListeTailles=this._options.listeTailles||[];var lElement,i,lValeur;for(i=0;i<this.ListeTailles.length;i++){lElement=this.ListeTailles[i];if(lElement&&lElement.search&&lElement.search(/%/)>=0){this.ListeTailles[i]=ObjetListe.initColonne(parseInt(lElement,10));}
else if(lElement&&!MethodesObjet.isObject(lElement)){lValeur=parseInt(lElement,10);this.ListeTailles[i]=Math.max(0,isNaN(lValeur)?0:lValeur);}}}
ObjetListe.prototype.SetParametres=function(AListeTitres,AListeTailles,AListeCreations,ACreationLigne,aTitreCreation,aHintTitres){this.setOptionsListe({listeTailles:AListeTailles!==null?AListeTailles:undefined,listeTitres:AListeTitres!==null?AListeTitres:undefined,hintTitres:aHintTitres!==null?aHintTitres:undefined,listeCreations:AListeCreations!==null?AListeCreations:undefined,creationLigne:ACreationLigne!==null?ACreationLigne:undefined,titreCreation:aTitreCreation!==null?aTitreCreation:undefined},true);};ObjetListe.prototype.setParametres_Affichage=function(aAvecStyleSite,aAvecBordure,aAvecFondBlanc,aNonEditable){this.setOptionsListe({avecFondBlanc:!!aAvecFondBlanc,nonEditable:!!aNonEditable});};ObjetListe.prototype.SetDonnees=function(ADonnees,aLigneSelectionne){this._donneesRecus=true;this.Donnees=ADonnees;var lControleurDonnees=this.Donnees?this.Donnees.getControleurDonneesListe():null;if(lControleurDonnees)
this.controleur.donneesListe=$.extend(true,{},lControleurDonnees);this._donneesColonnes.listeNonInitialisee=false;if(this.Donnees)
this.Donnees.traductionsListe=GTraductions.getValeur('liste');this.pageCourante=1;this.SelectionLigne= -1;this.SelectionColonne= -1;if(this.Donnees){this.lignesSelectionnees=new Array(this.Donnees.GetNbrLignes());this.lignesSelectionnees_prec=[];}
this.PositionCreation=0;this.ScrollV.scrollTo(0);if(this._options.avecScrollHorizontal){this.ScrollH.scrollTo(0);}
_calculsPreRendu.bind(this)();if(IE.MethodesObjet.isNumber(aLigneSelectionne)){this.SelectionLigne=aLigneSelectionne;this.SelectionnerLigne({ligne:this.SelectionLigne,avecScroll:true});_SurSelectionEvenement.bind(this)(this.SelectionColonne,this.SelectionLigne,false);}
this.Actualiser(IE.MethodesObjet.isNumber(aLigneSelectionne),false);};ObjetListe.prototype.Reset=function(){this.SetDonnees(new ObjetDonneesListe(new ObjetListeElements()));};ObjetListe.prototype.SurPreResize=function(){if(!this._donneesRecus) return;this.ScrollV.Vider();if(this._options.avecScrollHorizontal){this.ScrollH.Vider();}
this._donneesColonnes.calculsTailleColonnesAFaire=true;this._enResize=GHtml.getDisplay(this.Nom);if(!this._enResize) return;_SurCreationFin.bind(this)(-1);this.SurEditionFin(-1,null,true);_Sortir_DateCalendrier.bind(this)();this._donneesColonnes.largeurPage=0;GHtml.setHtml(this.Nom,'&nbsp;');};ObjetListe.prototype.SurPostResize=function(){if(!this._donneesRecus) return;if(this._enResize){this._donneesColonnes.largeurPage=_getLargeurPage.bind(this)();this.Actualiser(true,true);}
delete this._enResize;};function _getLargeurPage(){var lJElement=$('#'+this.Nom.escapeJQ());if(lJElement.html()==='')
lJElement.html('&nbsp;');return lJElement.width();}
function _calculerColonnes(){if(!this._donneesColonnes.largeurPage)
this._donneesColonnes.largeurPage=_getLargeurPage.bind(this)();this.Tailles=_calculerTaillesColonnes.bind(this)(this._donneesColonnes);this._donneesColonnes.calculsTailleColonnesAFaire=!this._donneesColonnes.largeurPage;}
function _calculerTri(){var lNombreTri=0,lNumerosColonnesTriDefaut=[],lGenreTriColonneTriDefaut=[],lGenreColonne,lNumeroColonne,i;if(this._options.colonnesTriables===true){this._colonnesTri=[];for(i=0;i<this.ListeTailles.length;i++)
this._colonnesTri[i]=true;}
else{this._colonnesTri=this._options.colonnesTriables;}
if(this._colonnesTri&&this._colonnesTri.length>0){if(IE.MethodesObjet.isArray(this._options.numeroColonneTriDefaut)&&this._options.numeroColonneTriDefaut.length>0){lNumerosColonnesTriDefaut=[];for(i=0;i<this._options.numeroColonneTriDefaut.length;i++){if(IE.MethodesObjet.isObject(this._options.numeroColonneTriDefaut[i])){lNumeroColonne=this._options.numeroColonneTriDefaut[i].numero||0;lGenreColonne=this._options.numeroColonneTriDefaut[i].genre||EGenreTriElement.Croissant;}
else{lNumeroColonne=this._options.numeroColonneTriDefaut[i];lGenreColonne=EGenreTriElement.Croissant;}
if(IE.MethodesObjet.isNumber(lNumeroColonne)&&_estColonneVisible.bind(this)(lNumeroColonne)&&!IE.MethodesTableau.existe(lNumeroColonne,lNumerosColonnesTriDefaut)){lNumerosColonnesTriDefaut.push(lNumeroColonne);lGenreTriColonneTriDefaut.push(lGenreColonne);}
else{;}}
lNombreTri=lNumerosColonnesTriDefaut.length;}
else{lNombreTri=1;if(IE.MethodesObjet.isObject(this._options.numeroColonneTriDefaut)){lNumeroColonne=this._options.numeroColonneTriDefaut.numero;lGenreColonne=this._options.numeroColonneTriDefaut.genre||EGenreTriElement.Croissant;}
else{lNumeroColonne=this._options.numeroColonneTriDefaut;lGenreColonne=EGenreTriElement.Croissant;}
lNumeroColonne=parseInt(lNumeroColonne||0,10);if(!_estColonneVisible.bind(this)(lNumeroColonne)){lNumeroColonne=this._donneesColonnes.tableauVisibiliteColonnes[0];;}
lNumerosColonnesTriDefaut=[lNumeroColonne];lGenreTriColonneTriDefaut=[lGenreColonne];}}
this._triCourant={colonne:[],genre:[],nombreTri:lNombreTri};for(i=0;i<lNombreTri;i++){this._triCourant.colonne[i]=lNumerosColonnesTriDefaut[i];this._triCourant.genre[i]=lGenreTriColonneTriDefaut[i];}}
function _calculerParametresCreation(){if(typeof(this._options.listeCreations)==='number'){this.ListeCreations=[];this.ListeCreations.push(this._options.listeCreations);}
else{this.ListeCreations=this._options.listeCreations;}
this.CreationLigne=this._options.creationLigne;this.CreationLigneInitial=this._options.creationLigne;}
function _calculerTaillesColonnes(aDonneesColonnes,aPourImpression){var lTaillesColonne=[];if(!this.ListeTailles) return lTaillesColonne;var i,lTailleRestante,lTotalValeurs=0,lColonnesPourcent=[];aDonneesColonnes.avecPourcentage=false;aDonneesColonnes.largeurTotalFixe=0;aDonneesColonnes.largeurTotalCalcule=0;for(i=0;i<this.ListeTailles.length;i++){if(_estColonneVisible.bind(this)(i)){if(this.ListeTailles[i]&&this.ListeTailles[i].valeur){aDonneesColonnes.avecPourcentage=true;lTotalValeurs+=this.ListeTailles[i].valeur;lColonnesPourcent.push({indice:i,valeur:this.ListeTailles[i].valeur,min:this.ListeTailles[i].min?parseInt(this.ListeTailles[i].min,10):0,max:this.ListeTailles[i].max?parseInt(this.ListeTailles[i].max,10):0});}
else{lTaillesColonne[i]=this.ListeTailles[i];if(this._options.colonnesSansBordureDroit[i])
lTaillesColonne[i]=lTaillesColonne[i]+1;aDonneesColonnes.largeurTotalFixe+=this.ListeTailles[i]+4+(this._options.colonnesSansBordureDroit[i]?2:1) ;}}}
aDonneesColonnes.largeurTotalCalcule=aDonneesColonnes.largeurTotalFixe;if(!aDonneesColonnes.largeurPage)
return lTaillesColonne;if(aDonneesColonnes.avecPourcentage){lTailleRestante=aDonneesColonnes.largeurPage-(aPourImpression?0:this.ScrollV.Largeur)-aDonneesColonnes.largeurTotalFixe-1-1-this._options.borduresContenu_left-this._options.borduresContenu_right;lTailleRestante=Math.max(0,lTailleRestante);var lElement,lNumeroColonne;for(i in lColonnesPourcent){lElement=lColonnesPourcent[i];lNumeroColonne=lElement.indice;lTaillesColonne[lNumeroColonne]=Math.max(ObjetListe._CONST_largeurMinColonne,Math.round(lTailleRestante*lElement.valeur/lTotalValeurs)-4-1);if(lElement.min&&lTaillesColonne[lNumeroColonne]<lElement.min){lTaillesColonne[lNumeroColonne]=lElement.min;}
else if(lElement.max&&lTaillesColonne[lNumeroColonne]>lElement.max){lTaillesColonne[lNumeroColonne]=lElement.max;}
lTailleRestante-=lTaillesColonne[lNumeroColonne]+5;lTotalValeurs-=lElement.valeur;aDonneesColonnes.largeurTotalCalcule+=lTaillesColonne[lNumeroColonne]+5;}}
return lTaillesColonne;}
function _surSurvolTriTitre(aElement,aEnSurvol){var lColonne=GHtml.extraireNombreDId(aElement.id),lDescripteur=this._donneesColonnes?this._donneesColonnes.descripteursTri[lColonne]:null;if(lDescripteur){GStyle.setCouleurFond(aElement,aEnSurvol?lDescripteur.getCouleurFondSurvol(this._options):'');}}
function evenementCommandesMenuContextuelTri(aColonne ,aLigne){var lNumeroTri=aLigne?aLigne.GetNumero():-1;if(lNumeroTri>=0){var lGenreTri=this._triCourant.genre[lNumeroTri];if(this._triCourant.colonne[lNumeroTri]===aColonne){lGenreTri=this._triCourant.genre[lNumeroTri]===EGenreTriElement.Croissant?EGenreTriElement.Decroissant:EGenreTriElement.Croissant;}
this.setColonneTri(aColonne,lGenreTri,lNumeroTri);}}
function afficherMenuContextuelTri(aColonne){var lDescripteur,lThis=this;if(this._triCourant.nombreTri>1){lDescripteur=this._donneesColonnes?this._donneesColonnes.descripteursTri[aColonne]:null;if(lDescripteur){ObjetMenuContextuel.afficher({pere:this,evenement:evenementCommandesMenuContextuelTri.bind(this,aColonne),initCommandes:function(aInstance){var i;for(i=0;i<lThis._triCourant.nombreTri;i++){aInstance.AddCommande(i,GTraductions.getValeur('liste.tri')+' '+(i+1),true);}}});}}}
function _clickSurCocheTitre(aColonne){var lDonneesListe=this.Donnees;if(!lDonneesListe){return;}
var lEtatCoche=lDonneesListe.getEtatCocheTitre(aColonne),lValeur=lEtatCoche!==ObjetDonneesListe.EGenreCoche.Verte,lLignes=lDonneesListe.getTableauLignesModifieesCocheTitre(aColonne,lValeur),lLigne,i,LDonnee,LErreur;for(i=0;i<lLignes.length;i++){lLigne=lLignes[i];LDonnee=lDonneesListe.Donnees.GetElement(lLigne);LErreur=lDonneesListe.SurEdition(aColonne,LDonnee,lValeur);if(LErreur===null||LErreur===undefined){if(lDonneesListe.EnModification(aColonne)){LDonnee.SetEtat(lDonneesListe.GetEtatSurEdition(aColonne,LDonnee));}}}
this.Actualiser(true,false);if(this.Pere&&this.Pere.$refreshSelf) this.Pere.$refreshSelf();_SurApresEditionEvenement.bind(this)(-1,aColonne);}
function _ajouterEvents(){var i;var lEventMapCelluleTd={mousedown:_surMouseDownCellule,mouseup:_surMouseUpCellule,click:_surClickCellule,keyup:_surKeyUpCellule,contextmenu:_surContextMenuCellule};var lEventMapCelluleDiv={keyup:_surKeyUpCelluleDiv};var lData={instance:this,callbackSuppressionDebut:_SurSuppressionDeb.bind(this),callbackSurDeploiement:_SurDeploiement.bind(this),callbackMenuContextuel:_ouvrirMenuContextuel.bind(this)};$('#'+this.ScrollV.GetIdContenu(EGenreZoneScroll.contenu).escapeJQ()).on('iedown','tr',lData,_surMouseDownLigne).on(lEventMapCelluleTd,'td:has(div)',lData).on(lEventMapCelluleDiv,'td>div',lData);if(!!this._colonnesTri){for(i=0;i<this._triCourant.nombreTri;i++){if(this._colonnesTri&&IE.MethodesObjet.isNumber(this._triCourant.colonne[i])){var lElement=$('#'+(this.ids.colonneDeTri+this._triCourant.colonne[i]).escapeJQ()),lPosition=lElement.position();if(lPosition){$('#'+(this.ids.curseurTri+i).escapeJQ()).css('left',(lPosition.left+Math.round(lElement.width()/2)-6)+'px');}}}}}
function _getDraggableContainer(){return this.draggableContainer?this.draggableContainer:'parent';}
ObjetListe.prototype.setDraggableContainer=function(aSelectorContainer){this.draggableContainer=aSelectorContainer;};function _ajouterDragLigne(){var lThis=this;for(var J=0;J<this.Donnees.GetNbrLignes();J++){if(this.Donnees._AvecDragLigne(J)){$('#'+_GetIdCellule.bind(this)(0,J).escapeJQ()).parent().draggable({revert:'invalid',appendTo:_getDraggableContainer.bind(lThis)(),helper:lThis.Donnees._getDraggableHelper(J),zIndex:lThis.Donnees.getDraggableZIndex(),delay:lThis.Donnees.getDraggableDelay(),distance:lThis.Donnees.getDraggableDistance(),cursorAt:lThis.Donnees.getDraggableCursorAt(),cursor:lThis.Donnees.getDraggableCursor(),scroll:lThis.Donnees.getDraggableScroll(),start:lThis.Donnees.getDraggableCallbackStart(),stop:lThis.Donnees.getDraggableCallbackStop()}).data('donneesliste-infodrag',lThis.Donnees._getDragInfoLigne(J)).addClass('classDraggableDeObjetListe');}}}
function _calculsPreRendu(){if(this._donneesColonnes.calculsPreRenduAFaire){this._donneesColonnes.calculsPreRenduAFaire=false;_calculerTitres.bind(this)();_calculerTailles.bind(this)();_calculColonnesCachees.bind(this)();_calculerParametresCreation.bind(this)();_calculerTri.bind(this)();}
if(this._donneesColonnes.calculsTailleColonnesAFaire){_calculerColonnes.bind(this)();}}
ObjetListe.prototype.Actualiser=function(aConserverSelection,aSansTriDonnees){this.EnCreation=false;this.EnEdition=false;if(!GHtml.elementExiste(this.Nom))
return;_calculsPreRendu.bind(this)();var lListeSelection=null;if(this.Donnees){if(aConserverSelection&&this.Donnees.Donnees&&this.Donnees.Donnees.GetElement)
lListeSelection=this.getListeElementsSelection();else{this.SelectionLigne= -1;this.SelectionColonne= -1;this.lignesSelectionnees=new Array(this.Donnees.GetNbrLignes());this.lignesSelectionnees_prec=[];}
if(aSansTriDonnees!==true){this.Donnees.triCourant=this._triCourant;this.Donnees.Trier();}}
var lScrollTop=GPosition.getScrollTop(this.ScrollV.GetIdZone(EGenreZoneScroll.contenu)),lScrollLeft;if(this._options.avecScrollHorizontal){lScrollLeft=$('#'+this.ScrollH.GetIdZone(EGenreZoneScroll.contenu).escapeJQ()).scrollLeft();}
GHtml.setHtml(this.Nom,this.ConstruireAffichage(),{controleur:this.controleur});this.ScrollV.SetDonnees(EGenreZoneScroll.contenu);if(this._options.avecScrollHorizontal){this.ScrollH.SetDonnees(EGenreZoneScroll.contenu,EGenreZoneScroll.titre,EGenreZoneScroll.tri,EGenreZoneScroll.total);}
this.ScrollV.scrollTo(lScrollTop);if(this._options.avecScrollHorizontal){this.ScrollH.scrollTo(lScrollLeft);}
_ajouterEvents.bind(this)();if(this.Donnees){this.Donnees.apresConstruction(this);}
if(this.Donnees&&this.Donnees._AvecDrag()){_ajouterDragLigne.bind(this)();}
if(this.idsInputFile.length&&this._options&&this._options.guidInputFile&&this._options.instanceInputFile){this._options.instanceInputFile.setDonnees({guid:this.Nom,elements:this.idsInputFile});}
if(aConserverSelection&&lListeSelection&&lListeSelection.GetNbrElements()>0)
this.setListeElementsSelection(lListeSelection,true);};function _getHauteurConteneur(){var lJListe=$(GHtml.getElement(this.Nom+'_Liste'));lJListe.css('height','1px');$(GHtml.getElement(this.IdPremierElement+'_pere')).css('height','100%');var lHauteurConteneur=GPosition.getHeight(this.IdPremierElement+'_pere')-GPosition.getHeight(this.ids.titre)-(GNavigateur.IsIE?0:1)-this._options.borduresContenu_top-this._options.borduresContenu_bottom;if(this._options.avecScrollHorizontal&&this._donneesColonnes.reserverPlaceScrollHorizontal){lHauteurConteneur-=this.ScrollH.Largeur;}
$(GHtml.getElement(this.IdPremierElement+'_pere')).css('height','auto');lJListe.css('height','');if(this._options.avecLigneTotal)
lHauteurConteneur=lHauteurConteneur-$(GHtml.getElement(this.idTotaux)).height();if(this._options.hauteurAdapteContenu){var lHeightContenu=$(GHtml.getElement(this.ScrollV.GetIdContenu(EGenreZoneScroll.contenu))).outerHeight();if(IE.MethodesObjet.isNumber(this._options.hauteurLimiteContenu)){lHauteurConteneur=Math.min(lHauteurConteneur,this._options.hauteurLimiteContenu);}
else{lHauteurConteneur=Math.min(lHauteurConteneur,lHeightContenu);}}
return lHauteurConteneur;}
function _getStyleTitre(aColonne,aLigne,aAvecTri){if(!this.ListeTitres){return'';}
var lDescripteur=this.ListeTitres[aLigne][aColonne];if(!lDescripteur){return'';}
var lCouleurBorduresTitre=this._options.borduresTitre_couleur||this._options.couleursListe.titre.getBordure(false);return GStyle.composeHeight(this._options.hauteurCelluleTitreStandard+(IE.Support.bordureExterneTD?0:-4-1)+
1+(aAvecTri?ObjetListe._CONST_hauteurImageTri:0))+
GStyle.composeCouleurFond(lDescripteur.getCouleurFond(this._options))+
GStyle.composeCouleurTexte(lDescripteur.getCouleurTexte(this._options))+(this._donneesColonnes.numeroDerniereColVisible===aColonne?aLigne>0?GStyle.composeCouleurBordure(lCouleurBorduresTitre,1,EGenreBordure.haut):'':GStyle.composeCouleurBordure(lCouleurBorduresTitre,1,EGenreBordure.droite+(aLigne>0?EGenreBordure.haut:0)));}
function _getStyleCellule(I,J,aJeuxCouleurs){return _getHeightCellule.bind(this)()+
GStyle.composeCouleurFond(aJeuxCouleurs.getFond(false))+
GStyle.composeCouleurTexte(aJeuxCouleurs.getTexte(false));}
function _getHeightCellule(aModificateur){return GStyle.composeHeight(this._options.hauteurCelluleStandard+(IE.Support.bordureExterneTD?0:-4-1)+(aModificateur?aModificateur:0));}
function _setStyleCellule(aId,I,J,aSelectionne,aCreation){var lJeuxCouleurs;if(aCreation&&!aSelectionne)
lJeuxCouleurs=this._options.couleursListe.editable;else{var lNumeroLigneVisible=J;if(aId&&aId.escapeJQ){lNumeroLigneVisible=$('#'+aId.escapeJQ()).parent().prevAll().length;}
lJeuxCouleurs=_getJeuxCouleur.bind(this)(I,J,lNumeroLigneVisible,aSelectionne);}
GStyle.setCouleur(aId,lJeuxCouleurs.getFond(false),lJeuxCouleurs.getTexte(false));}
function _GetClassCreation(){return'Liste_Cellule_Creation FondBlanc';}
function _getJeuxCouleurNonSelection(I,J,aNumeroLigneVisible){var LCouleurCellule=this.Donnees._GetCouleurCellule(I,J);if((LCouleurCellule!==null&&LCouleurCellule!==undefined))
switch(LCouleurCellule){case this.Donnees.ECouleurCellule.Blanc:return this._options.couleursListe.editable;case this.Donnees.ECouleurCellule.Gris:return this._options.couleursListe.nonEditable;case this.Donnees.ECouleurCellule.Deploiement:return this._options.couleursListe.cumul[this.Donnees._getNiveauDeploiement(I,J)];default:return LCouleurCellule;}
else{return this._options.alternanceCouleurLigneContenu?aNumeroLigneVisible%2===1?new ObjectCouleurCellule(GCouleur.blanc,GCouleur.noir,null):new ObjectCouleurCellule(GCouleur.fond,GCouleur.noir,null):(this.Donnees._AvecEdition(I,J)&&!this._options.nonEditable?this._options.couleursListe.editable:this._options.couleursListe.nonEditable);}}
function _getJeuxCouleur(aColonne,aLigne,aNumeroLigneVisible,aEstSelectionne){var lJeuxCouleur=_getJeuxCouleurNonSelection.bind(this)(aColonne,aLigne,aNumeroLigneVisible),lCouleurBordure=lJeuxCouleur.bordure;if(aEstSelectionne){var lJeuxCouleurSelection=this.Donnees._getCouleurCelluleSelection(aColonne,aLigne);if(!lJeuxCouleurSelection){lJeuxCouleur=new ObjectCouleurCellule(GCouleur.selection.fond,GCouleur.selection.texte);}
else{lJeuxCouleur=new ObjectCouleurCellule(lJeuxCouleurSelection.fond,lJeuxCouleurSelection.texte);}
if(!lJeuxCouleur.bordure){lJeuxCouleur.bordure=lCouleurBordure;}}
return lJeuxCouleur;}
function _HasNavigationClavier(I,J){var LCouleurCellule=this.Donnees._GetCouleurCellule(I,J);if((LCouleurCellule!==null&&LCouleurCellule!==undefined))
switch(LCouleurCellule){case this.Donnees.ECouleurCellule.Blanc:return true;case this.Donnees.ECouleurCellule.Gris:return(this.Donnees._GetNbrValeurs(I,J)>0)?true:false;case this.Donnees.ECouleurCellule.Deploiement:return(I===0)?true:false;}
else return(!this.Donnees._AvecEdition(I,J)||this._options.nonEditable?(this.Donnees._GetNbrValeurs(I,J)<1)?false:true:true);}
function _afficherMessage(){var LMessage=this.Donnees.GetMessage();if(LMessage)
GApplication.getMessage().Afficher(EGenreBoiteMessage.Information,null,LMessage);else if(this.Donnees._AvecEtatSaisie())
this.SetEtatSaisie(true);}
function _SurCreationEvenement(I){if(this.Donnees)
if(this.Donnees._AvecEvenement_Creation(I))
if(this.Pere&&this.Evenement){var lResult=this.Evenement.call(this.Pere,EGenreEvenementListe.Creation,I);if(this.Pere&&this.Pere.$refreshSelf) this.Pere.$refreshSelf();return lResult;}}
ObjetListe.prototype.setColonneTri=function(aColonne,aGenre,aNumeroTri){var lNumeroTri=aNumeroTri||0,lNumeroAncienTri=IE.MethodesTableau.chercher(aColonne,this._triCourant.colonne);if(lNumeroAncienTri>=0&&lNumeroAncienTri!==lNumeroTri){this._triCourant.colonne[lNumeroAncienTri]=this._triCourant.colonne[lNumeroTri];}
this._triCourant.genre[lNumeroTri]=(aGenre!==null&&aGenre!==undefined)?aGenre:EGenreTriElement.Croissant;this._triCourant.colonne[lNumeroTri]=aColonne;this.Actualiser(true,false);};function _extraireInfosId(aId){if(!aId) return false;var lInfos={};var lIds=aId.split('_');if(lIds[lIds.length-1]==='div'){lInfos.J=parseInt(lIds[lIds.length-2]);lInfos.I=parseInt(lIds[lIds.length-3]);}
else{lInfos.J=parseInt(lIds[lIds.length-1]);lInfos.I=parseInt(lIds[lIds.length-2]);}
return lInfos;}
function _surMouseDownCellule(event){var lInfos=_extraireInfosId(this.id);if(!lInfos) return;var lInstance=event.data.instance;GNavigateur.CtrlTouche=event.ctrlKey;lInstance.SurSelection(lInfos.I,lInfos.J,true);event.data.callbackSurDeploiement(event,lInfos.I,lInfos.J);lInstance._controleurMouseDown={i:lInfos.I,j:lInfos.J};}
function _surMouseUpCellule(event){var lInfos=_extraireInfosId(this.id),I=lInfos.I,J=lInfos.J,lInstance=event.data.instance;if(!lInfos) return;if(lInstance._controleurMouseDown){I=lInstance._controleurMouseDown.i;J=lInstance._controleurMouseDown.j;delete lInstance._controleurMouseDown;lInstance.forcerMenuContextuel=false;_SurSelectionEvenement.bind(lInstance)(I,J);}}
function _surContextMenuCellule(event){var lInfos=_extraireInfosId(this.id),J=lInfos.J,lInstance=event.data.instance;if(!lInfos) return;if(lInstance.Donnees&&(J> -1)&&(lInstance.SelectionColonne> -1)&&lInstance.Donnees._AvecMenuContextuel(lInstance.SelectionColonne,lInstance.SelectionLigne)&&(!$.fn.jIEDesactiverMenuContextuel||!$.fn.jIEDesactiverMenuContextuel.accepteContextMenuNatif(event)))
event.data.callbackMenuContextuel(lInstance.SelectionColonne,lInstance.SelectionLigne);}
function _estLignePrecedemmentSelectionnee(aColonne,aLigne){if(!this.lignesSelectionnees_prec){return false;}
if(this.lignesSelectionnees_prec[aLigne]){return true;}
var lInfosFusion=this._lignesFusionParColonne[aColonne+'_'+aLigne],lLigne;if(lInfosFusion&&lInfosFusion.lignesCumuls){for(lLigne in lInfosFusion.lignesCumuls){if(this.lignesSelectionnees_prec[lLigne]){return true;}}}
return false;}
function _editionDebSurSelection(I,J){if(this.Donnees&&(J> -1))
if(this.Donnees._AvecEvenement_SelectionClick(I,J))
if(this.Pere&&this.Evenement){var lResult=this.callback.appel(EGenreEvenementListe.SelectionClick,I,J,false);if(this.Pere&&this.Pere.$refreshSelf) this.Pere.$refreshSelf();if(lResult)
return;}
if(!this._options.editionApresSelection||_estLignePrecedemmentSelectionnee.bind(this)(I,J)||this.Donnees._AvecInputFile(I,J)||(this._options.ignorerEditionApresSelectionPourCoche&&(this.Donnees._GetTypeValeur(I,J)===this.Donnees.ETypeCellule.Coche)))
_SurEditionDeb.bind(this)(I,J);}
function _surClickCellule(event){var lInfos=_extraireInfosId(this.id),I=lInfos.I,J=lInfos.J,lInstance=event.data.instance;if(!lInfos) return;_editionDebSurSelection.bind(lInstance)(I,J);}
function _surKeyUpCellule(event){var lInfos=_extraireInfosId(this.id),I=lInfos.I,J=lInfos.J,lInstance=event.data.instance;if(!lInfos) return;if(GNavigateur.IsToucheSelection()||GNavigateur.IsToucheEdition()){lInstance.SurSelection(I,J,true);_SurSelectionEvenement.bind(lInstance)(I,J,true);}
if(GNavigateur.IsToucheSelection()){_editionDebSurSelection.bind(lInstance)(I,J);}
if(GNavigateur.IsToucheEdition()){_SurEditionDeb.bind(lInstance)(I,J);}
if(GNavigateur.IsToucheSupprimer()&&lInstance._options.AvecSuppression&&lInstance.Donnees._AvecSuppression(J)&&!lInstance.EnSuppression&&!lInstance.EnEdition){lInstance.SurSelection(I,J,true);lInstance.SurSuppression();}
GNavigateur.ResetCodeTouche();}
function _surKeyUpCelluleDiv(event){var lInfos=_extraireInfosId(this.id),I=lInfos.I,J=lInfos.J,lInstance=event.data.instance;if(GNavigateur.IsToucheFleche()){lInstance.NavigationClavier(_GetIdCellule.bind(lInstance)(I,J)+'_div');GNavigateur.StopperEvenement(event);}}
function _surMouseDownLigne(event){if($(this).is("html *")&&!event.estTouch){var lInfos=_extraireInfosId($(this).children()[0].id);if(!lInfos) return;event.data.callbackSuppressionDebut(lInfos.J,event);}}
function _ouvrirMenuContextuel(I,J){var lThis=this;ObjetMenuContextuel.afficher({pere:this,evenement:_evenementMenuContextuel.bind(this,I,J),initCommandes:function(aInstance){lThis.Donnees._initialisationObjetContextuel(I,J,aInstance,lThis.CreationLigne,lThis._options.nonEditable);},affichageSurInitCommandes:true});}
function _evenementMenuContextuel(I,J,aLigne,aElement){var lParametres={avecActualisation:true};if(aLigne)
switch(aLigne.GetNumero()){case EGenreCommandeMenu.Creation:{if(this._avecLigneCreationUnique){var LId=this.GetIdCreation(-1,-1);GHtml.setDisplay(LId+'_Creation',false);GHtml.setDisplay(LId+'_Creation_Edit',true);}
_SurCreationDeb.bind(this)(false);break;}
case EGenreCommandeMenu.Edition:{_SurEditionDeb.bind(this)(I,J);break;}
case EGenreCommandeMenu.Suppression:{this.SurSuppression();break;}
default:{this.Donnees._evenementMenuContextuel(I,J,aLigne,aElement,lParametres);if(lParametres.avecActualisation)
this.Actualiser(true);}}
else{this.Donnees._evenementMenuContextuel(I,J,aLigne,aElement,lParametres);if(lParametres.avecActualisation)
this.Actualiser(true);}}
function _SurSelectionEvenement(I,J,aSurClavier){if(this.Donnees&&(J> -1))
if(this.Donnees._AvecEvenement_Selection(I,J))
if(this.Pere&&this.Evenement){this.Evenement.call(this.Pere,EGenreEvenementListe.Selection,I,J,aSurClavier);if(this.Pere&&this.Pere.$refreshSelf) this.Pere.$refreshSelf();}
return true;}
function _SurSuppressionEvenement(J){if(this.Donnees&&(J> -1))
if(this.Donnees._AvecEvenement_Suppression(J))
if(this.Pere&&this.Evenement){this.Evenement.call(this.Pere,EGenreEvenementListe.Suppression,this.SelectionColonne,this.SelectionLigne);if(this.Pere&&this.Pere.$refreshSelf) this.Pere.$refreshSelf();}}
function _SurApresCreationEvenement(){if(this.Donnees)
if(this.Donnees._AvecEvenement_ApresCreation())
if(this.Pere&&this.Evenement){var lResult=this.Evenement.call(this.Pere,EGenreEvenementListe.ApresCreation);if(this.Pere&&this.Pere.$refreshSelf) this.Pere.$refreshSelf();return lResult;}}
function _SurApresErreurCreationEvenement(){if(this.Donnees)
if(this.Donnees._AvecEvenement_ApresErreurCreation())
if(this.Pere&&this.Evenement){var lResult=this.Evenement.call(this.Pere,EGenreEvenementListe.ApresErreurCreation);if(this.Pere&&this.Pere.$refreshSelf) this.Pere.$refreshSelf();return lResult;}}
function _SurApresEditionEvenement(aLigne,aColonne){if(this.Donnees)
if(this.Donnees._AvecEvenement_ApresEdition(aLigne,aColonne))
if(this.Pere&&this.Evenement){this.Evenement.call(this.Pere,EGenreEvenementListe.ApresEdition,aColonne,aLigne);if(this.Pere&&this.Pere.$refreshSelf) this.Pere.$refreshSelf();}
return true;}
function _SurApresSuppressionEvenement(){if(this.Donnees)
if(this.Donnees._AvecEvenement_ApresSuppression())
if(this.Pere&&this.Evenement){this.Evenement.call(this.Pere,EGenreEvenementListe.ApresSuppression);if(this.Pere&&this.Pere.$refreshSelf) this.Pere.$refreshSelf();}}
function _Entrer_Edition(){_Sortir_ZoneTexte.bind(this)();_Sortir_DateCalendrier.bind(this)();_setStyleCellule.bind(this)(this.IdCellule,null,null,false,true);}
function _getHTMLControleTexte(aColonne,aLigne){var lControle=this.Donnees._getControleCaracteresInput(aColonne,aLigne),lIEMask='',lMaxLength='';if(lControle&&lControle.mask){lIEMask='ie-mask="/[^'+lControle.mask+']/i" ';}
if(lControle&&lControle.tailleMax){lMaxLength='maxlength="'+lControle.tailleMax+'" ';}
if(!lMaxLength&&IE.HTML.MAX_LENGTH_Default>0&&this.Donnees._GetTailleTexteMax(aColonne,aLigne)>IE.HTML.MAX_LENGTH_Default){lMaxLength='maxlength="0" ';}
return lIEMask+lMaxLength;}
function _toString(aValeur){return aValeur+'';}
function _Entrer_Texte(I,J,aSurLigneCreation){var LValeur=this.Donnees._GetValeur(I,J,null,true);LValeur=_toString(LValeur);var lMaskInput=this.Donnees._getMaskInputEdition(I,J);if(lMaskInput){GHtml.setHtml(this.IdCellule,'<input id="'+this.IdEdition+'" class="Texte10 InlineBlock Liste_Texte" style="height:14px;" value="'+LValeur+'"></input>');var lInstance=this;var lEventMap={blur:function(){_sortirSaisieMaskInput.bind(lInstance)(this,I,J);},keydown:function(aEvent){GNavigateur.SetCodeTouche(aEvent);if(GNavigateur.IsToucheRetourChariot()){GNavigateur.StopperEvenement(aEvent);_sortirSaisieMaskInput.bind(lInstance)(this,I,J);}}};$('#'+this.IdCellule.escapeJQ()+'>input').on(lEventMap).mask(lMaskInput);}
else{this._valeurEnEdition=LValeur;GHtml.setHtml(this.IdCellule,'<input id="'+this.IdEdition+'" class="Texte10 Liste_Texte" '+'ie-model="saisieTexte('+J+','+I+','+!!aSurLigneCreation+')" '+'ie-event="keydown-keyup-blur->eventSaisieTexte" '+_getHTMLControleTexte.call(this,I,J)+'></input>',{controleur:this.controleur});}}
function _sortirSaisieMaskInput(aInput,I,J){var lValeur=$(aInput).val();if(J===null||J===undefined)
_SurCreation.bind(this)(lValeur);else _SurEdition.bind(this)(I,J,lValeur);}
function _Entrer_ZoneTexte(I,J,aSurLigneCreation){this._valeurEnEdition=this.Donnees._GetValeur(I,J,null,true);this._valeurEnEdition=_toString(this._valeurEnEdition);GHtml.setHtml(this.IdZoneTexte,'<textarea '+'ie-model="saisieTexte('+J+','+I+','+!!aSurLigneCreation+')" '+'ie-event="keydown-keyup-blur->eventSaisieTexte" '+' id="'+this.IdEdition+'" class="Texte10 Liste_ZoneTexte" '+'style="'+GStyle.composeCouleurBordure(this._options.couleursListe.editable.getBordure(false),1)+'" '+_getHTMLControleTexte.call(this,I,J)+'></textarea>',{controleur:this.controleur});var lPositionnement={width:GPosition.getWidth(this.IdCellule)+(aSurLigneCreation?2:1),height:100,left:GPosition.getLeft(this.IdCellule)+(aSurLigneCreation?0:-1),top:GPosition.getTop(this.IdCellule)+(aSurLigneCreation?1:-1)};GPosition.setTaille(this.IdZoneTexte,lPositionnement.width,lPositionnement.height);GPosition.placer(this.IdZoneTexte,lPositionnement.left,lPositionnement.top);GStyle.setVisible(this.IdZoneTexte,true);}
function _Sortir_ZoneTexte(){GStyle.setVisible(this.IdZoneTexte,false);GHtml.setHtml(this.IdZoneTexte,'');}
function _Entrer_DateCalendrier(I,J){;_Sortir_DateCalendrier.call(this);var LValeur=this.Donnees._GetValeur(I,J,null,true);GHtml.setHtml(this.IdCellule,'<span class="Texte10 Liste_Texte">'+LValeur+'</span>');this.fenetreDate=ObjetFenetre.creerInstance(window.ObjetFenetre_Date,{pere:this,evenement:_evenementFenetreDate.bind(this,I,J)});var lSelf=this;this.fenetreDate.ajouterCallbackSurDestruction(function(){delete lSelf.fenetreDate;});this.Donnees._initialiserObjetGraphique(I,J,this.fenetreDate);this.Donnees._setDonneesObjetGraphique(I,J,this.fenetreDate);this.fenetreDate.positionnerSousId(this.IdCellule);}
function _Sortir_DateCalendrier(){if(!this.fenetreDate) return;this.fenetreDate.Fermer();}
function _evenementFenetreDate(I,J,aGenreBouton,aDate){if(aGenreBouton=== -1){if(J===null||J===undefined)
_SurCreationFin.bind(this)(-1);else this.SurEditionFin(-1,J);}
else{var lValeur=aGenreBouton===1?this.Donnees._getChaineDeDate(aDate):null;if(J===null||J===undefined)
_SurCreation.bind(this)(lValeur);else _SurEdition.bind(this)(I,J,lValeur);}
_Sortir_DateCalendrier.bind(this)();}
ObjetListe.prototype.SurSelection=function(I,J){this.lignesSelectionnees_prec=MethodesObjet.dupliquer(this.lignesSelectionnees);if(!this.EnCreation&&!this.EnEdition){if(!this.Donnees||!(this.Donnees.AvecMultiSelection()&&(!this.Donnees.avecMultiSelectionSurCtrl()||GNavigateur.CtrlTouche))){if(this.lignesSelectionnees_prec[J]&&this.Donnees&&this.Donnees._avecDeselection(J,I)&&!this.Donnees.AvecMultiSelection()&&GNavigateur.CtrlTouche){this.SelectionnerLigne({ligne:this.SelectionLigne,selectionner:false});this.lignesSelectionnees_prec[J]=false;this.SelectionLigne= -1;this.SelectionColonne= -1;if(this.Donnees)
this.Donnees._SurSelection(J,I,false);return;}
if((I===this.SelectionColonne)&&(J===this.SelectionLigne))
return;var lInfosFusion=this._lignesFusionParColonne[I+'_'+J];if(lInfosFusion&&lInfosFusion.lignesCumuls&&lInfosFusion.lignesCumuls[this.SelectionLigne]===true){return;}
for(var iLigne=0;iLigne<this.lignesSelectionnees.length;iLigne++)
if(this.lignesSelectionnees[iLigne]){this.SelectionnerLigne({ligne:iLigne,selectionner:false});}
this.SelectionLigne=J;this.SelectionColonne=I;this.SelectionnerLigne({ligne:this.SelectionLigne});}
else{if(this.lignesSelectionnees[J]&&(!this.Donnees||this.Donnees._avecDeselection(J,I))){this.SelectionnerLigne({ligne:J,selectionner:false});this.SelectionLigne= -1;this.SelectionColonne= -1;}
else{this.SelectionnerLigne({ligne:J});this.SelectionLigne=J;this.SelectionColonne=I;}}
if(this.Donnees)
this.Donnees._SurSelection(this.SelectionColonne,this.SelectionLigne,true);}
GHtml.setFocus(_GetIdCellule.bind(this)((I>-1?I:0),J)+'_div');};function _getLigneOrigineDeFusionColonneDeLigneEtColonne(aLigne,aColonne){var lInfos=this._lignesFusionParColonne[aColonne+'_'+aLigne];if(lInfos){return lInfos.ligneOrigine;}
return aLigne;}
ObjetListe.prototype.SelectionnerLigne=function(aParametres){var lParametres=$.extend({ligne:-1,selectionner:true,avecScroll:false,avecEvenement:false},aParametres);var lLigne,I,lColonne,lLigneMin=Number.MAX_VALUE,lTrouverLignePourScroll=false;if(lParametres.ligne> -1){this.lignesSelectionnees[lParametres.ligne]=lParametres.selectionner;this.SelectionLigne=lParametres.ligne;if(this.Donnees){this.Donnees._SurSelectionLigne(lParametres.ligne,lParametres.selectionner);}
for(I=0;I<this.ListeTailles.length;I++){if(_estColonneVisible.bind(this)(I)){if(!lParametres.selectionner||(this.Donnees&&this.Donnees._AvecSelection(I,lParametres.ligne))){lLigne=_getLigneOrigineDeFusionColonneDeLigneEtColonne.bind(this)(lParametres.ligne,I);if(this.Donnees&&!!this.Donnees.Donnees.GetElement(lLigne))
_setStyleCellule.bind(this)(_GetIdCellule.bind(this)(I,lLigne),I,lLigne,lParametres.selectionner);if(lParametres.selectionner&&lParametres.avecScroll&&lLigne<lLigneMin){lLigneMin=lLigne;lColonne=I;lTrouverLignePourScroll=true;}}}}
if(lParametres.selectionner&&lParametres.avecScroll&&lTrouverLignePourScroll){var lJCellule=$('#'+_GetIdCellule.bind(this)(lColonne,lLigneMin).escapeJQ()),lPosition=lJCellule.position(),lScrollTopZone=GPosition.getScrollTop(this.ScrollV.GetIdZone(EGenreZoneScroll.contenu)),lZoneHeight=$('#'+this.ScrollV.GetIdZone(EGenreZoneScroll.contenu).escapeJQ()).height();if(lPosition&&((lPosition.top<lScrollTopZone)||(lPosition.top+lJCellule.height()>lScrollTopZone+lZoneHeight))){lPosition.top+=lScrollTopZone;this.ScrollV.scrollTo(lPosition.top);}}
if(lParametres.avecEvenement){_SurSelectionEvenement.bind(this)(-1,lParametres.ligne);}}};ObjetListe.prototype.ajouterElementCreation=function(aLibelle,aValeurCreation,aSansEditionLibelle){if(aLibelle){this.ListeValeurs[-1]=aValeurCreation;if(aSansEditionLibelle){_SurCreation.bind(this)(aLibelle);return;}
this._valeurEnEdition=_toString(aLibelle);this.$refreshSelf();GHtml.setFocus(this.IdEdition);this.EnCreationEvenement=false;}
else _SurCreationFin.bind(this)();return this;};function _surLigneCreationUnique(aSurClick,J){if(!aSurClick&&!GNavigateur.IsToucheEdition())
return;var LId=this.GetIdCreation(-1,J);GHtml.setDisplay(LId+'_Creation',false);GHtml.setDisplay(LId+'_Creation_Edit',true);_SurCreationDeb.bind(this)(false);}
function _SurCreationDeb(ASuivant){if(this._options.nonEditable||(this.Donnees===null)||this.Donnees===undefined) return;if(this.PositionCreation===0)
this.ListeValeurs=[];var lInterrompreCreation=false;if(!this.EnCreation||ASuivant){this.CreationColonne=this.ListeCreations[this.PositionCreation++];var I=this.CreationColonne;var J= -1;this.EnCreationEvenement=_SurCreationEvenement.bind(this)(I);if(this.EnCreationEvenement===EGenreEvenementListe.Creation){lInterrompreCreation=true;}
if(this.Donnees._AvecMenuContextuel(I,J)){_ouvrirMenuContextuel.bind(this)(I,J);lInterrompreCreation=true;}
if(lInterrompreCreation){var LId=this.GetIdCreation(-1,J);GHtml.setDisplay(LId+'_Creation_Edit',false);GHtml.setDisplay(LId+'_Creation',true);return;}
this.SurSelection(-1,-1);this.EnCreation=true;this.Donnees.setEnCreation(true);this.IdCellule=this.GetIdCreation(this.ListeCreations.length===1?0:this.CreationColonne,this.CreationLigneBis===null||this.CreationLigneBis===undefined?this.CreationLigne:this.CreationLigneBis);_Entrer_Edition.bind(this)();switch(this.Donnees._GetTypeValeur(I,J)){case this.Donnees.ETypeCellule.ZoneTexte:_Entrer_ZoneTexte.bind(this)(I,undefined,true);break;default:_Entrer_Texte.bind(this)(I,undefined,true);break;}
if(!this.EnCreationEvenement){GHtml.setFocusEdit(this.IdEdition);GHtml.setCursorAtEnd(this.IdEdition);}}}
function _SurCreationFin(ASelectionLigne){if(this.EnCreation){this.Donnees._SurApresCreation(ASelectionLigne);this.PositionCreation=0;this.CreationLigne=this.CreationLigneInitial;this.CreationLigneBis=null;this.EnCreation=false;this.EnCreationEvenement=false;this.Donnees.setEnCreation(false);this.Actualiser(false,false);this.SurSelection(-1,ASelectionLigne);_SurSelectionEvenement.bind(this)(-1,ASelectionLigne);GHtml.setFocus(this.Nom+'_recupnavigation');if(GNavigateur.IsToucheEchap()&&ASelectionLigne=== -1)
GHtml.setFocus(this.IdPremierElement);else GHtml.setFocus(_GetIdCellule.bind(this)(0,ASelectionLigne)+'_div');if(ASelectionLigne!== -1){_SurApresCreationEvenement.bind(this)();}
else{_SurApresErreurCreationEvenement.bind(this)();}}}
function _SurCreation(aValeur){if(this._fenetreInformationAffichee) return;if(this._messageEnCoursSurCreation) return;if(!this.EnCreation) return;delete this._valeurEnEdition;var lColonne=this.CreationColonne,lLigne= -1;if((aValeur!==null&&aValeur!==undefined)&&aValeur!==''){this.ListeValeurs[lColonne]=aValeur;if(this.ListeCreations[this.PositionCreation]===null||this.ListeCreations[this.PositionCreation]===undefined){lLigne=this.Donnees._SurCreation(this.ListeValeurs,this.CreationLigneBis===null||this.CreationLigneBis===undefined?this.CreationLigne:this.CreationLigneBis);this._messageEnCoursSurCreation=true;try{_afficherMessage.bind(this)();} finally{delete this._messageEnCoursSurCreation;}}
else{this.EnCreation=false;_setStyleCellule.bind(this)(this.IdCellule,lColonne,lLigne,false,true);if(MethodesObjet.isString(aValeur))
GHtml.setHtml(this.IdCellule,aValeur);_SurCreationDeb.bind(this)(true);return;}}
_SurCreationFin.bind(this)(lLigne);}
ObjetListe.prototype.setCreationLigne=function(aCreationLigneBis){this.CreationLigneBis=aCreationLigneBis;this.Actualiser(false,false);_surLigneCreationUnique.bind(this)(true,this.CreationLigneBis);_SurCreationDeb.bind(this)();};function _SurDeploiement(aEvent,I,J){if(this.EnCreation||this.EnEdition) return;if(GNavigateur.getBoutonSouris(aEvent)===EGenreBoutonSouris.Droite)
return;var LDonnee=this.Donnees.Donnees.GetElement(J);if(this.Donnees._AvecDeploiement()&&this.Donnees._AvecDeploiementSurColonne(I,J)&&LDonnee.estUnDeploiement&&(this.Donnees._GetTypeValeur(I,J)!==this.Donnees.ETypeCellule.Coche)&&(this.Donnees._GetTypeValeur(I,J)!==this.Donnees.ETypeCellule.CocheTriple)){this.Donnees.surDeploiement(I,J,LDonnee);this.Actualiser(false,true);if(this.Donnees._AvecEvenement_Deploiement(I,J)){this.Evenement.call(this.Pere,EGenreEvenementListe.Deploiement,I,J,this.Donnees._getDonnee(J));if(this.Pere&&this.Pere.$refreshSelf) this.Pere.$refreshSelf();}}}
ObjetListe.prototype.demarrerEditionSurCellule=function(aLigne,aColonne){_SurEditionDeb.bind(this)(aColonne,aLigne);return this;};function _SurEditionDeb(I,J){if(this._options.nonEditable) return;if((this.Donnees._AvecEdition(I,J)||this.Donnees._AvecEvenement_Edition(I,J))&&!this.EnEdition){if(this.Donnees._AvecEvenement_Edition(I,J)){this.enEditionEvenement=true;this.Evenement.call(this.Pere,EGenreEvenementListe.Edition,I,J,this.Donnees._getDonnee(J));if(this.Pere&&this.Pere.$refreshSelf) this.Pere.$refreshSelf();} else{this.EnEdition=true;this.IdCellule=_GetIdCellule.bind(this)(I,J);_Entrer_Edition.bind(this)();switch(this.Donnees._GetTypeValeur(I,J)){case this.Donnees.ETypeCellule.ZoneTexte:{_Entrer_ZoneTexte.bind(this)(I,J,false);break;}
case this.Donnees.ETypeCellule.Coche:{_SurEdition.bind(this)(I,J,'coche');break;}
case this.Donnees.ETypeCellule.CocheTriple:{_SurEdition.bind(this)(I,J,'coche');break;}
case this.Donnees.ETypeCellule.DateCalendrier:{_Entrer_DateCalendrier.bind(this)(I,J);break;}
default:{_Entrer_Texte.bind(this)(I,J,false);break;}}
if(!MethodesTableau.existe(this.Donnees._GetTypeValeur(I,J),[this.Donnees.ETypeCellule.Coche,this.Donnees.ETypeCellule.CocheTriple,this.Donnees.ETypeCellule.DateCalendrier])){GHtml.setFocus(this.IdEdition);GHtml.getElement(this.IdEdition).select();}}}}
function _SurEdition(I,J,aValeur){if(this._fenetreInformationAffichee) return;if(this.EnEdition||this.enEditionEvenement){delete this._valeurEnEdition;if(this.Donnees._Edition_Confirmation(I,J))
GApplication.getMessage().afficher({type:EGenreBoiteMessage.Confirmation,message:this.Donnees.GetMessage(),callback:_SurEditionApresConfirmation.bind(this,I,J,aValeur)});else _SurEditionApresConfirmation.bind(this)(EGenreAction.Valider,I,J,aValeur);}}
function _SurEditionApresConfirmation(AAccepte,I,J,aValeur){if(AAccepte===EGenreAction.Valider){if(((aValeur!==null&&aValeur!==undefined)||this.Donnees._GetTypeValeur(I,J)===this.Donnees.ETypeCellule.DateCalendrier)&&(aValeur!==''||this.Donnees._autoriserChaineVideSurEdition(I,J))){J=this.Donnees._SurEdition(I,J,aValeur);if(!this._messageEnCoursDAffichage){this._messageEnCoursDAffichage=true;_afficherMessage.bind(this)();delete this._messageEnCoursDAffichage;}}
this.SurEditionFin(I,J);} else this.EnEdition=false;}
ObjetListe.prototype.SurEditionFin=function(aColonne,aLigne,aSansDeslection){if(this.EnEdition||this.enEditionEvenement){this.EnEdition=false;this.enEditionEvenement=false;this.Actualiser(true,false);if(aSansDeslection!==true)
this.SurSelection(aColonne,aLigne);var lElement=GHtml.getElement(this.Nom+'_recupnavigation');if(GHtml.elementExiste(lElement))
GHtml.setFocus(lElement);lElement=GHtml.getElement(_GetIdCellule.bind(this)(aColonne,aLigne)+'_div');if(GHtml.elementExiste(lElement))
GHtml.setFocus(lElement);}
if(aColonne!== -1){_SurApresEditionEvenement.bind(this)(aLigne,aColonne);}};function _SurSuppressionDeb(J,aEvent){if(this._options.AvecSuppression&&this.Donnees._AvecSuppression(J)&&!this.EnSuppression&&!this.EnEdition&&!GNavigateur.isTactile){this.EnSuppression=true;var lLibelleSuppression=this.Donnees._GetLibelleSupression(J);if(!lLibelleSuppression){var lColonne=((lLibelleSuppression===null||lLibelleSuppression===undefined)&&this.ListeCreations)?this.ListeCreations[0]:0;lLibelleSuppression=this.Donnees._GetValeur(lColonne||0,J);}
if(!lLibelleSuppression)
lLibelleSuppression='&nbsp;';new IEClasses.Fantome({id:this.idZone,libelle:lLibelleSuppression,callbackFin:_surSuppressionFantome.bind(this),positionX:aEvent.pageX,positionY:aEvent.pageY});}}
function _surSuppressionFantome(aDansZone){this.EnSuppression=false;if(!aDansZone){this.SurSuppression();}}
ObjetListe.prototype.SurSuppression=function(){if(this._options.AvecSuppression&&(this.SelectionLigne> -1)){if(this.Donnees._Suppression_Impossible(this.SelectionLigne))
_afficherMessage.bind(this)();else if(this.Donnees._Suppression_Confirmation(this.SelectionLigne)){GApplication.getMessage().Afficher(EGenreBoiteMessage.Confirmation,null,this.Donnees.GetMessage(),null,this,_SurSuppressionApresConfirmation.bind(this));}
else{_SurSuppressionApresConfirmation.bind(this)(EGenreAction.Valider);}
this.EnSuppression=false;}};function _SurSuppressionApresConfirmation(AAccepte){if(AAccepte===EGenreAction.Valider){_SurSuppressionEvenement.bind(this)(this.SelectionLigne);this.SelectionLigne=this.Donnees._SurSuppression(this.SelectionLigne);this.Actualiser(false,false);if(this.Donnees._AvecEtatSaisie())
this.SetEtatSaisie(true);_SurApresSuppressionEvenement.bind(this)();}
GHtml.setFocus(this.IdPremierElement);}
function _GetIdCellule(I,J){return this.Nom+'_'+I+(J===null||J===undefined?'':'_'+J);}
ObjetListe.prototype.GetIdCreation=function(I,J){return this.Nom+'_Creation_'+I+(J===null||J===undefined?'':'_'+J);};ObjetListe.prototype.GetSelection=function(){return this.SelectionLigne;};ObjetListe.prototype.getListeElementsSelection=function(){var lSelections=new ObjetListeElements();if(this.lignesSelectionnees)
for(var i=0;i<this.lignesSelectionnees.length;i++)
if(this.lignesSelectionnees[i]){var lElement=this.Donnees.Donnees.GetElement(i);if(lElement)
lSelections.AddElement(lElement);}
return lSelections;};ObjetListe.prototype.getListeElementsCoches=function(){if(this.Donnees){return this.Donnees.Donnees.getListeElements(function(aElement,aIndice){return aElement.cmsActif;});}
else return new ObjetListeElements();};ObjetListe.prototype.setListeElementsSelection=function(aListeElements,aInstancesIdentiques){if(!aListeElements){return;}
var iLigne,lNb=this.Donnees.GetNbrLignes(),lElement,lElementTrouve;for(iLigne=0;iLigne<lNb;iLigne++){if(this.lignesSelectionnees[iLigne]&&!this.Donnees.estVisible(iLigne)){this.lignesSelectionnees[iLigne]=false;this.SelectionLigne= -1;}}
for(iLigne=0;iLigne<lNb;iLigne++){if(this.Donnees.estVisible(iLigne)){lElement=this.Donnees.Donnees.GetElement(iLigne);lElementTrouve=false;if(aInstancesIdentiques){lElementTrouve=!!(lElement&&IE.MethodesTableau.existe(lElement,aListeElements.ListeElements));}
else{lElementTrouve=lElement?aListeElements.GetElementParElement(lElement):false;}
if(this.lignesSelectionnees[iLigne]&&!lElementTrouve){this.SelectionnerLigne({ligne:iLigne,selectionner:false});}
else if(lElementTrouve){this.SelectionnerLigne({ligne:iLigne});}}}};function _estColonneVisible(aNumeroColonne){return this._donneesColonnes.tableauColonnesCachees[aNumeroColonne]!==true;}
function _calculColonnesCachees(){this.colonnesCachees=[];if(!MethodesObjet.isArray(this._options.colonnesCachees)&&isFinite(this._options.colonnesCachees)){this.colonnesCachees.push(this._options.colonnesCachees);}
else if(MethodesObjet.isArray(this._options.colonnesCachees)){this.colonnesCachees=this.colonnesCachees.concat(this._options.colonnesCachees);}
this.colonnesCachees.sort();this._donneesColonnes.numeroDerniereColVisible=0;this._donneesColonnes.nbColonnesCachees=0;this._donneesColonnes.tableauVisibiliteColonnes=[];if(this.ListeTailles)
for(var I=0;I<this.ListeTailles.length;I++)
if(MethodesTableau.chercher(I,this.colonnesCachees)=== -1){this._donneesColonnes.numeroDerniereColVisible=I;delete this._donneesColonnes.tableauColonnesCachees[I];this._donneesColonnes.tableauVisibiliteColonnes.push(I);}
else{this._donneesColonnes.tableauColonnesCachees[I]=true;this._donneesColonnes.nbColonnesCachees++;}}
ObjetListe.prototype.setColonnesCachees=function(aColonnes){this.setOptionsListe({colonnesCachees:aColonnes},true);};ObjetListe.prototype.getColonnesCachees=function(){return this.colonnesCachees;};ObjetListe.prototype.setColonnesVisibles=function(aColonnes){var lColonnesArray=[];for(var i=0;i<this.ListeTailles.length;i++){if(IE.MethodesTableau.chercher(i,aColonnes)=== -1){lColonnesArray.push(i);}}
this.setColonnesCachees(lColonnesArray);};ObjetListe.prototype.setEditable=function(aEditable){this._options.nonEditable=!aEditable;if(this._options.nonEditable)
this._options.AvecSuppression=false;};ObjetListe.prototype._evenementScroll=function(aGenre,aScrollTop){if(aGenre===EGenreScrollEvenement.TailleZone){if(this._options.hauteurAdapteContenu&&this._options.hauteurLimiteContenu!==true){aScrollTop=$(GHtml.getElement(this.ScrollV.GetIdContenu(EGenreZoneScroll.contenu))).outerHeight();if(IE.MethodesObjet.isNumber(this._options.hauteurLimiteContenu)){aScrollTop=Math.min(aScrollTop,this._options.hauteurLimiteContenu);}}
else{aScrollTop=_getHauteurConteneur.bind(this)()+(this.Donnees&&(this.nbLignesVisibles>this._options.nbLignesMax)?-ObjetListe._CONST_hauteurZonePagination:0);}
if(this._options.hauteurContenuListeMin=== -1){if(this.nbLignesVisibles>0){aScrollTop=Math.max(aScrollTop,$('#'+_GetIdCellule.bind(this)(0,0).escapeJQ()).outerHeight());}}
else{aScrollTop=Math.max(aScrollTop,this._options.hauteurContenuListeMin);}}
if(aGenre===EGenreScrollEvenement.TailleContenu&&!this._options.hauteurAdapteContenu){var lHauteurContenu=$(GHtml.getElement(this.ScrollV.GetIdContenu(EGenreZoneScroll.contenu))).outerHeight();if(this.ScrollV.TailleZone>lHauteurContenu)
aScrollTop=this.ScrollV.TailleZone;}
switch(aGenre){case EGenreScrollEvenement.Deplacement:return aScrollTop;case EGenreScrollEvenement.TailleZone:return aScrollTop;case EGenreScrollEvenement.TailleContenu:return aScrollTop;}};function _getLargeurMaxZone(){return this._donneesColonnes.largeurPage-this.ScrollV.Largeur-1-this._options.borduresContenu_left-this._options.borduresContenu_right;}
function _getLargeurConteneur(){this._donneesColonnes.reserverPlaceScrollHorizontal=false;var lLargeur=this._donneesColonnes.largeurTotalCalcule+
this.ScrollV.Largeur+
1+
this._options.borduresContenu_left+
this._options.borduresContenu_right;if(this._options.avecScrollHorizontal){this._donneesColonnes.reserverPlaceScrollHorizontal=this._options.avecReservationPlaceScrollHorizontal||lLargeur>this._donneesColonnes.largeurPage;lLargeur=Math.min(lLargeur,this._donneesColonnes.largeurPage);}
return lLargeur;}
ObjetListe.prototype._evenementScrollH=function(aGenre,aScrollLeft){switch(aGenre){case EGenreScrollEvenement.Deplacement:case EGenreScrollEvenement.TailleContenu:return aScrollLeft;case EGenreScrollEvenement.TailleZone:var lTaille=this._donneesColonnes.largeurTotalCalcule,lTailleMax=_getLargeurMaxZone.bind(this)(),i,lInc;if(lTaille>lTailleMax){lTaille=0;for(i=0;i<this.Tailles.length;i++){if(_estColonneVisible.bind(this)(i)){lInc=this.Tailles[i]+4+1;if(lTaille+lInc>lTailleMax){break;}
lTaille+=lInc;}}
lTaille-=1;}
return lTaille;}};ObjetListe.prototype.getScrollPosition=function(){return this.ScrollV.GetPosition();};ObjetListe.prototype.setScrollPosition=function(aPosition){this.ScrollV.scrollTo(aPosition);};})();;
function TypeChaineBrute(aChaineBrute){this.chaineBrute=IE.MethodesObjet.isString(aChaineBrute)?aChaineBrute:'';}
TypeChaineBrute.prototype.toJSON=function(){var lJSON={};lJSON[IE.ObjetJSON.const_champ_Type]=EGenreType.ChaineBrute;lJSON[IE.ObjetJSON.const_champ_Valeur]=this.chaineBrute;return lJSON;};;
function TypeFichierBase64(aDonneesBase64){this.donneesBase64=aDonneesBase64;}
TypeFichierBase64.prototype.toJSON=function(){var lJSON={};lJSON[IE.ObjetJSON.const_champ_Type]=EGenreType.FichierBase64;lJSON[IE.ObjetJSON.const_champ_Valeur]=this.donneesBase64;return lJSON;};;
function ObjetSerialiser(){}
ObjetSerialiser.prototype.executionQCM=function(aElement,aJSON){aJSON.QCM=aElement.QCM.toJSON();aJSON.dateDebutPublication=aElement.dateDebutPublication;aJSON.dateFinPublication=aElement.dateFinPublication;aJSON.modeQuestionnaire=aElement.modeQuestionnaire;aJSON.autoriserLaNavigation=aElement.autoriserLaNavigation;aJSON.modeDiffusionCorrige=aElement.modeDiffusionCorrige;aJSON.nombreQuestionsSoumises=aElement.nombreQuestionsSoumises;aJSON.melangerLesQuestions=aElement.melangerLesQuestions;aJSON.melangerLesReponses=aElement.melangerLesReponses;aJSON.dureeMaxQCM=aElement.dureeMaxQCM;aJSON.ressentiRepondant=aElement.ressentiRepondant;aJSON.publierCorrige=aElement.publierCorrige;aJSON.tolererFausses=aElement.tolererFausses;aJSON.acceptIncomplet=aElement.acceptIncomplet;return aElement.PourValidation();};ObjetSerialiser.prototype.QCM=function(aElement,aJSON){var lResult=aElement.PourValidation();aJSON.matiere=aElement.matiere;aJSON.niveau=aElement.niveau;aJSON.statutPrive=aElement.statutPrive;aJSON.autoriserLaNavigation=aElement.autoriserLaNavigation;aJSON.modeDiffusionCorrige=aElement.modeDiffusionCorrige;aJSON.nombreQuestionsSoumises=aElement.nombreQuestionsSoumises;aJSON.melangerLesQuestions=aElement.melangerLesQuestions;aJSON.melangerLesReponses=aElement.melangerLesReponses;aJSON.dureeMaxQCM=aElement.dureeMaxQCM;aJSON.ressentiRepondant=aElement.ressentiRepondant;aJSON.tolererFausses=aElement.tolererFausses;aJSON.acceptIncomplet=aElement.acceptIncomplet;if(lResult&&aElement.contenuQCM&&aElement.contenuQCM.typeNumerotation){aJSON.typeNumerotation=aElement.contenuQCM.typeNumerotation;}
if(aElement.contenuQCM&&aElement.contenuQCM.listeQuestions){aElement.contenuQCM.listeQuestions.setSerialisateurJSON({ignorerEtatsElements:false,methodeSerialisation:this.questionQCM.bind(this),nePasTrierPourValidation:true});aJSON.listeQuestions=aElement.contenuQCM.listeQuestions;aJSON.typeNumerotation=aElement.contenuQCM.typeNumerotation;lResult=lResult||aElement.contenuQCM.listeQuestions.existeElementPourValidation();}
return lResult;};ObjetSerialiser.prototype.questionQCM=function(aElement,aJSON){var lResult=aElement.PourValidation();aJSON[IE.ObjetJSON.const_champ_Position]=aElement.GetPosition();aJSON.nouvellePosition=aElement.nouvellePosition;aJSON.enonce=new TypeChaineBrute(aElement.enonce);aJSON.note=aElement.note;aJSON.editeur=aElement.editeur;aJSON.image=new TypeFichierBase64(aElement.image);aJSON.mp3name=aElement.mp3name;aJSON.mp3=new TypeFichierBase64(aElement.mp3);aJSON.url=aElement.url;aJSON.casesensitive=aElement.casesensitive;if(aElement.listeReponses){aElement.listeReponses.setSerialisateurJSON({ignorerEtatsElements:false,methodeSerialisation:this.reponseQCM.bind(this),nePasTrierPourValidation:true});aJSON.listeReponses=aElement.listeReponses;lResult=lResult||aElement.listeReponses.existeElementPourValidation();}
return lResult;};ObjetSerialiser.prototype.reponseQCM=function(aElement,aJSON){aJSON[IE.ObjetJSON.const_champ_Position]=aElement.GetPosition();aJSON.association=aElement.association;aJSON.feedback=aElement.feedback;aJSON.bonneReponse=aElement.bonneReponse;aJSON.editionAvancee=aElement.editionAvancee;if(aJSON.editionAvancee===true) aJSON.libelleHtml=new TypeChaineBrute(aElement.libelleHtml);aJSON.image=new TypeFichierBase64(aElement.image);};ObjetSerialiser.prototype.listeFichiers=function(aXml,aNoeud,aListePJ){aXml.CreerListeElements(aNoeud,'ListeFichiers','Fichier',aListePJ,this,this._surValidation_Fichier);};ObjetSerialiser.prototype._surValidation_Fichier=function(aXml,aNoeud,aElement){var lIdFichier=aElement.idFichier!==undefined?aElement.idFichier:(aElement.Fichier!==undefined?aElement.Fichier.idFichier:null);if(lIdFichier!==null){aXml.CreerVariable(aNoeud,'IDFichier',EGenreType.String,GChaine.CardinalToStr(lIdFichier));}};ObjetSerialiser.prototype.listePJ=function(aXml,aNoeud,aListePJ){aXml.CreerListeElements(aNoeud,'ListeDocumentsJoints','DocumentJoint',aListePJ);};;
MethodesObjet.heritagePrototype(ObjetBandeau,Identite);function ObjetBandeau(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.Libelle='';this.focusable=false;this.IdPremierElement=this.Nom+'_Libelle';}
ObjetBandeau.prototype.getControleur=function(){return{getLibelle:function(){return this.instance.Libelle;},getInfosBulle:function(){return this.instance.title||'';}};};ObjetBandeau.prototype.ConstruireAffichage=function(){var H=[];H.push('<table class="AlignementHaut" border="0" width="100%" height="20px" cellspacing="0" cellpadding="0">');H.push('<tr style="',GStyle.composeCouleur(GCouleur.bandeau.fond,GCouleur.bandeau.texte),'">');H.push('<td id="'+this.Nom+'_Libelle" class="Texte10 Gras Insecable" ie-html="getLibelle" ie-hint="getInfosBulle" tabIndex="-1">');H.push('</td>');H.push('</tr></table>');return H.join('');};ObjetBandeau.prototype.SetParametres=function(ALibelle){this.Libelle=''+ALibelle;if(this.Libelle) this.activerFocusable();else this.desactiverFocusable();this.$refreshSelf();};ObjetBandeau.prototype.SetLibelle=function(ALibelle){this.SetParametres(ALibelle);};ObjetBandeau.prototype.setInfoBulle=function(ALibelle){this.title=ALibelle;this.$refreshSelf();};;
var EGenreDocumentJoint={Url:0,Fichier:1,Cloud:2};EGenreDocumentJoint.getUrl=function(aRessource,aGenre){switch(aRessource.GetGenre()){case(EGenreDocumentJoint.Fichier):return GChaine.GetChainePourUrl(GApplication.getCommunication().composeUrlFichierExterne(aRessource.GetLibelle(),new ObjetElement('',aRessource.GetNumero(),aGenre)),true);case(EGenreDocumentJoint.Cloud):return aRessource.url;case(EGenreDocumentJoint.Url):return GChaine.GetChainePourUrl(GChaine.verifierURLHttp(aRessource.GetLibelle()),false);}};;
function ObjetRequeteNavigation(aPere,aEvenementSurReussite,aEvenementSurEchec){this.inheritedCreate(aPere,aEvenementSurReussite,false);}
IE.Requetes.inscrire('Navigation',ObjetRequeteNavigation,_ObjetRequeteXmlConsultationPN);ObjetRequeteNavigation.prototype.lancerRequete=function(aOnglet){this.JSON.onglet=aOnglet;GApplication.parametresUtilisateur.set('onglet',aOnglet,true);this.appelAsynchroneConsultation();};ObjetRequeteNavigation.prototype.actionApresRequete=function(aXml){this.callbackReussite.appel();};;
function ObjetRequeteSSONathan(aPere,aEvenementSurReussite,aEvenementSurEchec){this.inheritedCreate(aPere,aEvenementSurReussite,aEvenementSurEchec);}
IE.Requetes.inscrire('SSONathan',ObjetRequeteSSONathan,_ObjetRequeteXmlConsultationPN);ObjetRequeteSSONathan.prototype.lancerRequete=function(aEANManuel){if(aEANManuel)
this.JSON.EAN=aEANManuel;this.appelAsynchroneConsultation();};ObjetRequeteSSONathan.prototype.actionApresRequete=function(){this.callbackReussite.appel(this.JSONReponse.UrlSSO);};;
IE.Enum.EGenreMessageHtml={patiencePDF:'patiencePDF',patiencePDF_Mobile:'patiencePDF_mobile',patienceNathan:'patienceNathan',deconnexionENT:'deconnexionENT',deconnexionENT_Mobile:'deconnexionENT_Mobile'};IE.UtilitaireMessageHtml={construireUrl:function(aGenreMessageHtml){var lUrl='message.html';if(aGenreMessageHtml)
lUrl+='?G='+aGenreMessageHtml;return lUrl;}};;
function ObjetRequeteGenerationPDF(aPere,aEvenementSurReussite,aEvenementSurEchec){this.inheritedCreate(aPere,aEvenementSurReussite,aEvenementSurEchec);}
IE.Requetes.inscrire('GenerationPDF',ObjetRequeteGenerationPDF,_ObjetRequeteXmlConsultationPN);ObjetRequeteGenerationPDF.prototype.lancerRequete=function(aParametres,aOptionsPDF){this.JSON={options:{}};$.extend(this.JSON,aParametres);$.extend(this.JSON.options,aOptionsPDF);this.appelAsynchroneConsultation();};ObjetRequeteGenerationPDF.prototype.actionApresRequete=function(){this.callbackReussite.appel(this.JSONReponse.url);};;
IE.GenerationPDF={};(function(){IE.GenerationPDF.genererPDF=function(aParam){var lWindowPDF=null,lParametresPDF=aParam.paramPDF,lAvecProblemeOuvertureWindow=GNavigateur.IsIE8||GNavigateur.isAndroid;if(!lAvecProblemeOuvertureWindow){lWindowPDF=window.open(IE.UtilitaireMessageHtml.construireUrl(IE.Enum.EGenreMessageHtml.patiencePDF));}
new ObjetRequeteGenerationPDF(this,_actionSurRequeteGenerationPDF.bind(this,lAvecProblemeOuvertureWindow,lWindowPDF),_surEchecRequetePDF.bind(this,lWindowPDF)).lancerRequete(lParametresPDF,aParam.optionsPDF);};function _actionSurRequeteGenerationPDF(aAvecProblemeOuvertureWindow,aWindowPDF ,aUrl){var lUrl=GChaine.GetChainePourUrl(aUrl,true);if(!aAvecProblemeOuvertureWindow){if(aWindowPDF&&aWindowPDF.location)
aWindowPDF.location.href=lUrl;else window.open(lUrl);}
else{IE.Invocateur.evenement('OuvrirFenetreLienPDF',lUrl);}}
function _surEchecRequetePDF(aWindowPDF ,aMessage){var lMessage=aMessage&&(aMessage.length>0)?aMessage:GTraductions.getValeur('requete.erreur');GApplication.getMessage().Afficher(EGenreBoiteMessage.Information,null,lMessage);if(aWindowPDF&&aWindowPDF.close){aWindowPDF.close();}}})();;
var EGenreAffichageCahierDeTextes={TravailAFaire:0,ContenuDeCours:1,QCM:2,CahierDeTextes:3};;
var EGenreEvntMenusDeroulants={surOuvertureCombo:0,ressourceNonTrouve:1};;
MethodesObjet.heritagePrototype(ObjetInterfacePage,ObjetAbstraitInterface);function ObjetInterfacePage(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this._idAddZoneBandeau=IE.GUID.getId();}(function(){ObjetInterfacePage.prototype.SortirEtatCourantDAffichage=function(){};ObjetInterfacePage.prototype.getPrioriteAffichageBandeauLargeur=function(){return[window.ObjetCheckBox,window.ObjetBandeau,window.ObjetAffichagePageAvecMenusDeroulants];};function _getInfosSurZone(aIndice){var lElement=this.AddSurZone[aIndice];return $.extend({ident:lElement&&(lElement.html||lElement.separateur)?null:lElement,html:null,controleur:null,delegerControleVisibilite:lElement&&lElement.separation?false:true,alignementDroite:false,separateur:false},lElement);}
ObjetInterfacePage.prototype.ConstruireStructureAffichageBandeau=function(){var lHTML=[];var lGenre,lGenrePourLargeurComplete;var lAlignementDroite=true;var lExisteGenre=[];var I,lInfos,lInfosSurZone=[];for(I=0;I<this.AddSurZone.length;I++){lInfosSurZone.push(_getInfosSurZone.call(this,I));}
for(I=0;I<this.AddSurZone.length;I++){lInfos=lInfosSurZone[I];if(lInfos.ident!==undefined&&lInfos.ident!==null){lGenre=this.GenreAffichage[lInfos.ident];lExisteGenre[lGenre]=true;}
lAlignementDroite=lAlignementDroite&&lInfos.alignementDroite;}
var lOrdreGenre=this.getPrioriteAffichageBandeauLargeur();for(I in lOrdreGenre){lGenre=lOrdreGenre[I];if((lGenrePourLargeurComplete===null||lGenrePourLargeurComplete===undefined)&&lExisteGenre[lGenre])
lGenrePourLargeurComplete=lGenre;}
lHTML.push('<table style="width:100%;height: ',GApplication.hauteurBandeau,'px;" border="0" cellpadding="0" cellspacing="0" ',GObjetWAI.composeRole(EGenreRole.Presentation),'><tr>');if(lAlignementDroite&&this.AddSurZone.length>0){lHTML.push('<td style="width:100%"></td>');}
for(I=0;I<this.AddSurZone.length;I++){lInfos=lInfosSurZone[I];lGenre=lInfos.ident!==undefined&&lInfos.ident!==null?this.GenreAffichage[lInfos.ident]:null;if(lInfos.separateur)
lHTML.push('<td style="width:100%"></td>');else if(this.Instances[lInfos.ident]||lInfos.html)
lHTML.push('<td id="',lInfos.html?this._idAddZoneBandeau+I:this.Instances[lInfos.ident].GetNom(),'" class="PetitEspaceDroit '+(lGenre===window.ObjetCheckBox?'AlignementMilieu':'AlignementGauche')+'" style="width: '+(lGenre===lGenrePourLargeurComplete?'100%':'10px')+'">',lInfos.html&&!lInfos.controleur?lInfos.html:'','</td>');if(lGenre===window.ObjetCheckBox)
this.GetInstance(lInfos.ident).setParametres_Affichage('Texte10 Gras',null,'margin:auto;');}
if(lGenrePourLargeurComplete===undefined)
lHTML.push('<td style="width:100%"></td>');lHTML.push('</tr></table>');GHtml.setDisplay(GApplication.idLigneBandeau,true);GHtml.setHtml('bandeau',lHTML.join(''),{controleur:this.controleur});for(I=0;I<this.AddSurZone.length;I++){lInfos=lInfosSurZone[I];if(lInfos.controleur)
GHtml.setHtml(this._idAddZoneBandeau+I,lInfos.html,{controleur:lInfos.controleur});}
if(this.Pere&&this.Pere.surResizeInterface)
this.Pere.surResizeInterface();this.surResizeInterface();return'';};ObjetInterfacePage.prototype.setBandeau=function(aHtml){GHtml.setDisplay(GApplication.idLigneBandeau,true);GHtml.setHtml('bandeau',aHtml,{controleur:this.controleur});if(this.Pere&&this.Pere.surResizeInterface)
this.Pere.surResizeInterface();this.surResizeInterface();};ObjetInterfacePage.prototype.afficherBandeau=function(aAfficher){var lIdent,lInfos;for(var I in this.AddSurZone){lInfos=_getInfosSurZone.call(this,I);if(lInfos.delegerControleVisibilite){lIdent=lInfos.ident!==undefined&&lInfos.ident!==null?lInfos.ident:null;if(lInfos.html){GStyle.setVisible(this._idAddZoneBandeau+I,aAfficher);}
else if(this.Instances[lIdent]&&(!MethodesTableau.existe(this.GenreAffichage[lIdent],[window.ObjetAffichagePageAvecMenusDeroulants,window.ObjetSaisiePN]))){GStyle.setVisible(this.Instances[lIdent].GetNom(),aAfficher);}}}};ObjetInterfacePage.prototype.afficherMessage=function(aMessage){GHtml.setHtml(this.idPage,this.composeMessage(aMessage));};ObjetInterfacePage.prototype._EvenementAfficherMessage=function(AGenreMessage){this.afficherBandeau(false);if(this.Instances[this.IdentZoneAlClient]){var LMessage=typeof(AGenreMessage)==='number'?GTraductions.getValeur('Message')[AGenreMessage]:AGenreMessage;this.Instances[this.IdentZoneAlClient].effacer(this.composeMessage(LMessage));this.Instances[this.IdentZoneAlClient].IdPremierElement=this.idMessageActionRequise;}};ObjetInterfacePage.prototype.EvenementAfficherMessage=function(aGenreMessage){window.Invocateur.evenement(window.Invocateur.events.activationImpression,EGenreImpression.Aucune);this._EvenementAfficherMessage(aGenreMessage);};ObjetInterfacePage.prototype.construireFicheEleveEtFichePhoto=function(){if(this.avecFicheEleve()){this.identBtnFicheEleve=this.Add(window.ObjetBoutonBandeau,this.evtSurBtnFicheEleve,this.initialiserBtnFicheEleve);this.identFenetreFicheEleve=this.Add(window.ObjetFenetre_FicheEleve,null,this.initialiserFenetreFicheEleve);if(GApplication.droits.get(IEEnum.droits.eleves.consulterPhotosEleves)){this.identBtnFichePhoto=this.Add(window.ObjetBoutonBandeau,this.evtSurBtnFichePhoto,this.initialiserBtnPhotoEleve);this.identFichePhoto=this.Add(window.ObjetFichePhotos);}}};ObjetInterfacePage.prototype.estUnOngletAvecFicheEleve=function(aOnglet){var lListeOngletsAvecFicheEleve=[
EGenreOnglet.Bulletins,EGenreOnglet.Dossiers,EGenreOnglet.FicheBrevet,EGenreOnglet.FicheScolaire,EGenreOnglet.LivretScolaire_Fiche,EGenreOnglet.Releve,EGenreOnglet.SaisieAbsences_AppelEtSuivi,EGenreOnglet.SaisieAbsences_Appel,EGenreOnglet.SaisieAbsences_Appel_Professeur,EGenreOnglet.SaisieAppreciationsBulletin,EGenreOnglet.SaisieAppreciationsFicheBrevet,EGenreOnglet.SaisieAppreciationsGenerales,EGenreOnglet.SaisieAppreciationsReleve,EGenreOnglet.SaisieNotes,EGenreOnglet.SaisieAppreciationDeFinDeStage,EGenreOnglet.SuivisAbsenceRetard,EGenreOnglet.ListeEleves
];return MethodesTableau.existe(aOnglet,lListeOngletsAvecFicheEleve);};ObjetInterfacePage.prototype.estUnEspaceAvecFicheEleve=function(aEspace){var lListeEspacesAvecFicheEleve=[
EGenreEspace.Professeur,EGenreEspace.Etablissement
];return MethodesTableau.existe(aEspace,lListeEspacesAvecFicheEleve);};ObjetInterfacePage.prototype.avecFicheEleve=function(){return this.estUnEspaceAvecFicheEleve(GEtatUtilisateur.GenreEspace)&&
this.estUnOngletAvecFicheEleve(GEtatUtilisateur.getGenreOnglet())&&(GApplication.droits.get(IEEnum.droits.eleves.consulterIdentiteEleve)||GApplication.droits.get(IEEnum.droits.eleves.consulterFichesResponsables));};ObjetInterfacePage.prototype.evtSurBtnFicheEleve=function(){this._objGestionFocus_apresFenetreFicheEleve={id:this.GetInstance(this.identBtnFicheEleve).getPremierElement()};if(this.identFenetreFicheEleve){var lFenetre=this.GetInstance(this.identFenetreFicheEleve);lFenetre.SetDonnees(lFenetre.ongletParDefaut);}};ObjetInterfacePage.prototype.evtSurBtnFichePhoto=function(aGenre,aBloquerFocus){this._objGestionFocus_apresFenetreFichePhoto={id:this.GetInstance(this.identBtnFichePhoto).getPremierElement()};if(this.identFichePhoto){var lRessource=(aGenre!==undefined)?GEtatUtilisateur.Navigation.GetRessource(aGenre):null;if(lRessource!==undefined){var lUrl=GApplication.getCommunication().composeUrlFichierExterne('photo.jpg',{"N":lRessource.GetNumero(),"G":aGenre});this.GetInstance(this.identFichePhoto).SetDonnees(null,lUrl,null,aBloquerFocus);}}};ObjetInterfacePage.prototype.evtSurBtnFicheGraphe=function(){if(this.GetInstance(this.identFicheGraphe)){if(GEtatUtilisateur.getGraphe().image[0]){this.GetInstance(this.identFicheGraphe).SetDonnees(GEtatUtilisateur.getGraphe());} else{GApplication.getMessage().afficher({type:EGenreBoiteMessage.Information,titre:null,message:GEtatUtilisateur.getGraphe().message,titreBandeau:null,callback:null,avecDecalageFocusBouton:true});}}};ObjetInterfacePage.prototype.actualiserFicheGraphe=function(){if(this.GetInstance(this.identFicheGraphe)&&this.GetInstance(this.identFicheGraphe).EnAffichage){this.GetInstance(this.identFicheGraphe).SetDonnees(GEtatUtilisateur.getGraphe());}};ObjetInterfacePage.prototype.initialiserBtnFicheEleve=function(aInstance){aInstance.SetParametres('Image_ContactsPourBandeauTitre',true,false,false,[GTraductions.getValeur('FicheRenseignement'),GTraductions.getValeur('FicheRenseignement'),GTraductions.getValeur('FicheRenseignement')],20,false);};ObjetInterfacePage.prototype.initialiserBtnPhotoEleve=function(aInstance){aInstance.SetParametres('Image_PhotoPourBandeau',true,false,false,new Array(GTraductions.getValeur('VoirPhotoEleve'),GTraductions.getValeur('VoirPhotoEleve'),GTraductions.getValeur('VoirPhotoEleve')),20,false);aInstance.SetGenre(EGenreRessource.Eleve);};ObjetInterfacePage.prototype.initialiserBtnGraphe=function(aInstance){aInstance.SetParametres('Image_GrapheAraignee',true,false,true,[GTraductions.getValeur('competences.GrapheAraignee'),GTraductions.getValeur('competences.GrapheAraignee'),GTraductions.getValeur('competences.GrapheAraignee')],20,false);aInstance.SetGenre(EGenreRessource.Eleve);};ObjetInterfacePage.prototype.initialiserFenetreFicheEleve=function(aInstance){aInstance.SetParametres_Fenetre('',500,300,[GTraductions.getValeur('Fermer')],false);aInstance.setOngletParDefaut(window.ObjetFenetre_FicheEleve.genreOnglet.Identite);};ObjetInterfacePage.prototype.fermerFenetreFicheEleve=function(){if(this.fenetreFicheEleveEstAffiche()){var lFenetre=this.GetInstance(this.identFenetreFicheEleve);lFenetre.Fermer();}};ObjetInterfacePage.prototype.fermerPhotoEleve=function(){if(this.fenetrePhotoEleveEstAffiche()){var lFenetre=this.GetInstance(this.identFichePhoto);lFenetre.Fermer();}};ObjetInterfacePage.prototype.fenetreFicheEleveEstAffiche=function(){if(this.identFenetreFicheEleve){var lFenetre=this.GetInstance(this.identFenetreFicheEleve);return lFenetre.EstAffiche();}
else return false;};ObjetInterfacePage.prototype.fenetrePhotoEleveEstAffiche=function(){if(this.identFichePhoto){var lFenetre=this.GetInstance(this.identFichePhoto);return lFenetre.EstAffiche();}
else return false;};ObjetInterfacePage.prototype.surSelectionEleve=function(){this.activerFichesEleve(true);if(this.fenetreFicheEleveEstAffiche()){var lFenetre=this.GetInstance(this.identFenetreFicheEleve);if(GEtatUtilisateur.estModeAccessible()){lFenetre.Fermer();}
else lFenetre.SetDonnees(null,true);}
if(this.fenetrePhotoEleveEstAffiche()){if(GEtatUtilisateur.estModeAccessible()){this.GetInstance(this.identFichePhoto).Fermer();}
else this.evtSurBtnFichePhoto(EGenreRessource.Eleve,true);}};ObjetInterfacePage.prototype.activerFichesEleve=function(aActiver){if(this.identBtnFicheEleve) this.GetInstance(this.identBtnFicheEleve).setActif(aActiver);if(this.identBtnFichePhoto) this.GetInstance(this.identBtnFichePhoto).setActif(aActiver);if(!aActiver){this.fermerFenetreFicheEleve();this.fermerPhotoEleve();}};ObjetInterfacePage.prototype.selectionneEleveAutoDansPage=function(aIdentPage){var lTrouve=this.GetInstance(aIdentPage).selectionnerEleveCourant();this.activerFichesEleve(lTrouve);};ObjetInterfacePage.prototype.surEvntMenusDeroulants=function(aParam){switch(aParam.genreEvenement){case EGenreEvntMenusDeroulants.ressourceNonTrouve:this.surRessourceCouranteNonTrouveeDansCombo(aParam);break;}};ObjetInterfacePage.prototype.surRessourceCouranteNonTrouveeDansCombo=function(aParam){;this.activerFichesEleve(false);};ObjetInterfacePage.prototype._gestionFocus_apresFenetreFicheEleve=function(){if(this._objGestionFocus_apresFenetreFicheEleve&&this._objGestionFocus_apresFenetreFicheEleve.id)
GHtml.setFocus(this._objGestionFocus_apresFenetreFicheEleve.id);this._objGestionFocus_apresFenetreFicheEleve=null;};ObjetInterfacePage.prototype._gestionFocus_apresFenetreFichePhoto=function(){if(this._objGestionFocus_apresFenetreFichePhoto&&this._objGestionFocus_apresFenetreFichePhoto.id)
GHtml.setFocus(this._objGestionFocus_apresFenetreFichePhoto.id);this._objGestionFocus_apresFenetreFichePhoto=null;};}());;
MethodesObjet.heritagePrototype(ObjetMenuOnglets,Identite);function ObjetMenuOnglets(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.NomWrapper=this.Nom+'_Wrapper';this.NomCombo=this.Nom+'_Combo';this.NomEdit=this.Nom+'_Edit';this.NomListe=this.Nom+'_Liste';this.NomNiveau=[];this.baseNomNiveau='_niveau';this.ListeElements=null;this.listeTraitee=new ObjetListeElements();this.tabIndex=0;this.rayonArrondi=7;this.hauteurLigne=17;this.SetParametres({});GLog.setIDFiltrageLog("NAVIGATIONCLAVIER",false);GLog.setIDFiltrageLog("IDSCLAVIER",false);this._options={labelWAIcombo:'',roleWAIcombo:EGenreRole.Menu,roleWAIlist:EGenreRole.Menuitem,roleWAIlistitem:EGenreRole.Menuitem};IE.Invocateur.abonner('fermerAutresMenuOnglet',this._notificationFermer.bind(this),this);}(function(){ObjetMenuOnglets.prototype.SetParametres=function(aParam){this.avecSousMenu=!!aParam.avecSousMenu;this.avecPlusieursNiveau=!!aParam.avecPlusieursNiveau;this.masquerLibelleOnglet=!!aParam.masquerLibelleOnglet;this.niveauMaximum=aParam.niveauMaximum||100;this.largeur=null;this.largeurMaxLibelle=aParam.largeurMaxLibelle||null;this.hauteur=35;this.tabIndex=aParam.tabIndex||0;this.libelleCentre=aParam.libelleCentre||false;this.actionSurClickSiSeul=aParam.actionSurClickSiSeul||false;this.seulEtActionSurClick=false;this.bloquerCouleurOnglet=aParam.bloquerCouleurOnglet||false;this.avecCompteur=aParam.avecCompteur||false;this.totalCompteur=0;this.couleur={onglet:{background:'transparent',color:GCouleur.blanc},ongletSurvole:{background:'transparent',color:GCouleur.blanc},ongletSelectionne:{background:GCouleur.themeCouleur.foncee,color:GCouleur.blanc,border:''},sousOnglet:{background:GStyle.composeContenuDegradeVertical('#303437','#474c51'),color:GCouleur.blanc,textShadow:'0px 1px 1px rgba(0, 0, 0, 0.8)',border:'none'}};if(GNavigateur.IsIE8||GNavigateur.IsIE9) this.couleur.sousOnglet.filter='progid:DXImageTransform.Microsoft.Gradient(gradientType=0,startColorStr=#303437,endColorStr=#474c51);';this.raccourciClavier=aParam.raccourciClavier?' title="'+aParam.raccourciClavier+'"':'';this.vitesseAnimationOuverture=250;this.vitesseAnimationFermeture=0;};ObjetMenuOnglets.prototype.ajouterNiveau=function(){var lNiveauAjoute=this.NomNiveau.length;if(lNiveauAjoute===0) this.IdPremierElement=this.NomCombo+lNiveauAjoute;this.NomNiveau.push(this.baseNomNiveau+lNiveauAjoute);var H='<td>'+'<div id="'+this.NomCombo+lNiveauAjoute+'" class="SouligneSurFocus AvecMain Texte12 objetMenuOngletCombo" tabindex="'+this.tabIndex+'"'+GObjetWAI.composeRole(this._options.roleWAIcombo)+' '+GObjetWAI.composeAttribut({genre:EGenreAttribut.haspopup,valeur:'true'})+' '+GObjetWAI.composeAttribut({genre:EGenreAttribut.labelledby,valeur:this.NomEdit+this.NomNiveau[lNiveauAjoute]})+' '+GObjetWAI.composeAttribut({genre:EGenreAttribut.atomic,valeur:'true'})+' '+GObjetWAI.composeAttribut({genre:EGenreAttribut.describedby,valeur:GObjetWAI.idInfoWai[EGenreObjet.BarreOngletsPrincipal]})+' '+this.raccourciClavier+' style="'+($.isNumeric(this.largeur)?'width:'+this.largeur+'px;':'')+'height:'+this.hauteur+'px;'+GStyle.composeCouleurTexte(GCouleur.blanc)+(this.libelleCentre?'text-align:center;':'')+'">';H+='<div class="InlineBlock" style="height:100%;vertical-align:middle;" '+GObjetWAI.composeRole(EGenreRole.Presentation)+'></div>';H+='<div id="'+this.NomEdit+lNiveauAjoute+'"'+' style="text-overflow:ellipsis;overflow:hidden;vertical-align:middle;'+(this.largeurMaxLibelle?'max-width:'+this.largeurMaxLibelle+'px;':'')+'"'+' class="objetmenuonglet_breadcrumb InlineBlock"'+'>&nbsp;</div>';H+='</div>';H+='<div id="'+this.NomListe+this.NomNiveau[lNiveauAjoute]+'" class="Texte12 objetmenuonglet_niveau0 SansSelectionTexte" style="position:absolute;'+'"></div>';H+='</td>';$('#'+this.NomWrapper.escapeJQ()).append(H);return lNiveauAjoute;};ObjetMenuOnglets.prototype.setOptions_ObjetMenuOnglets=function(aOptions){$.extend(this._options,aOptions);};ObjetMenuOnglets.prototype.SetInformationWAI=function(ALabelFor){;this.LabelFor=ALabelFor===null?'':ALabelFor;};ObjetMenuOnglets.prototype.ConstruireAffichage=function(){return'<table cellpadding="0" cellspacing="0"><tr id="'+this.NomWrapper+'" style="height:'+this.hauteur+'px;" class="objetMenuOngletWrapper"></tr></table>';};ObjetMenuOnglets.prototype.RecupererDonnees=function(){$('#'+this.NomWrapper.escapeJQ()).on('focus mouseenter','div[id^="'+this.NomCombo.escapeJQ()+'"]',{aObjet:this},function(){$(this).find('span').addClass('Souligne');}).on('blur mouseleave','div[id^="'+this.NomCombo.escapeJQ()+'"]',{aObjet:this},function(){$(this).find('span').removeClass('Souligne');}).on('mouseenter focus','[id^="'+this.NomListe.escapeJQ()+this.baseNomNiveau+'"] ul:first-child > li:not(\'.objetmenuonglet_elementavecclic, .objetmenuonglet_elementsansclic\')',{aObjet:this},function(event){$(this).find('span').addClass('Souligne').end().siblings().find('span').removeClass('Souligne');}).on('mouseleave blur','[id^="'+this.NomListe.escapeJQ()+this.baseNomNiveau+'"] ul:first-child > li:not(\'.objetmenuonglet_elementavecclic, .objetmenuonglet_elementsansclic\')',{aObjet:this},function(event){$(this).find('span').removeClass('Souligne');}).on('click','[id^="'+this.NomListe.escapeJQ()+this.baseNomNiveau+'"] ul:first-child > li:not(\'.objetmenuonglet_elementavecclic, .objetmenuonglet_elementsansclic\')',{aObjet:this},function(event){var lThis=event.data.aObjet;if(!lThis.avecPlusieursNiveau){if($(this).parent().data('bloquerSousOnglet')===$(this).data('indice')) $(this).parent().data('bloquerSousOnglet',-1);else{$(this).parent().data('bloquerSousOnglet',-1);lThis.positionnerListe($(this).children('ul'));$(this).siblings().css(lThis.couleur.onglet).removeClass('Souligne').children('ul').slideUp(event.data.aObjet.vitesseAnimation).end().end().css(lThis.couleur.ongletSurvole).addClass('Souligne').children('ul').slideDown(event.data.aObjet.vitesseAnimation,function(){$(this).parent().parent().parent().data('height',$(this).parent().parent().height());});$(this).parent().data('bloquerSousOnglet',$(this).data('indice'));}} else{$(this).children('span').removeClass('Souligne');$(this).parents('div:first').slideUp(0);event.stopImmediatePropagation();event.data.aObjet.SurValidation(true,$(this).data('indice'));}}).on('click','[id^="'+this.NomListe.escapeJQ()+this.baseNomNiveau+'"] ul > li > ul li, .objetmenuonglet_elementavecclic',{aObjet:this},function(event){if($(this).children('ul').length===0){$(this).children('span').removeClass('Souligne');if($(this).is('li')) $(this).parents('div:first').slideUp(0);event.stopImmediatePropagation();event.data.aObjet.SurValidation(true,$(this).data('indice'));}}).on('focus mouseenter','[id^="'+this.NomListe.escapeJQ()+this.baseNomNiveau+'"] ul:first-child > li > ul > li',{aObjet:this},function(event){if($(this).children('ul').length===0) $(this).children('span').addClass('Souligne');}).on('blur mouseleave','[id^="'+this.NomListe.escapeJQ()+this.baseNomNiveau+'"] ul > li > ul > li',{aObjet:this},function(event){if($(this).children('ul').length===0) $(this).children('span').removeClass('Souligne');}).on('focus mouseenter','[id^="'+this.NomListe.escapeJQ()+this.baseNomNiveau+'"] ul > li > ul > li > ul > li, .objetmenuonglet_elementavecclic',{aObjet:this},function(event){$(this).children('span').addClass('Souligne');}).on('blur mouseleave','[id^="'+this.NomListe.escapeJQ()+this.baseNomNiveau+'"] ul > li > ul > li > ul > li, .objetmenuonglet_elementavecclic',{aObjet:this},function(event){$(this).children('span').removeClass('Souligne');}).on('mouseleave blur','[id^="'+this.NomListe.escapeJQ()+this.baseNomNiveau+'"]',{aObjet:this},function(event){var lThis=event.data.aObjet;var lDelay=500;if(event.pageX<=$(this).offset().left+$(this).width()&&event.pageY<=$(this).offset().top+$(this).data('height')) lDelay+=1000;$(this).delay(lDelay).queue(function(){$(this).find('ul:first-child').data('bloquerSousOnglet',-1).end().slideUp(lThis.vitesseAnimation).dequeue();});}).on('mouseenter focusin','[id^="'+this.NomListe.escapeJQ()+this.baseNomNiveau+'"]',{aObjet:this},function(event){$(this).stop(true,true).slideDown(0);}).on('keyup','[id^="'+this.NomListe.escapeJQ()+this.baseNomNiveau+'"] li',{aObjet:this},this.navigationClavier).on('keydown','[id^="'+this.NomListe.escapeJQ()+this.baseNomNiveau+'"] li',{aObjet:this},function(event){if(event.which===ToucheClavier.Tab) $(event.delegateTarget).trigger('mouseleave');});$('#'+this.NomWrapper.escapeJQ()).on('keyup','div[id^="'+this.NomCombo.escapeJQ()+'"]',{aObjet:this},this.navigationClavier).on('click','div[id^="'+this.NomCombo.escapeJQ()+'"]',{aObjet:this},function(event){var lThis=event.data.aObjet;if(lThis.seulEtActionSurClick) lThis.SurValidation(true,lThis.listeTraitee.GetElement(0).indice);else lThis.ouvrirListe(event);}).on('mouseenter','div[id^="'+this.NomCombo.escapeJQ()+'"]',{aObjet:this},function(event){var lThis=event.data.aObjet;$(this).delay(500).queue(function(){lThis.ouvrirListe(event);$(this).dequeue();});}).on('mouseleave blur','div[id^="'+this.NomCombo.escapeJQ()+'"], div[id^="'+this.NomCombo.escapeJQ()+'"] div, div[id^="'+this.NomCombo.escapeJQ()+'"] span',{aObjet:this},function(event){var lThis=event.data.aObjet;var lNomNiveau=event.target.id&&event.target.id.search(lThis.NomCombo)> -1?event.target.id.substr(lThis.NomCombo.length):$(this).parents('div[id^="'+lThis.NomCombo.escapeJQ()+'"]:first').length>0?$(this).parents('div[id^="'+lThis.NomCombo.escapeJQ()+'"]:first').get(0).id.substr(lThis.NomCombo.length):'0';var lJqToClose=$('#'+(lThis.NomListe+lThis.baseNomNiveau+lNomNiveau).escapeJQ());$(this).clearQueue();if(lJqToClose.is(':visible')) lJqToClose.trigger({type:'mouseleave',data:{aObjet:lThis}});});};ObjetMenuOnglets.prototype.navigationClavier=function(event){var lThis=event.data.aObjet;var lParentNiveau=$(this).parents('[id^="'+lThis.NomListe+'"]:first'),lNomNiveau=lParentNiveau.length===1?lParentNiveau.get(0).id.substr(lThis.NomListe.length+lThis.baseNomNiveau.length):lThis.NomNiveau[0],lPrevLi,lPrevElms;if($(this).attr('id')&&((!lThis.avecPlusieursNiveau&&$(this).attr('id').indexOf(lThis.NomCombo)===0)||(lThis.avecPlusieursNiveau&&$(this).attr('id').indexOf(lThis.NomCombo)===0))){if(event.which===ToucheClavier.RetourChariot||event.which===ToucheClavier.Espace||event.which===ToucheClavier.FlecheBas){if(lThis.seulEtActionSurClick){if(event.which!==ToucheClavier.FlecheBas) lThis.SurValidation(true,lThis.listeTraitee.GetElement(0).indice);} else{lThis.ouvrirListe(event);$('#'+lThis.NomListe.escapeJQ()+lThis.baseNomNiveau+$(this).attr('id').substr(lThis.NomCombo.length)).find('ul:first-child li:not(.objetmenuonglet_elementsansclic):first').focus();}} else if(lThis.avecPlusieursNiveau&&(event.which===ToucheClavier.FlecheDroite||event.which===ToucheClavier.FlecheGauche)){lNomNiveau=$(this).attr('id').substr(lThis.NomCombo.length);if(lThis.NomNiveau[parseInt(lNomNiveau)+(event.which===ToucheClavier.FlecheDroite?1:-1)]) $('#'+lThis.NomCombo.escapeJQ()+(parseInt(lNomNiveau)+(event.which===ToucheClavier.FlecheDroite?1:-1))).focus();}} else{if(event.which===ToucheClavier.RetourChariot||event.which===ToucheClavier.Espace){$(this).click();} else if(event.which===ToucheClavier.FlecheBas){if($(this).next('li').length===1){if($(this).parent().parent().is('#'+lThis.NomListe.escapeJQ()+lNomNiveau)||$(this).next('li').children('ul').length===0){$(this).next('li').focus();} else{$(this).next('li').children('ul').children('li:first').focus();}} else{lPrevElms=$(this).parentsUntil('#'+lThis.NomListe.escapeJQ()+lNomNiveau,'li');lPrevLi=$(this).parents('li:first');while(lPrevElms.is(lPrevLi)){if(lPrevLi.next('li').length===1&&(lPrevLi.next('li').children('ul').length===0)){$(this).blur();lPrevLi.next('li').focus();break;} else if(lPrevLi.next('li').length===1&&lPrevLi.next('li').children('ul:first').children('li:first').length===1){$(this).blur();lPrevLi.next('li').children('ul:first').children('li:first').focus();break;} else{lPrevLi=lPrevLi.parents('li:first');}}}} else if(event.which===ToucheClavier.FlecheHaut){if($(this).prev('li').length===1){if($(this).parent().parent().is('#'+lThis.NomListe.escapeJQ()+lNomNiveau)||$(this).prev('li').children('ul').length===0){$(this).prev('li').focus();} else{$(this).prev('li').children('ul').children('li:last').focus();}} else{lPrevElms=$(this).parentsUntil('#'+lThis.NomListe.escapeJQ()+lNomNiveau,'li');lPrevLi=$(this).parents('li:first');while(lPrevElms.is(lPrevLi)){if(lPrevLi.prev('li').length===1&&(lPrevLi.prev('li').children('ul').length===0)){$(this).blur();lPrevLi.prev('li').focus();break;} else if(lPrevLi.prev('li').length===1&&lPrevLi.prev('li').children('ul:first').children('li:first').length===1){$(this).blur();lPrevLi.prev('li').children('ul:first').children('li:first').focus();break;} else{lPrevLi=lPrevLi.parents('li:first');}}
if(lPrevLi.length===0){$('#'+lThis.NomListe.escapeJQ()+lNomNiveau).blur();$('#'+lThis.NomCombo.escapeJQ()+lNomNiveau).focus();}}} else if(event.which===ToucheClavier.FlecheDroite&&$(this).children('ul').length===1){if($(this).find('li:first').children('ul').length===0){$(this).find('li:first').focus();} else{$(this).find('li:first').children('ul').children('li:first').focus();}} else if(event.which===ToucheClavier.FlecheGauche){if($(this).is('#'+lThis.NomListe.escapeJQ()+lThis.NomNiveau[0]+'> ul > li > ul > li'))
$(this).parents('li:first').focus();else if($(this).is('#'+lThis.NomListe.escapeJQ()+lThis.NomNiveau[0]+'> ul > li')){$('#'+lThis.NomListe.escapeJQ()+lThis.NomNiveau[0]).blur();$('#'+lThis.NomCombo.escapeJQ()+'0').focus();}} else if((event.which===ToucheClavier.RetourChariot||event.which===ToucheClavier.Espace)&&$(this).is('#'+lThis.NomListe.escapeJQ()+lThis.NomNiveau[0]+' ul > li > ul li, #'+lThis.NomListe.escapeJQ()+lThis.NomNiveau[0]+' ul > li.objetmenuonglet_elementavecclic')){$(this).click();}}
if(event.which===ToucheClavier.Echap){$('#'+lThis.NomListe.escapeJQ()+lNomNiveau).blur();$('#'+lThis.NomCombo.escapeJQ()+lNomNiveau).focus();}
event.stopImmediatePropagation();};ObjetMenuOnglets.prototype._notificationFermer=function(aNomInstanceOrigine){if(this.Nom!==aNomInstanceOrigine) this._fermer();};ObjetMenuOnglets.prototype._fermer=function(){$('[id^='+this.NomListe.escapeJQ()+']').each(function(){if($(this).is(':visible')) $(this).data('height',$(this).children('ul:first-child').height());}).hide();};function _trouveFils(aElement,aListe,aProfondeurDesElements){aElement.children=new ObjetListeElements();for(var inc=0;aListe&&inc<aListe.GetNbrElements();inc++){var lElement=aListe.GetElement(inc);if(lElement.Actif&&lElement.Visible!==false&&lElement.profondeur===aProfondeurDesElements.length+1&&lElement.onglet&&lElement.onglet.GetGenre()===aElement.GetGenre()){if(aProfondeurDesElements.length<1||(lElement.onglet.onglet.GetGenre()===aProfondeurDesElements[0].onglet.GetGenre())){aElement.children.AddElement(new ObjetElement(lElement.Libelle,lElement.Numero,lElement.Genre,lElement.Position,lElement.Actif));var lNewElement=aElement.children.GetElement(aElement.children.GetNbrElements()-1);var lNewProfondeurDesElements=aProfondeurDesElements.concat([]);lNewProfondeurDesElements.push(lElement);lNewElement.libelleLong=lElement.libelleLong;lNewElement.indice=inc;lNewElement.profondeur=lElement.profondeur;if(lNewElement.profondeur<this.niveauMaximum){_trouveFils.bind(this)(lNewElement,aListe,lNewProfondeurDesElements);}}}}}
function _traiterFils(aElement,aListe,aListeOriginelle,aMasquerLibelleOnglet){if(aElement.children&&aElement.children.GetNbrElements()>0){for(var lChild=0;lChild<aElement.children.GetNbrElements();lChild++){var lChildElement=aElement.children.GetElement(lChild);_traiterFils(lChildElement,aListe,aListeOriginelle,aMasquerLibelleOnglet);}} else if(aListe){var lElementOriginel=aListeOriginelle.GetElement(aElement.indice);var lElementPourLibelle=lElementOriginel;var lLibelle=lElementPourLibelle.Libelle;while(!aMasquerLibelleOnglet&&lElementPourLibelle.onglet){lLibelle=lElementPourLibelle.onglet.Libelle+' &gt; '+lLibelle;lElementPourLibelle=lElementPourLibelle.onglet;}
aListe.AddElement(new ObjetElement(lLibelle,lElementOriginel.Numero,lElementOriginel.Genre,lElementOriginel.Position,lElementOriginel.Actif));var lNewElement=aListe.GetElement(aListe.GetNbrElements()-1);lNewElement.indice=aElement.indice;lNewElement.profondeur=0;lNewElement.avecClic=true;lNewElement.libelleLong=lElementOriginel.libelleLong;lNewElement.htmlAttributs=lElementOriginel.htmlAttributs;lNewElement.controleur=lElementOriginel.controleur;}}
function _formatageFils(aIndice,aElement,aListe,aAvecPlsNivx){var lChildElement;if((aElement.children&&aElement.children.GetNbrElements()>1)||(aAvecPlsNivx&&aElement.profondeur===0)){for(var lChild=0;lChild<aElement.children.GetNbrElements();lChild++){lChildElement=aElement.children.GetElement(lChild);_formatageFils(lChild,lChildElement,aElement.children,aAvecPlsNivx);}} else if(aListe&&aElement.children&&aElement.children.GetNbrElements()===1){lChildElement=aElement.children.GetElement(0);lChildElement.Libelle=lChildElement.libelleLong;lChildElement.profondeur=aElement.profondeur;if(lChildElement.profondeur===0) lChildElement.avecClic=true;aListe.AddElement(lChildElement,aIndice);if(lChildElement.children.GetNbrElements()>0) _formatageFils(aIndice,lChildElement,aListe,aAvecPlsNivx);}}
ObjetMenuOnglets.prototype.SetDonnees=function(AListeElements,aGenreOnglet,aGenreSousOnglet,aGenreAffichage){this.ListeElements=null;this.listeTraitee=new ObjetListeElements();this.ListeElements=AListeElements;var i,lNbElements=this.ListeElements.GetNbrElements(),lElement;function _compteur(){if($(this).data('indice')===i){$(this).iosbadge({content:lElement.compteur,size:16,position:'right-menuonglet',theme:'grey'});return false;}}
for(i=0;i<lNbElements;i++){lElement=this.ListeElements.GetElement(i);if(lElement.Actif&&lElement.Visible!==false&&lElement.profondeur===0){this.listeTraitee.AddElement(new ObjetElement(lElement.Libelle,lElement.Numero,lElement.Genre,lElement.Position,lElement.Actif));var lNewElement=this.listeTraitee.GetElement(this.listeTraitee.GetNbrElements()-1);lNewElement.indice=i;lNewElement.htmlAttributs=lElement.htmlAttributs;lNewElement.controleur=lElement.controleur;lNewElement.profondeur=lElement.profondeur;if(lElement.avecClic) lNewElement.avecClic=lElement.avecClic;_trouveFils.bind(this)(lNewElement,this.ListeElements,[]);if(lNewElement.children.GetNbrElements()===0&&!lNewElement.avecClic){this.listeTraitee.DelElement();}}}
if(!this.avecSousMenu){var lListePreTraitee=this.listeTraitee;this.listeTraitee=new ObjetListeElements();for(i=0;i<lListePreTraitee.GetNbrElements();i++){lElement=lListePreTraitee.GetElement(i);_traiterFils(lElement,this.listeTraitee,this.ListeElements,this.masquerLibelleOnglet);}} else{for(i=0;i<this.listeTraitee.GetNbrElements();i++){lElement=this.listeTraitee.GetElement(i);_formatageFils(i,lElement,this.listeTraitee,this.avecPlusieursNiveau);}}
this.seulEtActionSurClick=this.actionSurClickSiSeul&&this.listeTraitee.GetNbrElements()===1&&(!this.listeTraitee.GetElement(0).children||this.listeTraitee.GetElement(0).children.GetNbrElements()===0);if(this.seulEtActionSurClick) this._options.roleWAIcombo=EGenreRole.Button;$('#'+this.NomWrapper.escapeJQ()).html('');this.NomNiveau=[];this.nombreNiveau=this.avecPlusieursNiveau?this.listeTraitee.GetNbrElements():1;for(i=0;i<this.nombreNiveau;i++){var lNiveauAjoute=this.ajouterNiveau();var lJqListe=$('#'+this.NomListe.escapeJQ()+this.NomNiveau[lNiveauAjoute]);lJqListe.html('');if(this.avecPlusieursNiveau){var lNiveau=this.listeTraitee.GetElement(lNiveauAjoute);if(lNiveau.children) this.remplirListe(lJqListe,lNiveau.children);else $('#'+this.NomCombo.escapeJQ()+lNiveauAjoute).addClass('objetmenuonglet_elementavecclic');this.setLibelleOnglet(lNiveau,lNiveauAjoute);$('#'+this.NomCombo.escapeJQ()+lNiveauAjoute).data('indice',lNiveau.indice).css(this.couleur.onglet);this.positionnerListe(lJqListe);} else{this.remplirListe(lJqListe,this.listeTraitee);if(this.listeTraitee.GetNbrElements()===0) $('#'+this.NomCombo.escapeJQ()+lNiveauAjoute).css({display:'none'});}
lJqListe.children('ul').css(this.couleur.sousOnglet).css({boxShadow:'5px 5px 8px -5px '+GCouleur.noir}).children('li').not(':last').css({borderBottom:GCouleur.noir+' 1px solid'}).end().children('ul').children('li').children('ul').children('li:only-child').parent().css({'display':'none'}).end().end().addClass('AvecMain').parent().addClass('SansMain');lJqListe.slideUp(0);if(this.avecCompteur){this.totalCompteur=0;for(i=0;i<this.ListeElements.GetNbrElements();i++){lElement=this.ListeElements.GetElement(i);if(lElement&&lElement.compteur){this.totalCompteur+=lElement.compteur;lJqListe.find('li').each(_compteur);}}
if(this.totalCompteur>0){$('#'+(this.NomEdit+this.NomNiveau[lNiveauAjoute]).escapeJQ()).children('span').iosbadge({content:this.totalCompteur,size:16,position:'top-right-menuonglet',theme:'theme'});}}}
if(aGenreOnglet!==undefined&&aGenreOnglet!==null) this.setOnglet(aGenreOnglet,aGenreSousOnglet,aGenreAffichage);};ObjetMenuOnglets.prototype.remplirListe=function(aJqContainer,aListe){aJqContainer.append('<ul '+GObjetWAI.composeRole(EGenreRole.Menu)+'></ul>');var lJqUl=aJqContainer.children('ul:last-child');for(var i=0;aListe&&i<aListe.GetNbrElements();i++){var lElement=aListe.GetElement(i),lAvecAttributsHtml=IE.MethodesObjet.isString(lElement.htmlAttributs);var lHtml='<li '+(lElement.children&&lElement.children.GetNbrElements()>0?GObjetWAI.composeRole(EGenreRole.Group):GObjetWAI.composeRole(EGenreRole.Menuitem))+' '+GObjetWAI.composeAttribut({genre:EGenreAttribut.label,valeur:lElement.libelleLong||lElement.GetLibelle()})+(lElement.children&&lElement.children.GetNbrElements()>0?'':' tabindex="-1"')+'>'+'<span '+GObjetWAI.composeRole(EGenreRole.Presentation)+(lElement.children&&lElement.children.GetNbrElements()>0?' class="SansMain"':' class="AvecMain InlineBlock" style="width:100%;"')+(lAvecAttributsHtml?' '+lElement.htmlAttributs:'')+'>'+(this.avecSousMenu?lElement.GetLibelle():(lElement.libelleLong||lElement.GetLibelle()))+'</span>'+'</li>';if(lAvecAttributsHtml&&lJqUl.get(0))
IE.HTML.injectHTML(lJqUl.get(0),lHtml,lElement.controleur,true);else lJqUl.append(lHtml);var lJqLastLi=lJqUl.children('li:last-child');lJqLastLi.data('indice',lElement.indice);lJqLastLi.data('genre',lElement.Genre);if(lElement.children&&lElement.children.GetNbrElements()>0){lJqLastLi.addClass("objetmenuonglet_elementsansclic");this.remplirListe(lJqLastLi,lElement.children);} else if(lElement.profondeur===0){if(lElement.avecClic) lJqLastLi.addClass("objetmenuonglet_elementavecclic");else lJqLastLi.slideUp(0);}}};ObjetMenuOnglets.prototype.ouvrirListe=function(event){var lThis=event.data.aObjet;if(lThis.seulEtActionSurClick) return;var lNomNiveau=event.target.id?event.target.id.search(lThis.NomEdit.replace(/([\?\(\[\]\)\:\.])/g,'\\$1'))> -1?event.target.id.substr(lThis.NomEdit.length):event.target.id.search(lThis.NomCombo.replace(/([\?\(\[\]\)\:\.])/g,'\\$1'))> -1?event.target.id.substr(lThis.NomCombo.length):lThis.NomNiveau[0]:lThis.NomNiveau[0];if(lNomNiveau.search(lThis.baseNomNiveau)!==0) lNomNiveau=lThis.baseNomNiveau+lNomNiveau;var lOngletCourant=GEtatUtilisateur&&GEtatUtilisateur.genreOnglet?GEtatUtilisateur.genreOnglet:null;var lJqOngletAOuvrir=null;var lJqToOpen=$('#'+lThis.NomListe.escapeJQ()+lNomNiveau);if(lJqToOpen.length===1){if(lOngletCourant){lJqToOpen.children('ul').find('li').each(function(){if($(this).data('genre')===lOngletCourant) lJqOngletAOuvrir=$(this).parentsUntil(lJqToOpen).filter('li:last');});}
lThis.positionnerListe(lJqToOpen);$('[id^="'+lThis.NomListe.escapeJQ()+'"]').not(lJqToOpen).stop(true,true).slideUp(lThis.vitesseAnimationFermeture);lJqToOpen.stop(true,false).slideDown(lThis.vitesseAnimationOuverture,function(){if($(this).height()!==$(this).children('ul:first-child').height()) $(this).height($(this).children('ul:first-child').height());if($(this).css('overflow')!=='visible') $(this).css('overflow','visible');if(lJqOngletAOuvrir) lJqOngletAOuvrir.focus();});IE.Invocateur.evenement('fermerAutresMenuOnglet',lThis.Nom);}};ObjetMenuOnglets.prototype.positionnerListe=function(aJqEle){aJqEle.css({minWidth:aJqEle.prev().outerWidth()+'px'});var lCss={top:(aJqEle.prev().position().top+aJqEle.prev().height()+4)+'px'};var lLeft=Math.round(aJqEle.prev().position().left+parseInt(aJqEle.prev().css('marginLeft')));if(lLeft+aJqEle.width()<=GNavigateur.EcranL) lCss.left=lLeft+'px';else{var lRight=Math.round(GNavigateur.EcranL-(aJqEle.prev().position().left+aJqEle.prev().outerWidth()));lCss.right=lRight+'px';}
aJqEle.css(lCss);};ObjetMenuOnglets.prototype.ouvrirPremierNiveau=function(){$('#'+(this.NomListe+this.NomNiveau[0]).escapeJQ()).trigger('mouseover');};ObjetMenuOnglets.prototype.SurValidation=function(AInteractionUtilisateur,ASelection){var lElement=this.ListeElements.GetElement(ASelection);if(this.avecPlusieursNiveau){while(lElement.onglet) lElement=lElement.onglet;var lIndicePere=0;for(lIndicePere=0;lIndicePere<this.ListeElements.GetNbrElements();lIndicePere++){var lElementPere=this.ListeElements.GetElement(lIndicePere);if(lElementPere.GetNumero()===lElement.GetNumero()&&lElementPere.GetGenre()===lElement.GetGenre()&&lElementPere.profondeur===0) break;}
this.setCouleurOnglet(lIndicePere);}
if(this.Pere&&this.Pere.EvenementSurNavigation)
this.Pere.EvenementSurNavigation(this,AInteractionUtilisateur,ASelection);else this.RetourSurNavigation(AInteractionUtilisateur,ASelection);};ObjetMenuOnglets.prototype.setCouleurOnglet=function(aIndicePere){if(this.bloquerCouleurOnglet) return;var lThis=this;$('[id^="'+this.NomCombo.escapeJQ()+'"]').each(function(aIndex){if(aIndicePere!==undefined&&($(this).data('indice')===aIndicePere||(aIndicePere===true&&aIndex===0))) $(this).css(lThis.couleur.ongletSelectionne);else $(this).css(lThis.couleur.onglet);});};ObjetMenuOnglets.prototype.RetourSurNavigation=function(AInteractionUtilisateur,ASelection){this.InteractionUtilisateur=AInteractionUtilisateur;this.selection=ASelection;var lElement=this.ListeElements.GetElement(ASelection);this.callback.appel(lElement);this._fermer();};ObjetMenuOnglets.prototype.setLibelleGenreOnglet=function(aGenreOnglet){if(this.ListeElements){var lOnglet=this.ListeElements.GetElementParNumeroEtGenre(null,aGenreOnglet);this.setLibelleOnglet(lOnglet);}};ObjetMenuOnglets.prototype.getLibelleOnglet=function(aOnglet){return aOnglet.libelleLong?aOnglet.libelleLong:aOnglet.GetLibelle();};ObjetMenuOnglets.prototype.getLibelleGenreOnglet=function(aGenreOnglet){if(this.ListeElements){var lOnglet=this.ListeElements.GetElementParNumeroEtGenre(null,aGenreOnglet);return lOnglet.libelleLong?lOnglet.libelleLong:lOnglet.GetLibelle();}};ObjetMenuOnglets.prototype.setLibelleOnglet=function(aOnglet,aNiveau){aNiveau=aNiveau?aNiveau:0;var lLibelleComplet=aOnglet?this.getLibelleOnglet(aOnglet):'';lLibelleComplet='<span id="'+this.NomEdit+this.NomNiveau[aNiveau]+'"'+'class="NoWrap Titre'+(this.avecPlusieursNiveau?'':' SouligneSurFocus')+'"'+'>'+lLibelleComplet+'</span>';GHtml.setHtml($('#'+this.NomEdit.escapeJQ()+aNiveau).get(0),lLibelleComplet);;if(this.avecCompteur){if(this.totalCompteur>0){$('#'+(this.NomEdit+this.NomNiveau[0]).escapeJQ()).children('span').iosbadge({content:this.totalCompteur,size:16,position:'top-right-menuonglet',theme:'theme'});}}};ObjetMenuOnglets.prototype.Reset=function(){this.SetDonnees(new ObjetListeElements());};ObjetMenuOnglets.prototype.setOnglet=function(aGenreOnglet,aGenreSousOnglet,aGenreAffichage){if(aGenreOnglet!==undefined){var lOnglet=this.avecSousMenu?this.listeTraitee.GetElementParGenre(aGenreOnglet):this.listeTraitee.GetElementParGenre(aGenreSousOnglet);if(lOnglet&&lOnglet.GetActif()&&aGenreSousOnglet!==undefined&&this.avecSousMenu){lOnglet=lOnglet.children.GetElementParGenre(aGenreSousOnglet);if(lOnglet&&lOnglet.GetActif()&&(aGenreAffichage!==undefined&&aGenreAffichage!==null)&&lOnglet.children&&lOnglet.children.GetNbrElements()>0){lOnglet=lOnglet.children.GetElement(aGenreAffichage);}}
if(lOnglet&&this.avecPlusieursNiveau){var lElement=this.ListeElements.GetElement(lOnglet.indice);while(lElement.onglet) lElement=lElement.onglet;var lIndicePere=0;for(lIndicePere=0;lIndicePere<this.ListeElements.GetNbrElements();lIndicePere++){var lElementPere=this.ListeElements.GetElement(lIndicePere);if(lElementPere.GetNumero()===lElement.GetNumero()&&lElementPere.GetGenre()===lElement.GetGenre()&&lElementPere.profondeur===0)break;}
this.setCouleurOnglet(lIndicePere);}}
this._fermer();};ObjetMenuOnglets.prototype.setOngletPN=function(aGenreOnglet){if(aGenreOnglet!==undefined){var lElement=this.ListeElements.GetElementParNumeroEtGenre(null,aGenreOnglet);while(lElement&&lElement.onglet) lElement=lElement.onglet;var lIndicePere;if(this.avecPlusieursNiveau) for(lIndicePere=0;lIndicePere<this.ListeElements.GetNbrElements();lIndicePere++){var lElementPere=this.ListeElements.GetElement(lIndicePere);if(lElementPere.GetNumero()===lElement.GetNumero()&&lElementPere.GetGenre()===lElement.GetGenre()&&lElementPere.profondeur===0)break;} else lIndicePere=!!lElement;this.setCouleurOnglet(lIndicePere);}};ObjetMenuOnglets.prototype.selectionnerSousOnglet=function(aGenre){for(var I=0;I<this.ListeElements.GetNbrElements();I++)
if(this.ListeElements.GetGenre(I)===aGenre){this.SurValidation(true,I);return;}};})();;
function ObjetRequeteSaisieDeconnexion(aPere){this.inheritedCreate(aPere);this._avecControleModeExclusif=false;}
IE.Requetes.inscrire('SaisieDeconnexion',ObjetRequeteSaisieDeconnexion,_ObjetRequeteXmlConsultation);ObjetRequeteSaisieDeconnexion.prototype.lancerRequete=function(aParam){var lParam={decoManuelle:false};$.extend(lParam,aParam);if(lParam.decoManuelle){this._jsonRacineParametres.DeconnexionManuelle=true;}
GApplication.getCommunication().appel_fonction_asynchrone_xml({nom:this.nom,json:this._jsonRacineParametres,estUneSaisie:true,messageDetail:GTraductions.getValeur('connexion.DeconnexionEnCours')});GApplication.getCommunication().arreterPolling();};;
MethodesObjet.heritagePrototype(ObjetAffichageCommande,ObjetAbstraitInterface);function ObjetAffichageCommande(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.idCommande=this.Nom+'_Commande';IE.Invocateur.abonner(IE.Invocateur.events.modeExclusif,this._setModeExclusif,this);IE.Invocateur.abonner(IE.Invocateur.events.etatSaisie,this._setEtatSaisie.bind(this),this);}(function(){ObjetAffichageCommande.prototype.ConstruireInstances=function(){this.IdentBtnValidation=this.Add(window.ObjetBoutonBandeau,this.EvenementBoutonCommande,this.InitialiserValidation);this.IdentBtnImpression=this.Add(window.ObjetBoutonBandeau,this.EvenementBoutonCommande ,this.InitialiserImpression);this.identBtnGenerationPdf=this.Add(window.ObjetBoutonBandeau,this.EvenementBoutonCommande ,this._initialiserGenerationPdf);if(GEtatUtilisateur.avecCommunication()){this.identBtnCommunication=this.Add(window.ObjetBoutonBandeau,this.EvenementBoutonCommande ,this.initialiserBoutonCommunication);}
IE.Invocateur.abonner(IE.Invocateur.events.activationImpression,this._surActivationImpression.bind(this),this);IE.Invocateur.abonner(IE.Invocateur.events.choixImpression,this._surChoixImpression.bind(this),this);};ObjetAffichageCommande.prototype._evenementFenetreParametres=function(aGenreBouton,aParametres){if(aParametres)
this.callback.appel(aParametres);};ObjetAffichageCommande.prototype.SetParametresGeneraux=function(){this.GenreStructure=EStructureAffichage.Autre;this.AvecCadre=false;};ObjetAffichageCommande.prototype.getControleur=function(){return{modeExclusif:{afficher:function(){return GApplication.getModeExclusif();},html:function(){var H=[];H.push('<div class="Texte12 Gras SansMain" style="'+GStyle.composeCouleur(GCouleur.cumul,GCouleur.fond)+'" title="',GChaine.toTitle(GTraductions.getValeur('ModeExclusif.EntrerModeExclusif')),'">','<div class="PetitEspace">',GChaine.Insecable(GTraductions.getValeur('ModeExclusif.ConsultationTemporaire')),'</div>','</div>');return H.join('');}},afficherBtnContactVS:function(){return GApplication.droits.get(IEEnum.droits.communication.avecContactVS);},btnContactVS:{event:function(){IE.Invocateur.evenement('creerDiscussionVieScolaire');},getTitle:function(){return GTraductions.getValeur('Messagerie.ContacterVS');}}};};ObjetAffichageCommande.prototype.ConstruireStructureAffichageAutre=function(){var H=[];H.push('<table ',GObjetWAI.composeRole(EGenreRole.Presentation),' tabindex="-1" class="AlignementDroit" style="width: 100%; height: 100%;" border="0" cellpadding="0" cellspacing="0"><tr>');if(GEtatUtilisateur.getAvecSaisie())
H.push('<td style="width: 10px; display:none" class="AlignementDroit" '+' id="'+this.Instances[this.IdentBtnValidation].GetNom()+'"></td>');H.push('<td style="width: 10px; display:none"  class="AlignementDroit" '+' id="'+this.Instances[this.IdentBtnImpression].GetNom()+'"></td>');H.push('<td style="width: 10px; display:none"  class="AlignementDroit" '+' id="'+this.Instances[this.identBtnGenerationPdf].GetNom()+'"></td>');if(this.identBtnCommunication)
H.push('<td style="width: 10px; display:none" class="AlignementDroit" '+' id="'+this.Instances[this.identBtnCommunication].GetNom()+'"></td>');if(GEtatUtilisateur.GenreEspace===EGenreEspace.Professeur||GEtatUtilisateur.GenreEspace===EGenreEspace.Etablissement)
H.push('<td style="width: 10px;" ie-if="afficherBtnContactVS" class="AlignementDroit"><div class="EspaceGauche">','<ie-btnimage ie-model="btnContactVS" class="Image_ContactVS" style="width:30px;"></ie-btnimage>','</div></td>');H.push('<td class="AlignementDroit EspaceGauche" ie-display="modeExclusif.afficher" ie-html="modeExclusif.html"></td>');H.push('<td style="width: 100%;color:'+GCouleur.blanc+';">','&nbsp;','<td>');H.push('</tr></table>');H.push('<div id="main" tabindex="-1" class="wai_hidden"></div>');return H.join('');};ObjetAffichageCommande.prototype.InitialiserValidation=function(aInstance){aInstance.SetParametres('Image_CommandeValider',true,false,false,['',GTraductions.getValeur('Commande.Validation.Actif'),GTraductions.getValeur('Commande.Validation.Inactif')],30,false,true);aInstance.SetGenre(EGenreCommande.Validation);aInstance.withTabulation=false;};ObjetAffichageCommande.prototype.InitialiserImpression=function(aInstance){aInstance.SetParametres('Image_CommandeImprimer',true,false,false,['',GTraductions.getValeur('Commande.Impression.Actif'),GTraductions.getValeur('Commande.Impression.Inactif')],30,false,true);aInstance.SetGenre(EGenreCommande.Impression);aInstance.withTabulation=false;};ObjetAffichageCommande.prototype._initialiserGenerationPdf=function(aInstance){aInstance.SetParametres('Image_CommandeGenererPDF',true,false,false,['',GTraductions.getValeur('Commande.PDF.Actif'),GTraductions.getValeur('Commande.PDF.Inactif')],30,false);aInstance.SetGenre(EGenreCommande.Impression);aInstance.withTabulation=false;};ObjetAffichageCommande.prototype.initialiserBoutonCommunication=function(aInstance){aInstance.SetParametres('Image_CommandeEnvoieEmail',true,false,true,['',GTraductions.getValeur('Commande.Communication.Actif'),''],30,false,true);aInstance.SetGenre(EGenreCommande.Communication);aInstance.withTabulation=false;};ObjetAffichageCommande.prototype.EvenementBoutonCommande=function(AGenre){this.RetourSurNavigation(AGenre);};ObjetAffichageCommande.prototype.RetourSurNavigation=function(AGenre){this.callback.appel({genreCmd:AGenre});};ObjetAffichageCommande.prototype.evenementRaccourcisClavier=function(aNumeroTouche){switch(aNumeroTouche){case 1:if((this.IdentBtnValidation!==null)&&this.Instances[this.IdentBtnValidation].getActif())
this.callback.appel({genreCmd:EGenreCommande.Validation});break;case 2:if((this.IdentBtnImpression!==null)&&this.Instances[this.IdentBtnImpression].getActif())
this.callback.appel({genreCmd:EGenreCommande.Impression});break;case 3:if(this.identBtnCommunication!==null)
this.callback.appel({genreCmd:EGenreCommande.Communication});break;case 4:if(this.identBtnKiosque!==null)
this.callback.appel({genreCmd:EGenreCommande.Kiosque});break;}};ObjetAffichageCommande.prototype.actualiserInformationEtatCommande=function(){var j,lID;if(this.instancesActif&&this.instancesActif.length>0){for(j=0;j<this.instancesActif.length;j++){lID=this.Instances[this.instancesActif[j]].IdPremierElement;$('#'+lID.escapeJQ()).off('keyup',this.navigationCommandesActif);}}
this.instancesActif=[];for(var i=0;i<this.Instances.length;i++){var lInstance=this.Instances[i];if(lInstance&&lInstance.constructor&&(lInstance.constructor!==window.ObjetBoutonBandeau||(lInstance._options&&lInstance._options.actif))){this.instancesActif.push(i);}}
if(this.instancesActif.length>0){lID=this.Instances[this.instancesActif[0]].IdPremierElement;if(this.instancesActif.length>1){for(j=0;j<this.instancesActif.length;j++){lID=this.Instances[this.instancesActif[j]].IdPremierElement;$('#'+lID.escapeJQ()).on('keyup',null,{aObjet:this,index:j},this.navigationCommandesActif);}}}};ObjetAffichageCommande.prototype.navigationCommandesActif=function(event){var lThis=event.data.aObjet;var lIndex=event.data.index,lID,lInstance;if(GNavigateur.IsToucheFlecheGauche()||GNavigateur.IsToucheFlecheHaut()){if(lIndex>0){lInstance=lThis.Instances[lThis.instancesActif[lIndex-1]];lID=lInstance.IdPremierElement;$('#'+lID.escapeJQ()).focus();}} else if(GNavigateur.IsToucheFlecheDroite()||GNavigateur.IsToucheFlecheBas()){if(lIndex<lThis.instancesActif.length-1){lInstance=lThis.Instances[lThis.instancesActif[lIndex+1]];lID=lInstance.IdPremierElement;$('#'+lID.escapeJQ()).focus();}}};ObjetAffichageCommande.prototype.setVisibleBoutonKiosque=function(aVisible){if(this.GetInstance(this.identBtnKiosque))
GHtml.setDisplay(this.GetInstance(this.identBtnKiosque).GetNom(),aVisible);};ObjetAffichageCommande.prototype._setEtatSaisie=function(aActif){this.Instances[this.IdentBtnValidation].setActif(aActif);this.actualiserInformationEtatCommande();};ObjetAffichageCommande.prototype._surActivationImpression=function(aGenreImpression,aInstance,aCallback){IE.GestionImpression.surActivationImpression(aGenreImpression,aInstance,aCallback);if(GEtatUtilisateur.impressionCourante){this.Instances[this.IdentBtnImpression].setActif(GEtatUtilisateur.impressionCourante.etat!==EGenreImpression.Aucune&&GEtatUtilisateur.impressionCourante.etat!==EGenreImpression.GenerationPDF);this.Instances[this.identBtnGenerationPdf].setActif(GEtatUtilisateur.impressionCourante.etat===EGenreImpression.GenerationPDF);} else{this.Instances[this.IdentBtnImpression].setActif(false);this.Instances[this.identBtnGenerationPdf].setActif(false);}
this.actualiserInformationEtatCommande();};ObjetAffichageCommande.prototype._surChoixImpression=function(aGenreImpression){var lEstPDF=aGenreImpression===EGenreImpression.GenerationPDF;if(this.GetInstance(this.IdentBtnImpression)){GHtml.setDisplay(this.GetInstance(this.IdentBtnImpression).GetNom(),!lEstPDF);}
if(this.GetInstance(this.identBtnGenerationPdf)){GHtml.setDisplay(this.GetInstance(this.identBtnGenerationPdf).GetNom(),lEstPDF);}
GHtml.setHtml('zone_impression',GTraductions.getValeur(lEstPDF?'MessagePDF':'MessageImpression'));};ObjetAffichageCommande.prototype._setModeExclusif=function(){this.$refreshSelf();};ObjetAffichageCommande.prototype._gestionFocus_apresFenetreCommunication=function(){if(this.GetInstance(this.identBtnCommunication))
this.GetInstance(this.identBtnCommunication).FocusSurPremierElement();};ObjetAffichageCommande.prototype._gestionFocus_apresFenetreKiosque=function(){if(this.GetInstance(this.identBtnKiosque))
this.GetInstance(this.identBtnKiosque).FocusSurPremierElement();};ObjetAffichageCommande.prototype._gestionFocus_apresFenetreImpression=function(){if(this.GetInstance(this.IdentBtnImpression))
this.GetInstance(this.IdentBtnImpression).FocusSurPremierElement();};ObjetAffichageCommande.prototype._gestionFocus_apresFenetreGenerationPdf=function(){if(this.GetInstance(this.identBtnGenerationPdf))
this.GetInstance(this.identBtnGenerationPdf).FocusSurPremierElement();};}());;
MethodesObjet.heritagePrototype(ObjetZoneTexte,Identite);function ObjetZoneTexte(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.idTable=this.Nom+'_IdTable';this.idLibelle=this.Nom+'_IdLibelle';this.IdPremierElement=this.idLibelle;this.avecRetaillage=false;this.couleurTexte=GCouleur.texte;this._options={largeur:null,describedby:''};}
ObjetZoneTexte.prototype.setOptions_ObjetZoneTexte=function(aOptions){$.extend(this._options,aOptions);};ObjetZoneTexte.prototype.SetParametres=function(aAvecRetaillage,aCouleurTexte){this.avecRetaillage=aAvecRetaillage;this.couleurTexte=aCouleurTexte?aCouleurTexte:this.couleurTexte;};ObjetZoneTexte.prototype.ConstruireAffichage=function(){var H=[];H.push('<table id="'+this.idTable+'" border="0" cellspacing="0" cellpadding="0" ',(this._options.largeur?' style="'+GStyle.composeWidth(this._options.largeur)+'"':''),'>');H.push('<tr>');H.push('<td class="Texte10 Gras"><span ',this._options.describedby?GObjetWAI.composeAttribut({genre:EGenreAttribut.describedby,valeur:this._options.describedby+' '+this.idLibelle}):'',' id="'+this.idLibelle+'" class="Insecable" style="'+GStyle.composeCouleurTexte(this.couleurTexte)+'"></span>');H.push('</td>');H.push('</tr></table>');return H.join('');};ObjetZoneTexte.prototype.SetDonnees=function(aLibelle){if(this.avecRetaillage)
GPosition.setWidth(this.idTable,(GChaine.GetLongueurChaine(aLibelle,10,true)+4));var lTab=aLibelle?aLibelle.split('\n'):[];for(var i in lTab)
lTab[i]=GChaine.toTexte(lTab[i]);this.Libelle=lTab.join('<br>');GHtml.setHtml(this.idLibelle,this.Libelle,{controleur:this.controleur});var lThis=this;$('#'+this.idLibelle.escapeJQ()).on('focusin',function(){$(this).css('box-shadow','0 0 5px -1px '+lThis.couleurTexte);}).on('focusout',function(){$(this).css('box-shadow','none');});};ObjetZoneTexte.prototype.SetTabIndex=function(aTabIndex){GHtml.setTabIndex(this.idLibelle,aTabIndex);};;
IE.Invocateur.abonner(IE.Invocateur.events.modificationThemeCouleur,function(){GHtml.modifierRegleCss(".iosb-theme",'background',GStyle.composeContenuDegradeVertical(GCouleur.themeCouleur.moyen1,GCouleur.themeCouleur.sombre));GHtml.modifierRegleCss(".iosb-theme",'background-color',GCouleur.themeCouleur.sombre);GHtml.modifierRegleCss(".iosb-theme .iosb-content",'color',GCouleur.blanc);GHtml.modifierRegleCss(".iosb-theme .iosb-content",'text-shadow','1px -1px 1px '+GCouleur.themeCouleur.sombre);});MethodesObjet.heritagePrototype(ObjetAffichageBandeauEntete,ObjetAbstraitInterface);function ObjetAffichageBandeauEntete(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.idAideRaccourcisClavier='id_aideWAI';this.idAideAprèsConnexion='id_aideApresConnexion';this.idBoutonMembre=window.GUID.getId();IE.Invocateur.abonner('modification_Membre',this._modificationMembre.bind(this),this);IE.Invocateur.abonner('notification_communication',this._notificationCommunication.bind(this),this);IE.Invocateur.abonner('modifier_notification_communication',this._modifierNotificationComunications.bind(this),this);}(function(){var EGenreCommandePersonnel={deconnexion:0,onglet:1,telechargerCertificatScolarite:3,ExportFichierProf:4,ImportFichierProf:5,CommandeBouton:6};ObjetAffichageBandeauEntete.prototype.ConstruireInstances=function(){this.identMenuOnglets=this.Add(window.ObjetMenuOnglets,this.evenementSurMenuOnglets,this.initialiserMenuOnglets);this.identCommande=this.Add(window.ObjetAffichageCommande,this.EvenementBouton);this.IdentNomEleve=this.Add(window.ObjetZoneTexte,null,this.InitialiserNomEleve);this.identComboMembres=this.Add(window.ObjetSaisie,this._evenementSurComboMembres,this.initialiserComboMembres);this.identOngletUtilisateur=this.Add(window.ObjetMenuOnglets,this._evenementOngletUtilisateur,this._initialiserOngletUtilisateur);this.identOngletNotification=this.Add(window.ObjetMenuOnglets,this._evenementOngletNotification,this._initialiserOngletNotification);this.identMenuPlus=this.Add(window.ObjetMenuOnglets,this.evenementSurMenuPlus,this.initialiserMenuPlus);this.identMenuRessources=this.Add(window.ObjetMenuOnglets,this.evenementSurMenuRessources,this.initialiserMenuRessources);if(GEtatUtilisateur.avecPageAccueil()) this.identMenuAccueil=this.Add(window.ObjetMenuOnglets,this.evenementSurMenuRessources,this.initialiserMenuAccueil);};ObjetAffichageBandeauEntete.prototype.getInstanceMenuOnglet=function(){return this.GetInstance(this.identMenuOnglets);};ObjetAffichageBandeauEntete.prototype.getInstanceOngletUtilisateur=function(){return this.GetInstance(this.identOngletUtilisateur);};ObjetAffichageBandeauEntete.prototype.getInstanceMenuPlus=function(){return this.GetInstance(this.identMenuPlus);};ObjetAffichageBandeauEntete.prototype.getInstanceMenuRessources=function(){return this.GetInstance(this.identMenuRessources);};ObjetAffichageBandeauEntete.prototype.getInstanceMenuAccueil=function(){return this.GetInstance(this.identMenuAccueil);};ObjetAffichageBandeauEntete.prototype.SetParametresGeneraux=function(){this.GenreStructure=EStructureAffichage.Autre;};ObjetAffichageBandeauEntete.prototype.getControleur=function(){return{};};ObjetAffichageBandeauEntete.prototype.initialiserComboMembres=function(AInstance){AInstance.setOptions_ObjetSaisie({longueur:230,hauteur:25,classTexteReference:'Texte12',classTexte:'Gras',labelFor:GEtatUtilisateur.GenreEspace===EGenreEspace.Academie?GTraductions.getValeur('WAI.ListeSelectionProfesseur'):GTraductions.getValeur('WAI.ListeSelectionEleve'),accepterUnElement:true,avecFondSelectionSurSurvol:true,avecGrasSurSurvol:true,avecReservationPlaceBarreScroll:false,avecTextOverflowEllipsis:true,optionsBouton:{hauteur:20,avecBordures:true,avecCouleurFondBouton:true,avecFocusVisibleTexte:false,taillePolice:14}});AInstance.SetVisible(false);};ObjetAffichageBandeauEntete.prototype.InitialiserAncreLien=function(AObjet){AObjet.SetParametres('ContenuPage',null,GTraductions.getValeur('AllerAuContenu'));};ObjetAffichageBandeauEntete.prototype.initialiserMenuOnglets=function(aInstance){aInstance.SetParametres({avecSousMenu:true,avecPlusieursNiveau:true,libelleCentre:true});};ObjetAffichageBandeauEntete.prototype._initialiserOngletUtilisateur=function(AInstance){AInstance.SetParametres({avecSousMenu:false,largeurMaxLibelle:150});};ObjetAffichageBandeauEntete.prototype._initialiserOngletNotification=function(AInstance){AInstance.SetParametres({avecSousMenu:false,width:64,avecCompteur:true,largeurListe:185,bloquerCouleurOnglet:true});};ObjetAffichageBandeauEntete.prototype.initialiserMenuPlus=function(aInstance){aInstance.SetParametres({avecPlusieursNiveau:false,libelleCentre:true});};ObjetAffichageBandeauEntete.prototype.initialiserMenuRessources=function(aInstance){aInstance.SetParametres({avecPlusieursNiveau:false,libelleCentre:true,actionSurClickSiSeul:true});};ObjetAffichageBandeauEntete.prototype.initialiserMenuAccueil=function(aInstance){aInstance.SetParametres({avecPlusieursNiveau:false,libelleCentre:true,actionSurClickSiSeul:true});};ObjetAffichageBandeauEntete.prototype.SetDonnees=function(ALibelle,AListeEleves,AMessageConnexion){this.actualiserListeMembres(ALibelle,AListeEleves,AMessageConnexion);this._modificationMembre();if(GEtatUtilisateur.listeOngletsNotification.GetNbrElements()){var lOngletNotification=new ObjetElement('<span class="InlineBlock Image_Cloche_Notification"><span class="wai_hidden">'+GTraductions.getValeur('Onglet.Libelle')[EGenreOnglet.GeneralVieEtablissement]+'</span></span>');this.GetInstance(this.identOngletNotification).SetDonnees(GEtatUtilisateur.listeOngletsNotification);this.GetInstance(this.identOngletNotification).setLibelleOnglet(lOngletNotification);}
this.GetInstance(this.identMenuOnglets).SetDonnees(GEtatUtilisateur.listeOnglets,GEtatUtilisateur.getGenreOngletPere(),GEtatUtilisateur.getGenreOnglet());if(this.identMenuPlus!==undefined){this.setDonneesMenuPlus();}
if(this.identMenuRessources!==undefined){this.setDonneesMenuRessources();}
if(this.identMenuAccueil!==undefined){this.setDonneesMenuAccueil();}};ObjetAffichageBandeauEntete.prototype.actualiserLibelleOnglet=function(){$('#breadcumBandeau').html(this.GetInstance(this.identMenuOnglets).getLibelleGenreOnglet(GEtatUtilisateur.getGenreOnglet()));};ObjetAffichageBandeauEntete.prototype.setDonneesMenuPlus=function(){this.listeElementsMenuPlus=new ObjetListeElements();var lElement=new ObjetElement('',null,null,true);lElement.Visible=true;lElement.estUnOnglet=true;lElement.profondeur=0;lElement.avecClic=true;lElement.genreCommande=EGenreCommandePersonnel.CommandeBouton;lElement.genreCommandeBouton=EGenreCommande.Accessibilite;lElement.htmlAttributs='ie-html="libelleOnglet"';lElement.controleur={libelleOnglet:function(){return GEtatUtilisateur.getModeAccessible()?GTraductions.getValeur('Commande.Accessible.Desactive'):GTraductions.getValeur('Commande.Accessible.Actif');}};this.listeElementsMenuPlus.AddElement(lElement);lElement=new ObjetElement(GTraductions.getValeur('Commande.Manuel.Actif'),null,null,true);lElement.Visible=true;lElement.estUnOnglet=true;lElement.profondeur=0;lElement.avecClic=true;lElement.genreCommande=EGenreCommandePersonnel.CommandeBouton;lElement.genreCommandeBouton=EGenreCommande.Aide;this.listeElementsMenuPlus.AddElement(lElement);if(GEtatUtilisateur.existeTutoriel()&&GEtatUtilisateur.avecTutoriel()){lElement=new ObjetElement(GTraductions.getValeur('Commande.Tutoriel.Actif'),null,null,true);lElement.Visible=true;lElement.estUnOnglet=true;lElement.profondeur=0;lElement.avecClic=true;lElement.genreCommande=EGenreCommandePersonnel.CommandeBouton;lElement.genreCommandeBouton=EGenreCommande.Tutoriel;this.listeElementsMenuPlus.AddElement(lElement);}
if(GParametres.avecAccesMobile){lElement=new ObjetElement(GTraductions.getValeur('Commande.AccesMobile.Actif',[GParametres.GetNomEspace()]),null,null,true);lElement.Visible=true;lElement.estUnOnglet=true;lElement.profondeur=0;lElement.avecClic=true;lElement.genreCommande=EGenreCommandePersonnel.CommandeBouton;lElement.genreCommandeBouton=EGenreCommande.AccesMobile;this.listeElementsMenuPlus.AddElement(lElement);}
if(GApplication.droits.get(IEEnum.droits.fonctionnalites.gestionTwitter)){lElement=new ObjetElement(GTraductions.getValeur('Commande.SuivrePronoteTwitter.Actif'),null,null,true);lElement.Visible=true;lElement.estUnOnglet=true;lElement.profondeur=0;lElement.avecClic=true;lElement.genreCommande=EGenreCommandePersonnel.CommandeBouton;lElement.genreCommandeBouton=EGenreCommande.Twitter;this.listeElementsMenuPlus.AddElement(lElement);}
if(((GEtatUtilisateur.GenreEspace===EGenreEspace.Professeur)||(GEtatUtilisateur.GenreEspace===EGenreEspace.Etablissement))&&(GEtatUtilisateur.urlInstallClient)){lElement=new ObjetElement(GTraductions.getValeur('Commande.TelechargerClient.Actif'),null,null,true);lElement.Visible=true;lElement.estUnOnglet=true;lElement.profondeur=0;lElement.avecClic=true;lElement.genreCommande=EGenreCommandePersonnel.CommandeBouton;lElement.genreCommandeBouton=EGenreCommande.TelechargerClient;this.listeElementsMenuPlus.AddElement(lElement);}
this.GetInstance(this.identMenuPlus).SetDonnees(this.listeElementsMenuPlus);this.GetInstance(this.identMenuPlus).setLibelleOnglet(new ObjetElement(GTraductions.getValeur('Commandes.Onglet.Plus')));};ObjetAffichageBandeauEntete.prototype.setDonneesMenuRessources=function(aVisibleKiosque){var lElement,lListe=new ObjetListeElements();var lOnglet=GEtatUtilisateur.listeOnglets.GetElementParNumeroEtGenre(null,EGenreOnglet.RessourcePedagogique);if(lOnglet&&lOnglet.Actif){lElement=new ObjetElement(lOnglet.GetLibelle(),0,EGenreOnglet.RessourcePedagogique,null,true);lElement.Visible=true;lElement.estUnOnglet=true;lElement.profondeur=0;lElement.avecClic=true;lElement.genreCommande=EGenreCommandePersonnel.onglet;lListe.AddElement(lElement);}
if(GEtatUtilisateur.avecFenetreKiosque()&&aVisibleKiosque){lElement=new ObjetElement(GTraductions.getValeur('Commande.FenetreKiosque.Titre'),null,null,true);lElement.Visible=true;lElement.estUnOnglet=true;lElement.profondeur=0;lElement.avecClic=true;lElement.genreCommandeBouton=EGenreCommande.Kiosque;lElement.genreCommande=EGenreCommandePersonnel.CommandeBouton;lListe.AddElement(lElement);}
if(GEtatUtilisateur.avecIManuel()){lElement=new ObjetElement(GTraductions.getValeur('Onglet.Libelle')[EGenreOnglet.IManuels],null,null,true);lElement.Visible=true;lElement.estUnOnglet=true;lElement.profondeur=0;lElement.avecClic=true;lElement.genreCommandeBouton=EGenreCommande.IManuel;lElement.genreCommande=EGenreCommandePersonnel.CommandeBouton;lListe.AddElement(lElement);}
if(GEtatUtilisateur.avecOngletIManuel()){lElement=new ObjetElement(GTraductions.getValeur('Onglet.Libelle')[EGenreOnglet.IManuels],null,EGenreOnglet.IManuels);lElement.Visible=true;lElement.estUnOnglet=true;lElement.profondeur=0;lElement.avecClic=true;lElement.genreCommande=EGenreCommandePersonnel.onglet;lListe.AddElement(lElement);}
this.GetInstance(this.identMenuRessources).SetDonnees(lListe);this.GetInstance(this.identMenuRessources).setLibelleOnglet(new ObjetElement('<span title="'+(lListe.GetNbrElements()===1?lListe.GetLibelle(0):'')+'" style="width: 31px; overflow: hidden;" class="InlineBlock Image_CommandeKiosque"><span class="wai_hidden">'+(lListe.GetNbrElements()===1?lListe.GetLibelle(0):GTraductions.getValeur('Onglet.Libelle')[EGenreOnglet.RessourcePedagogique])+'</span></span>'));};ObjetAffichageBandeauEntete.prototype.setDonneesMenuAccueil=function(){var lElement,lListe=new ObjetListeElements();var lOnglet=GEtatUtilisateur.listeOnglets.GetElementParNumeroEtGenre(null,EGenreOnglet.Accueil);if(lOnglet){lElement=new ObjetElement(lOnglet.GetLibelle(),0,EGenreOnglet.Accueil,null,true);lElement.Visible=true;lElement.estUnOnglet=true;lElement.profondeur=0;lElement.avecClic=true;lElement.genreCommande=EGenreCommandePersonnel.onglet;lListe.AddElement(lElement);}
this.GetInstance(this.identMenuAccueil).SetDonnees(lListe);this.GetInstance(this.identMenuAccueil).setLibelleOnglet(new ObjetElement('<span title="'+GTraductions.getValeur('Commande.Accueil.Actif')+'" style="width: 31px; overflow: hidden;" class="InlineBlock Image_CommandeAccueil"><span class="wai_hidden">'+GTraductions.getValeur('Commande.Accueil.Actif')+'</span></span>'));};ObjetAffichageBandeauEntete.prototype.ConstruireStructureAffichageAutre=function(){var H=[];var lStyle=GStyle.composeCouleur(GCouleur.blanc,GCouleur.noir)+' '+GStyle.composeTaillePolice(18);var lImageEspace='Image_EspaceInvites';switch(GEtatUtilisateur.GenreEspace){case EGenreEspace.Professeur:lImageEspace='Image_EspaceEnseignants';break;case EGenreEspace.Eleve:lImageEspace='Image_EspaceEtudiants';break;case EGenreEspace.Etablissement:lImageEspace='Image_EspaceSecretariat';break;case EGenreEspace.Parent:lImageEspace='Image_EspaceParents';break;case EGenreEspace.Entreprise:lImageEspace='Image_EspaceEntreprise';break;case EGenreEspace.Academie:lImageEspace='Image_EspaceAcademie';break;}
H.push(GObjetWAI.composeSpan('',this.idAideAprèsConnexion));H.push('<table style="',GStyle.composeCouleurFond(GCouleur.blanc),'width:100%" border="0" cellpadding="0" cellspacing="5" ',GObjetWAI.composeRole(EGenreRole.Banner),'>');H.push('<tr>','<td class="Texte Gras" style="'+lStyle+'" ','>');if(GEtatUtilisateur.avecPageAccueil())
H.push('<div class="AvecMain" style="width: 280px;" title="',GTraductions.getValeur('Commande.Accueil.Actif'),'" onclick="',this.GetInstance(this.identMenuAccueil).GetNom(),'.SurValidation(true, 0);">');else H.push('<div style="width: 280px;">');H.push('<div style="width:0;height:100%;" class="InlineBlock AlignementMilieuVertical"></div>');H.push('<span class="InlineBlock ',lImageEspace,' AlignementMilieuVertical" style="background-color:',GCouleur.noir,';color:',GCouleur.blanc,';margin:0 10px 0 5px;">&nbsp;</span><span class="AlignementMilieuVertical">'+GChaine.Insecable(GParametres.NomEspace)+'</span>');H.push('</div>');H.push('</td>');if(this.GetInstance(this.identComboMembres))
H.push('<td class="AlignementMilieu" style="width: 100%">',GParametres.avecBoutonMembre?'<div id="'+this.idBoutonMembre+'" class="AlignementHaut boutonMembre Texte10 Gras AvecMain" style="'+GStyle.composeCouleurTexte(GCouleur.themeCouleur.foncee)+'" title="'+GTraductions.getValeur('hint.boutonMembre')+'" onclick="'+this.Nom+'._evenementBoutonMembre ()">'+GTraductions.getValeur('boutonMembre')+'</div>':'','<div id="',this.GetInstance(this.identComboMembres).GetNom(),'" class="AlignementHaut EspaceGauche InlineBlock AlignementGauche Texte14 Gras"></div>','</td>');H.push('<td class="Texte AlignementDroit" style="',lStyle,'">',GChaine.Insecable(GParametres.NomEtablissement),'</td>');H.push('</tr>');H.push('</table>');H.push('<div class="Image_FondMenuOnglet" style="border-top: 1px solid #c5c5c5;position:relative;background-color:',GCouleur.noir,';">');H.push('<table style="height:35px" border="0" cellpadding="0" cellspacing="0" ',GObjetWAI.composeRole(EGenreRole.Navigation),'>');H.push('<tr>');H.push('<td class="AlignementGauche" id="'+this.Instances[this.identCommande].GetNom()+'" ',GObjetWAI.composeRole(EGenreRole.Menubar),GObjetWAI.composeAttribut({genre:EGenreAttribut.describedby,valeur:GObjetWAI.idInfoWai[EGenreObjet.NavigationHorizontalAvecValidation]}),'></td>');H.push('<td class="AlignementHaut" style="width:100%;'+(this.GetInstance(this.identMenuOnglets)||this.GetInstance(this.identMenuPlus)?'border-left:#a7a7a7 1px solid;':'')+'">');if(this.GetInstance(this.identMenuOnglets)||this.GetInstance(this.identMenuPlus)||GEtatUtilisateur.acces.estConnexionDirect()){H.push('<table tabIndex="-1" cellpadding="0" cellspacing="0" ');if(this.GetInstance(this.identMenuOnglets)||this.GetInstance(this.identMenuPlus)){H.push(GObjetWAI.composeRole(EGenreRole.Menubar));H.push(GObjetWAI.composeAttribut({genre:EGenreAttribut.describedby,valeur:GObjetWAI.idInfoWai[EGenreObjet.BarreOngletsPrincipal]}));}
H.push('>');H.push('<tr>');if(this.GetInstance(this.identMenuAccueil)){H.push('<td id="'+this.GetInstance(this.identMenuAccueil).GetNom()+'" class="AlignementHaut"></td>');}
if(this.GetInstance(this.identMenuRessources)){H.push('<td id="'+this.GetInstance(this.identMenuRessources).GetNom()+'" class="AlignementHaut"></td>');}
if(this.GetInstance(this.identMenuOnglets)){H.push('<td id="'+this.GetInstance(this.identMenuOnglets).GetNom()+'" class="AlignementHaut"></td>');}
if(this.GetInstance(this.identMenuPlus)){H.push('<td id="'+this.GetInstance(this.identMenuPlus).GetNom()+'" class="AlignementHaut"></td>');}
if(this.GetInstance(this.identMenuOnglets)||this.GetInstance(this.identMenuPlus)||GEtatUtilisateur.acces.estConnexionDirect()) H.push('<td class="AlignementHaut" style="border-left:#323436 1px solid;height:100%;width:10px;"></td>');H.push('</tr></table>');}
H.push('</td>');H.push('<td'+(this.GetInstance(this.identOngletUtilisateur)?' style="border-left:#a7a7a7 1px solid;"':'')+'>');if(this.GetInstance(this.identOngletUtilisateur)){H.push('<div id="'+this.GetInstance(this.identOngletUtilisateur).GetNom()+'" class="AlignementHaut" style="overflow:hidden;" ',GObjetWAI.composeRole(EGenreRole.Menu),'></div>');}
if(false){H.push('<div class="AlignementHaut SouligneSurFocus AvecMain Texte12 Titre objetMenuOngletCombo" style="height:100%;color:'+GCouleur.blanc+';"><div class="InlineBlock" style="height:100%;vertical-align:middle;"></div><div id="'+this.idLibelleConnexionDirecte+'" class="InlineBlock" style="vertical-align:middle;"></div></div>');}
H.push('</td>');H.push('<td'+(!this.GetInstance(this.identOngletUtilisateur)&&this.GetInstance(this.identOngletNotification)?' style="border-left:#a7a7a7 1px solid;"':'')+'>');if(this.GetInstance(this.identOngletNotification)){H.push('<div id="'+this.GetInstance(this.identOngletNotification).GetNom()+'" class="AlignementHaut" ',GObjetWAI.composeRole(EGenreRole.Menu),'></div>');}
H.push('</td>');H.push('</tr>');H.push('</table>');H.push('</div>');H.push('<div id="ligneseparateur" style="border-top : 1px solid '+(GNavigateur.IsIE8?'#C3B9BC':'rgba(255, 255, 255, .5)')+'; height: 3px; '+GStyle.composeCouleur(GCouleur.bandeau.separateur,GCouleur.blanc)+'">'+GHtml.composeBlanc()+'</div>');H.push('<div id="',GApplication.idLigneBandeau,'" style="',GStyle.composeCouleurBordure(GCouleur.bandeau.bordure,5),'" ',GObjetWAI.composeRole(EGenreRole.Complementary),'>');H.push('<table style="width:100%;',GStyle.composeCouleur(GCouleur.bandeau.fond,GCouleur.bandeau.texte),'" class="Texte10 Gras" border="0" cellpadding="0" cellspacing="0" ',GObjetWAI.composeRole(EGenreRole.Presentation),'>');H.push('<tr>');H.push('<td style="height: '+GApplication.hauteurBandeau+'px; white-space:nowrap;" ><h1 id="'+GApplication.idBreadcrumb+'" class="Gras EspaceGauche Texte10" style="white-space:nowrap;margin:0;" tabIndex="0"></h1></td>');H.push('<td id="bandeau" class="EspaceDroit" style="width: 100%; height: '+GApplication.hauteurBandeau+'px"></td>');H.push('</tr>');H.push('</table>');H.push('</div>');H.push(GObjetWAI.composeSpan(GTraductions.getValeur('Navigation.AideRaccourcisClavier')+GTraductions.getValeur('Navigation.AideRaccourcisClavierDetails'),this.idAideRaccourcisClavier));return H.join('');};ObjetAffichageBandeauEntete.prototype.actualiserListeMembres=function(ALibelle,AListeRessources,AMessageConnexion){var lElement,lElementSource;if(GEtatUtilisateur.estEspaceAvecMembre()){if(AListeRessources.GetNbrElements()){this.GetInstance(this.identComboMembres).SetVisible(true);if(AListeRessources.GetNbrElements()>1){var lIndiceMembre=0;var lMembre=GEtatUtilisateur.getMembre();if(lMembre){lIndiceMembre=AListeRessources.GetIndiceParElement(lMembre);if(!lIndiceMembre) lIndiceMembre=0;}
var lListeRessources=new ObjetListeElements();for(var i=0;i<AListeRessources.GetNbrElements();i++){lElementSource=AListeRessources.GetElement(i);lElement=MethodesObjet.dupliquer(lElementSource,true);if(lElement.Classe){lElement.libelleCourt=lElement.Libelle;lElement.Libelle=lElement.libelleLong;}
lListeRessources.AddElement(lElement);}
this.GetInstance(this.identComboMembres).SetDonnees(lListeRessources,lIndiceMembre);} else{lElement=AListeRessources.GetElement(0);GEtatUtilisateur.SetNumeroEleve(lElement.GetNumero());GHtml.setHtml(this.GetInstance(this.identComboMembres).GetNom(),'<div style="padding-top: 3px;"> '+lElement.libelleLong+'</div>');GHtml.setTitle(this.idBoutonMembre,GTraductions.getValeur('hint.boutonMembre',[lElement.GetLibelle()]));}}}};ObjetAffichageBandeauEntete.prototype.actualiserBreadcrumb=function(aGenreOnglet){if(aGenreOnglet===EGenreOnglet.Accueil)
this.setLibelleMenuOnglet(GEtatUtilisateur.listeOnglets.GetElementParGenre(EGenreOnglet.Accueil));else{var lListeOnglet=GEtatUtilisateur.listeOnglets.getListeElements(function(aEle){return aEle.GetGenre()===aGenreOnglet;});this.setLibelleMenuOnglet(lListeOnglet.GetElement(0));}};ObjetAffichageBandeauEntete.prototype.setLibelleMenuOnglet=function(aOnglet){var lLibelle=aOnglet?(aOnglet.libelleLong?aOnglet.libelleLong:aOnglet.GetLibelle()?aOnglet.GetLibelle():''):'';$('#'+GApplication.idBreadcrumb.escapeJQ()).html(lLibelle+'&nbsp;');$('#'+GApplication.idBreadcrumbPerso.escapeJQ()).html(lLibelle);};ObjetAffichageBandeauEntete.prototype.getLibelleSousOnglet=function(aLibelle,aAvecNom,aAvecClasse,aAvecGroupe,aSansLibelleOnglet){if(this.sousOnglet===null||this.sousOnglet===undefined)
return'';if(!((this.sousOnglet.GetGenre()===EGenreOnglet.Informations)||(this.sousOnglet.GetGenre()===EGenreOnglet.EmploiDuTemps)||(this.sousOnglet.GetGenre()===EGenreOnglet.EquipePedagogique)))
aAvecGroupe=false;var lLibelleParametres=[];if(!aSansLibelleOnglet){var lLibelleOnglet=this.sousOnglet.libelleImpression;if(lLibelleOnglet)
lLibelleParametres.push(lLibelleOnglet);}
if(MethodesObjet.isString(aAvecNom)){if(lLibelleParametres.length)
lLibelleParametres.push(' ',GTraductions.getValeur('De'),' ');lLibelleParametres.push(aAvecNom);} else if(aAvecNom){if(lLibelleParametres.length)
lLibelleParametres.push(' ',GTraductions.getValeur('De'),' ');var lGenreOnglet=this.sousOnglet.GetGenre();var lNom='';if(GEtatUtilisateur.GenreEspace===EGenreEspace.Professeur){if((lGenreOnglet===EGenreOnglet.Competences_Releve)||(lGenreOnglet===EGenreOnglet.B2I_ParEleve)||(lGenreOnglet===EGenreOnglet.SaisieAppreciationDeFinDeStage))
lNom=GEtatUtilisateur.Navigation.GetLibelleRessource(EGenreRessource.Eleve);else lNom=GEtatUtilisateur.GetLibelleRessource();} else lNom=GEtatUtilisateur.GetLibelleEleve();lLibelleParametres.push(lNom);}
var lLibelle=GEtatUtilisateur.Navigation.GetLibelleRessource(EGenreRessource.Classe);if(aAvecClasse&&(GEtatUtilisateur.GenreEspace===EGenreEspace.Professeur)&&lLibelle)
lLibelleParametres.push(' &#45; ',GTraductions.getValeur('Classe'),' ',GTraductions.getValeur('De'),' ',lLibelle);lLibelle=GEtatUtilisateur.Identification.GetLibelleClasse();if(aAvecClasse&&((GEtatUtilisateur.GenreEspace===EGenreEspace.Parent)||(GEtatUtilisateur.GenreEspace===EGenreEspace.Eleve))&&lLibelle)
lLibelleParametres.push(' &#45; ',GTraductions.getValeur('Classe'),' ',GTraductions.getValeur('De'),' ',lLibelle);lLibelle=GEtatUtilisateur.Identification.GetLibelleGroupes();if(aAvecGroupe&&((GEtatUtilisateur.GenreEspace===EGenreEspace.Parent)||(GEtatUtilisateur.GenreEspace===EGenreEspace.Eleve))&&lLibelle&&(lLibelle.length<100))
lLibelleParametres.push(' &#45; ',GTraductions.getValeur('Groupe'),' ',GTraductions.getValeur('De'),' ',lLibelle);if(aLibelle)
lLibelleParametres.push(' &#45; ',aLibelle);lLibelleParametres.push('<span id="'+this.Nom+'_ComplementBandeau" class="Texte10 Gras"></span>');return lLibelleParametres.join('');};ObjetAffichageBandeauEntete.prototype.evenementSurMenuOnglets=function(aSousOnglet,aIgnorerHistorique){this.sousOnglet=aSousOnglet===null||aSousOnglet===undefined?this.sousOnglet:aSousOnglet;if(this.sousOnglet)
this.callback.appel({genreCmd:EGenreCommande.ChangerOnglet,onglet:this.sousOnglet,ignorerHistorique:aIgnorerHistorique});};ObjetAffichageBandeauEntete.prototype.evenementSurMenuPlus=function(aSousOnglet){if(aSousOnglet.GetGenre()!==null&&aSousOnglet.GetGenre()!==undefined){if(this.GetInstance(this.identMenuOnglets)) this.GetInstance(this.identMenuOnglets).setCouleurOnglet();if(this.GetInstance(this.identMenuRessources)) this.GetInstance(this.identMenuRessources).setCouleurOnglet();if(this.GetInstance(this.identOngletUtilisateur)) this.GetInstance(this.identOngletUtilisateur).setCouleurOnglet();if(this.GetInstance(this.identMenuAccueil)) this.GetInstance(this.identMenuAccueil).setCouleurOnglet();}
this.EvenementBouton({genreCmd:aSousOnglet.genreCommandeBouton});};ObjetAffichageBandeauEntete.prototype.evenementSurMenuRessources=function(aElement){if(!aElement)
return;if(aElement.GetGenre()!==null&&aElement.GetGenre()!==undefined){if(this.GetInstance(this.identMenuOnglets)) this.GetInstance(this.identMenuOnglets).setCouleurOnglet();if(this.GetInstance(this.identMenuPlus)) this.GetInstance(this.identMenuPlus).setCouleurOnglet();if(this.GetInstance(this.identOngletUtilisateur)) this.GetInstance(this.identOngletUtilisateur).setCouleurOnglet();if(this.GetInstance(this.identMenuAccueil)) this.GetInstance(this.identMenuAccueil).setCouleurOnglet();}
switch(aElement.genreCommande){case EGenreCommandePersonnel.onglet:GInterface.changementManuelOnglet(aElement.GetGenre());return;case EGenreCommandePersonnel.CommandeBouton:this.EvenementBouton({genreCmd:aElement.genreCommandeBouton});return;}};ObjetAffichageBandeauEntete.prototype.evenementSurMenuAccueil=function(aElement){if(!aElement)
return;if(aElement.GetGenre()!==null&&aElement.GetGenre()!==undefined){if(this.GetInstance(this.identMenuOnglets)) this.GetInstance(this.identMenuOnglets).setCouleurOnglet();if(this.GetInstance(this.identMenuPlus)) this.GetInstance(this.identMenuPlus).setCouleurOnglet();if(this.GetInstance(this.identOngletUtilisateur)) this.GetInstance(this.identOngletUtilisateur).setCouleurOnglet();if(this.GetInstance(this.identMenuRessources)) this.GetInstance(this.identMenuRessources).setCouleurOnglet();}
switch(aElement.genreCommande){case EGenreCommandePersonnel.onglet:if(this.GetInstance(this.identMenuOnglets)) this.GetInstance(this.identMenuOnglets).setCouleurOnglet();if(this.GetInstance(this.identMenuPlus)) this.GetInstance(this.identMenuPlus).setCouleurOnglet();if(this.GetInstance(this.identOngletUtilisateur)) this.GetInstance(this.identOngletUtilisateur).setCouleurOnglet();if(this.GetInstance(this.identMenuRessources)) this.GetInstance(this.identMenuRessources).setCouleurOnglet();GInterface.changementManuelOnglet(aElement.GetGenre());return;}};ObjetAffichageBandeauEntete.prototype._evenementBoutonMembre=function(aGenre){var lParam={genreCmd:EGenreCommande.BoutonMembre};this.callback.appel(lParam);};ObjetAffichageBandeauEntete.prototype._evenementOngletUtilisateur=function(aElement){if(!aElement)
return;if(aElement.GetGenre()!==null&&aElement.GetGenre()!==undefined){if(this.GetInstance(this.identMenuOnglets)) this.GetInstance(this.identMenuOnglets).setCouleurOnglet();if(this.GetInstance(this.identMenuRessources)) this.GetInstance(this.identMenuRessources).setCouleurOnglet();if(this.GetInstance(this.identMenuPlus)) this.GetInstance(this.identMenuPlus).setCouleurOnglet();if(this.GetInstance(this.identMenuAccueil)) this.GetInstance(this.identMenuAccueil).setCouleurOnglet();}
switch(aElement.genreCommande){case EGenreCommandePersonnel.deconnexion:GApplication.getMessage().afficher({type:EGenreBoiteMessage.Confirmation,titre:!GApplication.getDemo()&&GEtatUtilisateur.EtatSaisie?GTraductions.getValeur('connexion.DeconnexionSaisieNonValidee'):'',message:GTraductions.getValeur('connexion.ConfirmezDeconnexion'),callback:this._surReponseMessageDeconnexion});return;case EGenreCommandePersonnel.onglet:GInterface.changementManuelOnglet(aElement.GetGenre());return;case EGenreCommandePersonnel.telechargerCertificatScolarite:IE.GenerationPDF.genererPDF({paramPDF:{genreGenerationPDF:TypeHttpGenerationPDF.CertificatScolarite}});return;case EGenreCommandePersonnel.ExportFichierProf:this.callback.appel({genreCmd:EGenreCommande.ExportFichierProf});return;case EGenreCommandePersonnel.ImportFichierProf:this.callback.appel({genreCmd:EGenreCommande.ImportFichierProf});return;}};ObjetAffichageBandeauEntete.prototype._surReponseMessageDeconnexion=function(aValeur){if(aValeur===0){Invocateur.desabonner(Invocateur.events.autorisationRechargementPage);if(GApplication.acces.estConnexionCAS()){window.location.href=IE.UtilitaireMessageHtml.construireUrl(IE.Enum.EGenreMessageHtml.deconnexionENT);} else{new ObjetRequeteSaisieDeconnexion(this).lancerRequete({decoManuelle:true});}}};ObjetAffichageBandeauEntete.prototype._evenementOngletNotification=function(aElement){if(!aElement)
return;GInterface.changementManuelOnglet(aElement.GetGenre());};ObjetAffichageBandeauEntete.prototype._modificationMembre=function(aMembre){var lLibelle=GChaine.Insecable(GEtatUtilisateur.Identification.ressource.GetLibelle());if(GEtatUtilisateur.estEspaceEleve()) lLibelle+='<br />('+GEtatUtilisateur.Identification.GetLibelleClasse()+')';var lOnglet=new ObjetElement(lLibelle);this._actualiserOngletUtilisateur();this.GetInstance(this.identOngletUtilisateur).setLibelleOnglet(lOnglet);$('#'+this.idAideAprèsConnexion.escapeJQ()).attr(GObjetWAI.WaiAttribut[EGenreAttribut.label],GParametres.NomEspace+' '+lLibelle);};ObjetAffichageBandeauEntete.prototype.focusAuDebut=function(){$('#'+this.idAideAprèsConnexion.escapeJQ()).focus();};ObjetAffichageBandeauEntete.prototype._notificationCommunication=function(aNotificationsCommunication){if(aNotificationsCommunication&&GEtatUtilisateur.listeOngletsNotification.GetNbrElements()){var lTotal=0;for(var x in aNotificationsCommunication){if(aNotificationsCommunication[x]&&aNotificationsCommunication[x].onglet){var lOnglet=GEtatUtilisateur.listeOngletsNotification.GetElementParNumeroEtGenre(null,aNotificationsCommunication[x].onglet);if(lOnglet){if(GApplication.parametresUtilisateur.get('utiliserNotification')&&aNotificationsCommunication[x].onglet===EGenreOnglet.Messagerie&&lOnglet.compteur<aNotificationsCommunication[x].nb){IE.Notification.afficher({title:lOnglet.GetLibelle(),msg:lOnglet.GetLibelle()+' : '+aNotificationsCommunication[x].nb,onclick:GInterface.changementManuelOnglet.bind(GInterface,lOnglet.GetGenre()),icon:'FichiersRessource/Message.png'});}
lOnglet.compteur=aNotificationsCommunication[x].nb;lTotal+=lOnglet.compteur;}}}
_actualiserOngletNotification.bind(this)(lTotal);}};ObjetAffichageBandeauEntete.prototype._modifierNotificationComunications=function(aGenreOnglet,aModificateur){if(aModificateur===0||!GEtatUtilisateur.listeOngletsNotification.GetNbrElements())
return;var lOnglet=GEtatUtilisateur.listeOngletsNotification.GetElementParNumeroEtGenre(null,aGenreOnglet);if(lOnglet){lOnglet.compteur+=aModificateur;}
var lTotal=0;GEtatUtilisateur.listeOngletsNotification.parcourir(function(D){lTotal+=D.compteur;});_actualiserOngletNotification.bind(this)(lTotal>0);};function _actualiserOngletNotification(aActif){var lOngletNotification=new ObjetElement('<span class="InlineBlock Image_Cloche_Notification'+(aActif?'_actif':'')+'"><span class="wai_hidden">'+GTraductions.getValeur('Onglet.Libelle')[EGenreOnglet.GeneralVieEtablissement]+'</span></span>');this.GetInstance(this.identOngletNotification).SetDonnees(GEtatUtilisateur.listeOngletsNotification);this.GetInstance(this.identOngletNotification).setLibelleOnglet(lOngletNotification);}
ObjetAffichageBandeauEntete.prototype._actualiserOngletUtilisateur=function(){var lListe=new ObjetListeElements(),lElement,lOnglet;lOnglet=GEtatUtilisateur.listeOnglets.GetElementParNumeroEtGenre(null,EGenreOnglet.InfosPerso);if(lOnglet&&lOnglet.Actif){lElement=new ObjetElement(lOnglet.GetLibelle(),0,EGenreOnglet.InfosPerso,null,true);lElement.libelleLong=lOnglet.libelleLong;lElement.Visible=true;lElement.estUnOnglet=true;lElement.profondeur=0;lElement.avecClic=true;lElement.genreCommande=EGenreCommandePersonnel.onglet;lListe.AddElement(lElement);}
if(GEtatUtilisateur.GenreEspace===EGenreEspace.Eleve&&GApplication.droits.get(IEEnum.droits.avecPDFCertificatScolarite)){lElement=new ObjetElement(GTraductions.getValeur('Commande.CertificatScolarite.Actif'),0,null,null,true);lElement.Visible=true;lElement.estUnOnglet=false;lElement.profondeur=0;lElement.avecClic=true;lElement.genreCommande=EGenreCommandePersonnel.telechargerCertificatScolarite;lListe.AddElement(lElement);}
lOnglet=GEtatUtilisateur.listeOnglets.GetElementParNumeroEtGenre(null,EGenreOnglet.Entreprise);if(lOnglet&&lOnglet.Actif){lElement=new ObjetElement(lOnglet.GetLibelle(),0,EGenreOnglet.Entreprise,null,true);lElement.libelleLong=lOnglet.libelleLong;lElement.Visible=true;lElement.estUnOnglet=true;lElement.profondeur=0;lElement.avecClic=true;lElement.genreCommande=EGenreCommandePersonnel.onglet;lListe.AddElement(lElement);}
lOnglet=GEtatUtilisateur.listeOnglets.GetElementParNumeroEtGenre(null,EGenreOnglet.ParametresUtilisateur);if(lOnglet&&lOnglet.Actif){lElement=new ObjetElement(lOnglet.GetLibelle(),0,EGenreOnglet.ParametresUtilisateur,null,true);lElement.Visible=true;lElement.estUnOnglet=true;lElement.profondeur=0;lElement.avecClic=true;lElement.genreCommande=EGenreCommandePersonnel.onglet;lListe.AddElement(lElement);}
if(GEtatUtilisateur.GenreEspace===EGenreEspace.Professeur&&!GApplication.getDemo()&&GEtatUtilisateur.genreConnexion===EGenreConnexion.Normale&&!GNavigateur.isIpad&&!GNavigateur.isIphone){lElement=new ObjetElement(GTraductions.getValeur('Commande.RecupererFichierDeRessources'),0,null,null,true);lElement.Visible=true;lElement.estUnOnglet=false;lElement.profondeur=0;lElement.avecClic=true;lElement.genreCommande=EGenreCommandePersonnel.ImportFichierProf;lListe.AddElement(lElement);lElement=new ObjetElement(GTraductions.getValeur('Commande.CreerUnFichierDeRessources'),0,null,null,true);lElement.Visible=true;lElement.estUnOnglet=false;lElement.profondeur=0;lElement.avecClic=true;lElement.genreCommande=EGenreCommandePersonnel.ExportFichierProf;lListe.AddElement(lElement);}
lElement=new ObjetElement(GTraductions.getValeur('connexion.SeDeconnecter'),0,null,null,true);lElement.Visible=true;lElement.estUnOnglet=true;lElement.profondeur=0;lElement.avecClic=true;lElement.genreCommande=EGenreCommandePersonnel.deconnexion;lListe.AddElement(lElement);this.GetInstance(this.identOngletUtilisateur).SetDonnees(lListe);};ObjetAffichageBandeauEntete.prototype.EvenementBouton=function(aParam,aGenreBouton){if(aGenreBouton!==1){if(aParam.genreCmd===EGenreCommande.Accueil){if(this.GetInstance(this.identMenuOnglets)) this.GetInstance(this.identMenuOnglets).setCouleurOnglet();if(this.GetInstance(this.identMenuPlus)) this.GetInstance(this.identMenuPlus).setCouleurOnglet();if(this.GetInstance(this.identMenuRessources)) this.GetInstance(this.identMenuRessources).setCouleurOnglet();if(this.GetInstance(this.identOngletUtilisateur)) this.GetInstance(this.identOngletUtilisateur).setCouleurOnglet();this.sousOnglet=GEtatUtilisateur.listeOnglets.GetElementParGenre(EGenreOnglet.Accueil);}
this.callback.appel(aParam);}};ObjetAffichageBandeauEntete.prototype.evenementRaccourcisClavier=function(aNumeroTouche){switch(aNumeroTouche){case 0:$('#'+this.GetInstance(this.identMenuOnglets).NomEdit.escapeJQ()+this.GetInstance(this.identMenuOnglets).NomNiveau[0]).focus();break;case 1:this.GetInstance(this.identCommande).Instances[ this.GetInstance(this.identCommande).instancesActif[0]].FocusSurPremierElement();break;}};ObjetAffichageBandeauEntete.prototype._evenementSurComboMembres=function(aGenreEvenement,aElement){if(aGenreEvenement===EGenreEvenementObjetSaisie.selection){GHtml.setTitle(this.idBoutonMembre,GTraductions.getValeur('hint.boutonMembre',[aElement.libelleCourt]));if(this.GetInstance(this.identComboMembres).EstUneInteractionUtilisateur())
this.EvenementSurNavigation(this,aElement);}};ObjetAffichageBandeauEntete.prototype.RetourSurNavigation=function(aElement){this.SetEtatSaisie(false);GEtatUtilisateur.SetNumeroEleve(aElement.GetNumero());IE.Invocateur.evenement('modification_Membre',aElement);IE.Invocateur.evenement('modification_Membre_FenetreKiosque',aElement);this.evenementSurMenuOnglets();};ObjetAffichageBandeauEntete.prototype.evenementSurSousOnglet=function(){this.GetInstance(this.identMenuOnglets).deroulerListeSecondaire(this.idSousOnglet);};ObjetAffichageBandeauEntete.prototype.selectionnerSousOnglet=function(aGenreSousOnglet){this.GetInstance(this.identMenuOnglets).selectionnerSousOnglet(aGenreSousOnglet);};ObjetAffichageBandeauEntete.prototype.setVisibleKiosque=function(aVisibleKiosque){this.setDonneesMenuRessources(aVisibleKiosque);};ObjetAffichageBandeauEntete.prototype._gestionFocus_apresFenetreCommunication=function(){this.GetInstance(this.identCommande)._gestionFocus_apresFenetreCommunication();};ObjetAffichageBandeauEntete.prototype._gestionFocus_apresFenetreImpression=function(){this.GetInstance(this.identCommande)._gestionFocus_apresFenetreImpression();};ObjetAffichageBandeauEntete.prototype._gestionFocus_apresFenetreGenerationPdf=function(){this.GetInstance(this.identCommande)._gestionFocus_apresFenetreGenerationPdf();};}());;
MethodesObjet.heritagePrototype(ObjetInterfaceVide,ObjetAbstraitInterface);function ObjetInterfaceVide(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);}
ObjetInterfaceVide.prototype.SetParametresGeneraux=function(){this.GenreStructure=EStructureAffichage.Autre;};ObjetInterfaceVide.prototype.ConstruireStructureAffichageAutre=function(){return this.composeMessage(GTraductions.getValeur('SelectionAffichage'));};;
MethodesObjet.heritagePrototype(ObjetInputFile,Identite);function ObjetInputFile(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.inputFiles=[];this.inputFilesData={};this.baseIdSelecteur=this.Nom+'_fichier_';this.genreCommande={selectionFichier:0,miseAJourFichier:1};}
IE.ZoneFenetre.etendreEnFenetre(ObjetInputFile,{zIndex:100000});ObjetInputFile.prototype.RecupererDonnees=function(){$('#'+this.Nom.escapeJQ()).css({display:'block',width:0,height:0});};ObjetInputFile.prototype.setDonnees=function(aParam){if(!aParam.guid) return;aParam=$.extend({actualFiles:0},aParam);var lIdsIndex=$.inArray(aParam.guid,this.inputFiles);var lToRemoveElements=[];if(lIdsIndex=== -1){this.inputFiles.push(aParam.guid);lIdsIndex=this.inputFiles.length-1;this.inputFilesData[lIdsIndex]={idSelecteurs:[]};if(aParam.maxFiles===undefined) aParam.maxFiles=1;$.extend(this.inputFilesData[lIdsIndex],aParam);if(this.inputFilesData[lIdsIndex].maxFiles===0||this.inputFilesData[lIdsIndex].maxFiles>aParam.actualFiles) this.ajouterSelecteur(aParam.guid);} else{var lNewElements=aParam.elements;delete(aParam.elements);$.extend(this.inputFilesData[lIdsIndex],aParam);var lElementsId=$.map(this.inputFilesData[lIdsIndex].elements,function(aVal){return aVal.id;});for(var i in lNewElements){var lArrayPos=$.inArray(lNewElements[i].id,lElementsId);if(lArrayPos=== -1&&lNewElements[i].toRemove!==true) this.inputFilesData[lIdsIndex].elements.push(lNewElements[i]);else if(lArrayPos> -1&&lNewElements[i].toRemove===true){lToRemoveElements=lToRemoveElements.concat(this.inputFilesData[lIdsIndex].elements.splice(lArrayPos,1));}}
var lNumFiles=$.grep(this.inputFilesData[lIdsIndex].idSelecteurs,function(aVal){return aVal!=='';}).length;if(lNumFiles===0&&this.inputFilesData[lIdsIndex].maxFiles>(lNumFiles+this.inputFilesData[lIdsIndex].actualFiles)) this.ajouterSelecteur(this.inputFilesData[lIdsIndex].guid);else this.ajouterEvenementSelecteur(aParam.guid);}
if(this.inputFilesData[lIdsIndex].elements.length){var lStringSelecteur='#'+$.map(this.inputFilesData[lIdsIndex].elements,function(aVal){return aVal.id.escapeJQ();}).join(', #');var lJqElements=$(lStringSelecteur);if(this.inputFilesData[lIdsIndex].idWrapperEvent){if(lToRemoveElements.length) $('#'+this.inputFilesData[lIdsIndex].idWrapperEvent.escapeJQ()).off('mousemove');$('#'+this.inputFilesData[lIdsIndex].idWrapperEvent.escapeJQ()).off('mousemove mouseenter').on('mousemove mouseenter',lStringSelecteur,{aObjet:this},this._surMouseMove).off('mouseleave',this._surMouseLeave).on('mouseleave',lStringSelecteur,{aObjet:this},this._surMouseLeave).off('touchstart pointerenter',this._surTouchStart).on('touchstart pointerenter',this._surTouchStart).data('ie-inputfile',aParam.guid);if(this.inputFilesData[lIdsIndex].idContextFocus) $('#'+this.inputFilesData[lIdsIndex].idWrapperEvent.escapeJQ()).off('focus').on('focus',lStringSelecteur,{aObjet:this},this._surFocus);} else{lJqElements.data('ie-inputfile',aParam.guid).off('mousemove mouseenter').on('mousemove mousenter',{aObjet:this},this._surMouseMove).unbind('mouseleave',this._surMouseLeave).bind('mouseleave',{aObjet:this},this._surMouseLeave).off('touchstart pointerenter',this._surTouchStart).on('touchstart pointerenter',this._surTouchStart);if(this.inputFilesData[lIdsIndex].idContextFocus) lJqElements.off('focus').on('focus',{aObjet:this},this._surFocus);}}
if(lToRemoveElements.length&&!this.inputFilesData[lIdsIndex].idWrapperEvent){var lJqElementsToRemove=$('#'+$.map(lToRemoveElements,function(aVal){return aVal.id.escapeJQ();}).join(', #'));lJqElementsToRemove.removeData('ie-inputfile').off('mousemove mouseenter',this._surMouseMove).off('mouseleave',this._surMouseLeave).off('focus',this._surFocus);}};ObjetInputFile.prototype.ajouterSelecteur=function(aGuid){var lIdsIndex=$.inArray(aGuid,this.inputFiles);var lIdSelecteur=this.getIdSelecteur(aGuid);if(IE.Support.avecSupportFileUpload){$('#'+this.Nom.escapeJQ()).append(GApplication.getCommunication().composeFormFichier_({idFichier:lIdSelecteur,evntOnChange:this.Nom+'._surSelectionFichier',evntOnClick:this.inputFilesData[lIdsIndex].callbackCancel?this.Nom+'._surClickSelecteur('+lIdsIndex+')':null,paramOnChange:'event, this',title:this.inputFilesData[lIdsIndex].title,accept:this.inputFilesData[lIdsIndex].accept,labelWai:this.inputFilesData[lIdsIndex].labelWai}));} else{$('#'+this.Nom.escapeJQ()).append('<form id="'+GApplication.getCommunication().getIdFormInputFile(lIdSelecteur)+'" style="overflow:hidden;position:absolute;top:-500px;left:-500px;width:10px;height:10px;">'+'<div id="'+GApplication.getCommunication().IdFichier+lIdSelecteur+'" onClick="'+this.Nom+'._surSelectionFichier(event, this);" class="AvecMain" style="position:absolute;top:0;right:0;width:10px;height:10px;" title="'+(this.inputFilesData[lIdsIndex].title||'')+'"'+(this.inputFilesData[lIdsIndex].labelWai?' aria-label="'+this.inputFilesData[lIdsIndex].labelWai+'"':'')+'></div>'+'</form>');}
$('#'+this.getLastIdFormInputFile(aGuid).escapeJQ()).css({opacity:0}).data('ie-inputfile',aGuid).data('ie-inputfile-idfichier',lIdSelecteur);this.ajouterEvenementSelecteur(aGuid);};ObjetInputFile.prototype.ajouterEvenementSelecteur=function(aGuid){var lIdsIndex=$.inArray(aGuid,this.inputFiles);var lRedirect=[];for(var i in this.inputFilesData[lIdsIndex].elements){if(this.inputFilesData[lIdsIndex].elements[i].redirect) for(var j in this.inputFilesData[lIdsIndex].elements[i].redirect){if($.inArray(this.inputFilesData[lIdsIndex].elements[i].redirect[j],lRedirect)=== -1&&this.inputFilesData[lIdsIndex].elements[i].redirect[j]!=='click') lRedirect.push(this.inputFilesData[lIdsIndex].elements[i].redirect[j]);}}
$('#'+this.getLastIdFormInputFile(aGuid).escapeJQ()).off('mouseleave mousemove mouseenter').on('mouseleave',{aObjet:this},function(){$(this).css({top:'-500px',left:'-500px'});}).on('mousemove mouseenter',{aObjet:this},this._surMouseMove).find('input[type="file"]').off('contextmenu').off(lRedirect.join(' ')).on('contextmenu',function(aEvent){aEvent.preventDefault();return false;}).on(lRedirect.join(' '),{aObjet:this},this._surRedirect);};ObjetInputFile.prototype.getIdSelecteur=function(aGuid,aNum){var lIdsIndex=$.inArray(aGuid,this.inputFiles);var lNum=this.inputFilesData[lIdsIndex].idSelecteurs.length;var lIdSelecteur=this.baseIdSelecteur+lIdsIndex+'_'+lNum;if($.isNumeric(aNum)){lIdSelecteur=this.inputFilesData[lIdsIndex].idSelecteurs[aNum];} else{this.inputFilesData[lIdsIndex].idSelecteurs.push(lIdSelecteur);}
return lIdSelecteur;};ObjetInputFile.prototype.getLastIdFormInputFile=function(aGuid){var lIdsIndex=$.inArray(aGuid,this.inputFiles);var lNum=this.inputFilesData[lIdsIndex].idSelecteurs.length;return GApplication.getCommunication().getIdFormInputFile(this.inputFilesData[lIdsIndex].idSelecteurs[lNum-1]);};ObjetInputFile.prototype.getIdFormInputFile=function(aGuid,aId){var lIdsIndex=$.inArray(aGuid,this.inputFiles);return GApplication.getCommunication().getIdFormInputFile(aId);};ObjetInputFile.prototype._surMouseMove=function(aEvent){var lEstForm=this.tagName.toLowerCase()==='form'&&$(this).data('ie-inputfile-id');var lThis=aEvent.data.aObjet;var lGuid=$(aEvent.delegateTarget).data('ie-inputfile');var lIdsIndex=$.inArray(lGuid,lThis.inputFiles);var lActualId=lEstForm?$(this).data('ie-inputfile-id'):this.id;var lIdSelecteur=$.grep(lThis.inputFilesData[lIdsIndex].elements,function(aVal){return aVal.id===lActualId;})[0].idFichier;var lJqSelecteur=$();if(lIdSelecteur!==undefined){if($.inArray(lIdSelecteur,lThis.inputFilesData[lIdsIndex].idSelecteurs)> -1) lJqSelecteur=$('#'+lThis.getIdFormInputFile(lGuid,lIdSelecteur).escapeJQ());else{lJqSelecteur=$('#'+lThis.getLastIdFormInputFile(lGuid).escapeJQ());}} else{lJqSelecteur=$('#'+lThis.getLastIdFormInputFile(lGuid).escapeJQ());}
lJqSelecteur.data('ie-inputfile-id',lActualId);var lJqEle=$('#'+lActualId.escapeJQ());var lElePos=lJqEle.offset();if(!lElePos) return;var lEleTop=lElePos.top;var lEleLeft=lElePos.left;var lEleMaxTop=lElePos.top+lJqEle.outerHeight()-10 ;var lEleMaxLeft=lElePos.left+lJqEle.outerWidth()-10 ;var lTop=Math.min(Math.max(aEvent.pageY-5,lEleTop),lEleMaxTop);var lLeft=Math.min(Math.max(aEvent.pageX-5,lEleLeft),lEleMaxLeft);lJqSelecteur.css({top:lTop,left:lLeft});};ObjetInputFile.prototype._surFocus=function(aEvent){if($(this).filter(':focus').length===1){var lThis=aEvent.data.aObjet;var lGuid=$(aEvent.delegateTarget).data('ie-inputfile');var lIdsIndex=$.inArray(lGuid,lThis.inputFiles);var lActualId=this.id;var lIdSelecteur=$.grep(lThis.inputFilesData[lIdsIndex].elements,function(aVal){return aVal.id===lActualId;})[0].idFichier;var lJqSelecteur=$();var lJqFocusables=GNavigateur.getJqFocusable(lThis.inputFilesData[lIdsIndex].idContextFocus);var lIndex=lJqFocusables.index(this);if(lIdSelecteur!==undefined){if($.inArray(lIdSelecteur,lThis.inputFilesData[lIdsIndex].idSelecteurs)> -1) lJqSelecteur=$('#'+lThis.getIdFormInputFile(lGuid,lIdSelecteur).escapeJQ());else{lJqSelecteur=$('#'+lThis.getLastIdFormInputFile(lGuid).escapeJQ());}} else{lJqSelecteur=$('#'+lThis.getLastIdFormInputFile(lGuid).escapeJQ());}
lJqSelecteur.data('ie-inputfile-id',lActualId);lJqSelecteur.data('ie-inputfile-idprevfocus',lJqFocusables.eq(lIndex-1).attr('id'));lJqSelecteur.data('ie-inputfile-idnextfocus',lJqFocusables.eq(lIndex+1).attr('id'));var lTop=$(this).offset().top;var lLeft=$(this).offset().left;lJqSelecteur.css({top:lTop,left:lLeft}).find('input[type="file"]').off('keydown blur focus').on('keydown blur',lThis._surBlur).on('focus',function(){var lJqElement=$('#'+$(this).parent().data('ie-inputfile-id').escapeJQ());lJqElement.triggerHandler('focus');lJqElement.triggerHandler('focusin');}).focus();}};ObjetInputFile.prototype._surBlur=function(aEvent){if(aEvent.type==='blur'||(aEvent.type==='keydown'&&aEvent.which===ToucheClavier.Tab)){$(this).parent().css({top:'-500px',left:'-500px'});var lJqElement=$('#'+$(this).parent().data('ie-inputfile-id').escapeJQ());lJqElement.triggerHandler('blur');lJqElement.triggerHandler('focusout');$(this).unbind('keydown').unbind('focus');if(aEvent.type==='keydown'&&!aEvent.shiftKey) $('#'+$(this).parent().data('ie-inputfile-idnextfocus').escapeJQ()).focus();else if(aEvent.type==='keydown') $('#'+$(this).parent().data('ie-inputfile-idprevfocus').escapeJQ()).focus();aEvent.preventDefault();aEvent.stopImmediatePropagation();return false;}};ObjetInputFile.prototype._surTouchStart=function(aEvent){if(aEvent.type==='pointerenter'&&aEvent.pointerType==='mouse')
return;$(this).unbind('mouseleave',this._surMouseLeave);};ObjetInputFile.prototype._surMouseLeave=function(aEvent){var lEstForm=this.tagName.toLowerCase()==='form'&&$(this).data('ie-inputfile-id');var lThis=aEvent.data.aObjet;var lGuid=$(aEvent.delegateTarget).data('ie-inputfile');var lIdsIndex=$.inArray(lGuid,lThis.inputFiles);var lActualId=lEstForm?$(this).data('ie-inputfile-id'):this.id;var lIdSelecteur=$.grep(lThis.inputFilesData[lIdsIndex].elements,function(aVal){return aVal.id===lActualId;})[0].idFichier;var lJqSelecteur=$();if(lIdSelecteur!==undefined){if($.inArray(lIdSelecteur,lThis.inputFilesData[lIdsIndex].idSelecteurs)> -1) lJqSelecteur=$('#'+lThis.getIdFormInputFile(lGuid,lIdSelecteur).escapeJQ());else{lJqSelecteur=$('#'+lThis.getLastIdFormInputFile(lGuid).escapeJQ());}} else{lJqSelecteur=$('#'+lThis.getLastIdFormInputFile(lGuid).escapeJQ());}
lJqSelecteur.css({top:'-500px',left:'-500px'});};ObjetInputFile.prototype._surRedirect=function(aEvent){var lThis=aEvent.data.aObjet;var lId=$(this).parent().data('ie-inputfile-id');var lGuid=$(aEvent.delegateTarget).parent().data('ie-inputfile');var lIdIndex=$.inArray(lGuid,lThis.inputFiles);var lElement=$.grep(lThis.inputFilesData[lIdIndex].elements,function(aVal){return aVal.id===lId;});if(lElement.length===1&&$.inArray(aEvent.type,lElement[0].redirect)!== -1){var lResult=true;if(aEvent.type!=='mouseleave'&&aEvent.type!=='mouseout'&&aEvent.type!=='mouseenter'&&aEvent.type!=='mouseover'&&aEvent.type!=='mousemove'){aEvent.stopImmediatePropagation();aEvent.preventDefault();lResult=false;}
$('#'+lElement[0].id.escapeJQ()).trigger({type:aEvent.type,pageX:aEvent.pageX,pageY:aEvent.pageY});return lResult;}};function _annulerEcouteCancelInput(){$(document).off('mousemove.cancelInput iedown.cancelInput keydown.cancelInput');}
ObjetInputFile.prototype._surClickSelecteur=function(aIndice){var lCallback=this.inputFilesData[aIndice]?this.inputFilesData[aIndice].callbackCancel:null;if(lCallback)
$(document).one('mousemove.cancelInput iedown.cancelInput keydown.cancelInput',function(){_annulerEcouteCancelInput();lCallback();});};ObjetInputFile.prototype._surSelectionFichier=function(aEvent,aObj){_annulerEcouteCancelInput();var lGuid=$(aObj).parent().data('ie-inputfile');var lIdFichierPJ=$(aObj).parent().data('ie-inputfile-idfichier');var lId=$(aObj).parent().data('ie-inputfile-id');var lIdIndex=$.inArray(lGuid,this.inputFiles);if(!IE.Support.avecSupportFileUpload){GApplication.getMessage().afficher({titreBandeau:GTraductions.getValeur('upload_impossible_titre'),message:GTraductions.getValeur('upload_impossible_message')});return;}
if(aObj.files&&aObj.files.length===0) return false;var lFileToRemove=[],x;if(aObj.files&&this.inputFilesData[lIdIndex].maxSize){for(x=0;x<aObj.files.length;x++){if(aObj.files[x].size>this.inputFilesData[lIdIndex].maxSize) lFileToRemove.push(x);}}
if(lFileToRemove.length>0){GApplication.getMessage().afficher({type:EGenreBoiteMessage.Information,message:GTraductions.getValeur('inputFile.msgEchecTailleFichier',[Math.floor(this.inputFilesData[lIdIndex].maxSize/1024)])});aObj.value='';aEvent.preventDefault();return false;}
lFileToRemove=[];if((aObj.files||aObj.value)&&this.inputFilesData[lIdIndex].extension&&this.inputFilesData[lIdIndex].extension.length){if(aObj.files) for(x=0;x<aObj.files.length;x++){if($.inArray(aObj.files[x].name.replace(/(.*)\.([^\.\/]+)$/,'$2').toLowerCase(),this.inputFilesData[lIdIndex].extension)=== -1) lFileToRemove.push(x);} else{if($.inArray(aObj.value.replace(/(.*)\.([^\.\/]+)$/,'$2').toLowerCase(),this.inputFilesData[lIdIndex].extension)=== -1) lFileToRemove.push(x);}}
if(lFileToRemove.length>0){GApplication.getMessage().afficher({type:EGenreBoiteMessage.Information,message:GTraductions.getValeur('inputFile.echecSelection',[$.map(this.inputFilesData[lIdIndex].extension,function(ele){return'*.'+ele;}).join(', ')])});aObj.value='';aEvent.preventDefault();return false;}
var lElement=$.grep(this.inputFilesData[lIdIndex].elements,function(aVal){return aVal.id===lId;})[0];if($.inArray('click',lElement.redirect)> -1) $('#'+lElement.id.escapeJQ()).trigger('click');var lEltFichier=new ObjetElement('',null,this.inputFilesData[lIdIndex].genrePJ);lEltFichier.idFichier=lIdFichierPJ;lEltFichier.Path=aObj.value;lEltFichier.Libelle=GChaine.ajouterEntites(GChaine.enleverChemin(lEltFichier.Path));lEltFichier.nomOriginal=lEltFichier.Libelle;lEltFichier.SetEtat(EGenreEtat.Creation);if(lElement.idFichier!==undefined) lEltFichier.Etat=EGenreEtat.Modification;this.callback.appel({action:lElement.idFichier===undefined?this.genreCommande.selectionFichier:this.genreCommande.miseAJourFichier,originalId:lId,eltFichier:lEltFichier});var lNumFiles=$.grep(this.inputFilesData[lIdIndex].idSelecteurs,function(aVal){return aVal!=='';}).length;if(this.inputFilesData[lIdIndex].maxFiles===0||this.inputFilesData[lIdIndex].maxFiles>(lNumFiles+this.inputFilesData[lIdIndex].actualFiles)) this.ajouterSelecteur(this.inputFilesData[lIdIndex].guid);};ObjetInputFile.prototype.supprimerFichier=function(aEltFichier){if(aEltFichier.idFichier){var lInput=$('#'+GApplication.getCommunication().getIdInputFile(aEltFichier.idFichier).escapeJQ());if(lInput.length===1) lInput.get(0).value='';}};ObjetInputFile.prototype.destroyGUID=function(aGUID){var lIdsIndex=$.inArray(aGUID,this.inputFiles);if(lIdsIndex> -1){var lSelecteurs=$.grep(this.inputFilesData[lIdsIndex].idSelecteurs,function(aVal){return aVal!=='';});for(var i=0,lNb=lSelecteurs.length;i<lNb;i++){$('#'+this.getIdFormInputFile(aGUID,lSelecteurs[i]).escapeJQ()).remove();}
if(this.inputFilesData[lIdsIndex].elements.length){var lStringSelecteur='#'+$.map(this.inputFilesData[lIdsIndex].elements,function(aVal){return aVal.id.escapeJQ();}).join(', #');var lJqElements=$(lStringSelecteur);if(this.inputFilesData[lIdsIndex].idWrapperEvent){$('#'+this.inputFilesData[lIdsIndex].idWrapperEvent.escapeJQ()).off('mousemove mouseenter',this._surMouseMove).off('mouseleave',this._surMouseLeave).off('touchstart pointerenter',this._surTouchStart).removeData('ie-inputfile');if(this.inputFilesData[lIdsIndex].idContextFocus) $('#'+this.inputFilesData[lIdsIndex].idWrapperEvent.escapeJQ()).off('focus',this._surFocus);} else{lJqElements.removeData('ie-inputfile').off('mousemove mouseenter',this._surMouseMove).unbind('mouseleave',this._surMouseLeave).off('touchstart pointerenter',this._surTouchStart);if(this.inputFilesData[lIdsIndex].idContextFocus) lJqElements.off('focus',this._surFocus);}}
this.inputFiles.splice(lIdsIndex,1);}};;
MethodesObjet.heritagePrototype(ObjetModulePJ,Identite);function ObjetModulePJ(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.id_trombone=this.Nom+'_trombone';this.idOrigPJ=true;this.id_libellesPJ=this.Nom+'_libellesPJ';this.genreCommande={menuContext:0};}
ObjetModulePJ.prototype.ConstruireAffichage=function(){var H=[];H.push('<div id="',this.id_trombone,'" class="Image_Trombone InlineBlock AlignementHaut" tabIndex="0"></div>');if(this.idOrigPJ) H.push('<div id="',this.id_libellesPJ,'" class="InlineBlock AlignementHaut EspaceGauche EspaceDroit"></div>');return H.join('');};ObjetModulePJ.prototype.setDonnees=function(aParam){this.genrePJ=aParam.genrePJ;this.genreRessourcePJ=aParam.genreRessourcePJ;if(aParam.idListePJ) this.setIdPourLibellesPJ(aParam.idListePJ);if(aParam.listePJ) this.setLibellesPJ(aParam.listePJ);};ObjetModulePJ.prototype.RecupererDonnees=function(){$('#'+this.id_trombone.escapeJQ()+', #'+this.id_libellesPJ.escapeJQ()).on('contextmenu',{aObjet:this},function(event){event.stopImmediatePropagation();event.preventDefault();event.data.aObjet.callback.appel({action:event.data.aObjet.genreCommande.menuContext});return false;});$('#'+this.id_trombone.escapeJQ()).on('focus',{couleur:GCouleur.texte},function(event){$(this).css('box-shadow','0 0 5px -1px '+event.data.couleur);}).on('blur',{couleur:GCouleur.texte},function(event){$(this).css('box-shadow','');});};ObjetModulePJ.prototype.getNomTrombone=function(){return this.id_trombone;};ObjetModulePJ.prototype.setLibellesPJ=function(aListePJ){$('#'+this.id_libellesPJ.escapeJQ()).IEHtml(aListePJ.getUrls(this.genrePJ,true,null,this.genreRessourcePJ),{controleur:this.controleur});};ObjetModulePJ.prototype.setIdPourLibellesPJ=function(aIdListePJ){this.idOrigPJ=false;this.id_libellesPJ=aIdListePJ;};;
MethodesObjet.heritagePrototype(ObjetSelecteurPJ,ObjetAbstraitInterface);function ObjetSelecteurPJ(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.genreMenuContextuel={ajouterPJNouvelle:0,ajouterPJExistante:1,supprimerPJ:2};this._initialiserOptions();}
ObjetSelecteurPJ.genreEvnt={selectionPJ:1,suppressionPJ:2,editionPJ:3};ObjetSelecteurPJ.prototype._initialiserOptions=function(){this._options={genrePJ:EGenreDocumentJoint.Fichier,genreRessourcePJ:EGenreRessource.DocJointEtablissement,title:'',styleSite:false,maxFiles:0,maxSize:1048576,avecAjoutExistante:false,avecCmdAjoutNouvelle:true};};ObjetSelecteurPJ.prototype.setOptions=function(aOptions){$.extend(this._options,aOptions);if(this._options.maxFiles===1) this._options.avecCmdAjoutNouvelle=false;};ObjetSelecteurPJ.prototype.ConstruireInstances=function(){this.idInputFile=this.addFenetre(window.ObjetInputFile ,this.evenementInputFile);this.identPJ=this.Add(window.ObjetModulePJ ,this.evntModulePJ);this.identMenuContextPJ=this.Add(window.ObjetMenuContextuel ,this.evntMenuContextuel ,this.initMenuContextuel);this.identSousMenuContextPJ=this.Add(window.ObjetMenuContextuel ,this.evntMenuContextuel ,this.initSousMenuContextuel);this.identEditionPJ=this.Add(window.ObjetFenetre_PieceJointe ,this.evntEditionPJ ,this.initEditionPJ);};ObjetSelecteurPJ.prototype.ComposeContenu=function(){var H=[];H.push('<div class="EspaceHaut" id="',this.GetNomInstance(this.identPJ),'"></div>');return H.join('');};ObjetSelecteurPJ.prototype.SetActif=function(AActif){this.Actif=AActif;this.GetInstance(this.idInputFile).SetActif(AActif);this.GetInstance(this.identPJ).SetActif(AActif);};ObjetSelecteurPJ.prototype.SetDonnees=function(aParam){this.listePJTotale=aParam.listeTotale;this.listePJ=aParam.listePJ;this.idContextFocus=aParam.idContextFocus;var lParam={listePJ:this.listePJ,genrePJ:this._options.genrePJ,genreRessourcePJ:this._options.genreRessourcePJ,styleSite:this._options.styleSite};if(aParam.idListePJ) lParam.idListePJ=aParam.idListePJ;this.GetInstance(this.identPJ).setDonnees(lParam);if(this.Actif)
this.GetInstance(this.idInputFile).setDonnees({guid:this.Nom,title:this._options.title,genrePJ:this._options.genrePJ,actualFiles:this.listePJ?this.listePJ.GetNbrElements():0,maxFiles:this._options.maxFiles,maxSize:this._options.maxSize,idContextFocus:this.idContextFocus,elements:[{id:this.GetInstance(this.identPJ).getNomTrombone(),redirect:['contextmenu']}
]});else this.GetInstance(this.idInputFile).setDonnees({guid:this.Nom,elements:[{id:this.GetInstance(this.identPJ).getNomTrombone(),toRemove:true}
]});};ObjetSelecteurPJ.prototype.destroyInputFile=function(){this.GetInstance(this.idInputFile).destroyGUID(this.Nom);return this;};ObjetSelecteurPJ.prototype.setTailleMaxPJ=function(aTailleMax){this._options.maxSize=aTailleMax;};ObjetSelecteurPJ.prototype.controlerFichierSelectionne=function(aParam){if(this._isLibelleFichierExiste(aParam.GetLibelle()))
return{succes:false,msg:GTraductions.getValeur('selecteurPJ.msgEchecLibelleFichier')};return{succes:true,msg:''};};ObjetSelecteurPJ.prototype._isLibelleFichierExiste=function(aNomFichier){var lNbrElts=this.listePJTotale.GetNbrElements();var lElt;for(var I=0;I<lNbrElts;I++){lElt=this.listePJTotale.GetElement(I);if(lElt.Existe()&&(lElt.GetLibelle()===aNomFichier))
return true;}
return false;};ObjetSelecteurPJ.prototype.initMenuContextuel=function(aInstance){if(!this.Actif) return;if(this._options.avecCmdAjoutNouvelle)
aInstance.AddCommande(this.genreMenuContextuel.ajouterPJNouvelle,GTraductions.getValeur('selecteurPJ.ajoutNouvellePJ'));if(this._options.avecAjoutExistante)
aInstance.AddCommande(this.genreMenuContextuel.ajouterPJExistante,GTraductions.getValeur('selecteurPJ.ajoutPJExistante'));};ObjetSelecteurPJ.prototype.initSousMenuContextuel=function(aInstance){aInstance.AddListe();if(this._options.avecCmdAjoutNouvelle||this._options.avecAjoutExistante)
this.GetInstance(this.identMenuContextPJ).AddSeparateur();this.GetInstance(this.identMenuContextPJ).addDeploiement(this.genreMenuContextuel.supprimerPJ,GTraductions.getValeur('selecteurPJ.supprimerPJ'),aInstance,false);};ObjetSelecteurPJ.prototype.initEditionPJ=function(aInstance){aInstance.SetParametres_Fenetre('',500,450,[GTraductions.getValeur('principal.fermer')]);};ObjetSelecteurPJ.prototype.evenementInputFile=function(aParam){if(this.GetInstance(this.identEditionPJ).EnAffichage){this.GetInstance(this.identEditionPJ).evenementSurSelecteurFichier(aParam.eltFichier.Etat,aParam.eltFichier);} else{switch(aParam.action){case this.GetInstance(this.idInputFile).genreCommande.selectionFichier:var lControle=this.controlerFichierSelectionne(aParam.eltFichier);if(lControle.succes){this.listePJTotale.AddElement(aParam.eltFichier);this.listePJ.AddElement(aParam.eltFichier);if(this._options.maxFiles!==0&&this.listePJ.GetNbrElementsExistes()>=this._options.maxFiles)
this.GetInstance(this.idInputFile).setDonnees({guid:this.Nom,elements:[{id:this.GetInstance(this.identPJ).getNomTrombone(),toRemove:true}
]});this.callback.appel({evnt:ObjetSelecteurPJ.genreEvnt.selectionPJ,fichier:aParam.eltFichier});} else{GApplication.getMessage().Afficher(EGenreBoiteMessage.Information,null,lControle.msg);}
break;case this.GetInstance(this.idInputFile).genreCommande.miseAJourFichier:break;default:;break;}
this.GetInstance(this.identPJ).setLibellesPJ(this.listePJ);}};ObjetSelecteurPJ.prototype.evntModulePJ=function(aParam){if(!this.Actif) return;switch(aParam.action){case this.GetInstance(this.identPJ).genreCommande.menuContext:if(this._options.avecCmdAjoutNouvelle||this._options.avecAjoutExistante)
this.GetInstance(this.identMenuContextPJ).afficherLigne(-1,EGenreLigneMenu.Separateur,this.listePJ.GetNbrElements()>0);this.GetInstance(this.identMenuContextPJ).afficherLigne(this.genreMenuContextuel.supprimerPJ,EGenreLigneMenu.Deploiement,this.listePJ.GetNbrElementsExistes()>0);this.GetInstance(this.identSousMenuContextPJ).SetDonnees(null,this.listePJ,null,false);this.GetInstance(this.identMenuContextPJ).SetDonnees(null,this.listePJ,null);if(this._options.avecCmdAjoutNouvelle)
this.GetInstance(this.idInputFile).setDonnees({guid:this.Nom,elements:[{id:this.GetInstance(this.identMenuContextPJ).getIdCelluleTexteParCommande(this.genreMenuContextuel.ajouterPJNouvelle),redirect:['mousemove','click']}
]});break;default:;break;}};ObjetSelecteurPJ.prototype.evntSupprimerPJ=function(aAccepte){if(!this.Actif) return;this.GetInstance(this.identEditionPJ).Fermer();if(aAccepte!==EGenreAction.Valider)
return;this.eltASupprimer.SetEtat(EGenreEtat.Suppression);this.GetInstance(this.idInputFile).supprimerFichier(this.eltASupprimer);this.GetInstance(this.identPJ).setLibellesPJ(this.listePJ);if(this._options.maxFiles!==0&&this.listePJ.GetNbrElementsExistes()<this._options.maxFiles)
this.GetInstance(this.idInputFile).setDonnees({guid:this.Nom,elements:[{id:this.GetInstance(this.identPJ).getNomTrombone(),redirect:['contextmenu']}
]});this.callback.appel({evnt:ObjetSelecteurPJ.genreEvnt.suppressionPJ});};ObjetSelecteurPJ.prototype.evntMenuContextuel=function(aLigne,aElt){if(!this.Actif) return;if(aLigne.Genre===EGenreLigneMenu.Liste){this.eltASupprimer=aElt;GApplication.getMessage().Afficher(EGenreBoiteMessage.Confirmation,'',GTraductions.getValeur('selecteurPJ.msgConfirmPJ',[aElt.GetLibelle()]),null,this,this.evntSupprimerPJ);}
else{switch(aLigne.Numero){case this.genreMenuContextuel.ajouterPJExistante:this.GetInstance(this.identEditionPJ).afficherFenetrePJ({listePJTot:this.listePJTotale,listePJContexte:this.listePJ,genreFenetrePJ:this._options.genrePJ,genrePJ:this._options.genrePJ,genreRessourcePJ:this._options.genreRessourcePJ,instanceInputFile:this.GetInstance(this.idInputFile),guidInputFile:this.Nom,avecFiltre:{date:true}});break;default:break;}}};ObjetSelecteurPJ.prototype.evntEditionPJ=function(){if(!this.Actif) return;var alisteDocumentsJoints=this.listePJTotale;if(!alisteDocumentsJoints) return;var lDoc;for(var I=0;I<alisteDocumentsJoints.GetNbrElements();I++){var lDocumentJoint=this.listePJ.GetElementParNumero(alisteDocumentsJoints.GetNumero(I));var lActif=alisteDocumentsJoints.GetElement(I).Actif&&alisteDocumentsJoints.Existe(I);if(lDocumentJoint){if(!lActif){lDocumentJoint.SetEtat(EGenreEtat.Suppression);}
else{lDoc=alisteDocumentsJoints.GetElement(I);if(lDoc.Etat===EGenreEtat.Modification){lDocumentJoint.Libelle=lDoc.Libelle;}}} else{if(lActif){var lEltFichier;lDoc=alisteDocumentsJoints.GetElement(I);if(lDoc.Fichier){lDoc.idFichier=lDoc.Fichier.idFichier;lDoc.Path=lDoc.Fichier.Path;lDoc.Libelle=lDoc.Fichier.Libelle;lDoc.nomOriginal=lDoc.Fichier.nomOriginal;}
lEltFichier=MethodesObjet.dupliquer(lDoc);lEltFichier.SetEtat(EGenreEtat.Creation);this.listePJ.AddElement(lEltFichier);}}}
this.callback.appel({evnt:ObjetSelecteurPJ.genreEvnt.editionPJ});this.GetInstance(this.identPJ).setLibellesPJ(this.listePJ);if(!this.GetInstance(this.identPJ).EnAffichage){this.GetInstance(this.idInputFile).setDonnees({guid:this.Nom,idContextFocus:this.idContextFocus});}};;
function TUtilitaireMessagerie(){}(function(){TUtilitaireMessagerie.getDiscussion=function(aParam){var H=[],lMargeGauche,lMargeDroite,J,lCouleurBordure=aParam.couleurBordure?aParam.couleurBordure:GCouleur.bordure;var lBaseId=IE.GUID.getId()+'_';H.push('<div style="position:relative;">');H.push('<div class="tUtilitaireMessagerie_flecheHaut" style="display:none;position:absolute;top:0;left:0;border-top:red 1px solid;height:1px;width:0px;"><div class="Image_Messagerie_FlecheRouge" style="position:absolute;right:0;top:-5px;"></div></div>');H.push('<div class="tUtilitaireMessagerie_flecheBas" style="display:none;position:absolute;top:0;left:0;border-top:red 1px solid;height:1px;width:0px;"><div class="Image_Messagerie_FlecheRouge" style="position:absolute;right:0;top:-5px;"></div></div>');H.push('<div class="tUtilitaireMessagerie_flecheGauche" style="display:none;position:absolute;top:0;left:0;border-left:red 1px solid;height:0px;width:1px;"></div>');for(var I=0;I<aParam.listeMessages.GetNbrElements();I++){var lMessage=aParam.listeMessages.GetElement(I);lMargeGauche=aParam.margesGauche?aParam.margesGauche[(lMessage.emetteur?1:0)+(lMessage.estUnAparte?2:0)]:'0px;';lMargeDroite=aParam.margesDroite?aParam.margesDroite[(lMessage.emetteur?1:0)+(lMessage.estUnAparte?2:0)]:'0px;';if(I>0)
H.push('<br/>');H.push('<fieldset id="'+lBaseId+lMessage.GetNumero()+'" class="AvecSelectionTexte',(aParam.ieEventMessage?' AvecMain':''),'"',aParam.ieEventMessage?' ie-event="'+aParam.ieEventMessage+'('+I+')"':'',aParam.ieStyleMessage?' ie-style="'+aParam.ieStyleMessage+'('+I+',\''+lCouleurBordure+'\')"':'',' style="position:relative;display:block;padding: 3px 6px 8px 6px; border: 1px solid ',(aParam.couleurBordure?aParam.couleurBordure:GCouleur.bordure),'; margin-left: ',lMargeGauche,'; margin-right: ',lMargeDroite,';',' background-color: ',lMessage.brouillon?aParam.couleurBrouillon?aParam.couleurBrouillon:GCouleur.nonEditable.fond:lMessage.estUnAparte?(aParam.couleurFond?aParam.couleurFond:GCouleur.nonEditable.fond):'#FFFFFF',';">');H.push('<legend style="position:relative;">');H.push(this.getLibelleParticipants(lMessage,true));H.push('</legend>');H.push('<div style="position:relative; overflow:auto;">');if(lMessage.estHTML)
H.push(lMessage.contenu);else H.push(GChaine.ToHTML(lMessage.contenu));H.push('</div>');if(lMessage.listeDocumentsJoints&&lMessage.listeDocumentsJoints.GetNbrElements()>0)
H.push(_construirePJs(lMessage));if(lMessage.listeMessagesPourContexte){H.push('<hr/>');for(J=0;J<lMessage.listeMessagesPourContexte.GetNbrElements();J++){var lMessagePourContexte=lMessage.listeMessagesPourContexte.GetElement(J);lMargeGauche=aParam.margesGauche?aParam.margesGauche[4]:'0px;';lMargeDroite=aParam.margesDroite?aParam.margesDroite[4]:'0px;';H.push('<div style="margin-left: ',lMargeGauche,'; margin-right: ',lMargeDroite,'">');H.push(this.getLibelleParticipants(lMessagePourContexte,true));H.push('<div style="margin-left: ',lMessage.estMessageTransferant&&!lMessagePourContexte.emetteur?'0':lMargeGauche,'; margin-right: ',lMargeDroite,'">');H.push(lMessagePourContexte.contenu);H.push('</div>');if(lMessagePourContexte.listeDocumentsJoints&&lMessagePourContexte.listeDocumentsJoints.GetNbrElements()>0){H.push('<div style="margin-left: ',lMargeGauche,'; margin-right: ',lMargeDroite,'">');H.push(_construirePJs(lMessagePourContexte));H.push('</div>');}
if(J<lMessage.listeMessagesPourContexte.GetNbrElements()-1)
H.push('<hr/>');H.push('</div>');}}
H.push('</fieldset>');}
H.push('</div>');return H.join('');};function _construirePJs(aMessage){var H=[],J;for(J=0;J<aMessage.listeDocumentsJoints.GetNbrElements();J++){var lDocumentJoint=aMessage.listeDocumentsJoints.GetElement(J);H.push('<div>',GChaine.composerURL(GApplication.getCommunication().composeUrlFichierExterne(lDocumentJoint.GetLibelle(),{"N":lDocumentJoint.GetNumero(),"G":EGenreRessource.RelationMessageFichierExterne}),lDocumentJoint.GetLibelle() ,true),'</div>');}
return H.join('');}
function _getLibelleBrouillonNonEnvoye(aDiscussion,aListeMessagerie,aMessageBrouillon){var lMessageBrouillon=aMessageBrouillon;if(!lMessageBrouillon){var lNumeroPossession=aDiscussion.listePossessionsMessages.GetNumero(0);aListeMessagerie.parcourir(function(aMessage){if(!aMessage.estUneDiscussion&&aMessage.brouillon&&aMessage.listePossessionsMessages&&aMessage.listePossessionsMessages.GetNumero(0)===lNumeroPossession){lMessageBrouillon=aMessage;return false;}});}
if(lMessageBrouillon&&lMessageBrouillon.transferant)
return GTraductions.getValeur('Messagerie.BrouillonDiscussionTransfert');return GTraductions.getValeur('Messagerie.BrouillonDiscussion');}
TUtilitaireMessagerie.getLibelleBandeau=function(aDiscussion,aListeMessagerie){var H=[];if(aDiscussion.estUneDiscussion){if(aDiscussion.nbBrouillons===1&&aDiscussion.nbBrouillons===aDiscussion.nombreMessages){H.push(_getLibelleBrouillonNonEnvoye(aDiscussion,aListeMessagerie));}
else{H.push(aDiscussion.objet);H.push(' - ');H.push(aDiscussion.public?aDiscussion.public:GChaine.Format(GTraductions.getValeur('Messagerie.NParticipants'),[aDiscussion.listePublic.length]));}} else{if(aDiscussion.brouillon&&aDiscussion.pere.nbBrouillons===1&&aDiscussion.pere.nbBrouillons===aDiscussion.pere.nombreMessages)
H.push(_getLibelleBrouillonNonEnvoye(aDiscussion,aListeMessagerie,aDiscussion));else H.push(aDiscussion.pere.objet);}
return H.join('');};TUtilitaireMessagerie.getLibelleDiscussion=function(aDiscussion,aHtmlImage){var H=[];if(aDiscussion){var lClass=[aDiscussion.lu?'':'Gras',aDiscussion.profondeur?'Italique':''];H.push('<div',lClass.length?' class="'+lClass.join(' ')+'"':'',' style="margin-left: '+10*aDiscussion.profondeur+'px;"','>');if(aHtmlImage)
H.push(aHtmlImage);if(aDiscussion.archive&&aDiscussion.profondeur===0)
H.push('<div class="InlineBlock" style="height:100%">','<div class="Image_MessageArchive" style="position:relative; top:-1px; height:15px;" title="',GChaine.toTitle(GTraductions.getValeur('Messagerie.HintDiscussionArchive')),'">&nbsp;</div>','</div>&nbsp;');H.push((aDiscussion.profondeur?'':aDiscussion.objet+'&nbsp;')+'('+aDiscussion.nombreMessages+')'+'&nbsp;');if(aDiscussion.nbBrouillons>0)
H.push('[',aDiscussion.nbBrouillons===1?GTraductions.getValeur('Messagerie.UnBrouillon'):GChaine.Format(GTraductions.getValeur('Messagerie.NBrouillons'),[aDiscussion.nbBrouillons]),']&nbsp;');H.push(aDiscussion.documentsJoints?'&nbsp;-&nbsp;'+'<div class="InlineBlock">'+GImage.composeImage('Image_TrombonePetit',11,false)+'</div>':'');H.push('&nbsp;-&nbsp;'+aDiscussion.libelleDate+'&nbsp;-&nbsp;');H.push(aDiscussion.public?aDiscussion.public:'<div '+(aDiscussion.listePublic?' title="'+aDiscussion.listePublic.join('\n')+'"':'')+' class="InlineBlock AlignementHaut" style="margin-left:">'+GImage.composeImage('Image_Messagerie_Groupe',16,false)+'</div>');H.push('</div>');}
return H.join('');};TUtilitaireMessagerie.getLibelleDiscussionAccessible=function(aDiscussion){var H=[];if(aDiscussion){H.push((aDiscussion.profondeur?'':aDiscussion.objet+'&nbsp;')+'('+aDiscussion.nombreMessages+')');H.push('&nbsp;-&nbsp;'+aDiscussion.libelleDate);}
return H.join('');};TUtilitaireMessagerie.getDetailDiscussionAccessible=function(aDiscussion){var H=[];if(aDiscussion){if(aDiscussion.public)
H.push('<div>',aDiscussion.public,'</div>');else H.push('<div>',aDiscussion.listePublic.join('\n'),'</div>');if(aDiscussion.documentsJoints)
H.push('<div>',aDiscussion.documentsJoints,'</div>');}
return H.join('');};TUtilitaireMessagerie.getCleDiscussion=function(aDiscussion){if(aDiscussion)
return aDiscussion.profondeur+'-'+aDiscussion.objet+'-'+aDiscussion.nombreMessages;else return'';};TUtilitaireMessagerie.getLibelleDate=function(aDiscussion){var H=[];H.push('<div',aDiscussion.lu?'':' class="Gras"',' style="margin-left: '+10*aDiscussion.profondeur+'px;"','>');if(aDiscussion.brouillon)
H.push('[',GTraductions.getValeur('Messagerie.Brouillon'),']&nbsp;');H.push(aDiscussion.libelleDate);H.push('</div>');return H.join('');};TUtilitaireMessagerie.getLibelleParticipants=function(aMessage,aPourListeMessages){var H=[];if(aMessage.estMessageTransferant){H.push('<div>',aMessage.nbTransfert>1?GChaine.Format(GTraductions.getValeur('Messagerie.NMessagestransferes'),[aMessage.nbTransfert]):GTraductions.getValeur('Messagerie.1Messagetransfere'),'</div>');}
else{H.push('<div',aMessage.lu&&!aPourListeMessages?'':' class="Gras"','>');if(aPourListeMessages&&aMessage.brouillon){H.push('<div class="InlineBlock">[',GTraductions.getValeur('Messagerie.Brouillon'),']</div>');H.push('<div class="InlineBlock">&nbsp;'+aMessage.libelleDate+'</div>');}
else{H.push(aMessage.public_gauche?'<div class="InlineBlock"'+(aMessage.hint_gauche?' title="'+aMessage.hint_gauche+'"':'')+'>'+aMessage.public_gauche+'</div>':'<div class="InlineBlock" title="'+(aMessage.listePublic?aMessage.listePublic.join('\n'):'')+'">'+GImage.composeImage('Image_Messagerie_Groupe',16,false)+'</div>');H.push('<div class="InlineBlock" style="margin-left: 5px; margin-right: 5px;">'+GImage.composeImage(aMessage.sens?'Image_Messagerie_FlecheDroite':'Image_Messagerie_FlecheGauche',16,false)+'</div>');H.push(aMessage.public_droite?'<div class="InlineBlock"'+(aMessage.hint_droite?' title="'+aMessage.hint_droite+'"':'')+'>'+aMessage.public_droite+'</div>':aMessage.brouillon?'':'<div class="InlineBlock" title="'+(aMessage.listePublic?aMessage.listePublic.join('\n'):'')+'">'+GImage.composeImage('Image_Messagerie_Groupe',16,false)+'</div>');H.push(aPourListeMessages?'<div class="InlineBlock Maigre" style="margin-left: 10px;">'+aMessage.libelleDate+'</div>':'');}
H.push('</div>');}
return H.join('');};TUtilitaireMessagerie.getIndiceDiscussion=function(aListeMessagerie,aMessage){if(aMessage&&aMessage.listePossessionsMessages){for(var I=0;I<aMessage.listePossessionsMessages.GetNbrElements();I++){var lPossessionMessage=aMessage.listePossessionsMessages.GetElement(I);for(var J=0;J<aListeMessagerie.GetNbrElements();J++){var lDiscussion=aListeMessagerie.GetElement(J);for(var K=0;K<lDiscussion.listePossessionsMessages.GetNbrElements();K++){if((lPossessionMessage.GetNumero()===lDiscussion.listePossessionsMessages.GetNumero(K))&&(aMessage.estUneDiscussion===lDiscussion.estUneDiscussion)&&((aMessage.pere&&lDiscussion.pere)||(!aMessage.pere&&!lDiscussion.pere)))
return J;}}}}
return null;};TUtilitaireMessagerie.getIndicePere=function(aListeMessagerie,aMessage){if(aMessage.indicePere>=0)
return this.getIndicePere(aListeMessagerie,aListeMessagerie.GetElement(aMessage.indicePere));else return aMessage.indice;};TUtilitaireMessagerie.estEgal=function(aMessage1,aMessage2){if(aMessage1&&aMessage2){if(aMessage1.estUneDiscussion&&aMessage2.estUneDiscussion)
return this.getCleDiscussion(aMessage1)===this.getCleDiscussion(aMessage2);else if(!aMessage1.estUneDiscussion&&!aMessage2.estUneDiscussion)
return aMessage1.GetNumero()===aMessage2.GetNumero();}
return false;};})();;

MethodesObjet.heritagePrototype(DonneesListe_Messagerie,ObjetDonneesListe);function DonneesListe_Messagerie(aDonnees,aParam){this.inheritedCreate(aDonnees);this.pere=aParam.pere;this.evenementDeploiement=aParam.evenementDeploiement;this.evenementMenuContextuel=aParam.evenementMenuContextuel;this.classDeploiement=IE.GUID.getClassCss();this.avecDeploiement=aParam.avecDeploiement||false;}
DonneesListe_Messagerie.genreColonne={date:0,document:1,participants:2};DonneesListe_Messagerie.genreCommande={lu:0,nonLu:1,supprimer:2,archiver:3,desarchiver:4,transferer:5};(function(){DonneesListe_Messagerie.prototype.AvecEvenement_Creation=function(I){return true;};DonneesListe_Messagerie.prototype.AvecEvenement_Selection=function(I,J){return true;};DonneesListe_Messagerie.prototype.AvecEvenement_ApresSuppression=function(I,J){return false;};DonneesListe_Messagerie.prototype.AvecEdition=function(I,D){return false;};DonneesListe_Messagerie.prototype.AvecSuppression=function(D){return false;};DonneesListe_Messagerie.prototype.AvecSelection=function(I,D){return true;};DonneesListe_Messagerie.prototype.AvecDeploiement=function(D){return true;};DonneesListe_Messagerie.prototype.AvecMenuContextuel=function(I,D,aLigne){return!!D&&aLigne>=0;};DonneesListe_Messagerie.prototype.initialisationObjetContextuel=function(I,D,aInstance,aAvecCreation,aNonEditable){if(!aInstance) return;if(GApplication.droits.get(IEEnum.droits.communication.avecDiscussionAvancee)){if(D.archive)
aInstance.AddCommande(DonneesListe_Messagerie.genreCommande.desarchiver,GTraductions.getValeur('Messagerie.Desarchiver'));else aInstance.AddCommande(DonneesListe_Messagerie.genreCommande.archiver,GTraductions.getValeur('Messagerie.Archiver'));if((!D.estUneDiscussion&&!D.brouillon)||(D.estUneDiscussion&&(D.nbBrouillons||0)<D.nombreMessages))
aInstance.AddCommande(DonneesListe_Messagerie.genreCommande.transferer,D.estUneDiscussion?GTraductions.getValeur('Messagerie.Menu_TransfererLaDiscussion'):GTraductions.getValeur('Messagerie.Menu_TransfererLeMessage'));}
if(D.estUneDiscussion)
aInstance.AddCommande(DonneesListe_Messagerie.genreCommande.supprimer,GTraductions.getValeur('Messagerie.Menu.Supprimer'));else if(D.brouillon)
aInstance.AddCommande(DonneesListe_Messagerie.genreCommande.supprimer,GTraductions.getValeur('Messagerie.HintSupprimerBrouillon'));aInstance.SetDonnees();};DonneesListe_Messagerie.prototype.evenementMenuContextuel=function(aColonne,aLigne,D,aLigneMenuContextuel,aElementMenuContextuel){this.evenementMenuContextuel.call(this.pere,aLigneMenuContextuel.GetNumero(),D);};DonneesListe_Messagerie.prototype.estCelluleDeFusionEnLigne=function(I,D){return D.estUneDiscussion;};function _surDeploiement(event){var lIndice=GHtml.extraireNombreDId($(this).parent().parent().parent().get(0).id,1),lInstance=event.data.instance,lElement=lInstance.Donnees.GetElement(lIndice);if(lElement){lInstance.evenementDeploiement.call(lInstance.pere,lElement);}}
DonneesListe_Messagerie.prototype.apresConstruction=function(){$('.'+this.classDeploiement).on('mousedown',{instance:this},_surDeploiement);};DonneesListe_Messagerie.prototype.GetValeur=function(I,D,K){switch(I){case DonneesListe_Messagerie.genreColonne.date:{var lHtmlDeploiement=this.avecDeploiement?'<div class="'+this.classDeploiement+' InlineBlock '+(D.estDeploye?'Image_DeploiementListe_Deploye':'Image_DeploiementListe_NonDeploye')+'" style="margin-right: 3px;"></div>':'';return D.estUneDiscussion?TUtilitaireMessagerie.getLibelleDiscussion(D,lHtmlDeploiement):TUtilitaireMessagerie.getLibelleDate(D);}
case DonneesListe_Messagerie.genreColonne.document:return D.documentsJoints?'Image_TrombonePetit':'';case DonneesListe_Messagerie.genreColonne.participants:return TUtilitaireMessagerie.getLibelleParticipants(D);default:return'';}};DonneesListe_Messagerie.prototype.GetTypeValeur=function(I,D){switch(I){case DonneesListe_Messagerie.genreColonne.date:return D.estUneDiscussion?this.ETypeCellule.Html:this.ETypeCellule.Texte;case DonneesListe_Messagerie.genreColonne.document:return this.ETypeCellule.Image;case DonneesListe_Messagerie.genreColonne.participants:return this.ETypeCellule.Html;default:return this.ETypeCellule.Texte;}};DonneesListe_Messagerie.prototype.getClass=function(I,D){var lClass=[D.profondeur>1?'Italique':''];return lClass.join(' ');};DonneesListe_Messagerie.prototype.getNiveauDeploiement=function(I,D){return D.profondeur;};DonneesListe_Messagerie.prototype.GetCouleurCellule=function(I,D){return D.estUneDiscussion?this.ECouleurCellule.Deploiement:this.ECouleurCellule.Gris;};DonneesListe_Messagerie.prototype.GetVisible=function(D){return D.visible;};DonneesListe_Messagerie.prototype.SurSuppression=function(D){for(var I=0;I<this.Donnees.GetNbrElements();I++){var lMessage=this.Donnees.GetElement(I);if(TUtilitaireMessagerie.getIndicePere(this.Donnees,lMessage)===D.indice)
lMessage.SetEtat(EGenreEtat.Suppression);}};DonneesListe_Messagerie.prototype.GetMessage_Suppression_Confirmation=function(D){return GTraductions.getValeur('Messagerie.ConfirmationSuppression');};}());;
function TypeChaineHtml(aChaineHtml){this.chaineHtml=IE.MethodesObjet.isString(aChaineHtml)?aChaineHtml:'';}
TypeChaineHtml.prototype.toJSON=function(){var lJSON={};lJSON[IE.ObjetJSON.const_champ_Type]=EGenreType.Html;lJSON[IE.ObjetJSON.const_champ_Valeur]=this.chaineHtml;return lJSON;};;
function ObjetRequeteSaisieMessage(aPere,aEvenementSurReussite,aEvenementSurEchec){this.inheritedCreate(aPere,aEvenementSurReussite,aEvenementSurEchec);}
IE.Requetes.inscrire('SaisieMessage',ObjetRequeteSaisieMessage,_ObjetRequeteXmlSaisiePN);(function(){ObjetRequeteSaisieMessage.prototype.lancerRequete=function(aParam){var lParam={avecHtml:false};$.extend(lParam,aParam);if(aParam.pourSuppression){this.JSON.pourSuppression=true;lParam.message.listePossessionsMessages.setSerialisateurJSON({ignorerEtatsElements:true,nePasTrierPourValidation:true});this.JSON.listePossessionsMessages=lParam.message.listePossessionsMessages;} else if(aParam.pourLu){this.JSON.pourLu=true;this.JSON.lu=aParam.lu;lParam.message.listePossessionsMessages.setSerialisateurJSON({ignorerEtatsElements:true,nePasTrierPourValidation:true});this.JSON.listePossessionsMessages=lParam.message.listePossessionsMessages;} else if(aParam.pourArchive){this.JSON.pourArchive=true;this.JSON.archiver=aParam.archiver;lParam.message.listePossessionsMessages.setSerialisateurJSON({ignorerEtatsElements:true,nePasTrierPourValidation:true});this.JSON.listePossessionsMessages=lParam.message.listePossessionsMessages;}
else{if(aParam.pourBrouillon){this.JSON.pourBrouillon=true;this.JSON.brouillon=lParam.brouillon;if(lParam.brouillon&&lParam.brouillon.ignorerPJ)
this.JSON.ignorerPJBrouillon=true;_serialiserTransferts(this.JSON,aParam);}
else if(aParam.pourTransfert){this.JSON.pourTransfert=true;_serialiserTransferts(this.JSON,aParam);}
else{this.JSON.bouton=lParam.bouton;this.JSON.estChat=lParam.estChat;if(lParam.brouillon&&lParam.brouillon.existeNumero()){this.JSON.brouillon=lParam.brouillon;if(lParam.brouillon.ignorerPJ)
this.JSON.ignorerPJBrouillon=true;}}
this.JSON.messagePourReponse=lParam.messagePourReponse;this.JSON.objet=lParam.objet;if(lParam.avecHtml)
this.JSON.contenu=new TypeChaineHtml(lParam.contenu);else this.JSON.contenu=lParam.contenu;this.JSON.listeDestinataires=lParam.listeDestinataires;if(lParam.PJ){this.JSON.nomfichier=lParam.PJ.fichier.Libelle;this.JSON.idFichier=GChaine.CardinalToStr(lParam.PJ.fichier.idFichier);}}
IE.Invocateur.evenement('requeteSaisieMessage',false,this.callbackReussite.pere);this.appelAsynchroneSaisie();if(aParam&&aParam.apresEnvoieRequete)
aParam.apresEnvoieRequete();};ObjetRequeteSaisieMessage.prototype.actionApresRequete=function(){this.callbackReussite.appel(this.JSONRapportSaisie);};function _serialiserTransferts(aJSON,aParam){aJSON.listeMessagesTransfert=aParam.listeMessagesTransfert;if(aJSON.listeMessagesTransfert)
aJSON.listeMessagesTransfert.setSerialisateurJSON({ignorerEtatsElements:true,nePasTrierPourValidation:true});}
ObjetRequeteSaisieMessage.prototype.apresReponseRequete=function(){IE.Invocateur.evenement('requeteSaisieMessage',true,this.callbackReussite.pere);};})();;
function ObjetRequeteListeMessagerie(aPere,aEvenementSurReussite,aEvenementSurEchec){this.inheritedCreate(aPere,aEvenementSurReussite,aEvenementSurEchec);}
IE.Requetes.inscrire('ListeMessagerie',ObjetRequeteListeMessagerie,_ObjetRequeteXmlConsultationPN);ObjetRequeteListeMessagerie.prototype.lancerRequete=function(aParametres){var lParametres=$.extend({},aParametres);$.extend(this.JSON,lParametres);this.appelAsynchroneConsultation();};ObjetRequeteListeMessagerie.prototype.actionApresRequete=function(){for(var I=0;I<this.JSONReponse.listeMessagerie.GetNbrElements();I++){var lLigne=this.JSONReponse.listeMessagerie.GetElement(I);lLigne.indice=I;if(lLigne.indicePere>=0)
lLigne.pere=this.JSONReponse.listeMessagerie.GetElement(lLigne.indicePere);lLigne.estDeploye=false;lLigne.estUneDiscussion=lLigne.estUneDiscussion?true:false;}
this.callbackReussite.appel(this.JSONReponse);};;
function ObjetRequeteListeMessages(aPere,aEvenementSurReussite,aEvenementSurEchec){this.inheritedCreate(aPere,aEvenementSurReussite,aEvenementSurEchec);}
IE.Requetes.inscrire('ListeMessages',ObjetRequeteListeMessages,_ObjetRequeteXmlConsultationPN);ObjetRequeteListeMessages.prototype.lancerRequete=function(aParametres){var lParametres=$.extend({},aParametres);$.extend(this.JSON,lParametres);this.JSON.marquerCommeLu=aParametres.marquerCommeLu;lParametres.message.listePossessionsMessages.setSerialisateurJSON({ignorerEtatsElements:true,nePasTrierPourValidation:true,methodeSerialisation:function(aElement,aJSON){if(aElement.ignorerSerialisation===true)
return false;}});this.JSON.listePossessionsMessages=lParametres.message.listePossessionsMessages;if(lParametres.message.estUneDiscussion&&lParametres.message.profondeur>0)
this.JSON.estSousDiscussion=true;this.appelAsynchroneConsultation();};ObjetRequeteListeMessages.prototype.actionApresRequete=function(){this.callbackReussite.appel(this.JSONReponse);};;

function InterfaceListeMessagerie(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.idReponse=window.GUID.getId();this.idDiscussion=window.GUID.getId();this.idSectionListe=window.GUID.getId();this.idFiltreDiscussion=window.GUID.getId();this.idBandeauGauche=window.GUID.getId();this.idBandeauDroite=window.GUID.getId();this.idBrouillonNonEnvoye=window.GUID.getId();this.idVisuTransfert=window.GUID.getId();this.avecFlecheInfo=false;this._options={avecListeDiscussions:true,enFenetre:false,estDiscussionCommune:false,hauteurFiltre:19,avecSousDiscussions:true,discussionSelectionneeUniquementVisible:false,estChat:false,activerSauvegardeAutoBrouillon:true,activerBoutonsBrouillon:false};this.uniquementLesCommunes=true;this.sansDiscussions=false;this._initBrouillon();this.avecEditeurRiche=GNavigateur.withContentEditable&&!MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Eleve,EGenreEspace.Parent]);IE.Invocateur.abonner('notification_actualisationMessage',this._notificationCommunication,this);IE.Invocateur.abonner('requeteSaisieMessage',this._notificationRequeteSaisieMessage,this);IE.Invocateur.abonner('notification_creationDiscussion',function(){this.__selectionneeDiscussionRecente=true;},this);IE.Invocateur.evenement('affichage_messagerie',true);}
MethodesObjet.heritagePrototype(InterfaceListeMessagerie,ObjetInterfacePage);(function(){var EGenreMenuVisuMessage={repondreMessage:0,afficherDiscussion:1,supprimerBrouillon:2};InterfaceListeMessagerie.prototype.getControleur=function(){return{cbNonLu:{getValue:function(){return GApplication.parametresUtilisateur.get('Communication.DiscussionNonLues');},setValue:function(aValue){_evenementSurCBLue.call(this.instance,aValue);}},brouillon:{inputObjet:{getValue:function(){return this.instance.brouillon&&this.instance.brouillon.objet?this.instance.brouillon.objet||'':'';},setValue:function(aValue){this.instance.brouillon.objet=aValue;this.instance.brouillon.SetEtat(EGenreEtat.Modification);}},enregistrer:{event:function(){this.instance._requeteSaisieMessage({pourBrouillon:true,brouillon:this.instance.brouillon,messagePourReponse:this.instance.messagePourReponse,objet:this.instance.brouillon.objet,contenu:this.instance.brouillon.contenu,listeDestinataires:this.instance.brouillon.listeDestinataires,PJ:this.instance.brouillon.PJ});},getDisabled:function(){return!(this.instance.messagePourReponse&&this.instance.brouillon.Etat!==EGenreEtat.Aucun);}},poubelle:{event:function(){var lMessage=IE.MethodesObjet.dupliquer(this.instance.brouillon);lMessage.listePossessionsMessages=new ObjetListeElements();lMessage.listePossessionsMessages.AddElement(IE.MethodesObjet.dupliquer(this.instance.brouillon));_supprimerMessageCourant.call(this.instance,lMessage);},getDisabled:function(){return!(this.instance.brouillon.existeNumero()&&this.instance.brouillon.Etat!==EGenreEtat.Creation);},getTitle:function(){return GTraductions.getValeur('Messagerie.HintSupprimerBrouillon');}}},destinataires:{avecBtnAjouter:function(){return this.instance.paramDestinataires&&this.instance.paramDestinataires.listeProfesseurs&&this.instance.paramDestinataires.listePersonnels&&this.instance.messagePourReponse&&!this.instance.messagePourReponse.estChat;},btnAjouter:{event:function(){var lMessagePourReponse=this.instance.messagePourReponse;ObjetMenuContextuel.afficher({pere:this.instance,evenement:_menuContextuelAjouterDestinataires,initCommandes:function(aInstance){var lNbProfs=lMessagePourReponse&&lMessagePourReponse.listeDestinataires?lMessagePourReponse.listeDestinataires.getListeElements(function(D){return D.GetGenre()===EGenreRessource.Enseignant;}).GetNbrElements():0,lNbPerso=lMessagePourReponse&&lMessagePourReponse.listePersonnels?lMessagePourReponse.listeDestinataires.getListeElements(function(D){return D.GetGenre()===EGenreRessource.Personnel;}).GetNbrElements():0;aInstance.AddCommande(EGenreRessource.Enseignant,GTraductions.getValeur('Professeurs')+(lNbProfs>0?' (+ '+lNbProfs+')':''));aInstance.AddCommande(EGenreRessource.Personnel,GTraductions.getValeur('Personnels')+(lNbPerso>0?' (+ '+lNbPerso+')':''));}});},getTitle:function(){return GTraductions.getValeur('Messagerie.HintAjouterDest');}},nb:function(){var lNb=_getListeDestinatairesMessageCourant.call(this.instance).GetNbrElements();return lNb>0?lNb===1?GTraductions.getValeur('Messagerie.UnDestinataire'):GTraductions.getValeur('Messagerie.NDestinataires',[lNb]):'';},hint:function(){var lDestinataires=_getListeDestinatairesMessageCourant.call(this.instance);lDestinataires.setTri([ObjetTri.init('Genre'),ObjetTri.init('Position')]);lDestinataires.trier();return lDestinataires.getTableauLibelles().join('\n');}},visuMessage:{event:function(aIndice,aEvent){switch(aEvent.type){case'click':_selectionVisuMessage.call(this.instance,aIndice);break;case'contextmenu':var lMessageListe=_selectionVisuMessage.call(this.instance,aIndice);if(lMessageListe)
_menuContextuelVisuMessage.call(this.instance,lMessageListe);break;}
this.controleur.$refreshSelf();},getStyle:function(aIndice,aCouleur){if(!this.instance.listeMessages) return null;var lMessageVisu=this.instance.listeMessages.GetElement(aIndice),lEstSelectionne=false;if(lMessageVisu){lEstSelectionne=this.instance.message&&lMessageVisu.GetNumero()===this.instance.message.GetNumero();if(!lEstSelectionne)
lEstSelectionne=this.instance._messageVisuSelectionne&&this.instance._messageVisuSelectionne.possessionMessage&&lMessageVisu.possessionMessage&&lMessageVisu.GetNumero()===this.instance._messageVisuSelectionne.GetNumero()&&lMessageVisu.possessionMessage.GetNumero()===this.instance._messageVisuSelectionne.possessionMessage.GetNumero();}
return{'border-color':lEstSelectionne?GCouleur.selection.fond:aCouleur};}}};};InterfaceListeMessagerie.prototype._notificationCommunication=function(){if(this._options.estChat)
return;this.SetDonnees({conserverBrouillon:true});};InterfaceListeMessagerie.prototype._notificationRequeteSaisieMessage=function(aEstReponseRequete,aInstanceEmetteur){if(aEstReponseRequete)
IE.Invocateur.abonner('notification_actualisationMessage',this._notificationCommunication,this);else IE.Invocateur.desabonner('notification_actualisationMessage',this);if(this._options.estChat)
return;if(aEstReponseRequete)
this.SetDonnees(aInstanceEmetteur===this?this.param:{conserverBrouillon:true});};InterfaceListeMessagerie.prototype._autorisePJ=function(){return!this._options.estChat&&!MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Eleve,EGenreEspace.Parent]);};InterfaceListeMessagerie.prototype._initBrouillon=function(){this.brouillon=new ObjetElement();this.brouillon.contenu='';this.brouillon.objet='';this.brouillon.listeFichiers=new ObjetListeElements();this.brouillon.PJ=null;};InterfaceListeMessagerie.prototype.setOptions=function(aOptions){$.extend(this._options,aOptions);};InterfaceListeMessagerie.prototype.ConstruireInstances=function(){if(!this._options.enFenetre){this.ajouterEvenementGlobal(EEvent.SurPreResize,_surPreResize.bind(this));this.ajouterEvenementGlobal(EEvent.SurPostResize,_surPostResize.bind(this));}
if(this._options.avecListeDiscussions&&GApplication.droits.get(IEEnum.droits.communication.avecDiscussionAvancee))
this.identComboEtiquette=this.Add(window.ObjetSaisiePN,_evenementSurComboEtiquette.bind(this),_initialiserComboEtiquette.bind(this));this.identListe=this.Add(window.ObjetListe ,this._evenementSurListe,this._initialiserListe);this.identBoutonEditeurHTML=this.Add(window.ObjetBoutonBandeau,this.evenementSurBoutonHTML ,this.initialiserBoutonEditeurHTML);this.identFenetreHTML=this.Add(window.ObjetFenetre ,this.evenementSurFenetreHTML ,this.initialiserFenetreHTML);this.identBoutons=[];this.identBoutons[0]=this.Add(window.ObjetBouton,this._evenementSurBoutonRepondre,this._initialiserBouton);this.identBoutons[1]=this.Add(window.ObjetBouton,this._evenementSurBoutonRepondre,this._initialiserBouton);this.identBoutons[2]=this.Add(window.ObjetBouton,this._evenementSurBoutonRepondre,this._initialiserBouton);if(this._autorisePJ()){this.identSelecteurPJ=this.Add(window.ObjetSelecteurPJ,_evntSelecteurPJ.bind(this),_initSelecteurPJ.bind(this));}
if(false){this.identBoutonMonsieurFiche=this.Add(window.ObjetBoutonBandeau,_evenementSurBoutonMonsieurFiche.bind(this) ,_initialiserBoutonMonsieurFiche);}
if(GApplication.droits.get(IEEnum.droits.communication.avecDiscussionAvancee))
this.identDestinataire=this.Add(window.ObjetDestinataires,_evenementSurDestinataire);if(this.identComboEtiquette!==undefined)
this.idPremierObjet=this.GetInstance(this.identComboEtiquette).GetNom();else this.idPremierObjet=this.GetInstance(this.identListe).GetNom();if(this._options.estChat){IE.Invocateur.desabonner('traiter_notifications_chatVS',this);IE.Invocateur.abonner('traiter_notifications_chatVS',_actualisationSurNotificationChat.bind(this),this);}};InterfaceListeMessagerie.prototype.DetruireInstances=function(){if(window.GTinyInit)
window.GTinyInit.detruireInstanceTiny(this.idReponse);IE.Invocateur.evenement('affichage_messagerie',false);};InterfaceListeMessagerie.prototype.SetParametresGeneraux=function(){this.GenreStructure=EStructureAffichage.Autre;};InterfaceListeMessagerie.prototype.ConstruireStructureAffichageAutre=function(){var H=[];var lWidth=this._options.avecListeDiscussions?this._options.enFenetre?(330+31):(410+31):0;H.push('<div style="width: 100%; height: 100%;">');H.push('<table class="Texte10 Espace" style="width: 100%; height: 100%;" border="0" cellpadding="0" cellspacing="0">');H.push('<tr>');H.push('<td id="',this.idSectionListe,'" class="AlignementHaut" style="',GStyle.composeWidth(lWidth),GStyle.composeHeight('100%'),'">','<div>',this._options.enFenetre?'<div class="AlignementHaut" style="'+GStyle.composeWidth(lWidth)+GStyle.composeHeight(this._options.hauteurFiltre)+'">'+_composeCBNonLu()+'</div>':'<div class="EspaceBas">'+composeBandeauGauche.bind(this)()+'</div>','<div id="',this.GetNomInstance(this.identListe),'" class="AlignementHaut" style="',GStyle.composeWidth(lWidth),GStyle.composeHeight('100%'),'"></div>','</div>','</td>');H.push('<td id="',this.idReponse,'_section" class="AlignementHaut EspaceGauche">');H.push('<div>');if(!this._options.enFenetre) H.push('<div class="EspaceBas">'+composeBandeauDroite.bind(this)()+'</div>');H.push('<div style="margin-bottom : 3px;">');H.push('<div id="',this.idReponse,'_vide" style="height: 132px; display : none" class="Texte10">',this.composeMessage(GTraductions.getValeur('Messagerie.AucuneDiscussionSelectionnee')),'</div>');H.push('<table id="',this.idReponse,'_pere" style="height: 132px;" class="Table Texte10" border="0" cellpadding="0" cellspacing="0" >');if(GApplication.droits.get(IEEnum.droits.communication.avecDiscussionAvancee)){H.push('<tr id="',this.idBrouillonNonEnvoye,'" style="display:none;"><td id="',this.idBrouillonNonEnvoye,'_td"style="padding-left: 50px;"');H.push('</td><td></td></tr>');}
if(this._autorisePJ()){H.push('<tr><td style="padding-left: 50px;" colspan="2">');H.push('<div id="',this.GetNomInstance(this.identSelecteurPJ),'"></div>');H.push('</td></tr>');}
var lEventKeyUp=this.avecEditeurRiche?'':' onkeyup="'+this.Nom+'._setMessage (value)" onchange="'+this.Nom+'._setMessage (value)"';H.push('<tr>','<td style="padding-left: 50px; width:100%;" class="AlignementHaut">','<textarea id="',this.idReponse,'" ',(this.avecEditeurRiche?' maxlength="0"':' maxlength="10000"'),' class="Texte10"',lEventKeyUp,' style="width: 100%;',(this.avecEditeurRiche?'':GStyle.composeHeight(75)),' border: 1px solid black;"></textarea>','</td>','<td id="',this.GetInstance(this.identBoutonEditeurHTML).GetNom(),'" class="AlignementHaut" oncontextmenu="GNavigateur.StopperEvenement (event); return false;"></td>','</tr>');if(GApplication.droits.get(IEEnum.droits.communication.avecDiscussionAvancee)){H.push('<tr id="',this.idVisuTransfert,'" style="display:none;"><td id="',this.idVisuTransfert,'_td"style="padding-left: 50px;">');H.push('</td><td></td></tr>');}
H.push('<tr><td>');H.push('<div style="margin : 5px 0 5px 0; height : 20px;">');if(this._options.activerBoutonsBrouillon&&!this._options.estChat&&GApplication.droits.get(IEEnum.droits.communication.avecDiscussionAvancee)){H.push('<div style="padding-left: 50px;">','<div style="float:left"><ie-btnimage ie-model="brouillon.enregistrer" class="Image_SystemeEnregistrer" style="width:22px;"></ie-btnimage></div>','<div style="float:left; margin-left:5px;margin-top:2px;"><ie-btnimage ie-model="brouillon.poubelle" class="Image_Poubelle" style="width:18px;"></ie-btnimage></div>','</div>');}
H.push('<div id="',this.GetNomInstance(this.identBoutons[0]),'" style="margin-left: 5px; float: right;"></div>');H.push('<div id="',this.GetNomInstance(this.identBoutons[1]),'" style="margin-left: 5px; float: right;"></div>');H.push('<div id="',this.GetNomInstance(this.identBoutons[2]),'" style="margin-left: 5px; float: right;"></div>');if(GApplication.droits.get(IEEnum.droits.communication.avecDiscussionAvancee)&&!this._options.estChat){H.push('<div style="margin-left: 5px; float: right;" ie-if="destinataires.avecBtnAjouter">','<ie-btnimage ie-model="destinataires.btnAjouter" class="Image_IconePlus" style="width:18px;"></ie-btnimage>','</div>');H.push('<div ie-html="destinataires.nb" ie-title="destinataires.hint" style="margin-left: 5px; margin-top:4px; float: right;"></div>');}
H.push('</div>');H.push('</td><td></td></tr>');H.push('</table>');H.push('</div>');H.push('<div id="',this.idDiscussion,'" style="overflow-y: auto; height: 100%;width:100%;"></div>');H.push('</div>');H.push('</td>');H.push('</tr>');H.push('</table>');H.push('</div>');return H.join('');};function _composeCBNonLu(){return'<ie-checkbox ie-model="cbNonLu" class="Gras NoWrap" style="'+GStyle.composeCouleurTexte(GCouleur.bandeau.texte)+'">'+GChaine.Insecable(GTraductions.getValeur('actualites.UniquementNonLues'))+'&nbsp;'+'</ie-checkbox>';}
function composeBandeauGauche(){var T=[];T.push('<table class="Texte10" style="width:100%;',GStyle.composeHeight(GApplication.hauteurBandeau),'" border="0" cellpadding="0" cellspacing="0">');T.push('<tr><td class="Gras EspaceGauche MaClasseBordure" style="'+GStyle.composeCouleur(GCouleur.bandeau.fond,GCouleur.bandeau.texte)+' height:',GApplication.hauteurBandeau,'px;">');T.push('<table class="Texte10 Table" border="0" cellpadding="0" cellspacing="0" id="',this.idBandeauGauche,'" tabIndex="-1">');T.push('<tr>');if(this.GetInstance(this.identComboEtiquette))
T.push('<td id="',this.GetInstance(this.identComboEtiquette).GetNom(),'" style="width: 100%"></td>');T.push('<td class="AlignementDroite">',_composeCBNonLu(),'</td>');T.push('</tr>');T.push('</table>');T.push('</td></tr>');T.push('</table>');return T.join('');}
function composeBandeauDroite(){var T=[];T.push('<table class="Texte10" style="width:100%;',GStyle.composeHeight(GApplication.hauteurBandeau),'" border="0" cellpadding="0" cellspacing="0">');T.push('<tr><td class="Gras EspaceGauche MaClasseBordure" style="'+GStyle.composeCouleur(GCouleur.bandeau.fond,GCouleur.bandeau.texte)+' height: ',GApplication.hauteurBandeau,'px;">');T.push('<table class="Texte10 Table" border="0" cellpadding="0" cellspacing="0" id="',this.idBandeauDroite,'" tabIndex="-1">');T.push('<tr>');T.push('<td id="',this.idBandeauDroite,'_Texte" tabIndex="-1" class="Gras" style="width:100%;">','</td>');if(IE.MethodesObjet.isNumber(this.identBoutonMonsieurFiche)){T.push('<td id="',this.GetNomInstance(this.identBoutonMonsieurFiche),'" class="PetitEspaceDroit"></td>');}
T.push('</tr>');T.push('</table>');T.push('</td></tr>');T.push('</table>');return T.join('');}
function _initTiny(){GHtml.setValue(this.idReponse,'');if(!this.avecEditeurRiche) return;_actualiserContenuSaisie.call(this);var lInit=window.GTinyInit.getParametresInitParDefaut({id:this.idReponse,pere:this});lInit.theme_advanced_toolbar_location="none";lInit.height=75;lInit.min_height=75;lInit.max_height=75;lInit.setup=function(editor){editor.onKeyUp.add(function(editor){if(editor.isDirty())
editor.settings.pere._setMessage(editor.getContent());});editor.onChange.add(function(editor){if(!editor._enCoursDestruction&&editor.isDirty())
editor.settings.pere._setMessage(editor.getContent());});window.GTinyInit.setupParDefaut(editor);};tinyMCE.init(lInit);this.$refreshSelf();}
InterfaceListeMessagerie.prototype.SetDonnees=function(aParam){if(this._options.callbackActualisation)
this._options.callbackActualisation();this.param=aParam;if(aParam&&aParam.message){this.message=aParam.message;if(!this._options.estChat)
GEtatUtilisateur.message=this.message;}
if(aParam&&aParam.listeMessagerie){this.listeMessagerie=aParam.listeMessagerie;}
if(aParam&&aParam.ressource)
this.ressource=aParam.ressource;if(aParam&&aParam.avecSelectionPremiereDiscussion)
this.avecSelectionPremiereDiscussion=aParam.avecSelectionPremiereDiscussion;if(!aParam||!aParam.conserverBrouillon){_sauvegardeBrouillonAvecConfirmation(this);this._initBrouillon();if(this.avecEditeurRiche&&window.GTinyInit){window.GTinyInit.detruireInstanceTiny(this.idReponse);_initTiny.bind(this)();}
else GHtml.setValue(this.idReponse,this.brouillon.contenu);_actualiserSelecteurPJ.call(this);this.$refreshSelf();}
GHtml.setDisplay(this.idSectionListe,this._options.avecListeDiscussions);if(GEtatUtilisateur.message&&!this._options.estChat){this.listeMessagerie=null;this.message=GEtatUtilisateur.message;}
if(this._options.estChat&&!aParam.message){_creationDiscussion.call(this);return;}
if(this._options.avecListeDiscussions||!this.listeMessagerie){if(!this.message){GHtml.setDisplay(this.idReponse+'_pere',false);GHtml.setDisplay(this.idReponse+'_vide',true);$('#'+this.idDiscussion.escapeJQ()).html('');if(!this._options.enFenetre) GHtml.setHtml(this.idBandeauDroite+'_Texte','');}
new ObjetRequeteListeMessagerie(this,this._reponseRequeteListeMessagerie).lancerRequete({avecMessage:true,avecLu:true,ressource:this.ressource});} else if(!this._options.avecListeDiscussions&&this.message){this.avecSelectionPremiereDiscussion=true;new ObjetRequeteListeMessages(this,this._reponseListeMessages.bind(this)).lancerRequete({message:this.message,marquerCommeLu:true});}};InterfaceListeMessagerie.prototype.RecupererDonnees=function(){if(this.avecRecupereDonnees!==false)
this.SetDonnees();};function _initialiserComboEtiquette(aInstance){aInstance.setOptions_ObjetSaisie({longueur:80});aInstance.SetControleNavigation(true);}
InterfaceListeMessagerie.prototype._initialiserListe=function(aInstance){var lInstance=this;aInstance.controleur.filtreDiscussion={visible:function(){return!!lInstance._options.estDiscussionCommune;},bouton:{event:function(){lInstance.uniquementLesCommunes=!lInstance.uniquementLesCommunes;_surChangerFiltreDiscussion.call(lInstance);},getSelection:function(){return lInstance.uniquementLesCommunes;},getTitle:function(){return lInstance.uniquementLesCommunes?GTraductions.getValeur('Messagerie.Info.TousMessages'):GTraductions.getValeur('Messagerie.Info.FiltrerMessages');}}};var lOptions={listeTailles:this._options.avecSousDiscussions?this._options.enFenetre?[90,10,230]:[200,10,200]:this._options.enFenetre?[330]:[410],listeTitres:this._options.avecSousDiscussions?[GTraductions.getValeur('Messagerie.Titre.Date'),'[Image_TrombonePetit_Blanc]',{libelleHtml:'<div style="float:left" ie-if="filtreDiscussion.visible">'+'<ie-btnimage ie-model="filtreDiscussion.bouton" class="Image_FiltrePourListe" style="width:15px;"></ie-btnimage>'+'</div>'+GTraductions.getValeur('Messagerie.Titre.Participants')}
]:[GTraductions.getValeur('accueil.discussions')]};if(!this._options.enFenetre&&(!this.etiquette||(!this.etiquette.brouillon&&!this.etiquette.archive))){$.extend(lOptions,{titreCreation:GTraductions.getValeur('Messagerie.LigneNouvelleDiscussion'),listeCreations:1,creationLigne:-1});}
aInstance.setOptionsListe(lOptions,true);};InterfaceListeMessagerie.prototype.initialiserBoutonEditeurHTML=function(aInstance){var lTrad=GTraductions.getValeur('CahierDeTexte.miseEnForme');aInstance.setOptions_ObjetBoutonBandeau({nomClass:'Image_FormatageTexte',avecEtat:true,actif:false,tableauLibelles:[lTrad,lTrad,lTrad],taille:21,avecSelection:false,avecEspaceGauche:false,raccourciClavier:undefined});aInstance.selection=false;aInstance.SetVisible(this.avecEditeurRiche);};function _initialiserBoutonMonsieurFiche(aInstance){var lTitre=GTraductions.getTitreMFiche('Messagerie.MFicheDiscussion');aInstance.SetParametres('Image_MonsieurFiche',true,false,true,[lTitre,lTitre,lTitre],20,false);}
function _evenementSurBoutonMonsieurFiche(){var lId=this.GetInstance(this.identBoutonMonsieurFiche).getPremierElement();GApplication.getMessage().afficher({idRessource:'Messagerie.MFicheDiscussion',callback:function(){GHtml.setFocus(lId);}});}
InterfaceListeMessagerie.prototype.initialiserFenetreHTML=function(aInstance){aInstance.SetParametres_Fenetre(GTraductions.getValeur('CahierDeTexte.miseEnForme'),850,420,[GTraductions.getValeur('Annuler'),GTraductions.getValeur('Valider')]);};InterfaceListeMessagerie.prototype._initialiserBouton=function(aInstance){aInstance.setOptionsBouton({Libelles:[''],labelWAI:''});aInstance.SetVisible(false);};function _initSelecteurPJ(aInstance){aInstance.setOptions({genrePJ:EGenreDocumentJoint.Fichier,genreRessourcePJ:EGenreRessource.RelationMessageFichierExterne,title:GTraductions.getValeur('Messagerie.HintPJ'),maxFiles:1,maxSize:GApplication.droits.get(IEEnum.droits.tailleMaxDocJointEtablissement)});}
InterfaceListeMessagerie.prototype._reponseRequeteListeMessagerie=function(aParam){this.listeEtiquettes=aParam.listeEtiquettes;this.listeMessagerie=aParam.listeMessagerie;this.sansDiscussions=(this.listeMessagerie.GetNbrElements()===0);if(this.GetInstance(this.identComboEtiquette)){var lIndice=0;if(this.etiquette)
lIndice=this.listeEtiquettes.GetIndiceParElement(this.etiquette);this.GetInstance(this.identComboEtiquette).SetDonnees(this.listeEtiquettes,lIndice);}
var lIndiceSelection=TUtilitaireMessagerie.getIndiceDiscussion(this.listeMessagerie,this.message);var lSelection=this.listeMessagerie.GetElement(lIndiceSelection);if(lSelection){if(lSelection.estUneDiscussion){lSelection.estDeploye=!!this.message.estDeploye;}
lSelection=this.listeMessagerie.GetElement(lSelection.indicePere);while(lSelection&&lSelection.estUneDiscussion){lSelection.estDeploye=true;lSelection=this.listeMessagerie.GetElement(lSelection.indicePere);}}
if(this.__selectionneeDiscussionRecente){lIndiceSelection=0;delete this.__selectionneeDiscussionRecente;}
if(this.avecSelectionPremiereDiscussion&&this.listeMessagerie.GetNbrElements()>0&&(!this.message||TUtilitaireMessagerie.getIndiceDiscussion(this.listeMessagerie,this.message)===null||TUtilitaireMessagerie.getIndiceDiscussion(this.listeMessagerie,this.message)===undefined))
lIndiceSelection=0;if(this._options.avecListeDiscussions){_verifierEtatVisibilite.bind(this)();}
lSelection=this.listeMessagerie.GetElement(lIndiceSelection);if(!lSelection||lSelection.visible===false){_viderDiscussion.call(this,false);lIndiceSelection=undefined;}
this.GetInstance(this.identListe).SetDonnees(this.listeDonneesMessagerie=new DonneesListe_Messagerie(this.listeMessagerie,{pere:this,evenementDeploiement:_evenementSurDeploiement.bind(this),evenementMenuContextuel:_evenementSurMenuContextuel.bind(this),avecDeploiement:this._options.avecSousDiscussions}),lIndiceSelection);if(this.param){this.param.conserverBrouillon=false;}
if(this.param&&this.param.callBackApresDonneesMessagerie){this.param.callBackApresDonneesMessagerie(this.sansDiscussions);}};InterfaceListeMessagerie.prototype._setMessage=function(aHtml){var lDescriptif=aHtml;if(this.avecEditeurRiche)
lDescriptif=window.GTinyInit.estContenuVide(lDescriptif)?'':lDescriptif;this.brouillon.contenu=lDescriptif;if(this.brouillon.contenu===''&&this.brouillon.listeFichiers.GetNbrElements()===0&&this.brouillon.Etat===EGenreEtat.Creation)
this._initBrouillon();else this.brouillon.SetEtat(EGenreEtat.Modification);this.$refreshSelf();};function _evenementSurDeploiement(aElement){aElement.estDeploye=!aElement.estDeploye;this.GetInstance(this.identListe).Actualiser(true,false);}
function _afficherMessageVide(aMessage){var lMessage=aMessage||GTraductions.getValeur('Messagerie.AucuneDiscussionSelectionnee');GHtml.setHtml(this.idReponse+'_vide',this.composeMessage(lMessage));GHtml.setDisplay(this.idReponse+'_vide',true);}
function _viderDiscussion(aDetruireTiny){this.message=null;this._messageVisuSelectionne=null;GEtatUtilisateur.message=null;this._initBrouillon();if(window.GTinyInit&&aDetruireTiny)
window.GTinyInit.detruireInstanceTiny(this.idReponse);_afficherMessageVide.bind(this)();GHtml.setDisplay(this.idReponse+'_pere',false);$('#'+this.idDiscussion.escapeJQ()).html('');if(!this._options.enFenetre)
GHtml.setHtml(this.idBandeauDroite+'_Texte','');}
function _evenementSurMenuContextuel(aColonne,aLigne,aLigneMenuContextuel,aElementMenuContextuel){var lParametres;switch(aElementMenuContextuel.GetNumero()){case DonneesListe_Messagerie.genreCommande.lu:{lParametres={pourLu:true,lu:true,message:this.message};break;}
case DonneesListe_Messagerie.genreCommande.nonLu:{lParametres={pourLu:true,lu:false,message:this.message};break;}
case DonneesListe_Messagerie.genreCommande.supprimer:_supprimerMessageCourant.call(this,this.message);return;case DonneesListe_Messagerie.genreCommande.archiver:case DonneesListe_Messagerie.genreCommande.desarchiver:lParametres={pourArchive:true,archiver:aElementMenuContextuel.GetNumero()===DonneesListe_Messagerie.genreCommande.archiver,message:this.message};_sauvegardeBrouillonAvecConfirmation(this);break;case DonneesListe_Messagerie.genreCommande.transferer:var lMessage=_getMessageTransfert.call(this);var lFenetre=ObjetFenetre.creerInstance(window.ObjetFenetre_Message,{pere:this,evenement:function(aNumeroBouton,aParam){GHtml.setDisplay(lFenetre.GetNom(),false);if(aNumeroBouton===1){var lParametres={pourTransfert:true,objet:aParam.objet,contenu:aParam.contenu,listeDestinataires:aParam.destinataires,PJ:aParam.PJ,listeFichiers:aParam.ListeFichiers,listeMessagesTransfert:lMessage.listeMessagesPourSaisie,apresEnvoieRequete:function(){lFenetre.Fermer();}};this._requeteSaisieMessage(lParametres);}
else{_sauvegarderCreationBrouillonParFenetre.call(this,aParam,lFenetre,lMessage.listeMessagesPourSaisie);}}},{avecChoixDestinataires:true,transfertMessage:true,nePasFermerSurValidation:true,titre:lMessage.nbTransfert>1?GTraductions.getValeur('Messagerie.TransfererLesMessages'):GTraductions.getValeur('Messagerie.TransfererLeMessage')});var lListeMessages=new ObjetListeElements();lListeMessages.AddElement(lMessage);lFenetre.SetDonnees($.extend({transfert:{objet:GTraductions.getValeur('Messagerie.AbreviationTransfert')+' :'+this.message.objet,listeMessages:lListeMessages}},_donneesFenetreEditionDiscussion.call(this)));return;}
this._requeteSaisieMessage(lParametres);}
function _getMessageTransfert(){var lListe=new ObjetListeElements(),lMessage=new ObjetElement('',0);lListe.AddElement(lMessage);lMessage.contenu='';lMessage.listeMessagesPourContexte=new ObjetListeElements();lMessage.listeMessagesPourSaisie=new ObjetListeElements();lMessage.estMessageTransferant=true;lMessage.nbTransfert=0;if(this.listeMessages)
this.listeMessages.parcourir(function(aMessage){if(aMessage.brouillon)
return;if(lMessage.listeMessagesPourContexte.GetElementParNumero(aMessage.GetNumero()))
return;lMessage.listeMessagesPourContexte.AddElement(IE.MethodesObjet.dupliquer(aMessage));lMessage.listeMessagesPourSaisie.AddElement(new ObjetElement('',aMessage.GetNumero()));lMessage.nbTransfert+=1;if(aMessage.listeMessagesPourContexte)
aMessage.listeMessagesPourContexte.parcourir(function(aMessagePourContexte){lMessage.listeMessagesPourContexte.AddElement(IE.MethodesObjet.dupliquer(aMessagePourContexte));});});return lMessage;}
function _evenementSurComboEtiquette(aGenreEvenement,aEtiquette){if(aGenreEvenement===EGenreEvenementObjetSaisie.selection){this.etiquette=aEtiquette;_verifierEtatVisibilite.bind(this)();this._initialiserListe(this.GetInstance(this.identListe));this.GetInstance(this.identListe).Actualiser();if(this.GetInstance(this.identComboEtiquette).InteractionUtilisateur)
_viderDiscussion.call(this,false);}}
function _supprimerMessageCourant(aMessage){var lSelf=this,lParametres={pourSuppression:true,message:aMessage};GApplication.getMessage().afficher({type:EGenreBoiteMessage.Confirmation,message:GTraductions.getValeur('Messagerie.ConfirmationSuppression'),callback:function(aAccepte){if(aAccepte!==EGenreAction.Valider)
return;lSelf._requeteSaisieMessage(lParametres);_viderDiscussion.call(lSelf,true);}});}
function _evenementSurCBLue(aValue){GApplication.parametresUtilisateur.set('Communication.DiscussionNonLues',!!aValue);_sauvegardeBrouillonAvecConfirmation(this);_verifierEtatVisibilite.bind(this)();var lSelection=true;if(GApplication.parametresUtilisateur.get('Communication.DiscussionNonLues')&&this.message&&this.message.lu){_viderDiscussion.call(this,false);lSelection=false;}
this.GetInstance(this.identListe).Actualiser(lSelection,false);}
function _verifierEtatVisibilite(){var lEtatVisible=true;var lIndicePere=null,lFunc=function(aUniquementLesCommunes,D){D.ignorerSerialisation=lUniquementLesCommunes&&D.visibleFiltre===false;};if(this._options.discussionSelectionneeUniquementVisible&&this.message){lIndicePere=TUtilitaireMessagerie.getIndiceDiscussion(this.listeMessagerie,this.message);}
for(var i=0 ;i<this.listeMessagerie.GetNbrElements() ;i++){var lMessage=this.listeMessagerie.GetElement(i);lMessage.visible=true;if(lMessage.estUneDiscussion&&GApplication.parametresUtilisateur.get('Communication.DiscussionNonLues'))
lEtatVisible=!lMessage.lu;if(GApplication.parametresUtilisateur.get('Communication.DiscussionNonLues'))
lMessage.visible=lEtatVisible;if(this._options.discussionSelectionneeUniquementVisible&&lIndicePere!==null){if(lIndicePere!==TUtilitaireMessagerie.getIndicePere(this.listeMessagerie,lMessage)){lMessage.visible=false;}}
if(this._options.estDiscussionCommune){var lUniquementLesCommunes=this.uniquementLesCommunes;if(lUniquementLesCommunes&&lMessage.visibleFiltre===false)
lMessage.visible=false;if(lMessage.listePossessionsMessages)
lMessage.listePossessionsMessages.parcourir(lFunc.bind(this,lUniquementLesCommunes));}
else if(lMessage.estUneDiscussion){if(this.etiquette&&this.etiquette.existeNumero()&&!lMessage.listeEtiquettes.GetElementParElement(this.etiquette)){lMessage.visible=false;lMessage.estDeploye=false;}}}}
function _surChangerFiltreDiscussion(){_verifierEtatVisibilite.call(this);var lAvecSelection=this.message&&this.message.visible;if(!lAvecSelection){_viderDiscussion.call(this,false);}
var lListe=this.GetInstance(this.identListe);lListe.Actualiser(lAvecSelection,false);if(lAvecSelection)
lListe.SelectionnerLigne({ligne:lListe.GetSelection(),avecEvenement:true});}
InterfaceListeMessagerie.prototype._requeteSaisieMessage=function(aParametres,aCallbackRequete){this._conserverBrouillonChat=false;aParametres.avecHtml=MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Professeur,EGenreEspace.Etablissement]);if(aParametres.avecHtml&&aParametres.contenu&&!this.avecEditeurRiche){aParametres.contenu=GChaine.ToHTML(aParametres.contenu);}
this._initBrouillon();var lRequete=new ObjetRequeteSaisieMessage(this,aCallbackRequete?aCallbackRequete:this._evenementSurSaisieMessage);var lListeFichiers=aParametres.listeFichiers;if(!lListeFichiers&&aParametres.brouillon&&aParametres.brouillon.listeFichiers)
lListeFichiers=aParametres.brouillon.listeFichiers;if(lListeFichiers&&lListeFichiers.GetNbrElements()>0){lRequete.addUpload({listeFichiers:lListeFichiers});}
lRequete.lancerRequete(aParametres);};function _tousLesFilsSontLus(aIndiceMessagePere){var I,lMessage,lNb=this.listeMessagerie.GetNbrElements();for(I=0;I<lNb;I++){lMessage=this.listeMessagerie.GetElement(I);if(aIndiceMessagePere===lMessage.indicePere){if(!lMessage.lu){if(lMessage.estUneDiscussion){if(_tousLesFilsSontLus.bind(this)(lMessage.indice)){lMessage.lu=true;}
else{return false;}}
else{return false;}}}}
return true;}
function _mettreAJourLuPereSelonFils(){var I,lMessage;for(I=0;I<this.listeMessagerie.GetNbrElements();I++){lMessage=this.listeMessagerie.GetElement(I);if(lMessage.estUneDiscussion&&!lMessage.lu&&_tousLesFilsSontLus.bind(this)(lMessage.indice)){lMessage.lu=true;}}}
function _passerMessageEnLu(aMessage){var lNombreLus=0,I,lMessage;if(!aMessage.lu){if(aMessage.estUneDiscussion){for(I=0;I<this.listeMessagerie.GetNbrElements();I++){lMessage=this.listeMessagerie.GetElement(I);if(!aMessage.lu&&aMessage.indice===lMessage.indicePere){lNombreLus+=_passerMessageEnLu.bind(this)(lMessage);}}}
else{lNombreLus+=1;}}
aMessage.lu=true;return lNombreLus;}
function _evenementSurFenetreMessage(aNumeroBouton,aParam){if(aNumeroBouton===1){var lParametres={objet:aParam.objet,contenu:aParam.contenu,listeDestinataires:aParam.destinataires,PJ:aParam.PJ,listeFichiers:aParam.ListeFichiers};this._requeteSaisieMessage(lParametres);}}
function _donneesFenetreEditionDiscussion(){return{genresRessources:[{genre:EGenreRessource.Eleve,getDisabled:function(){return!GApplication.droits.get(IEEnum.droits.communication.avecDiscussionEleves);}},{genre:EGenreRessource.Responsable,getDisabled:function(){return!GApplication.droits.get(IEEnum.droits.communication.avecDiscussionParents);}},{genre:EGenreRessource.Enseignant},{genre:EGenreRessource.Personnel}
]};}
function _sauvegarderCreationBrouillonParFenetre(aParamFenetre,aInstanceFenetre,aListeMessagesTransfert){if(_avecSauvegardeBrouillonAutorise.call(this)&&((aParamFenetre.destinataires&&aParamFenetre.destinataires.GetNbrElements()>0)||aParamFenetre.contenu||(!aListeMessagesTransfert&&aParamFenetre.objet)||(aParamFenetre.ListeFichiers&&aParamFenetre.ListeFichiers.GetNbrElements()>0))){var lInstance=this;GApplication.getMessage().afficher({type:EGenreBoiteMessage.Confirmation,message:GTraductions.getValeur('Messagerie.ConfirmationEnregistrerBrouillon'),callback:function(aAccepte){if(aAccepte===EGenreAction.Valider){lInstance._requeteSaisieMessage({pourBrouillon:true,brouillon:null,messagePourReponse:null,objet:aParamFenetre.objet,contenu:aParamFenetre.contenu,listeDestinataires:aParamFenetre.destinataires,listeMessagesTransfert:aListeMessagesTransfert,PJ:aParamFenetre.PJ,listeFichiers:aParamFenetre.ListeFichiers,apresEnvoieRequete:function(){aInstanceFenetre.Fermer();}});}
else aInstanceFenetre.Fermer();}});}
else aInstanceFenetre.Fermer();}
function _evenementFenetreEditionDiscussion(){var lFenetre=ObjetFenetre.creerInstance(window.ObjetFenetre_Message,{pere:this,evenement:function(aNumeroBouton,aParam){GHtml.setDisplay(lFenetre.GetNom(),false);if(aNumeroBouton===1){var lParametres={objet:aParam.objet,contenu:aParam.contenu,listeDestinataires:aParam.destinataires,PJ:aParam.PJ,listeFichiers:aParam.ListeFichiers,apresEnvoieRequete:function(){lFenetre.Fermer();}};this._requeteSaisieMessage(lParametres);}
else{_sauvegarderCreationBrouillonParFenetre.call(this,aParam,lFenetre);}}},{avecChoixDestinataires:true,nePasFermerSurValidation:true});lFenetre.SetDonnees(_donneesFenetreEditionDiscussion.call(this));}
InterfaceListeMessagerie.prototype._evenementSurListe=function(aGenreEvenementListe,aColonne,aLigne){switch(aGenreEvenementListe){case EGenreEvenementListe.Creation:if(GApplication.droits.get(IEEnum.droits.communication.avecDiscussionAvancee))
_evenementFenetreEditionDiscussion.bind(this)();else GInterface.EvenementSurCommunication(true);return EGenreEvenementListe.Creation;case EGenreEvenementListe.Selection:this.message=this.listeMessagerie.GetElement(aLigne);if(!this._conserverMessageVisuSelectionne)
this._messageVisuSelectionne=null;var lMarquerCommeLu=true;if(GNavigateur.estSourisBoutonDroit()&&TUtilitaireMessagerie.estEgal(GEtatUtilisateur.message,this.message)){this.listeDonneesMessagerie.initialisationObjetContextuel(aLigne,this.message,this.listeDonneesMessagerie.objetMenuContextuel);break;}
if(!this.param||!this.param.conserverBrouillon){_sauvegardeBrouillonAvecConfirmation(this);this._initBrouillon();_actualiserContenuSaisie.call(this);_actualiserSelecteurPJ.call(this);}
GHtml.setDisplay(this.idReponse+'_vide',false);GHtml.setDisplay(this.idReponse+'_pere',true);var lNombreLues=0;if(!GApplication.droits.get(IEEnum.droits.estEnConsultation)){if(!TUtilitaireMessagerie.estEgal(GEtatUtilisateur.message,this.message)){lNombreLues=_passerMessageEnLu.bind(this)(this.message);if(lNombreLues>0){_mettreAJourLuPereSelonFils.bind(this)();}}
this.GetInstance(this.identListe).Actualiser(true,false);}
GEtatUtilisateur.message=this.message;if(!this._options.enFenetre)
GHtml.setHtml(this.idBandeauDroite+'_Texte',TUtilitaireMessagerie.getLibelleBandeau(this.message,this.listeMessagerie));if(lNombreLues>0){IE.Invocateur.evenement('modifier_notification_communication',EGenreOnglet.Messagerie,-lNombreLues);}
new ObjetRequeteListeMessages(this,this._reponseListeMessages.bind(this)).lancerRequete({message:this.message,marquerCommeLu:lMarquerCommeLu});break;default:break;}};function _avecBrouillonASauvegarder(){return _avecSauvegardeBrouillonAutorise.call(this)&&this.brouillon&&this.brouillon.Etat!==EGenreEtat.Aucun&&this.messagePourReponse;}
function _saisieBrouillon(aBrouillon,aMessagePourReponse,aCallback){this._requeteSaisieMessage({pourBrouillon:true,brouillon:aBrouillon,messagePourReponse:aMessagePourReponse,objet:aBrouillon.objet,contenu:aBrouillon.contenu,listeDestinataires:aBrouillon.listeDestinataires,PJ:aBrouillon.PJ},aCallback);}
InterfaceListeMessagerie.prototype.getSaisiePageEnCours=function(){if(_avecBrouillonASauvegarder.call(this)){var lBrouillon=IE.MethodesObjet.dupliquer(this.brouillon),lMessagePourReponse=IE.MethodesObjet.dupliquer(this.messagePourReponse),lInstance=this;return{titre:'',message:GTraductions.getValeur('Messagerie.ConfirmationEnregistrerBrouillon'),callback:function(){_saisieBrouillon.call(lInstance,lBrouillon,lMessagePourReponse,lInstance.ActionSurValidation);}};}
return null;};function _avecSauvegardeBrouillonAutorise(){return this._options.activerSauvegardeAutoBrouillon&&!this._options.estChat&&!GApplication.droits.get(IEEnum.droits.estEnConsultation)&&GApplication.droits.get(IEEnum.droits.communication.avecDiscussionAvancee);}
function _sauvegardeBrouillonAvecConfirmation(aInstance){if(_avecBrouillonASauvegarder.call(aInstance)){var lBrouillon=IE.MethodesObjet.dupliquer(aInstance.brouillon),lMessagePourReponse=IE.MethodesObjet.dupliquer(aInstance.messagePourReponse);;aInstance._brouillonEnCoursSauvegarde=true;GApplication.getMessage().afficher({type:EGenreBoiteMessage.Confirmation,message:GTraductions.getValeur('Messagerie.ConfirmationEnregistrerBrouillon'),callback:function(aAccepte){delete aInstance._brouillonEnCoursSauvegarde ;if(aAccepte===EGenreAction.Valider){_saisieBrouillon.call(aInstance,lBrouillon,lMessagePourReponse,function(){});}
_actualiserSelecteurPJ.call(aInstance);}});return true;}
return false;}
function _actualiserContenuSaisie(){if(this.avecEditeurRiche){var lInstanceTiny=tinyMCE.getInstanceById(this.idReponse);if(lInstanceTiny&&lInstanceTiny.initialized)
lInstanceTiny.setContent(this.brouillon.contenu);} else{GHtml.setValue(this.idReponse,this.brouillon.contenu);}}
InterfaceListeMessagerie.prototype.evenementSurFenetreHTML=function(aNumeroBouton){var lContent='';if(!this.avecEditeurRiche){lContent=GHtml.getValue(this.idReponse+'_fenetre');} else{var lEditeur=tinyMCE.getInstanceById(this.idReponse+'_fenetre');lContent=lEditeur.getContent();lEditeur.hide();window.GTinyInit.detruireInstanceTiny(this.idReponse+'_fenetre');}
if(aNumeroBouton===1){this._setMessage(lContent);_actualiserContenuSaisie.call(this);}
this._gestionFocus_apresFenetreEditeur();};InterfaceListeMessagerie.prototype.evenementSurBoutonHTML=function(){var lHTML=[];if(!this.avecEditeurRiche){this.brouillon.contenu=GHtml.getValue(this.idReponse);lHTML.push('<textarea id="',this.idReponse,'_fenetre" class="Texte10" style="width:100%;height:100%" maxlength="0"></textarea>');this.GetInstance(this.identFenetreHTML).Afficher(lHTML.join(''));GHtml.setValue(this.idReponse+'_fenetre',this.brouillon.contenu||'');} else{lHTML.push('<div id="',this.idReponse,'_fenetre" class="Texte10" style="width: 100%;"></div>');this.GetInstance(this.identFenetreHTML).Afficher(lHTML.join(''));GHtml.setHtml(this.idReponse+'_fenetre',this.brouillon.contenu);var lInit=window.GTinyInit.getParametresInitParDefaut({id:this.idReponse+'_fenetre',pere:this,avecBoutonWord:false});lInit.height=330;lInit.min_height=298;lInit.max_height=600;tinyMCE.init(lInit);this._objGestionFocus_apresFenetreEditeur={id:this.idReponse};}};InterfaceListeMessagerie.prototype._evenementSurBoutonRepondre=function(aGenre){var lControleContenuNonVide=true;var lParametres={messagePourReponse:this.messagePourReponse,brouillon:this.brouillon,bouton:new ObjetElement('',0,aGenre),contenu:this.brouillon.contenu,PJ:this.brouillon.PJ,estChat:this._options.estChat};if(GApplication.droits.get(IEEnum.droits.communication.avecDiscussionAvancee)){if(this._options.estChat&&!this.message){this._creationChatAvecSaisieMessage=true;lParametres.objet=this.param.objet;lParametres.listeDestinataires=this.param.listeDestinataires;}
else if(this.brouillon&&!this.messagePourReponse.existeNumero()){lControleContenuNonVide=false;lParametres.objet=this.brouillon.objet;;lParametres.listeDestinataires=this.brouillon.listeDestinataires;if(!lParametres.listeDestinataires||lParametres.listeDestinataires.GetNbrElements()===0){GApplication.getMessage().afficher({type:EGenreBoiteMessage.Information,message:GTraductions.getValeur('Messagerie.MsgAucunDestinataire')});return;}}
else if(this.messagePourReponse&&this.messagePourReponse.listeDestinataires){lParametres.listeDestinataires=this.messagePourReponse.listeDestinataires;}}
if(lControleContenuNonVide&&!this.brouillon.contenu){GApplication.getMessage().afficher({type:EGenreBoiteMessage.Information,message:GTraductions.getValeur('Messagerie.MsgAucunContenu')});return;}
this._requeteSaisieMessage(lParametres);this._initBrouillon();};InterfaceListeMessagerie.prototype._evenementSurSaisieMessage=function(){if(this.message&&this.listeMessagerie){var lMessage=this.listeMessagerie.GetElement(TUtilitaireMessagerie.getIndiceDiscussion(this.listeMessagerie,this.message));if(lMessage&&!lMessage.estUneDiscussion&&IE.MethodesObjet.isNumber(lMessage.indicePere))
lMessage=this.listeMessagerie.GetElement(lMessage.indicePere);if(lMessage&&!this._options.estChat){GEtatUtilisateur.message=lMessage;}}
this.listeMessagerie=null;if(this.param&&this.param.listeMessagerie)
this.param.listeMessagerie=null;};function _creationDiscussion(){this.GetInstance(this.identBoutonEditeurHTML).setActif(true);for(var lGenre=0;lGenre<this.identBoutons.length;lGenre++){var lInstanceBouton=this.GetInstance(this.identBoutons[lGenre]);lInstanceBouton.SetVisible(lGenre===2?true:false);lInstanceBouton.SetLibelle(lGenre===2?this.param.listeDestinataires.GetNbrElements()===1?GChaine.Format(GTraductions.getValeur('Messagerie.EnvoyerA'),[this.param.listeDestinataires.GetLibelle(0)]):GTraductions.getValeur('Messagerie.EnvoyerATous'):'');lInstanceBouton.Genre=lGenre;}}
function _evenementSurDestinataire(aGenreRessource,aListeModifiee,aListeDestinataires){this.brouillon.listeDestinataires=aListeDestinataires;this.brouillon.SetEtat(EGenreEtat.Modification);this.$refreshSelf();}
function _construireBrouillonNonEnvoye(aBrouillon){var H=[];H.push('<div id="',this.GetNomInstance(this.identDestinataire),'"></div>');H.push('<div style="position:relative;',GStyle.composeHeight(18),'">');if(!aBrouillon.estMessageTransferant){H.push('<label style="position:absolute; top:2px;">',GTraductions.getValeur('Messagerie.ObjetMsg'),'</label>');H.push('<div style="margin-left:40px;">');H.push('<input ie-model="brouillon.inputObjet" maxlength="200" type="text" class="PetitEspace Fenetre_Bordure"',' style="',GStyle.composeHeight(18),'width:100%;"></input>');H.push('</div>');}
else H.push('<label style="position:absolute; top:2px;">',GTraductions.getValeur('Messagerie.ObjetMsg'),'&nbsp;&nbsp;',aBrouillon.objet,'</label>');H.push('</div>');GHtml.setHtml(this.idBrouillonNonEnvoye+'_td',H.join(''),{controleur:this.controleur});this.GetInstance(this.identDestinataire).Initialiser();var lListes={};aBrouillon.listeDestinataires.parcourir(function(D){if(!lListes[D.GetGenre()])
lListes[D.GetGenre()]=new ObjetListeElements();lListes[D.GetGenre()].AddElement(D);D.SetEtat(EGenreEtat.Modification);});for(var i in lListes)
if(lListes[i])
lListes[i].trier();this.GetInstance(this.identDestinataire).SetDonnees([{genre:EGenreRessource.Eleve,getDisabled:function(){return!GApplication.droits.get(IEEnum.droits.communication.avecDiscussionEleves);},listeDestinataires:lListes[EGenreRessource.Eleve]},{genre:EGenreRessource.Responsable,getDisabled:function(){return!GApplication.droits.get(IEEnum.droits.communication.avecDiscussionParents);},listeDestinataires:lListes[EGenreRessource.Responsable]},{genre:EGenreRessource.Enseignant,listeDestinataires:lListes[EGenreRessource.Enseignant]},{genre:EGenreRessource.Personnel,listeDestinataires:lListes[EGenreRessource.Personnel]}
]);}
function _construireVisuTransfert(aBrouillon){var H=[];var lListeMessages=new ObjetListeElements(),lMessage=new ObjetElement('',0);lListeMessages.AddElement(lMessage);lMessage.contenu='';lMessage.estMessageTransferant=true;lMessage.listeMessagesPourContexte=aBrouillon.listeMessagesPourContexte;lMessage.nbTransfert=aBrouillon.listeMessagesPourContexte.GetNbrElements();H.push('<div class="EspaceHaut">','<div id="',this.idVisuTransfert+'_scroll','" style="overflow-y: auto; max-height:200px; width:100%;">',TUtilitaireMessagerie.getDiscussion({listeMessages:lListeMessages,margesGauche:[0,'10px','75px','115px','50px'],margesDroite:['10px','10px','115px','75px','100px'],couleurBordure:GCouleur.bordure,couleurFond:GCouleur.themeNeutre.claire,couleurBrouillon:GCouleur.fond}),'</div>','</div>');GHtml.setHtml(this.idVisuTransfert+'_td',H.join(''),{controleur:this.controleur});$('#'+(this.idVisuTransfert+'_scroll').escapeJQ()).jScrollPane();}
InterfaceListeMessagerie.prototype._reponseListeMessages=function(aParam){if(this._options.callbackActualisation)
this._options.callbackActualisation();this.listeMessages=aParam.listeMessages;this.messagePourReponse=aParam.messagePourReponse;this.paramDestinataires=aParam.destinataires;if(this.message) this.GetInstance(this.identBoutonEditeurHTML).setActif(true);for(var lGenre=0;lGenre<this.identBoutons.length;lGenre++){var lInstanceBouton=this.GetInstance(this.identBoutons[lGenre]);var lBouton=aParam.listeBoutons.GetElementParGenre(lGenre);lInstanceBouton.SetVisible(lBouton?true:false);lInstanceBouton.SetLibelle(lBouton?lBouton.GetLibelle():'');lInstanceBouton.Genre=lGenre;}
if(aParam.listeBoutons.GetNbrElements()===0){GHtml.setDisplay(this.idReponse+'_pere',false);_afficherMessageVide.bind(this)(IE.MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Professeur,EGenreEspace.Etablissement])?GTraductions.getValeur('Messagerie.DestinatairesNonAutorises'):GTraductions.getValeur('Messagerie.NonAutorisePourDestinataires'));}
if(aParam.brouillon&&aParam.brouillon.estMessageTransferant){GHtml.setDisplay(this.idVisuTransfert,true);_construireVisuTransfert.call(this,aParam.brouillon);}
else{GHtml.setDisplay(this.idVisuTransfert,false);GHtml.setHtml(this.idVisuTransfert+'_td','');}
if(aParam.brouillon&&aParam.brouillon.listeDestinataires&&this.listeMessages&&this.listeMessages.GetNbrElements()===0){GHtml.setDisplay(this.idBrouillonNonEnvoye,true);_construireBrouillonNonEnvoye.call(this,aParam.brouillon);}
else{GHtml.setDisplay(this.idBrouillonNonEnvoye,false);GHtml.setHtml(this.idBrouillonNonEnvoye+'_td','');}
var lJqDiscu=$('#'+this.idDiscussion.escapeJQ());if(lJqDiscu&&lJqDiscu.data('jsp')){lJqDiscu.data('jsp').destroy();lJqDiscu=$('#'+this.idDiscussion.escapeJQ());}
this.surResizeInterface();lJqDiscu.IEHtml(TUtilitaireMessagerie.getDiscussion({listeMessages:this.listeMessages,margesGauche:['10px','50px','75px','115px','50px' ],margesDroite:['50px','20px','115px','75px','100px'],couleurBordure:this._options.enFenetre?GCouleur.bordure:GCouleur.themeCouleur.moyen1,couleurFond:this._options.enFenetre?GCouleur.themeNeutre.claire:GCouleur.themeCouleur.claire,couleurBrouillon:GCouleur.fond,ieEventMessage:!this._options.estChat?'click-contextmenu->visuMessage.event':null,ieStyleMessage:!this._options.estChat?'visuMessage.getStyle':null}),{controleur:this.controleur});if(this.avecFlecheInfo){lJqDiscu.find('fieldset[id$="'+this.messagePourReponse.GetNumero()+'"]').children('legend').prepend('<div class="Image_Messagerie_FlecheBlanche" style="position:absolute;top:-1px;left:-16px;"></div>');lJqDiscu.children('div').on('click',function(event){$(this).children('.tUtilitaireMessagerie_flecheHaut, .tUtilitaireMessagerie_flecheBas, .tUtilitaireMessagerie_flecheGauche').css('display','none');event.stopImmediatePropagation();});lJqDiscu.find('fieldset').on('click',{lThis:this},function(event){var lNumeroMessage=$(this).attr('id').match(/_([A-Z0-9]+)$/i)[1];var lMessage=event.data.lThis.listeMessages.GetElementParNumero(lNumeroMessage);if(lMessage&&lMessage.messageSource&&lMessage.messageSource.existeNumero()){var lNumeroMessageSource=lMessage.messageSource.GetNumero();var lJqMessageSource=$(this).siblings('[id$="'+lNumeroMessageSource+'"]');if(lJqMessageSource&&lJqMessageSource.length===1){var lWidthMessage=parseInt($(this).css('margin-left'));var lWidthSource=parseInt(lJqMessageSource.css('margin-left'));var lTopMessage=$(this).position().top+Math.floor($(this).outerHeight()/2)+Math.floor($(this).children('legend').position().top+($(this).children('legend').outerHeight()/2))-parseInt($(this).css('padding-top'));var lTopSource=lJqMessageSource.position().top+Math.floor(lJqMessageSource.outerHeight()/2)+Math.floor(lJqMessageSource.children('legend').position().top+(lJqMessageSource.children('legend').outerHeight()/2))-parseInt($(this).css('padding-top'));var lHeightFleche=lTopSource-lTopMessage;$(this).parent().children('.tUtilitaireMessagerie_flecheHaut').css({display:'block',width:lWidthMessage+'px',top:lTopMessage+'px'});$(this).parent().children('.tUtilitaireMessagerie_flecheBas').css({display:'block',width:lWidthSource+'px',top:lTopSource+'px'});$(this).parent().children('.tUtilitaireMessagerie_flecheGauche').css({display:'block',height:lHeightFleche+'px',top:lTopMessage+'px'});event.stopImmediatePropagation();}}});}
lJqDiscu.jScrollPane();if(aParam.brouillon){this._initBrouillon();this.brouillon=aParam.brouillon;_actualiserContenuSaisie.call(this);if(aParam.brouillon.listeDocumentsJoints){this.brouillon.listeFichiers=aParam.brouillon.listeDocumentsJoints;_actualiserSelecteurPJ.call(this);}
else this.brouillon.listeFichiers=new ObjetListeElements();}};function _actualiserSelecteurPJ(){if(!this._autorisePJ())
return;this.brouillon.listeFichiers.parcourir(function(D){D.Genre=EGenreDocumentJoint.Fichier;});this.brouillon.listeFichiers.getUrls=ObjetDeserialiser.getUrls;var lInstance=this.GetInstance(this.identSelecteurPJ);if(!this._brouillonEnCoursSauvegarde)
lInstance.destroyInputFile();lInstance.SetDonnees({listePJ:this.brouillon.listeFichiers,listeTotale:new ObjetListeElements(),idContextFocus:this.Nom});}
function _evntSelecteurPJ(aParam){this.brouillon.listeFichiers=new ObjetListeElements();this.brouillon.PJ=null;if(aParam.evnt===ObjetSelecteurPJ.genreEvnt.selectionPJ){this.brouillon.listeFichiers.AddElement(aParam.fichier);var lPJ=new ObjetElement();lPJ.Numero=ObjetElement.getNumeroCreation();lPJ.Libelle=aParam.fichier.Libelle;lPJ.fichier=aParam.fichier;lPJ.SetEtat(EGenreEtat.Creation);this.brouillon.PJ=lPJ;}
this.brouillon.SetEtat(EGenreEtat.Modification);this.brouillon.ignorerPJ=true;this.$refreshSelf();}
function _surPreResize(){GStyle.setVisible(this.idReponse+'_section',false);var lJqDiscu=$('#'+this.idDiscussion.escapeJQ());if(lJqDiscu&&lJqDiscu.data('jsp')) lJqDiscu.data('jsp').destroy();}
function _surPostResize(){GStyle.setVisible(this.idReponse+'_section',true);$('#'+this.idDiscussion.escapeJQ()).jScrollPane();}
InterfaceListeMessagerie.prototype.surResizeInterface=function(){$('#'+this.idDiscussion.escapeJQ()).height(0);this.inherited('surResizeInterface');GPosition.declencherResizeCommun([this.idSectionListe,this.idReponse+'_section'],[0,0]);if(this._options.avecListeDiscussions) GPosition.declencherResize(this.GetInstance(this.identListe).GetNom(),0);GPosition.declencherResize(this.idDiscussion,-6);};InterfaceListeMessagerie.prototype._gestionFocus_apresFenetreEditeur=function(){if(this._objGestionFocus_apresFenetreEditeur&&this._objGestionFocus_apresFenetreEditeur.id){window.tinymce.getInstanceById(this._objGestionFocus_apresFenetreEditeur.id).focus();this._objGestionFocus_apresFenetreEditeur=null;}};function _menuContextuelAjouterDestinataires(aLigne){var lGenreRessource=aLigne.GetNumero();switch(lGenreRessource){case EGenreRessource.Enseignant:case EGenreRessource.Personnel:var lNomListe=lGenreRessource===EGenreRessource.Enseignant?'listeProfesseurs':'listePersonnels';if(this.paramDestinataires[lNomListe].GetNbrElements()===0){GApplication.getMessage().afficher({message:lGenreRessource===EGenreRessource.Enseignant?GTraductions.getValeur('Messagerie.TousLesProfesseursDejaDestinataires'):GTraductions.getValeur('Messagerie.TousLesPersonnelsDejaDestinataires')});return;}
if(!this.messagePourReponse){;return;}
if(!this.messagePourReponse.listeDestinataires)
this.messagePourReponse.listeDestinataires=new ObjetListeElements();var lMessagePourReponse=this.messagePourReponse;var lFenetre=ObjetFenetre.creerInstance(window.ObjetFenetre_SelectionPublic,{pere:this,evenement:function(aGenreRessource,aListeRessourcesSelectionnees,aNumeroBouton){if(aNumeroBouton===1){lMessagePourReponse.listeDestinataires=lMessagePourReponse.listeDestinataires.getListeElements(function(D){return D.GetGenre()!==lGenreRessource;});aListeRessourcesSelectionnees.parcourir(function(D){var lElement=IE.MethodesObjet.dupliquer(D);lElement.Genre=lGenreRessource;lElement.SetEtat(EGenreEtat.Modification);lMessagePourReponse.listeDestinataires.AddElement(lElement);});}},initialiser:false});lFenetre.setOptions_Fenetre_SelectionRessource({avecCocheRessources:true});lFenetre.setSelectionObligatoire(false);lFenetre.setAffichageUtilisateurCourant(false);lFenetre.Initialiser();lFenetre.setDonnees({listeRessources:this.paramDestinataires[lNomListe],listeRessourcesSelectionnees:lMessagePourReponse.listeDestinataires.getListeElements(function(D){return D.GetGenre()===lGenreRessource;}),genreRessource:lGenreRessource,titre:EGenreRessource.getTitreFenetreSelectionRessource(lGenreRessource)});break;default:;}}
function _selectionVisuMessage(aIndice){this._messageVisuSelectionne=this.listeMessages.GetElement(aIndice);if(!this._messageVisuSelectionne||!this._messageVisuSelectionne.possessionMessage) return;var lMessage=new ObjetElement();lMessage.listePossessionsMessages=new ObjetListeElements();lMessage.listePossessionsMessages.AddElement(this._messageVisuSelectionne.possessionMessage);lMessage.estUneDiscussion=false;lMessage.pere=true;var lIndice=TUtilitaireMessagerie.getIndiceDiscussion(this.listeMessagerie,lMessage),lMessageListe=this.listeMessagerie.GetElement(lIndice),lListe=this.GetInstance(this.identListe);if(lMessageListe){if(this.message&&this.message.brouillon&&this.message.GetNumero()!==lMessageListe.GetNumero()){lListe.setListeElementsSelection(new ObjetListeElements());this._conserverMessageVisuSelectionne=true;try{lListe.SelectionnerLigne({ligne:lIndice,avecEvenement:true});} finally{delete this._conserverMessageVisuSelectionne;}
return null;}
var lMessagePere,lActualiser=false;if(!this.message||this.message.GetNumero()!==lMessageListe.GetNumero()){lMessagePere=lMessageListe;while(lMessagePere.pere){lMessagePere.pere.estDeploye=true;lMessagePere=lMessagePere.pere;lActualiser=true;}}
if(lActualiser)
this.GetInstance(this.identListe).Actualiser(true,true);var lListeSelection=new ObjetListeElements();if(lMessagePere&&lMessagePere!==lMessageListe)
lListeSelection.AddElement(lMessagePere);lListeSelection.AddElement(lMessageListe);lListe.setListeElementsSelection(lListeSelection,true);}
return lMessageListe;}
function _menuContextuelVisuMessage(aMessageListe){if(!this._messageVisuSelectionne) return;if(!aMessageListe) return;var lSelf=this;ObjetMenuContextuel.afficher({pere:this,evenement:function(aLigne){var lIndicePere,lIndiceMessage,lDiscussion,lListe=this.GetInstance(this.identListe);switch(aLigne.GetNumero()){case EGenreMenuVisuMessage.repondreMessage:lIndiceMessage=IE.MethodesTableau.chercher(aMessageListe,this.listeMessagerie.ListeElements);if(lIndiceMessage>=0){lListe.setListeElementsSelection(new ObjetListeElements());this._conserverMessageVisuSelectionne=true;try{lListe.SelectionnerLigne({ligne:lIndiceMessage,avecEvenement:true});} finally{delete this._conserverMessageVisuSelectionne;}}
break;case EGenreMenuVisuMessage.afficherDiscussion:lDiscussion=aMessageListe;while(lDiscussion.pere)
lDiscussion=lDiscussion.pere;lIndicePere=IE.MethodesTableau.chercher(lDiscussion,this.listeMessagerie.ListeElements);lIndiceMessage=IE.MethodesTableau.chercher(aMessageListe,this.listeMessagerie.ListeElements);;if(lIndicePere>=0){lListe.setListeElementsSelection(new ObjetListeElements());this._conserverMessageVisuSelectionne=true;try{lListe.SelectionnerLigne({ligne:lIndicePere,avecEvenement:true});} finally{delete this._conserverMessageVisuSelectionne;}
if(lIndiceMessage>=0)
lListe.SelectionnerLigne({ligne:lIndiceMessage});}
break;case EGenreMenuVisuMessage.supprimerBrouillon:_supprimerMessageCourant.call(this,aMessageListe);break;default:;}},initCommandes:function(aInstance){if(lSelf.message){if(aMessageListe.brouillon){if(aMessageListe.GetNumero()!==lSelf.message.GetNumero())
aInstance.AddCommande(EGenreMenuVisuMessage.repondreMessage,GTraductions.getValeur('Messagerie.MenuVisu_ReprendreBrouillon'));aInstance.AddCommande(EGenreMenuVisuMessage.supprimerBrouillon,GTraductions.getValeur('Messagerie.MenuVisu_SupprimerBrouillon'));}
else{if(aMessageListe.GetNumero()===lSelf.message.GetNumero())
aInstance.AddCommande(EGenreMenuVisuMessage.afficherDiscussion,GTraductions.getValeur('Messagerie.MenuVisu_AfficherDiscussion'));else aInstance.AddCommande(EGenreMenuVisuMessage.repondreMessage,GTraductions.getValeur('Messagerie.MenuVisu_Repondre'));}}}});}
function _getListeDestinatairesMessageCourant(){var lDestinataires=new ObjetListeElements();if(this.paramDestinataires){if(this.paramDestinataires.listeDestinataires)
lDestinataires.FusionnerListe(this.paramDestinataires.listeDestinataires);if(this.messagePourReponse.listeDestinataires)
lDestinataires.FusionnerListe(this.messagePourReponse.listeDestinataires);}
return lDestinataires;}
function _actualisationSurNotificationChat(aListeDiscussions){if(!aListeDiscussions) return;var lMessageActualisation=null,lSelf=this;aListeDiscussions.parcourir(function(aMessage){if(aMessage.listePossessionsMessages){if(!lSelf.message&&lSelf._creationChatAvecSaisieMessage&&aMessage.perso&&aMessage.listePossessionsMessages.GetNbrElements()===1){lMessageActualisation=aMessage;}
else if(lSelf.message&&lSelf.message.listePossessionsMessages){aMessage.listePossessionsMessages.parcourir(function(aPossessionMessage){if(lSelf.message.listePossessionsMessages.GetElementParElement(aPossessionMessage)){lMessageActualisation=aMessage;return false;}});}
if(lMessageActualisation){;lMessageActualisation.messageDejaTraite=true;return false;}}});if(lMessageActualisation){lMessageActualisation=IE.MethodesObjet.dupliquer(lMessageActualisation);var lListeMessages=new ObjetListeElements();lListeMessages.AddElement(lMessageActualisation);this._conserverBrouillonChat=this._conserverBrouillonChat!==false?true:false;this.SetDonnees({message:lMessageActualisation,listeMessagerie:lListeMessages,conserverBrouillon:this._conserverBrouillonChat});delete this._conserverBrouillonChat;}}}());;
function ObjetFenetre_Discussion(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);var lSelf=this;this._options={avecListeDiscussions:true,enFenetre:true,estDiscussionCommune:false,discussionSelectionneeUniquementVisible:false,callbackActualisation:function(){setTimeout(function(){lSelf.EnPremierPlan();},100);}};}
MethodesObjet.heritagePrototype(ObjetFenetre_Discussion,ObjetFenetre);(function(){ObjetFenetre_Discussion.prototype.setOptions=function(aOptions){$.extend(this._options,aOptions);};ObjetFenetre_Discussion.prototype.ConstruireInstances=function(){this.identMessagerie=this.Add(window.InterfaceListeMessagerie,null,_initMessagerie);IE.Invocateur.abonner(IE.Invocateur.events.actualisationAffichage,_surActualisationAffichage.bind(this));};function _surActualisationAffichage(aParametres){if(this.EnAffichage&&!this._options.estChat){aParametres.interruptionActualisation=true;this.SetDonnees(this.paramOriginel);}}
function _evntMessagerie(){}
function _initMessagerie(aInstance){aInstance.setOptions(this._options);aInstance.avecRecupereDonnees=false;}
ObjetFenetre_Discussion.prototype.SetDonnees=function(aParam){this.paramOriginel=aParam;this.param=MethodesObjet.dupliquer(aParam);if(this._options.estChat)
this.setTitre(this.param.objet);else if(this.param&&this.param.discussion){this.setTitre(this.param.discussion.objet);} else if(this.param&&this.param.ressource){this.setTitre(GTraductions.getValeur('Messagerie.DiscussionAvec',[this.param.ressource.GetLibelle()]));}
if(this._options.estChat&&!this.param.discussion){this.Afficher();this.GetInstance(this.identMessagerie).SetDonnees(this.param);return;}
if(this._options.avecListeDiscussions&&!this.param.discussion){var lDonnees={ressource:this.param.ressource,avecSelectionPremiereDiscussion:this.param.avecSelectionPremiereDiscussion};lDonnees.callBackApresDonneesMessagerie=this.callBackApresDonneesMessagerie.bind(this);this.Afficher();this.GetInstance(this.identMessagerie).SetDonnees(lDonnees);} else{this.Afficher();this.GetInstance(this.identMessagerie).SetDonnees({message:this.param.discussion,listeMessagerie:this.param.listeMessagerie});}};ObjetFenetre_Discussion.prototype.callBackApresDonneesMessagerie=function(aSansDiscussion){if(aSansDiscussion){this.Fermer();GApplication.getMessage().Afficher(EGenreBoiteMessage.Information,'',GTraductions.getValeur('Messagerie.AucuneDiscussionAvec',[this.param.ressource.GetLibelle()]));}};ObjetFenetre_Discussion.prototype.Fermer=function(aParam){var lInstance=this.GetInstance(this.identMessagerie);if(lInstance){IE.Invocateur.desabonner(lInstance);}
this.inherited('Fermer',aParam);};ObjetFenetre_Discussion.prototype.SurValidation=function(aGenreBouton){var lParam=aGenreBouton===0?this.paramOriginel:this.param;this.Fermer();this.callback.appel(aGenreBouton,lParam);};ObjetFenetre_Discussion.prototype.ComposeContenu=function(){var T=[];if(this.GetInstance(this.identMessagerie))
T.push('<div id="',this.GetNomInstance(this.identMessagerie),'" style="',GStyle.composeHeight(this.optionsFenetre.hauteur-56),'"></div>');return T.join('');};ObjetFenetre_Discussion.prototype.surFixerTaille=function(){this.inherited('surFixerTaille');this.GetInstance(this.identMessagerie).surResizeInterface();};}());;

MethodesObjet.heritagePrototype(ObjetFenetre_Message,ObjetFenetre);function ObjetFenetre_Message(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.SetTitre(GTraductions.getValeur('Messagerie.TitreFenetre'));this.setOptionsFenetre({largeur:600,hauteur:487});this.SetListeBoutons([GTraductions.getValeur('Annuler'),GTraductions.getValeur('Messagerie.BtnEnvoyer')]);this.C_largeurLabelChamps=50;this.idEntete=IE.GUID.getId();this.idInputObjetMsg=IE.GUID.getId();this.idContenuMsg=IE.GUID.getId();this.id_destinataires=IE.GUID.getId();this.idCBEleve=IE.GUID.getId();this.idCBResp1=IE.GUID.getId();this.idCBResp2=IE.GUID.getId();this.idDiscussion=IE.GUID.getId();}(function(){ObjetFenetre_Message.prototype.getControleur=function(){return{getObjetTexte:function(){return this.instance.message&&this.instance.message.objet?this.instance.message.objet||'':'';},inputObjet:{getValue:function(){return this.instance.message&&this.instance.message.objet?this.instance.message.objet||'':'';},setValue:function(aValue){if(this.instance.message)
this.instance.message.objet=aValue;}}};};ObjetFenetre_Message.prototype._autorisePJ=function(){return!MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Eleve,EGenreEspace.Parent]);};ObjetFenetre_Message.prototype._autoriseTiny=function(){return!MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Eleve,EGenreEspace.Parent]);};ObjetFenetre_Message.prototype.ConstruireInstances=function(){if(this._autorisePJ()){this.identSelecteurPJ=this.Add(window.ObjetSelecteurPJ,_evntSelecteurPJ.bind(this),_initSelecteurPJ.bind(this));}
if(this.optionsFenetre.avecChoixDestinataires)
this.identDestinataire=this.Add(window.ObjetDestinataires,null,null);};ObjetFenetre_Message.prototype._infosDest=function(aNb,aHint){return{nbDest:aNb,hintDest:aHint};};ObjetFenetre_Message.prototype._formatterDonneesPourAffichage=function(){if(!this.optionsFenetre.avecChoixDestinataires)
return this._formatterDonneesParGenreRessource();};ObjetFenetre_Message.prototype._formatterDonneesParGenreRessource=function(){var i,lNbr,lElt,lEltJ,j,lNbrJ;var lNb=0,lHint=[];switch(this.param.genreRessource){case EGenreRessource.Classe:case EGenreRessource.Groupe:;var lClasse=this.param.listeSelectionnee.GetElement(0);var lNbEquipe=0,lHintEquipe=[];if(lClasse.listeRessources){lClasse.listeRessources.setTri([ObjetTri.init('Position')]);lClasse.listeRessources.trier();for(j=0,lNbrJ=lClasse.listeRessources.GetNbrElements();j<lNbrJ;j++){lEltJ=lClasse.listeRessources.GetElement(j);if((GEtatUtilisateur.GenreEspace!==EGenreEspace.Professeur)||(lNbrJ===1)||(GEtatUtilisateur.getUtilisateur().GetNumero()!==lEltJ.GetNumero())){lNbEquipe++;lHintEquipe.push(lEltJ.GetLibelle());}}}
return{destinataires:this._infosDest(lNbEquipe,lHintEquipe.join('\n'))};case EGenreRessource.Eleve:var lNbResp1=0,lNbResp2=0,lHintResp1=[],lHintResp2=[];for(i=0,lNbr=this.param.listeSelectionnee.GetNbrElements();i<lNbr;i++){lElt=this.param.listeSelectionnee.GetElement(i);this.donneesDest.eleves.AddElement(lElt);lNb++;lHint.push(lElt.GetLibelle());if(lElt.listeRessources){for(j=0,lNbrJ=lElt.listeRessources.GetNbrElements();j<lNbrJ;j++){lEltJ=lElt.listeRessources.GetElement(j);if(lEltJ.existeNumero()){switch(j){case 0:if(!this.donneesDest.respLegal1.GetElementParNumero(lEltJ.GetNumero())){lNbResp1++;lHintResp1.push(lEltJ.GetLibelle());this.donneesDest.respLegal1.AddElement(lEltJ);}
break;case 1:if(!this.donneesDest.respLegal2.GetElementParNumero(lEltJ.GetNumero())){lNbResp2++;lHintResp2.push(lEltJ.GetLibelle());this.donneesDest.respLegal2.AddElement(lEltJ);}
break;}
if(!this.donneesDest.respLegaux.GetElementParNumero(lEltJ.GetNumero())){this.donneesDest.respLegaux.AddElement(lEltJ);}}}}}
return{eleves:this._infosDest(lNb,lHint.join('\n')),resp1:this._infosDest(lNbResp1,lHintResp1.join('\n')),resp2:this._infosDest(lNbResp2,lHintResp2.join('\n'))};case EGenreRessource.Responsable:case EGenreRessource.Enseignant:case EGenreRessource.Personnel:if(MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Eleve,EGenreEspace.Parent])){for(i=0,lNbr=this.param.listeSelectionnee.GetNbrElements();i<lNbr;i++){lElt=this.param.listeSelectionnee.GetElement(i);if(lElt.avecDiscussion){lNb++;lHint.push(lElt.GetLibelle());this.donneesDest.destinataires.AddElement(lElt);}}}
else{for(i=0,lNbr=this.param.listeSelectionnee.GetNbrElements();i<lNbr;i++){lElt=this.param.listeSelectionnee.GetElement(i);lNb++;lHint.push(lElt.GetLibelle());}}
return{destinataires:this._infosDest(lNb,lHint.join('\n'))};default:;break;}};ObjetFenetre_Message.prototype._setDestinataires=function(){if(!this.optionsFenetre.avecChoixDestinataires){this._setDestinatairesParGenreRessource();} else{var lInstanceDest=this.GetInstance(this.identDestinataire);;lInstanceDest.SetDonnees(this.param.genresRessources);}};ObjetFenetre_Message.prototype._setDestinatairesParGenreRessource=function(){function _getTraducGenreRessource(aGenreRessource){switch(aGenreRessource){case EGenreRessource.Classe:case EGenreRessource.Groupe:return GTraductions.getValeur('Messagerie.EquipePeda');case EGenreRessource.Responsable:return GTraductions.getValeur('Messagerie.Parents');case EGenreRessource.Enseignant:return GTraductions.getValeur('Messagerie.Profs');case EGenreRessource.Personnel:return GTraductions.getValeur('Messagerie.Personnels');default:return'';}}
var T=[];switch(this.param.genreRessource){case EGenreRessource.Eleve:var lAff;var lAvecEleves=GApplication.droits.get(IEEnum.droits.communication.avecDiscussionEleves);var lAvecParents=GApplication.droits.get(IEEnum.droits.communication.avecDiscussionParents);if(this.destinataires.eleves.nbDest>1){lAff=[{hint:lAvecEleves?this.destinataires.eleves.hintDest:GTraductions.getValeur('Messagerie.CommEleveInactif') ,nb:this.destinataires.eleves.nbDest ,id:this.idCBEleve ,label:GTraductions.getValeur('Messagerie.Eleves'),actif:lAvecEleves}];if(this.destinataires.resp1.nbDest>0)
lAff.push({hint:lAvecParents?this.destinataires.resp1.hintDest:GTraductions.getValeur('Messagerie.CommParentInactif') ,nb:this.destinataires.resp1.nbDest ,id:this.idCBResp1 ,label:GTraductions.getValeur('Messagerie.Resp1Legal'),actif:lAvecParents});if(this.destinataires.resp2.nbDest>0)
lAff.push({hint:lAvecParents?this.destinataires.resp2.hintDest:GTraductions.getValeur('Messagerie.CommParentInactif') ,nb:this.destinataires.resp2.nbDest ,id:this.idCBResp2 ,label:GTraductions.getValeur('Messagerie.Resp2Legal'),actif:lAvecParents});}
else{lAff=[{hint:lAvecEleves?'':GTraductions.getValeur('Messagerie.CommEleveInactif'),nb:null,id:this.idCBEleve ,label:this.destinataires.eleves.hintDest,actif:GApplication.droits.get(IEEnum.droits.communication.avecDiscussionEleves)}];if(this.destinataires.resp1.nbDest>0) lAff.push({hint:lAvecParents?'':GTraductions.getValeur('Messagerie.CommParentInactif'),nb:null,id:this.idCBResp1 ,label:this.destinataires.resp1.hintDest,actif:GApplication.droits.get(IEEnum.droits.communication.avecDiscussionParents)});if(this.destinataires.resp2.nbDest>0) lAff.push({hint:lAvecParents?'':GTraductions.getValeur('Messagerie.CommParentInactif'),nb:null,id:this.idCBResp2 ,label:this.destinataires.resp2.hintDest,actif:GApplication.droits.get(IEEnum.droits.communication.avecDiscussionParents)});}
for(var i=0,lNbr=lAff.length;i<lNbr;i++){var lElt=lAff[i];T.push('<div class="InlineBlock GrandEspaceDroit" title="',GChaine.toTitle(lElt.hint),'">');T.push('<input id="',lElt.id,'" type="checkbox" class="EspaceDroit" ',lElt.actif?'':' disabled ','></input>');T.push('<label for="',lElt.id,'" class="',lElt.actif?'':'Gris','">',lElt.label);if(lElt.nb)
T.push(' (',lElt.nb,')');T.push('</label>');T.push('</div>');}
break;case EGenreRessource.Responsable:case EGenreRessource.Enseignant:case EGenreRessource.Personnel:if(this.destinataires.destinataires.nbDest>1){T.push('<div title="',this.destinataires.destinataires.hintDest,'">',_getTraducGenreRessource(this.param.genreRessource),' (',this.destinataires.destinataires.nbDest,')','</div>');}
else T.push('<div>',this.destinataires.destinataires.hintDest,'</div>');break;case EGenreRessource.Classe:case EGenreRessource.Groupe:if(this.destinataires.destinataires.nbDest>1){T.push('<div title="',this.destinataires.destinataires.hintDest,'">',_getTraducGenreRessource(this.param.genreRessource),' (',this.destinataires.destinataires.nbDest,')','</div>');}
else T.push('<div>',_getTraducGenreRessource(this.param.genreRessource),' (',this.destinataires.destinataires.hintDest,')','</div>');break;default:;break;}
GHtml.setHtml(this.id_destinataires,T.join(''));};ObjetFenetre_Message.prototype._getListeDestinataires=function(){if(this.optionsFenetre.avecChoixDestinataires){return this.GetInstance(this.identDestinataire).getListeDestinataires();}
var lListe=new ObjetListeElements();switch(this.param.genreRessource){case EGenreRessource.Eleve:var lAvecEleves=$('#'+this.idCBEleve.escapeJQ()).is(':checked');var lAvecResp1=$('#'+this.idCBResp1.escapeJQ()).is(':checked');var lAvecResp2=$('#'+this.idCBResp2.escapeJQ()).is(':checked');if(lAvecEleves) lListe.FusionnerListe(this.donneesDest.eleves);if(lAvecResp1&&lAvecResp2){lListe.FusionnerListe(this.donneesDest.respLegaux);}
else{if(lAvecResp1) lListe.FusionnerListe(this.donneesDest.respLegal1);if(lAvecResp2) lListe.FusionnerListe(this.donneesDest.respLegal2);}
break;case EGenreRessource.Responsable:case EGenreRessource.Enseignant:case EGenreRessource.Personnel:if(MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Eleve,EGenreEspace.Parent])){lListe.FusionnerListe(this.donneesDest.destinataires);}
else lListe.FusionnerListe(this.param.listeSelectionnee);break;case EGenreRessource.Classe:case EGenreRessource.Groupe:lListe.FusionnerListe(this.param.listeSelectionnee.GetElement(0).listeRessources);break;default:;break;}
var i,lNbr;for(i=0,lNbr=lListe.GetNbrElements();i<lNbr;i++)
lListe.GetElement(i).SetEtat(EGenreEtat.Modification);return lListe;};ObjetFenetre_Message.prototype.SetDonnees=function(aParam){this.message={objet:'',destinataires:new ObjetListeElements(),ListeFichiers:new ObjetListeElements(),PJ:null,contenu:'',estMsgInitial:true};this.donneesDest={eleves:new ObjetListeElements(),respLegal1:new ObjetListeElements(),respLegal2:new ObjetListeElements(),respLegaux:new ObjetListeElements()};if(MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Eleve,EGenreEspace.Parent])){$.extend(this.donneesDest,{destinataires:new ObjetListeElements()});}
$('#'+this.idContenuMsg.escapeJQ()).val('');if(this._autoriseTiny())
_initTiny.bind(this)();this.param=aParam;this.destinataires=this._formatterDonneesPourAffichage();this.setOptionsFenetre({largeur:600,hauteur:(!this.optionsFenetre.transfertMessage?581:636)});this.Afficher();this._setDestinataires();if(!this.optionsFenetre.transfertMessage){var lLargeur=$('#'+this.Nom.escapeJQ()).width()-this.C_largeurLabelChamps-30;$('#'+this.idInputObjetMsg.escapeJQ()).width(lLargeur);}
var lHauteur=$('#'+this.IdContenu.escapeJQ()).height()-$('#'+this.idEntete.escapeJQ()).height()-10;$('#'+this.idContenuMsg.escapeJQ()).height(lHauteur);$('#'+this.Nom.escapeJQ()+' input[type="checkbox"]').jIECheckBox();if(!this._autoriseTiny())
$('#'+this.idContenuMsg.escapeJQ()).off('IEChange').on('IEChange',{aObjet:this},function(event){event.data.aObjet.message.contenu=GHtml.getValue(this);});if(this._autorisePJ()){var lListePJ=new ObjetListeElements();lListePJ.getUrls=ObjetDeserialiser.getUrls;this.GetInstance(this.identSelecteurPJ).SetDonnees({listePJ:lListePJ,listeTotale:new ObjetListeElements(),idContextFocus:this.Nom});}
if(this.optionsFenetre.transfertMessage&&this.param.transfert){this.message.objet=this.param.transfert.objet;$('#'+this.idDiscussion.escapeJQ()).show().IEHtml(TUtilitaireMessagerie.getDiscussion({listeMessages:this.param.transfert.listeMessages,margesGauche:[0,'10px','75px','115px','50px'],margesDroite:['10px','10px','115px','75px','100px'],couleurBordure:GCouleur.bordure,couleurFond:GCouleur.themeNeutre.claire,couleurBrouillon:GCouleur.fond}),{controleur:this.controleur}).jScrollPane();}};function _initSelecteurPJ(aInstance){aInstance.setOptions({genrePJ:EGenreDocumentJoint.Fichier,title:GTraductions.getValeur('Messagerie.HintPJ'),maxFiles:1,maxSize:GApplication.droits.get(IEEnum.droits.tailleMaxDocJointEtablissement)});}
function _initTiny(){if(GNavigateur.withContentEditable){var lInit=window.GTinyInit.getParametresInitParDefaut({id:this.idContenuMsg,avecBoutonWord:false});lInit.height=this.optionsFenetre.transfertMessage?200:330;lInit.min_height=this.optionsFenetre.transfertMessage?150:298;lInit.max_height=600;window.tinyMCE.init(lInit);}}
ObjetFenetre_Message.prototype.ComposeContenu=function(){var T=[];T.push(_composeZoneEnteteMsg.bind(this)());T.push(_composeZoneContenuMsg.bind(this)());if(this.optionsFenetre.transfertMessage)
T.push('<div class="EspaceHaut">','<div id="',this.idDiscussion,'" style="overflow-y: auto; max-height:200px; width:100%;"></div>','</div>');return T.join('');};function _composeChampDestinataires(){var T=[];if(!this.optionsFenetre.avecChoixDestinataires){T.push('<div class="EspaceBas">');T.push('<div class="InlineBlock Gras" style="width:',this.C_largeurLabelChamps,'px">',GTraductions.getValeur('Messagerie.DestinatairesMsg'),'</div>');T.push('<div id ="',this.id_destinataires,'" class="InlineBlock"></div>');T.push('</div>');}
else T.push('<div id="',this.GetNomInstance(this.identDestinataire),'"></div>');return T.join('');}
function _composeChampObjet(){var T=[];T.push('<div class="EspaceBas">');if(this.optionsFenetre.avecChoixDestinataires&&this.optionsFenetre.transfertMessage)
T.push('<div class="InlineBlock EspaceDroit">',GTraductions.getValeur('Messagerie.ObjetMsg'),'</div>');else T.push('<div class="InlineBlock" style="width:',this.C_largeurLabelChamps,'px">',GTraductions.getValeur('Messagerie.ObjetMsg'),'</div>');if(this.optionsFenetre.transfertMessage)
T.push('<div class="InlineBlock" ie-html="getObjetTexte"></div>');else T.push('<div class="InlineBlock"><input ie-model="inputObjet" id="',this.idInputObjetMsg,'" maxlength="200" type="text" class="InlineBlock PetitEspace Texte10 Fenetre_Bordure" style="',GStyle.composeHeight(18),GStyle.composeBordureArrondi(3),'"></input></div>');T.push('</div>');return T.join('');}
function _composeChampPJ(){var T=[];T.push('<div id="',this.GetNomInstance(this.identSelecteurPJ),'"></div>');return T.join('');}
function _composeZoneEnteteMsg(){var T=[];T.push('<div id="',this.idEntete,'" class="Texte10 EspaceHaut" style="width:100%">');T.push(_composeChampDestinataires.bind(this)());T.push(_composeChampObjet.bind(this)());if(this._autorisePJ()) T.push(_composeChampPJ.bind(this)());T.push('</div>');return T.join('');}
function _composeZoneContenuMsg(){return'<textarea id="'+this.idContenuMsg+'"'+(!this._autoriseTiny()?' maxlength="10000"':'')+' class="Texte10" style="width:100%; border:1px solid black"></textarea>';}
ObjetFenetre_Message.prototype.controlerSaisieMsg=function(){var lResult={estOk:true,destinatairesKo:false,contenuKo:false,content:''};if(this.optionsFenetre.avecChoixDestinataires){if(this.GetInstance(this.identDestinataire).getListeDestinataires().GetNbrElements()===0)
$.extend(lResult,{estOk:false,destinatairesKo:true});}
else{if(this.param.listeSelectionnee.GetNbrElements()<1){$.extend(lResult,{estOk:false,destinatairesKo:true});}
if(this.param.genreRessource===EGenreRessource.Eleve){var lAvecEleves=$('#'+this.idCBEleve.escapeJQ()).is(':checked');var lAvecResp1=$('#'+this.idCBResp1.escapeJQ()).is(':checked');var lAvecResp2=$('#'+this.idCBResp2.escapeJQ()).is(':checked');if(!lAvecEleves&&!lAvecResp1&&!lAvecResp2){$.extend(lResult,{estOk:false,destinatairesKo:true});}}}
if(this._autoriseTiny()){if(!GNavigateur.withContentEditable){lResult.content=GHtml.getValue(this.idContenuMsg);} else{var lEditeur=tinyMCE.getInstanceById(this.idContenuMsg);lResult.content=lEditeur?lEditeur.getContent():'';}
if(window.GTinyInit.estContenuVide(lResult.content)){lResult.content='';$.extend(lResult,{estOk:false,contenuKo:true});}}
else{if(this.message.contenu.trim()===''){$.extend(lResult,{estOk:false,contenuKo:true});}
else lResult.content=GHtml.getValue(this.idContenuMsg);}
return lResult;};function _detruireTiny(){if(this._autoriseTiny()){if(GNavigateur.withContentEditable){var lEditeur=tinyMCE.getInstanceById(this.idContenuMsg);if(lEditeur)lEditeur.hide();window.GTinyInit.detruireInstanceTiny(this.idContenuMsg);}}}
ObjetFenetre_Message.prototype.SurValidation=function(aNumeroBouton,aFermer){var lControle=this.controlerSaisieMsg();this.message.contenu=lControle.content;this.message.destinataires=this._getListeDestinataires();if(aNumeroBouton===1){if(lControle.estOk){_detruireTiny.call(this);if(!this.optionsFenetre.nePasFermerSurValidation&&aFermer!==false)
this.Fermer();this.callback.appel(aNumeroBouton,this.message,this,aFermer!==false);}
else{GApplication.getMessage().afficher({type:EGenreBoiteMessage.Information,message:lControle.destinatairesKo?GTraductions.getValeur('Messagerie.MsgAucunDestinataire'):(lControle.contenuKo?GTraductions.getValeur('Messagerie.MsgAucunContenu'):'')});}}
else{_detruireTiny.call(this);if(!this.optionsFenetre.nePasFermerSurValidation&&aFermer!==false)
this.Fermer();this.callback.appel(aNumeroBouton,this.message,this,aFermer!==false);}};function _evntSelecteurPJ(aParam){this.message.ListeFichiers=new ObjetListeElements();this.message.PJ=null;if(aParam.evnt===ObjetSelecteurPJ.genreEvnt.selectionPJ){this.message.ListeFichiers.AddElement(aParam.fichier);var lPJ=new ObjetElement();lPJ.Numero=ObjetElement.getNumeroCreation();lPJ.Libelle=aParam.fichier.Libelle;lPJ.fichier=aParam.fichier;lPJ.SetEtat(EGenreEtat.Creation);this.message.PJ=lPJ;}}})();;
MethodesObjet.heritagePrototype(DonneesListe_Communication,ObjetDonneesListe);function DonneesListe_Communication(aDonnees,aMasquerDonneesInutiles,aAfficherAvecDiscussion,aModeDiscussion){this.inheritedCreate(aDonnees);this.masquerDonneesInutiles=aMasquerDonneesInutiles;this.afficherAvecDiscussion=aAfficherAvecDiscussion;this.modeDiscussion=aModeDiscussion;}
DonneesListe_Communication.genreColonne={coche:0,nom:1,image:2,autre:3};DonneesListe_Communication.prototype.AvecEdition=function(I,D){return(I===DonneesListe_Communication.genreColonne.coche);};DonneesListe_Communication.prototype.AvecSelection=function(I,D){return false;};DonneesListe_Communication.prototype.AvecSuppression=function(I,D){return false;};DonneesListe_Communication.prototype.AvecEtatSaisie=function(D){return false;};DonneesListe_Communication.prototype.AvecEvenement_ApresEdition=function(I,D){return true;};DonneesListe_Communication.prototype.AvecEvenement_Selection=function(I,D){return true;};DonneesListe_Communication.prototype.SurEdition=function(I,D,V){if(I===DonneesListe_Communication.genreColonne.coche)
D.selection=V;};DonneesListe_Communication.prototype.GetNbrValeurs=function(I,D){switch(I){case DonneesListe_Communication.genreColonne.coche:case DonneesListe_Communication.genreColonne.nom:return 1;case DonneesListe_Communication.genreColonne.image:return 1;case DonneesListe_Communication.genreColonne.autre:return!D.listeRessources?!D.fonction?1:1:D.listeRessources.GetNbrElements();}};DonneesListe_Communication.prototype.GetValeur=function(I,D,K){switch(I){case DonneesListe_Communication.genreColonne.coche:return D.selection;case DonneesListe_Communication.genreColonne.nom:return D.GetLibelle()+(D.estPrincipal?' <b>('+GTraductions.getValeur('fenetreCommunication.profPrincipal')+')</b>':'');case DonneesListe_Communication.genreColonne.image:return(this.afficherAvecDiscussion&&D.avecDiscussion?'<div style="float:left;" class="Image_Destinataire_Message_Actif" title="'+GTraductions.getValeur('fenetreCommunication.colonne.discussionAutorisee')+'"></div>':'')+(D.avecEmail?'<div style="float:left;" class="Image_Destinataire_Email_Actif" title="'+GTraductions.getValeur('fenetreCommunication.colonne.emailAutorise')+'"></div>':'');case DonneesListe_Communication.genreColonne.autre:return!D.listeRessources?!D.fonction?'':D.fonction.GetLibelle():((D.listeRessources.GetElement(K)&&D.listeRessources.GetElement(K).estUneSousMatiere?'&nbsp;&nbsp;&nbsp;&nbsp;':'')+D.listeRessources.GetLibelle(K));}
return'';};DonneesListe_Communication.prototype.GetTypeValeur=function(I,D){switch(I){case DonneesListe_Communication.genreColonne.coche:return this.ETypeCellule.Coche;case DonneesListe_Communication.genreColonne.nom:return this.ETypeCellule.Texte;case DonneesListe_Communication.genreColonne.image:return this.ETypeCellule.Html;case DonneesListe_Communication.genreColonne.autre:return this.ETypeCellule.Texte;}};DonneesListe_Communication.prototype.GetCouleurCellule=function(I,D){return this.ECouleurCellule.Blanc;};DonneesListe_Communication.prototype.GetVisible=function(D){if(this.modeDiscussion&&this.masquerDonneesInutiles){return!!D.avecDiscussion;}
return!this.masquerDonneesInutiles||(D.avecDiscussion||D.avecEmail);};;
function ObjetRequeteSaisieCasier(aPere,aEvenementSurReussite,aEvenementSurEchec){this.inheritedCreate(aPere,aEvenementSurReussite,aEvenementSurEchec);}
IE.Requetes.inscrire('SaisieCasier',ObjetRequeteSaisieCasier,_ObjetRequeteXmlSaisiePN);ObjetRequeteSaisieCasier.genreSaisie={saisieCasier:0,marquerLectureDocument:1};(function(){ObjetRequeteSaisieCasier.prototype.lancerRequete=function(aParam){var lParam={genreSaisie:ObjetRequeteSaisieCasier.genreSaisie.saisieCasier};$.extend(lParam,aParam);this.JSON.genreSaisie=aParam.genreSaisie;switch(aParam.genreSaisie){case ObjetRequeteSaisieCasier.genreSaisie.saisieCasier:{if(lParam.listeLignes){lParam.listeLignes.setSerialisateurJSON({methodeSerialisation:_serialisation.bind(this)});this.JSON.listeLignes=lParam.listeLignes;}
this.appelAsynchroneSaisie();}
break;case ObjetRequeteSaisieCasier.genreSaisie.marquerLectureDocument:{this.JSON.documentLu=aParam.documentLu;this.appelAsynchroneSaisie();}
break;default:break;}};function _serialisation(aElement,aJSON){aJSON.memo=aElement.memo;if(aElement.listePersonnels) aJSON.listePersonnels=aElement.listePersonnels.toJSON();if(aElement.listeProfesseurs) aJSON.listeProfesseurs=aElement.listeProfesseurs.toJSON();if(aElement.listeMaitreStage) aJSON.listeMaitreStage=aElement.listeMaitreStage.toJSON();if(aElement.documentCasier){aJSON.documentCasier=aElement.documentCasier;aJSON.idFichier=GChaine.CardinalToStr(aElement.documentCasier.idFichier);}}
ObjetRequeteSaisieCasier.prototype.actionApresRequete=function(){this.callbackReussite.appel();};})();;
function ObjetRequeteListeRessourcesPourCommunication(aPere,aEvenementSurReussite,aEvenementSurEchec){this.inheritedCreate(aPere,aEvenementSurReussite,aEvenementSurEchec);}
IE.Requetes.inscrire('ListeRessourcesPourCommunication',ObjetRequeteListeRessourcesPourCommunication,_ObjetRequeteXmlConsultationPN);ObjetRequeteListeRessourcesPourCommunication.prototype.lancerRequete=function(aParametres){{var lParametres=$.extend({},aParametres);$.extend(this.JSON,lParametres);this.appelAsynchroneConsultation();}};ObjetRequeteListeRessourcesPourCommunication.prototype.actionApresRequete=function(){for(var I=0;this.JSONReponse.listeRessourcesPourCommunication&&(I<this.JSONReponse.listeRessourcesPourCommunication.GetNbrElements());I++){var lRessource=this.JSONReponse.listeRessourcesPourCommunication.GetElement(I);lRessource.avecEmail=lRessource.email?true:false;}
this.callbackReussite.appel(this.JSONReponse);};;

MethodesObjet.heritagePrototype(ObjetFenetre_Communication,ObjetFenetre);function ObjetFenetre_Communication(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.avecTailleSelonContenu=true;this.genreBoutons={email:0,demarrerDiscussion:1,discussionsCommunes:2,information:3,sondage:4,casier:5};this.ordreBoutons=[
this.genreBoutons.email,this.genreBoutons.demarrerDiscussion,this.genreBoutons.discussionsCommunes,this.genreBoutons.information,this.genreBoutons.sondage,this.genreBoutons.casier
];this.avecInformations=MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Professeur,EGenreEspace.Etablissement]);this.idDivEnvoyerEMail=IE.GUID.getId();this.idMail=IE.GUID.getId();this.idBoutons=IE.GUID.getId();this.idMessage=IE.GUID.getId();this.hauteurTabOnglets=19;this.PourMemeMatiere=false;this.PourMemeClasseEtGroupe=false;this.DateDeb=GParametres.PremiereDate;this.DateFin=GParametres.DerniereDate;this.membreSelectionne=null;this.listeSelectionnee=new ObjetListeElements();this.listeGenreRessources=new ObjetListeElements();if(this._existeBoutonVisible(EGenreRessource.Classe)&&
MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Professeur,EGenreEspace.Etablissement])&&
GEtatUtilisateur.getListeClasses(true,false,true).GetNbrElements())
this.listeGenreRessources.AddElement(new ObjetElement(GTraductions.getValeur('fenetreCommunication.onglet.equipePedagogique'),0,EGenreRessource.Classe));if(this._existeBoutonVisible(EGenreRessource.Eleve)&&
MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Professeur,EGenreEspace.Etablissement]))
this.listeGenreRessources.AddElement(new ObjetElement(GTraductions.getValeur('fenetreCommunication.onglet.eleve'),0,EGenreRessource.Eleve));if(this._existeBoutonVisible(EGenreRessource.Responsable)&&
MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Professeur,EGenreEspace.Etablissement]))
this.listeGenreRessources.AddElement(new ObjetElement(GTraductions.getValeur('fenetreCommunication.onglet.parent'),0,EGenreRessource.Responsable));if(this._existeBoutonVisible(EGenreRessource.Enseignant)&&
MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Professeur,EGenreEspace.Etablissement,EGenreEspace.Parent,EGenreEspace.Eleve]))
this.listeGenreRessources.AddElement(new ObjetElement(GTraductions.getValeur('fenetreCommunication.onglet.professeur'),0,EGenreRessource.Enseignant));if(this._existeBoutonVisible(EGenreRessource.Personnel)&&
MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Professeur,EGenreEspace.Etablissement,EGenreEspace.Parent,EGenreEspace.Eleve]))
this.listeGenreRessources.AddElement(new ObjetElement(GTraductions.getValeur('fenetreCommunication.onglet.personnel'),0,EGenreRessource.Personnel));}(function(){ObjetFenetre_Communication.prototype.ConstruireInstances=function(){this.identCombo=this.Add(window.ObjetSaisiePN,this.EvenementSurCombo,this.initialiserCombo.bind(this,null));this.identComboClasseGroupe=this.Add(window.ObjetSaisiePN,this.EvenementSurComboClasseGroupe,this.initialiserComboClasseGroupe);this.identComboMembres=this.Add(window.ObjetSaisiePN,this.EvenementSurComboMembre,this.initialiserCombo.bind(this,165));this.identTabs=this.Add(window.ObjetTabOnglets,this.evenementSurTab,this.initialiserTabs);this.identListe=this.Add(window.ObjetListe,this.evenementSurListe,this.initialiserListe);if(GApplication.droits.get(IEEnum.droits.communication.avecDiscussion))
this.idFenetreDiscussion=this.addFenetre(window.ObjetFenetre_Discussion,_evntFenetreDiscussion.bind(this),_initFenetreDiscussion.bind(this));this.identBoutons=[];for(var I=0;I<this.ordreBoutons.length;I++){var lGenreBouton=this.ordreBoutons[I];this.identBoutons[lGenreBouton]=this.Add(window.ObjetBouton,_evenementSurBtnEdition.bind(this,lGenreBouton),_initialiserBtnEdition.bind(this));}
if(this.avecInformations){this.identEditionActu=this.addFenetre(window.ObjetFenetre_EditionActualite ,_evenementEditionActu.bind(this),_initialiserEditionActu.bind(this));}
if(MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Professeur,EGenreEspace.Etablissement])){this.idInputFile=this.addFenetre(window.ObjetInputFile,_evenementInputFile.bind(this));}
if(MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Professeur,EGenreEspace.Etablissement,EGenreEspace.Eleve,EGenreEspace.Parent])){this.identFenetreDiscussion=this.Add(window.ObjetFenetre_Message,_evntFenetreDiscussion.bind(this));}};function _initFenetreDiscussion(aInstance){aInstance.setOptions({avecListeDiscussions:true,estDiscussionCommune:true});aInstance.SetParametres_Fenetre('',550+400,600,[GTraductions.getValeur('Fermer')],true);}
function _evenementSurBtnEdition(aGenre){this._objGestionFocus_apresFenetre={id:this.GetInstance(this.identBoutons[aGenre]).getPremierElement()};switch(aGenre){case this.genreBoutons.demarrerDiscussion:this.GetInstance(this.identFenetreDiscussion).SetDonnees({ListeRessources:this.ListeRessources,listeSelectionnee:this.listeSelectionnee,genreRessource:this.genre});break;case this.genreBoutons.discussionsCommunes:this.GetInstance(this.idFenetreDiscussion).SetDonnees({ressource:this.listeSelectionnee.GetElement(0),avecSelectionPremiereDiscussion:true});break;case this.genreBoutons.information:case this.genreBoutons.sondage:var lAvecChoixAnonyme=($.inArray(this.genre,[EGenreRessource.Enseignant,EGenreRessource.Responsable,EGenreRessource.Eleve,EGenreRessource.Personnel])===-1);var lGenres=[];lGenres.push(this.genre);if($.inArray(this.genre,[EGenreRessource.Classe,EGenreRessource.Groupe])===-1){if(this.genre!==EGenreRessource.Enseignant)
lGenres.push(EGenreRessource.Enseignant);if(this.genre!==EGenreRessource.Personnel)
lGenres.push(EGenreRessource.Personnel);}
this.GetInstance(this.identEditionActu).SetTitre(GTraductions.getValeur(aGenre===this.genreBoutons.information?'actualites.creerInfo':'actualites.creerSondage'));this.GetInstance(this.identEditionActu).SetDonnees({donnee:null,creation:true,genresPublic:lGenres,avecChoixAnonyme:lAvecChoixAnonyme,listePublic:this.listeSelectionnee,genreReponse:aGenre===this.genreBoutons.information?TypeGenreReponseInternetActualite.AvecAR:TypeGenreReponseInternetActualite.ChoixUnique});break;case this.genreBoutons.email:var lDestinataires='';for(var i=0;i<this.listeSelectionnee.GetNbrElements();i++){var lRessource=this.listeSelectionnee.GetElement(i);if(lRessource.email)
lDestinataires+=(lDestinataires?';':'')+lRessource.email;}
this.envoyerEMail(lDestinataires);break;default:;break;}}
function _evenementInputFile(aParam){this.ListeFichiers=new ObjetListeElements();this.ListeFichiers.AddElement(aParam.eltFichier);this.listeLignes=new ObjetListeElements();var lDocCasier=new ObjetElement();lDocCasier.Numero=ObjetElement.getNumeroCreation();lDocCasier.Libelle=aParam.eltFichier.Libelle;lDocCasier.documentCasier=aParam.eltFichier;lDocCasier.memo='';lDocCasier.listePersonnels=new ObjetListeElements();lDocCasier.listeProfesseurs=new ObjetListeElements();lDocCasier.listeMaitreStage=new ObjetListeElements();var i,lNbr,lElt,lCopie;var lListeDestinatairesCasier=new ObjetListeElements();for(i=0,lNbr=this.listeSelectionnee.GetNbrElements();i<lNbr;i++){lElt=this.listeSelectionnee.GetElement(i);lCopie=new ObjetElement(lElt.GetLibelle(),lElt.GetNumero(),lElt.GetGenre());lCopie.SetEtat(EGenreEtat.Creation);lListeDestinatairesCasier.AddElement(lCopie);}
switch(this.genre){case EGenreRessource.Enseignant:lDocCasier.listeProfesseurs=lListeDestinatairesCasier;break;case EGenreRessource.Personnel:lDocCasier.listePersonnels=lListeDestinatairesCasier;break;default:break;}
lDocCasier.SetEtat(EGenreEtat.Creation);this.listeLignes.AddElement(lDocCasier);new ObjetRequeteSaisieCasier(this,this.RecupererDonnees).addUpload({listeFichiers:this.ListeFichiers}).lancerRequete({genreSaisie:ObjetRequeteSaisieCasier.genreSaisie.saisieCasier,listeLignes:this.listeLignes});}
ObjetFenetre_Communication.prototype.actionSurSaisieMessage=function(aFermerFenetre){if(aFermerFenetre){IE.Invocateur.evenement('notification_creationDiscussion');this.Fermer();}};function _evenementEditionActu(aGenreBouton,aParam){if(aGenreBouton===1){this.Fermer();}}
ObjetFenetre_Communication.prototype._getLibelleBouton=function(aGenreBouton,aActif){switch(aGenreBouton){case this.genreBoutons.email:return GTraductions.getValeur('fenetreCommunication.bouton.email');case this.genreBoutons.demarrerDiscussion:return GTraductions.getValeur('fenetreCommunication.bouton.demarrerDiscussion');case this.genreBoutons.discussionsCommunes:return GTraductions.getValeur('fenetreCommunication.bouton.discussionsCommunes');case this.genreBoutons.information:return GTraductions.getValeur('fenetreCommunication.bouton.information');case this.genreBoutons.sondage:return GTraductions.getValeur('fenetreCommunication.bouton.sondage');case this.genreBoutons.casier:return GTraductions.getValeur('fenetreCommunication.bouton.casier');}};ObjetFenetre_Communication.prototype._getHintBouton=function(aGenreBouton,aActif){switch(aGenreBouton){case this.genreBoutons.email:return'';case this.genreBoutons.demarrerDiscussion:{if(aActif)
return'';else{switch(this.genre){case EGenreRessource.Eleve:return GTraductions.getValeur('Messagerie.CommParentEleveInactif');case EGenreRessource.Responsable:return GTraductions.getValeur('Messagerie.CommParentInactif');}
return'';}
break;}
case this.genreBoutons.discussionsCommunes:return'';case this.genreBoutons.information:return'';case this.genreBoutons.sondage:return'';case this.genreBoutons.casier:return'';}};ObjetFenetre_Communication.prototype._getClassBouton=function(aGenreBouton){switch(aGenreBouton){case this.genreBoutons.email:return'Image_Email';case this.genreBoutons.demarrerDiscussion:return'Image_Discussion';case this.genreBoutons.discussionsCommunes:return'Image_DiscussionCommune';case this.genreBoutons.information:return'Image_ActuInfo';case this.genreBoutons.sondage:return'Image_ActuQuestion';case this.genreBoutons.casier:return'Image_Casier';}};ObjetFenetre_Communication.prototype._getHauteurBouton=function(aGenreBouton){return 18;};ObjetFenetre_Communication.prototype._getIdBouton=function(aGenreBouton){return this.Nom+'_bouton_'+aGenreBouton;};ObjetFenetre_Communication.prototype._estBoutonVisible=function(aGenreRessource,aGenreBouton){if(this.modeDiscussion)
return aGenreBouton===this.genreBoutons.demarrerDiscussion;switch(aGenreBouton){case this.genreBoutons.email:switch(GEtatUtilisateur.GenreEspace){case EGenreEspace.Professeur:return MethodesTableau.existe(aGenreRessource,[EGenreRessource.Eleve,EGenreRessource.Responsable,EGenreRessource.Enseignant,EGenreRessource.Personnel,EGenreRessource.MaitreDeStage,EGenreRessource.Periode]);case EGenreEspace.Etablissement:return MethodesTableau.existe(aGenreRessource,[EGenreRessource.Eleve,EGenreRessource.Responsable,EGenreRessource.Enseignant,EGenreRessource.Personnel]);case EGenreEspace.Parent:return MethodesTableau.existe(aGenreRessource,[EGenreRessource.Enseignant,EGenreRessource.Personnel]);default:return false;}
break;case this.genreBoutons.demarrerDiscussion:return GApplication.droits.get(IEEnum.droits.communication.avecDiscussion)&&
MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Professeur,EGenreEspace.Etablissement,EGenreEspace.Eleve,EGenreEspace.Parent]);case this.genreBoutons.discussionsCommunes:return GApplication.droits.get(IEEnum.droits.communication.avecDiscussion)&&
MethodesTableau.existe(aGenreRessource,[EGenreRessource.Enseignant,EGenreRessource.Personnel,EGenreRessource.Eleve,EGenreRessource.Responsable]);case this.genreBoutons.information:return MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Professeur,EGenreEspace.Etablissement])&&
GApplication.droits.get(IEEnum.droits.actualite.avecSaisieActualite);case this.genreBoutons.sondage:return MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Professeur,EGenreEspace.Etablissement])&&
GApplication.droits.get(IEEnum.droits.actualite.avecSaisieActualite);case this.genreBoutons.casier:return MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Professeur,EGenreEspace.Etablissement])&&
MethodesTableau.existe(aGenreRessource,[EGenreRessource.Enseignant,EGenreRessource.Personnel,EGenreRessource.MaitreDeStage])&&
GApplication.droits.get(IEEnum.droits.casierNumerique.avecSaisieDocumentsCasiers);}};ObjetFenetre_Communication.prototype._existeBoutonVisible=function(aGenreRessource){for(var I=0;I<this.ordreBoutons.length;I++){var lGenreBouton=this.ordreBoutons[I];if(this._estBoutonVisible(aGenreRessource,lGenreBouton))
return true;}
return false;};ObjetFenetre_Communication.prototype._actualiserBoutonsCommunication=function(aActif){var lVisible,lActif,lLibelle,lHint,lHauteur,lGenreBouton;for(var I=0;I<this.ordreBoutons.length;I++){lGenreBouton=this.ordreBoutons[I];lVisible=this._estBoutonVisible(this.genre,lGenreBouton);lActif=aActif===undefined?this._estBoutonActif(lGenreBouton):aActif;lLibelle=this._getLibelleBouton(lGenreBouton,lActif);lHint=this._getHintBouton(lGenreBouton,lActif);lHauteur=this._getHauteurBouton(lGenreBouton,lActif);GHtml.setDisplay(this._getIdBouton(lGenreBouton),lVisible);this.GetInstance(this.identBoutons[lGenreBouton]).SetActif(lActif);this.GetInstance(this.identBoutons[lGenreBouton]).SetLibelle(lLibelle);this.GetInstance(this.identBoutons[lGenreBouton]).setHint(lHint);this.GetInstance(this.identBoutons[lGenreBouton]).setHeight(lHauteur);}
if(this.idInputFile){this.GetInstance(this.idInputFile).setDonnees({guid:this.Nom,idContextFocus:this.Nom,maxFiles:0,maxSize:GApplication.droits.get(IEEnum.droits.tailleMaxDocJointEtablissement),elements:lActif?
[{id:this.GetInstance(this.identBoutons[this.genreBoutons.casier]).IdBouton,redirect:['mouseover','mouseout']}
]:
[{id:this.GetNomInstance(this.identBoutons[this.genreBoutons.casier]),toRemove:true}
]});}};ObjetFenetre_Communication.prototype._estBoutonActif=function(aGenreBouton){switch(aGenreBouton){case this.genreBoutons.email:return this._estBoutonEmailActif();case this.genreBoutons.discussionsCommunes:return this._estBoutondiscussionsCommunesActif();case this.genreBoutons.demarrerDiscussion:return this._estBoutonDemarrerDiscussionActif();case this.genreBoutons.information:return this.listeSelectionnee.GetNbrElements()>0;case this.genreBoutons.sondage:return this.listeSelectionnee.GetNbrElements()>0;case this.genreBoutons.casier:return this.listeSelectionnee.GetNbrElements()>0;}
return false;};ObjetFenetre_Communication.prototype._estBoutonEmailActif=function(){if(this.listeSelectionnee)
for(var i=0;i<this.listeSelectionnee.GetNbrElements();i++){var lElement=this.listeSelectionnee.GetElement(i);if(lElement.avecEmail)
return true;}
return false;};ObjetFenetre_Communication.prototype._estBoutondiscussionsCommunesActif=function(){return(this.listeSelectionnee.GetNbrElements()===1);};ObjetFenetre_Communication.prototype._estBoutonDemarrerDiscussionActif=function(){if(this.listeSelectionnee.GetNbrElements()===0)
return false;switch(this.genre){case EGenreRessource.Classe:case EGenreRessource.Groupe:{return this.listeSelectionnee.GetNbrElements()===1;}
case EGenreRessource.Eleve:return GApplication.droits.get(IEEnum.droits.communication.avecDiscussionEleves)||GApplication.droits.get(IEEnum.droits.communication.avecDiscussionParents);case EGenreRessource.Responsable:return GApplication.droits.get(IEEnum.droits.communication.avecDiscussionParents);case EGenreRessource.Enseignant:case EGenreRessource.Personnel:{for(var i=0;i<this.listeSelectionnee.GetNbrElements();i++){var lElement=this.listeSelectionnee.GetElement(i);if(lElement.avecDiscussion)
return true;}
return false;}}};function _initialiserBtnEdition(aInstance){aInstance.setOptionsBouton({Libelles:[''],Actif:false,styleSite:false,Width:250,Height:null,TabImages:[],TabCurseurs:[],espaceNormal:true,DescriptionAccessible:'',labelWAI:''});}
function _initialiserEditionActu(aInstance){aInstance.SetParametres_Fenetre(GTraductions.getValeur('actualites.Edition.Creation'),700,700,new Array(GTraductions.getValeur('Annuler'),GTraductions.getValeur('Valider')));}
function _evntFenetreDiscussion(aNumeroBouton,aParam){if(aNumeroBouton===1){this.message=aParam;var lParametres={avecHtml:MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Professeur,EGenreEspace.Etablissement]),objet:this.message.objet,contenu:this.message.contenu,listeDestinataires:this.message.destinataires,PJ:this.message.PJ};if(lParametres.avecHtml&&!GNavigateur.withContentEditable){lParametres.contenu=GChaine.ToHTML(lParametres.contenu);}
new ObjetRequeteSaisieMessage(this,this.actionSurSaisieMessage.bind(this,aParam.estMsgInitial)).addUpload({listeFichiers:aParam.ListeFichiers}).lancerRequete(lParametres,false);}}
ObjetFenetre_Communication.prototype.initialiserListeClasse=function(){this.listeClasses=new ObjetListeElements();if(MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Professeur,EGenreEspace.Etablissement])){this.listeClasses=GEtatUtilisateur.getListeClasses(true,(this.genre!==EGenreRessource.Personnel)&&(GEtatUtilisateur.GenreEspace!==EGenreEspace.Etablissement),true);if(this.genre===EGenreRessource.Enseignant)
this.listeClasses.AddElement(new ObjetElement(GTraductions.getValeur('fenetreEnvoiEmail.combo_item_TousLesProfesseurs'),0,EGenreRessource.Enseignant));if(this.genre===EGenreRessource.Personnel)
this.listeClasses.AddElement(new ObjetElement(GTraductions.getValeur('fenetreEnvoiEmail.combo_item_TousLesPersonnels'),0,EGenreRessource.Personnel));if(this.listeClasses.GetElementParNumeroEtGenre(null,EGenreRessource.Classe))
this.listeClasses.AddElement(new ObjetElement(GTraductions.getValeur('fenetreEnvoiEmail.combo_item_classe'),0,EGenreRessource.Classe));if(this.listeClasses.GetElementParNumeroEtGenre(null,EGenreRessource.Groupe))
this.listeClasses.AddElement(new ObjetElement(GTraductions.getValeur('fenetreEnvoiEmail.combo_item_groupe'),0,EGenreRessource.Groupe));for(var I=0;I<this.listeClasses.GetNbrElements();I++){var LElement=this.listeClasses.GetElement(I);LElement.ClassAffichage=LElement.existeNumero()?'PetitEspaceGauche':'Gras';LElement.AvecSelection=LElement.existeNumero()||(LElement.GetGenre()===EGenreRessource.Enseignant)||(LElement.GetGenre()===EGenreRessource.Personnel);}
this.listeClasses.setTri([ObjetTri.init(function(D){return!((D.GetGenre()===EGenreRessource.Enseignant)||(D.GetGenre()===EGenreRessource.Personnel));}),ObjetTri.init('Genre'),ObjetTri.init(function(D){return D.existeNumero();}),ObjetTri.init('Libelle')
]);this.listeClasses.trier();}};ObjetFenetre_Communication.prototype.initialiserTabs=function(aInstance){aInstance.SetParametres(this.listeGenreRessources,false,this.optionsFenetre.largeur-10,this.hauteurTabOnglets,120);};ObjetFenetre_Communication.prototype.initialiserCombo=function(aLargeur ,aInstance){aInstance.SetParametres(null,null,aLargeur,false);aInstance.setOptions_ObjetSaisie({labelWAIZone:GTraductions.getValeur('AbsenceVS.comboRessource'),roleWAIEdit:EGenreRole.Option,avecTextOverflowEllipsis:true});};ObjetFenetre_Communication.prototype.initialiserComboClasseGroupe=function(aInstance){aInstance.SetParametres(null,null,null,false);aInstance.setOptions_ObjetSaisie({labelWAIZone:GTraductions.getValeur('AbsenceVS.comboRessource'),roleWAIEdit:EGenreRole.Option});};ObjetFenetre_Communication.prototype.getColonneAutre=function(){switch(this.genre){case EGenreRessource.Enseignant:return GTraductions.getValeur('fenetreCommunication.colonne.matiere');case EGenreRessource.Responsable:return GTraductions.getValeur('fenetreCommunication.colonne.eleve');case EGenreRessource.Personnel:return GTraductions.getValeur('fenetreCommunication.colonne.fonction');default:return'';}};ObjetFenetre_Communication.prototype.avecCombo=function(){if(!this.listeClasses||this.listeClasses.GetNbrElements()===0)
return false;if(MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Professeur,EGenreEspace.Etablissement]))
return MethodesTableau.existe(this.genre,[EGenreRessource.Enseignant,EGenreRessource.Responsable,EGenreRessource.Eleve,EGenreRessource.Personnel]);return false;};ObjetFenetre_Communication.prototype.avecComboClasseGroupe=function(){return MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Professeur])&&MethodesTableau.existe(this.genre,[EGenreRessource.Classe,EGenreRessource.Groupe]);};ObjetFenetre_Communication.prototype.avecComboMembres=function(){return GEtatUtilisateur.Identification.ListeRessources.GetNbrElements()>1&&MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Parent])&&MethodesTableau.existe(this.genre,[EGenreRessource.Enseignant,EGenreRessource.Personnel]);};ObjetFenetre_Communication.prototype.avecMail=function(){return!this.modeDiscussion&&MethodesTableau.existe(this.genre,[EGenreRessource.Personnel]);};function _afficherAvecDiscussionDansTitre(){return GApplication.droits.get(IEEnum.droits.communication.avecDiscussion)&&MethodesTableau.existe(this.genre,[EGenreRessource.Enseignant,EGenreRessource.Personnel])&&MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Parent,EGenreEspace.Eleve]);}
function _afficherAvecEmailDansTitre(){return GEtatUtilisateur.GenreEspace!==EGenreEspace.Eleve;}
function _getListeTitreDeListe(){var lTitreImage='{'+(_afficherAvecDiscussionDansTitre.bind(this)()?'<div style="float:left;" class="Image_Destinataire_Message_Actif" title="'+GTraductions.getValeur('fenetreCommunication.colonne.discussionAutorisee')+'"></div>':'')+(_afficherAvecEmailDansTitre.bind(this)()?'<div style="float:left;" class="Image_Destinataire_Email_Actif" title="'+GTraductions.getValeur('fenetreCommunication.colonne.emailAutorise')+'"></div>':'')+'}';return[{estCoche:true},this.avecCombo()||this.avecComboClasseGroupe()||this.avecComboMembres()?'':(this.genre===EGenreRessource.Classe?GTraductions.getValeur('fenetreCommunication.colonne.classe'):GTraductions.getValeur('fenetreCommunication.colonne.nom')),lTitreImage,this.getColonneAutre()];}
ObjetFenetre_Communication.prototype.initialiserListe=function(aInstance,aActualiser){var lAfficherAvecDiscussion=_afficherAvecDiscussionDansTitre.bind(this)();var lAfficherAvecEmail=_afficherAvecEmailDansTitre.bind(this)();var lLargeurImage=lAfficherAvecDiscussion&&lAfficherAvecEmail?40:20;var lColonnesCachees=[],lColonnesSansBordureDroit=[false,true,false,false];if(MethodesTableau.existe(this.genre,[EGenreRessource.Classe,EGenreRessource.Groupe,EGenreRessource.Eleve]))
lColonnesCachees.push(DonneesListe_Communication.genreColonne.autre);if(this.modeDiscussion||MethodesTableau.existe(this.genre,[EGenreRessource.Classe,EGenreRessource.Groupe])||GEtatUtilisateur.GenreEspace===EGenreEspace.Eleve){lColonnesCachees.push(DonneesListe_Communication.genreColonne.image);lColonnesSansBordureDroit=[];}
aInstance.setOptionsListe({listeTailles:[20,'100%',lLargeurImage,170],listeTitres:_getListeTitreDeListe.bind(this)(),colonnesCachees:lColonnesCachees,colonnesSansBordureDroit:lColonnesSansBordureDroit},aActualiser);};function _getHeight(aHauteur){if(GNavigateur.isTactile){return'height: 100%; min-height: '+aHauteur+'px; ';} else{return'height: '+aHauteur+'px; ';}}
ObjetFenetre_Communication.prototype.ComposeContenu=function(){var T=[];var lHauteur=this.optionsFenetre.hauteur-this.hauteurTabOnglets-30-25;T.push('<div class="EspaceBas Gras" id="'+this.GetNomInstance(this.identCombo)+'" style="z-index: 1000; position: absolute; top: 57px; left: 40px;"></div>');T.push('<div class="EspaceBas Gras" id="'+this.GetNomInstance(this.identComboClasseGroupe)+'" style="z-index: 1000; position: absolute; top: 57px; left: 40px;"></div>');T.push('<div class="EspaceBas Gras" id="'+this.GetNomInstance(this.identComboMembres)+'" style="z-index: 1000; position: absolute; top: 57px; left: 40px;"></div>');T.push('<div style="height: ',this.hauteurTabOnglets,'px;" id="'+this.GetNomInstance(this.identTabs)+'"></div>');T.push('<div class="Espace ClassCommunicationBordure" style="',_getHeight(lHauteur),GStyle.composeCouleurBordure(GCouleur.fenetre.bordure,1),'">');T.push('<div id="'+this.idMessage+'" class="Texte10 AlignementMilieu GrandEspaceHaut" style="display:none">'+'</div>');T.push('<div id="'+this.GetNomInstance(this.identListe)+'" style="',(this.modeDiscussion?_getHeight(lHauteur-27):'float: left; width: 450px; '+_getHeight(lHauteur)),' margin-bottom: 5px; display: none;">');T.push('</div>');T.push('<div id="',this.idBoutons,'" style="',(this.modeDiscussion?'float:right;':''),'">');for(var I=0;I<this.ordreBoutons.length;I++){var lGenreBouton=this.ordreBoutons[I];T.push('<div id="'+this._getIdBouton(lGenreBouton)+'" class="NoWrap" style="',this.modeDiscussion?'':'margin-bottom:15px;','"><div style="width: 18px;" class="InlineBlock EspaceDroit '+this._getClassBouton(lGenreBouton)+'" style="padding-top : 1px;">&nbsp;</div><div class="InlineBlock WhiteSpaceNormal AlignementHaut" id="',this.GetNomInstance(this.identBoutons[lGenreBouton]),'"></div></div>');}
T.push('</div>');T.push('<div id="',this.idMail,'" style="display: none;">',this.composeEmailWebmasterSecretariat(),'</div>');T.push('</div>');T.push('<div id="',this.idDivEnvoyerEMail,'" class="wai_hidden"></div>');return T.join('');};ObjetFenetre_Communication.prototype.composeEmailWebmasterSecretariat=function(){var T=[];T.push('<table class="EspaceHaut Texte10" border="0" cellpadding="5" cellspacing="0">');if(GEtatUtilisateur.emailWebmaster)
T.push('<tr><td class="Gras">',GTraductions.getValeur('fenetreEnvoiEmail.titre_webmaster'),'</td><td class="Gras">&nbsp;:&nbsp;</td><td>',GChaine.composerEmail(GEtatUtilisateur.emailWebmaster),'</td></tr>');if(GEtatUtilisateur.emailSecretariat)
T.push('<tr><td class="Gras">',GTraductions.getValeur('fenetreEnvoiEmail.titre_secretariat'),'</td><td class="Gras">&nbsp;:&nbsp;</td><td>',GChaine.composerEmail(GEtatUtilisateur.emailSecretariat),'</td></tr>');T.push('</table>');return T.join('');};ObjetFenetre_Communication.prototype.evenementSurTab=function(aElement){if(aElement)
this.tabSelectionne=aElement;var lGenre=this.tabSelectionne?this.tabSelectionne.GetGenre():0;if(lGenre!==this.genre){this.genre=lGenre;this.listeSelectionnee=new ObjetListeElements();this._actualiserBoutonsCommunication(false);if(this.modeDiscussion&&IE.MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Professeur,EGenreEspace.Etablissement])&&((lGenre===EGenreRessource.Eleve&&!GApplication.droits.get(IEEnum.droits.communication.avecDiscussionEleves)&&!GApplication.droits.get(IEEnum.droits.communication.avecDiscussionParents))||(lGenre===EGenreRessource.Responsable&&!GApplication.droits.get(IEEnum.droits.communication.avecDiscussionParents)))){this.actionSurEvenementCombo({avecMessage:true});return;}
this.initialiserListeClasse();if(this.avecCombo()){var lIndiceClasse=this.listeClasses.GetIndiceParElement(GEtatUtilisateur.Navigation.GetRessource(EGenreRessource.Classe));this.GetInstance(this.identCombo).SetDonnees(this.listeClasses,lIndiceClasse===null||lIndiceClasse===undefined?0:lIndiceClasse);} else if(this.avecComboClasseGroupe()){var lListeClasseGroupe=new ObjetListeElements();lListeClasseGroupe.AddElement(new ObjetElement(GTraductions.getValeur('fenetreEnvoiEmail.combo_item_classe'),0,EGenreRessource.Classe));lListeClasseGroupe.AddElement(new ObjetElement(GTraductions.getValeur('fenetreEnvoiEmail.combo_item_groupe'),0,EGenreRessource.Groupe));this.GetInstance(this.identComboClasseGroupe).SetDonnees(lListeClasseGroupe,0);}
else if(this.avecComboMembres()){var lListeMembres=new ObjetListeElements();GEtatUtilisateur.Identification.ListeRessources.parcourir(function(D){lListeMembres.AddElement(new ObjetElement(D.libelleLong,D.GetNumero(),EGenreRessource.Eleve));});var lIndice=GEtatUtilisateur.Identification.ListeRessources.GetIndiceParElement(this.membreSelectionne||GEtatUtilisateur.getMembre());this.GetInstance(this.identComboMembres).SetDonnees(lListeMembres,lIndice);}
else{this.EvenementSurCombo(null,new ObjetElement('',0,EGenreRessource.Classe));}}};ObjetFenetre_Communication.prototype.EvenementSurCombo=function(aGenreEvenement,aElement,aEleve){if((aGenreEvenement===null||aGenreEvenement===undefined)||(aGenreEvenement===EGenreEvenementObjetSaisie.selection)){if(aElement&&aElement.existeNumero())
GEtatUtilisateur.Navigation.SetRessource(EGenreRessource.Classe,aElement);new ObjetRequeteListeRessourcesPourCommunication(this,this.actionSurEvenementCombo).lancerRequete({onglet:new ObjetElement('',-1,this.genre),classe:aElement,eleve:aEleve},false);}};ObjetFenetre_Communication.prototype.EvenementSurComboClasseGroupe=function(aGenreEvenement,aElement){if(aGenreEvenement===EGenreEvenementObjetSaisie.selection){if(aElement)
this.genre=aElement.GetGenre();this.EvenementSurCombo(null,new ObjetElement('',0,EGenreRessource.Classe));}};ObjetFenetre_Communication.prototype.EvenementSurComboMembre=function(aGenreEvenement,aElement){if(aGenreEvenement===EGenreEvenementObjetSaisie.selection){this.membreSelectionne=aElement;this.EvenementSurCombo(null,null,aElement);}};ObjetFenetre_Communication.prototype.evenementSurListe=function(aGenreEvenementListe,aColonne,aLigne,aSurClavier){if(aGenreEvenementListe===EGenreEvenementListe.Selection){switch(aColonne){case 2:if(GNavigateur.IsToucheSelection()){var lElement=this.ListeRessources.GetElement(aLigne);var lDestinataires='';if(lElement.email){lDestinataires+=lElement.email;this.envoyerEMail(lDestinataires);}}
break;default:break;}}
this._evenementSurListe();};ObjetFenetre_Communication.prototype._getListeSelectionnee=function(){var lGenre=this.genre;var lListeSelectionnee=this.ListeRessources.getListeElements(function(aElement){return aElement.selection&&aElement.Genre===lGenre;});return lListeSelectionnee;};ObjetFenetre_Communication.prototype._evenementSurListe=function(){this.listeSelectionnee=this._getListeSelectionnee();this._actualiserBoutonsCommunication();};ObjetFenetre_Communication.prototype._nbRessourcesCochees=function(){var lNombre=0;for(var i=0,lNb=this.ListeRessources.GetNbrElements();i<lNb;i++)
if(this.ListeRessources.GetElement(i).selection)
lNombre++;return lNombre;};ObjetFenetre_Communication.prototype._actualiserListe=function(){this.actionSurEvenementCombo({listeRessourcesPourCommunication:this.ListeRessources});};ObjetFenetre_Communication.prototype.actionSurEvenementCombo=function(aParam){GHtml.setDisplay(this.idMail,this.avecMail()&&!aParam.avecMessage);GHtml.setDisplay(this.GetNomInstance(this.identCombo),this.avecCombo()&&!aParam.avecMessage);GHtml.setDisplay(this.GetNomInstance(this.identComboClasseGroupe),this.avecComboClasseGroupe()&&!aParam.avecMessage);GHtml.setDisplay(this.GetNomInstance(this.identComboMembres),this.avecComboMembres()&&!aParam.avecMessage);this.ListeRessources=aParam.listeRessourcesPourCommunication;if(!this.ListeRessources)
this.ListeRessources=new ObjetListeElements();this.listeSelectionnee=this._getListeSelectionnee();this._actualiserBoutonsCommunication();if(!aParam.avecMessage&&(this.existeRessource()||(MethodesTableau.existe(this.genre,[EGenreRessource.Enseignant,EGenreRessource.Personnel])&&this.avecComboMembres()))){GHtml.setDisplay(this.idMessage,false);GHtml.setDisplay(this.GetNomInstance(this.identListe),true);GHtml.setDisplay(this.idBoutons,true);this.initialiserListe(this.GetInstance(this.identListe),false);this.GetInstance(this.identListe).setOptionsListe({listeTitres:_getListeTitreDeListe.bind(this)()}).SetDonnees(this.ObjetEmailListe=new DonneesListe_Communication(this.ListeRessources,MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Parent,EGenreEspace.Eleve]),MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Parent,EGenreEspace.Eleve])&&GApplication.droits.get(IEEnum.droits.communication.avecDiscussion),this.modeDiscussion));} else{GHtml.setDisplay(this.GetNomInstance(this.identListe),false);GHtml.setDisplay(this.idBoutons,false);GHtml.setDisplay(this.idMessage,true);GHtml.setHtml(this.idMessage,this.getMessageAucuneRessource());}
this.actualiserTaille();};ObjetFenetre_Communication.prototype.existeRessource=function(){if(!(MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Parent,EGenreEspace.Eleve])))
return true;else{for(var I=0;I<this.ListeRessources.GetNbrElements();I++){var lRessource=this.ListeRessources.GetElement(I);if(lRessource.avecDiscussion||lRessource.avecEmail)
return true;}
return false;}};ObjetFenetre_Communication.prototype.getMessageAucuneRessource=function(){switch(this.genre){case EGenreRessource.Enseignant:return GEtatUtilisateur.GenreEspace===EGenreEspace.Eleve?GTraductions.getValeur('Messagerie.AucunProfesseurPourEleve'):GTraductions.getValeur('Messagerie.AucunProfesseur');case EGenreRessource.Personnel:return GEtatUtilisateur.GenreEspace===EGenreEspace.Eleve?GTraductions.getValeur('Messagerie.AucunPersonnelPourEleve'):GTraductions.getValeur('Messagerie.AucunPersonnel');case EGenreRessource.Eleve:case EGenreRessource.Responsable:;return(this.genre===EGenreRessource.Eleve?GTraductions.getValeur('Messagerie.InactiveParentsEleves'):GTraductions.getValeur('Messagerie.InactiveParents'))+' ('+GTraductions.getValeur('Onglet.LibelleLong')[EGenreOnglet.InfosPerso]+')';}
return'';};ObjetFenetre_Communication.prototype.SurAfficher=function(){if(this.GetInstance(this.identTabs)){this.evenementSurTab(this.GetInstance(this.identTabs).getElementSectionne());}};ObjetFenetre_Communication.prototype.SurFermer=function(){if(this.avecCombo())
this.GetInstance(this.identCombo).Reset();if(this.avecComboClasseGroupe())
this.GetInstance(this.identComboClasseGroupe).Reset();if(this.avecComboMembres()){this.GetInstance(this.identComboMembres).Reset();}
if(this.GetInstance(this.identListe))
this.GetInstance(this.identListe).Reset();};ObjetFenetre_Communication.prototype.envoyerEMail=function(aDestinataires){$('#'+this.idDivEnvoyerEMail.escapeJQ()).html(GChaine.composerEmail(aDestinataires));$('#'+this.idDivEnvoyerEMail.escapeJQ()).find('a').get(0).click();};ObjetFenetre_Communication.prototype.actualiserTaille=function(){if(GNavigateur.isTactile){$('.ClassCommunicationBordure').css('min-height','1px');var lElement=GHtml.getElement(this.Nom+'_Res');var lHauteur=$(lElement).height()-this.hauteurTabOnglets-5;$('.ClassCommunicationBordure').css('min-height',lHauteur+'px');}};})();;
function ObjetRequeteSaisieURLKiosque(aPere,aEvenementSurReussite,aEvenementSurEchec){this.inheritedCreate(aPere,aEvenementSurReussite,aEvenementSurEchec);this._avecControleModeExclusif=false;}
IE.Requetes.inscrire('SaisieURLKiosque',ObjetRequeteSaisieURLKiosque,_ObjetRequeteXmlSaisiePN);(function(){ObjetRequeteSaisieURLKiosque.prototype.lancerRequete=function(aDonnees){this.JSON.SSO=aDonnees.SSO;this.appelAsynchroneSaisie({messageDetail:GTraductions.getValeur('requete.VeuillezPatienter')});};ObjetRequeteSaisieURLKiosque.prototype.actionApresRequete=function(aXml){this.callbackReussite.appel(this.JSONRapportSaisie.urlSSO);};})();;

MethodesObjet.heritagePrototype(ObjetFenetre_Kiosque,ObjetFenetre);function ObjetFenetre_Kiosque(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);IE.Invocateur.abonner('modification_Membre_FenetreKiosque',this._modificationMembre.bind(this),this);}(function(){ObjetFenetre_Kiosque.prototype.ConstruireInstances=function(){};ObjetFenetre_Kiosque.prototype.SetDonnees=function(){if(!this.existeCoordonnees()){this.coordonnees.left=5;this.coordonnees.top=80;}
new ObjetRequeteRessourcePedagogique(this,_reponseRequeteRessourcePedagogique.bind(this)).lancerRequete({avecRessourcesPronote:false,avecRessourcesEditeur:true});};function _reponseRequeteRessourcePedagogique(aListeMatieres,aListeRessources){this.listeMatieres=aListeMatieres;this.listeRessources=aListeRessources;this.Actualiser();this.Afficher();}
ObjetFenetre_Kiosque.prototype.initialiserTabs=function(aInstance){aInstance.SetParametres(this.listeOnglets,false,this.optionsFenetre.largeur-10,this.hauteurTabOnglets,150);};ObjetFenetre_Kiosque.prototype.ComposeContenu=function(){if(this.listeMatieres){this.listeMatieres.setTri([ObjetTri.init('existeNumero',EGenreTriElement.Decroissant)]);this.listeMatieres.trier();}
if(!this.listeMatieres||(this.listeMatieres.GetNbrElements()===0))
return GTraductions.getValeur('Commande.FenetreKiosque.Message');var H=[];for(var i=0;this.listeMatieres&&(i<this.listeMatieres.GetNbrElements());i++){var lMatiere=this.listeMatieres.GetElement(i);H.push(this.compose_Matiere(lMatiere));}
return'<table class="Texte10" style="width: 100%;" border="0" cellpadding="0" cellspacing="3">'+H.join(this.compose_Separateur())+'</table>';};ObjetFenetre_Kiosque.prototype.compose_Matiere=function(aMatiere){var H=[];var lExisteMatiere=[];for(var i=0;this.listeRessources&&(i<this.listeRessources.GetNbrElements());i++){var lRessource=this.listeRessources.GetElement(i);if((lRessource.GetGenre()===EGenreRessourcePedagogique.kiosque)&&lRessource.matiere&&(lRessource.matiere.GetNumero()===aMatiere.GetNumero())){H.push('<tr>');H.push('<td class="Gras">',!lExisteMatiere[aMatiere.GetNumero()]?aMatiere.GetLibelle():'','</td>');H.push('<td class="GrandEspaceGauche LienAccueil" style="margin-left: 5px;" onclick="',this.Nom,'._surRessourceKiosque (',i,')">'+lRessource.ressource.GetLibelle()+'</td>');H.push('</tr>');lExisteMatiere[aMatiere.GetNumero()]=true;}}
return H.join('');};ObjetFenetre_Kiosque.prototype.compose_Separateur=function(){var H=[];H.push('<tr>');H.push('<td colspan="2"> ','<div style="',GStyle.composeCouleurBordure(GCouleur.themeNeutre.moyen2,1,EGenreBordure.bas),'"></div>','</td>');H.push('</tr>');return H.join('');};ObjetFenetre_Kiosque.prototype._surRessourceKiosque=function(i){var lRessource=this.listeRessources.GetElement(i);new ObjetRequeteSaisieURLKiosque(this,this._actionaisieURLKiosque).lancerRequete(lRessource.ressource);};ObjetFenetre_Kiosque.prototype._actionaisieURLKiosque=function(aUrlSSO){window.open(aUrlSSO);};ObjetFenetre_Kiosque.prototype._modificationMembre=function(aMembre){this.SetDonnees();};})();;
var EGenreWidget={discussions:0,casier:1,appelNonFait:2,CDTNonSaisi:3,conseilDeClasse:4,menuDeLaCantine:5,vieScolaire:6,travailAFaire:7,agenda:8,actualites:9,notes:10,QCM:11,EDT:12,ressources:13,kiosque:14,ressourcePedagogique:15,DS:16,aide:17,competences:18,coursNonAssures:19,penseBete:20,DSEvaluation:21,RetourEspace:22};;
MethodesObjet.heritagePrototype(ObjetFiche,Identite);function ObjetFiche(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.EnAffichage=false;this.idContenu=this.Nom+'_Contenu';this.IdPremierElement=this.idContenu;this.idCorpsContenu=this.Nom+'_corpsContenu';this.idBandeau=this.Nom+'_Bandeau';this.idLibelleBandeau=this.Nom+'_LibelleBandeau';this.avecBandeau=true;this.avecDeplacementSurBandeau=true;this.avecDeplacementSurFiche=false;this.bloquerFocus=false;this.avecBoutonFermer=true;this.initialiserOptionsFiche();this.ajouterEvenementGlobal(EEvent.SurPreResize ,this.surPreResize);this.ajouterEvenementGlobal(EEvent.SurPostResize ,this.surPostResize);IE.Invocateur.abonner(IE.Invocateur.events.fermerFenetres,this.Fermer.bind(this,false),this);}
IE.ZoneFenetre.etendreEnFenetre(ObjetFiche,{zIndex:1100});ObjetFiche.prototype.initialiserOptionsFiche=function(){this._optionsFiche={avecAbonnementBlocage:true,avecAbonnementPremierPlan:true,repositionnementSurResize:true,couleurBandeau:GCouleur.fenetre.bandeau,largeurBoutonFermeture:18};};ObjetFiche.prototype.setOptions_Fiche=function(aOptions){$.extend(this._optionsFiche,aOptions);};ObjetFiche.prototype.getControleur=function(){return{eventBoutonFermer:function(event){switch(event.type){case'keyup':if(GNavigateur.IsToucheSelection())
this.instance.Fermer();break;case'click':this.instance.Fermer();break;}}};};ObjetFiche.prototype.DetruireInstances=function(){this.Fermer(false);};ObjetFiche.prototype.SetTraductions=function(ATraductions){this.Traductions=ATraductions;};ObjetFiche.prototype.Compose=function(){var H='';H+='<span class="wai_hidden" tabindex="0" onfocus="'+this.Nom+'.FocusSurPremierElement();"></span>';H+='<div tabindex="-1" id="'+this.idContenu+'" class="SansOutline"'+' onmousedown="'+this.Nom+'.EnPremierPlan ()"'+' style="'+GStyle.composeBoxShadow()+'"'+' onkeyup="if (GNavigateur.IsToucheEchap()) '+this.Nom+'.surToucheEchap()" '+GObjetWAI.composeRole(EGenreRole.Dialog)+'>';H+='<table class="Texte10 Fenetre_Cadre" style="'+GStyle.composeWidth(this.Largeur)+GStyle.composeHeight(this.Hauteur)+'" border="0" cellpadding="0" cellspacing="0">';if(this.avecBandeau)
H+='<tr><td id="'+this.idBandeau+'">'+this.ComposeBandeau(this.avecBoutonFermer)+'</td></tr>';H+='<tr><td id="'+this.idCorpsContenu+'" class="FondBlanc '+(this.avecDeplacementSurFiche?'AvecMove':'')+'" style="height:100%;'+'" valign="top">'+this.ComposeContenu()+'</td></tr>';H+='</table>';H+='</div>';H+='<span class="wai_hidden" tabindex="0"  onfocus="'+this.Nom+'.FocusSurPremierElement();"></span>';return H;};ObjetFiche.prototype.ComposeBandeau=function(AAvecBoutonFermer){var lHtml=[];this.avecBoutonFermer=AAvecBoutonFermer;this.LargeurTitre=this.Largeur-7-(AAvecBoutonFermer?this._optionsFiche.largeurBoutonFermeture:0);lHtml.push('<table style="',GStyle.composeCouleur(this._optionsFiche.couleurBandeau.fond,this._optionsFiche.couleurBandeau.texte),' width:100%;" border="0" cellpadding="0" cellspacing="0">','<tr><td>');lHtml.push('<div class="NoWrap">');lHtml.push('<div id="',this.idLibelleBandeau,'" class="InlineBlock AlignementHaut Espace Texte10 Gras ',this.avecDeplacementSurBandeau?'AvecMove':'','" style="'+GStyle.composeWidth(this.LargeurTitre)+'">',this.GetTitre(),'</div>');if(AAvecBoutonFermer){lHtml.push('<div class="InlineBlock AlignementHaut">');lHtml.push('<div class="PetitEspaceDroit AlignementDroit" style="padding-top: 2px;">');lHtml.push('<div class="AlignementHaut AvecMain Image_CroixFermetureMasque OmbreFocus" tabindex="0" width="1px" ie-event="keyup-click->eventBoutonFermer" ',GObjetWAI.composeRole(EGenreRole.Button),' ',GObjetWAI.composeAttribut({genre:EGenreAttribut.label,valeur:GTraductions.getValeur('WAI.FermerFiche')}),'>','</div>');lHtml.push('</div>');lHtml.push('</div>');}
lHtml.push('</div>');lHtml.push('</td></tr>',this.composeComplementBandeau?this.composeComplementBandeau():'','</table>');return lHtml.join('');};ObjetFiche.prototype.GetTitre=function(){;return'&nbsp;';};ObjetFiche.prototype.EnPremierPlan=function(){GNavigateur.EnPremierPlan(this.Nom);};ObjetFiche.prototype.actualiser=function(){this.Afficher(this.idCours);};ObjetFiche.prototype.Afficher=function(AIdCours,aLeft,aTop){this.afficherFiche({id:AIdCours,left:aLeft,top:aTop,positionSurSouris:true,positionSurSourisSiAffiche:false});};ObjetFiche.prototype.getOptionsDraggable=function(){var lHandle='';if(this.avecDeplacementSurBandeau){lHandle+='#'+this.idLibelleBandeau.escapeJQ();}
if(this.avecDeplacementSurFiche){if(lHandle.length>0){lHandle+=',';}
lHandle+='#'+this.idCorpsContenu.escapeJQ();}
return{handle:lHandle};};ObjetFiche.prototype.afficherFiche=function(aParametres){var lParametres={left:null,top:null,id:null,positionSurSouris:false,positionSurSourisSiAffiche:false};$.extend(lParametres,aParametres);this.idCours=lParametres.id;;GHtml.setDisplay(this.Nom,true);GStyle.setVisible(this.Nom,false);if(this._optionsFiche.avecAbonnementBlocage)
GNavigateur.abonnementBlocageInterface(this.Nom);if(this._optionsFiche.avecAbonnementPremierPlan)
GNavigateur.abonnementPremierPlan(this.Nom);GNavigateur.bloquerResize=true;try{GHtml.setHtml(this.Nom,this.Compose(),{controleur:this.controleur});if(this.surPreAffichage)
this.surPreAffichage();if(this.idScroll){var lJqScroll=$('#'+this.idScroll.escapeJQ());if(lJqScroll.data('jsp')) lJqScroll.data('jsp').destroy();lJqScroll=$('#'+this.idScroll.escapeJQ());if(lJqScroll.length===1) lJqScroll.jScrollPane({showArrows:true});}
if(((lParametres.left!==null&&lParametres.left!==undefined))&&((lParametres.top!==null&&lParametres.top!==undefined)))
GPosition.placer(this.Nom,lParametres.left,lParametres.top);else if((lParametres.id!==null&&lParametres.id!==undefined))
GPosition.placerFiche(this.Nom,lParametres.id,this.EnAffichage);else if(lParametres.positionSurSouris){if(!this.EnAffichage||lParametres.positionSurSourisSiAffiche){GPosition.placer(this.Nom,GNavigateur.SourisX,GNavigateur.SourisY);}}}
finally{GNavigateur.bloquerResize=false;}
GStyle.setVisible(this.Nom,true);if(!this.bloquerFocus)
GHtml.setFocus(this.IdPremierElement);this.EnAffichage=true;this.EnPremierPlan();if(this.surAfficher)
this.surAfficher();if($('#'+this.Nom.escapeJQ()).find('img').length===0){this.apresAfficher();} else{$('#'+this.Nom.escapeJQ()).find('img').on('load error',this.apresAfficher.bind(this));}};ObjetFiche.prototype.apresAfficher=function(){var lWidth=$('#'+this.idContenu.escapeJQ()).width()-7-(this.avecBoutonFermer?this._optionsFiche.largeurBoutonFermeture:0);$('#'+this.idLibelleBandeau.escapeJQ()).outerWidth(lWidth);if(this.avecDeplacementSurBandeau||this.avecDeplacementSurFiche){$('#'+this.Nom.escapeJQ()).jIEDraggable(this.getOptionsDraggable());}};ObjetFiche.prototype.masquerCroix=function(){$('#'+this.idContenu.escapeJQ()).find('.Image_CroixFermetureMasque').hide();};ObjetFiche.prototype.afficherCroix=function(){$('#'+this.idContenu.escapeJQ()).find('.Image_CroixFermetureMasque').show();};ObjetFiche.prototype.surToucheEchap=function(){if(this.avecBoutonFermer&&$('#'+this.idContenu.escapeJQ()).find('.Image_CroixFermetureMasque').is(':visible')){this.Fermer();}};ObjetFiche.prototype.Fermer=function(ASurInteractionUtilisateur){if(this.EnAffichage){var LSurInteractionUtilisateur=ASurInteractionUtilisateur===null||ASurInteractionUtilisateur===undefined?true:ASurInteractionUtilisateur;if(this._optionsFiche.avecAbonnementBlocage)
GNavigateur.desabonnementBlocageInterface(this.Nom);if(this._optionsFiche.avecAbonnementPremierPlan)
GNavigateur.desabonnementPremierPlan(this.Nom);GStyle.setVisible(this.Nom,false);GHtml.setDisplay(this.Nom,false);if(LSurInteractionUtilisateur)
this.callback.appel();this.effacer();$('#'+this.Nom.escapeJQ()).css('left','').css('top','');this.EnAffichage=false;}};ObjetFiche.prototype.EstAffiche=function(){return this.EnAffichage===true;};ObjetFiche.prototype.setLibelleBandeau=function(aLibelle){$('#'+this.idLibelleBandeau.escapeJQ()).text(aLibelle);};ObjetFiche.prototype.surPreResize=function(){if(this._optionsFiche.repositionnementSurResize&&this.EstAffiche()){this._tempResize={left:GPosition.getLeft(this.Nom),top:GPosition.getTop(this.Nom)};GHtml.setDisplay(this.Nom,false);}};ObjetFiche.prototype.surPostResize=function(){if(this._optionsFiche.repositionnementSurResize&&this.EstAffiche()&&this._tempResize){GPosition.placer(this.Nom,0,0);GHtml.setDisplay(this.Nom,true);GPosition.placer(this.Nom,this._tempResize.left,this._tempResize.top);delete this._tempResize;}};;
function UtilitaireQCM(){this.couleurBonneReponse='green';this.couleurFausseReponse='red';}
UtilitaireQCM.prototype.composeNumerotation=function(aTypeNum,aNum){if(aTypeNum===TypeNumerotation.n123) return aNum;else if(aTypeNum===TypeNumerotation.nABC) return this.aphabetize(aNum).toUpperCase();else if(aTypeNum===TypeNumerotation.NRoman) return this.romanize(aNum);};UtilitaireQCM.prototype.aphabetize=function(aNum){var lResult='';while(aNum>0){aNum--;var lRemain=aNum%26;lResult=String.fromCharCode(lRemain+97)+lResult;aNum=(aNum-lRemain)/26;}
return lResult;};UtilitaireQCM.prototype.romanize=function(aNum){var lLookup={M:1000,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1},lRoman='',i;for(i in lLookup){while(aNum>=lLookup[i]){lRoman+=i;aNum-=lLookup[i];}}
return lRoman;};UtilitaireQCM.prototype.estCliquable=function(aExecutionQCM){return aExecutionQCM.fichierDispo&&(GEtatUtilisateur.estEspacePourEleve()?this.estJouable(aExecutionQCM)||
this.estCorrige(aExecutionQCM):(GEtatUtilisateur.estEspacePourProf()?true:false));};UtilitaireQCM.prototype.estJouable=function(aExecutionQCM){return aExecutionQCM.estEnPublication===true&&((aExecutionQCM.etatCloture!==TypeEtatExecutionQCMPourRepondant.EQR_DureeMaxDepassee&&
aExecutionQCM.etatCloture!==TypeEtatExecutionQCMPourRepondant.EQR_Termine)||
aExecutionQCM.estRejouable);};UtilitaireQCM.prototype.estCorrige=function(aExecutionQCM){return aExecutionQCM.publierCorrige===true;};;
MethodesObjet.heritagePrototype(UtilitaireQCM_Espace,UtilitaireQCM);if(!window.GUtilitaires) window.GUtilitaires={};window.GUtilitaires.QCM=new UtilitaireQCM_Espace();function UtilitaireQCM_Espace(){this.inheritedCreate();this.classWrapperInput='utilitaireQCMWrapperInput';this.classWrapperBracket='utilitaireQCMWrapperBracket';}
UtilitaireQCM_Espace.prototype.composeEnonce=function(aThis,aQuestion){var lEnonceHtml=aQuestion.enonce,lResponse;var lIndice=0;if(aQuestion.GetGenre()===TypeGenreExerciceDeQuestionnaire.GEQ_ClozeField||aQuestion.GetGenre()===TypeGenreExerciceDeQuestionnaire.GEQ_ClozeFixed||aQuestion.GetGenre()===TypeGenreExerciceDeQuestionnaire.GEQ_ClozeVariable){lEnonceHtml=lEnonceHtml.replace(/&#039;/gi,'&apos;');if(aQuestion.GetGenre()===TypeGenreExerciceDeQuestionnaire.GEQ_ClozeField&&aQuestion.enonce.match(/{#}/gi)){lEnonceHtml=lEnonceHtml.replace(/{#}/gi,'<input type="text" id="'+aThis.Nom+'_q'+aThis.indiceQuestion+'_r'+(lIndice++)+'" class="objetVisuEleveInputCloze" />');} else if(aQuestion.listeReponses&&aQuestion.listeReponses.GetNbrElements()&&aQuestion.listeReponses.GetNbrElements()===aQuestion.enonce.match(/{#}/gi).length){for(var i=0;i<aQuestion.listeReponses.GetNbrElements();i++){lEnonceHtml=lEnonceHtml.replace('{#}','<label class="objetVisuEleveInputSelect"><select id="'+aThis.Nom+'_q'+aThis.indiceQuestion+'_r'+i+'"  class="objetVisuEleveInputSelect"><option value=""></option>'+$.map(aQuestion.listeReponses.GetElement(i).listeChoix,function(val){return'<option value="'+val+'">'+val+'</option>';}).join('')+'</select></label>');}} else{var lThis=this;lEnonceHtml=lEnonceHtml.replace(/{[0-9]*:(ShortAnswer|MultiChoice):(~*(%[0-9]{1,3}%|=)?[^~%#{}]+#?[^~%#{}]*)+}/gi,function(ele){var lHtml='';var lSpans=[];if(aQuestion.GetGenre()===TypeGenreExerciceDeQuestionnaire.GEQ_ClozeVariable){lHtml='<span style="border:'+GCouleur.intermediaire+' 1px solid;">';var lResponses=ele.match(/((multichoice:|shortanswer:|~)(%[0-9]{1,3}%|=)?[^~%#{}]+#?[^~%#{}]*)/gi);for(var x in lResponses){if(!$.isNumeric(x))continue;lResponses[x]=lResponses[x].replace(/^(multichoice:|shortanswer:)/i,'');lResponses[x]=lResponses[x].replace(/^(:|~)?=/,'%100%');lResponses[x]=lResponses[x].replace(/^(:|~)?([^~%#{}])/,'%0%$2');lResponse=lResponses[x].split('%');lResponse.splice(2,1,lResponse[2].split('#')[0],lResponse[2].split('#')[1]);lSpans.push('<span style="color:'+(lResponse[1]==='100'?lThis.couleurBonneReponse:lThis.couleurFausseReponse)+';">'+lResponse[2]+'</span>');}
lHtml+=lSpans.join(' | ');lHtml+='</span>';} else{lResponse=ele.match(/(?:multichoice:|shortanswer:|~)(?:%100%|=)([^~%#{}]+)#?[^~%#{}]*/i);lHtml='<span style="color:'+lThis.couleurBonneReponse+';border:'+GCouleur.intermediaire+' 1px solid;">'+lResponse[1]+'</span>';}
return lHtml;});}}
return lEnonceHtml;};UtilitaireQCM_Espace.prototype.composeReponses=function(aThis,aQuestion,aAvecReponse,aAvecFeedback){var lHtml=[],lReponse,i;if(aQuestion.GetGenre()===TypeGenreExerciceDeQuestionnaire.GEQ_SingleChoice||aQuestion.GetGenre()===TypeGenreExerciceDeQuestionnaire.GEQ_MultiChoice){var lType='checkbox';if(aQuestion.GetGenre()===TypeGenreExerciceDeQuestionnaire.GEQ_SingleChoice) lType='radio';var lModeBouton=!aAvecReponse&&!aAvecFeedback;for(i=0;lModeBouton&&i<aQuestion.listeReponses.GetNbrElements();i++){lReponse=aQuestion.listeReponses.GetElement(i);if(lReponse.image||lReponse.editionAvancee){lModeBouton=false;}}
lHtml.push('<table cellpadding="0" cellspacing="0" style="">');if(!aAvecReponse) lHtml.push('<tr><td class="AlignementHaut"></td><td></td><td></td><td style="padding-left:20px;border-left:#fff 2px solid;"><div class="objetVisuEleveLabelCorrige">'+GTraductions.getValeur('ExecutionQCM.LabelCorrige')+'</div></td></tr>');for(i=0;i<aQuestion.listeReponses.GetNbrElements();i++){lReponse=aQuestion.listeReponses.GetElement(i);if(!lReponse.Existe()) continue;lHtml.push('<tr><td style="-webkit-transform-style: preserve-3d;" class="AlignementHaut">');lHtml.push(this.composeSingleMulti({objetThis:aThis,reponse:lReponse,indice:i,type:lType,modeBouton:lModeBouton,avecReponse:aAvecReponse,avecFeedback:aAvecFeedback,dernier:i===aQuestion.listeReponses.GetNbrElements()-1}));if(!aAvecReponse){lHtml.push('</td><td class="AlignementMilieuVertical AlignementMilieu" style="width:41px;">');lHtml.push('</td><td class="AlignementHaut" style="padding-right:20px;">');lHtml.push('</td><td style="padding-left:20px;" class="AlignementHaut objetVisuEleveCorrige">');lHtml.push('<div id="',aThis.Nom,'_q',aThis.indiceQuestion,'_corrige',i,'"></div>');}
lHtml.push('</td></tr>');}
lHtml.push('</table>');} else if(aQuestion.GetGenre()===TypeGenreExerciceDeQuestionnaire.GEQ_ShortAnswer||aQuestion.GetGenre()===TypeGenreExerciceDeQuestionnaire.GEQ_NumericalAnswer){if(aAvecReponse&&aQuestion.listeReponses.GetNbrElements()){lHtml.push('<ul>');for(i=0;i<aQuestion.listeReponses.GetNbrElements();i++){lReponse=aQuestion.listeReponses.GetElement(i);if(!lReponse.Existe()) continue;lHtml.push('<li>');lHtml.push(lReponse.GetLibelle());if(aAvecFeedback&&lReponse.feedback!=='') lHtml.push('<span style="color:'+(lReponse.bonneReponse?this.couleurBonneReponse:this.couleurFausseReponse)+';" class="EspaceGauche">&#x27AA;&nbsp;'+lReponse.feedback+'</span>');lHtml.push('</li>');}
lHtml.push('</ul>');} else{lHtml.push('<table cellpadding="0" cellspacing="0" style="">');lHtml.push('<tr><td class="AlignementHaut"></td><td></td><td style="padding-left:20px;border-left:#fff 2px solid;"><div class="objetVisuEleveLabelCorrige">'+GTraductions.getValeur('ExecutionQCM.LabelCorrige')+'</div></td></tr>');lHtml.push('<tr><td class="AlignementHaut">');lHtml.push('<input type="text" id="',aThis.Nom,'_q',aThis.indiceQuestion,'_r0" class="objetVisuEleveInput" />');lHtml.push('</td><td class="AlignementHaut" style="padding-right:20px;">');lHtml.push('</td><td style="min-width:50%;padding-left:20px;" class="AlignementHaut objetVisuEleveCorrige">');lHtml.push('<div id="',aThis.Nom,'_q',aThis.indiceQuestion,'_corrige0"></div>');lHtml.push('<div id="',aThis.Nom,'_q',aThis.indiceQuestion,'_feedback0"></div>');lHtml.push('</td></tr>');lHtml.push('</table>');}} else if(aQuestion.GetGenre()===TypeGenreExerciceDeQuestionnaire.GEQ_Matching&&!aAvecReponse){var lProp=[];var lAssoc=[];var lAnswer=[];var lReponses=[];for(i=0;i<aQuestion.listeReponses.GetNbrElements();i++){lReponse=aQuestion.listeReponses.GetElement(i);if(!lReponse.Existe()) continue;lProp.push('<li id="',aThis.Nom,'_q',aThis.indiceQuestion,'_assoc',i,'" style="padding:5px;border:#ccc 1px solid;margin:5px;">',lReponse.GetLibelle(),'</li>');lAssoc.push('<li id="',aThis.Nom,'_q',aThis.indiceQuestion,'_drop',i,'" style="padding:5px;border:#ccc 1px dashed;margin:5px;">&nbsp;</li>');if($.inArray(lReponse.association,lReponses)=== -1){lAnswer.push('<li id="',aThis.Nom,'_q',aThis.indiceQuestion,'_r',i,'" style="padding:5px;border:#ccc 1px solid;margin:5px;background-color:#fff;cursor:move;display:inline-block;">',lReponse.association,'</li>');lReponses.push(lReponse.association);}}
lHtml=lHtml.concat(['<table cellpadding="0" cellspacing="0" style="width:100%">','<tr><td class="AlignementHaut"></td><td class="AlignementHaut"></td><td style="padding-left:20px;border-left:#fff 2px solid;"><div class="objetVisuEleveLabelCorrige">'+GTraductions.getValeur('ExecutionQCM.LabelCorrige')+'</div></td></tr>','<tr><td class="AlignementHaut" style="width:60%;">'],['<div style="overflow:auto;line-height:110%;"><ul class="objetVisuEleveAssoc objetVisuEleveProp" style="float:left;list-style:none;width:50%;margin:0;padding:0;">'],lProp,['</ul><ul class="objetVisuEleveAssoc objetVisuEleveAssocReponses" style="float:left;list-style:none;width:50%;margin:0;padding:0;">'],lAssoc,['</ul></div>'],['</td>','<td class="AlignementHaut" style="width:6%;">','<ul class="objetVisuEleveAssoc objetVisuEleveAssocCoches" style="list-style:none;width:100%;margin:0;padding:0;"></ul>','</td>','<td style="width:33%;padding-left:20px;" class="AlignementHaut objetVisuEleveCorrige">'],['<div style="overflow:auto;line-height:110%;"><ul class="objetVisuEleveAssoc objetVisuEleveAssocCorriges" style="list-style:none;width:100%;margin:0;padding:0;"></ul></div>'],['</td></tr>','</table>'],['<ul id="',aThis.Nom,'_q',aThis.indiceQuestion,'_choix" class="objetVisuEleveAssocChoix" style="list-style:none;position:relative;line-height:110%;padding:10px;">'],lAnswer,['</ul>']);} else if(aQuestion.GetGenre()===TypeGenreExerciceDeQuestionnaire.GEQ_Matching&&aAvecReponse){for(i=0;i<aQuestion.listeReponses.GetNbrElements();i++){lReponse=aQuestion.listeReponses.GetElement(i);if(!lReponse.Existe()) continue;lHtml.push(lReponse.GetLibelle()+' <span class="Texte12">&harr;</span> '+lReponse.association+'<br />');}} else if(aQuestion.GetGenre()===TypeGenreExerciceDeQuestionnaire.GEQ_SpellAnswer){lReponse=aQuestion.listeReponses.GetElement(0);if(lReponse&&aAvecReponse){lHtml.push($.map(lReponse.GetLibelle().split(''),function(aVal){return'<span class="Texte10 EspaceDroit InlineBlock" style="width:9px;text-align:center;border:0;border-bottom:1px #000 solid;margin-right:5px;padding:0;">'+aVal+'</span>';}).join(''));if(aAvecFeedback&&lReponse.feedback!=='') lHtml.push('<span style="color:'+(this.couleurBonneReponse)+';" class="EspaceGauche">&#x27AA;&nbsp;'+lReponse.feedback+'</span>');} else if(lReponse){lHtml.push('<table cellpadding="0" cellspacing="0" style="">');lHtml.push('<tr><td class="AlignementHaut"></td><td></td><td style="padding-left:10px;border-left:#fff 2px solid;"><div class="objetVisuEleveLabelCorrige">'+GTraductions.getValeur('ExecutionQCM.LabelCorrige')+'</div></td></tr>');lHtml.push('<tr><td class="AlignementHaut">');lHtml.push($.map(lReponse.GetLibelle().split(''),function(aVal){return'<input name="'+aThis.Nom+'_q'+aThis.indiceQuestion+'_r" type="text" maxLength="1" size="1"'+' style="text-align:center;border:0;border-bottom:1px #000 solid;margin-right:5px;padding:0;width:22px;"'+' onkeyup="if($(this).val() !== \'\' && $(this).next(\'input\')) if(!(event.keyCode === ToucheClavier.Tab && event.shiftKey) && event.keyCode !== ToucheClavier.Shift) $(this).next(\'input\').focus();"'+' onkeydown="if(event.keyCode === ToucheClavier.Backspace && $(this).val() === \'\' && $(this).prev(\'input\')) $(this).prev(\'input\').focus().val(\'\');"'+' />';}).join(''));lHtml.push('</td><td class="AlignementHaut">');lHtml.push('</td><td style="min-width:50%;padding-left:10px;" class="AlignementHaut objetVisuEleveCorrige">');lHtml.push('<div id="',aThis.Nom,'_q',aThis.indiceQuestion,'_corrige"></div>');lHtml.push('<div id="',aThis.Nom,'_q',aThis.indiceQuestion,'_feedback" style="line-height:110%;"></div>');lHtml.push('</td></tr>');lHtml.push('</table>');}}
return lHtml;};UtilitaireQCM_Espace.prototype.composeSingleMulti=function(aParam){var lHtml=[];var lChecked=(aParam.avecReponse&&aParam.reponse.bonneReponse?' checked="checked"':'');lHtml.push('<div class="'+(aParam.modeBouton?'objetVisuEleveBouton AlignementMilieu':'')+(aParam.modeBouton&&lChecked?' objetVisuEleveBoutonChecked':'')+'" id="',aParam.objetThis.Nom,'_q',aParam.objetThis.indiceQuestion,'_div_r',aParam.indice,'"'+' style="'+(aParam.modeBouton?'border:'+GCouleur.fenetre.nonEditable.bordure+' 1px solid;'+GStyle.composeTransitions('transform -webkit-transform background','0.25s'):'width:100%;'+(!aParam.dernier&&(aParam.reponse.image||aParam.reponse.editionAvancee)?'padding-bottom:7px;border-bottom:'+GCouleur.grisClair+' 1px solid;margin-bottom:8px;':'margin-bottom:15px;'))+'">');lHtml.push('<div class="InlineBlock AlignementHaut ',this.classWrapperInput,'"'+(aParam.modeBouton?' style="width:0px;height:0px;overflow:hidden;"':'')+'>');if(!aParam.pourCorrige){lHtml.push('<input type="',aParam.type,'" id="',aParam.objetThis.Nom,'_q',aParam.objetThis.indiceQuestion,'_r',aParam.indice,'" name="',aParam.objetThis.Nom,'_q',aParam.objetThis.indiceQuestion,'"'+lChecked+' />');} else{if(aParam.type==='radio'){if(lChecked){lHtml.push('<span class="InlineBlock AlignementHaut Image_RadioB_Coche_Fenetre" style="margin-right:2px">&nbsp;</span>');} else{lHtml.push('<span class="InlineBlock AlignementHaut Image_RadioB_Decoche_Fenetre" style="margin-right:2px">&nbsp;</span>');}} else if(aParam.type==='checkbox'){if(lChecked){lHtml.push('<span class="InlineBlock AlignementHaut Image_CheckB_Coche_Fenetre" style="margin-right:2px">&nbsp;</span>');} else{lHtml.push('<span class="InlineBlock AlignementHaut Image_CheckB_Decoche_Fenetre" style="margin-right:2px">&nbsp;</span>');}}}
lHtml.push('</div>');lHtml.push('<div class="InlineBlock AlignementMilieuVertical '+(aParam.modeBouton?' AlignementMilieu':' EspaceGauche')+'" style="line-height:110%;'+(aParam.modeBouton?'width:100%;':'max-width:95%;')+'overflow:hidden;">');lHtml.push('<div class="AlignementMilieuVertical">');lHtml.push('<label for="',aParam.objetThis.Nom,'_q',aParam.objetThis.indiceQuestion,'_r',aParam.indice,'" style="'+(aParam.modeBouton?'padding:15px;display:block;':'')+'">',(!aParam.reponse.editionAvancee?aParam.reponse.GetLibelle():aParam.reponse.libelleHtml),'</label>');if(aParam.avecFeedback&&aParam.reponse.feedback!=='') lHtml.push(' <span style="color:'+(aParam.reponse.bonneReponse?this.couleurBonneReponse:this.couleurFausseReponse)+';" class="EspaceGauche">&#x27AA;&nbsp;'+aParam.reponse.feedback+'</span>');if(aParam.reponse.image) lHtml.push('<div style="padding:3px;"><img src="data:image/png;base64,'+aParam.reponse.image+'" onerror="$(this).parent().html(GTraductions.getValeur(\'ExecutionQCM.ImageNonSupportee\'));"',(aParam.objetThis.actualiserHauteurReponse?'onload="'+aParam.objetThis.Nom+'.actualiserHauteurReponse(\''+aParam.objetThis.Nom+'_q'+aParam.objetThis.indiceQuestion+'_div_r'+aParam.indice+'\');"':''),' /></div>');lHtml.push('</div>');lHtml.push('</div>');lHtml.push('</div>');return lHtml.join('');};;
function TUtilitaireCDT(){}(function(){TUtilitaireCDT.strtMatiere=function(aMatiere,aGroupe,aPourFiche){var H=[];H.push('<div class="InlineBlock" style="float: left; margin-right: 3px; width: 8px; height: 12px; ',GStyle.composeCouleurFond(aMatiere.CouleurFond),'"></div>','<div class="InlineBlock',aPourFiche?' Move':'','">','<span class="Gras">',aMatiere.GetLibelle()?aMatiere.GetLibelle():'&nbsp;','</span>',aGroupe?' ('+aGroupe.GetLibelle()+')':'','</div>');return H.join('');};TUtilitaireCDT.strtDate=function(aDate){var H=[];H.push(aDate?GTraductions.getValeur('CahierDeTexte.le')+GDate.FormatDate(aDate,' %JJ %MMMM %AAAA '+GTraductions.getValeur('CahierDeTexte.a')+' %hhh%mm'):'');return H.join('');};TUtilitaireCDT.initGrilleCalendrier=function(aInstance){aInstance.SetParametres(GParametres.PremiereDate,GParametres.DerniereDate,GParametres.JoursOuvres,false,false,false,true,false);aInstance.setOptions({avecDeploiement:false,avecSelection:true});aInstance.setTraductions(GTraductions.getValeur('GrilleCalendrier'));};})();;
var EGenreLienDS={tGL_Devoir:0,tGL_Evaluation:1};EGenreLienDS.getImage=function(aGenre){switch(aGenre){case EGenreLienDS.tGL_Devoir:return'Image_IconeDS';case EGenreLienDS.tGL_Evaluation:return'Image_IconeEvaluation';}
return'';};;
function ObjetUtilitaireCahierDeTexte(aTraductions){this.traductions=aTraductions;}
ObjetUtilitaireCahierDeTexte.prototype.composeCDC=function(aElement,aNom){var lHtml=[];lHtml.push('<table class="Texte10 EspaceHaut EspaceBas" style="width:100%;" border="0" cellpadding="0" cellspacing="0">');var lAvecDS=aElement.estUnDS;var lColspan=lAvecDS?' colspan="2" ':'';for(var i=0;i<aElement.listeContenus.GetNbrElements();i++){if(i>0)
lHtml.push('<tr><td ',lColspan,' class="EspaceGauche10"><hr></td></tr>');var lContenu=aElement.listeContenus.GetElement(i);lHtml.push('<tr><td ',lContenu.categorie.genreLienDS===EGenreLienDS.tGL_Devoir?'':lColspan ,' class="EspaceGauche PetitEspaceBas AlignementHaut Gras">');lHtml.push(lContenu.Libelle,(lContenu.categorie.Libelle?(lContenu.Libelle?' - ':'')+lContenu.categorie.Libelle:''));lHtml.push('</td>');if(lContenu.categorie.genreLienDS!==undefined){lHtml.push('<td style="width:17px" class="PetitEspaceGauche PetitEspaceDroit">',this.composeSymboleDS(lContenu.categorie.genreLienDS),'</td>');}
lHtml.push('</tr>','<tr><td ',lColspan,' class="EspaceGauche EspaceDroit AlignementHaut" style="position:relative; overflow:auto;">',lContenu.descriptif,'</td></tr>');if(lContenu.ListePieceJointe.GetNbrElements()>0){lHtml.push('<tr><td ',lColspan,' class="EspaceGauche10 AlignementHaut">',this.composePiecesJointes(lContenu,false),'</td></tr>');}
if(lContenu.listeExecutionQCM.GetNbrElements()>0){var nbExecutionQCM=lContenu.listeExecutionQCM.GetNbrElements();for(var j=0;j<nbExecutionQCM;j++){var lExecutionQCM=lContenu.listeExecutionQCM.GetElement(j);lHtml.push('<tr><td ',lColspan,' class="EspaceGauche10 AlignementHaut">',this.getTitreExecutionQCMContenu(aElement.GetNumero()+'_'+lContenu.GetNumero()+'_'+j,lExecutionQCM,aNom),'</td></tr>');}}}
if(aElement.ListeTravailAFaire.GetNbrElements()){lHtml.push('<tr><td ',lColspan,' class="EspaceGauche AlignementHaut">',this.composeTAFpourContenu(aElement.ListeTravailAFaire,aNom),'</td></tr>');}
lHtml.push('</table>');return lHtml.join('');};ObjetUtilitaireCahierDeTexte.prototype.composeTAFpourContenu=function(aListeTAF,aNom){aListeTAF.setTri([ObjetTri.init('Genre'),ObjetTri.init('PourLe')]);aListeTAF.trier();var lHtml=[];if(aListeTAF.GetNbrElements()){lHtml.push('<div class="Texte10 EspaceHaut">');for(var I=0;I<aListeTAF.GetNbrElements();I++){var LTravailAFaire=aListeTAF.GetElement(I);lHtml.push('<div class="Texte10"><span class="Souligne">',LTravailAFaire.Genre===1?GTraductions.getValeur('CahierDeTexte.lecons'):GTraductions.getValeur('CahierDeTexte.devoirs'),' ',GTraductions.getValeur('CahierDeTexte.pourLe'),' ',GChaine.Insecable(GDate.FormatDate(LTravailAFaire.PourLe,'%JJ/%MM')) ,'&nbsp;:</span>&nbsp;','</div>');var lEstQCM=LTravailAFaire.executionQCM&&LTravailAFaire.executionQCM.existeNumero();lHtml.push('<div class="Texte10">','<div',(lEstQCM?'':' style="position:relative; overflow:auto;"'),'>',lEstQCM?this.getTitreExecutionQCM(LTravailAFaire.GetNumero(),LTravailAFaire.executionQCM,aNom):LTravailAFaire.descriptif,'</div>','</div>');}
lHtml.push('</div>');}
return lHtml.join('');};ObjetUtilitaireCahierDeTexte.prototype.getTitreExecutionQCM=function(I,aExecutionQCM,aNom){var H=[];var lAvecAction=aNom&&
window.GUtilitaires.QCM.estCliquable(aExecutionQCM);var lAction=lAvecAction?' class="AvecMain Souligne" onclick="'+aNom+'.surExecutionQCM (event, \''+I+'\')"':'';H.push('<div>',aExecutionQCM.estEnPublication===true?GTraductions.getValeur('ExecutionQCM.RepondreQCM'):GDate.FormatDate(aExecutionQCM.dateDebutPublication,''+GTraductions.getValeur('ExecutionQCM.QCMPublieLe')+' %J %MMMM'),' : ','<span',lAction,'>',aExecutionQCM.QCM.GetLibelle(),'</span>','</div>');return H.join('');};ObjetUtilitaireCahierDeTexte.prototype.getTitreExecutionQCMContenu=function(I,aExecutionQCM,aNom){var H=[];var lAvecAction=aNom&&
window.GUtilitaires.QCM.estCliquable(aExecutionQCM);var lAction=lAvecAction?' class="AvecMain Souligne" onclick="'+aNom+'.surExecutionQCMContenu (event, \''+I+'\')"':'';H.push('<div>',GTraductions.getValeur('ExecutionQCM.RepondreQCMContenu'),' : ','<span',lAction,'>',aExecutionQCM.QCM.GetLibelle(),'</span>','</div>');return H.join('');};ObjetUtilitaireCahierDeTexte.prototype.composePiecesJointes=function(aElement,aAvecTitre){var lHtml=[];var lAvecTitre=(aAvecTitre!==null&&aAvecTitre!==undefined)?aAvecTitre:true;lHtml.push('<table class="Texte10" border="0" cellpadding="0" cellspacing="0"><tr>');if(lAvecTitre)
lHtml.push('<td class="AlignementHaut Gras" width="150px">',GChaine.Insecable(GTraductions.getValeur('CahierDeTexte.documentsAConsulter')+' : '),'</td>');lHtml.push('<td><table class="Texte10" border="0" cellpadding="0" cellspacing="0">');var nbPiecesJointes=aElement.ListePieceJointe.GetNbrElements();for(var I=0;I<nbPiecesJointes;I++){var lPieceJointe=aElement.ListePieceJointe.GetElement(I);lHtml.push('<tr><td>',GChaine.composerURL(lPieceJointe.Url,lPieceJointe.Libelle,lPieceJointe.GetGenre()===EGenreDocumentJoint.Fichier),'</td></tr>');}
lHtml.push('</table></td>','</tr></table>');return lHtml.join('');};ObjetUtilitaireCahierDeTexte.prototype.composeTitreTAF=function(aElement){var T=[];T.push('<table ',GObjetWAI.composeRole(EGenreRole.Gridcell),' style="',GStyle.composeCouleur(GCouleur.themeNeutre.legere,GCouleur.noire),' width:100%; height:15px;" border="0" cellpadding="0" cellspacing="0">','<tr>','<td class="Texte10 AvecMove"><div class="PetitEspace Texte10">',TUtilitaireCDT.strtMatiere(aElement,aElement.groupe,false),'</td>','</tr>','</table>');return T.join('');};ObjetUtilitaireCahierDeTexte.prototype.composeTitreCDC=function(aElement,aListeCDT){var T=[];var lElt=aListeCDT.GetElementParNumero(aElement.ressources.GetNumero(0));var lClasseSelectionnee=GEtatUtilisateur.Navigation.GetRessource(EGenreRessource.Classe);if(!lClasseSelectionnee&&GEtatUtilisateur.getMembre())
lClasseSelectionnee=GEtatUtilisateur.getMembre().Classe;var lAvecGroupe=lElt.groupe&&lElt.groupe.existeNumero()&&lClasseSelectionnee&&(lClasseSelectionnee.GetNumero()!==lElt.groupe.GetNumero());T.push('<table ',GObjetWAI.composeRole(EGenreRole.Gridcell),' style="',GStyle.composeCouleur(GCouleur.themeNeutre.legere,GCouleur.noire),' width:100%; height:15px;" border="0" cellpadding="0" cellspacing="0">','<tr>','<td class="Texte10 AvecMove"><div class="PetitEspace Texte10">','<div>',TUtilitaireCDT.strtMatiere(aElement,lAvecGroupe?lElt.groupe:false,false),'</div>','<div>',TUtilitaireCDT.strtDate(aElement.Date),'</div>','</td>','</tr>','</table>');return T.join('');};ObjetUtilitaireCahierDeTexte.prototype.composeSymboleDS=function(AGenreLienDS){var T=[];T.push('<div class="InlineBlock ',EGenreLienDS.getImage(AGenreLienDS),' AlignementMilieuVertical" style="width:17px"></div>');return T.join('');};ObjetUtilitaireCahierDeTexte.prototype.composeTAF=function(aElement,aListeTAF,aParam){var T=[],I;var lNbrElements=aElement.ressources?aElement.ressources.GetNbrElements():aListeTAF.GetNbrElements();var lElement,lRessource;var lBandeauDS;var lDonneLe,lNewDonneLe,lLibelle='';var lGenreTAF,lGenreNewTAF=0;var lNomGenre=[GTraductions.getValeur('CahierDeTexte.lecons'),GTraductions.getValeur('CahierDeTexte.devoirs')];var lAvecDevoirPersonalise=false;if(aParam.avecInfoDevoirPersonalise&&aListeTAF.avecDevoirPersonalise)
for(I=0;I<lNbrElements&&!lAvecDevoirPersonalise;I++){lElement=aElement.ressources?aListeTAF.GetElementParNumero(aElement.ressources.GetNumero(I)):aListeTAF.GetElement(I);if(lElement.pourTousLesEleves===false)
lAvecDevoirPersonalise=true;}
for(I=0;I<lNbrElements;I++){if(aElement.ressources){lRessource=aElement.ressources.GetElement(I);lElement=lRessource.estUnDS?lRessource:aListeTAF.GetElementParNumero(lRessource.GetNumero());}
else lElement=aListeTAF.GetElement(I);if(lElement.estUnDS){if(!lBandeauDS){T.push('<div style="height:4px; ',GStyle.composeCouleur(GCouleur.themeNeutre.legere,GCouleur.noire),'">&nbsp;</div>');lBandeauDS=true;}
if(lElement.estDevoir)
T.push('<div class="NoWrap PetitEspace EspaceGauche">','<div class="InlineBlock GrandEspaceDroit AlignementMilieuVertical" >',lElement.GetLibelle(),'</div>',this.composeSymboleDS(EGenreLienDS.tGL_Devoir),'</div>');if(lElement.estEval)
T.push('<div class="NoWrap PetitEspace EspaceGauche">','<div class="InlineBlock GrandEspaceDroit AlignementMilieuVertical" >',lElement.GetLibelle(),'</div>',this.composeSymboleDS(EGenreLienDS.tGL_Evaluation),'</div>');}
else{var lNbJours=GDate.GetDifferenceJours(lElement.PourLe,lElement.DonneLe);var lStrJours=(lNbJours>1?GTraductions.getValeur('CahierDeTexte.jours'):GTraductions.getValeur('CahierDeTexte.jour'));lNewDonneLe=GTraductions.getValeur('CahierDeTexte.donneLe')+GDate.FormatDate(lElement.DonneLe,' %JJ %MMMM %AAAA');lGenreNewTAF=lElement.Genre;lLibelle="";T.push('<div class="EspaceBas">','<table class="Texte10 AlignementHaut" style="width:100%;" border="0" cellpadding="0" cellspacing="0">');if(!lDonneLe||lDonneLe!==lNewDonneLe){lGenreTAF=0;lLibelle='<span class="EspaceGauche">'+lNewDonneLe+'</span><span>'+' ['+lNbJours+' '+lStrJours+']</span>';var lGpe=lElement.nomPublic?'<div style="padding: 2px 0px 0px 5px;" >'+GTraductions.getValeur('Etudiants')+' '+lElement.nomPublic+'</div>':'';T.push('<tr style="',GStyle.composeCouleur(GCouleur.themeNeutre.legere,GCouleur.noire),'"><td colspan="',lAvecDevoirPersonalise?'2':'1','" class="PetitEspaceHaut PetitEspaceBas AlignementHaut">',lLibelle,lGpe,'</td></tr>');}
if(this.avecGenreTAF&&(!lGenreTAF||lGenreTAF!==lGenreNewTAF)){T.push('<tr><td colspan="',lAvecDevoirPersonalise?'2':'1','" class="EspaceGauche10 EspaceDroit PetitEspaceHaut AlignementHaut Italique Souligne">',lNomGenre[lGenreNewTAF-1],' :</td></tr>');}
T.push('<tr>');if(lAvecDevoirPersonalise)
T.push('<td width="13px" class="EspaceGauche PetitEspaceHaut AlignementHaut"><div class="',lElement.pourTousLesEleves?'SansImage_Devoir_Personalise':'Image_Devoir_Personalise','" title="',lElement.pourTousLesEleves?'':GTraductions.getValeur('CahierDeTexte.infoDevoirPerso'),'"></div></td>');var lEstQCM=lElement.executionQCM&&lElement.executionQCM.existeNumero();T.push('<td class="',lAvecDevoirPersonalise?'PetitEspaceGauche ':'EspaceGauche10 EspaceDroit PetitEspaceHaut AlignementHaut"','style="',(lEstQCM?'':'position:relative; overflow:auto'),(lAvecDevoirPersonalise?'width:100%;':''),'"','>',lEstQCM?this.getTitreExecutionQCM(lElement.GetNumero(),lElement.executionQCM,aParam.nom):lElement.descriptif,'</td>');T.push('</tr>');if(lElement.ListePieceJointe.GetNbrElements()>0){T.push('<tr>',lAvecDevoirPersonalise?'<td class="EspaceGauche"><div class="SansImage_Devoir_Personalise"></div></td>':'','<td class="',lAvecDevoirPersonalise?'PetitEspaceGauche ':'EspaceGauche10 ','EspaceDroit AlignementHaut"',lAvecDevoirPersonalise?' style="width:100%;"':'','>',this.composePiecesJointes(lElement,false),'</td>','</tr>');}
T.push('</table></div>');lDonneLe=lNewDonneLe;lGenreTAF=lGenreNewTAF;}}
return T.join('');};ObjetUtilitaireCahierDeTexte.prototype.getListeDonneesBrute=function(aParam){if(aParam.modeAffichage===EGenreAffichageCahierDeTextes.TravailAFaire){if(aParam.avecDS){aParam.listeDS.parcourir(function(D){D.estUnDS=true;return true;});if(aParam.avecTAF){var lListeTAF=MethodesObjet.dupliquer(aParam.listeTAF);var lListeDS=MethodesObjet.dupliquer(aParam.listeDS);return lListeTAF.FusionnerListe(lListeDS);}
else{return aParam.listeDS;}}
else{return aParam.avecTAF?aParam.listeTAF:new ObjetListeElements();}}
else{return aParam.listeCDT;}};ObjetUtilitaireCahierDeTexte.prototype.getListeFusionnee=function(aMatieres,aDonnees,aAvecMatieresVides){var lMatiere;var lDateCourante=null;function _filtrerParMatiereEtDate(aElt){return(aElt.GetNumero()===lMatiere)&&(GDate.estJourEgal(aElt.Date,lDateCourante));}
var lMatiereCourante;var lListeMatieresDuJour=[];var lResult=new ObjetListeElements();var i,lNbr,lElt;for(i=0,lNbr=aMatieres.GetNbrElements();i<lNbr;i++){lElt=aMatieres.GetElement(i);var lDate=lElt.date;lMatiere=lElt.Matiere.GetNumero();if(!GDate.estJourEgal(lDate,lDateCourante)){lDateCourante=lDate;lMatiereCourante=null;lListeMatieresDuJour=[];}
if(lMatiere!==lMatiereCourante){lMatiereCourante=lMatiere;if(!MethodesTableau.existe(lMatiere,lListeMatieresDuJour)){lListeMatieresDuJour.push(lMatiere);var lDonneeFiltre=aDonnees.getListeElements(_filtrerParMatiereEtDate);if(lDonneeFiltre.GetNbrElements()===1){lResult.AddElement(lDonneeFiltre.GetElement(0));}
else{if(aAvecMatieresVides){var lEltMatiere=new ObjetElement(lElt.Matiere.Libelle,lElt.Matiere.Numero,lElt.Matiere.Genre,lElt.Matiere.Position,lElt.Matiere.Actif);lEltMatiere.Date=lDateCourante;lEltMatiere.couleurBordure=GCouleur.liste.bordure;lEltMatiere.estUneSuite=false;lEltMatiere.aUneSuite=false;lEltMatiere.CouleurFond=lElt.CouleurFond;lEltMatiere.CouleurTexte=lElt.CouleurTexte;lEltMatiere.ressources=new ObjetListeElements();lResult.AddElement(lEltMatiere);}}}}}
return lResult;};ObjetUtilitaireCahierDeTexte.prototype.formatDonnees=function(aParam){var I,lElt,elementRessource,newElement;var lModeTAF=(aParam.modeAffichage===EGenreAffichageCahierDeTextes.TravailAFaire);var lListeDonnees=this.getListeDonneesBrute(aParam);var lResult=new ObjetListeElements();var lDate=null;var lMatiere=null;var lElementPrecedent=null;var lListe=lListeDonnees===null||lListeDonnees===undefined?0:lListeDonnees.GetNbrElements();for(I=0;I<lListe;I++){lElt=lListeDonnees.GetElement(I);lElt.ResetTri();switch(aParam.modeAffichage){case EGenreAffichageCahierDeTextes.TravailAFaire:if(lElt.estUnDS){lElt.AddTri(lElt.PourLe,EGenreType.Date);lElt.AddTri(lElt.Matiere.Libelle);}
else{lElt.AddTri(lElt.PourLe,EGenreType.Date);lElt.AddTri(lElt.Matiere.Libelle);lElt.AddTri(GDate.GetJour(lElt.DonneLe),EGenreType.Date);lElt.AddTri(lElt.Genre);lElt.AddTri(lElt.Libelle);}
break;default:lElt.AddTri(lElt.Date,EGenreType.Date);lElt.AddTri(lElt.Matiere.Libelle);break;}}
lListeDonnees.Trier();for(I=0;I<lListeDonnees.GetNbrElements();I++){lElt=lListeDonnees.GetElement(I);if((lModeTAF)||(lElt.listeContenus&&(lElt.listeContenus.GetNbrElements()>0))){newElement=new ObjetElement(lElt.Matiere.Libelle,lElt.Matiere.Numero,lElt.Matiere.Genre,lElt.Matiere.Position,lElt.Matiere.Actif);newElement.Date=lModeTAF?lElt.PourLe:lElt.Date;newElement.couleurBordure=GCouleur.liste.bordure;newElement.estUneSuite=false;newElement.aUneSuite=false;newElement.CouleurFond=lElt.CouleurFond;newElement.CouleurTexte=lElt.CouleurTexte;if(lModeTAF){newElement.groupe=lElt.groupe;newElement.ResetTri();}
newElement.AddTri(newElement.Date,EGenreType.Date);newElement.AddTri(newElement.Libelle);elementRessource=new ObjetElement(lModeTAF?(lElt.estUnDS?lElt.horaires:lElt.Libelle):lElt.listeContenus.GetLibelle(0),lElt.Numero,lElt.Genre,lElt.Position,lElt.Actif);if(lModeTAF){elementRessource.estUnDS=lElt.estUnDS;if(lElt.estUnDS){elementRessource.estDevoir=lElt.estDevoir;elementRessource.estEval=lElt.estEval;}
elementRessource.DonneLe=lElt.DonneLe;elementRessource.nomPublic=lElt.nomPublic;elementRessource.AddTri(lElt.estUnDS?0:1);elementRessource.AddTri(lElt.DonneLe);elementRessource.AddTri(newElement.Genre);}
else{var j,lNbr,lContenu;for(j=0,lNbr=lElt.listeContenus.GetNbrElements();j<lNbr;j++){lContenu=lElt.listeContenus.GetElement(j);if(lContenu.categorie&&lContenu.categorie.genreLienDS===EGenreLienDS.tGL_Devoir){elementRessource.estUnDS=true;}}}
if(lModeTAF&&lDate&&GDate.estJourEgal(lDate,newElement.Date)&&(lMatiere===newElement.Libelle)){lElementPrecedent.ressources.AddElement(elementRessource);lElementPrecedent.ressources.Trier();} else{newElement.ressources=new ObjetListeElements();newElement.ressources.AddElement(elementRessource);lResult.AddElement(newElement);lElementPrecedent=newElement;}
if(elementRessource.estUnDS){lElementPrecedent.estAvecDS=true;lElementPrecedent.estDevoir=lElt.estDevoir;lElementPrecedent.estEval=lElt.estEval;}
lDate=newElement.Date;lMatiere=newElement.Libelle;}}
lResult.Trier();if(lModeTAF&&aParam.listeMatieres){var lTri=[ObjetTri.init('place'),ObjetTri.init(function(D){return D.Matiere.GetLibelle();})];aParam.listeMatieres.setTri(lTri);aParam.listeMatieres.trier();lResult=this.getListeFusionnee(aParam.listeMatieres,lResult,aParam.avecMatieres);}
$.extend(aParam,{listeElements:lResult});this.apresFormatterDonneesPourAffichage(aParam);return lResult;};ObjetUtilitaireCahierDeTexte.prototype.apresFormatterDonneesPourAffichage=function(aParam){var lElt;var T=[];var i,lNbr;for(i=0,lNbr=aParam.listeElements.GetNbrElements();i<lNbr;i++){lElt=aParam.listeElements.GetElement(i);T=[];if(lElt.estAvecDS){T.push('<div class="NoWrap">');T.push('<div class="InlineBlock AlignementMilieuVertical GrandEspaceDroit">');}
T.push('<div style="float: left; height: 100%; margin-top: 3px; margin-bottom: 3px; margin-left : 3px;" class="NoWrap">',TUtilitaireCDT.strtMatiere(lElt,false,false),'</div><div style="clear: both"></div>');if(lElt.estAvecDS){T.push('</div>');if(lElt.estDevoir)
T.push('<div class="InlineBlock AlignementMilieuVertical" >',this.composeSymboleDS(EGenreLienDS.tGL_Devoir),'</div>');if(lElt.estEval)
T.push('<div class="InlineBlock AlignementMilieuVertical',lElt.estDevoir?' PetitEspaceGauche':'','" >',this.composeSymboleDS(EGenreLienDS.tGL_Evaluation),'</div>');T.push('</div>');}
if(aParam.avecDonneeLe){var j,lNbr2,lRessource;var lDonneeLeCourant=null;for(j=0,lNbr2=lElt.ressources.GetNbrElements();j<lNbr2;j++){lRessource=lElt.ressources.GetElement(j);if(!lRessource.estUnDS&&lRessource.DonneLe!==lDonneeLeCourant){lDonneeLeCourant=lRessource.DonneLe;var lNbJours=GDate.GetDifferenceJours(lElt.Date,lDonneeLeCourant);var lStrJours=(lNbJours>1?GTraductions.getValeur('CahierDeTexte.jours'):GTraductions.getValeur('CahierDeTexte.jour'));T.push('<div class=" GrandEspaceGauche">');T.push('<ul style="padding: 0px; margin: 0px;"><li style="list-style-position: inside; padding: 0px 0px 5px 0px;">');T.push('<span class="EspaceGauche">'+GTraductions.getValeur('CahierDeTexte.donneLe')+GDate.FormatDate(lDonneeLeCourant,' %JJ/%MM')+'</span>');T.push('<span>'+' ['+lNbJours+' '+lStrJours+']</span>');T.push('</li></ul>');T.push('</div>');}
if(lRessource.nomPublic){T.push('<div style="padding: 0px 0px 5px 35px;" >',GTraductions.getValeur('Etudiants'),' ',lRessource.nomPublic,'</div>');}}}
lElt.html=[];lElt.html[0]=T.join('');var lAffTAF=(aParam.modeAffichage===EGenreAffichageCahierDeTextes.TravailAFaire);T=[];T.push('<table ',GObjetWAI.composeRole(EGenreRole.Gridcell),' class="Texte10" style="width:100%;" border="0" cellpadding="0" cellspacing="0">');T.push('<tr><td>',lAffTAF?this.composeTitreTAF(lElt):this.composeTitreCDC(lElt,aParam.listeCDT),'</td></tr>');T.push('<tr><td height="100%;" class="FondBlanc" valign="top">');T.push('<table class="Texte10" style="width:100%;" border="0" cellpadding="0" cellspacing="0">');T.push('<tr>');T.push('<td class="AlignementHaut">');T.push('<div style=width:100%; height:100%;">');T.push(lAffTAF?this.composeTAF(lElt,aParam.listeTAF,{avecInfoDevoirPersonalise:aParam.avecInfoDevoirPersonalise,nom:aParam.nom,listeDS:aParam.listeDS}):this.composeCDC(aParam.listeCDT.GetElementParNumero(lElt.ressources.GetNumero(0)),aParam.nom));T.push('</div>');T.push('</td>');T.push('</tr>');T.push('</table>');T.push('</td></tr>');T.push('</table>');lElt.html[1]=T.join('');}};;
MethodesObjet.heritagePrototype(ObjetFicheCDT,ObjetFiche);function ObjetFicheCDT(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.Largeur=300;this.Hauteur=150;this.largeurMax=750;this.hauteurMax=400;this.avecGenreTAF=false;this.avecInfoDevoirPersonalise=false;this.utilitaireCDT=new ObjetUtilitaireCahierDeTexte(GTraductions.getValeur('CahierDeTexte'));this.idScroll=this.Nom+'_scroll';this._optionsFiche.largeurBoutonFermeture=11;}
ObjetFicheCDT.prototype.SetDonnees=function(aIdCours,aMatiere,aListeTAF,aGenreAffichage,aCahierDeTextes){this.matiere=aMatiere;this.listeTAF=aListeTAF;this.cahierDeTextes=aCahierDeTextes;this.genreAffichage=(aGenreAffichage!==null&&aGenreAffichage!==undefined)?aGenreAffichage:(GEtatUtilisateur.getGenreOnglet()===EGenreOnglet.CDT_TAF?EGenreAffichageCahierDeTextes.TravailAFaire:EGenreAffichageCahierDeTextes.ContenuDeCours);this.Afficher(aIdCours);};ObjetFicheCDT.prototype.setAvecInfoDevoirPersonalise=function(aBoolean){this.avecInfoDevoirPersonalise=aBoolean;};ObjetFicheCDT.prototype.ComposeContenu=function(){var lHtml=[];var lClass=this.genreAffichage===EGenreAffichageCahierDeTextes.TravailAFaire?"Texte10":"Texte10 FondBlanc";lHtml.push('<table class="',lClass,'" style="width:100%;height:100%;',GStyle.composeBordureArrondi(this.rayonBordure,EGenreCoin.basG+EGenreCoin.basD),'" border="0" cellpadding="0" cellspacing="0">');lHtml.push('<tr>');lHtml.push('<td class="AlignementHaut AvecSelectionTexte">');lHtml.push('<div id="',this.idScroll,'" class="Fenetre_Scroll" style="width:100%; height:100%;">');if(this.genreAffichage===EGenreAffichageCahierDeTextes.TravailAFaire)
lHtml.push(this.composeTAF());else lHtml.push(this.utilitaireCDT.composeCDC(this.cahierDeTextes,this.Nom));lHtml.push('</div>');lHtml.push('</td>');lHtml.push('</tr>');lHtml.push('</table>');return lHtml.join('');};ObjetFicheCDT.prototype.ComposeBandeau=function(AAvecBoutonFermer){var lHtml=[];var lLargeurTitre=this.Largeur-7-(AAvecBoutonFermer?this._optionsFiche.largeurBoutonFermeture:0);var lClass=this.genreAffichage===EGenreAffichageCahierDeTextes.TravailAFaire?"":" EspaceBas";lHtml.push('<div class="NoWrap" style="',GStyle.composeCouleur(GCouleur.themeNeutre.legere,GCouleur.noire),GStyle.composeBordureArrondi(this.rayonBordure-1,EGenreCoin.hautD),'">');lHtml.push('<div id="',this.idLibelleBandeau,'" class="InlineBlock AlignementHaut AvecMove" style="'+GStyle.composeWidth(lLargeurTitre)+'"><div class="EspaceHaut EspaceGauche',lClass,'">',this.composeTitre(),'</div></div>');if(AAvecBoutonFermer){lHtml.push('<div class="InlineBlock AlignementHaut">');lHtml.push('<div class="EspaceHaut PetitEspaceDroit AlignementDroit">');lHtml.push('<div class="AlignementHaut AvecMain Image_CroixFermeture" tabindex="0" width="1px" onkeyup="if (GNavigateur.IsToucheSelection ()) '+this.Nom+'.Fermer()" onclick="'+this.Nom+'.Fermer()" ',GObjetWAI.composeRole(EGenreRole.Button),' ',GObjetWAI.composeAttribut({genre:EGenreAttribut.label,valeur:GTraductions.getValeur('WAI.FermerFiche')}),'>','<div class="Texte10" style="width: 11px;">&nbsp;</div>','</div>');lHtml.push('</div>');lHtml.push('</div>');}
lHtml.push('</div>');return lHtml.join('');};ObjetFicheCDT.prototype.composeTitre=function(){var lHtml=[];if(this.genreAffichage===EGenreAffichageCahierDeTextes.TravailAFaire){lHtml.push(TUtilitaireCDT.strtMatiere(this.matiere,this.matiere.groupe,true));} else{var lClasseSelectionnee=GEtatUtilisateur.Navigation.GetRessource(EGenreRessource.Classe);if(!lClasseSelectionnee&&GEtatUtilisateur.getMembre())
lClasseSelectionnee=GEtatUtilisateur.getMembre().Classe;var lAvecGroupe=this.cahierDeTextes.groupe&&this.cahierDeTextes.groupe.existeNumero()&&lClasseSelectionnee&&(lClasseSelectionnee.GetNumero()!==this.cahierDeTextes.groupe.GetNumero());lHtml.push('<div>',TUtilitaireCDT.strtMatiere(this.matiere,lAvecGroupe?this.cahierDeTextes.groupe:false,true),'</div>','<div>',TUtilitaireCDT.strtDate(this.cahierDeTextes.Date),'</div>');}
return lHtml.join('');};ObjetFicheCDT.prototype.surExecutionQCM=function(event,I){var lElement=this.matiere.ressources?this.listeTAF.GetElementParNumero(this.matiere.ressources.GetElementParNumero(I).GetNumero()):this.listeTAF.GetElementParNumero(I);if(GApplication.getDemo()) lElement.executionQCM.etatCloture=TypeEtatExecutionQCMPourRepondant.EQR_EnCours;this.callback.appel({executionQCM:lElement.executionQCM});};ObjetFicheCDT.prototype.surExecutionQCMContenu=function(event,I){var lPos=I.match(/^([a-z0-9]+)_([a-z0-9]+)_([0-9]+)$/i);var lElement=this.cahierDeTextes.listeContenus.GetElementParNumero(lPos[2]).listeExecutionQCM.GetElement(lPos[3]);this.callback.appel({executionQCM:lElement});};ObjetFicheCDT.prototype.composeTAF=function(){if(!this.matiere.ressources){var I,lNbr,lElt;for(I=0,lNbr=this.listeTAF.GetNbrElements();I<lNbr;I++){lElt=this.listeTAF.GetElement(I);lElt.ResetTri();lElt.AddTri(lElt.PourLe,EGenreType.Date);lElt.AddTri(lElt.Matiere.Libelle);lElt.AddTri(GDate.GetJour(lElt.DonneLe),EGenreType.Date);lElt.AddTri(lElt.Genre);lElt.AddTri(lElt.Libelle);}
this.listeTAF.Trier();}
return this.utilitaireCDT.composeTAF(this.matiere,this.listeTAF,{avecInfoDevoirPersonalise:this.avecInfoDevoirPersonalise,nom:this.Nom});};ObjetFicheCDT.prototype.surPreAffichage=function(){var lElementScroll=$('#'+this.idScroll.escapeJQ());var lHeight=lElementScroll.outerHeight(true);var lWidth=lElementScroll.outerWidth(true);if(lHeight>this.hauteurMax){lElementScroll.height(this.hauteurMax);} else lElementScroll.height(lHeight+1);if(lWidth>this.largeurMax){lElementScroll.width(this.largeurMax);} else lElementScroll.width(lWidth+1);lElementScroll.jScrollPane({showArrows:true});};;
function ObjetVisuEleve(aNom,aIdent,aPere,aEvenement){this.Nom=aNom;this.Pere=aPere;this.Evenement=aEvenement;this.modeProf=false;this.modeVisuQuestion=false;this.idContenu=null;this.numeroExecution=null;this.executionQCM=null;this.indiceQuestion= -1;this.listeQuestions=null;this.question=null;this.nbQuestions=null;this.typeNumerotation=null;this.etatCloture=null;this.start=null;this.affichageEnLigne=null;this.affichageUnePage=null;this.intervalChrono=null;this.evaluationNote=[];this.enActualisation=false;this.idWrapperGlobal=this.Nom+'_WrapperGlobal';this.idWrapperAffichage=this.Nom+'_WrapperAffichage_';this.idValeurChrono=this.Nom+'_ValeurChrono';this.idWrapperBarreProgression=this.Nom+'_WrapperBarreProg';this.idRessenti=this.Nom+'_Ressenti';this.idTexteRessenti=this.Nom+'_TexteRessenti';this.idNbPoint=this.Nom+'_NbPoint_';this.idSlashNbPoint=this.Nom+'_SlashNbPoint_';this.idMp3Question=this.Nom+'_mp3question_';this.idMp3Control=this.Nom+'_control_mp3question_';this.idBoutonNext=this.Nom+'_boutonNext_';this.idBoutonSubmit=this.Nom+'_boutonSubmit_';this.couleurNonVu='White';this.couleurNonRepondu='LightGray';this.couleurValidee='Gray ';this.couleurFaux='#ec636a';this.couleurPartiel='Orange';this.couleurVrai='#9fd647';this.couleurThemeQCM='#62acc5';}
ObjetVisuEleve.prototype.setParametres=function(aObjet){this.idContenu=aObjet.idContenu;this.numeroExecution=aObjet.numeroExecution;this.modeProf=aObjet.modeProf;this.modeVisuQuestion=false;this.executionQCM=null;this.indiceQuestion= -1;this.listeQuestions=null;this.question=null;this.nbQuestions=null;this.typeNumerotation=null;this.etatCloture=null;this.start=null;this.affichageEnLigne=null;this.affichageUnePage=null;clearInterval(this.intervalChrono);this.intervalChrono=null;this.evaluationNote=[];this.enActualisation=false;};ObjetVisuEleve.prototype.actualiser=function(){var lThis;if(this.etatCloture&&$.inArray(this.etatCloture,[TypeEtatExecutionQCMPourRepondant.EQR_EnCours,TypeEtatExecutionQCMPourRepondant.EQR_ARefaire])=== -1&&this.indiceQuestion> -1){if(this.executionQCM.modeDiffusionCorrige===TypeModeCorrectionQCM.FBQ_CorrigeALaFin||this.executionQCM.modeDiffusionCorrige===TypeModeCorrectionQCM.FBQ_CorrigeApresQuestion||(this.executionQCM.estLieADevoir&&this.executionQCM.publierCorrige)){this.composeCorrigeFin();this.indiceQuestion=this.nbQuestions+Number(this.executionQCM.ressentiRepondant)+1;} else if(!this.executionQCM.estLieADevoir){this.composeCorrigeFin(true);} else this.composeCloture();this.formaterLien();this.triggerFinActualisation();return;}
if(!this.affichageEnLigne||$('#'+this.idWrapperAffichage.escapeJQ()+this.indiceQuestion).length===0){if($('#'+this.idWrapperGlobal.escapeJQ()).length===0){this.affichageEnLigne=null;}
var lHtml=[];if(!this.affichageEnLigne){lHtml.push(this.composeOuvertureDivGlobal());}
if(this.executionQCM&&!this.executionQCM.message&&this.estEnInitialisation()&&!this.estEnCloture()){lHtml=lHtml.concat(this.composePageModalite());} else if(this.executionQCM&&!this.executionQCM.message&&this.estEnInitialisation()&&this.estEnCloture()){if(this.executionQCM.estDemarre) lHtml=lHtml.concat(this.composePagePresCorrige());else lHtml=lHtml.concat(this.composePageNonDemarre());} else if(this.executionQCM&&this.estEnCours()&&this.question){this.evaluationNote[this.indiceQuestion]={validee:false};lHtml=lHtml.concat(this.composeAffichageQuestion());} else if(this.executionQCM&&this.executionQCM.message){lHtml.push('<div class="InlineBlock" style="height:100%;vertical-align:middle;"></div><h1 class="InlineBlock" style="vertical-align:middle;text-align:center;font-size:25px;width:99%;border-bottom:',GCouleur.fond,' 1px solid;margin:10px auto 100px;">'+this.executionQCM.message+'</h1>');} else if(this.executionQCM&&this.estEnRessenti()){lHtml=lHtml.concat(this.composeAffichageRessenti());} else if(this.executionQCM&&this.indiceQuestion>=this.nbQuestions){lHtml=lHtml.concat(this.composeAffichageFin());this.interdireFermetureInterface();}
if(!this.affichageEnLigne){lHtml.push(this.composeFermetureDivGlobal());}
var lAsymetrie=false;if(this.question&&this.question.GetGenre()===TypeGenreExerciceDeQuestionnaire.GEQ_Matching){var lReponses=[];var i,lNbr,lReponse;for(i=0,lNbr=this.question.listeReponses.GetNbrElements();i<lNbr;i++){lReponse=this.question.listeReponses.GetElement(i);if($.inArray(lReponse.association,lReponses)=== -1){lReponses.push(lReponse.association);} else{lAsymetrie=true;break;}}}
if(!this.affichageEnLigne){$('#'+this.idContenu).html(lHtml.join(''));if(this.executionQCM.autoriserLaNavigation) this.ajouterEvenementBarreProgression();$('#'+this.idContenu).find(':checkbox, :radio').jIECheckBox();this.ajouterEvenementQuestion(lAsymetrie);if(this.question&&this.question.reponsesRepondant&&this.question.reponsesRepondant.length>0){this.triggerFinActualisation();this.majReponsesRepondant();this.formaterLien();this.triggerFinActualisation();if(this.executionQCM.modeDiffusionCorrige===TypeModeCorrectionQCM.FBQ_CorrigeApresQuestion) this.composeCorrige();}
lThis=this;$('[id^="'+this.Nom.escapeJQ()+'_q'+this.indiceQuestion+'_div_r"]').each(function(){lThis.actualiserHauteurReponse(this.id);});var lJqImg=$('#'+this.idWrapperAffichage.escapeJQ()+this.indiceQuestion).find('img');if(lJqImg.length) lJqImg.load(this.actualiserHauteurQuestion.bind(this,this.indiceQuestion));else this.actualiserHauteurQuestion();this.majChrono();$('#'+this.idWrapperAffichage.escapeJQ()+this.indiceQuestion).find('div[id^="'+this.idMp3Control.escapeJQ()+'"]').on('click',{lThis:this},this.playMp3);$('#'+this.idWrapperAffichage.escapeJQ()+this.indiceQuestion).find('audio[id^="'+this.idMp3Question.escapeJQ()+'"]').on('ended',function(){$('#'+this.id.replace('_mp3question_','_control_mp3question_').escapeJQ()).trigger('click');});this.formaterLien();this.triggerFinActualisation();this.enActualisation=false;} else{lThis=this;$('#'+this.idWrapperGlobal.escapeJQ()).find('[id^="'+this.idWrapperAffichage.escapeJQ()+'"]:visible').fadeOut(200,function(){$('#'+lThis.idWrapperGlobal.escapeJQ()).append(lHtml.join('')).find(':checkbox, :radio').jIECheckBox();lThis.ajouterEvenementQuestion(lAsymetrie);if(lThis.question&&lThis.question.reponsesRepondant&&lThis.question.reponsesRepondant.length>0){lThis.triggerFinActualisation();lThis.majReponsesRepondant();lThis.formaterLien();lThis.triggerFinActualisation();if(lThis.executionQCM.modeDiffusionCorrige===TypeModeCorrectionQCM.FBQ_CorrigeApresQuestion) lThis.composeCorrige();}
$('#'+lThis.idWrapperAffichage.escapeJQ()+lThis.indiceQuestion).hide().fadeIn(200);lThis.composeBarreProgression();$('[id^="'+lThis.Nom.escapeJQ()+'_q'+lThis.indiceQuestion+'_div_r"]').each(function(){lThis.actualiserHauteurReponse(this.id);});var lJqImg=$('#'+lThis.idWrapperAffichage.escapeJQ()+lThis.indiceQuestion).find('img');if(lJqImg.length) lJqImg.load(lThis.actualiserHauteurQuestion.bind(lThis,lThis.indiceQuestion));else lThis.actualiserHauteurQuestion();$('#'+lThis.idWrapperAffichage.escapeJQ()+lThis.indiceQuestion).find('div[id^="'+lThis.idMp3Control.escapeJQ()+'"]').on('click',{lThis:lThis},lThis.playMp3);$('#'+lThis.idWrapperAffichage.escapeJQ()+lThis.indiceQuestion).find('audio[id^="'+lThis.idMp3Question.escapeJQ()+'"]').on('ended',function(){$('#'+this.id.replace('_mp3question_','_control_mp3question_').escapeJQ()).trigger('click');});lThis.formaterLien();lThis.triggerFinActualisation();lThis.enActualisation=false;if(lThis.estEnCours()&&lThis.executionQCM.dureeMaxQCM) lThis.majChrono();});}
if(this.affichageEnLigne===null){this.affichageEnLigne=this.executionQCM&&this.executionQCM.autoriserLaNavigation&&!this.executionQCM.message;}} else{lThis=this;$('#'+this.idWrapperGlobal.escapeJQ()).find('[id^="'+this.idWrapperAffichage.escapeJQ()+'"]:visible').fadeOut(100,function(){$('#'+lThis.idWrapperAffichage.escapeJQ()+lThis.indiceQuestion).fadeIn(100);lThis.composeBarreProgression();lThis.actualiserHauteurQuestion();lThis.formaterLien();lThis.triggerFinActualisation();lThis.enActualisation=false;});}
if(this.estEnCours()&&this.executionQCM.dureeMaxQCM){this.majChrono();if(!this.intervalChrono) this.intervalChrono=setInterval(this.majChrono.bind(this),5000);} else if(this.intervalChrono&&!this.estEnCours()){clearInterval(this.intervalChrono);}};ObjetVisuEleve.prototype.playMp3=function(aEvent){aEvent.stopImmediatePropagation();if(!$(this).data('play')){$('#'+this.id.replace(/_control/,'').escapeJQ()).get(0).play();$(this).children('span').removeClass('Image_QCM_Son_Play').addClass('Image_QCM_Son_Pause');$(this).data('play',true);} else{$('#'+this.id.replace(/_control/,'').escapeJQ()).get(0).pause();$(this).children('span').removeClass('Image_QCM_Son_Pause').addClass('Image_QCM_Son_Play');$(this).data('play',false);}};ObjetVisuEleve.prototype.triggerFinActualisation=function(){;};ObjetVisuEleve.prototype.composeOuvertureDivGlobal=function(){;return'';};ObjetVisuEleve.prototype.composeFermetureDivGlobal=function(){;return'';};ObjetVisuEleve.prototype.composeTitre=function(){;return'';};ObjetVisuEleve.prototype.composeAffichageQuestion=function(){;return[];};ObjetVisuEleve.prototype.ajouterEvenementQuestion=function(aAsymetrie){if(this.executionQCM&&this.estEnCours()&&this.question&&this.question.GetGenre()===TypeGenreExerciceDeQuestionnaire.GEQ_Matching){this.ajouterEvenementMatching(aAsymetrie);} else if(this.executionQCM&&this.estEnCours()&&this.question&&(this.question.GetGenre()===TypeGenreExerciceDeQuestionnaire.GEQ_SingleChoice||this.question.GetGenre()===TypeGenreExerciceDeQuestionnaire.GEQ_MultiChoice)){this.ajouterEvenementSingleMultiChoice();} else if(this.executionQCM&&this.estEnRessenti()){this.ajouterEvenementRessenti();}};ObjetVisuEleve.prototype.ajouterEvenementMatching=function(aAsymetrie){;};ObjetVisuEleve.prototype.ajouterEvenementSingleMultiChoice=function(){;};ObjetVisuEleve.prototype.composeAffichageRessenti=function(){;return[];};ObjetVisuEleve.prototype.ajouterEvenementRessentiEtoile=function(){$('span[id^="'+this.idRessenti.escapeJQ()+'"]').on('mouseenter',{aObjet:this},function(aEvent){var lThis=aEvent.data.aObjet;var lRessentiTmp=this.id.match(/_([0-9]+)/i)[1];$(this).prevAll().addBack().removeClass('Image_QCM_Etoile_Off').addClass('Image_QCM_Etoile_On').end().end().nextAll().removeClass('Image_QCM_Etoile_On').addClass('Image_QCM_Etoile_Off');$('span#'+lThis.idTexteRessenti.escapeJQ()).text(GTraductions.getValeur('ExecutionQCM.valeurRessenti')[lRessentiTmp-1]);}).on('mouseleave',{aObjet:this},function(aEvent){var lThis=aEvent.data.aObjet;$(this).siblings().addBack().removeClass('Image_QCM_Etoile_On').addClass('Image_QCM_Etoile_Off');$('span#'+lThis.idTexteRessenti.escapeJQ()).text('');if(lThis.ressenti>0){$('span#'+lThis.idRessenti.escapeJQ()+'_'+lThis.ressenti).prevAll().addBack().removeClass('Image_QCM_Etoile_Off').addClass('Image_QCM_Etoile_On');$('span#'+lThis.idTexteRessenti.escapeJQ()).text(GTraductions.getValeur('ExecutionQCM.valeurRessenti')[lThis.ressenti-1]);}}).on('click',{aObjet:this},function(aEvent){var lThis=aEvent.data.aObjet;var lRessenti=this.id.match(/_([0-9]+)/i)[1];lThis.ressenti=parseInt(lRessenti);$('#'+lThis.idBoutonSubmit.escapeJQ()+lThis.indiceQuestion).show();});};ObjetVisuEleve.prototype.ajouterEvenementRessenti=function(){$('span[id^="'+this.idRessenti.escapeJQ()+'"]').on('mouseenter',{aObjet:this},function(aEvent){$(this).css({color:GCouleur.noir}).siblings('span').css({color:GCouleur.grisClair});}).on('mouseleave',{aObjet:this},function(aEvent){var lThis=aEvent.data.aObjet;$(this).siblings('span').addBack().css({color:GCouleur.grisClair});if(lThis.ressentiSelectionne){$('span#'+lThis.idRessenti.escapeJQ()+'_'+lThis.ressenti).css({color:GCouleur.noir});}}).on('click',{aObjet:this},function(aEvent){var lThis=aEvent.data.aObjet;lThis.ressentiSelectionne=true;var lRessenti=this.id.match(/_([0-9]+)/i)[1];lThis.ressenti=parseInt(lRessenti);$('#'+lThis.idBoutonSubmit.escapeJQ()+lThis.nbQuestions).show();});};ObjetVisuEleve.prototype.composeAffichageFin=function(){;return[];};ObjetVisuEleve.prototype.composePageNonDemarre=function(){;return[];};ObjetVisuEleve.prototype.composeCloture=function(){;return[];};ObjetVisuEleve.prototype.formaterLien=function(){$('#'+this.idContenu).find('a[href]').each(function(){var lUrl=$(this).attr('href');if(lUrl.search(/^(ht|f)tp/gi)!==0){lUrl='http://'+lUrl;$(this).prop('href',lUrl);}});};ObjetVisuEleve.prototype.composeCorrigeFin=function(aSansCorrige){this.affichageUnePage=true;$('#'+this.idContenu).html('');var lHtml=[];lHtml=lHtml.concat(this.composeAffichageCorrigeFin());$('#'+this.idContenu).html(lHtml.join('')).find(':checkbox, :radio').jIECheckBox();this.formaterLien();this.triggerFinActualisation();this.nbImages=$('#'+this.idContenu).find('img').length;var lThis=this;$('[id^="'+this.idWrapperAffichage+'"]').each(function(){var lJqImg=$(this).find('img');if(lJqImg.length){var lId=parseInt(this.id.slice(lThis.idWrapperAffichage.length));lJqImg.load(lThis.actualiserHauteurQuestion.bind(lThis,lId));}});var lBackupIndice=this.indiceQuestion;var aIndice,aNbr;aNbr=this.listeQuestions?this.listeQuestions.GetNbrElements():0;for(aIndice=0;aIndice<aNbr;aIndice++){this.indiceQuestion=aIndice;this.question=this.listeQuestions.GetElement(aIndice);var lAsymetrie=false;if(this.question&&this.question.GetGenre()===TypeGenreExerciceDeQuestionnaire.GEQ_Matching){var lReponses=[];var i,lNbr,lReponse;for(i=0,lNbr=this.question.listeReponses.GetNbrElements();i<lNbr;i++){lReponse=this.question.listeReponses.GetElement(i);if($.inArray(lReponse.association,lReponses)=== -1){lReponses.push(lReponse.association);} else{lAsymetrie=true;break;}}}
this.ajouterEvenementQuestion(lAsymetrie);this.majReponsesRepondant();if(!aSansCorrige) this.composeCorrige();else this.desactiveEvent();}
this.indiceQuestion=lBackupIndice;$('[id^="'+this.idWrapperAffichage+'"]').find('div[id^="'+this.idMp3Control.escapeJQ()+'"]').on('click',{lThis:this},this.playMp3);$('[id^="'+this.idWrapperAffichage+'"]').find('audio[id^="'+this.idMp3Question.escapeJQ()+'"]').on('ended',function(){$('#'+this.id.replace('_mp3question_','_control_mp3question_').escapeJQ()).trigger('click');});this.actualiserHauteurCorrige();this.enActualisation=false;this.autoriserFermetureInterface();};ObjetVisuEleve.prototype.autoriserFermetureInterface=function(){;};ObjetVisuEleve.prototype.interdireFermetureInterface=function(){;};ObjetVisuEleve.prototype.composeAffichageCorrigeFin=function(){;return[];};ObjetVisuEleve.prototype.actualiserHauteurCorrige=function(){;};ObjetVisuEleve.prototype.actualiserHauteurQuestion=function(){;};ObjetVisuEleve.prototype.actualiserHauteurReponse=function(){;};ObjetVisuEleve.prototype.composePageModalite=function(){;return[];};ObjetVisuEleve.prototype.composePagePresCorrige=function(){;return[];};ObjetVisuEleve.prototype.composeChrono=function(){;return[];};ObjetVisuEleve.prototype.majChrono=function(){if($('#'+this.idValeurChrono.escapeJQ()).length===0&&this.intervalChrono){clearInterval(this.intervalChrono);return;}
if(!this.executionQCM.dureeMaxQCM) return;var lMinRestantes=this.getMinutesChrono(),lTextTime=lMinRestantes,lLibelleTime=GTraductions.getValeur('ExecutionQCM.MinutesCourt');if(lMinRestantes<1){lTextTime='&lt; 1';if(this.getMilliSecondesChrono()/1000<=30){lTextTime='&lt; 30';lLibelleTime=GTraductions.getValeur('ExecutionQCM.SecondesCourt');}}
this.composeMajChrono(lTextTime,lLibelleTime);};ObjetVisuEleve.prototype.composeMajChrono=function(aTextTime,aLibelleTime){;};ObjetVisuEleve.prototype.getMinutesChrono=function(){var lSecRestantes=this.getMilliSecondesChrono(),lTpsRestant=new Date(lSecRestantes>0?lSecRestantes:0),lMinutes=lTpsRestant.getUTCHours()*60+lTpsRestant.getUTCMinutes();return lMinutes;};ObjetVisuEleve.prototype.getMilliSecondesChrono=function(){var lSecRestantes=new Date(0).setUTCMinutes(this.executionQCM.dureeMaxQCM)-(new Date().getTime()-this.start);return lSecRestantes;};ObjetVisuEleve.prototype.composeBarreProgression=function(){var lHtml=[];lHtml=lHtml.concat(this.composeAffichageBarreProgression());if(this.affichageEnLigne){$('#'+this.idWrapperBarreProgression.escapeJQ()).html(lHtml.join(''));this.composeMiseEnFormeBarreProgression();}
return lHtml;};ObjetVisuEleve.prototype.composeAffichageBarreProgression=function(){;return[];};ObjetVisuEleve.prototype.composeMiseEnFormeBarreProgression=function(){;};ObjetVisuEleve.prototype.getCouleurPointProgression=function(aIndice){var lBackColor=this.couleurNonVu;if(this.evaluationNote[aIndice]){if(this.evaluationNote[aIndice].nbBonnesReponses&&this.evaluationNote[aIndice].nbReponsesJustes>=0){if(this.evaluationNote[aIndice].nbReponsesJustes===0) lBackColor=this.couleurFaux;else if(this.evaluationNote[aIndice].nbReponsesJustes===this.evaluationNote[aIndice].nbBonnesReponses) lBackColor=this.couleurVrai;else if(this.evaluationNote[aIndice].nbReponsesJustes<this.evaluationNote[aIndice].nbBonnesReponses) lBackColor=this.couleurPartiel;} else if(this.evaluationNote[aIndice].validee) lBackColor=this.couleurValidee;else lBackColor=this.couleurNonRepondu;}
return lBackColor;};ObjetVisuEleve.prototype.ajouterEvenementBarreProgression=function(){;};ObjetVisuEleve.prototype.composeRessentiEtoile=function(){;return[];};ObjetVisuEleve.prototype.composeRessenti=function(){;return[];};ObjetVisuEleve.prototype.composeNavigation=function(){;return[];};ObjetVisuEleve.prototype.composeCorrige=function(){if(this.question.GetGenre()===TypeGenreExerciceDeQuestionnaire.GEQ_SingleChoice||this.question.GetGenre()===TypeGenreExerciceDeQuestionnaire.GEQ_MultiChoice){this.composeCorrigeSingleMulti();} else if(this.question.GetGenre()===TypeGenreExerciceDeQuestionnaire.GEQ_NumericalAnswer){this.composeCorrigeNumerique();} else if(this.question.GetGenre()===TypeGenreExerciceDeQuestionnaire.GEQ_ShortAnswer){this.composeCorrigeShort();} else if(this.question.GetGenre()===TypeGenreExerciceDeQuestionnaire.GEQ_SpellAnswer){this.composeCorrigeSpell();} else if(this.question.GetGenre()===TypeGenreExerciceDeQuestionnaire.GEQ_Matching){this.composeCorrigeMatching();} else if(this.question.GetGenre()===TypeGenreExerciceDeQuestionnaire.GEQ_ClozeField||this.question.GetGenre()===TypeGenreExerciceDeQuestionnaire.GEQ_ClozeFixed||this.question.GetGenre()===TypeGenreExerciceDeQuestionnaire.GEQ_ClozeVariable){this.composeCorrigeCloze();}
if(this.question.noteEleve&&this.executionQCM.modeQuestionnaire===TypeModeQuestionnaire.MQZ_NoteSans){$('#'+this.idNbPoint.escapeJQ()+this.indiceQuestion).html((this.question.qualif===TypeQualificatifReponse.qrBonne?GTraductions.getValeur('ExecutionQCM.BonneReponse')+'&nbsp;':'')+'<span class="InlineBlock '+(this.question.qualif===TypeQualificatifReponse.qrBonne?'Image_QCM_PastilleBonne':this.question.qualif===TypeQualificatifReponse.qrBonnePartielle?'Image_QCM_PastillePartielle':this.question.qualif===TypeQualificatifReponse.qrFausse?'Image_QCM_PastilleFausse':'')+'">&nbsp;</span>').css({color:this.question.qualif===TypeQualificatifReponse.qrBonne?this.couleurVrai:this.question.qualif===TypeQualificatifReponse.qrBonnePartielle?this.couleurPartiel:this.couleurFaux}).show();} else if(this.question.noteEleve){$('#'+this.idNbPoint.escapeJQ()+this.indiceQuestion).html((this.question.qualif===TypeQualificatifReponse.qrBonne?GTraductions.getValeur('ExecutionQCM.BonneReponse')+'&nbsp;':'')+
this.question.noteEleve.toString()).css({color:this.question.qualif===TypeQualificatifReponse.qrBonne?this.couleurVrai:this.question.qualif===TypeQualificatifReponse.qrBonnePartielle?this.couleurPartiel:this.couleurFaux}).show();$('#'+this.idSlashNbPoint.escapeJQ()+this.indiceQuestion).show();} else if(this.evaluationNote[this.indiceQuestion].nbBonnesReponses===this.evaluationNote[this.indiceQuestion].nbReponsesJustes){$('#'+this.idNbPoint.escapeJQ()+this.indiceQuestion).html(GTraductions.getValeur('ExecutionQCM.BonneReponse')+'&nbsp;').css({color:this.couleurVrai}).show();}
this.formaterLien();this.triggerFinActualisation();this.actualiserHauteurQuestion();$('#'+this.idBoutonNext.escapeJQ()+this.indiceQuestion).show();$('#'+this.idBoutonSubmit.escapeJQ()+this.indiceQuestion).hide();};ObjetVisuEleve.prototype.composeCorrigeSingleMulti=function(){this.evaluationNote[this.indiceQuestion]={nbBonnesReponses:this.question.listeReponses.getListeElements(function(aEle){return aEle.bonneReponse;}).GetNbrElements(),nbReponsesJustes:0};var lThis=this,lForcerFaux=false;$('[id^="'+this.Nom+'_q'+this.indiceQuestion+'_r"]:checked').each(function(){var lIndice=this.id.match(/_r([0-9]+)$/i)[1];var lReponse=lThis.question.listeReponses.GetElement(lIndice);if(lReponse.bonneReponse){lThis.evaluationNote[lThis.indiceQuestion].nbReponsesJustes+=1;} else{lForcerFaux=true;}});if(!this.executionQCM.acceptIncomplet&&this.evaluationNote[this.indiceQuestion].nbReponsesJustes!==this.evaluationNote[this.indiceQuestion].nbBonnesReponses) this.evaluationNote[this.indiceQuestion].nbReponsesJustes=0;if(!this.executionQCM.tolererFausses&&lForcerFaux) this.evaluationNote[this.indiceQuestion].nbReponsesJustes=0;for(var i=0;i<this.question.listeReponses.GetNbrElements();i++){if(!$('[id="'+this.Nom+'_q'+this.indiceQuestion+'_r'+i+'"]').is(':checked')){var lReponse=this.question.listeReponses.GetElement(i);if(lReponse.bonneReponse){this.composeAffichageCorrigeSingleMultiVraiNonCoche('[id="'+this.Nom+'_q'+this.indiceQuestion+'_r'+i+'"]');} else if(this.evaluationNote[this.indiceQuestion].nbReponsesJustes!==this.evaluationNote[this.indiceQuestion].nbBonnesReponses){this.composeAffichageCorrigeSingleMultiFauxNonCoche('[id="'+this.Nom+'_q'+this.indiceQuestion+'_r'+i+'"]');}}}
$('[id^="'+this.Nom+'_q'+this.indiceQuestion+'_r"]:checked').each(function(){var lIndice=this.id.match(/_r([0-9]+)$/i)[1];var lReponse=lThis.question.listeReponses.GetElement(lIndice);if(lThis.evaluationNote[lThis.indiceQuestion].nbReponsesJustes!==lThis.evaluationNote[lThis.indiceQuestion].nbBonnesReponses){if(lReponse.bonneReponse){lThis.composeAffichageCorrigeSingleMultiVraiCoche(this);} else{lThis.composeAffichageCorrigeSingleMultiFauxCoche(this);}} else{if(lReponse.bonneReponse){lThis.composeAffichageCorrigeSingleMultiVraiCoche(this,true);}}
if(lReponse.feedback) lThis.composeAffichageCorrigeSingleMultiFeedback('[id="'+lThis.Nom+'_q'+lThis.indiceQuestion+'_r'+lIndice+'"]',(lReponse.bonneReponse?lThis.couleurVrai:lThis.couleurFaux),lReponse.feedback);});this.desactiveEventSingleMulti();};ObjetVisuEleve.prototype.composeAffichageCorrigeSingleMultiVraiCoche=function(aSelecteur){;};ObjetVisuEleve.prototype.composeAffichageCorrigeSingleMultiVraiNonCoche=function(aSelecteur){;};ObjetVisuEleve.prototype.composeAffichageCorrigeSingleMultiFauxCoche=function(aSelecteur){;};ObjetVisuEleve.prototype.composeAffichageCorrigeSingleMultiFauxNonCoche=function(aSelecteur){;};ObjetVisuEleve.prototype.composeAffichageCorrigeSingleMultiFeedback=function(aSelecteur,aCouleur,aFeedback){;};ObjetVisuEleve.prototype.desactiveEventSingleMulti=function(){;};ObjetVisuEleve.prototype.composeCorrigeShort=function(){this.evaluationNote[this.indiceQuestion]={nbBonnesReponses:1,nbReponsesJustes:0};var lJqInput=$('#'+this.Nom.escapeJQ()+'_q'+this.indiceQuestion+'_r0');var lReponse=GChaine.ajouterEntites(lJqInput.val());lReponse=lReponse.replace(/^\s+/,'').replace(/\s+$/,'').replace(/\s+/gi,' ');if(!this.question.casesensitive) lReponse=GChaine.latinize(lReponse).toLowerCase();var lBonneReponses=!this.question.casesensitive?this.question.listeReponses.getListeElements(function(aEle){return GChaine.latinize(aEle.GetLibelle()).toLowerCase()===lReponse;}):this.question.listeReponses.getListeElements(function(aEle){return aEle.GetLibelle()===lReponse;});if(lBonneReponses.GetNbrElements()){this.evaluationNote[this.indiceQuestion].nbReponsesJustes=1;this.composeAffichageCorrigeShortVrai(lJqInput.get(0));if(lBonneReponses.GetElement(0).feedback) this.composeAffichageCorrigeShortFeedback(lJqInput.get(0),this.couleurVrai,lBonneReponses.GetElement(0).feedback);} else{this.composeAffichageCorrigeShortFaux(lJqInput.get(0),this.question.listeReponses.GetElement(0).GetLibelle());}
this.desactiveEventShort();};ObjetVisuEleve.prototype.composeCorrigeSpell=function(){this.evaluationNote[this.indiceQuestion]={nbBonnesReponses:1,nbReponsesJustes:0};var lJqInput=$('[name="'+this.Nom.escapeJQ()+'_q'+this.indiceQuestion+'_r"]');var lReponse='';lJqInput.each(function(){lReponse+=$(this).val();});lReponse=GChaine.ajouterEntites(lReponse);lReponse=lReponse.replace(/^\s+/,'').replace(/\s+$/,'').replace(/\s+/gi,' ');if(!this.question.casesensitive) lReponse=GChaine.latinize(lReponse).toLowerCase();var lBonneReponses=!this.question.casesensitive?this.question.listeReponses.getListeElements(function(aEle){return GChaine.latinize(aEle.GetLibelle()).toLowerCase()===lReponse;}):this.question.listeReponses.getListeElements(function(aEle){return aEle.GetLibelle()===lReponse;});if(lBonneReponses.GetNbrElements()){this.evaluationNote[this.indiceQuestion].nbReponsesJustes=1;this.composeAffichageCorrigeSpellVrai('[name="'+this.Nom.escapeJQ()+'_q'+this.indiceQuestion+'_r"]');if(lBonneReponses.GetElement(0).feedback) this.composeAffichageCorrigeSpellFeedback('[name="'+this.Nom.escapeJQ()+'_q'+this.indiceQuestion+'_r"]',this.couleurVrai,lBonneReponses.GetElement(0).feedback);} else{this.composeAffichageCorrigeSpellFaux('[name="'+this.Nom.escapeJQ()+'_q'+this.indiceQuestion+'_r"]',this.question.listeReponses.GetElement(0).GetLibelle());}
this.desactiveEventSpell();};ObjetVisuEleve.prototype.composeCorrigeNumerique=function(){this.evaluationNote[this.indiceQuestion]={nbBonnesReponses:1,nbReponsesJustes:0};var lJqInput=$('#'+this.Nom.escapeJQ()+'_q'+this.indiceQuestion+'_r0');var lReponse=lJqInput.val();lReponse=lReponse.replace(/\s+/gi,'');lReponse=lReponse.replace(/\./,',').replace(/٫/gi,',').replace(/²/gi,'2').replace(/³/gi,'3');lReponse=GChaine.latinize(lReponse).toLowerCase();lReponse=GChaine.ajouterEntites(lReponse);var lBonneReponses=this.question.listeReponses.getListeElements(function(aEle){return GChaine.latinize(aEle.GetLibelle().replace(/\s+/gi,'').replace(/\./,',').replace(/٫/gi,',').replace(/²/gi,'2').replace(/³/gi,'3')).toLowerCase()===lReponse;});if(lBonneReponses.GetNbrElements()){this.evaluationNote[this.indiceQuestion].nbReponsesJustes=1;this.composeAffichageCorrigeShortVrai(lJqInput.get(0));if(lBonneReponses.GetElement(0).feedback) this.composeAffichageCorrigeShortFeedback(lJqInput.get(0),this.couleurVrai,lBonneReponses.GetElement(0).feedback);} else{this.composeAffichageCorrigeShortFaux(lJqInput.get(0),this.question.listeReponses.GetElement(0).GetLibelle());}
this.desactiveEventShort();};ObjetVisuEleve.prototype.composeAffichageCorrigeShortVrai=function(aSelecteur){;};ObjetVisuEleve.prototype.composeAffichageCorrigeShortFaux=function(aSelecteur,aBonneReponse){;};ObjetVisuEleve.prototype.composeAffichageCorrigeShortFeedback=function(aSelecteur,aCouleur,aFeedback){;};ObjetVisuEleve.prototype.desactiveEventShort=function(){;};ObjetVisuEleve.prototype.composeAffichageCorrigeSpellVrai=function(aSelecteur){;};ObjetVisuEleve.prototype.composeAffichageCorrigeSpellFaux=function(aSelecteur){;};ObjetVisuEleve.prototype.composeAffichageCorrigeSpellFeedback=function(aSelecteur,aCouleur,aFeedback){;};ObjetVisuEleve.prototype.desactiveEventSpell=function(){;};ObjetVisuEleve.prototype.composeCorrigeMatching=function(){this.evaluationNote[this.indiceQuestion]={nbBonnesReponses:this.question.listeReponses.GetNbrElements(),nbReponsesJustes:0};var lAsymetrie=false;var lReponses=[];var i,lNbr,lReponse;for(i=0,lNbr=this.question.listeReponses.GetNbrElements();i<lNbr;i++){lReponse=this.question.listeReponses.GetElement(i);if($.inArray(lReponse.association,lReponses)=== -1){lReponses.push(lReponse.association);} else{lAsymetrie=true;break;}}
var lThis=this;this.composeMiseEnFormeCorrigeMatching(lAsymetrie);$('[id^="'+this.Nom+'_q'+this.indiceQuestion+'_drop"]').each(function(){var lIndice=this.id.match(/_drop([0-9]+)$/i)[1];var lReponse=lThis.getReponseMatching(this);lReponse=GChaine.ajouterEntites(lReponse);var lBonneReponse=lThis.question.listeReponses.GetElement(lIndice).bonneReponse;if(lBonneReponse===lReponse) lThis.evaluationNote[lThis.indiceQuestion].nbReponsesJustes+=1;lThis.composeAffichageReponseCorrigeMatching(this,lReponse!=='',lBonneReponse===lReponse?lThis.couleurVrai:lThis.couleurFaux);lThis.composeCorrigeReponseCorrigeMatching('#'+lThis.idWrapperAffichage.escapeJQ()+lThis.indiceQuestion+' .objetVisuEleveAssocCorriges',lThis.Nom+'_q'+lThis.indiceQuestion+'_c'+lIndice,lBonneReponse===lReponse,lBonneReponse,lBonneReponse===lReponse?lThis.couleurVrai:lThis.couleurFaux);lThis.composeMiseEnFormeCorrigeReponseCorrigeMatching(this);});this.desactiveEventMatching(lAsymetrie);};ObjetVisuEleve.prototype.composeMiseEnFormeCorrigeMatching=function(){;};ObjetVisuEleve.prototype.composeAffichageReponseCorrigeMatching=function(aSelecteur,aAvecReponse,aCouleur){;};ObjetVisuEleve.prototype.composeCorrigeReponseCorrigeMatching=function(aSelecteur,aId,aBonneReponse,aCorrige,aCouleur){;};ObjetVisuEleve.prototype.composeMiseEnFormeCorrigeReponseCorrigeMatching=function(aSelecteur){;};ObjetVisuEleve.prototype.desactiveEventMatching=function(){;};ObjetVisuEleve.prototype.composeCorrigeCloze=function(){var lEnonceOriginel=this.question.enonceOriginel.replace(/&#039;/gi,'&apos;');var lReponses=lEnonceOriginel.match(/({[0-9]*:(?:ShortAnswer|MultiChoice):(?:~*(?:%[0-9]{1,3}%|=)?[^~%#{}]+#[^~%#{}]*)+})/gi);if(this.question.casesensitive===false) lReponses=$.map(lReponses,function(aEle){return GChaine.latinize(aEle.toLowerCase());});var lReponsesJustes=[];this.evaluationNote[this.indiceQuestion]={nbBonnesReponses:lReponses.length,nbReponsesJustes:0};var lThis=this;$('#'+this.idWrapperEnonce.escapeJQ()+this.indiceQuestion).find('select, input[type="text"]').each(function(aIndex){var lReponse=$(this).val();if($(this).is('input')) lReponse=lReponse.replace(/^\s+/,'').replace(/\s+$/,'').replace(/\s+/gi,' ');var lValRep=false;if(lThis.question.casesensitive===false) lValRep=lReponses[aIndex].match(new RegExp('(?::|~)(%[0-9]{1,3}%|=)?'+GChaine.latinize(lReponse.replace(/(\(|\)|\[|\]|\+|\*|\.|\^|\$|\?|\\|\{|\}|\|)/g,'\\$1')).toLowerCase()+'(#|~)',''));else lValRep=lReponses[aIndex].match(new RegExp('(?::|~)(%[0-9]{1,3}%|=)?'+lReponse.replace(/(\(|\)|\[|\]|\+|\*|\.|\^|\$|\?|\\|\{|\}|\|)/g,'\\$1')+'(#|~)',''));lValRep=lValRep&&lValRep[1]?lValRep[1].replace(/%/gi,'').replace('=','100'):'0';if(parseInt(lValRep)===100){lThis.evaluationNote[lThis.indiceQuestion].nbReponsesJustes+=1;lReponsesJustes[aIndex]=1;}
lThis.composeMiseEnFormeReponseCorrigeCloze(this,parseInt(lValRep)===100?'black':lThis.couleurFaux,lReponse);});if(this.evaluationNote[this.indiceQuestion].nbBonnesReponses!==this.evaluationNote[this.indiceQuestion].nbReponsesJustes){this.composeMiseEnFormeWrapperEnonceCloze('#'+this.idWrapperEnonce.escapeJQ()+this.indiceQuestion);var lInc=0;this.composeMiseEnFormeWrapperCorrigeCloze('#'+this.idWrapperEnonce.escapeJQ()+this.indiceQuestion,GChaine.ToHTML(lEnonceOriginel).replace(/({[0-9]*:(ShortAnswer|MultiChoice):.*?(~*(?:%100%|=)([^~%#{}]+)#[^~%#{}]*).*?})/gi,function(aMatch,aA,aB,aC,aD){return lThis.composeMiseEnFormeCorrectionCorrigeCloze(aD,(lReponsesJustes[lInc++]===1?'':'color:'+lThis.couleurFaux+';')+'font-weight:bold;');}));}
this.actualiserHauteurQuestion();};ObjetVisuEleve.prototype.composeMiseEnFormeReponseCorrigeCloze=function(aSelecteur,aCouleur,aTexte){;};ObjetVisuEleve.prototype.composeMiseEnFormeWrapperEnonceCloze=function(aSelecteur){;};ObjetVisuEleve.prototype.composeMiseEnFormeWrapperCorrigeCloze=function(aSelecteur,aTexte){;};ObjetVisuEleve.prototype.composeMiseEnFormeCorrectionCorrigeCloze=function(aTexte,aStyle){;return'';};ObjetVisuEleve.prototype.desactiveEventCloze=function(){;};ObjetVisuEleve.prototype.majReponsesRepondant=function(){if(this.question.GetGenre()===TypeGenreExerciceDeQuestionnaire.GEQ_SingleChoice||this.question.GetGenre()===TypeGenreExerciceDeQuestionnaire.GEQ_MultiChoice){this.majReponsesSingleMulti();} else if(this.question.GetGenre()===TypeGenreExerciceDeQuestionnaire.GEQ_ShortAnswer||this.question.GetGenre()===TypeGenreExerciceDeQuestionnaire.GEQ_NumericalAnswer){this.majReponsesShort();} else if(this.question.GetGenre()===TypeGenreExerciceDeQuestionnaire.GEQ_SpellAnswer){this.majReponsesSpell();} else if(this.question.GetGenre()===TypeGenreExerciceDeQuestionnaire.GEQ_Matching){this.majReponsesMatching();} else if(this.question.GetGenre()===TypeGenreExerciceDeQuestionnaire.GEQ_ClozeField||this.question.GetGenre()===TypeGenreExerciceDeQuestionnaire.GEQ_ClozeFixed||this.question.GetGenre()===TypeGenreExerciceDeQuestionnaire.GEQ_ClozeVariable){this.majReponsesCloze();}
$('#'+this.idBoutonNext.escapeJQ()+this.indiceQuestion).show();};ObjetVisuEleve.prototype.desactiveEvent=function(){if(this.question.GetGenre()===TypeGenreExerciceDeQuestionnaire.GEQ_SingleChoice||this.question.GetGenre()===TypeGenreExerciceDeQuestionnaire.GEQ_MultiChoice){this.desactiveEventSingleMulti();} else if(this.question.GetGenre()===TypeGenreExerciceDeQuestionnaire.GEQ_ShortAnswer||this.question.GetGenre()===TypeGenreExerciceDeQuestionnaire.GEQ_NumericalAnswer){this.desactiveEventShort();} else if(this.question.GetGenre()===TypeGenreExerciceDeQuestionnaire.GEQ_SpellAnswer){this.desactiveEventSpell();} else if(this.question.GetGenre()===TypeGenreExerciceDeQuestionnaire.GEQ_Matching){var lAsymetrie=false;var lReponses=[];for(var i=0;i<this.question.listeReponses.GetNbrElements();i++){var lReponse=this.question.listeReponses.GetElement(i);if($.inArray(lReponse.association,lReponses)=== -1){lReponses.push(lReponse.association);} else{lAsymetrie=true;break;}}
this.desactiveEventMatching(lAsymetrie);} else if(this.question.GetGenre()===TypeGenreExerciceDeQuestionnaire.GEQ_ClozeField||this.question.GetGenre()===TypeGenreExerciceDeQuestionnaire.GEQ_ClozeFixed||this.question.GetGenre()===TypeGenreExerciceDeQuestionnaire.GEQ_ClozeVariable){this.desactiveEventCloze();}
$('#'+this.idBoutonNext.escapeJQ()+this.indiceQuestion).show();};ObjetVisuEleve.prototype.majReponsesSingleMulti=function(){for(var x in this.question.reponsesRepondant) if(this.question.reponsesRepondant[x]!==''){this.composeMajReponsesSingleMulti('#'+this.Nom.escapeJQ()+'_q'+this.indiceQuestion+'_r'+(parseInt(this.question.reponsesRepondant[x])-1),true);}};ObjetVisuEleve.prototype.majReponsesShort=function(){var lJqInput=$('#'+this.Nom.escapeJQ()+'_q'+this.indiceQuestion+'_r0');if(this.question.reponsesRepondant&&this.question.reponsesRepondant[0]) this.composeMajReponsesShort(lJqInput,GChaine.enleverEntites(this.question.reponsesRepondant[0]));};ObjetVisuEleve.prototype.majReponsesSpell=function(){if(this.question.reponsesRepondant&&this.question.reponsesRepondant[0]) this.composeMajReponsesSpell('[name="'+this.Nom.escapeJQ()+'_q'+this.indiceQuestion+'_r"]',GChaine.enleverEntites(this.question.reponsesRepondant[0]));};ObjetVisuEleve.prototype.majReponsesMatching=function(){var lUsedDraggable=['dummyID'];var lAsymetrie=false;if(this.question&&this.question.GetGenre()===TypeGenreExerciceDeQuestionnaire.GEQ_Matching){var lReponses=[];for(var i=0;i<this.question.listeReponses.GetNbrElements();i++){var lReponse=this.question.listeReponses.GetElement(i);if($.inArray(lReponse.association,lReponses)=== -1){lReponses.push(lReponse.association);} else{lAsymetrie=true;break;}}}
for(var x in this.question.reponsesRepondant) if(this.question.reponsesRepondant[x]!==''){var lResult=this.composeMajReponsesMatching('#'+this.Nom.escapeJQ()+'_q'+this.indiceQuestion+'_drop'+x,this.Nom+'_q'+this.indiceQuestion+'_r',GChaine.enleverEntites(this.question.reponsesRepondant[x]),lUsedDraggable,lAsymetrie);if(lResult){lUsedDraggable.push(lResult);} else{;}}};ObjetVisuEleve.prototype.majReponsesCloze=function(){var lThis=this;$('#'+this.idWrapperEnonce.escapeJQ()+this.indiceQuestion).find('select, input[type="text"]').each(function(aIndex){if(lThis.question.reponsesRepondant&&lThis.question.reponsesRepondant[aIndex]!=='') lThis.composeMajReponsesCloze(this,GChaine.enleverEntites(lThis.question.reponsesRepondant[aIndex]));});};ObjetVisuEleve.prototype.composeMajReponsesSingleMulti=function(aSelecteur,aSelected){;};ObjetVisuEleve.prototype.composeMajReponsesShort=function(aSelecteur,aTexte){;};ObjetVisuEleve.prototype.composeMajReponsesSpell=function(aSelecteur,aTexte){;};ObjetVisuEleve.prototype.composeMajReponsesMatching=function(aSelDrop,aBaseSelDrag,aReponse,aUsedId,aAsymetrie){;return'';};ObjetVisuEleve.prototype.composeMajReponsesCloze=function(aSelecteur,aReponse){;};ObjetVisuEleve.prototype.recupererReponses=function(){var lReponses=[],lJqInput,lReponse;if(this.question.GetGenre()===TypeGenreExerciceDeQuestionnaire.GEQ_SingleChoice||this.question.GetGenre()===TypeGenreExerciceDeQuestionnaire.GEQ_MultiChoice){$('[id^="'+this.Nom+'_q'+this.indiceQuestion+'_r"]:checked').each(function(){var lIndice=this.id.match(/_r([0-9]+)$/i)[1];lReponses.push(parseInt(lIndice)+1);});} else if(this.question.GetGenre()===TypeGenreExerciceDeQuestionnaire.GEQ_ShortAnswer||this.question.GetGenre()===TypeGenreExerciceDeQuestionnaire.GEQ_NumericalAnswer){lJqInput=$('#'+this.Nom.escapeJQ()+'_q'+this.indiceQuestion+'_r0');lReponse=lJqInput.val().replace(/^\s+/,'').replace(/\s+$/,'').replace(/\s+/gi,' ');lReponses.push(lReponse);} else if(this.question.GetGenre()===TypeGenreExerciceDeQuestionnaire.GEQ_SpellAnswer){lJqInput=$('input[name="'+this.Nom.escapeJQ()+'_q'+this.indiceQuestion+'_r"]');lReponse='';lJqInput.each(function(){lReponse+=$(this).val();});lReponse=lReponse.replace(/^\s+/,'').replace(/\s+$/,'').replace(/\s+/gi,' ');lReponses.push(lReponse);} else if(this.question.GetGenre()===TypeGenreExerciceDeQuestionnaire.GEQ_Matching){var lThis=this;$('[id^="'+this.Nom+'_q'+this.indiceQuestion+'_drop"]').each(function(){lReponses.push(lThis.getReponseMatching(this));});} else if(this.question.GetGenre()===TypeGenreExerciceDeQuestionnaire.GEQ_ClozeField||this.question.GetGenre()===TypeGenreExerciceDeQuestionnaire.GEQ_ClozeFixed||this.question.GetGenre()===TypeGenreExerciceDeQuestionnaire.GEQ_ClozeVariable){$('#'+this.idWrapperEnonce.escapeJQ()+this.indiceQuestion).find('select, input[type="text"]').each(function(){lReponse=$(this).val();if($(this).is('input')) lReponse=lReponse.replace(/^\s+/,'').replace(/\s+$/,'').replace(/\s+/gi,' ');lReponses.push(lReponse);});}
return lReponses;};ObjetVisuEleve.prototype.getReponseMatching=function(aSelecteur){;};ObjetVisuEleve.prototype.setDonnees=function(aParam){if(this.estEnInitialisation()){this.executionQCM=aParam;this.nbQuestions=this.executionQCM.QCM&&this.executionQCM.QCM.nbQuestion?this.executionQCM.QCM.nbQuestion:this.executionQCM.nombreQuestionsSoumises?this.executionQCM.nombreQuestionsSoumises:this.executionQCM.QCM&&this.executionQCM.QCM.nbQuestionsTotal?this.executionQCM.QCM.nbQuestionsTotal:this.executionQCM.nbQuestionsTotal;}
if(aParam.message) this.executionQCM.message=aParam.message;if(this.typeNumerotation===undefined||this.typeNumerotation===null){this.typeNumerotation=aParam.QCM&&aParam.QCM.typeNumerotation!==undefined?aParam.QCM.typeNumerotation:aParam.contenuQCM&&aParam.contenuQCM.typeNumerotation!==undefined?aParam.contenuQCM.typeNumerotation:aParam.typeNumerotation;}
if(aParam&&((aParam.QCM&&aParam.QCM.etatCloture>=0)||aParam.etatCloture>=0)){this.etatCloture=aParam.etatCloture?aParam.etatCloture:aParam.QCM.etatCloture;}
if(aParam.QCM&&aParam.modeVisuQuestion&&aParam.modeVisuQuestion===true&&$.isNumeric(aParam.questionEnVisu)){this.indiceQuestion=aParam.questionEnVisu;this.modeVisuQuestion=aParam.modeVisuQuestion;} else{this.modeVisuQuestion=false;}
if(aParam.QCM){if(aParam.QCM.secEcoulees){this.start=new Date().getTime()-(aParam.QCM.secEcoulees*1000);} else if(!this.start&&!this.estEnInitialisation()) this.start=new Date().getTime();if(aParam.QCM.listeQuestions&&!this.modeProf&&$.inArray(this.etatCloture,[TypeEtatExecutionQCMPourRepondant.EQR_EnCours,TypeEtatExecutionQCMPourRepondant.EQR_ARefaire])> -1) this.question=aParam.QCM.listeQuestions.GetElement(0);else if(aParam.QCM.listeQuestions){this.listeQuestions=aParam.QCM.listeQuestions;this.question=aParam.QCM.listeQuestions.GetElement(this.indiceQuestion);}}
if(this.estEnInitialisation()||!this.estEnCloture()||this.estEnCorrigeFin()) this.actualiser();};ObjetVisuEleve.prototype.setDonneesReponse=function(aParam){this.etatCloture=aParam.etatCloture;if(aParam.etatCloture!==undefined&&$.inArray(aParam.etatCloture,[TypeEtatExecutionQCMPourRepondant.EQR_EnCours,TypeEtatExecutionQCMPourRepondant.EQR_ARefaire])=== -1&&this.executionQCM.modeDiffusionCorrige!==TypeModeCorrectionQCM.FBQ_CorrigeALaFin){this.composeCloture();if(aParam.etatCloture===TypeEtatExecutionQCMPourRepondant.EQR_DureeMaxDepassee) this.indiceQuestion=this.nbQuestions+Number(this.executionQCM.ressentiRepondant);} else if(this.estEnRessenti()&&this.executionQCM.modeDiffusionCorrige===TypeModeCorrectionQCM.FBQ_CorrigeApresQuestion){this.indiceQuestion++;this.actualiser();} else if(this.executionQCM.modeDiffusionCorrige===TypeModeCorrectionQCM.FBQ_CorrigeALaFin&&aParam&&aParam.listeQuestions&&aParam.listeQuestions.GetNbrElements()>0){this.listeQuestions=aParam.listeQuestions;if(aParam.etatCloture!==TypeEtatExecutionQCMPourRepondant.EQR_DureeMaxDepassee){this.composeCorrigeFin();this.indiceQuestion++;this.enActualisation=false;} else{this.composeCloture();this.enActualisation=false;this.indiceQuestion=this.nbQuestions+Number(this.executionQCM.ressentiRepondant);}} else if(this.executionQCM.modeDiffusionCorrige===TypeModeCorrectionQCM.FBQ_CorrigeApresQuestion&&aParam&&aParam.listeQuestions&&aParam.listeQuestions.GetNbrElements()===1){$.extend(true,this.question,aParam.listeQuestions.GetElement(0));this.composeCorrige();this.enActualisation=false;}};ObjetVisuEleve.prototype.surEvenement=function(aObjet){if(this.enActualisation){return;} else this.enActualisation=true;if(this.estEnCloture()&&!this.estUnCorrigeVisibleApresCloture()){this.fermetureFenetre();return;}
if(this.modeProf){this.surEvenementProf(aObjet);} else{this.surEvenementEleve(aObjet);}};ObjetVisuEleve.prototype.surEvenementProf=function(aObjet){if(aObjet.action==='submit'&&this.executionQCM.modeDiffusionCorrige===TypeModeCorrectionQCM.FBQ_CorrigeApresQuestion){if(this.estEnCours()){this.composeCorrige();this.enActualisation=false;} else if(this.estEnRessenti()){this.indiceQuestion++;this.actualiser();return;} else{this.fermetureFenetre();}
$('#'+this.idBoutonSubmit.escapeJQ()+this.indiceQuestion).hide();} else{if(this.modeVisuQuestion){this.fermetureFenetre();return;}
if(aObjet.action==='prev'){this.indiceQuestion--;} else{if(aObjet.action==='submit'){if(this.estEnCours()){this.evaluationNote[this.indiceQuestion].validee=true;this.question.reponsesRepondant=this.recupererReponses();} else if(this.estEnRessenti()){$.noop();} else if(this.estEnFin()){if(this.executionQCM.modeDiffusionCorrige!==TypeModeCorrectionQCM.FBQ_CorrigeALaFin||this.estEnCorrigeFin()) this.fermetureFenetre();else{this.indiceQuestion++;this.composeCorrigeFin();}
return;}}
if(this.estEnCloture()&&this.executionQCM.estRejouable&&aObjet.action==='restart') this.etatCloture=null;if(this.estEnCloture()) this.indiceQuestion=this.nbQuestions+Number(this.executionQCM.ressentiRepondant)+1;else this.indiceQuestion++;}
this.recupererQuestionProf();}};ObjetVisuEleve.prototype.surEvenementEleve=function(aObjet){if(aObjet.action==='submit'&&this.executionQCM.modeDiffusionCorrige===TypeModeCorrectionQCM.FBQ_CorrigeApresQuestion){this.surEvenementValidationEleve();$('#'+this.idBoutonSubmit.escapeJQ()+this.indiceQuestion).hide();} else{if(aObjet.action==='prev'){this.indiceQuestion--;} else{if(aObjet.action==='submit'){if(!this.surEvenementValidationEleve()) return;}
if(this.estEnCloture()&&this.executionQCM.estRejouable&&aObjet.action==='restart') this.etatCloture=null;if(this.estEnInitialisation()&&this.estUneExecutionDejaCommencee()) this.indiceQuestion=this.executionQCM.indiceProchaineQuestion;else if(this.estEnCloture()) this.indiceQuestion=this.nbQuestions+Number(this.executionQCM.ressentiRepondant)+1;else this.indiceQuestion++;}
this.recupererQuestionEleve();}};ObjetVisuEleve.prototype.recupererQuestion=function(){if(this.modeProf){this.recupererQuestionProf();} else{this.recupererQuestionEleve();}};ObjetVisuEleve.prototype.recupererQuestionProf=function(){if(this.listeQuestions&&this.listeQuestions.GetNbrElements()>0){if(this.executionQCM.dureeMaxQCM&&this.getMilliSecondesChrono()<=0) this.etatCloture=TypeEtatExecutionQCMPourRepondant.EQR_DureeMaxDepassee;this.question=this.listeQuestions.GetElement(this.indiceQuestion);if(this.etatCloture===TypeEtatExecutionQCMPourRepondant.EQR_DureeMaxDepassee){this.composeCloture();this.enActualisation=false;this.indiceQuestion=this.nbQuestions+Number(this.executionQCM.ressentiRepondant);} else this.actualiser();} else{var lParam={action:'get',indiceQuestion:this.indiceQuestion,numeroExecution:this.numeroExecution,element:this.executionQCM,pourInitialisation:this.indiceQuestion===0&&!this.estEnCloture()};this.Evenement.call(this.Pere,lParam);}};ObjetVisuEleve.prototype.recupererQuestionEleve=function(){var lParam={action:'get',indiceQuestion:this.indiceQuestion,numeroExecution:this.numeroExecution,element:this.executionQCM,pourInitialisation:this.indiceQuestion===0&&!this.estEnCloture()};this.Evenement.call(this.Pere,lParam);};ObjetVisuEleve.prototype.surEvenementValidationEleve=function(){var lParam;if(this.estEnCours()){this.evaluationNote[this.indiceQuestion].validee=true;lParam={action:'set',element:this.executionQCM,indiceQuestion:this.indiceQuestion,reponse:this.recupererReponses()};this.Evenement.call(this.Pere,lParam);} else if(this.estEnRessenti()){lParam={action:'set',element:this.executionQCM,ressenti:this.ressenti};this.Evenement.call(this.Pere,lParam);} else if(this.estEnFin()){if(this.executionQCM.modeDiffusionCorrige!==TypeModeCorrectionQCM.FBQ_CorrigeALaFin||this.estEnCorrigeFin()) this.fermetureFenetre(this.executionQCM.modeDiffusionCorrige!==TypeModeCorrectionQCM.FBQ_CorrigeALaFin);else{lParam={action:'set',element:this.executionQCM,pourCloture:true};this.Evenement.call(this.Pere,lParam);}
return false;}
return true;};ObjetVisuEleve.prototype.fermetureFenetre=function(aPourCloture){var lParam={action:'close'};if(aPourCloture===true){lParam.element=this.executionQCM;lParam.pourCloture=true;}
this.Evenement.call(this.Pere,lParam);};ObjetVisuEleve.prototype.estEnInitialisation=function(){return this.indiceQuestion=== -1;};ObjetVisuEleve.prototype.estEnRessenti=function(){return this.indiceQuestion===this.nbQuestions&&this.executionQCM.ressentiRepondant;};ObjetVisuEleve.prototype.estEnFin=function(){return this.indiceQuestion>=this.nbQuestions&&!this.estEnRessenti();};ObjetVisuEleve.prototype.estEnCorrigeFin=function(){return(this.executionQCM.modeDiffusionCorrige===TypeModeCorrectionQCM.FBQ_CorrigeALaFin||(this.estEnCloture()&&this.estUnCorrigeVisibleApresCloture()))&&this.indiceQuestion===this.nbQuestions+Number(this.executionQCM.ressentiRepondant)+1;};ObjetVisuEleve.prototype.estEnCours=function(){return this.indiceQuestion> -1&&this.indiceQuestion<this.nbQuestions;};ObjetVisuEleve.prototype.estEnCloture=function(){return this.etatCloture!==undefined&&this.etatCloture!==null&&$.inArray(this.etatCloture,[TypeEtatExecutionQCMPourRepondant.EQR_EnCours,TypeEtatExecutionQCMPourRepondant.EQR_ARefaire])=== -1;};ObjetVisuEleve.prototype.estUneExecutionDejaCommencee=function(){return this.executionQCM.indiceProchaineQuestion>=0&&this.executionQCM.indiceProchaineQuestion<this.nbQuestions;};ObjetVisuEleve.prototype.estUnCorrigeVisibleApresCloture=function(){return this.executionQCM.publierCorrige||this.executionQCM.modeDiffusionCorrige===TypeModeCorrectionQCM.FBQ_CorrigeALaFin||this.executionQCM.modeDiffusionCorrige===TypeModeCorrectionQCM.FBQ_CorrigeApresQuestion;};;

MethodesObjet.heritagePrototype(ObjetVisuEleve_Espace,ObjetVisuEleve);function ObjetVisuEleve_Espace(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.nbImages=0;this.nbImagesChargees=0;this.ressentiSelectionne=false;this.idWrapperTitre=this.Nom+'_WrapperTitre_';this.idWrapperQuestion=this.Nom+'_WrapperQuestion_';this.idWrapperNavigation=this.Nom+'_WrapperNavigation_';this.idWrapperReponses=this.Nom+'_WrapperReponses_';this.idWrapperEnonce=this.Nom+'_WrapperEnonce_';this.idWrapperCorrige=this.Nom+'_WrapperCorrige';this.idWrapperBarreProgression=this.Nom+'_WrapperBarreProg';this.idProgression=this.Nom+'_idProgression_';this.idIndicateurProg=this.Nom+'_IndicateurProgression';this.idBoutonPrev=this.Nom+'_boutonPrev_';this.idBoutonStart=this.Nom+'_boutonStart';this.couleurFondQCM='#f0efeb';}
ObjetVisuEleve_Espace.prototype.triggerFinActualisation=function(){};ObjetVisuEleve_Espace.prototype.composeOuvertureDivGlobal=function(){return'<div style="position:absolute;top:0;left:0;right:0;bottom:0;background-color:'+this.couleurFondQCM+';color:#000;line-height:30px;padding:0 10px;">';};ObjetVisuEleve_Espace.prototype.composeFermetureDivGlobal=function(){return'</div>';};ObjetVisuEleve_Espace.prototype.composeTitre=function(){var lHtmlTitle=[];if(this.executionQCM.GetLibelle()) lHtmlTitle.push(this.executionQCM.GetLibelle());var lTrad='';if(this.executionQCM.modeQuestionnaire===TypeModeQuestionnaire.MQZ_NoteSans){lTrad=GTraductions.getValeur('ExecutionQCM.notation.titre.non_note');} else if(this.executionQCM.modeQuestionnaire===TypeModeQuestionnaire.MQZ_NoteInformative){lTrad=GTraductions.getValeur('ExecutionQCM.notation.titre.titre_informatif',[this.executionQCM.nombreDePoints]);} else if(this.executionQCM.modeQuestionnaire===TypeModeQuestionnaire.MQZ_NoteDevoir){lTrad=GTraductions.getValeur('ExecutionQCM.notation.titre.associe_devoir',[this.executionQCM.nombreDePoints]);}
if(lTrad!=='') lHtmlTitle.push(lTrad);if(this.executionQCM.service&&this.executionQCM.service.GetLibelle()) lHtmlTitle.push(this.executionQCM.service.GetLibelle());if(this.executionQCM.matiere&&this.executionQCM.matiere.GetLibelle()) lHtmlTitle.push(this.executionQCM.matiere.GetLibelle());if(this.executionQCM.listeProfesseurs) lHtmlTitle.push(this.executionQCM.listeProfesseurs.getTableauLibelles().join(', '));return GChaine.enleverEntites(lHtmlTitle.join(' - '));};ObjetVisuEleve_Espace.prototype.composeAffichageQuestion=function(){var lHtml=[];if(!this.affichageEnLigne){lHtml.push('<div id="',this.idWrapperGlobal,'" style="position:absolute;top:20px;right:150px;bottom:20px;left:0px;text-align:right;">');lHtml.push('<div class="InlineBlock" style="height:100%;vertical-align:middle;"></div>');}
lHtml.push('<div id="',this.idWrapperAffichage,this.indiceQuestion,'" class="InlineBlock" style="position:relative;vertical-align:middle;width:90%;text-align:left;">');lHtml=lHtml.concat(this.composeNavigation());lHtml=lHtml.concat(this.composeQuestion());lHtml.push('</div>');if(!this.affichageEnLigne){lHtml.push('</div>');lHtml.push('<div style="position:absolute;top:20px;right:0px;width:130px;height:100px;">');if(this.executionQCM.dureeMaxQCM) lHtml=lHtml.concat(this.composeChrono());lHtml.push('</div>');lHtml.push('<div id="',this.idWrapperBarreProgression,'" style="position:absolute;top:120px;right:0px;bottom:20px;width:130px;text-align:center;">');lHtml=lHtml.concat(this.composeBarreProgression());lHtml.push('</div>');}
return lHtml;};ObjetVisuEleve_Espace.prototype.ajouterEvenementMatching=function(aAsymetrie){var lWidth=$('[id^="'+this.Nom+'_q'+this.indiceQuestion+'_drop"]:first').width();var lMaxHeightReponse=0;$('[id^="'+this.Nom+'_q'+this.indiceQuestion+'_r"]').each(function(){lMaxHeightReponse=Math.max(lMaxHeightReponse,$(this).height());});$('[id^="'+this.Nom+'_q'+this.indiceQuestion+'_drop"]').each(function(){var lMaxHeight=Math.max(lMaxHeightReponse,$(this).height(),$('#'+this.id.replace('_drop','_assoc').escapeJQ()).height());$(this).height(lMaxHeight);$('#'+this.id.replace('_drop','_assoc').escapeJQ()).height(lMaxHeight);});$('#'+this.Nom.escapeJQ()+'_q'+this.indiceQuestion+'_choix').css('height',function(){return $(this).height();});$($('[id^="'+this.Nom+'_q'+this.indiceQuestion+'_r"]').get().reverse()).each(function(){var lPos=$(this).position();$(this).css({position:'absolute',top:lPos.top,left:lPos.left});});$('[id^="'+this.Nom+'_q'+this.indiceQuestion+'_r"]').draggable({revert:'invalid',cursor:'move',helper:aAsymetrie?'clone':'original',cursorAt:{top:5,left:5},containment:'#'+this.idWrapperQuestion.escapeJQ()+' .jspPane',drag:this.onDrag});var lThis=this;$('[id^="'+this.Nom+'_q'+this.indiceQuestion+'_drop"]').droppable({hoverClass:'objetVisuEleveDropHover',drop:function(event,ui){if(aAsymetrie&&ui.draggable.attr('id')){var lNewElement=ui.draggable.clone(false);lNewElement.attr('name',lNewElement.attr('id'));lNewElement.attr('id','');lNewElement.draggable({revert:'invalid',cursor:'move',helper:'original',cursorAt:{top:5,left:5},containment:'#'+lThis.idWrapperQuestion.escapeJQ()+' .jspPane',drag:lThis.onDrag});ui.draggable.after(lNewElement);lNewElement.offset($(this).offset());lNewElement.addClass('ui-dropped');lNewElement.data('droppedOn',$(this).attr('id'));} else{ui.draggable.offset($(this).offset());ui.draggable.addClass('ui-dropped');ui.draggable.data('droppedOn',$(this).attr('id'));}
$(this).data('dragId',ui.draggable.attr('id')||ui.draggable.attr('name'));},accept:function(ele){if(!$(this).data('dragId')||(!aAsymetrie&&$(this).data('dragId')===ele.attr('id'))) return true;else if($(this).data('dragId')&&aAsymetrie){if(ele.attr('id')) return false;else if($(this).data('dragId')===ele.attr('name')){if($(this).attr('id')===ele.data('droppedOn')) return true;else return false;}} else return false;},out:function(event,ui){ui.draggable.removeClass('ui-dropped');$(this).removeData('dragId');},tolerance:"pointer"});$('[id="'+this.Nom+'_q'+this.indiceQuestion+'_choix"]').droppable({hoverClass:'objetVisuEleveDropHover',drop:function(event,ui){if(aAsymetrie){if(!ui.draggable.attr('id')){ui.draggable.draggable('destroy').remove();$('body').css('cursor','');}}}});};ObjetVisuEleve_Espace.prototype.onDrag=function(event,ui){var lJqScroll=$(this).parents('.jspScrollable:first');if(lJqScroll.length){var lDelta=0;if(ui.offset.top-lJqScroll.offset().top<= -1){lDelta=ui.offset.top-lJqScroll.offset().top;} else if(ui.offset.top>lJqScroll.offset().top+lJqScroll.height()){lDelta=ui.offset.top-(lJqScroll.offset().top+lJqScroll.height());}
if(lDelta!==0){var lOldPos=lJqScroll.data('jsp').getPercentScrolledY();lJqScroll.data('jsp').scrollByY(lDelta);if(lOldPos!==lJqScroll.data('jsp').getPercentScrolledY()){ui.position.top=parseFloat(ui.helper[0].style.top)+lDelta;ui.helper.data('ui-draggable').offset.parent.top-=lDelta;}}}};ObjetVisuEleve_Espace.prototype.ajouterEvenementSingleMultiChoice=function(){var lJqInputs=$('input[id^="'+this.Nom+'_q'+this.indiceQuestion+'_r"]');if(lJqInputs.length&&lJqInputs.first().parents('.objetVisuEleveBouton:first').length){lJqInputs.change(function(event){$(this).parents('.'+window.GUtilitaires.QCM.classWrapperInput).parent().toggleClass('objetVisuEleveBoutonChecked',$(this).is(':checked'));if(this.type==='radio') $(this).parents('.'+window.GUtilitaires.QCM.classWrapperInput).parent().parent().parent().siblings().children('td:first-child').children('div').removeClass('objetVisuEleveBoutonChecked');event.stopImmediatePropagation();});}};ObjetVisuEleve_Espace.prototype.composeAffichageRessenti=function(){var lHtml=[];if(!this.affichageEnLigne){lHtml.push('<div id="',this.idWrapperGlobal,'" style="position:absolute;top:20px;right:20px;bottom:20px;left:20px;">');lHtml.push('<div class="InlineBlock" style="height:100%;vertical-align:middle;"></div>');}
lHtml.push('<div id="',this.idWrapperAffichage,this.indiceQuestion,'" class="InlineBlock" style="vertical-align:middle;width:99%;position:relative;">');lHtml=lHtml.concat(this.composeNavigation());lHtml=lHtml.concat(this.composeRessenti());lHtml.push('</div>');if(!this.affichageEnLigne){lHtml.push('</div>');}
return lHtml;};ObjetVisuEleve_Espace.prototype.composeAffichageFin=function(){var lHtml=[];if(!this.affichageEnLigne){lHtml.push('<div id="',this.idWrapperGlobal,'" style="position:absolute;top:20px;right:20px;bottom:20px;left:20px;">');lHtml.push('<div class="InlineBlock" style="height:100%;vertical-align:middle;"></div>');}
lHtml.push('<div id="',this.idWrapperAffichage,this.indiceQuestion,'" class="InlineBlock" style="vertical-align:middle;width:99%;position:relative;">');lHtml.push('<div style="position:absolute;top:0;left:0;width:100%;height:100%;"><table id="',this.idWrapperNavigation,this.indiceQuestion,'" style="width:100%;height:100%;"><tr>');lHtml.push('<td style="vertical-align:middle;">');lHtml.push('<div style="width:38px;height:30px;">&nbsp;</div>');lHtml.push('</td>');lHtml.push('<td style="width:100%;vertical-align:bottom;">');lHtml.push('<div id="',this.idBoutonSubmit,this.indiceQuestion,'" style="width:120px;height:30px;font-size:15px;border-radius: 2px;box-shadow: 0 3px 4px -3px #555555;color:#FFFFFF;text-shadow: 0 1px 1px #555555;background-color:',this.couleurThemeQCM,';text-align:center;cursor:pointer;margin:0 auto;" onclick="'+this.Nom+'.surEvenement({action: \'submit\'});" tabIndex="0"><strong>');if(this.executionQCM.modeDiffusionCorrige===TypeModeCorrectionQCM.FBQ_CorrigeALaFin) lHtml.push(GTraductions.getValeur('ExecutionQCM.presentationCorrige.VisualiserCorrige'));else lHtml.push(GTraductions.getValeur('ExecutionQCM.Terminer'));lHtml.push('</strong></div>');lHtml.push('</td>');lHtml.push('<td style="vertical-align:middle;">');lHtml.push('<div style="width:38px;height:30px;">&nbsp;</div>');lHtml.push('</td>');lHtml.push('</tr></table></div>');lHtml.push('<div style="background-color:#fff;color:#000;box-shadow: 0 3px 10px -5px #000000;font-size:20px;padding:10px;margin:0 50px 50px;">');lHtml.push('<h1 style="text-align:center;font-size:25px;">');if(this.executionQCM.modeDiffusionCorrige===TypeModeCorrectionQCM.FBQ_CorrigeALaFin&&this.executionQCM.modeQuestionnaire===TypeModeQuestionnaire.MQZ_NoteDevoir) lHtml.push(GTraductions.getValeur('ExecutionQCM.phraseFinAvantCorrige'));else if(this.executionQCM.modeDiffusionCorrige===TypeModeCorrectionQCM.FBQ_CorrigeALaFin) lHtml.push(GTraductions.getValeur('ExecutionQCM.phraseFinQCMAvantCorrige'));else if(this.executionQCM.modeQuestionnaire===TypeModeQuestionnaire.MQZ_NoteDevoir) lHtml.push(GTraductions.getValeur('ExecutionQCM.phraseFin'));else lHtml.push(GTraductions.getValeur('ExecutionQCM.phraseFinQCM'));lHtml.push('</h1>');lHtml.push('</div>');lHtml.push('</div>');if(!this.affichageEnLigne){lHtml.push('</div>');}
return lHtml;};ObjetVisuEleve_Espace.prototype.composePageNonDemarre=function(){var lHtml=[];if(!this.affichageEnLigne){lHtml.push('<div id="',this.idWrapperGlobal,'" style="position:absolute;top:20px;right:20px;bottom:20px;left:20px;">');lHtml.push('<div class="InlineBlock" style="height:100%;vertical-align:middle;"></div>');}
lHtml.push('<div id="',this.idWrapperAffichage,this.indiceQuestion,'" class="InlineBlock" style="vertical-align:middle;width:99%;position:relative;">');lHtml.push('<div style="position:absolute;top:0;left:0;width:100%;height:100%;"><table id="',this.idWrapperNavigation,this.indiceQuestion,'" style="width:100%;height:100%;"><tr>');lHtml.push('<td style="vertical-align:middle;">');lHtml.push('<div style="width:38px;height:30px;">&nbsp;</div>');lHtml.push('</td>');lHtml.push('<td style="width:100%;vertical-align:bottom;">');lHtml.push('<div id="',this.idBoutonSubmit,this.indiceQuestion,'" style="width:120px;height:30px;font-size:15px;border-radius: 2px;box-shadow: 0 3px 4px -3px #555555;color:#FFFFFF;text-shadow: 0 1px 1px #555555;background-color:',this.couleurThemeQCM,';text-align:center;cursor:pointer;margin:0 auto;" onclick="'+this.Nom+'.fermetureFenetre();" tabIndex="0"><strong>'+GTraductions.getValeur('ExecutionQCM.Terminer')+'</strong></div>');lHtml.push('</td>');lHtml.push('<td style="vertical-align:middle;">');lHtml.push('<div style="width:38px;height:30px;">&nbsp;</div>');lHtml.push('</td>');lHtml.push('</tr></table></div>');lHtml.push('<div style="background-color:#fff;color:#000;box-shadow: 0 3px 10px -5px #000000;font-size:20px;padding:10px;margin:0 50px 50px;">');lHtml.push('<h1 style="text-align:center;font-size:25px;">'+GTraductions.getValeur('ExecutionQCM.phraseClotureNonDemarre')+'</h1>');lHtml.push('</div>');lHtml.push('</div>');if(!this.affichageEnLigne){lHtml.push('</div>');}
return lHtml;};ObjetVisuEleve_Espace.prototype.composeCloture=function(){$('#'+this.idContenu).html('');var lHtml=[];lHtml.push('<div style="position:absolute;top:0;left:0;right:0;bottom:0;background-color:',this.couleurFondQCM,';color:#000;line-height:30px;padding:0 10px;">');lHtml.push('<div id="',this.idWrapperGlobal,'" style="position:absolute;top:20px;right:20px;bottom:20px;left:20px;">');lHtml.push('<div class="InlineBlock" style="height:100%;vertical-align:middle;"></div>');lHtml.push('<div class="InlineBlock" style="width:99%;color:#000;font-size:20px;text-align:left;vertical-align:middle;">');lHtml.push('<div style="background-color:#fff;color:#000;box-shadow: 0 3px 10px -5px #000000;font-size:20px;padding:10px;margin:0 50px 50px;">');if(this.etatCloture===TypeEtatExecutionQCMPourRepondant.EQR_DureeMaxDepassee&&this.executionQCM.modeQuestionnaire===TypeModeQuestionnaire.MQZ_NoteDevoir) lHtml.push('<h1 style="text-align:center;font-size:25px;">'+GTraductions.getValeur('ExecutionQCM.PhraseClotureDelaiMax')+'</h1>');else if(this.etatCloture===TypeEtatExecutionQCMPourRepondant.EQR_DureeMaxDepassee) lHtml.push('<h1 style="text-align:center;font-size:25px;">'+GTraductions.getValeur('ExecutionQCM.PhraseClotureQCMDelaiMax')+'</h1>');else if(this.executionQCM.modeQuestionnaire===TypeModeQuestionnaire.MQZ_NoteDevoir) lHtml.push('<h1 style="text-align:center;font-size:25px;">'+GTraductions.getValeur('ExecutionQCM.PhraseCloture')+'</h1>');else lHtml.push('<h1 style="text-align:center;font-size:25px;">'+GTraductions.getValeur('ExecutionQCM.PhraseClotureQCM')+'</h1>');lHtml.push('</div>');lHtml.push('<table id="',this.idWrapperNavigation,this.indiceQuestion,'" style="width:100%;"><tr>');lHtml.push('<td style="width:100%;">');lHtml.push('<div id="',this.idBoutonSubmit,this.indiceQuestion,'" style="width:120px;height:30px;font-size:15px;border-radius: 2px;box-shadow: 0 3px 4px -3px #555555;color:#FFFFFF;text-shadow: 0 1px 1px #555555;background-color:',this.couleurThemeQCM,';text-align:center;cursor:pointer;margin:0 auto;" onclick="'+this.Nom+'.surEvenement({action: \'submit\'});" tabIndex="0"><strong>'+GTraductions.getValeur('ExecutionQCM.Terminer')+'</strong></div>');lHtml.push('</td>');lHtml.push('</tr></table>');lHtml.push('</div>');lHtml.push('</div>');lHtml.push('</div>');$('#'+this.idContenu).html(lHtml.join(''));this.actualiserHauteurQuestion();this.enActualisation=false;};ObjetVisuEleve_Espace.prototype.composeAffichageCorrigeFin=function(){var lHtml=[];lHtml.push('<div style="position:absolute;top:0;left:0;right:0;bottom:0;background-color:',this.couleurFondQCM,';color:#000;line-height:30px;padding:0 10px;">');lHtml.push('<div id="',this.idWrapperGlobal,'" style="position:absolute;top:20px;right:20px;bottom:20px;left:20px;">');lHtml.push('<div class="InlineBlock" style="height:100%;vertical-align:middle;"></div>');lHtml.push('<div id="',this.idWrapperCorrige,'" class="InlineBlock" style="width:99%;color:#000;font-size:20px;text-align:left;vertical-align:middle;max-height:100%;overflow:auto;">');var lBackupIndice=this.indiceQuestion;if(this.listeQuestions) for(var i=0;i<this.listeQuestions.GetNbrElements();i++){this.indiceQuestion=i;this.question=this.listeQuestions.GetElement(i);lHtml.push('<div id="',this.idWrapperAffichage,this.indiceQuestion,'" style="width:99%;">');lHtml=lHtml.concat(this.composeQuestion());lHtml.push('</div>');}
this.indiceQuestion=lBackupIndice;lHtml.push('<table id="',this.idWrapperNavigation,this.indiceQuestion,'" style="width:100%;"><tr>');lHtml.push('<td style="width:100%;">');lHtml.push('<div id="',this.idBoutonSubmit,this.indiceQuestion,'" style="width:120px;height:30px;font-size:15px;border-radius: 2px;box-shadow: 0 3px 4px -3px #555555;color:#FFFFFF;text-shadow: 0 1px 1px #555555;background-color:',this.couleurThemeQCM,';text-align:center;cursor:pointer;margin:0 auto;" onclick="'+this.Nom+'.surEvenement({action: \'submit\'});" tabIndex="0"><strong>'+GTraductions.getValeur('ExecutionQCM.Terminer')+'</strong></div>');lHtml.push('</td>');lHtml.push('</tr></table>');lHtml.push('</div>');lHtml.push('</div>');lHtml.push('</div>');return lHtml;};ObjetVisuEleve_Espace.prototype.autoriserFermetureInterface=function(){this.Evenement.call(this.Pere,{action:'afficherCroix'});};ObjetVisuEleve_Espace.prototype.interdireFermetureInterface=function(){this.Evenement.call(this.Pere,{action:'masquerCroix'});};ObjetVisuEleve_Espace.prototype.actualiserHauteurCorrige=function(aIndice){if($('#'+this.idWrapperCorrige.escapeJQ()).get(0).scrollHeight>$('#'+this.idWrapperGlobal.escapeJQ()).height()) $('#'+this.idWrapperCorrige.escapeJQ()).jScrollPane({showArrows:true});};ObjetVisuEleve_Espace.prototype.actualiserHauteurQuestion=function(aIndice){if(aIndice!==undefined) this.nbImagesChargees++;if(this.affichageUnePage!==true){aIndice=aIndice?aIndice:this.indiceQuestion;if($('#'+this.idWrapperQuestion.escapeJQ()+aIndice).data('jsp')){$('#'+this.idWrapperQuestion.escapeJQ()+aIndice).data('jsp').destroy();}
var lMaxHeight=$('#'+this.idWrapperGlobal.escapeJQ()).height()-20-10-$('#'+this.idWrapperTitre.escapeJQ()+aIndice).height()-($('#'+(this.idBoutonSubmit+aIndice).escapeJQ()).is(':visible')?50:0);$('#'+this.idWrapperQuestion.escapeJQ()+aIndice).height('');if($('#'+this.idWrapperQuestion.escapeJQ()+aIndice).height()>lMaxHeight){$('#'+this.idWrapperQuestion.escapeJQ()+aIndice).height(lMaxHeight+'px');$('#'+this.idWrapperQuestion.escapeJQ()+aIndice).jScrollPane({showArrows:true});}}
var lJqCorrige=$('#'+this.idWrapperCorrige.escapeJQ());if(this.nbImagesChargees===this.nbImages&&lJqCorrige.length){if(lJqCorrige.data('jsp')){lJqCorrige.data('jsp').destroy();}
if($('#'+this.idWrapperCorrige.escapeJQ()).get(0).scrollHeight>$('#'+this.idWrapperGlobal.escapeJQ()).height()) $('#'+this.idWrapperCorrige.escapeJQ()).jScrollPane({showArrows:true});}};ObjetVisuEleve_Espace.prototype.actualiserHauteurReponse=function(aId){};ObjetVisuEleve_Espace.prototype.composePageModalite=function(){var lHtml=[];lHtml.push('<div style="position:absolute;top:0;left:0;right:0;bottom:0;text-align:center;">');lHtml.push('<div class="InlineBlock" style="height:100%;vertical-align:middle;"></div>');lHtml.push('<div class="InlineBlock" style="width:70%;background-color:#fff;color:#000;box-shadow: 0 3px 10px -5px #000000;font-size:20px;padding:10px 10px 30px 10px;text-align:left;vertical-align:middle;">');lHtml.push('<h1 style="text-align:center;font-size:25px;width:90%;border-bottom:'+this.couleurThemeQCM+' 1px solid;margin:0 auto 25px;">',GTraductions.getValeur('ExecutionQCM.LisezIndications'),'</h1>');var lTrad='';var lImage='';if(this.executionQCM.modeQuestionnaire===TypeModeQuestionnaire.MQZ_NoteSans){if(this.executionQCM.estLieADevoir||this.executionQCM.estUnTAF) lTrad='ExecutionQCM.notation.non_note';else lTrad='ExecutionQCM.notation.revision';lImage='Image_QCM_non_note';} else if(this.executionQCM.modeQuestionnaire===TypeModeQuestionnaire.MQZ_NoteInformative){lTrad='ExecutionQCM.notation.titre_informatif';lImage='Image_QCM_titre_informatif';} else if(this.executionQCM.modeQuestionnaire===TypeModeQuestionnaire.MQZ_NoteDevoir){lTrad='ExecutionQCM.notation.associe_devoir';lImage='Image_QCM_associe_devoir';}
if(lTrad!=='') lHtml.push('<div style="width:80%;margin:0 auto 10px"><div class="InlineBlock ',lImage,'">&nbsp;</div><div class="InlineBlock">',GTraductions.getValeur(lTrad,[this.executionQCM.nombreDePoints])+'</div></div>');lTrad='';if(this.executionQCM.dureeMaxQCM){lTrad='ExecutionQCM.presentation.limite_temps';lImage='Image_QCM_limite_temps';} else{lTrad='ExecutionQCM.presentation.sans_limite_temps';lImage='Image_QCM_sans_limite_temps';}
if(lTrad!=='') lHtml.push('<div style="width:80%;margin:0 auto 10px"><div class="InlineBlock ',lImage,'">&nbsp;</div><div class="InlineBlock">',GTraductions.getValeur(lTrad,[this.executionQCM.dureeMaxQCM+' '+GTraductions.getValeur('ExecutionQCM.Minutes')]),'</div></div>');lTrad='';if(!this.executionQCM.autoriserLaNavigation){lTrad='ExecutionQCM.presentation.sans_retour_precedent';lImage='Image_QCM_sans_retour_precedent';} else{lTrad='ExecutionQCM.presentation.retour_precedent';lImage='Image_QCM_retour_precedent';}
if(lTrad!=='') lHtml.push('<div style="width:80%;margin:0 auto 10px"><div class="InlineBlock ',lImage,'">&nbsp;</div><div class="InlineBlock">',GTraductions.getValeur(lTrad),'</div></div>');lTrad='';if(this.executionQCM.modeDiffusionCorrige===TypeModeCorrectionQCM.FBQ_CorrigeSans){lTrad='ExecutionQCM.corrige.aucun';lImage='Image_QCM_corrige_aucun';} else if(this.executionQCM.modeDiffusionCorrige===TypeModeCorrectionQCM.FBQ_CorrigeApresQuestion){lTrad='ExecutionQCM.corrige.chaque_question';lImage='Image_QCM_corrige_chaque_question';} else if(this.executionQCM.modeDiffusionCorrige===TypeModeCorrectionQCM.FBQ_CorrigeALaFin){lTrad='ExecutionQCM.corrige.fin_qcm';lImage='Image_QCM_corrige_fin_qcm';}
if(lTrad!=='') lHtml.push('<div style="width:80%;margin:0 auto 10px"><div class="InlineBlock ',lImage,'">&nbsp;</div><div class="InlineBlock">',GTraductions.getValeur(lTrad),'</div></div>');lHtml.push('<div id="',this.idBoutonStart,'" style="width:250px;height:30px;font-size:15px;border-radius: 2px;box-shadow: 0 3px 4px -3px #555555;color:#FFFFFF;text-shadow: 0 1px 1px #555555;background-color:',this.couleurThemeQCM,';text-align:center;cursor:pointer;margin:0 auto;" onclick="'+this.Nom+'.surEvenement({action: \'start\'});" tabIndex="0"><strong>',GTraductions.getValeur('ExecutionQCM.CommencerQCM'),'</strong></div>');lHtml.push('</div>');lHtml.push('</div>');return lHtml;};ObjetVisuEleve_Espace.prototype.composePagePresCorrige=function(){var lHtml=[];lHtml.push('<div style="position:absolute;top:0;left:0;right:0;bottom:0;text-align:center;">');lHtml.push('<div class="InlineBlock" style="height:100%;vertical-align:middle;"></div>');lHtml.push('<div class="InlineBlock" style="width:70%;background-color:#fff;color:#000;box-shadow: 0 3px 10px -5px #000000;font-size:20px;padding:10px 10px 30px 10px;text-align:left;vertical-align:middle;">');lHtml.push('<h1 style="text-align:center;font-size:25px;width:90%;border-bottom:'+this.couleurThemeQCM+' 1px solid;margin:0 auto 25px;">');if(this.executionQCM.modeQuestionnaire===TypeModeQuestionnaire.MQZ_NoteDevoir) lHtml.push(GTraductions.getValeur('ExecutionQCM.presentationCorrige.CorrigeIdevoirExecute'));else lHtml.push(GTraductions.getValeur('ExecutionQCM.presentationCorrige.CorrigeQCMExecute'));lHtml.push('</h1>');var lTrad='';var lImage='';var lTexteNote='';if(this.executionQCM.modeQuestionnaire===TypeModeQuestionnaire.MQZ_NoteSans){if(!this.executionQCM.estRejouable) lTrad='ExecutionQCM.notation.non_note';else lTrad='ExecutionQCM.notation.revision';lImage='Image_QCM_non_note';} else if(this.executionQCM.modeQuestionnaire===TypeModeQuestionnaire.MQZ_NoteInformative){lTrad='ExecutionQCM.notation.titre_informatif';lImage='Image_QCM_titre_informatif';} else if(this.executionQCM.modeQuestionnaire===TypeModeQuestionnaire.MQZ_NoteDevoir){lTexteNote=GTraductions.getValeur('ExecutionQCM.presentationCorrige.noteObtenue',[this.executionQCM.noteQCM.toString(),this.executionQCM.nombreDePoints])+'<br />';lTrad='ExecutionQCM.presentationCorrige.reponsesDonnees';lImage='Image_QCM_associe_devoir';}
if(lTrad!=='') lHtml.push('<div style="width:80%;margin:0 auto 10px"><div class="InlineBlock ',lImage,'" style="vertical-align:middle;">&nbsp;</div><div class="InlineBlock" style="vertical-align:middle;">',(lTexteNote?lTexteNote:''),this.executionQCM.modeQuestionnaire===TypeModeQuestionnaire.MQZ_NoteInformative?GTraductions.getValeur(lTrad,[this.executionQCM.nombreDePoints]):GTraductions.getValeur(lTrad,[this.executionQCM.nbQuestRepondues,this.executionQCM.nbQuestFaites,this.executionQCM.nbQuestBonnes]),'</div></div>');if(this.executionQCM.dureeMaxQCM){lTrad='ExecutionQCM.presentationCorrige.limite_temps';lImage='Image_QCM_limite_temps';} else{lTrad='ExecutionQCM.presentationCorrige.sans_limite_temps';lImage='Image_QCM_sans_limite_temps';}
if(lTrad!=='') lHtml.push('<div style="width:80%;margin:0 auto 10px"><div class="InlineBlock ',lImage,'" style="vertical-align:middle;">&nbsp;</div><div class="InlineBlock" style="vertical-align:middle;">',GTraductions.getValeur(lTrad,[this.executionQCM.dureeMaxQCM]),(this.executionQCM.dureeMaxQCM?' '+GTraductions.getValeur('ExecutionQCM.Minutes'):''),'</div></div>');if(!this.executionQCM.estRejouable||!GEtatUtilisateur.estEspaceEleve()){lHtml.push('<div id="',this.idBoutonStart,'" style="width:250px;height:30px;font-size:15px;border-radius: 2px;box-shadow: 0 3px 4px -3px #555555;color:#FFFFFF;text-shadow: 0 1px 1px #555555;background-color:',this.couleurThemeQCM,';text-align:center;cursor:pointer;margin:0 auto;" onclick="'+this.Nom+'.surEvenement({action: \'start\'});" tabIndex="0"><strong>',GTraductions.getValeur('ExecutionQCM.presentationCorrige.VisualiserCorrige'),'</strong></div>');} else{lHtml.push('<div style="text-align:center;">');lHtml.push('<div id="',this.idBoutonStart,'" class="InlineBlock" style="width:250px;height:30px;font-size:15px;border-radius: 2px;box-shadow: 0 3px 4px -3px #555555;color:#FFFFFF;text-shadow: 0 1px 1px #555555;background-color:',this.couleurThemeQCM,';text-align:center;cursor:pointer;margin:0 15px;" onclick="'+this.Nom+'.surEvenement({action: \'start\'});" tabIndex="0"><strong>',GTraductions.getValeur('ExecutionQCM.presentationCorrige.VisualiserCorrige'),'</strong></div>');lHtml.push('<div id="',this.idBoutonNext,'" class="InlineBlock" style="width:250px;height:30px;font-size:15px;border-radius: 2px;box-shadow: 0 3px 4px -3px #555555;color:#FFFFFF;text-shadow: 0 1px 1px #555555;background-color:',this.couleurThemeQCM,';text-align:center;cursor:pointer;margin:0 15px;" onclick="'+this.Nom+'.surEvenement({action: \'restart\'});" tabIndex="0"><strong>',GTraductions.getValeur('ExecutionQCM.presentationCorrige.RecommencerQCM'),'</strong></div>');lHtml.push('</div>');}
lHtml.push('</div>');lHtml.push('</div>');return lHtml;};ObjetVisuEleve_Espace.prototype.composeChrono=function(){var lHtml=[];lHtml.push('<div class="Image_QCM_Chrono" style="margin:0 auto 15px;line-height:20px;padding-top:15px;"><br /><span id="',this.idValeurChrono,'"></span></div>');return lHtml;};ObjetVisuEleve_Espace.prototype.composeMajChrono=function(aTextTime,aLibelleTime){$('#'+this.idValeurChrono.escapeJQ()).html('<span style="font-size:25px;line-height:20px;">'+aTextTime+'</span><br />'+aLibelleTime);};ObjetVisuEleve_Espace.prototype.composeAffichageBarreProgression=function(){var lHeightTotal=Math.min(Math.floor(($('#'+this.idContenu).height()-120)/this.nbQuestions),26);var lHeightAvecPaddingBorder=Math.round((lHeightTotal)*0.666);var lHeightAvecPadding=lHeightAvecPaddingBorder-0 ;var lHeightMargin=lHeightTotal-lHeightAvecPaddingBorder;var lHeightPadding=Math.floor((lHeightAvecPadding*0.3)/2);var lHeight=lHeightAvecPadding-(2*lHeightPadding);var lPourcentCentrage=Math.floor((($('#'+this.idContenu).height()-120)/$('#'+this.idContenu).height())*100);var lHtml=[];lHtml.push('<div class="InlineBlock" style="height:',lPourcentCentrage,'%;margin:auto;vertical-align:middle;"></div>');lHtml.push('<div class="InlineBlock" style="position:relative;width:16px;vertical-align:middle;padding:5px;">');if(this.estEnCours()) lHtml.push('<div id="',this.idIndicateurProg,'" class="Image_QCM_Fleche_Position" style="position:absolute;top:'+(Math.min(this.indiceQuestion*lHeightTotal,this.nbQuestions*lHeightTotal)+Math.floor(lHeightAvecPaddingBorder/2)+1)+'px;left:-10px;"></div>');for(var i=0;i<this.nbQuestions;i++){var lBackColor=this.getCouleurPointProgression(i);lHtml.push('<div id="'+this.idProgression+i+'" style="'+(this.executionQCM.autoriserLaNavigation?'cursor:pointer;':'')+'width:'+lHeight+'px;height:'+lHeight+'px;padding:'+lHeightPadding+'px;margin:0 auto '+lHeightMargin+'px;background-color:#fff;box-shadow: 0 3px 10px -5px #000000;" title="',GTraductions.getValeur('ExecutionQCM.QuestionXSurY',[i+1,this.nbQuestions]),'">','<div style="background-color:'+lBackColor+';width:'+lHeight+'px;height:'+lHeight+'px;">&nbsp;</div>','</div>');}
lHtml.push('</div>');return lHtml;};ObjetVisuEleve_Espace.prototype.composeMiseEnFormeBarreProgression=function(){};ObjetVisuEleve_Espace.prototype.ajouterEvenementBarreProgression=function(){$('#'+this.idWrapperBarreProgression.escapeJQ()+' div[id^="'+this.idProgression+'"]').addClass('AvecMain');$('#'+this.idWrapperBarreProgression.escapeJQ()).on('click','div[id^="'+this.idProgression+'"]',{aObjet:this},function(event){var lIndice=this.id.match(/_([0-9]+)$/i)[1],lThis=event.data.aObjet;lThis.indiceQuestion=parseInt(lIndice);lThis.recupererQuestion();});};ObjetVisuEleve_Espace.prototype.composeQuestion=function(){this.evaluationNote[this.indiceQuestion]={validee:false};var lHtml=[];lHtml.push('<div style="position:relative;background-color:#fff;color:#000;box-shadow: 0 3px 10px -5px #000000;font-size:20px;padding:10px;margin:0 50px 50px;">');lHtml.push('<h1 id="',this.idWrapperTitre,this.indiceQuestion,'" style="font-size:18px;width:99%;border-bottom:'+this.couleurThemeQCM+' 1px solid;margin:auto;">','<table cellpadding="0" cellspacing="0" style="border:0;width:100%"><tr>','<td style="vertical-align: top; white-space: nowrap;text-align:left;color:',this.couleurThemeQCM,';">',GTraductions.getValeur('QCM.QuestionLibelle'),' ',window.GUtilitaires.QCM.composeNumerotation(this.typeNumerotation,this.indiceQuestion+1),'&nbsp;:&nbsp;</td>','<td style="vertical-align: top;width:100%;text-align:left;">',this.question.GetLibelle(),'</td>','<td style="vertical-align: top; white-space: nowrap;font-size:15px;font-style:normal;margin-left:15px;text-align:right;">','<span id="',this.idNbPoint,this.indiceQuestion,'" style="display:none;"></span>',(this.executionQCM.modeQuestionnaire===TypeModeQuestionnaire.MQZ_NoteSans?'':('<span id="'+this.idSlashNbPoint+this.indiceQuestion+'" style="display:none;color:'+this.couleurThemeQCM+';">/</span><span style="color:'+this.couleurThemeQCM+';">'+this.question.note+' '+(parseInt(this.question.note)===1?GTraductions.getValeur('ExecutionQCM.Point'):GTraductions.getValeur('ExecutionQCM.Points'))+'</span>')),'</td>','</tr></table>','</h1>');lHtml.push('<div id="',this.idWrapperQuestion,this.indiceQuestion,'" style="'+(this.affichageUnePage?'':'overflow:auto;')+'margin:0 15px;">');lHtml.push('<div id="',this.idWrapperEnonce,this.indiceQuestion,'" class="GrandEspaceHaut PetitEspaceBas" style="overflow:auto;line-height:110%;font-size:13px'+';">',window.GUtilitaires.QCM.composeEnonce(this,this.question));if(this.question.image) lHtml.push('<div class="GrandEspaceHaut GrandEspaceBas"><img alt="" src="data:image/png;base64,',this.question.image,'" onerror="$(this).parent().html(GTraductions.getValeur(\'ExecutionQCM.ImageNonSupportee\'));" /></div>');if(this.question.mp3name&&this.question.mp3name!==''&&this.question.mp3&&this.question.mp3!==''){lHtml.push('<audio onclick="event.stopImmediatePropagation()" id="',this.idMp3Question,this.indiceQuestion,'" style="padding:3px;" src="data:audio/mp3;base64,',this.question.mp3,'">'+GTraductions.getValeur('ExecutionQCM.AudioNonSupporte')+'</audio>');lHtml.push('<div id="',this.idMp3Control,this.indiceQuestion,'"  style="padding:3px;" class="InlineBlock"><span class="InlineBlock Image_QCM_Son_Play"></span> ',this.question.mp3name,'</div>');}
if(this.question.url&&this.question.url!=='') lHtml.push('<div style="padding:3px;"><div class="Image_QCM_Site InlineBlock AlignementMilieuVertical" style="width:18px;height:18px;"></div><a class="AlignementMilieuVertical" href="'+this.question.url+'" target="_blank">'+this.question.url+'</a></div>');lHtml.push('</div>');lHtml.push('<div id="',this.idWrapperReponses,this.indiceQuestion,'" class="Texte12 GrandEspaceHaut">');lHtml=lHtml.concat(window.GUtilitaires.QCM.composeReponses(this,this.question));lHtml.push('</div>');if(this.question.editeur&&this.question.editeur.existeNumero()) lHtml.push('<div class="Texte11" style="text-align:right;color:'+GCouleur.fenetre.texte+';">'+GTraductions.getValeur('ExecutionQCM.CopyRightEditeur2013',[this.question.editeur.GetLibelle()])+'</div>');lHtml.push('</div>');lHtml.push('</div>');return lHtml;};ObjetVisuEleve_Espace.prototype.composeRessentiEtoile=function(){var lHtml=[],i;lHtml.push('<div style="position:relative;background-color:#fff;color:#000;box-shadow: 0 3px 10px -5px #000000;font-size:20px;padding:10px;margin:0 50px 50px;">');lHtml.push('<h1 id="',this.idWrapperTitre,this.indiceQuestion,'" style="font-size:25px;width:90%;border-bottom:'+this.couleurThemeQCM+' 1px solid;margin:auto;font-style:italic;text-align:right;">'+GTraductions.getValeur('ExecutionQCM.TitreRessenti')+'</h1>');lHtml.push('<div id="',this.idWrapperQuestion,this.indiceQuestion,'" style="overflow:auto;">');lHtml.push('<div id="',this.idWrapperEnonce,this.indiceQuestion,'" class="Texte12" style="overflow:auto;">');lHtml.push('<div style="font-size:50px;text-align:center;height:50px;line-height:50px;padding:10px;">');for(i=1;i<=5;i++) lHtml.push('<span class="AvecMain InlineBlock Image_QCM_Etoile_Off" id="',this.idRessenti,'_',i,'">&nbsp;</span>');lHtml.push('</div>');lHtml.push('<div class="Texte24" style="text-align:center;padding:10px;">');var lLargMax=0;for(i=1;i<=5;i++) lLargMax=Math.max(lLargMax,GChaine.GetLongueurChaineDansDiv(GTraductions.getValeur('ExecutionQCM.valeurRessenti')[i-1],24));lHtml.push(GTraductions.getValeur('ExecutionQCM.phraseRessenti'));lHtml.push('<span id="',this.idTexteRessenti,'" class="InlineBlock AlignementGauche" style="width:',lLargMax,'px;"></span>');lHtml.push('</div>');lHtml.push('</div>');lHtml.push('</div>');lHtml.push('</div>');return lHtml;};ObjetVisuEleve_Espace.prototype.composeRessenti=function(){var lHtml=[];lHtml.push('<div style="position:relative;background-color:#fff;color:#000;box-shadow: 0 3px 10px -5px #000000;font-size:20px;padding:10px;margin:0 50px 50px;">');lHtml.push('<h1 id="',this.idWrapperTitre,this.indiceQuestion,'" style="font-size:25px;width:90%;border-bottom:'+this.couleurThemeQCM+' 1px solid;margin:auto;font-style:italic;text-align:right;">'+GTraductions.getValeur('ExecutionQCM.TitreRessenti')+'</h1>');lHtml.push('<div id="',this.idWrapperQuestion,this.indiceQuestion,'" style="overflow:auto;">');lHtml.push('<div id="',this.idWrapperEnonce,this.indiceQuestion,'" class="Texte12" style="overflow:auto;">');lHtml.push('<div style="font-size:40px;text-align:center;height:50px;line-height:50px;padding:50px 10px;">');lHtml.push('<div class="Texte24 InlineBlock AlignementMilieuVertical" style="height:100%;">',GTraductions.getValeur('ExecutionQCM.phraseRessenti'),'</div>');lHtml.push('<span class="AvecMain InlineBlock AlignementMilieuVertical" id="',this.idRessenti,'_0" style="width:200px;text-align:center;color:',GCouleur.grisClair,';">',GTraductions.getValeur('ExecutionQCM.valeurRessenti')[3],'</span>');lHtml.push('<span class="AvecMain InlineBlock AlignementMilieuVertical" id="',this.idRessenti,'_1" style="width:200px;text-align:center;color:',GCouleur.grisClair,';">',GTraductions.getValeur('ExecutionQCM.valeurRessenti')[1],'</span>');lHtml.push('</div>');lHtml.push('</div>');lHtml.push('</div>');lHtml.push('</div>');return lHtml;};ObjetVisuEleve_Espace.prototype.composeNavigation=function(){var lHtml=[];lHtml.push('<div style="position:absolute;top:0;left:0;width:100%;height:100%;"><table id="',this.idWrapperNavigation,this.indiceQuestion,'" style="width:100%;height:100%;"><tr>');lHtml.push('<td style="vertical-align:middle;">');if(this.executionQCM.autoriserLaNavigation&&this.indiceQuestion>0)lHtml.push('<div id="',this.idBoutonPrev,this.indiceQuestion,'" class="Image_QCM_Fleche_Prec" style="font-size:15px;border-radius: 2px;box-shadow: 0 3px 4px -3px #555555;background-color:',this.couleurThemeQCM,';text-align:center;cursor:pointer;" onclick="'+this.Nom+'.surEvenement({action: \'prev\'});" tabIndex="0" title="'+GTraductions.getValeur('ExecutionQCM.Precedent')+'"></div>');else lHtml.push('<div style="width:38px;height:30px;">&nbsp;</div>');lHtml.push('</td>');lHtml.push('<td style="width:100%;vertical-align:bottom;">');lHtml.push('<div id="',this.idBoutonSubmit,this.indiceQuestion,'" style="width:120px;height:30px;font-size:15px;border-radius: 2px;box-shadow: 0 3px 4px -3px #555555;color:#FFFFFF;text-shadow: 0 1px 1px #555555;background-color:',this.couleurThemeQCM,';text-align:center;cursor:pointer;margin:0 auto;',(this.estEnRessenti()?'display:none;':''),'" onclick="'+this.Nom+'.surEvenement({action: \'submit\'});" tabIndex="0"><strong>'+(this.estEnCours()?GTraductions.getValeur('ExecutionQCM.Valider'):GTraductions.getValeur('ExecutionQCM.Terminer'))+'</strong></div>');lHtml.push('</td>');lHtml.push('<td style="vertical-align:middle;">');var lMasquerNext=(!this.executionQCM.autoriserLaNavigation&&this.executionQCM.modeDiffusionCorrige===TypeModeCorrectionQCM.FBQ_CorrigeApresQuestion)||(this.executionQCM&&this.indiceQuestion>=this.nbQuestions);if((this.executionQCM.autoriserLaNavigation&&this.estEnCours())||this.executionQCM.modeDiffusionCorrige===TypeModeCorrectionQCM.FBQ_CorrigeApresQuestion)lHtml.push('<div id="',this.idBoutonNext,this.indiceQuestion,'" class="Image_QCM_Fleche_Suiv" style="font-size:15px;border-radius: 2px;box-shadow: 0 3px 4px -3px #555555;background-color:',this.couleurThemeQCM,';text-align:center;cursor:pointer;'+(lMasquerNext?'display:none;':'')+'" onclick="'+this.Nom+'.surEvenement({action: \'next\'});" tabIndex="0" title="'+GTraductions.getValeur('ExecutionQCM.Suivant')+'"></div>');else lHtml.push('<div style="width:38px;height:30px;">&nbsp;</div>');lHtml.push('</td>');lHtml.push('</tr></table></div>');return lHtml;};ObjetVisuEleve_Espace.prototype.composeAffichageCorrigeSingleMultiVraiCoche=function(aSelecteur,aSansCorrige){var lIndice=$(aSelecteur).attr('id').match(/_r([0-9]+)$/)[1];var lModeBouton=$(aSelecteur).parents('.'+window.GUtilitaires.QCM.classWrapperInput).parent().hasClass('objetVisuEleveBouton');$(aSelecteur).parents('.'+window.GUtilitaires.QCM.classWrapperInput).parent().parent().next('td').append('<span class="InlineBlock AlignementMilieuVertical Image_QCM_CocheVerte"'+(lModeBouton?'':' style="padding-bottom:15px;"')+'>&nbsp;</span>');if(!aSansCorrige){$(aSelecteur).parents('table:first').find('.objetVisuEleveLabelCorrige').css('display','inline-block');$('#'+$(aSelecteur).attr('id').replace('_r','_corrige').escapeJQ()).append(window.GUtilitaires.QCM.composeSingleMulti({objetThis:this,reponse:this.question.listeReponses.GetElement(lIndice),indice:lIndice,type:this.question.GetGenre()===TypeGenreExerciceDeQuestionnaire.GEQ_SingleChoice?'radio':'checkbox',modeBouton:$(aSelecteur).parents('.'+window.GUtilitaires.QCM.classWrapperInput).parent().hasClass('objetVisuEleveBouton'),avecReponse:true,avecFeedback:false,pourCorrige:true,dernier:parseInt(lIndice)===(this.question.listeReponses.GetNbrElements()-1)})).parent().css('border-left','#e7e7e7 2px solid');}};ObjetVisuEleve_Espace.prototype.composeAffichageCorrigeSingleMultiVraiNonCoche=function(aSelecteur){var lIndice=$(aSelecteur).attr('id').match(/_r([0-9]+)$/)[1];$(aSelecteur).parents('table:first').find('.objetVisuEleveLabelCorrige').css('display','inline-block');$('#'+$(aSelecteur).attr('id').replace('_r','_corrige').escapeJQ()).append(window.GUtilitaires.QCM.composeSingleMulti({objetThis:this,reponse:this.question.listeReponses.GetElement(lIndice),indice:lIndice,type:this.question.GetGenre()===TypeGenreExerciceDeQuestionnaire.GEQ_SingleChoice?'radio':'checkbox',modeBouton:$(aSelecteur).parents('.'+window.GUtilitaires.QCM.classWrapperInput).parent().hasClass('objetVisuEleveBouton'),avecReponse:true,avecFeedback:false,pourCorrige:true,dernier:parseInt(lIndice)===(this.question.listeReponses.GetNbrElements()-1)})).parent().css('border-left','#e7e7e7 2px solid');};ObjetVisuEleve_Espace.prototype.composeAffichageCorrigeSingleMultiFauxCoche=function(aSelecteur){var lIndice=$(aSelecteur).attr('id').match(/_r([0-9]+)$/)[1];var lModeBouton=$(aSelecteur).parents('.'+window.GUtilitaires.QCM.classWrapperInput).parent().hasClass('objetVisuEleveBouton');$(aSelecteur).parents('table:first').find('.objetVisuEleveLabelCorrige').css('display','inline-block');$(aSelecteur).parents('.'+window.GUtilitaires.QCM.classWrapperInput).parent().parent().next('td').append('<span class="InlineBlock AlignementMilieuVertical Image_QCM_CocheRouge"'+(lModeBouton?'':' style="padding-bottom:15px;"')+'>&nbsp;</span>');$('#'+$(aSelecteur).attr('id').replace('_r','_corrige').escapeJQ()).append(window.GUtilitaires.QCM.composeSingleMulti({objetThis:this,reponse:this.question.listeReponses.GetElement(lIndice),indice:lIndice,type:this.question.GetGenre()===TypeGenreExerciceDeQuestionnaire.GEQ_SingleChoice?'radio':'checkbox',modeBouton:$(aSelecteur).parents('.'+window.GUtilitaires.QCM.classWrapperInput).parent().hasClass('objetVisuEleveBouton'),avecReponse:true,avecFeedback:false,pourCorrige:true,dernier:parseInt(lIndice)===(this.question.listeReponses.GetNbrElements()-1)})).parent().css('border-left','#e7e7e7 2px solid');};ObjetVisuEleve_Espace.prototype.composeAffichageCorrigeSingleMultiFauxNonCoche=function(aSelecteur){var lIndice=$(aSelecteur).attr('id').match(/_r([0-9]+)$/)[1];$(aSelecteur).parents('table:first').find('.objetVisuEleveLabelCorrige').css('display','inline-block');$('#'+$(aSelecteur).attr('id').replace('_r','_corrige').escapeJQ()).append(window.GUtilitaires.QCM.composeSingleMulti({objetThis:this,reponse:this.question.listeReponses.GetElement(lIndice),indice:lIndice,type:this.question.GetGenre()===TypeGenreExerciceDeQuestionnaire.GEQ_SingleChoice?'radio':'checkbox',modeBouton:$(aSelecteur).parents('.'+window.GUtilitaires.QCM.classWrapperInput).parent().hasClass('objetVisuEleveBouton'),avecReponse:true,avecFeedback:false,pourCorrige:true,dernier:parseInt(lIndice)===(this.question.listeReponses.GetNbrElements()-1)})).parent().css('border-left','#e7e7e7 2px solid');};ObjetVisuEleve_Espace.prototype.composeAffichageCorrigeSingleMultiFeedback=function(aSelecteur,aCouleur,aFeedback){var lModeBouton=$(aSelecteur).parents('.'+window.GUtilitaires.QCM.classWrapperInput).parent().hasClass('objetVisuEleveBouton');if(!lModeBouton){$(aSelecteur).parents('.'+window.GUtilitaires.QCM.classWrapperInput).parent().parent().children('div').removeClass('GrandEspaceBas');}
var lJqTd=$(aSelecteur).parents('.'+window.GUtilitaires.QCM.classWrapperInput).parent().parent().next().next();lJqTd.append('<div '+(lModeBouton?'style="border:'+GCouleur.fenetre.nonEditable.bordure+' 1px solid;padding:0 15px;line-height: 120%;" class="objetVisuEleveBoutonFeedback"':'style="padding: 0px 0px 7px; margin-bottom: 8px; border-bottom: 1px solid transparent; line-height: 110%;"')+'><div style="height:100%;" class="InlineBlock AlignementMilieuVertical"></div><div class="InlineBlock AlignementMilieuVertical Italique">'+aFeedback+'</div></div>');if(lJqTd.height()>lJqTd.children('div').outerHeight()) lJqTd.children('div').height(lJqTd.height()-2-parseInt(lJqTd.children('div').css('paddingTop'))-parseInt(lJqTd.children('div').css('paddingBottom'))-parseInt(lJqTd.children('div').css('marginTop'))-parseInt(lJqTd.children('div').css('marginBottom')));};ObjetVisuEleve_Espace.prototype.desactiveEventSingleMulti=function(){$('[id^="'+this.Nom+'_q'+this.indiceQuestion+'_r"]').each(function(){if($(this).data('jIECheckBox')) $(this).data('jIECheckBox').destroy();$(this).replaceWith(function(){if($(this).is(':radio')){if($(this).is(':checked')){return'<span class="InlineBlock AlignementMilieuVertical Image_RadioB_Coche_Fenetre" style="margin-right:2px">&nbsp;</span>';} else{return'<span class="InlineBlock AlignementMilieuVertical Image_RadioB_Decoche_Fenetre" style="margin-right:2px">&nbsp;</span>';}} else if($(this).is(':checkbox')){if($(this).is(':checked')){return'<span class="InlineBlock AlignementMilieuVertical Image_CheckB_Coche_Fenetre" style="margin-right:2px">&nbsp;</span>';} else{return'<span class="InlineBlock AlignementMilieuVertical Image_CheckB_Decoche_Fenetre" style="margin-right:2px">&nbsp;</span>';}}});});};ObjetVisuEleve_Espace.prototype.composeAffichageCorrigeShortVrai=function(aSelecteur){$(aSelecteur).attr('title',function(){return this.value;}).parents('td:first').next('td').append('<div class="Image_QCM_CocheVerte" style="margin:10px;"></div>');};ObjetVisuEleve_Espace.prototype.composeAffichageCorrigeShortFaux=function(aSelecteur,aBonneReponse){$(aSelecteur).attr('title',function(){return this.value;}).parents('td:first').next('td').append('<div class="Image_QCM_CocheRouge" style="margin:10px;"></div>');$(aSelecteur).parents('table:first').find('.objetVisuEleveLabelCorrige').css('display','inline-block');$('#'+$(aSelecteur).attr('id').replace('_r','_corrige').escapeJQ()).append('<input type="text" class="objetVisuEleveInput" value="'+aBonneReponse+'" title="'+aBonneReponse+'" readonly />').parent().css('border-left','#e7e7e7 2px solid');};ObjetVisuEleve_Espace.prototype.composeAffichageCorrigeShortFeedback=function(aSelecteur,aCouleur,aFeedback){$('#'+$(aSelecteur).attr('id').replace('_r','_feedback').escapeJQ()).html(aFeedback);};ObjetVisuEleve_Espace.prototype.desactiveEventShort=function(){var lJqInput=$('#'+this.Nom.escapeJQ()+'_q'+this.indiceQuestion+'_r0');lJqInput.on('click focus',function(aEvent){$(this).blur();aEvent.preventDefault();aEvent.stopImmediatePropagation();return false;});};ObjetVisuEleve_Espace.prototype.composeAffichageCorrigeSpellVrai=function(aSelecteur){$(aSelecteur).parents('td:first').next('td').append('<div class="Image_QCM_CocheVerte" style="margin:0 10px;"></div>');};ObjetVisuEleve_Espace.prototype.composeAffichageCorrigeSpellFaux=function(aSelecteur,aBonneReponse){$(aSelecteur).parents('td:first').next('td').append('<div class="Image_QCM_CocheRouge" style="margin:0 10px;"></div>');$(aSelecteur).parents('table:first').find('.objetVisuEleveLabelCorrige').css('display','inline-block');$('#'+$(aSelecteur).last().attr('name').replace('_r','_corrige').escapeJQ()).append($.map(aBonneReponse.split(''),function(aVal){return'<input type="text" maxLength="1" size="1"'+' style="text-align:center;border:0;border-bottom:1px #000 solid;margin-right:5px;padding:0;width:22px;"'+' value="'+aVal+'" readonly />';}).join('')).parent().css('border-left','#e7e7e7 2px solid');};ObjetVisuEleve_Espace.prototype.composeAffichageCorrigeSpellFeedback=function(aSelecteur,aCouleur,aFeedback){$('#'+$(aSelecteur).last().attr('name').replace('_r','_feedback').escapeJQ()).html(aFeedback);};ObjetVisuEleve_Espace.prototype.desactiveEventSpell=function(){$('#'+this.idWrapperReponses.escapeJQ()+this.indiceQuestion).find('input[type="text"]').on('click focus',function(aEvent){$(this).blur();aEvent.preventDefault();aEvent.stopImmediatePropagation();return false;});};ObjetVisuEleve_Espace.prototype.composeMiseEnFormeCorrigeMatching=function(){var lWidth=$('[id^="'+this.Nom+'_q'+this.indiceQuestion+'_drop"]:first').width();$('[id^="'+this.Nom+'_q'+this.indiceQuestion+'_r"], [name^="'+this.Nom+'_q'+this.indiceQuestion+'_r"]').each(function(){$(this).width(lWidth);});$('[id^="'+this.Nom+'_q'+this.indiceQuestion+'_"], [name^="'+this.Nom+'_q'+this.indiceQuestion+'_"]').each(function(){$(this).height('');});var lMaxHeightReponse=0;$('[id^="'+this.Nom+'_q'+this.indiceQuestion+'_r"], [name^="'+this.Nom+'_q'+this.indiceQuestion+'_r"]').each(function(){lMaxHeightReponse=Math.max(lMaxHeightReponse,$(this).height());});$('[id^="'+this.Nom+'_q'+this.indiceQuestion+'_drop"]').each(function(){var lMaxHeight=Math.max(lMaxHeightReponse,$(this).height(),$('#'+this.id.replace('_drop','_assoc').escapeJQ()).height());$(this).height(lMaxHeight);$('#'+this.id.replace('_drop','_assoc').escapeJQ()).height(lMaxHeight);});};ObjetVisuEleve_Espace.prototype.composeAffichageReponseCorrigeMatching=function(aSelecteur,aAvecReponse,aCouleur){};ObjetVisuEleve_Espace.prototype.composeCorrigeReponseCorrigeMatching=function(aSelecteur,aId,aBonneReponse,aCorrige,aCouleur){$(aSelecteur).append('<li id="'+aId+'" style="padding:5px;border:1px solid '+(aBonneReponse?'#FFFFFF':'#CCCCCC')+';margin:5px;background-color:#fff;'+(aBonneReponse?GStyle.composeBoxShadow({x:0,y:0,blur:0,spread:0,opacity:0}):'')+'">'+(aBonneReponse?'&nbsp;':aCorrige)+'</li>');var lJqElementReponse=false;if($('#'+aId.replace('_c','_drop').escapeJQ()).data('dragId')) lJqElementReponse=$('#'+$('#'+aId.replace('_c','_drop').escapeJQ()).data('dragId').escapeJQ());$(aSelecteur.replace('objetVisuEleveAssocCorriges','objetVisuEleveAssocCoches')).append('<li id="'+aId.replace('_c','_image')+'" style="padding:5px;border:1px solid #FFFFFF;margin:5px;background-color:#fff;">'+(lJqElementReponse&&lJqElementReponse.text()?(aBonneReponse?'<div class="Image_QCM_CocheVerte"></div>':'<div class="Image_QCM_CocheRouge"></div>'):'<div style="width:16px;height:16px;"></div>')+'</li>');};ObjetVisuEleve_Espace.prototype.composeMiseEnFormeCorrigeReponseCorrigeMatching=function(aSelecteur){var lJqLicorrige=$('#'+aSelecteur.id.replace('_drop','_c').escapeJQ());if(lJqLicorrige.html()!=='&nbsp;'){lJqLicorrige.parents('td:first').css('border-left','#e7e7e7 2px solid');$(aSelecteur).parents('table:first').find('.objetVisuEleveLabelCorrige').css('display','inline-block');}
var lJqElementReponse=false;if($(aSelecteur).data('dragId')) lJqElementReponse=$('#'+$(aSelecteur).data('dragId').escapeJQ());var lHeight=Math.max($('#'+aSelecteur.id.replace('_drop','_assoc').escapeJQ()).height(),$('#'+aSelecteur.id.replace('_drop','_c').escapeJQ()).height());$(aSelecteur).height(lHeight);if(lJqElementReponse) lJqElementReponse.height(lHeight);$('#'+aSelecteur.id.replace('_drop','_c').escapeJQ()).height(lHeight);$('#'+aSelecteur.id.replace('_drop','_image').escapeJQ()).height(lHeight);};ObjetVisuEleve_Espace.prototype.desactiveEventMatching=function(aAsymetrie){$('#'+this.idWrapperAffichage.escapeJQ()+this.indiceQuestion+' .objetVisuEleveAssocChoix').css({height:1,width:1,margin:0,padding:0,borderColor:'transparent',overflow:'hidden'});this.actualiserHauteurQuestion();var lJqDrags=$('[id^="'+this.Nom+'_q'+this.indiceQuestion+'_r"], [name^="'+this.Nom+'_q'+this.indiceQuestion+'_r"]');var lAttrName=aAsymetrie?'name':'id';$('[id^="'+this.Nom+'_q'+this.indiceQuestion+'_drop"]').each(function(){if($(this).data('dragId')){var lJqUsedDrag=lJqDrags.filter('['+lAttrName+'="'+$(this).data('dragId')+'"]:first');lJqUsedDrag.offset($(this).offset()).draggable("disable").css({cursor:'default'}).addClass('ui-dropped');lJqDrags=lJqDrags.not(lJqUsedDrag);}});lJqDrags.hide();$('#'+this.idWrapperAffichage.escapeJQ()+this.indiceQuestion+' .objetVisuEleveAssocChoix').css({overflow:'visible'});};ObjetVisuEleve_Espace.prototype.composeMiseEnFormeReponseCorrigeCloze=function(aSelecteur,aCouleur,aTexte){var lSelecteur=$(aSelecteur);if(lSelecteur.parent().is('label')) lSelecteur=lSelecteur.parent();lSelecteur.replaceWith('<input class="objetVisuEleveInputCloze'+(aCouleur===this.couleurFaux?' Image_QCM_CocheRouge':' Image_QCM_CocheVerte')+'" style="background-position:right center;width:auto;height:auto;" readonly value="'+aTexte+'" />');};ObjetVisuEleve_Espace.prototype.composeMiseEnFormeWrapperEnonceCloze=function(aSelecteur){$(aSelecteur).wrapInner('<div class="EspaceBas" style="float:left;width:48%;padding-right:1%;border-right:#ccc 1px solid;overflow:auto;"></div>');};ObjetVisuEleve_Espace.prototype.composeMiseEnFormeWrapperCorrigeCloze=function(aSelecteur,aTexte){$(aSelecteur).append('<div class="EspaceBas" style="float:left;width:48%;padding-left:1%;overflow:auto;">'+aTexte+'</div>').removeClass('GrandEspaceHaut').css('clear','both').parent().prepend('<div class="Texte12">'+'<div class="EspaceHaut" style="float:left;width:48%;padding-right:1%;"></div>'+'<div class="EspaceHaut" style="float:left;width:48%;padding-left:1%;">'+'<span class="objetVisuEleveLabelCorrige" style="display:inline-block;">'+GTraductions.getValeur('ExecutionQCM.LabelCorrige')+'</span>'+'</div>'+'</div>');};ObjetVisuEleve_Espace.prototype.composeMiseEnFormeCorrectionCorrigeCloze=function(aTexte,aStyle){return'<input class="objetVisuEleveInputCloze" readonly value="'+aTexte+'" />';};ObjetVisuEleve_Espace.prototype.desactiveEventCloze=function(){$('#'+this.idWrapperEnonce.escapeJQ()+this.indiceQuestion).find('select, input[type="text"]').on('click focus',function(aEvent){$(this).blur();aEvent.preventDefault();aEvent.stopImmediatePropagation();return false;});};ObjetVisuEleve_Espace.prototype.composeMajReponsesSingleMulti=function(aSelecteur,aSelected){$(aSelecteur).inputChecked(aSelected).parents('.objetVisuEleveBouton').addClass('objetVisuEleveBoutonChecked');};ObjetVisuEleve_Espace.prototype.composeMajReponsesShort=function(aSelecteur,aTexte){$(aSelecteur).val(GChaine.enleverEntites(aTexte));};ObjetVisuEleve_Espace.prototype.composeMajReponsesSpell=function(aSelecteur,aTexte){$(aSelecteur).each(function(lIndex){$(this).val(GChaine.enleverEntites(aTexte[lIndex]));});};ObjetVisuEleve_Espace.prototype.composeMajReponsesMatching=function(aSelDrop,aBaseSelDrag,aReponse,aUsedId,aAsymetrie){var lJqDrop=$(aSelDrop),lJqDrag;if(aAsymetrie){lJqDrag=$('ul.objetVisuEleveAssocChoix [id^="'+aBaseSelDrag+'"]:contains('+aReponse+')').first();var lNewElement=lJqDrag.clone(false);lNewElement.attr('name',lNewElement.attr('id'));lNewElement.attr('id','');lNewElement.draggable({revert:'invalid',cursor:'move',helper:'original',cursorAt:{top:5,left:5},containment:'#'+this.idWrapperQuestion.escapeJQ()+' .jspPane',drag:this.onDrag});lJqDrag.after(lNewElement);lNewElement.offset(lJqDrop.offset());} else{lJqDrag=$('ul.objetVisuEleveAssocChoix [id^="'+aBaseSelDrag+'"]:contains('+aReponse+')').not('#'+aUsedId.join(', #').escapeJQ()).first();lJqDrag.offset(lJqDrop.offset());}
lJqDrop.data('dragId',lJqDrag.attr('id'));return lJqDrag.attr('id');};ObjetVisuEleve_Espace.prototype.composeMajReponsesCloze=function(aSelecteur,aReponse){$(aSelecteur).val(aReponse);};ObjetVisuEleve_Espace.prototype.getReponseMatching=function(aSelecteur){if($(aSelecteur).data('dragId')){var lJqElementReponse=$('#'+$(aSelecteur).data('dragId').escapeJQ());return lJqElementReponse.text();} else return'';};;

MethodesObjet.heritagePrototype(ObjetFicheVisuEleveQCM,ObjetFiche);function ObjetFicheVisuEleveQCM(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.IdContenu=this.Nom+'_Contenu';this.idScroll=this.Nom+'_scroll';this.largeurMax=GNavigateur.ClientL-12 ;this.hauteurMax=GNavigateur.ClientH-12-24 ;this.idVisuEleve=this.Nom+'_VisuEleve';this.objetVisuEleve=new ObjetVisuEleve_Espace(this.Nom+".objetVisuEleve",null,this,this.evenementVisuEleve);this.setOptions_Fiche({avecAbonnementBlocage:true,couleurBandeau:{fond:this.objetVisuEleve.couleurThemeQCM,texte:GCouleur.blanc}});}
ObjetFicheVisuEleveQCM.prototype.ComposeContenu=function(){var H=[];H.push('<div id="',this.idVisuEleve,'" style="position:relative;width:',this.largeurMax,'px;height:',this.hauteurMax,'px;overflow:hidden;"></div>');return H.join('');};ObjetFicheVisuEleveQCM.prototype.actualiserTaille=function(){this.largeurMax=GNavigateur.ClientL-12 ;this.hauteurMax=GNavigateur.ClientH-12-24 ;$('#'+this.idVisuEleve.escapeJQ()).css({width:this.largeurMax+'px',height:this.hauteurMax+'px'});};ObjetFicheVisuEleveQCM.prototype.GetTitre=function(){return'';};ObjetFicheVisuEleveQCM.prototype.setDonnees=function(aQCM){this.qcm=aQCM;if(!this.EnAffichage){this.actualiserTaille();this.Afficher(null,10,10);}
this.objetVisuEleve.setDonnees(this.qcm);this.setLibelleBandeau(this.objetVisuEleve.composeTitre());};ObjetFicheVisuEleveQCM.prototype.setDonneesReponse=function(aParam){if(this.EnAffichage) this.objetVisuEleve.setDonneesReponse(aParam);};ObjetFicheVisuEleveQCM.prototype.setParametres=function(aNumeroExecutionQCM,aModeProf){this.objetVisuEleve.setParametres({idContenu:this.idVisuEleve.escapeJQ(),numeroExecution:aNumeroExecutionQCM,modeProf:aModeProf!==undefined?aModeProf:false});};ObjetFicheVisuEleveQCM.prototype.evenementVisuEleve=function(aParam){this.callback.appel(aParam);};ObjetFicheVisuEleveQCM.prototype.surPreAffichage=function(){GPosition.setHeight(this.idScroll,this.hauteurMax);GPosition.setWidth(this.idScroll,this.largeurMax);};ObjetFicheVisuEleveQCM.prototype.Fermer=function(aSurInteractionUtilisateur){var lEnAffichage=this.EnAffichage;this.inherited('Fermer',aSurInteractionUtilisateur);this.qcm=undefined;this.objetVisuEleve.setParametres({idContenu:this.idVisuEleve.escapeJQ(),numeroExecution:null});var lSurInteractionUtilisateur=aSurInteractionUtilisateur===null||aSurInteractionUtilisateur===undefined?true:aSurInteractionUtilisateur;if(lEnAffichage&&lSurInteractionUtilisateur)
this.callback.appel({action:'croixFermeture'});};;
function ObjetRequeteSaisieQCMReponses(aPere,aEvenementSurReussite,aEvenementSurEchec){this.inheritedCreate(aPere,aEvenementSurReussite,aEvenementSurEchec);}
IE.Requetes.inscrire('SaisieQCMReponses',ObjetRequeteSaisieQCMReponses,_ObjetRequeteXmlSaisiePN);ObjetRequeteSaisieQCMReponses.prototype.lancerRequete=function(aParam){var P=this.XML;var lJSON={executionQCM:aParam.element.toJSON(),indiceQuestion:aParam.indiceQuestion,reponse:aParam.reponse,ressenti:aParam.ressenti,pourInitialisation:aParam.pourInitialisation,pourCloture:aParam.pourCloture};P.CreerVariable(null,'donnees',EGenreType.JSON,lJSON);this.appelAsynchroneSaisie();};ObjetRequeteSaisieQCMReponses.prototype.actionApresRequete=function(aXml){var lParam={};if(this.JSONReponse.etatCloture!==undefined) lParam.etatCloture=this.JSONReponse.etatCloture;if(this.JSONReponse.listeQuestions){lParam.listeQuestions=new ObjetListeElements().fromJSON(this.JSONReponse.listeQuestions,this._ajouterQuestion.bind(this));}
this.callbackReussite.appel(lParam);};ObjetRequeteSaisieQCMReponses.prototype._ajouterQuestion=function(aJSON,aElement){aElement.copieJSON(aJSON);if(aJSON.listeReponses) aElement.listeReponses=new ObjetListeElements().fromJSON(aJSON.listeReponses,this._ajouterReponse.bind(this));};ObjetRequeteSaisieQCMReponses.prototype._ajouterReponse=function(aJSON,aElement){aElement.copieJSON(aJSON);};;
function ObjetRequeteQCMQuestions(aPere,aEvenementSurReussite,aEvenementSurEchec){this.inheritedCreate(aPere,aEvenementSurReussite,aEvenementSurEchec);}
IE.Requetes.inscrire('ListeQCMQuestions',ObjetRequeteQCMQuestions,_ObjetRequeteXmlConsultationPN);ObjetRequeteQCMQuestions.prototype.lancerRequete=function(aParam){var P=this.XML;P.CreerElement(null,'element',aParam.element);if(aParam.indiceQuestion> -1) P.CreerVariable(null,'indiceQuestion',EGenreType.Integer,aParam.indiceQuestion);if(aParam.eleve) P.CreerElement(null,'eleve',aParam.eleve);this.appelAsynchroneConsultation();};ObjetRequeteQCMQuestions.prototype.actionApresRequete=function(aXml){var lParam={};if(this.JSONReponse.message){lParam.message=this.JSONReponse.message;} else{lParam.QCM=new ObjetElement().fromJSON(this.JSONReponse.QCM);lParam.QCM.copieJSON(this.JSONReponse.QCM);lParam.QCM.listeQuestions=new ObjetListeElements().fromJSON(this.JSONReponse.QCM.listeQuestions,this._ajouterQuestion.bind(this));}
this.callbackReussite.appel(lParam);};ObjetRequeteQCMQuestions.prototype._ajouterQuestion=function(aJSON,aElement){aElement.copieJSON(aJSON);aElement.nouvellePosition=aElement.position;if(aJSON.listeReponses) aElement.listeReponses=new ObjetListeElements().fromJSON(aJSON.listeReponses,this._ajouterReponse.bind(this));};ObjetRequeteQCMQuestions.prototype._ajouterReponse=function(aJSON,aElement){aElement.copieJSON(aJSON);};;
MethodesObjet.heritagePrototype(InterfaceFicheVisuEleveQCM,ObjetAbstraitInterface);function InterfaceFicheVisuEleveQCM(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.eleve=null;}
InterfaceFicheVisuEleveQCM.prototype.ConstruireInstances=function(){this.identFicheVisu=this.Add(window.ObjetFicheVisuEleveQCM,this.evenementSurVisuEleve,null);};InterfaceFicheVisuEleveQCM.prototype.setEtatFicheVisu=function(aParam){this.setParametres(aParam.numExecQCM,aParam.modeProf,aParam.eleve);this.setDonnees(aParam.donnees);};InterfaceFicheVisuEleveQCM.prototype.setParametres=function(aNumeroExecutionQCM,aModeProf,aEleve){if(aEleve) this.eleve=aEleve;this.GetInstance(this.identFicheVisu).setParametres(aNumeroExecutionQCM,aModeProf);};InterfaceFicheVisuEleveQCM.prototype.setDonnees=function(aParam){this.GetInstance(this.identFicheVisu).setDonnees(aParam);};InterfaceFicheVisuEleveQCM.prototype.evenementSurVisuEleve=function(aParam){if(aParam===undefined) return;this.param=aParam;if(this.param.action==='get'){if((GEtatUtilisateur.estEspaceEleve())&&aParam.pourInitialisation) new ObjetRequeteSaisieQCMReponses(this,this.actionSurQCMInitialisation).lancerRequete(this.param);else this.actionSurQCMInitialisation();} else if(this.param.action==='set'){new ObjetRequeteSaisieQCMReponses(this,this.actionSurSaisieReponses).lancerRequete(this.param);} else if(this.param.action==='close'){if(this.param.pourCloture&&GEtatUtilisateur.estEspaceEleve()){new ObjetRequeteSaisieQCMReponses(this,this.actionSurSaisieReponses).lancerRequete(this.param);this.callback.appel(this.param);}
if(this.GetInstance(this.identFicheVisu).EnAffichage) this.GetInstance(this.identFicheVisu).Fermer();} else if(this.param.action==='croixFermeture'){this.callback.appel({action:'close'});} else if(this.param.action==='masquerCroix'){this.GetInstance(this.identFicheVisu).masquerCroix();} else if(this.param.action==='afficherCroix'){this.GetInstance(this.identFicheVisu).afficherCroix();}};InterfaceFicheVisuEleveQCM.prototype.actionSurQCMInitialisation=function(){if(this.eleve) this.param.eleve=this.eleve;new ObjetRequeteQCMQuestions(this,this.actionSurSaisieQCMQuestions).lancerRequete(this.param);};InterfaceFicheVisuEleveQCM.prototype.actionSurSaisieQCMQuestions=function(aParam){this.GetInstance(this.identFicheVisu).setDonnees(aParam);};InterfaceFicheVisuEleveQCM.prototype.actionSurSaisieReponses=function(aParam){this.GetInstance(this.identFicheVisu).setDonneesReponse(aParam);};;
function ObjetRequetePageAccueil(aPere,aEvenementSurReussite,aEvenementSurEchec){this.inheritedCreate(aPere,aEvenementSurReussite,aEvenementSurEchec);}
IE.Requetes.inscrire('PageAccueil',ObjetRequetePageAccueil,_ObjetRequeteXmlConsultationPN);(function(){ObjetRequetePageAccueil.prototype.lancerRequete=function(aDonnees){var lXml=this.XML;this.JSON={};if(MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Eleve,EGenreEspace.Parent,EGenreEspace.Mobile_Eleve,EGenreEspace.Mobile_Parent])||GEtatUtilisateur.estModeAccessible())
lXml.CreerVariable(null,'DateDebut',EGenreType.Date,aDonnees.dateGrille);else lXml.CreerVariable(null,'NumeroSemaine',EGenreType.Cardinal,aDonnees.numeroSemaine);this.JSON.CDTNonSaisi=aDonnees.CDTNonSaisi;this.JSON.coursNonAssures=aDonnees.coursNonAssures;this.JSON.menuDeLaCantine=aDonnees.menuDeLaCantine;this.JSON.widgets=aDonnees.widgets;this.appelAsynchroneConsultation();};ObjetRequetePageAccueil.prototype.actionApresRequete=function(aXml){var lVieScolaire;if(this._recupererDonneesWidget(EGenreWidget.vieScolaire)&&this.JSONReponse.vieScolaire){this.autorisationsVS=this.JSONReponse.vieScolaire.autorisations;var lListeAbsences=new ObjetDeserialiser().listeEvenementsVS(this.JSONReponse.vieScolaire.listeAbsences,true);lListeAbsences.libelle=this.JSONReponse.vieScolaire.L;lVieScolaire={listeAbsences:this.JSONReponse.vieScolaire.listeAbsences.getListeElements(function(aElement){return!IE.MethodesTableau.existe(aElement.GetGenre(),[EGenreRessource.Incident])||!aElement.mesure||!aElement.mesure.publication||!lListeAbsences.GetElementParNumero(aElement.mesure.GetNumero());})};}
var lQCM;if(this._recupererDonneesWidget(EGenreWidget.QCM)){var lUtilitaireDeserialisation=new ObjetDeserialiser();lQCM={listeExecutionsQCM:this.JSONReponse.QCM?new ObjetListeElements().fromJSON(this.JSONReponse.QCM.listeExecutionsQCM,lUtilitaireDeserialisation._ajouterQCM.bind(lUtilitaireDeserialisation)):null};}
var lEDT;if(this._recupererDonneesWidget(EGenreWidget.EDT)&&this.JSONReponse.ListeCours)
lEDT={listeCours:new ObjetDeserialiser().listeCours(this.JSONReponse),avecCoursAnnule:aXml.GetVariable(null,'AvecCoursAnnule')};if(this._recupererDonneesWidget(EGenreWidget.Agenda)&&this.JSONReponse.agenda)
this.JSONReponse.agenda.listeEvenements=new ObjetDeserialiser().getListeEvenements(this.JSONReponse.agenda.listeEvenements);if(this._recupererDonneesWidget(EGenreWidget.Notes)&&this.JSONReponse.notes)
this.JSONReponse.notes.listeDevoirs=new ObjetListeElements().fromJSON(this.JSONReponse.notes.listeDevoirs,this._ajouterDevoir.bind(this));if(this._recupererDonneesWidget(EGenreWidget.competences)&&this.JSONReponse.competences){this.JSONReponse.competences.listePiliers=new ObjetListeElements();for(var i=0;i<this.JSONReponse.competences.listeEvaluations.GetNbrElements();i++){var lEvaluation=this.JSONReponse.competences.listeEvaluations.GetElement(i);for(var j=0;j<lEvaluation.listeNiveauxDAcquisitions.GetNbrElements();j++){var lNiveauDAcquisition=lEvaluation.listeNiveauxDAcquisitions.GetElement(j);var lPilier=this.JSONReponse.competences.listePiliers.GetElementParNumero(lNiveauDAcquisition.pilier.GetNumero());if(!lPilier)
this.JSONReponse.competences.listePiliers.AddElement(lNiveauDAcquisition.pilier);}}
this.JSONReponse.competences.listePiliers.setTri([ObjetTri.init('ordre')]);this.JSONReponse.competences.listePiliers.trier();}
var lAutorisationKiosque=!!this.JSONReponse.autorisationKiosque;this.callbackReussite.appel({QCM:lQCM,notes:this.JSONReponse.notes,vieScolaire:lVieScolaire,actualites:this.JSONReponse.actualites,discussions:this.JSONReponse.discussions,agenda:this.JSONReponse.agenda,menuDeLaCantine:this.JSONReponse.menuDeLaCantine,EDT:lEDT,travailAFaire:this.JSONReponse.travailAFaire,casier:this.JSONReponse.casier,appelNonFait:this.JSONReponse.appelNonFait,CDTNonSaisi:this.JSONReponse.CDTNonSaisi,conseilDeClasse:this.JSONReponse.conseilDeClasse,ressources:this.JSONReponse.ressources,kiosque:this.JSONReponse.kiosque,ressourcePedagogique:this.JSONReponse.ressourcePedagogique,devoirSurveille:this.JSONReponse.devoirSurveille,competences:this.JSONReponse.competences,penseBete:this.JSONReponse.penseBete,coursNonAssures:this.JSONReponse.coursNonAssures,devoirSurveilleEvaluation:this.JSONReponse.devoirSurveilleEvaluation},this.autorisationsVS,lAutorisationKiosque);};ObjetRequetePageAccueil.prototype._ajouterDevoir=function(aJSON,aDevoir){aDevoir.copieJSON(aJSON);if(aDevoir.masque)
aDevoir.note.setMasque(aDevoir.masque);};ObjetRequetePageAccueil.prototype._recupererDonneesWidget=function(aGenreWidget){if(this.JSON.widget)
return aGenreWidget===this.JSON.widget.GetGenre();return true;};}());;
function ObjetRequeteSaisieAccueil(aPere,aEvenementSurReussite,aEvenementSurEchec){this.inheritedCreate(aPere,aEvenementSurReussite,aEvenementSurEchec);}
IE.Requetes.inscrire('SaisieAccueil',ObjetRequeteSaisieAccueil,_ObjetRequeteXmlSaisiePN);(function(){ObjetRequeteSaisieAccueil.prototype.lancerRequete=function(aDonnees){var P=this.XML;if(aDonnees.actualites){aDonnees.actualites.listeActualites.setSerialisateurJSON({methodeSerialisation:_serialiserActualite.bind(this)});this.JSON.listeActualites=aDonnees.actualites.listeActualites;}
if(aDonnees.vieScolaire)
P.CreerListeElements(null,'ListeAbsences','Absence',aDonnees.vieScolaire.listeAbsences,this,_serialiserAbsence);this.appelAsynchroneSaisie();};function _serialiserActualite(aActualite,aJSON){aJSON.genrePublic=aActualite.genrePublic;aJSON.public=aActualite.public;aJSON.lue=aActualite.avecReponse||(aActualite.genreReponse===TypeGenreReponseInternetActualite.SansAR&&aActualite.lue);aJSON.marqueLueSeulement=aActualite.marqueLueSeulement?aActualite.marqueLueSeulement:false;if(!aJSON.marqueLueSeulement){aJSON.avecReponse=aActualite.avecReponse;if(aActualite.genreReponse>TypeGenreReponseInternetActualite.AvecAR&&aActualite.avecReponse){aJSON.valeurReponse=aActualite.valeurReponse;}}}
function _serialiserAbsence(aXml,aNoeud,aAbsence){aXml.CreerVariable(aNoeud,'EstLue' ,EGenreType.Boolean,aAbsence.estLue);aXml.CreerVariable(aNoeud,'Justification',EGenreType.String ,aAbsence.justification);aXml.CreerElement(aNoeud,'MotifParent' ,aAbsence.motifParent);aXml.CreerVariable(aNoeud,'ParentAAccuseDeReception' ,EGenreType.Boolean,aAbsence.parentAAccuseDeReception);}})();;
function ObjetRequeteFicheCDT(aPere,aEvenementSurReussite,aEvenementSurEchec){this.inheritedCreate(aPere,aEvenementSurReussite,aEvenementSurEchec);}
IE.Requetes.inscrire('FicheCDT',ObjetRequeteFicheCDT,_ObjetRequeteXmlConsultationPN);ObjetRequeteFicheCDT.prototype.lancerRequete=function(aParametres){var lParametres={cahierDeTextes:undefined,cours:undefined,numeroSemaine:undefined,matiere:undefined,date:undefined,contenu:undefined,TAF:undefined};$.extend(lParametres,aParametres);this.JSON={cahierDeTextes:lParametres.cahierDeTextes,cours:lParametres.cours,numeroSemaine:lParametres.numeroSemaine,matiere:lParametres.matiere,date:lParametres.date,contenu:lParametres.contenu,TAF:lParametres.TAF};this.appelAsynchroneConsultation();};ObjetRequeteFicheCDT.prototype.actionApresRequete=function(aXml){this.callbackReussite.appel(new ObjetDeserialiser().cahierDeTextes(aXml,aXml.GetCategorie(null,'CahierDeTextes'),true));};;
MethodesObjet.heritagePrototype(ObjetAffichagePageAccueil,ObjetInterfacePage);function ObjetAffichagePageAccueil(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);GEtatUtilisateur.widgets=GApplication.parametresUtilisateur.get('widgets')||[];this.genreEvenement={selectionPage:0,saisie:1};this.dateParDefaut=GApplication.getDateDemo()?GApplication.getDateDemo():GParametres.JourOuvre;this.numeroSemaineParDefaut=IE.Cycles.cycleDeLaDate(this.dateParDefaut);this.donneesRequete={dateGrille:this.dateParDefaut,numeroSemaine:this.numeroSemaineParDefaut,AppelNonFait:{date:this.dateParDefaut},CDTNonSaisi:{numeroSemaine:this.numeroSemaineParDefaut},coursNonAssures:{numeroSemaine:this.numeroSemaineParDefaut},menuDeLaCantine:{date:this.dateParDefaut}};this.idWrapper=this.Nom+'_defaut_';this.idColonne=this.Nom+'_colonne_';this.idWidgetsInvisibles=window.GUID.getId();this.suffixIdWrapper='_suffWrap';this.suffixIdContenu='_suffContent';this.suffixIdToutVoir='_suffToutVoir';this.suffixIdDeployer='_suffDeployer';this.idPremierObjet=this.Nom+'_premierObjet';this.classSansScroll='ObjetAffichagePageAccueilWidgetSansScroll';this._classActualiteSaisieDirect=IE.GUID.getClassCss();this.styles={hauteurTitre:23,largeurSeparateur:20,hauteurSeparateur:10,margeBasWidget:20,tailleBordureWidget:2,largeurColonneBouton:23};this.genreColonne={agendaEtInformations:{genre:0,position:4,minWidth:300,maxWidth:500,actif:false,visible:true},CDT:{genre:2,position:1,minWidth:300,maxWidth:600,actif:false,visible:true},notes:{genre:1,position:2,minWidth:300,maxWidth:600,actif:false,visible:true},emploiDuTemps:{genre:3,position:0,minWidth:GEtatUtilisateur.GenreEspace===EGenreEspace.Professeur||GEtatUtilisateur.GenreEspace===EGenreEspace.Etablissement?350:250,maxWidth:GEtatUtilisateur.GenreEspace===EGenreEspace.Professeur||GEtatUtilisateur.GenreEspace===EGenreEspace.Etablissement?550:250,actif:false,visible:true},absencesProf:{genre:4,position:3,minWidth:300,maxWidth:750,actif:false,visible:true}};this.listeFiches=[];this.avecNavigationCours=MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Professeur,EGenreEspace.Etablissement]);this.avecDeploiementWidget=MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Professeur,EGenreEspace.Etablissement]);this.avecToutVoir=!MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Professeur,EGenreEspace.Etablissement]);this.avecCompteur=MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Professeur,EGenreEspace.Etablissement]);this.tailleImages=17;this.autorisationsVS=null;this.donneesGrille={avecCoursAnnule:GEtatUtilisateur.getAvecCoursAnnule(),avecCoursAnnulesSuperposes:!GEtatUtilisateur.estEspacePourEleve(),numeroSemaine:null,listeCours:null,joursStage:null,date:null};Invocateur.abonner(Invocateur.events.modeExclusif,this._setModeExclusif,this);}(function(){ObjetAffichagePageAccueil.prototype.declarerWidgets=function(){this.donnees={EDT:{genre:EGenreWidget.EDT,genreColonne:this.genreColonne.emploiDuTemps.genre,id:window.GUID.getId(),page:{Onglet:EGenreOnglet.EmploiDuTemps},image:'WidgetEDT',existe:this.existeWidgetEDT,construire:this.construireWidgetEDT,position:0,poids:1,maximise:true,sansJScrollPane:true,sansReduction:true,semaineSelectionnee:this.numeroSemaineParDefaut,coursSelectionne:null},QCM:{genre:EGenreWidget.QCM,genreColonne:this.genreColonne.CDT.genre,id:window.GUID.getId(),page:null,image:'WidgetQCM',titre:GTraductions.getValeur('accueil.executionsQCM'),hint:GTraductions.getValeur('accueil.info.executionsQCM'),message:GTraductions.getValeur('accueil.AucuneExecutionsQCM'),existe:this.existeWidgetExecutionsQCM,construire:this.construireWidgetExecutionsQCM,position:2,poids:1,selecteurNavigationFleche:'[onclick]',classElementFocus:'ObjetAffichagePageAccueilElementAvecFocus'},notes:{genre:EGenreWidget.notes,genreColonne:this.genreColonne.notes.genre,id:window.GUID.getId(),page:{Onglet:EGenreOnglet.Releve},image:'WidgetNotes',titre:GTraductions.getValeur('accueil.dernieresNotes'),hint:GTraductions.getValeur('accueil.info.notes'),message:GTraductions.getValeur('accueil.aucuneNote'),existe:this.existeWidgetNotes,construire:this.construireWidgetNotes,position:1,poids:1,selecteurNavigationFleche:'[onclick]',classElementFocus:'ObjetAffichagePageAccueilElementAvecFocus',feminin:true},agenda:{genre:EGenreWidget.agenda,genreColonne:this.genreColonne.agendaEtInformations.genre,id:window.GUID.getId(),page:{Onglet:EGenreOnglet.Agenda},image:'WidgetAgenda',titre:GTraductions.getValeur('accueil.agenda.titre'),hint:GTraductions.getValeur('accueil.info.agenda'),message:GTraductions.getValeur('accueil.aucuneAgenda'),existe:this.existeWidgetAgenda,construire:this.construireWidgetAgenda,position:2,poids:1,selecteurNavigationFleche:'[onclick]',classElementFocus:'ObjetAffichagePageAccueilElementAvecFocus',semaineSelectionnee:this.numeroSemaineParDefaut},actualites:{genre:EGenreWidget.actualites,genreColonne:this.genreColonne.agendaEtInformations.genre,id:window.GUID.getId(),page:{Onglet:EGenreOnglet.Informations},image:'WidgetActualites',titre:GTraductions.getValeur('accueil.actualites'),hint:GTraductions.getValeur('accueil.info.actualites'),message:GTraductions.getValeur('accueil.aucuneActualite'),existe:this.existeWidgetActualites,construire:this.construireWidgetActualites,position:3,poids:2,selecteurNavigationFleche:'[onclick]',classElementFocus:'ObjetAffichagePageAccueilElementAvecFocus'},travailAFaire:{genre:EGenreWidget.travailAFaire,genreColonne:this.genreColonne.CDT.genre,id:window.GUID.getId(),page:{Onglet:EGenreOnglet.CDT_TAF},image:'WidgetTAF',titre:GTraductions.getValeur('accueil.travailAFaireAbbr'),hint:GTraductions.getValeur('accueil.info.travailAFaire'),message:GTraductions.getValeur('accueil.aucunTAF'),existe:this.existeWidgetTAF,construire:this.construireWidgetTAF,position:3,poids:1,selecteurNavigationFleche:'.ElmMatierePourNavigation',classElementFocus:'ObjetAffichagePageAccueilElementAvecFocus'},vieScolaire:{genre:EGenreWidget.vieScolaire,genreColonne:this.genreColonne.notes.genre,id:window.GUID.getId(),page:{Onglet:GEtatUtilisateur.existeGenreOnglet(EGenreOnglet.Absences_Liste)?EGenreOnglet.Absences_Liste:EGenreOnglet.Absences_Recapitulatif},image:'WidgetVieScolaire',titre:GTraductions.getValeur('accueil.vieScolaire'),hint:GTraductions.getValeur('accueil.info.viescolaire'),message:GTraductions.getValeur('accueil.aucuneAbsence'),existe:this.existeWidgetVieScolaire,construire:this.construireWidgetVieScolaire,position:0,poids:1,selecteurNavigationFleche:'[onclick]',classElementFocus:'ObjetAffichagePageAccueilElementAvecFocus'},menuDeLaCantine:{genre:EGenreWidget.menuDeLaCantine,genreColonne:this.genreColonne.agendaEtInformations.genre,id:window.GUID.getId(),page:{Onglet:EGenreOnglet.Menus},image:'WidgetMenu',titre:GTraductions.getValeur('accueil.menu'),hint:GTraductions.getValeur('accueil.info.menu'),message:GTraductions.getValeur('accueil.pasDeMenu'),existe:this.existeWidgetMenu,construire:this.construireWidgetMenu,position:6,poids:1,selecteurNavigationFleche:'[onclick]',classElementFocus:'ObjetAffichagePageAccueilElementAvecFocus',semaineSelectionnee:this.numeroSemaineParDefaut},discussions:{genre:EGenreWidget.discussions,genreColonne:this.genreColonne.agendaEtInformations.genre,id:window.GUID.getId(),page:{Onglet:EGenreOnglet.Messagerie},image:'WidgetDiscussions',titre:GTraductions.getValeur('accueil.discussions.titre'),hint:GTraductions.getValeur('accueil.info.discussions'),message:GTraductions.getValeur('accueil.aucunMessage'),existe:this.existeWidgetDiscussions,construire:this.construireWidgetDiscussions,position:4,poids:1,selecteurNavigationFleche:'[onclick]',classElementFocus:'ObjetAffichagePageAccueilElementAvecFocus',feminin:true},casier:{genre:EGenreWidget.casier,genreColonne:this.genreColonne.agendaEtInformations.genre,id:window.GUID.getId(),page:{Onglet:EGenreOnglet.Casier_MonCasier},image:'WidgetCasier',titre:GTraductions.getValeur('accueil.casier.titre'),hint:GTraductions.getValeur('accueil.casier.titre'),message:GTraductions.getValeur('accueil.casier.message'),existe:this.existeWidgetCasier,construire:this.construireWidgetCasier,position:5,poids:1,selecteurNavigationFleche:'[onclick]',classElementFocus:'ObjetAffichagePageAccueilElementAvecFocus'},penseBete:{genre:EGenreWidget.penseBete,genreColonne:GEtatUtilisateur.GenreEspace===EGenreEspace.Etablissement?this.genreColonne.agendaEtInformations.genre:this.genreColonne.absencesProf.genre,id:window.GUID.getId(),image:'WidgetPenseBete',titre:GTraductions.getValeur('accueil.penseBete.titre'),hint:'',message:'',existe:this.existeWidgetPenseBete,construire:this.construireWidgetPenseBete,position:0,poids:1,tailleFixe:true,sansJScrollPane:true,selecteurNavigationFleche:'[onclick]',classElementFocus:'ObjetAffichagePageAccueilElementAvecFocus',couleurFond:ObjetAffichagePageAccueil.couleurWidgetPenseBete,couleurBordure:ObjetAffichagePageAccueil.couleurWidgetPenseBete},appelNonFait:{genre:EGenreWidget.appelNonFait,genreColonne:GEtatUtilisateur.GenreEspace===EGenreEspace.Etablissement?this.genreColonne.agendaEtInformations.genre:this.genreColonne.absencesProf.genre,id:window.GUID.getId(),page:{Onglet:GEtatUtilisateur.existeGenreOnglet(EGenreOnglet.SaisieAbsences_AppelEtSuivi)?EGenreOnglet.SaisieAbsences_AppelEtSuivi:EGenreOnglet.SaisieAbsences_Appel},image:'WidgetAppelNonFait',titre:GTraductions.getValeur('accueil.appelNonFait.titre'),hint:'',message:GTraductions.getValeur('accueil.appelNonFait.message'),existe:this.existeWidgetAppelNonFait,construire:this.construireWidgetAppelNonFait,position:1,poids:1,selecteurNavigationFleche:'[onclick]',classElementFocus:'ObjetAffichagePageAccueilElementAvecFocus',jourSelectionne:this.dateParDefaut},CDTNonSaisi:{genre:EGenreWidget.CDTNonSaisi,genreColonne:this.genreColonne.absencesProf.genre,id:window.GUID.getId(),page:{Onglet:EGenreOnglet.SaisieCahierDeTextes},image:'WidgetCDTNonSaisi',titre:GTraductions.getValeur('accueil.CDTNonSaisi.titre'),hint:'',message:GTraductions.getValeur('accueil.CDTNonSaisi.message'),existe:this.existeWidgetCDTNonSaisi,construire:this.construireWidgetCDTNonSaisi,position:2,poids:1,selecteurNavigationFleche:'[onclick]',classElementFocus:'ObjetAffichagePageAccueilElementAvecFocus',semaineSelectionnee:this.numeroSemaineParDefaut},conseilDeClasse:{genre:EGenreWidget.conseilDeClasse,genreColonne:this.genreColonne.absencesProf.genre,id:window.GUID.getId(),page:null,image:'WidgetCDC',titre:GTraductions.getValeur('accueil.CDC.titre'),hint:'',existe:this.existeWidgetCDC,construire:this.construireWidgetCDC,position:4,poids:1,selecteurNavigationFleche:'[onclick]',classElementFocus:'ObjetAffichagePageAccueilElementAvecFocus'},ressources:{genre:EGenreWidget.ressources,genreColonne:this.genreColonne.absencesProf.genre,id:window.GUID.getId(),page:null,image:'WidgetRessources',titre:GEtatUtilisateur.existeGenreOnglet(EGenreOnglet.ProgrammesBO)?GTraductions.getValeur('accueil.ressources.titreAvecBO'):GTraductions.getValeur('accueil.ressources.titreSansBO'),hint:'',existe:this.existeWidgetRessources,construire:this.construireWidgetRessources,position:5,poids:1,selecteurNavigationFleche:'[onclick]',classElementFocus:'ObjetAffichagePageAccueilElementAvecFocus',feminin:true},kiosque:{genre:EGenreWidget.kiosque,genreColonne:this.genreColonne.absencesProf.genre,id:window.GUID.getId(),page:null,image:'WidgetKiosque',titre:GTraductions.getValeur('accueil.kiosque.titre'),hint:'',existe:this.existeWidgetKiosque,construire:this.construireWidgetKiosque,position:6,poids:1,selecteurNavigationFleche:'[onclick]',classElementFocus:'ObjetAffichagePageAccueilElementAvecFocus'},ressourcePedagogique:{genre:EGenreWidget.ressourcePedagogique,genreColonne:this.genreColonne.CDT.genre,id:window.GUID.getId(),page:{Onglet:EGenreOnglet.RessourcePedagogique},image:'WidgetRessourcePedagogique',titre:GTraductions.getValeur('accueil.ressourcePedagogique.titre'),message:GTraductions.getValeur('accueil.ressourcePedagogique.aucuneRessourcePedagogique'),hint:GTraductions.getValeur('accueil.ressourcePedagogique.info'),existe:this.existeWidgetRessourcePedagogique,construire:this.construireWidgetRessourcePedagogique,position:4,poids:1,selecteurNavigationFleche:'[onclick]',classElementFocus:'ObjetAffichagePageAccueilElementAvecFocus',feminin:true},devoirSurveille:{genre:EGenreWidget.DS,genreColonne:this.genreColonne.CDT.genre,id:window.GUID.getId(),image:'WidgetDS',titre:GTraductions.getValeur('accueil.DS.titre'),hint:GTraductions.getValeur('accueil.DS.hint'),existe:this.existeWidgetDS,construire:this.construireWidgetDS,genreDS:EGenreLienDS.tGL_Devoir,position:0,poids:1,selecteurNavigationFleche:'[onclick]',classElementFocus:'ObjetAffichagePageAccueilElementAvecFocus'},devoirSurveilleEvaluation:{genre:EGenreWidget.DSEvaluation,genreColonne:this.genreColonne.CDT.genre,id:window.GUID.getId(),image:'WidgetDSEvaluation',titre:GTraductions.getValeur('accueil.DSEvaluation.titre'),hint:GTraductions.getValeur('accueil.DSEvaluation.hint'),existe:this.existeWidgetDSEvaluation,construire:this.construireWidgetDSEvaluation,genreDS:EGenreLienDS.tGL_Evaluation,position:1,poids:1,selecteurNavigationFleche:'[onclick]',classElementFocus:'ObjetAffichagePageAccueilElementAvecFocus'},competences:{genre:EGenreWidget.competences,genreColonne:this.genreColonne.notes.genre,id:window.GUID.getId(),page:{Onglet:EGenreOnglet.BulletinCompetences},image:'WidgetCompetences',titre:GTraductions.getValeur('accueil.competences.titre'),hint:GTraductions.getValeur('accueil.competences.hint'),message:'',existe:this.existeWidgetCompetences,construire:this.construireWidgetCompetences,position:2,poids:1,selecteurNavigationFleche:'[onclick]',classElementFocus:'ObjetAffichagePageAccueilElementAvecFocus',feminin:true},coursNonAssures:{genre:EGenreWidget.coursNonAssures,genreColonne:this.genreColonne.absencesProf.genre,id:window.GUID.getId(),page:{Onglet:EGenreOnglet.CoursNonAssures},image:'WidgetCoursNonAssures',titre:GTraductions.getValeur('accueil.coursNonAssures.titre'),hint:'',message:GTraductions.getValeur('accueil.coursNonAssures.message'),existe:this.existeWidgetCoursNonAssures,construire:this.construireWidgetCoursNonAssures,position:3,poids:1,selecteurNavigationFleche:'[onclick]',classElementFocus:'ObjetAffichagePageAccueilElementAvecFocus',semaineSelectionnee:IE.Cycles.cycleDeLaDate(GApplication.getDateDemo()?GApplication.getDateDemo():new Date())}};};ObjetAffichagePageAccueil.prototype.getWidget=function(aGenre){switch(aGenre){case(EGenreWidget.discussions):return this.donnees.discussions;case(EGenreWidget.casier):return this.donnees.casier;case(EGenreWidget.appelNonFait):return this.donnees.appelNonFait;case(EGenreWidget.CDTNonSaisi):return this.donnees.CDTNonSaisi;case(EGenreWidget.conseilDeClasse):return this.donnees.conseilDeClasse;case(EGenreWidget.menuDeLaCantine):return this.donnees.menuDeLaCantine;case(EGenreWidget.vieScolaire):return this.donnees.vieScolaire;case(EGenreWidget.travailAFaire):return this.donnees.travailAFaire;case(EGenreWidget.agenda):return this.donnees.agenda;case(EGenreWidget.actualites):return this.donnees.actualites;case(EGenreWidget.notes):return this.donnees.notes;case(EGenreWidget.QCM):return this.donnees.QCM;case(EGenreWidget.EDT):return this.donnees.EDT;case(EGenreWidget.ressources):return this.donnees.ressources;case(EGenreWidget.kiosque):return this.donnees.kiosque;case(EGenreWidget.ressourcePedagogique):return this.donnees.ressourcePedagogique;case(EGenreWidget.DS):return this.donnees.devoirSurveille;case(EGenreWidget.aide):return this.donnees.aide;case(EGenreWidget.competences):return this.donnees.competences;case(EGenreWidget.coursNonAssures):return this.donnees.coursNonAssures;case(EGenreWidget.penseBete):return this.donnees.penseBete;case(EGenreWidget.DSEvaluation):return this.donnees.devoirSurveilleEvaluation;}};ObjetAffichagePageAccueil.prototype.ConstruireInstances=function(){this.declarerWidgets();this.ficheCDT=this.Add(window.ObjetFicheCDT,this.evenementSurFicheCDT,null);this.interfaceFicheVisu=this.Add(window.InterfaceFicheVisuEleveQCM,this.evenementSurVisuEleve,null);this.ajouterEvenementGlobal(EEvent.SurPreResize,this.SurPreResize);this.ajouterEvenementGlobal(EEvent.SurPostResize,this.SurPostResize);};ObjetAffichagePageAccueil.prototype.SetParametresGeneraux=function(){this.GenreStructure=EStructureAffichage.Autre;};ObjetAffichagePageAccueil.prototype.ConstruireStructureAffichageAutre=function(){var H=[];H.push('<div style="position:relative;width:100%;height:100%;">');H.push(GObjetWAI.composeSpan(GEtatUtilisateur.listeOnglets.GetElementParGenre(EGenreOnglet.Accueil).GetLibelle(),this.idPremierObjet));H.push('<div tabindex="-1" id="',this.idWrapper,'" style="height:100%;width:100%;">');H.push('</div>');H.push('</div>');return H.join('');};ObjetAffichagePageAccueil.prototype.actualiserColonnes=function(){var H=[],lColonnes=[],i,j,lLignes=[];for(i in this.genreColonne){if(this.genreColonne[i].actif){lColonnes[this.genreColonne[i].position]=i;}}
H.push('<table class="Texte10" style="width:100%;height:100%;table-layout:fixed;border-spacing:',this.styles.largeurSeparateur,'px ',this.styles.hauteurSeparateur,'px;">');H.push('<tr>');for(i=0;i<lColonnes.length;i++) if(lColonnes[i]){lLignes=[];for(j in this.donnees){if(this.donnees[j]&&this.donnees[j].construire&&this.donnees[j].existe.bind(this)()&&this.donnees[j].genreColonne===this.genreColonne[lColonnes[i]].genre){lLignes[this.donnees[j].position]=j;}}
H.push('<td id="',this.idColonne,this.genreColonne[lColonnes[i]].genre,'" style="','padding:0;',(GNavigateur.isTactile?'width:'+this.genreColonne[lColonnes[i]].minWidth+'px':''),'" class="AlignementHaut">');for(j=0;j<lLignes.length;j++) if(lLignes[j]){H.push('<div id="',this.donnees[lLignes[j]].id,'" style="','margin-bottom:',this.styles.margeBasWidget,'px;','"></div>');}
H.push('</td>');}
H.push('<td id="',this.idWidgetsInvisibles,'" class="AlignementHaut AlignementDroit"></td>');H.push('</tr>');H.push('</table>');$('#'+this.idWrapper.escapeJQ()).IEHtml(H.join(''),{controleur:this.controleur});};ObjetAffichagePageAccueil.prototype.initialiserPage=function(aInstance){};ObjetAffichagePageAccueil.prototype.addFiche=function(aFiche){this.listeFiches.push(aFiche);};ObjetAffichagePageAccueil.prototype.fermerFiches=function(){for(var i=0;i<this.listeFiches.length;i++) if(this.listeFiches[i]){this.listeFiches[i].Fermer();}};ObjetAffichagePageAccueil.prototype.RecupererDonnees=function(aWidgets){if(aWidgets){this.donneesRequete.widgets=aWidgets;new ObjetRequetePageAccueil(this,this.actionSurRecupererDonneesDeWidget).lancerRequete(this.donneesRequete);} else{if(GInterface.GetInstance(GInterface.IdentBandeauEntete)){var lIFCBandeau=GInterface.GetInstance(GInterface.IdentBandeauEntete);lIFCBandeau.GetInstance(lIFCBandeau.identMenuOnglets)._fermer();}
this.SetEtatSaisie(false);new ObjetRequetePageAccueil(this,this.actionSurRecupererDonnees).lancerRequete(this.donneesRequete);}};ObjetAffichagePageAccueil.prototype.actionSurRecupererDonnees=function(aObjet,aAutorisationVS,aAutorisationKiosque){GEtatUtilisateur.autorisationKiosque=aAutorisationKiosque;GInterface.setVisibleKiosque(GEtatUtilisateur.autorisationKiosque);if(GEtatUtilisateur.avecPageAccueil())
this.traiterDonnees(aObjet);GEtatUtilisateur.premierChargement=false;this.autorisationsVS=aAutorisationVS;this.fermerFiches();if(GNavigateur.isTactile) this.resize();};ObjetAffichagePageAccueil.prototype.actionSurRecupererDonneesDeWidget=function(aObjet){if(GEtatUtilisateur.avecPageAccueil()){$.extend(true,this.donnees,aObjet);this.traiterDonneesEDT();for(var i in aObjet){if(aObjet[i]){if(this.donnees[i]&&this.donnees[i].construire&&this.donnees[i].existe.bind(this)()) this.donnees[i].construire.bind(this)();this.resizeColonne(this.donnees[i].genreColonne);}}}};ObjetAffichagePageAccueil.prototype.traiterDonneesEDT=function(){this.donneesGrille.date=this._getDateGrille();this.donneesGrille.numeroSemaine=this.donneesRequete.numeroSemaine;this.donneesGrille.listeCours=this.donnees.EDT.listeCours;if(!GEtatUtilisateur.getAvecChoixCoursAnnule()){GEtatUtilisateur.setAvecCoursAnnule(this.donnees.EDT.avecCoursAnnule);this.donneesGrille.avecCoursAnnule=GEtatUtilisateur.getAvecCoursAnnule();}};ObjetAffichagePageAccueil.prototype.traiterDonnees=function(aObjet){var i,lGenreColonne,lSelf=this;function _estDonneeVisibleDeColonne(aEle,aIndex){return aEle&&aEle.construire&&aEle.existe.call(lSelf)&&aEle.genreColonne===lGenreColonne?true:undefined;}
$.extend(true,this.donnees,aObjet);this.DonneesRecues=true;this.donneesRequete.widget=null;this.traiterDonneesEDT();for(i in this.genreColonne){lGenreColonne=this.genreColonne[i].genre;this.genreColonne[i].actif=$.map(this.donnees,_estDonneeVisibleDeColonne).length>0;this.genreColonne[i].visible=$.map(this.donnees,_estDonneeVisibleDeColonne).length>0;}
if(GEtatUtilisateur.estModeAccessible()){this.AfficherListe();} else{this.actualiserAffichage();this.surResizeInterface();}};ObjetAffichagePageAccueil.prototype.actualiserAffichage=function(){function _focusin(){$(this).css('box-shadow','0 0 5px -1px '+GCouleur.noir+' inset');}
function _focusout(){$(this).css('box-shadow','none');}
function _keyup(event){if(event.which===ToucheClavier.RetourChariot||event.which===ToucheClavier.Espace){event.data.aObjet.evenementPage(event.data.aObjet.genreEvenement.selectionPage,event.data.aPage);}
event.stopPropagation();}
function _getWidgetsPourSelecNavig(aEle){return aEle.selecteurNavigationFleche?aEle:undefined;}
function _keyupPourSelecFocus(event){if(event.which===ToucheClavier.FlecheBas){$(this).find('#'+event.data.idContent.escapeJQ()).find(event.data.selecteur+':first').attr('tabIndex',function(aI,aVal){return aVal!==undefined?aVal:'-1';}).focus();}}
function _keyupPourSelecNavig(event){if(event.which===ToucheClavier.FlecheBas||event.which===ToucheClavier.FlecheHaut){var lJqDataJsp=$(this).parents('#'+event.data.idWrapper.escapeJQ()).data('jsp'),lJqEleNavig=$(this).parents('#'+event.data.idWrapper.escapeJQ()).find(event.data.selecteur),lIndex=lJqEleNavig.index(this)+(event.which===ToucheClavier.FlecheBas?1:-1);if(lIndex<0||lIndex>=lJqEleNavig.length) return;if(lJqDataJsp) lJqDataJsp.scrollToElement(lJqEleNavig[lIndex]);$(lJqEleNavig[lIndex]).attr('tabIndex',function(aI,aVal){return aVal!==undefined?aVal:'-1';}).focus();event.stopPropagation();} else if(event.which===ToucheClavier.RetourChariot){$(this).trigger('click');}}
function _addClassSelecNavig(event){$(this).addClass(event.data.classFocus);}
function _removeClassSelecNavig(event){$(this).removeClass(event.data.classFocus);}
var i,lWidgetSelecFocus=[];if(!this.DonneesRecues) return'';this.actualiserColonnes();for(i in this.donnees){if(this.donnees[i]&&this.donnees[i].construire&&this.donnees[i].existe.bind(this)()) this.donnees[i].construire.bind(this)();}
$('[id$="'+this.suffixIdWrapper+'"]').on('focusin',function(){$(this).css('box-shadow','0 0 5px 1px '+GCouleur.bordure+' inset');}).on('focusout',function(){$(this).css('box-shadow','none');});lWidgetSelecFocus=$.map(this.donnees,_getWidgetsPourSelecNavig);for(i=0;i<lWidgetSelecFocus.length;i++) if(lWidgetSelecFocus[i]){$('#'+lWidgetSelecFocus[i].id.escapeJQ()+this.suffixIdWrapper).on('keyup',{idContent:lWidgetSelecFocus[i].id+this.suffixIdContenu,selecteur:lWidgetSelecFocus[i].selecteurNavigationFleche},_keyupPourSelecFocus).on('keyup',lWidgetSelecFocus[i].selecteurNavigationFleche,{idWrapper:lWidgetSelecFocus[i].id+this.suffixIdWrapper,selecteur:lWidgetSelecFocus[i].selecteurNavigationFleche},_keyupPourSelecNavig).on('focus',lWidgetSelecFocus[i].selecteurNavigationFleche,{classFocus:lWidgetSelecFocus[i].classElementFocus},_addClassSelecNavig).on('blur',lWidgetSelecFocus[i].selecteurNavigationFleche,{classFocus:lWidgetSelecFocus[i].classElementFocus},_removeClassSelecNavig);}
$('#'+this.Nom.escapeJQ()+' input').jIECheckBox() ;if(GApplication.getModeExclusif())
this._setModeExclusif(true);$(window).trigger('resize');};ObjetAffichagePageAccueil.prototype._setModeExclusif=function(aModeExclusif){$('#'+this.donnees.actualites.id.escapeJQ()+' .'+this._classActualiteSaisieDirect).inputDisabled(aModeExclusif);$('input:checkbox[id^="'+(this.Nom+'_inputVS_').escapeJQ()+'"] ').inputDisabled(aModeExclusif);};ObjetAffichagePageAccueil.prototype.construireWidgetsInvisibles=function(){GHtml.setHtml(this.idWidgetsInvisibles,this.composeWidgetsInvisibles(),{controleur:this.controleur});};ObjetAffichagePageAccueil.prototype.composeWidgetsInvisibles=function(aWidget){var H=[];for(var i in this.donnees){var lWidget=this.donnees[i];if(lWidget&&lWidget.construire&&lWidget.existe.bind(this)()&&GEtatUtilisateur.widgets[lWidget.genre]&&!GEtatUtilisateur.widgets[lWidget.genre].visible){H.push('<div class="AvecMain ',lWidget.image,'" title="',lWidget.titre,'" onclick="'+this.Nom+'._surFermer (',lWidget.genre,', true)" style="clear:both;float:right;"></div>');}}
return H.join('');};ObjetAffichagePageAccueil.prototype.construireWidget=function(aWidget){if(!GEtatUtilisateur.widgets[aWidget.genre])
GEtatUtilisateur.widgets[aWidget.genre]={visible:true,deploye:true};GHtml.setHtml(aWidget.id,this.composeWidget(aWidget),{controleur:this.controleur});this._surDeployer(aWidget.genre,false);this._surFermer(aWidget.genre,false);};ObjetAffichagePageAccueil.prototype.actualiserWidget=function(aWidget){GHtml.setHtml(aWidget.id+this.suffixIdContenu,aWidget.html,{controleur:this.controleur});GHtml.setHtml(aWidget.id+'_TitreText',aWidget.titre+(aWidget.nbrElements>0?' ('+aWidget.nbrElements+')':''),{controleur:this.controleur});this.resizeColonne(aWidget.genreColonne);};ObjetAffichagePageAccueil.prototype.composeWidget=function(aWidget){var H=[];var lBordure=EGenreBordure.gauche+EGenreBordure.droite+EGenreBordure.bas;H.push(this.composeTitre(aWidget));H.push('<div ',GObjetWAI.composeRole(EGenreRole.Tree),' class="AlignementHaut" style="',GStyle.composeCouleur(aWidget.couleurFond?aWidget.couleurFond:GCouleur.blanc,GCouleur.noir),GStyle.composeCouleurBordure(aWidget.couleurBordure?aWidget.couleurBordure:GCouleur.themeCouleur.claire,this.styles.tailleBordureWidget,lBordure),'">');H.push('<div id="',aWidget.id,this.suffixIdWrapper,'" ',GObjetWAI.composeAttribut({genre:EGenreAttribut.labelledby,valeur:aWidget.id+'_TitreText'}),' ',' style="height:auto;overflow:',(aWidget.sansJScrollPane?'hidden':'auto'),';',(aWidget.maxHeight?'max-height:'+aWidget.maxHeight+'px;':''),'" class="',(aWidget.sansJScrollPane?' '+this.classSansScroll:''),'"',' tabIndex="0">');H.push('<div id="',aWidget.id,this.suffixIdContenu,'" style="height:100%;width:100%;">');H.push(aWidget.afficherMessage&&aWidget.message?'<div class="PetitEspace">'+aWidget.message+'</div>':aWidget.html);H.push('</div>');H.push('</div>');H.push('</div>');return H.join('');};ObjetAffichagePageAccueil.prototype.composeTitre=function(aWidget){var lExistePage=aWidget.page&&GEtatUtilisateur.existeGenreOnglet(aWidget.page.Onglet);var H=[];H.push('<div id="',aWidget.id,'_Titre" title="'+aWidget.hint+'" class="TitreSectionAccueil" style="height:',this.styles.hauteurTitre,'px;width:100%;',GStyle.composeCouleur(aWidget.couleurFond?aWidget.couleurFond:GCouleur.themeCouleur.claire,GCouleur.texte),'">');H.push('<table class="Tableau" style="width:100%;height:100%" border="0" cellpadding="0" cellspacing="0"><tr>');if(aWidget.titre){H.push('<td style="width:100%;">');H.push('<div style="position:relative;width:100%;" class="Texte11">&nbsp;<div',(aWidget.hint?'':' ie-ellipsis'),lExistePage&&!this.avecToutVoir?' onclick="'+this.Nom+'._surToutVoir('+aWidget.genre+')"':'',' style="position:absolute;top:0;left:0;width:100%;height:100%;" id="',aWidget.id,'_TitreText" class="',(aWidget.hint?'ie-ellipsis ':''),'Texte11 Gras PetitEspaceGauche PetitEspaceDroit NoWrap',lExistePage&&!this.avecToutVoir?' LienAccueil':'','">');H.push(aWidget.titre);H.push((aWidget.nbrElements>0)&&this.avecCompteur?' ('+aWidget.nbrElements+')':'');H.push('</div></div>');H.push('</td>');}
if(aWidget.idMrFiche){H.push('<td>');H.push('<div id="'+aWidget.idMrFiche+'"></div>');H.push('</td>');}
H.push('<td>','&nbsp;','</td>');if(aWidget.idSelecteurDate){H.push('<td>');H.push('<div id="'+aWidget.idSelecteurDate+'"></div>');H.push('</td>');}
if(aWidget.idCombo){H.push('<td>');H.push('<div id="'+aWidget.idCombo+'"></div>');H.push('</td>');}
if(aWidget.idBouton){H.push('<td>');H.push('<div id="'+aWidget.idBouton+'"></div>');H.push('</td>');}
if(this.avecToutVoir){H.push('<td class="Insecable AlignementDroit">');if(lExistePage)
H.push(this.composeToutVoir(aWidget));}
H.push('</td>');if(this.avecDeploiementWidget){if(aWidget&&aWidget.sansReduction!==true){H.push('<td>');H.push('<div id="',aWidget.id,this.suffixIdDeployer,'" class="AvecMain WidgetReduire" onclick="'+this.Nom+'._surDeployer (',aWidget.genre,', true)"></div>');H.push('</td>');}
H.push('<td>');H.push('<div class="AvecMain WidgetFermer" onclick="'+this.Nom+'._surFermer (',aWidget.genre,', true)"></div>');H.push('</td>');}
H.push('</tr></table>');H.push('</div>');return H.join('');};ObjetAffichagePageAccueil.prototype.composeToutVoir=function(aWidget){var H=[];H.push('<div id="'+aWidget.id+this.suffixIdToutVoir+'" '+GObjetWAI.composeRole(EGenreRole.Button),' title="',GTraductions.getValeur('accueil.toutVoir'),'"',' class="LienAccueil Gras PetitEspaceDroit"',' onclick="'+this.Nom+'._surToutVoir(',aWidget.genre,')"',' tabIndex="0"','>',GTraductions.getValeur('accueil.toutVoir'),'</div>');return H.join('');};ObjetAffichagePageAccueil.prototype._surToutVoir=function(aGenre){var lWidget=this.getWidget(aGenre);if(lWidget&&lWidget.semaineSelectionnee) GEtatUtilisateur.SetSemaineSelectionnee(lWidget.semaineSelectionnee);else if(lWidget&&lWidget.jourSelectionne) GEtatUtilisateur.setNavigationDate(lWidget.jourSelectionne);if(lWidget&&lWidget.coursSelectionne) GEtatUtilisateur.setNavigationCours(lWidget.coursSelectionne);this.evenementPage(this.genreEvenement.selectionPage,lWidget.page);};ObjetAffichagePageAccueil.prototype._surFermer=function(aGenre,aChangerEtat){var lWidget=this.getWidget(aGenre),i=0;if(aChangerEtat){GEtatUtilisateur.widgets[lWidget.genre].visible=!GEtatUtilisateur.widgets[lWidget.genre]||!GEtatUtilisateur.widgets[lWidget.genre].visible;GApplication.parametresUtilisateur.set('widgets',GEtatUtilisateur.widgets);}
if(this.getWidget(aGenre))
GStyle.setDisplay(this.getWidget(aGenre).id,!GEtatUtilisateur.widgets[lWidget.genre]||GEtatUtilisateur.widgets[lWidget.genre].visible);this.construireWidgetsInvisibles();if(aChangerEtat){var lEstMasquee=false;for(i in this.genreColonne) if(this.genreColonne[i].genre===lWidget.genreColonne){lEstMasquee=!this.genreColonne[i].visible;}
var lDevientMasquee=!this.resizeColonne(lWidget.genreColonne);if(lDevientMasquee||(lEstMasquee&&!lDevientMasquee)) $(window).trigger('resize');}};ObjetAffichagePageAccueil.prototype._surDeployer=function(aGenre,aChangerEtat){var lWidget=this.getWidget(aGenre);if(lWidget){if(aChangerEtat){GEtatUtilisateur.widgets[lWidget.genre].deploye=!GEtatUtilisateur.widgets[lWidget.genre].deploye;GApplication.parametresUtilisateur.set('widgets',GEtatUtilisateur.widgets);}
GHtml.setClass(lWidget.id+this.suffixIdDeployer,!GEtatUtilisateur.widgets[lWidget.genre]||GEtatUtilisateur.widgets[lWidget.genre].deploye?'AvecMain WidgetReduire':'AvecMain WidgetAgrandir');GStyle.setDisplay(lWidget.id+this.suffixIdContenu,!GEtatUtilisateur.widgets[lWidget.genre]||GEtatUtilisateur.widgets[lWidget.genre].deploye);if(aChangerEtat) this.resizeColonne(lWidget.genreColonne);}};ObjetAffichagePageAccueil.prototype.evenementPage=function(aEvenement,aDonnees){switch(aEvenement){case this.genreEvenement.selectionPage:if(aDonnees.message)
GApplication.getMessage().Afficher(EGenreBoiteMessage.Information,aDonnees.message);else{GEtatUtilisateur.setPage(aDonnees);if(GEtatUtilisateur.getGenreOnglet()){var lOnglet=new ObjetElement('',0,GEtatUtilisateur.getGenreOnglet());if(GInterface.GetInstance(GInterface.IdentBandeauEntete)) GInterface.GetInstance(GInterface.IdentBandeauEntete).evenementSurMenuOnglets(lOnglet);}}
break;case this.genreEvenement.saisie:new ObjetRequeteSaisieAccueil(this,this.actionSurSaisie).lancerRequete(aDonnees);break;default:;break;}};ObjetAffichagePageAccueil.prototype.resize=function(){var i=0,j=0,lWidthTotal=0,lWidthMax=0,lWidthMin=0,lPoidsTotal=0,lTailleParPoids=0,lCalcWidth=0,lMinimalWidth=0,lWidgets=[],lColonnes=[],lWidth=[];function _getExiste(aEle){return!!aEle;}
$('#'+(this.Nom).escapeJQ()+' > div').css('display','none');lWidthTotal=$('#'+(this.Nom).escapeJQ()).width()-(2*this.styles.largeurSeparateur);$('#'+(this.Nom).escapeJQ()+' > div').css('display','');for(i in this.genreColonne){if(this.genreColonne[i].actif&&this.genreColonne[i].visible){lColonnes[this.genreColonne[i].position]=this.genreColonne[i];lWidthMax+=this.genreColonne[i].maxWidth+this.styles.largeurSeparateur;lWidthMin+=this.genreColonne[i].minWidth+this.styles.largeurSeparateur;}}
lColonnes=$.grep(lColonnes,_getExiste);lWidthTotal-=this.styles.largeurColonneBouton;if(lWidthTotal>lWidthMax){for(i in lColonnes){$(('#'+this.idColonne+lColonnes[i].genre).escapeJQ()).width(lColonnes[i].maxWidth);}} else if(lWidthTotal<lWidthMin||GNavigateur.isTactile){for(i in lColonnes){$(('#'+this.idColonne+lColonnes[i].genre).escapeJQ()).width(lColonnes[i].minWidth);}} else{for(i in lColonnes) if(lColonnes[i].minWidth===lColonnes[i].maxWidth){$(('#'+this.idColonne+lColonnes[i].genre).escapeJQ()).width(lColonnes[i].minWidth);lWidthTotal-=(lColonnes[i].minWidth+this.styles.largeurSeparateur);lColonnes[i]=undefined;}
lColonnes=$.grep(lColonnes,_getExiste);lMinimalWidth=lWidthTotal;for(i in lColonnes){lMinimalWidth=Math.min(lMinimalWidth,lColonnes[i].minWidth+this.styles.largeurSeparateur);}
for(i in lColonnes){lColonnes[i].poids=Math.round(10*(lColonnes[i].minWidth+this.styles.largeurSeparateur)/lMinimalWidth)/10;lPoidsTotal+=lColonnes[i].poids;}
lTailleParPoids=Math.floor((lWidthTotal-this.styles.largeurSeparateur*lColonnes.length)/lPoidsTotal);for(i in lColonnes){lCalcWidth=lColonnes[i].poids*lTailleParPoids;lWidth[i]=Math.floor(lCalcWidth);}
for(i in lColonnes){$(('#'+this.idColonne+lColonnes[i].genre).escapeJQ()).width(lWidth[i]);}}
for(i in this.genreColonne){if(this.genreColonne[i].actif){this.resizeColonne(this.genreColonne[i].genre);}}};ObjetAffichagePageAccueil.prototype.resizeColonne=function(aGenreColonne){var i,lColonne,lHeightColonne=0,lPoidsTotal=0,lTailleTotale=0,lTailleDispo=0,lPoidsARetailler=0,lTailleParPoids=0,lWidgets=[],lWidgetsHeight=[],lTailleWidgetOK=[],lJqWidgets;function _getIdDeCle(aEle){return aEle.id;}
function _getPoidsDeCle(aEle){return aEle.poids;}
function _estMaximise(aEle){return!!aEle.maximise;}
function _getExiste(aEle){return!!aEle;}
for(i in this.genreColonne) if(this.genreColonne[i].genre===aGenreColonne){lColonne=this.genreColonne[i];}
$(('#'+this.idColonne+aGenreColonne).escapeJQ()).show();lColonne.visible=true;$(('#'+this.idColonne+aGenreColonne).escapeJQ()+' [id$="'+this.suffixIdWrapper+'"]').each(function(){if($(this).data('jsp')) $(this).data('jsp').destroy();});$('#'+(this.idWrapper).escapeJQ()).parent().height(1);lHeightColonne=$('#'+(this.Nom).escapeJQ()).height()-(2*this.styles.hauteurSeparateur);$('#'+(this.idWrapper).escapeJQ()).parent().height('100%');for(i in this.donnees){if(this.donnees[i]&&this.donnees[i].genreColonne===aGenreColonne&&this.donnees[i].construire&&this.donnees[i].existe.bind(this)()&&GEtatUtilisateur.widgets[this.donnees[i].genre]&&GEtatUtilisateur.widgets[this.donnees[i].genre].visible){lWidgets[this.donnees[i].position]=this.donnees[i];if(!this.donnees[i].tailleFixe)
lPoidsTotal+=this.donnees[i].poids;}}
lWidgets=$.grep(lWidgets,_getExiste);if(lWidgets.length===0){$(('#'+this.idColonne+aGenreColonne).escapeJQ()).hide();lColonne.visible=false;return false;}
lJqWidgets=$('#'+($.map(lWidgets,_getIdDeCle).join(', #')).escapeJQ()).filter(':visible');lJqWidgets.find('[id$="'+this.suffixIdWrapper+'"]').height('');lWidgetsHeight=lJqWidgets.map(function(aEle){return $(this).outerHeight(true);}).get();for(i=0;i<lWidgetsHeight.length;i++) if(lWidgetsHeight[i]){lTailleTotale+=lWidgetsHeight[i];}
if(!GNavigateur.isTactile&&(lTailleTotale>=lHeightColonne||$.grep(lWidgets,_estMaximise).length>0)){lTailleDispo=lHeightColonne;for(i=0;i<lWidgets.length;i++) if(lWidgets[i]){lTailleWidgetOK[i]=lWidgets[i].tailleFixe||(!lWidgets[i].maximise&&(lWidgetsHeight[i]<=(lHeightColonne*_getPoidsDeCle(lWidgets[i])/lPoidsTotal)));}
for(i=0;i<lTailleWidgetOK.length;i++){if(lTailleWidgetOK[i]) lTailleDispo-=lWidgetsHeight[i];else lPoidsARetailler+=_getPoidsDeCle(lWidgets[i]);}
lTailleParPoids=lTailleDispo/lPoidsARetailler;for(i=0;i<lTailleWidgetOK.length;i++) if(!lTailleWidgetOK[i]){$('#'+_getIdDeCle(lWidgets[i]).escapeJQ()).find('[id$="'+this.suffixIdWrapper+'"]').height(Math.floor(lTailleParPoids*_getPoidsDeCle(lWidgets[i]))-this.styles.hauteurTitre-this.styles.margeBasWidget-this.styles.tailleBordureWidget);}}
$(('#'+this.idColonne+aGenreColonne).escapeJQ()+' [id$="'+this.suffixIdWrapper+'"]').not('.'+this.classSansScroll).each(function(){if($(this).height()<parseInt($(this).prop('scrollHeight'))-1||$(this).width()<parseInt($(this).prop('scrollWidth'))-1){$(this).jScrollPane({showArrows:true,enableKeyboardNavigation:false});}});return true;};ObjetAffichagePageAccueil.prototype.actionSurSaisie=function(){this.RecupererDonnees();};ObjetAffichagePageAccueil.prototype.SurPreResize=function(){$('#'+(this.Nom).escapeJQ()+' > div').css('display','none');};ObjetAffichagePageAccueil.prototype.SurPostResize=function(){$('#'+(this.Nom).escapeJQ()+' > div').css('display','');if(!GEtatUtilisateur.estModeAccessible()){if(GEtatUtilisateur.avecPageAccueil()){this.resize();}}};ObjetAffichagePageAccueil.prototype.surResizeInterface=function(){this.inherited('surResizeInterface');if(GEtatUtilisateur.estModeAccessible()){this.AfficherListe();}};ObjetAffichagePageAccueil.prototype.SurValidation=function(){this.Valider();};ObjetAffichagePageAccueil.prototype.Valider=function(){if(this.donnees.actualites.listeActualites.existeElementPourValidation()||this.donnees.vieScolaire.listeAbsences.existeElementPourValidation())
this.evenementPage(this.genreEvenement.saisie,this.donnees);};ObjetAffichagePageAccueil.prototype._actionSurRequeteFicheCDT=function(aGenreAffichageCDT ,aCahierDeTextes){if(this.ficheCDT>=0) this.GetInstance(this.ficheCDT).Fermer();this.GetInstance(this.ficheCDT).SetDonnees(this.idPositionFicheCDT,aCahierDeTextes.Matiere,aCahierDeTextes.ListeTravailAFaire,aGenreAffichageCDT,aCahierDeTextes);};ObjetAffichagePageAccueil.prototype.evenementSurFicheCDT=function(aParam){if(aParam&&aParam.executionQCM)
this.afficherExecutionQCM(aParam.executionQCM);else this._gestionFocus_apresFicheCDT(aParam);};ObjetAffichagePageAccueil.prototype._gestionFocus_apresFicheCDT=function(aGenreEvenement){if(this.idPositionFicheCDT) GHtml.setFocus(this.idPositionFicheCDT);};ObjetAffichagePageAccueil.prototype.afficherExecutionQCM=function(aExecutionQCM){this.GetInstance(this.interfaceFicheVisu).setParametres(aExecutionQCM.GetNumero(),GApplication.getDemo()||(GEtatUtilisateur.GenreEspace===EGenreEspace.Professeur)||((GEtatUtilisateur.GenreEspace===EGenreEspace.Parent||GEtatUtilisateur.GenreEspace===EGenreEspace.Entreprise)&&(aExecutionQCM.etatCloture===undefined||aExecutionQCM.etatCloture===TypeEtatExecutionQCMPourRepondant.EQR_EnCours)));this.GetInstance(this.interfaceFicheVisu).setDonnees(aExecutionQCM);};})();;
MethodesObjet.heritagePrototype(ObjetListeArborescente,Identite);function ObjetListeArborescente(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.noeudsOuverts=true;this.avecValidation=false;}(function(){var AltImagePlus=". Noeud fermé. ";var AltImageMoins=". Noeud ouvert. ";var AltImageVide=". Noeud vide. ";ObjetListeArborescente.prototype.getClassTexte=function(){return'Texte14';};ObjetListeArborescente.prototype.getLineHeightTexte=function(){return'line-height:18px;';};ObjetListeArborescente.prototype.ConstruireAffichage=function(aHeight){var H=[];H.push('<div id="'+this.Nom+'" class="'+this.getClassTexte()+' ObjetListeArborescente" style="'+this.getLineHeightTexte()+'height:'+(aHeight?aHeight+'px':'100%')+';overflow:hidden;"></div>');return H.join('');};ObjetListeArborescente.prototype.SetDonnees=function(aNoeudListe){var lNoeudListe=null;GHtml.setTabIndex(this.Nom,'-1');if(arguments.length>1){lNoeudListe=Array.prototype.shift.call(arguments);for(var x in arguments) if(x!=='length') this._ajouterDesFreresAuNoeud(arguments[x],lNoeudListe);} else lNoeudListe=aNoeudListe;if(lNoeudListe){var DivRacine=GHtml.getElement(this.Nom) ;this._ajouterUnFilsAuNoeud(lNoeudListe,DivRacine);$('#'+this.Nom.escapeJQ()).find('li').filter(function(){return $(this).attr('aria-expanded')==="false";}).each(function(){var myChild=$(this).children('ul');$(this).data('myChild',myChild.get(0));myChild.detach();});this.ajouterEvenements();$('#'+this.Nom.escapeJQ()).jScrollPane({showArrows:true}).find('li:first').attr('tabIndex','0').focus();}};ObjetListeArborescente.prototype.setFocus=function(){$('#'+this.Nom.escapeJQ()).find('li:first').attr('tabIndex','0').focus();};ObjetListeArborescente.prototype.ajouterEvenements=function(){$('#'+this.Nom.escapeJQ()).on('focus','li',{aObjet:this},this.focusSurLi).on('blur','li',{aObjet:this},this.blurSurLi).on('click','li[aria-expanded]',{aObjet:this},this.ouvrirFermerLi).on('keyup','li',{aObjet:this},this.seDeplacer);};ObjetListeArborescente.prototype.setParametres=function(aOuvert,aAvecValidation){this.noeudsOuverts=(((aOuvert!==null&&aOuvert!==undefined))?aOuvert:true);this.avecValidation=aAvecValidation;};ObjetListeArborescente.prototype.GetListeArborescente=function(){$('#'+this.Nom.escapeJQ()).data('jsp').destroy();var lDomNode=$('#'+this.Nom.escapeJQ()).clone();this.ajouterEvenements();$('#'+this.Nom.escapeJQ()).jScrollPane({showArrows:true});lDomNode.attr('id','').css({height:'',overflow:''});return lDomNode.get(0);};ObjetListeArborescente.prototype.SetTitreImpression=function(ATitre){this.TitreImpression=ATitre;};ObjetListeArborescente.prototype.GetTitreImpression=function(){return this.TitreImpression;};ObjetListeArborescente.prototype.construireRacine=function(){var lJqRacine=$('<ul></ul>');lJqRacine.attr({'role':'tree','aria-multiselectable':'false'});return lJqRacine.get(0);};ObjetListeArborescente.prototype._construireNoeud=function(AId,ALibelle,AClass,ADeroule,APremierElement,ALevel){var LClass=(AClass?AClass:''+this.getClassTexte());var LClassWai="wai_hidden";var lJqNoeud=$('<li></li>');lJqNoeud.attr({'tabIndex':'-1','role':'treeitem','aria-selected':'false','aria-checked':'false','aria-level':ALevel?ALevel:'','aria-expanded':(ADeroule!==null&&ADeroule!==undefined)?(ADeroule?'true':'false'):(this.noeudsOuverts?'true':'false'),'class':this.getClassTexte()+' AvecMain'}).data({'avecValidation':this.avecValidation,'callback':this.callback});var lJqImg=$('<span>&nbsp;</span>');lJqImg.attr({'role':'presentation','class':((ADeroule!==null&&ADeroule!==undefined)?(ADeroule?'Image_FermetureDeploiement':'Image_Deploiement'):(this.noeudsOuverts?'Image_FermetureDeploiement':'Image_Deploiement'))+' InlineBlock','alt':'','title':GTraductions.getValeur('ClicListeArbo')});var lJqSpan=$('<span></span>');lJqSpan.addClass(LClass).html(ALibelle.ucfirst());var lJqSpanWai=$('<span></span>');lJqSpanWai.addClass(LClassWai).html((ADeroule!==null&&ADeroule!==undefined)?(ADeroule?AltImageMoins:AltImagePlus):(this.noeudsOuverts?AltImageMoins:AltImagePlus));lJqNoeud.append(lJqImg,lJqSpan,lJqSpanWai);var LNoeud=lJqNoeud.get(0);return LNoeud;};ObjetListeArborescente.prototype._construireNoeudGroupe=function(AId,ADeroule){var lJqNoeud=$('<ul></ul>');lJqNoeud.attr({'role':'tree','aria-setsize':'0','style':'display:'+((ADeroule!==null&&ADeroule!==undefined)?(ADeroule?"block":"none"):(this.noeudsOuverts?"block":"none"))+';visibility:'+((ADeroule!==null&&ADeroule!==undefined)?(ADeroule?"visible":"hidden"):(this.noeudsOuverts?"visible":"hidden"))+';','class':this.getClassTexte()+' SansMain'});return $(lJqNoeud).get(0);};ObjetListeArborescente.prototype.ConstruireFeuille=function(AId,ALibelle,AClass,ALevel){var LClass=(AClass?AClass:this.getClassTexte()+' SansMain');var lJqFeuille=$('<li></li>');lJqFeuille.attr({'tabIndex':'-1','role':'treeitem','aria-selected':'false','aria-checked':'false','aria-level':ALevel,'class':LClass}).html(ALibelle.ucfirst()+'<span class="wai_hidden">.</span>').data({'isFeuille':true});var LFeuille=lJqFeuille.get(0);return LFeuille;};ObjetListeArborescente.prototype.focusSurLi=function(event){var lThis=event.data.aObjet;$(this).attr({"aria-selected":"true","aria-checked":"true"});};ObjetListeArborescente.prototype.blurSurLi=function(event){var lThis=event.data.aObjet;$(this).attr({"aria-selected":"false","aria-checked":"false"});};ObjetListeArborescente.prototype.ouvrirFermerLi=function(event){event.stopImmediatePropagation();var lThis=event.data.aObjet;if($(this).attr("aria-expanded")==="true"){$(this).children('span:first-child').removeClass('Image_FermetureDeploiement').addClass('Image_Deploiement').end().children('span.wai_hidden').html(AltImagePlus).end().children('ul').css({'display':"none","visibility":"hidden"}).end().attr("aria-expanded","false");var myChild=$(this).children('ul');$(this).data('myChild',myChild.get(0));myChild.detach();$(this).children('span.wai_hidden').focus();$(this).focus();} else{$(this).append($(this).data('myChild'));$(this).data("myChild",undefined);$(this).children('span:first-child').removeClass('Image_Deploiement').addClass('Image_FermetureDeploiement').end().children('span.wai_hidden').html(AltImageMoins).end().children('ul').css({'display':"block","visibility":"visible"}).end().attr("aria-expanded","true");$(this).children('span.wai_hidden').focus();$(this).focus();}
if($(this).parent().attr("role")!=="tree") $(this).parent().focus();if($('#'+lThis.Nom.escapeJQ()).data('jsp')){var lElementActif=GHtml.getElementEnFocus();$('#'+lThis.Nom.escapeJQ()).data('jsp').destroy();lThis.ajouterEvenements();$('#'+lThis.Nom.escapeJQ()).jScrollPane({showArrows:true});$(lElementActif).focus();}};ObjetListeArborescente.prototype.seDeplacer=function(event){event.stopImmediatePropagation();var lThis=event.data.aObjet;if(GNavigateur.IsToucheFlecheGauche()){if($(this).attr('aria-expanded')==='true') $(this).click();else $(this).parent('ul').parent('li').focus();} else if(GNavigateur.IsToucheFlecheDroite()){if($(this).attr('aria-expanded')){if($(this).attr('aria-expanded')==='false') $(this).click();else $(this).children('ul').children('li:first-child').focus();}} else if(GNavigateur.IsToucheFlecheBas()){if($(this).attr('aria-expanded')==='true'&&$(this).children('ul').children('li:first-child').length>0) $(this).children('ul').children('li:first-child').focus();else if($(this).next().length===1) $(this).next().focus();else $(this).parent('ul').parent('li').next().focus();} else if(GNavigateur.IsToucheFlecheHaut()){if($(this).prev().attr('aria-expanded')==='true'&&$(this).prev().children('ul').children('li:last-child').length>0) $(this).prev().children('ul').children('li:last-child').focus();else if($(this).prev().length===1) $(this).prev().focus();else $(this).parent('ul').parent('li').focus();} else if(GNavigateur.IsToucheSelection()){if($(this).attr('aria-expanded')) $(this).click();}
$('#'+lThis.Nom.escapeJQ()).data('jsp').scrollToElement(document.activeElement);};ObjetListeArborescente.prototype._ajouterUnFilsAuNoeud=function(AFils,ANoeud){$(ANoeud).append(AFils);};ObjetListeArborescente.prototype._ajouterDesFreresAuNoeud=function(aGroupeFrere,aNoeud){$(aGroupeFrere).children().each(function(){$(aNoeud).append(this);});};ObjetListeArborescente.prototype.ajouterUneFeuilleAuNoeud=function(ANoeud,AId,ALibelle,AClass){var LLevel=(this._getLevelParent(ANoeud)+1);var LSize=(this._getSizeParent(ANoeud)+1);var LFeuille=this.ConstruireFeuille(AId,(ALibelle?ALibelle:''),AClass,LLevel);this._ajouterUnFilsAuNoeud(LFeuille,ANoeud);if(ANoeud.getAttribute("role")==="tree"){ANoeud.setAttribute("aria-setsize",LSize);for(var I=0;I<ANoeud.childNodes.length;I++){if(ANoeud.childNodes[I].getAttribute("role")==="treeitem") ANoeud.childNodes[I].setAttribute("aria-setsize",LSize);}}
return LFeuille;};ObjetListeArborescente.prototype.ajouterUnNoeudAuNoeud=function(aNoeud,aId,aLibelle,aClass,aDeroule,aPremierElement){var lLevel=(this._getLevelParent(aNoeud)+1);var lSize=(this._getSizeParent(aNoeud)+1);var lNoeudFils=this._construireNoeud(aId,(aLibelle?aLibelle:''),aClass,aDeroule,aPremierElement,lLevel);var lGroupeNoeudFils=this._construireNoeudGroupe(aId+'_groupe',aDeroule);this._ajouterUnFilsAuNoeud(lNoeudFils,aNoeud);this._ajouterUnFilsAuNoeud(lGroupeNoeudFils,lNoeudFils);if(aNoeud.getAttribute("role")==="treegroup"){aNoeud.setAttribute("aria-setsize",lSize);for(var I=0;I<aNoeud.childNodes.length;I++){if(aNoeud.childNodes[I].getAttribute("role")==="treeitem") aNoeud.childNodes[I].setAttribute("aria-setsize",lSize);}}
return lGroupeNoeudFils;};ObjetListeArborescente.prototype.construireUnNoeudPourNoeud=function(aNoeud,aId,aLibelle,aClass,aDeroule,aPremierElement){var lLevel=(this._getLevelParent(aNoeud)+1);var lNoeudFils=this._construireNoeud(aId,(aLibelle?aLibelle:''),aClass,aDeroule,aPremierElement,lLevel);var lGroupeNoeudFils=this._construireNoeudGroupe(aId+'_groupe',aDeroule);this._ajouterUnFilsAuNoeud(lGroupeNoeudFils,lNoeudFils);return{noeud:lNoeudFils,container:lGroupeNoeudFils};};ObjetListeArborescente.prototype.ajouterArbreNoeudAuNoeud=function(aNoeud,aNoeudFils){var lSize=(this._getSizeParent(aNoeud)+1);this._ajouterUnFilsAuNoeud(aNoeudFils,aNoeud);if(aNoeud.getAttribute("role")==="tree"){aNoeud.setAttribute("aria-setsize",lSize);for(var I=0;I<aNoeud.childNodes.length;I++){if(aNoeud.childNodes[I].getAttribute("role")==="treeitem") aNoeud.childNodes[I].setAttribute("aria-setsize",lSize);}}};ObjetListeArborescente.prototype._getLevelParent=function(AElement){return(AElement.getAttribute("role")==="tree")&&(AElement.previousSibling)&&(AElement.previousSibling.getAttribute("aria-level"))?parseInt(AElement.previousSibling.getAttribute("aria-level")):0;};ObjetListeArborescente.prototype._getSizeParent=function(AElement){return(AElement.getAttribute("role")==="tree")&&(AElement.getAttribute("aria-setsize"))?parseInt(AElement.getAttribute("aria-setsize")):0;};}());;
var EGenreRepas={Midi:0,Soir:1};;

function ObjetUtilitaireAbsence(){this.maxLengthCommentaire=200;}
ObjetUtilitaireAbsence.prototype.getSaisieObservation=function(aObservation,aCallBack,aID){var H=[];H.push('<div style="padding:2px 0px 0px 0px;">','<input type="checkbox" id="',aID,'" class="AvecMain" style="padding:0px; margin:0px;" onclick="',aCallBack,'" ',(aObservation.estLue?'checked disabled ':''),'/>','<label for="',aID,'" class="Texte10" style="padding:0px 2px; margin:0px; line-height:13px;">&nbsp;',GTraductions.getValeur('AbsenceVS.observationLu'),'</label>','</div>');return H.join('');};ObjetUtilitaireAbsence.prototype.getARdePunition=function(aAbsence,aCallBack,aID){var H=[];H.push('<div style="padding:2px 0px 0px 0px;">','<input type="checkbox" id="',aID,'" class="AvecMain" style="padding:0px; margin:0px;" onclick="',aCallBack,'" ',(aAbsence.parentAAccuseDeReception?'checked disabled ':''),'/>','<label for="',aID,'" class="Texte10" style="padding:0px 2px; margin:0px; line-height:13px;">&nbsp;',GTraductions.getValeur('AbsenceVS.accuseDeReception'),'</label>','</div>');return H.join('');};ObjetUtilitaireAbsence.prototype.getInfoAbsenceAccessible=function(aAbsence,aPourAccueil){var H=[];switch(aAbsence.Genre){case EGenreRessource.ObservationProfesseurEleve:H.push(this.getMatiere(aAbsence,false,true));H.push(this.getCommentaire(aAbsence,false,false));break;case EGenreRessource.Absence:H.push(this.getHeuresCoursManquees(aAbsence));if(!aPourAccueil) H.push(this.getDemiJournees(aAbsence));break;case EGenreRessource.AbsenceRepas:break;case EGenreRessource.AbsenceInternat:break;case EGenreRessource.Retard:break;case EGenreRessource.Infirmerie:H.push(this.getSymptomesMedicaux(aAbsence,true,false));H.push(this.getActesMedicaux(aAbsence,true,false));break;case EGenreRessource.Exclusion:case EGenreRessource.Punition:case EGenreRessource.Sanction:case EGenreRessource.Incident:case EGenreRessource.MesureConservatoire:for(var I=0;I<aAbsence.listeMotifs.GetNbrElements();I++)
H.push('<span>',aAbsence.listeMotifs.GetLibelle(I),'</span><br>');if(aAbsence.circonstances)
H.push('<span>',aAbsence.circonstances,'</span><br>');if(aAbsence.travailAFaire)
H.push('<span>',GTraductions.getValeur('AbsenceVS.travailAFaire'),' : ',aAbsence.travailAFaire,'</span><br>');var lIndividu=this.getDemandeurDecideur(aAbsence);if(lIndividu)
H.push('<span>',lIndividu,'</span><br>');break;default:break;}
return H.join('');};ObjetUtilitaireAbsence.prototype.getMotifAbsence=function(aObjet){var lTitle='';var lResult='';var lMotif='';if(aObjet.donnee.reglee||(aObjet.donnee.listeMotifs&&aObjet.donnee.listeMotifs.GetNbrElements()>0)){if(GEtatUtilisateur.GenreEspace===EGenreEspace.Parent&&aObjet.donnee.message&&aObjet.enListe){lTitle='ie-hint="'+(aObjet.donnee.message.replace?aObjet.donnee.message.replace(/\n/g,'<br />'):aObjet.donnee.message)+'"';}
lMotif=aObjet.donnee.listeMotifs.getTableauLibelles().join(', ');if(aObjet.donnee.reglee&&aObjet.donnee.listeMotifs.GetNbrElements()===0)
lMotif=GTraductions.getValeur('AbsenceVS.sansMotif').ucfirst();if((aObjet.donnee.GetGenre()===EGenreRessource.Absence||aObjet.donnee.GetGenre()===EGenreRessource.Retard)&&!aObjet.donnee.justifie){if(lMotif){lMotif+=' ('+GTraductions.getValeur('AbsenceVS.sansRaisonValable')+')';} else{lMotif=GTraductions.getValeur('AbsenceVS.sansRaisonValable').ucfirst();}}
lResult=!aObjet.enListe?lMotif:'<div class="PetitEspace'+(lTitle&&aObjet.classe?' '+aObjet.classe:'')+'" '+lTitle+'>'+lMotif+'</div>';if(!aObjet.enListe&&aObjet.donnee.message&&GEtatUtilisateur.GenreEspace===EGenreEspace.Parent)
lResult+='<div class="Texte10 Italique EspaceHaut">'+aObjet.donnee.message+'</div>';return lResult;}
if(GEtatUtilisateur.GenreEspace!==EGenreEspace.Parent||!MethodesTableau.existe(aObjet.donnee.GetGenre(),[EGenreRessource.Absence,EGenreRessource.Retard])) return'';return lResult;};ObjetUtilitaireAbsence.prototype.getCommentaireMotifAbsence=function(aObjet){if(GEtatUtilisateur.GenreEspace!==EGenreEspace.Parent||!MethodesTableau.existe(aObjet.donnee.GetGenre(),[EGenreRessource.Absence,EGenreRessource.Retard])) return'';var lResult='';if(aObjet.donnee.reglee||aObjet.donnee.listeMotifs.GetNbrElements()>0){if(!aObjet.enListe||aObjet.donnee.message) return'';lResult='<div class="PetitEspace">'+aObjet.donnee.justification+'</div>';return lResult;}
var lValue='';if(!aObjet.enListe)
lResult+='<div class="Texte10">'+GTraductions.getValeur('AbsenceVS.saisissezCommentaire',[this.maxLengthCommentaire]).ucfirst()+'&nbsp;:</div>';var lStyle=!aObjet.enListe?GStyle.composeHeight(36)+GStyle.composeBordureArrondi(3):'padding:3px;';if(aObjet.donnee.justification)
lValue=aObjet.donnee.justification;if(!aObjet.enListe)
lResult+='<div><textarea class="Texte10" maxlength="'+this.maxLengthCommentaire+'" id="'+aObjet.id+'" style="line-height:14px; '+GStyle.composeWidth(aObjet.width?aObjet.width:100,aObjet.width?'px':'%')+GStyle.composeCouleurBordure(GCouleur.bordure,1)+GStyle.composeBordureArrondi(3)+lStyle+'" onfocus="$(this).one(\'mouseup\',function(){$(this).select();return false;}).select();" onkeyup="'+aObjet.callback+'" onchange="'+aObjet.callback+'">'+lValue+'</textarea></div>';else lResult+='<div><input class="Texte10" maxlength="'+this.maxLengthCommentaire+'" type="text" id="'+aObjet.id+'" style="line-height:14px; '+GStyle.composeWidth(aObjet.width?aObjet.width:100,aObjet.width?'px':'%')+GStyle.composeCouleurBordure(GCouleur.bordure,1)+GStyle.composeBordureArrondi(3)+lStyle+'" onfocus="$(this).one(\'mouseup\',function(){$(this).select();return false;}).select();" onkeyup="'+aObjet.callback+'" onchange="'+aObjet.callback+'" value="'+lValue+'" /></div>';if(aObjet.donnee.message&&GEtatUtilisateur.GenreEspace===EGenreEspace.Parent&&!aObjet.enListe&&!aObjet.donnee.reglee&&aObjet.donnee.listeMotifs.GetNbrElements()===0)
lResult+='<div class="Texte10 Italique EspaceHaut">'+aObjet.donnee.message+'</div>';return lResult;};ObjetUtilitaireAbsence.prototype.getHeuresCoursManquees=function(aElement,aSansSpan){if(!aElement.NbrHeures||aElement.NbrHeures==='0h00') return'';var lTrad='';if(parseInt(aElement.NbrHeures.charAt(0))<2) lTrad=GTraductions.getValeur('AbsenceVS.heureCoursManque',[aElement.NbrHeures]);else lTrad=GTraductions.getValeur('AbsenceVS.heuresCoursManquees',[aElement.NbrHeures]);if(aSansSpan) return lTrad;return'<span>'+lTrad+'</span><br>';};ObjetUtilitaireAbsence.prototype.getDemiJournees=function(aElement,aSansSpan){if(!$.isNumeric(aElement.NbrJours)||aElement.NbrJours<=0) return'';var lTraduction=aElement.NbrJours>1?'demiJournees':'demiJournee';if(aSansSpan) return GTraductions.getValeur('AbsenceVS.'+lTraduction,[aElement.NbrJours]);return'<span>'+GTraductions.getValeur('AbsenceVS.'+lTraduction,[aElement.NbrJours])+'</span><br>';};ObjetUtilitaireAbsence.prototype.getSymptomesMedicaux=function(aElement,aAvecLibelle,aSansSpan){if(!aElement.symptomesMedicaux) return'';var lResult=(aAvecLibelle?GTraductions.getValeur('AbsenceVS.titres.symptMedicaux').ucfirst()+' : ':'')+aElement.symptomesMedicaux.getTableauLibelles().join(', ');if(aSansSpan) return lResult;return'<span>'+lResult+'</span><br>';};ObjetUtilitaireAbsence.prototype.getActesMedicaux=function(aElement,aAvecLibelle,aSansSpan){if(!aElement.symptomesMedicaux) return'';var lResult=(aAvecLibelle?GTraductions.getValeur('AbsenceVS.titres.actesMedicaux').ucfirst()+' : ':'')+aElement.actesMedicaux.getTableauLibelles().join(', ');if(aSansSpan) return lResult;return'<span>'+lResult+'</span><br>';};ObjetUtilitaireAbsence.prototype.getMatiere=function(aElement,aSansSpan,aSansDate){if(!aElement.matiere||!aElement.matiere.existeNumero()) return'';var lResult=aElement.matiere.GetLibelle();if(aElement.dateDebut&&(aElement.dateDebut.getHours()!==0)&&!aSansDate)
lResult+=' '+GTraductions.getValeur('A')+GDate.FormatDate(aElement.dateDebut,' %xhh%mm ');if(aSansSpan) return lResult;return'<span>'+lResult+'</span><br>';};ObjetUtilitaireAbsence.prototype.getCommentaire=function(aElement,aAvecLibelle,aSansSpan){if(!aElement.commentaire) return'';var lResult=(aAvecLibelle?GTraductions.getValeur('AbsenceVS.titres.observation').ucfirst()+' : ':'')+aElement.commentaire;if(aSansSpan) return lResult;return'<span>'+lResult+'</span><br>';};ObjetUtilitaireAbsence.prototype.getDemandeurDecideur=function(aElement,aAvecTitre){var lResult='';if(aElement.GetGenre()===EGenreRessource.ObservationProfesseurEleve){if(aAvecTitre) lResult=GTraductions.getValeur('AbsenceVS.titres.saisiepar')+' ';var lMailTo=aElement.demandeur.mail&&GEtatUtilisateur.GenreEspace===EGenreEspace.Parent?'<a href="mailto:'+aElement.demandeur.mail+'?Subject='+GTraductions.getValeur('AbsenceVS.SujetMailtoObservation',[GEtatUtilisateur.getMembre().GetLibelle(),GDate.FormatDate(aElement.dateDebut,'%J %MMM'+(aElement.dateDebut.getHours()===0?'':' '+GTraductions.getValeur('A')+' %xhh%mm'))])+'" class="AlignementHaut InlineBlock"><div class="Image_EnvoiEmail"></div></a>':'';return'<div class="AlignementHaut InlineBlock">'+lResult+aElement.demandeur.GetLibelle()+'&nbsp;</div>'+lMailTo;}
var lStrTraduction='decidePar';var lIndividu=null;if(aElement.GetGenre()===EGenreRessource.Punition){lStrTraduction='demandePar';lIndividu=aElement.demandeur;} else if(aElement.GetGenre()===EGenreRessource.Incident){lIndividu=aElement.rapporteur;} else{lIndividu=aElement.decideur;}
if(!lIndividu||!lIndividu.existeNumero())
return lResult;lResult+=lIndividu.GetLibelle();if(lIndividu.GetGenre()!==TypeGenreIndividuAuteur.GIA_Personnel){lResult+=' ('+GTraductions.getValeur('AbsenceVS.titres.professeur').ucfirst()+')';}
if(aAvecTitre&&lResult)
lResult=GTraductions.getValeur('AbsenceVS.'+lStrTraduction,[lResult]);return lResult;};ObjetUtilitaireAbsence.prototype.getDate=function(aElement,aAvecChaineAujourdhui){var lEstJourEgal=!(aElement.dateDebut&&aElement.dateFin)||GDate.estJourEgal(aElement.dateDebut,aElement.dateFin);var lDateDebut=GDate.FormatDate(aElement.dateDebut,lEstJourEgal?aAvecChaineAujourdhui?'['+GTraductions.getValeur('Le')+' '+'%J %MMM'+']':GTraductions.getValeur('Le')+' '+'%J %MMM':(aElement.ouverte?GTraductions.getValeur('Le'):GTraductions.getValeur('Du'))+' '+'%J %MMM');var lDateFin=GDate.FormatDate(aElement.dateFin ,'%J %MMM');var lHeureDebut=GDate.FormatDate(aElement.dateDebut,'%xhh%mm');var lHeureFin=GDate.FormatDate(aElement.dateFin ,'%xhh%mm');var lPlace=aElement.place;switch(aElement.GetGenre()){case EGenreRessource.AbsenceRepas:return lDateDebut+' '+(aElement.genreRepas===EGenreRepas.Midi?GTraductions.getValeur('AbsenceVS.amidi'):GTraductions.getValeur('AbsenceVS.ausoir'));case EGenreRessource.ObservationProfesseurEleve:return lDateDebut+(aElement.dateDebut.getHours()===0?'':' '+GTraductions.getValeur('A')+' '+lHeureDebut);case EGenreRessource.Infirmerie:case EGenreRessource.Absence:if(aElement.ouverte)
return GTraductions.getValeur('Depuis')+' '+lDateDebut+' '+GTraductions.getValeur('A')+' '+lHeureDebut;if(lEstJourEgal)
return lDateDebut+' '+GTraductions.getValeur('De')+' '+lHeureDebut+' '+GTraductions.getValeur('A')+' '+lHeureFin;return lDateDebut+' '+GTraductions.getValeur('A')+' '+lHeureDebut+' '+GTraductions.getValeur('Au')+' '+lDateFin+' '+GTraductions.getValeur('A')+' '+lHeureFin;case EGenreRessource.Incident:case EGenreRessource.Retard:return lDateDebut+' '+GTraductions.getValeur('A')+' '+lHeureDebut;case EGenreRessource.Punition:var lResult='';lPlace=aElement.placeDemande;if(aElement.horsCours)
lPlace=null;lDateDebut=GDate.FormatDate(aElement.dateDemande,'['+GTraductions.getValeur('Le')+' '+'%J %MMM'+']');if((lPlace!==null&&lPlace!==undefined)){var lDate=GDate.PlaceAnnuelleEnDate(lPlace);if(lDate&&GDate.estDateValide(lDate)&&GDate.estJourEgal(lDate,aElement.dateDemande))
lResult=' '+GTraductions.getValeur('A')+GDate.FormatDate(lDate,' %xhh%mm ');lResult=lDateDebut+lResult;} else lResult=lDateDebut;return lResult;case EGenreRessource.AbsenceInternat:case EGenreRessource.Sanction:case EGenreRessource.MesureConservatoire:if(lEstJourEgal)
return lDateDebut;return lDateDebut+' '+GTraductions.getValeur('Au')+' '+lDateFin;default:return'';}};ObjetUtilitaireAbsence.prototype.getDureeDAbsence=function(aAbsence){if(aAbsence.Genre===EGenreRessource.Retard)
return aAbsence.duree+' '+GTraductions.getValeur('AbsenceVS.minutes');else{if(MethodesObjet.isString(aAbsence.duree))
return aAbsence.duree;if(MethodesObjet.isDate(aAbsence.duree))
return GDate.FormatDate(aAbsence.duree,'%xhh%mm ');if(MethodesObjet.isNumber(aAbsence.duree)){return GDate.getDuree(aAbsence.duree);}}
return aAbsence.duree;};ObjetUtilitaireAbsence.prototype.getDureeSanction=function(aAbsence){var H=[];var lNombre=0;var lTraduction='';if(EGenreSanction.estUneExclusionTemporaire(aAbsence.nature.GetGenre())){lNombre=aAbsence.duree;lTraduction=(aAbsence.nature.GetGenre()===EGenreSanction.ExclusionInternat)?(lNombre>1?GTraductions.getValeur('AbsenceVS.nuits'):GTraductions.getValeur('AbsenceVS.nuit')):(lNombre>1?GTraductions.getValeur('AbsenceVS.jours'):GTraductions.getValeur('AbsenceVS.jour'));H.push('&nbsp;',lNombre,'&nbsp;',GTraductions.getValeur('AbsenceVS.'+lTraduction));if(aAbsence.estDemiJournee)
H.push(' ('+(aAbsence.estMatin?GTraductions.getValeur('AbsenceVS.matin'):GTraductions.getValeur('AbsenceVS.apresMidi'))+')');if(aAbsence.avecSursis){if(aAbsence.dureeSursis>0){H.push(' ',GTraductions.getValeur('AbsenceVS.dont'),' ',aAbsence.dureeSursis,' ',GTraductions.getValeur('AbsenceVS.avecSursis'));if(aAbsence.dateFinSursis)
H.push(GDate.FormatDate(aAbsence.dateFinSursis,' '+GTraductions.getValeur('jusquAu')+' %J %MMM'));} else H.push(' ',GTraductions.getValeur('AbsenceVS.avecSursis'));}} else if(aAbsence.nature.GetGenre()===EGenreSanction.Responsabilisation){lNombre=aAbsence.duree;lTraduction=(lNombre>1?GTraductions.getValeur('Heures').toLowerCase():GTraductions.getValeur('Heure').toLowerCase());H.push('&nbsp;',lNombre,'&nbsp;',GTraductions.getValeur('AbsenceVS.'+lTraduction));} else if(aAbsence.nature.GetGenre()===EGenreSanction.ExclusionDefinitive){if(aAbsence.avecSursis){H.push(' (',GTraductions.getValeur('AbsenceVS.avecSursis'));if(aAbsence.dateFinSursis)
H.push(GDate.FormatDate(aAbsence.dateFinSursis,' '+GTraductions.getValeur('jusquAu')+' %J %MMM'));H.push(')');}}
return H.join('');};ObjetUtilitaireAbsence.prototype.getModalitesPunitionSanction=function(aAbsence){var lResult='';switch(aAbsence.Genre){case EGenreRessource.Exclusion:case EGenreRessource.Punition:if(aAbsence.nature&&aAbsence.nature.GetLibelle())
lResult+=aAbsence.nature.GetLibelle();else lResult+=GTraductions.getValeur('AbsenceVS.punition');if(aAbsence.programmation&&(aAbsence.programmation.GetNbrElements()>0)){lResult+=' '+(aAbsence.nature.GetGenre()===EGenrePunition.Devoir?GTraductions.getValeur('AbsenceVS.aRendreLe'):GTraductions.getValeur('Le'));var lArray=[];for(var I=0;I<aAbsence.programmation.GetNbrElements();I++){var lProg=aAbsence.programmation.GetElement(I);var lTemp=GDate.FormatDate(lProg.date,' %J %MMM');var lDate=$.isNumeric(lProg.place)?(aAbsence.Genre===EGenreRessource.Punition)&&aAbsence.nature&&(aAbsence.nature.GetGenre()!==EGenrePunition.Exclusion)?GDate.PlaceParJourEnDate(lProg.place):GDate.PlaceAnnuelleEnDate(lProg.place):'';if(lDate&&GDate.estDateValide(lDate))
lTemp+=' '+GTraductions.getValeur('A')+GDate.FormatDate(lDate,' %xhh%mm ');if(lProg.duree){if(lProg.placeExecution!==undefined&&lProg.placeExecution!==null){var lExecution=GDate.PlaceParJourEnDate(lProg.placeExecution);if(lExecution&&GDate.estDateValide(lExecution))
lTemp+=' '+GTraductions.getValeur('A')+' '+GDate.FormatDate(lExecution,' %xhh%mm ');}
lTemp+=' ('+GDate.getDuree(lProg.duree)+')';}
lArray.push(lTemp);}
lResult+=lArray.join(',');} else if(aAbsence.estProgrammable){lResult+=' ('+GTraductions.getValeur('AbsenceVS.nonProgramme')+')';}
break;case EGenreRessource.Sanction:if(aAbsence.nature){lResult+=aAbsence.nature.GetLibelle();} else{lResult+=GTraductions.getValeur('AbsenceVS.sanction');}
if(aAbsence.nature.GetGenre()===EGenreSanction.Autre_Exclusion)
lResult+=' ('+GTraductions.getValeur('AbsenceVS.exclusion2').toLowerCase()+') ';lResult+=this.getDureeSanction(aAbsence);break;case EGenreRessource.Incident:if(aAbsence.mesure)
lResult+=this.getModalitesPunitionSanction(aAbsence.mesure);else lResult+=GTraductions.getValeur('AbsenceVS.AucuneMesure');break;default:break;}
return lResult.ucfirst();};ObjetUtilitaireAbsence.prototype.getLibellePunitionSanctionDIncident=function(aAbsence){var lResult='';if(MethodesTableau.existe(aAbsence.GetGenre(),[EGenreRessource.Punition,EGenreRessource.Sanction,EGenreRessource.MesureConservatoire])&&!aAbsence.estProgrammation&&aAbsence.estLieAUnIncident&&aAbsence.incident&&aAbsence.incident.publie){lResult=GTraductions.getValeur('AbsenceVS.IncidentSignaleLe',[GDate.FormatDate(aAbsence.incident.date,'%J %MMM'),GDate.FormatDate(aAbsence.incident.date,'%xhh%mm')]);}
return lResult;};ObjetUtilitaireAbsence.prototype.getChaineTraductionGenreAbsence=function(aObjet){switch(aObjet.genre){case EGenreRessource.ObservationProfesseurEleve:if(aObjet.estLue===false) return GTraductions.getValeur('AbsenceVS.observationNonLue');return aObjet.singulier?GTraductions.getValeur('AbsenceVS.observation'):GTraductions.getValeur('AbsenceVS.observations');case EGenreRessource.Absence:if(aObjet.justifie===true)
return aObjet.singulier?GTraductions.getValeur('AbsenceVS.absenceCoursJust'):GTraductions.getValeur('AbsenceVS.absencesCoursJust');if(aObjet.justifie===false)
return aObjet.singulier?GTraductions.getValeur('AbsenceVS.absenceCoursNonJust'):GTraductions.getValeur('AbsenceVS.absencesCoursNonJust');return aObjet.singulier?GTraductions.getValeur('AbsenceVS.absence'):GTraductions.getValeur('AbsenceVS.absences');case EGenreRessource.AbsenceRepas:return aObjet.singulier?GTraductions.getValeur('AbsenceVS.absenceRepas'):GTraductions.getValeur('AbsenceVS.absencesRepas');case EGenreRessource.AbsenceInternat:return aObjet.singulier?GTraductions.getValeur('AbsenceVS.absenceInternat'):GTraductions.getValeur('AbsenceVS.absencesInternat');case EGenreRessource.Retard:return aObjet.singulier?GTraductions.getValeur('AbsenceVS.retard'):GTraductions.getValeur('AbsenceVS.retards');case EGenreRessource.Infirmerie:return aObjet.singulier?GTraductions.getValeur('AbsenceVS.infirmerie'):GTraductions.getValeur('AbsenceVS.infirmeries');case EGenreRessource.Exclusion:return aObjet.singulier?GTraductions.getValeur('AbsenceVS.exclusion'):GTraductions.getValeur('AbsenceVS.exclusions');case EGenreRessource.Punition:return aObjet.singulier?GTraductions.getValeur('AbsenceVS.punition'):GTraductions.getValeur('AbsenceVS.punitions');case EGenreRessource.Sanction:return aObjet.singulier?GTraductions.getValeur('AbsenceVS.sanction'):GTraductions.getValeur('AbsenceVS.sanctions');case EGenreRessource.MesureConservatoire:return aObjet.singulier?GTraductions.getValeur('AbsenceVS.mesureConservatoire'):GTraductions.getValeur('AbsenceVS.mesuresConservatoires');case EGenreRessource.Incident:return aObjet.singulier?GTraductions.getValeur('AbsenceVS.incident'):GTraductions.getValeur('AbsenceVS.incidents');default:;return'';}};ObjetUtilitaireAbsence.prototype.arrayToChaine=function(aArray,aSeparateur,aSeparateurFin){var lResult='';if(aArray.length>0){lResult=aArray[aArray.length-1];if(aArray.length>1){aArray.pop();lResult=aArray.join(aSeparateur)+aSeparateurFin+lResult;}}
return lResult;};ObjetUtilitaireAbsence.prototype.getChaineRecapitulatifPunition=function(aObjet){var lResult='';var lListe;var lNbrList;lResult+=aObjet.nombre+' '+(aObjet.nombre===1?GTraductions.getValeur('AbsenceVS.punition').toLowerCase():GTraductions.getValeur('AbsenceVS.punitions').toLowerCase());if(aObjet.nombre>1){lResult+=' ('+GTraductions.getValeur('AbsenceVS.dont')+' ';var lPunitions=[];for(var i=0;i<aObjet.recap.GetNbrElements();i++){var lRecap=aObjet.recap.GetElement(i);lPunitions.push(lRecap.Nombre+' '+lRecap.GetLibelle());}
lResult+=this.arrayToChaine(lPunitions,', ',' '+GTraductions.getValeur('Et')+' ');lResult+=')';} else if(aObjet.recap){lResult+=' ('+aObjet.recap.GetLibelle(0)+')';}
return lResult;};ObjetUtilitaireAbsence.prototype.getChaineRecapitulatifSanction=function(aObjet){var lResult='';lResult+=aObjet.nombre+' '+(aObjet.nombre===1?GTraductions.getValeur('AbsenceVS.sanction').toLowerCase():GTraductions.getValeur('AbsenceVS.sanctions').toLowerCase());if(aObjet.nombre>1){lResult+=' ('+GTraductions.getValeur('AbsenceVS.dont')+' ';var lSanctions=[];for(var i=0;i<aObjet.recap.GetNbrElements();i++){var lRecap=aObjet.recap.GetElement(i);lSanctions.push(lRecap.Nombre+' '+lRecap.GetLibelle());}
lResult+=this.arrayToChaine(lSanctions,', ',' '+GTraductions.getValeur('Et')+' ');lResult+=')';} else{lResult+=' ('+aObjet.donnees.GetElement(0).nature.GetLibelle()+')';}
return lResult;};;
ObjetAffichagePageAccueil.prototype.AfficherListe=function(){if(!this.DonneesRecues) return'';this.utilitaireAbsence=new ObjetUtilitaireAbsence();var lIdListe=this.Nom+'_Liste';this._objetListeArborescente=new ObjetListeArborescente(lIdListe,0,this,null);var lRacine=this._objetListeArborescente.construireRacine();this._objetListeArborescente.setParametres(false);var lPremierElement=true;var lTitre='';var I=0;var lElement;var lNoeudListeElements;var lNoeudElement;lTitre=GTraductions.getValeur('EDT.Cours')+' '+GTraductions.getValeur('Du')+' ';var lJour=null,lNoeudJours;for(I=0;I<this.donnees.EDT.listeCours.GetNbrElements();I++){var lCours=this.donnees.EDT.listeCours.GetElement(I);if(!lJour||!GDate.estJourEgal(lJour,lCours.DateDuCours)){lJour=GDate.GetJour(lCours.DateDuCours);lNoeudJours=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lRacine,'',lTitre+GDate.FormatDate(lJour,'%JJJJ %JJ %MMMM'),'Gras',true,lPremierElement);lPremierElement=false;}
var lMatiere=lCours.ListeContenus.GetElementParGenre(EGenreRessource.Matiere);if(lMatiere){var lLibelleCours=lMatiere.GetLibelle()+' '+GTraductions.getValeur('A')+' '+GDate.FormatDate(lCours.DateDuCours,'%hhh%mm');if(lCours.Statut)
lLibelleCours+=' '+'('+lCours.Statut+')';var lNoeudCours=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lNoeudJours,'',lLibelleCours,'Gras');var lHtml=[];for(var J=0;J<lCours.ListeContenus.GetNbrElements();J++){var lContenu=lCours.ListeContenus.GetElement(J);if(lContenu.GetLibelle().length&&(lContenu.Visible!==false)&&(lContenu.GetGenre()!==EGenreRessource.Matiere)&&!lContenu.nePasImprimer)
lHtml.push('<div>',lContenu.GetLibelle(),'</div>');}
this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudCours,'',lHtml.join(''));}}
if(this.existeWidgetDS&&this.existeWidgetDS()){lTitre=GTraductions.getValeur('accueil.DS.titre');lNoeudListeElements=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lRacine,lIdListe+'_ListeDS',lTitre,'Gras',true,lPremierElement);lPremierElement=false;for(var i=0;i<this.donnees.devoirSurveille.listeDS.GetNbrElements();i++){var lDS=this.donnees.devoirSurveille.listeDS.GetElement(i);if(lDS.GetGenre()===EGenreLienDS.tGL_Devoir){lTitre=GDate.FormatDate(lDS.dateDebut,'['+GTraductions.getValeur('Le')+' '+'%JJJJ %J %MMM'+']'+' '+GTraductions.getValeur('De')+' '+'%hhh%mm')+GDate.FormatDate(lDS.dateFin,' '+GTraductions.getValeur('A')+' '+'%hhh%mm');lNoeudElement=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lNoeudListeElements,'',lTitre,'Gras');this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudElement,'',lDS.matiere.GetLibelle());}}}
if(this.existeWidgetDSEvaluation&&this.existeWidgetDSEvaluation()){lTitre=GTraductions.getValeur('accueil.DSEvaluation.titre');lNoeudListeElements=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lRacine,lIdListe+'_ListeEva',lTitre,'Gras',true,lPremierElement);lPremierElement=false;for(var i=0;i<this.donnees.devoirSurveille.listeDS.GetNbrElements();i++){var lDS=this.donnees.devoirSurveille.listeDS.GetElement(i);if(lDS.GetGenre()===EGenreLienDS.tGL_Evaluation){lTitre=GDate.FormatDate(lDS.dateDebut,'['+GTraductions.getValeur('Le')+' '+'%JJJJ %J %MMM'+']'+' '+GTraductions.getValeur('De')+' '+'%hhh%mm')+GDate.FormatDate(lDS.dateFin,' '+GTraductions.getValeur('A')+' '+'%hhh%mm');lNoeudElement=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lNoeudListeElements,'',lTitre,'Gras');this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudElement,'',lDS.matiere.GetLibelle());}}}
if(this.donnees.travailAFaire.listeTAF){lTitre=GTraductions.getValeur('accueil.travailAFaireAbbr');lNoeudListeElements=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lRacine,lIdListe+'_ListeTAF',lTitre,'Gras',true,lPremierElement);lPremierElement=false;if(this.donnees.travailAFaire.listeTAF.GetNbrElements()>0){var lDate,lTaf,lMatiere;var T=[];for(var I=0;I<this.donnees.travailAFaire.listeTAF.GetNbrElements();I++){lTaf=this.donnees.travailAFaire.listeTAF.GetElement(I);lTaf.indice=I;if(!T[lTaf.pourLe])
T[lTaf.pourLe]=[];T[lTaf.pourLe].push(lTaf);}
for(lDate in T){lMatiere=null;var lDateLibelle=new Date(lDate);lTitre=(GDate.estDateParticulier(lDateLibelle)?GTraductions.getValeur('accueil.pour').ucfirst():GTraductions.getValeur('accueil.pourle').ucfirst())+' '+GDate.FormatDate(lDateLibelle,'['+'%JJJJ %J %MMM'+']');lNoeudElement=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lNoeudListeElements,'',lTitre,'Gras');for(var J in T[lDate]){lTaf=T[lDate][J];if(!lMatiere||lMatiere.GetNumero()!==lTaf.matiere.GetNumero()){lTitre=lTaf.matiere.GetLibelle();var lNoeudMatiere=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lNoeudElement,'',lTitre);}
if(lNoeudMatiere){this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudMatiere,'',lTaf.descriptif);if(lTaf.listeDocumentJoint&&(lTaf.listeDocumentJoint.GetNbrElements()>0)){for(var I=0;I<lTaf.listeDocumentJoint.GetNbrElements();I++){var lPieceJointe=lTaf.listeDocumentJoint.GetElement(I);lTitre=GChaine.composerURL(EGenreDocumentJoint.getUrl(lPieceJointe,EGenreRessource.DocumentJoint),lPieceJointe.GetLibelle(),lPieceJointe.GetGenre()===EGenreDocumentJoint.Fichier,null,'LienAccueil');this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudMatiere,'',lTitre);}}}
lMatiere=lTaf.matiere;}}} else{this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudListeElements,'',GTraductions.getValeur('accueil.aucunTAF'));}}
if(this.existeWidgetRessourcePedagogique&&this.existeWidgetRessourcePedagogique()){lTitre=GTraductions.getValeur('accueil.ressourcePedagogique.titre');lNoeudListeElements=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lRacine,lIdListe+'_ListeResPeda',lTitre,'Gras',true,lPremierElement);lPremierElement=false;if(this.donnees.ressourcePedagogique.listeRessources.GetNbrElements()>0){for(var i=0;i<this.donnees.ressourcePedagogique.listeRessources.GetNbrElements();i++){var lRessource=this.donnees.ressourcePedagogique.listeRessources.GetElement(i);var lMatiere=this.donnees.ressourcePedagogique.listeMatieres.GetElementParNumero(lRessource.matiere.GetNumero());if(lMatiere&&(!lMatiere.date||(lRessource.date>lMatiere.date)))
lMatiere.date=lRessource.date;}
this.donnees.ressourcePedagogique.listeMatieres.setTri([ObjetTri.init('date',EGenreTriElement.Decroissant)]);this.donnees.ressourcePedagogique.listeMatieres.trier();this.donnees.ressourcePedagogique.listeRessources.setTri([ObjetTri.init('date',EGenreTriElement.Decroissant)]);this.donnees.ressourcePedagogique.listeRessources.trier();for(var i=0;i<this.donnees.ressourcePedagogique.listeRessources.GetNbrElements();i++){var lRessource=this.donnees.ressourcePedagogique.listeRessources.GetElement(i);var lMatiere=this.donnees.ressourcePedagogique.listeMatieres.GetElementParNumero(lRessource.matiere.GetNumero());var lChaine='';var lGenre=lRessource.GetGenre();if((lGenre===EGenreRessourcePedagogique.QCM)&&window.GUtilitaires.QCM.estCorrige(lRessource.ressource))
lGenre=EGenreRessourcePedagogique.corrige;lTitre=(lMatiere?lMatiere.GetLibelle()+' - ':'')+EGenreRessourcePedagogique.getLibelleDeGenreEtNombre(lGenre);lNoeudElement=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lNoeudListeElements,'',lTitre,'Gras');switch(lRessource.GetGenre()){case EGenreRessourcePedagogique.kiosque:lTitre=lRessource.ressource.GetLibelle();break;case EGenreRessourcePedagogique.QCM:lTitre=lRessource.ressource.QCM.GetLibelle()+'&nbsp;'+GChaine.Format(GTraductions.getValeur('accueil.ressourcePedagogique.deposeLe'),[GDate.FormatDate(lRessource.date,'%JJ/%MM')]);break;default:lTitre='<a class="LienAccueil" href="'+EGenreRessourcePedagogique.getUrl(lRessource.GetGenre(),lRessource.ressource)+'">'+lRessource.ressource.GetLibelle()+'</a>'+'&nbsp;'+GChaine.Format(GTraductions.getValeur('accueil.ressourcePedagogique.deposeLe'),[GDate.FormatDate(lRessource.date,'%JJ/%MM')]);break;}
this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudElement,'',lTitre);}} else{this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudListeElements,'',GTraductions.getValeur('accueil.ressourcePedagogique.aucuneRessourcePedagogique'));}}
if(this.donnees.vieScolaire.listeAbsences){lTitre=GTraductions.getValeur('accueil.vieScolaire');lNoeudListeElements=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lRacine,lIdListe+'_ListeVieScolaire',lTitre,'Gras',true,lPremierElement);lPremierElement=false;if(this.donnees.vieScolaire.listeAbsences.GetNbrElements()>0){for(I=0;I<this.donnees.vieScolaire.listeAbsences.GetNbrElements();I++){lElement=this.donnees.vieScolaire.listeAbsences.GetElement(I);lTitre=this.utilitaireAbsence.getChaineTraductionGenreAbsence({genre:lElement.GetGenre(),singulier:true,justifie:lElement.justifie}).ucfirst()+' '+this.utilitaireAbsence.getDate(lElement,true);lNoeudElement=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lNoeudListeElements,'',lTitre,'Gras');lTitre=this.getLigne2AbsenceAccessible(lElement);if(lTitre) this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudElement,'',lTitre);lTitre=this.utilitaireAbsence.getInfoAbsenceAccessible(lElement);if(lTitre) this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudElement,'',lTitre);}} else{this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudListeElements,'',GTraductions.getValeur('accueil.aucuneAbsence'));}}
if(this.donnees.notes.listeDevoirs){lTitre=GTraductions.getValeur('accueil.dernieresNotes');lNoeudListeElements=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lRacine,lIdListe+'_ListeDevoirs',lTitre,'Gras',true,lPremierElement);lPremierElement=false;if(this.donnees.notes.listeDevoirs.GetNbrElements()>0){for(I=0;I<this.donnees.notes.listeDevoirs.GetNbrElements();I++){lElement=this.donnees.notes.listeDevoirs.GetElement(I);lTitre=lElement.service.GetLibelle()+' : '+lElement.note.getNote()+(lElement.bareme.estBaremeParDefaut()||!lElement.note.estUneValeur()?'':lElement.bareme.getBaremeEntier());lNoeudElement=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lNoeudListeElements,'',lTitre,'Gras');this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudElement,'',GDate.FormatDate(lElement.date,'['+GTraductions.getValeur('Le')+' %J %MMMM'+']'));if(lElement.moyenne) this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudElement,'',GTraductions.getValeur('accueil.'+(lElement.estEnGroupe?'moyenneGroupe':'moyenneClasse'))+'&nbsp;:&nbsp;'+lElement.moyenne.getNote()+(lElement.bareme.estBaremeParDefaut()||!lElement.moyenne.estUneValeur()?'':lElement.bareme.getBaremeEntier()));}} else{this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudListeElements,'',GTraductions.getValeur('accueil.aucuneNote'));}}
if(this.donnees.competences.listeEvaluations&&this.donnees.competences.listeEvaluations.GetNbrElements()){lTitre=GTraductions.getValeur('accueil.competences.titre');lNoeudListeElements=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lRacine,lIdListe+'_ListeCompetences',lTitre,'Gras',true,lPremierElement);lPremierElement=false;var lOrdre=EGenreNiveauDAcquisition.ordre();for(I=0;I<this.donnees.competences.listePiliers.GetNbrElements();I++){var lPilier=this.donnees.competences.listePiliers. GetElement(I);lTitre=lPilier.GetLibelle();lNoeudElement=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lNoeudListeElements,'',lTitre,'Gras');for(J=0;J<this.donnees.competences.listeEvaluations.GetNbrElements();J++){var lEvaluation=this.donnees.competences.listeEvaluations.GetElement(J);var lObjet={pilier:lPilier,indicePilier:I,evaluation:lEvaluation,indiceEvaluation:J,titre:'',nbrNiveauxDAcquisitions:[]};if(this.existeEvaluationAccessible(lObjet)){var lNoeudEvaluation=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lNoeudElement,'',lObjet.titre);for(var k in lOrdre){var lGenre=lOrdre[k];if(lObjet.nbrNiveauxDAcquisitions[lGenre]&&lObjet.nbrNiveauxDAcquisitions[lGenre].length){var lNiveauDAcquisition=lObjet.nbrNiveauxDAcquisitions[lGenre][0];lTitre=lNiveauDAcquisition.GetLibelle()+'&nbsp;:&nbsp;'+lObjet.nbrNiveauxDAcquisitions[lGenre].length;if(lTitre) this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudEvaluation,'',lTitre);}}}}}}
if(this.donnees.agenda.listeEvenements){lTitre=GTraductions.getValeur('accueil.agenda.titre');lNoeudListeElements=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lRacine,lIdListe+'_ListeAgenda',lTitre,'Gras',true,lPremierElement);lPremierElement=false;if(this.donnees.agenda.listeEvenements.GetNbrElements()>0){for(I=0;I<this.donnees.agenda.listeEvenements.GetNbrElements();I++){lElement=this.donnees.agenda.listeEvenements.GetElement(I);lTitre=lElement.GetLibelle();lNoeudElement=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lNoeudListeElements,'',lTitre,'Gras');if(lElement.listeEleves&&lElement.listeEleves.length>0)
this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudElement,'',lElement.listeEleves.join(', '));lTitre=this.donnees.agenda.listeEvenements._getLibelleEvenement({evenement:lElement}).join('<br>');if(lTitre) this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudElement,'',lTitre);lTitre=(lElement.listeDocJoints&&lElement.listeDocJoints.GetNbrElements()>0)?this.composeDocuments(lElement.listeDocJoints):'';if(lTitre) this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudElement,'',lTitre);}} else{this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudListeElements,'',GTraductions.getValeur('accueil.aucuneAgenda'));}}
if(this.donnees.actualites.listeActualites){lTitre=GTraductions.getValeur('accueil.actualites');lNoeudListeElements=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lRacine,lIdListe+'_ListeActualites',lTitre,'Gras',true,lPremierElement);lPremierElement=false;if(this.donnees.actualites.listeActualites.GetNbrElements()>0){for(I=0;I<this.donnees.actualites.listeActualites.GetNbrElements();I++){lElement=this.donnees.actualites.listeActualites.GetElement(I);lTitre=lElement.categorie&&lElement.categorie.existeNumero()?lElement.categorie.GetLibelle().toUpperCase()+' ':'';lTitre+=lElement.GetLibelle();lNoeudElement=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lNoeudListeElements,'',lTitre,'Gras');lTitre=this.composeDetailActualite(lElement);if(lTitre) this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudElement,'',lTitre);}} else{this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudListeElements,'',GTraductions.getValeur('accueil.aucuneActualite'));}}
if(this.donnees.discussions.listeMessagerie){lTitre=GTraductions.getValeur('accueil.discussions.titre');lNoeudListeElements=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lRacine,lIdListe+'_ListeDiscussions',lTitre,'Gras',true,lPremierElement);lPremierElement=false;if(this.donnees.discussions.listeMessagerie.GetNbrElements()>0){for(I=0;I<this.donnees.discussions.listeMessagerie.GetNbrElements();I++){lElement=this.donnees.discussions.listeMessagerie.GetElement(I);lTitre=TUtilitaireMessagerie.getLibelleDiscussionAccessible(lElement);lNoeudElement=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lNoeudListeElements,'',lTitre,'Gras');lTitre=TUtilitaireMessagerie.getDetailDiscussionAccessible(lElement);if(lTitre) this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudElement,'',lTitre);}} else{this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudListeElements,'',GTraductions.getValeur('accueil.aucuneActualite'));}}
if(this.donnees.menuDeLaCantine.listePlats){lTitre=GTraductions.getValeur('accueil.menu');lNoeudListeElements=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lRacine,lIdListe+'_ListeMenu',lTitre,'Gras',true,lPremierElement);lPremierElement=false;if(this.donnees.menuDeLaCantine.listePlats.GetNbrElements()>0){this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudListeElements,'',this.composeRepas(true));} else{this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudListeElements,'',GTraductions.getValeur('accueil.pasDeMenu'));}}
$('#'+(this.Nom).escapeJQ()).addClass('AlignementHaut');GHtml.setHtml(this.Nom,this._objetListeArborescente.ConstruireAffichage());this._objetListeArborescente.SetDonnees(lRacine);};ObjetAffichagePageAccueil.prototype.existeEvaluationAccessible=function(aParam){var lExisteNiveauDAcquisition=false,lNiveauDAcquisition;for(var i=0;i<aParam.evaluation.listeNiveauxDAcquisitions.GetNbrElements();i++){lNiveauDAcquisition=aParam.evaluation.listeNiveauxDAcquisitions.GetElement(i);if(aParam.pilier.GetNumero()===lNiveauDAcquisition.pilier.GetNumero()){if(!aParam.nbrNiveauxDAcquisitions[lNiveauDAcquisition.GetGenre()])
aParam.nbrNiveauxDAcquisitions[lNiveauDAcquisition.GetGenre()]=[];aParam.nbrNiveauxDAcquisitions[lNiveauDAcquisition.GetGenre()].push(lNiveauDAcquisition);lExisteNiveauDAcquisition=true;}}
if(lExisteNiveauDAcquisition){aParam.titre=GDate.FormatDate(aParam.evaluation.date,'['+GTraductions.getValeur('Le')+' '+'%JJ/%MM'+']')+'&nbsp;-&nbsp;'+aParam.evaluation.matiere.GetLibelle();}
return lExisteNiveauDAcquisition;};ObjetAffichagePageAccueil.prototype.getLigne2AbsenceAccessible=function(aAbsence){var lResult='';switch(aAbsence.Genre){case EGenreRessource.ObservationProfesseurEleve:lResult+=this.utilitaireAbsence.getDemandeurDecideur(aAbsence);break;case EGenreRessource.Absence:case EGenreRessource.Retard:lResult+=this.utilitaireAbsence.getMotifAbsence({donnee:aAbsence,enListe:false});break;case EGenreRessource.AbsenceRepas:case EGenreRessource.AbsenceInternat:lResult+=(aAbsence.Motif&&aAbsence.Motif.existeNumero())?aAbsence.Motif.GetLibelle():'';break;case EGenreRessource.Infirmerie:break;case EGenreRessource.Exclusion:case EGenreRessource.Punition:case EGenreRessource.Sanction:lResult+=this.utilitaireAbsence.getModalitesPunitionSanction(aAbsence);break;default:break;}
return lResult.ucfirst();};ObjetAffichagePageAccueil.prototype.composeDetailActualite=function(aActualite){var H=[];H.push('<div>',aActualite.message,'</div>');for(var I=0;aActualite.listeDocumentsJoints&&(I<aActualite.listeDocumentsJoints.GetNbrElements());I++){var lDocumentJoint=aActualite.listeDocumentsJoints.GetElement(I);H.push('<a class="Texte10" href="'+GChaine.GetChainePourUrl(GApplication.getCommunication().composeUrlFichierExterne(lDocumentJoint.GetLibelle(),{"N":lDocumentJoint.GetNumero(),"G":EGenreRessource.DocJointEtablissement}),true)+'" target="_blank">'+lDocumentJoint.GetLibelle()+'</a>');}
if(aActualite.signataire)
H.push('<div>',aActualite.signataire,'</div>');return H.join('');};ObjetAffichagePageAccueil.prototype.composeDocuments=function(aListeDocumentsJoints){var lHtml=[];for(var I=0;I<aListeDocumentsJoints.GetNbrElements();I++){var lDocumentJoint=aListeDocumentsJoints.GetElement(I);lHtml.push(GChaine.composerURL(GApplication.getCommunication().composeUrlFichierExterne(lDocumentJoint.GetLibelle(),{"N":lDocumentJoint.GetNumero(),"G":EGenreRessource.DocJointEtablissement}),lDocumentJoint.GetLibelle() ,true));}
return lHtml.join(', ');};;
ObjetAffichagePageAccueil.prototype.existeWidgetMenu=function(){return!this.donnees||this.donnees.menuDeLaCantine.listeRepas;};ObjetAffichagePageAccueil.prototype.creerObjetsMenu=function(){this.dateMenu=Identite.creerInstance(window.ObjetCelluleDate,{pere:this,evenement:this._evenementComboMenu});};ObjetAffichagePageAccueil.prototype.initialiserObjetsMenu=function(){this.dateMenu.SetParametres(false,90,null,'Maigre',true,false,'%JJJ %JJ %MMM');this.dateMenu.Initialiser();this.dateMenu.SetDonnees(this.donneesRequete.menuDeLaCantine.date);};ObjetAffichagePageAccueil.prototype.construireWidgetMenu=function(){this.creerObjetsMenu();var lWidget={html:this.composeWidgetMenu(),nbrElements:null,afficherMessage:this.donnees.menuDeLaCantine.listeRepas.GetNbrElements()===0,idSelecteurDate:this.dateMenu.GetNom()};$.extend(true,this.donnees.menuDeLaCantine,lWidget);this.construireWidget(this.donnees.menuDeLaCantine);this.initialiserObjetsMenu();};ObjetAffichagePageAccueil.prototype.composeWidgetMenu=function(){var H=[];for(var i=0;i<this.donnees.menuDeLaCantine.listeRepas.GetNbrElements();i++){var lRepas=this.donnees.menuDeLaCantine.listeRepas.GetElement(i);H.push('<div class="PetitEspace">');H.push('<div class="AlignementMilieu Gras">');var lLibelleRepas='';if((this.donnees.menuDeLaCantine.listeRepas.GetNbrElements()===2)||(lRepas.GetGenre()===EGenreRepas.Soir))
lLibelleRepas=[GTraductions.getValeur('Menus.RepasMidi'),GTraductions.getValeur('Menus.RepasSoir')][lRepas.GetGenre()];if(lRepas.GetLibelle()){if(lLibelleRepas!=='')
lLibelleRepas+=' : ';lLibelleRepas+=lRepas.GetLibelle();}
H.push(lLibelleRepas);H.push('</div>');for(var j=0;j<lRepas.listePlats.GetNbrElements();j++){var lPlat=lRepas.listePlats.GetElement(j);H.push('<div class="AlignementMilieu">');H.push(lPlat.listeAliments.getTableauLibelles().join(' / '));H.push('</div>');}
H.push('</div>');}
return H.join('');};ObjetAffichagePageAccueil.prototype._evenementComboMenu=function(aDate){this.donneesRequete.menuDeLaCantine.date=aDate;this.donnees.menuDeLaCantine.semaineSelectionnee=IE.Cycles.cycleDeLaDate(this.donneesRequete.menuDeLaCantine.date);this.RecupererDonnees([this.donnees.menuDeLaCantine.genre]);};;
MethodesObjet.heritagePrototype(ObjetFichePresence,ObjetFiche);function ObjetFichePresence(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.avecArrondi=true;this.Largeur=265;this.Hauteur=125;this.largeurMax=500;this.hauteurMax=400;this.tailleImages=17;this.tableauCB=[];this.utilitaireAbsence=new ObjetUtilitaireAbsence();this.idBouton=IE.GUID.getId();this.idScroll=this.Nom+'_scroll';Invocateur.abonner(Invocateur.events.modeExclusif,this._setModeExclusif,this);}(function(){function _getIdCombo(aIndice){return'_I_'+aIndice;}
function _initCombos(){var I,lCombo;for(I=0;I<this.donnees.GetNbrElements();I++){lCombo=this.combos[_getIdCombo(I)];if(lCombo){lCombo.Initialiser();_actualiserCombo.bind(this)(I);}}}
function _actualiserCombo(aIndice){var lCombo=this.combos[_getIdCombo(aIndice)];if(!lCombo) return;var lAbsence=this.donnees.GetElement(aIndice);var lListe=lAbsence.GetGenre()===EGenreRessource.Absence?GEtatUtilisateur.listeMotifsAbsences:GEtatUtilisateur.listeMotifsRetards;lCombo.SetDonnees(lListe);if(lAbsence.motifParent&&lAbsence.motifParent.existeNumero())
lCombo.initSelectionParNumeroEtGenre(lAbsence.motifParent.GetNumero());else lCombo.SetContenu(GTraductions.getValeur('AbsenceVS.aPreciser'));}
function _creationCombos(){var I,lId,lAbsence;this.combos={};for(I=0;I<this.donnees.GetNbrElements();I++){lAbsence=this.donnees.GetElement(I);var lListe=lAbsence.GetGenre()===EGenreRessource.Absence?GEtatUtilisateur.listeMotifsAbsences:GEtatUtilisateur.listeMotifsRetards;var lSaisieMotif=false;switch(lAbsence.GetGenre()){case EGenreRessource.Absence:lSaisieMotif=this.autorisations?this.autorisations.saisieMotifAbsence:false;break;case EGenreRessource.Retard:lSaisieMotif=this.autorisations?this.autorisations.saisieMotifRetard:false;break;default:break;}
if(lSaisieMotif&&MethodesTableau.existe(lAbsence.GetGenre(),[EGenreRessource.Absence,EGenreRessource.Retard])&&lListe.GetNbrElements()>0){lId=_getIdCombo(I);this.combos[lId]=new ObjetSaisie(this.Nom+'.saisies'+lId,null,this,_surEvenementSaisie.bind(this,I));var lWidth=220;this.combos[lId].SetParametres(EGenreSaisie.Combo,lWidth,true);}}}
function _surEvenementSaisie(aIndice,aGenreSelection,aElement){var lAbsence=this.donnees.GetElement(aIndice);if((aGenreSelection===EGenreEvenementObjetSaisie.selection&&aElement)&&(!lAbsence.motifParen||(lAbsence.motifParent.GetNumero()!==aElement.GetNumero()))){lAbsence.motifParent=aElement;lAbsence.SetEtat(EGenreEtat.Modification);GHtml.setDisabled(this.idBouton,false);this.SetEtatSaisie(true);}}
ObjetFichePresence.prototype.SetDonnees=function(aID,aTitre,aListeDonnees,aAutorisations){this.donnees=aListeDonnees;this.avecSaisie=this.donnees.getIndiceElementParFiltre(function(aElement){return aElement.avecSaisie;})> -1;this.autorisations=aAutorisations;this.setTitre(aTitre);this.Afficher(aID);if(this.donnees.GetNbrElements()>0)
_initCombos.bind(this)();if(this.donnees.existeElementPourValidation()){GHtml.setDisabled(this.idBouton,false);}
$('#'+this.Nom.escapeJQ()+' input[type="checkbox"]').jIECheckBox({marginRightMin:0});this.surPostAffichage();if(GApplication.getModeExclusif())
this._setModeExclusif(true);};ObjetFichePresence.prototype._setModeExclusif=function(aModeExclusif){$('#'+this.Nom.escapeJQ()+' input:checkbox[id^="'+(this.Nom+'_input_').escapeJQ()+'"] ').each(function(){if(!$(this).data('disable'))
$(this).inputDisabled(aModeExclusif);});};ObjetFichePresence.prototype.GetTitre=function(){var H=[];H.push('<div>',this.titreFiche,'</div>');return H.join('');};ObjetFichePresence.prototype.setTitre=function(aTitre){this.titreFiche=aTitre;};ObjetFichePresence.prototype.ComposeContenu=function(){var H=[];this.tableauCB=[];_creationCombos.bind(this)();H.push('<div id="',this.idScroll,'" class="Fenetre_Scroll">');H.push('<div><table class="Table Texte10 Espace ContenuTableauPresence" border="0" cellspacing="0" cellpadding="0">');for(var i=0;i<this.donnees.GetNbrElements();i++){H.push(this.composeAbsence(this.donnees.GetElement(i),i));}
H.push('<tr>');H.push('<td style="'+GStyle.composeHeight(100,'%')+'"></td>');H.push('</tr>');H.push('</table></div>');if(this.avecSaisie){H.push('<div class="Texte10 Espace AlignementDroit"><ie-bouton id="',this.idBouton,'" onclick="',this.Nom,'.surBouton ()" disabled>',GTraductions.getValeur('Valider'),'</ie-bouton></div>');}
H.push('</div>');return H.join('');};ObjetFichePresence.prototype.surBouton=function(){if(this.Pere&&this.Pere.Valider)
this.Pere.Valider();};ObjetFichePresence.prototype.composeAbsence=function(aAbsence,aIndice){var H=[];H.push('<tr>');H.push('<td class="Texte10 AlignementHaut PetitEspaceBas"><div style="'+GStyle.composeWidth(25)+'"><div ',this.getInfoAbsence(aAbsence),'class="',EGenreRessource.getNomImageAbsence({genre:aAbsence.GetGenre(),genreNature:aAbsence.nature?aAbsence.nature.GetGenre():null,justifie:aAbsence.justifie,estProgrammation:aAbsence.estProgrammation,estLue:aAbsence.estLue,avecSursis:aAbsence.avecSursis}),'" style="'+GStyle.composeWidth(this.tailleImages)+'"></div></div></td>');H.push('<td class="Texte10 AlignementHaut PetitEspaceHaut" style="line-height: 12px; padding-top: 2px;">');if((aAbsence.GetGenre()===EGenreRessource.Punition)&&aAbsence.estProgrammation){H.push('<div class="Gras">');H.push(this.getLibelleModalitePunitionSanction(aAbsence,true));H.push('</div>');} else{H.push('<div class="Gras">');H.push(this.getLibelleTitre(aAbsence));H.push('</div>');H.push(this.getLibellePunitionSanctionDIncident(aAbsence));H.push(this.getLibelleModalitePunitionSanction(aAbsence));}
H.push('<div class="EspaceHaut">');H.push(this.getLibelleObservationProfesseurEleve(aAbsence));H.push(this.getLibelleMotifs(aAbsence,aIndice));H.push(this.getLibelleTAF(aAbsence));if(aAbsence.GetGenre()!==EGenreRessource.Incident)
H.push(this.getLibelleDemandeurDecideur(aAbsence,(aAbsence.GetGenre()===EGenreRessource.Punition)&&aAbsence.estProgrammation));H.push('</div>');H.push('<div class="EspaceHaut">');H.push(this.utilitaireAbsence.getHeuresCoursManquees(aAbsence));H.push(this.utilitaireAbsence.getDemiJournees(aAbsence));H.push('</div>');if(GEtatUtilisateur.GenreEspace===EGenreEspace.Parent&&aAbsence.GetGenre()===EGenreRessource.ObservationProfesseurEleve){H.push(this.utilitaireAbsence.getSaisieObservation(aAbsence,this.Nom+'.surSelection ('+aIndice+')',this.getIDCheckBox(aIndice)));this.tableauCB.push(this.getIDCheckBox(aIndice));}
if(aAbsence.GetGenre()===EGenreRessource.Punition&&aAbsence.nature&&aAbsence.nature.estAvecARParent&&GEtatUtilisateur.GenreEspace===EGenreEspace.Parent&&!aAbsence.estProgrammation){H.push(this.utilitaireAbsence.getARdePunition(aAbsence,this.Nom+'.surAR ('+aIndice+')',this.getIDCheckBox(aIndice)));this.tableauCB.push(this.getIDCheckBox(aIndice));}
H.push('&nbsp;</td>');H.push('</tr>');return H.join('');};ObjetFichePresence.prototype.getIDCheckBox=function(aIndice){return this.Nom+'_input_'+aIndice;};ObjetFichePresence.prototype.getLibelleTitre=function(aAbsence){var lLibelle=this.getChaineTraductionGenreAbsence(aAbsence);if(aAbsence.GetGenre()===EGenreRessource.ObservationProfesseurEleve){lLibelle='<div class="InlineBlock AlignementHaut" style="height:14px; line-height:14px;">'+lLibelle+'&nbsp;</div>';lLibelle+=aAbsence.demandeur.mail&&GEtatUtilisateur.GenreEspace===EGenreEspace.Parent?'<a href="mailto:'+aAbsence.demandeur.mail+'?Subject='+GTraductions.getValeur('AbsenceVS.SujetMailtoObservation',[GEtatUtilisateur.getMembre().GetLibelle(),GDate.FormatDate(aAbsence.dateDebut,'%J %MMMM'+(aAbsence.dateDebut.getHours()===0?'':' '+GTraductions.getValeur('A')+' %xhh%mm'))])+'" class="AlignementHaut InlineBlock"><div class="Image_EnvoiEmail"></div></a>':'';}
return(lLibelle!=='')?'<div class="Texte10 Insecable Gras">'+lLibelle+'</div>':'';};ObjetFichePresence.prototype.getIDElementVS=function(aIndice){return this.Nom+'_inputVS_'+aIndice;};ObjetFichePresence.prototype.getLibellePunitionSanctionDIncident=function(aAbsence){var lLibelle='';var lModalite=this.utilitaireAbsence.getLibellePunitionSanctionDIncident(aAbsence);if(lModalite)
lLibelle+='<span class="EspaceHaut"><br>'+lModalite+'<br></span>';return lLibelle;};ObjetFichePresence.prototype.getLibelleModalitePunitionSanction=function(aAbsence,aSansTitre){var lLibelle='';var lModalite=this.utilitaireAbsence.getModalitesPunitionSanction(aAbsence);if(lModalite)
lLibelle+='<span class="EspaceHaut">'+(aSansTitre?'':'<br>')+lModalite+'</span>';return lLibelle;};ObjetFichePresence.prototype.getLibelleObservationProfesseurEleve=function(aAbsence,aIndice){var lLibelle='';if(aAbsence.GetGenre()===EGenreRessource.ObservationProfesseurEleve){lLibelle+=this.utilitaireAbsence.getMatiere(aAbsence,true);lLibelle+=(lLibelle&&aAbsence.commentaire?'<br>':'')+aAbsence.commentaire;}
return(lLibelle!=='')?'<div class="Texte10 Insecable">'+lLibelle+'</div>':'';};ObjetFichePresence.prototype.getLibelleMotifs=function(aAbsence,aIndice){var lLibelle='';if(aAbsence.avecSaisie){var lCombo=this.combos[_getIdCombo(aIndice)];if(lCombo){lLibelle='<div class="EspaceHaut">'+GTraductions.getValeur('AbsenceVS.votreRaison')+'&nbsp;:</div>';lLibelle+='<div id="'+lCombo.Nom+'" class="motif" style="margin-bottom: 2px;"></div>';}
lLibelle+=this.utilitaireAbsence.getCommentaireMotifAbsence({callback:this.Nom+'.surSaisieVS('+aIndice+')',donnee:aAbsence,id:this.getIDElementVS(aIndice),enListe:false,width:246});} else{lLibelle=this.utilitaireAbsence.getMotifAbsence({callback:this.Nom+'.surSaisieVS('+aIndice+')',donnee:aAbsence,id:this.getIDElementVS(aIndice),enListe:false,traduction:''});}
return(lLibelle!=='')?'<div class="Texte10 Insecable">'+lLibelle+'</div>':'';};ObjetFichePresence.prototype.getLibelleTAF=function(aAbsence){var lLibelle='';if(aAbsence.travailAFaire)
lLibelle+='<div>'+GTraductions.getValeur('AbsenceVS.travailAFaire')+' : '+aAbsence.travailAFaire+'</div>';return(lLibelle!=='')?'<div class="Texte10">'+lLibelle+'</div>':'';};ObjetFichePresence.prototype.getLibelleDemandeurDecideur=function(aAbsence,aAvecDateDemande){var lLibelle='';if(aAbsence.GetGenre()!==EGenreRessource.ObservationProfesseurEleve){lLibelle+=this.utilitaireAbsence.getDemandeurDecideur(aAbsence,true);if(aAvecDateDemande&&(aAbsence.GetGenre()===EGenreRessource.Punition)&&GDate.estDateValide(aAbsence.dateDemande)){if(lLibelle==='')
lLibelle+=GTraductions.getValeur('AbsenceVS.demande');lLibelle+=' '+GTraductions.getValeur('Le')+GDate.FormatDate(aAbsence.dateDemande,' %J %MMMM ');}}
return(lLibelle!=='')?'<div class="Texte10 Insecable">'+lLibelle+'</div>':'';};ObjetFichePresence.prototype.getChaineTraductionGenreAbsence=function(aAbsence){var lResult='';switch(aAbsence.Genre){case EGenreRessource.ObservationProfesseurEleve:lResult+=GTraductions.getValeur('AbsenceVS.observation');if(aAbsence.demandeur&&aAbsence.demandeur.existeNumero())
lResult+=' '+GTraductions.getValeur('De')+' '+aAbsence.demandeur.GetLibelle();break;case EGenreRessource.Absence:lResult+=this.utilitaireAbsence.getChaineTraductionGenreAbsence({genre:aAbsence.GetGenre(),singulier:true,justifie:aAbsence.justifie}).ucfirst()+' '+this.utilitaireAbsence.getDate(aAbsence,true);break;case EGenreRessource.AbsenceRepas:lResult+=GTraductions.getValeur('AbsenceVS.absenceRepas');lResult+=' - '+(aAbsence.genreRepas===EGenreRepas.Midi?GTraductions.getValeur('AbsenceVS.midi'):GTraductions.getValeur('AbsenceVS.soir'));break;case EGenreRessource.AbsenceInternat:lResult+=GTraductions.getValeur('AbsenceVS.absenceInternat');break;case EGenreRessource.Retard:lResult+=GTraductions.getValeur('AbsenceVS.retard')+' '+GTraductions.getValeur('De')+' '+this.utilitaireAbsence.getDureeDAbsence(aAbsence)+' '+GDate.FormatDate(aAbsence.dateDebut,GTraductions.getValeur('Le')+' %J %MMMM '+GTraductions.getValeur('A')+' %xhh%mm ');break;case EGenreRessource.Infirmerie:lResult+=GTraductions.getValeur('AbsenceVS.infirmerie');lResult+=' '+GTraductions.getValeur('De')+GDate.FormatDate(aAbsence.dateDebut,' %xhh%mm ')+GTraductions.getValeur('A')+GDate.FormatDate(aAbsence.dateFin,' %xhh%mm ');break;case EGenreRessource.Exclusion:case EGenreRessource.Punition:case EGenreRessource.Sanction:case EGenreRessource.Incident:case EGenreRessource.MesureConservatoire:lResult+=this.utilitaireAbsence.getChaineTraductionGenreAbsence({genre:aAbsence.GetGenre(),singulier:true,justifie:aAbsence.justifie}).ucfirst()+' '+this.utilitaireAbsence.getDate(aAbsence,true);break;default:break;}
return lResult.ucfirst();};ObjetFichePresence.prototype.getInfoAbsence=function(aAbsence){var lDebut='title="';var lFin='" ';switch(aAbsence.GetGenre()){case EGenreRessource.ObservationProfesseurEleve:if(aAbsence.estLue)
return lDebut+GTraductions.getValeur('AbsenceVS.observationLue').ucfirst()+lFin;return lDebut+GTraductions.getValeur('AbsenceVS.observationNonLue').ucfirst()+lFin;case EGenreRessource.Absence:if(aAbsence.justifie)
return lDebut+GTraductions.getValeur('AbsenceVS.absenceCoursJust').ucfirst()+lFin;return lDebut+GTraductions.getValeur('AbsenceVS.absenceCoursNonJust').ucfirst()+lFin;case EGenreRessource.AbsenceRepas:return lDebut+GTraductions.getValeur('AbsenceVS.absenceRepas').ucfirst()+lFin;case EGenreRessource.AbsenceInternat:return lDebut+GTraductions.getValeur('AbsenceVS.absenceInternat').ucfirst()+lFin;case EGenreRessource.Retard:return lDebut+GTraductions.getValeur('AbsenceVS.retard').ucfirst()+lFin;case EGenreRessource.Infirmerie:return lDebut+GTraductions.getValeur('AbsenceVS.infirmerie').ucfirst()+lFin;case EGenreRessource.Exclusion:return lDebut+GTraductions.getValeur('AbsenceVS.exclusion').ucfirst()+lFin;case EGenreRessource.Punition:switch(aAbsence.nature.GetGenre()){case EGenrePunition.Exclusion:return lDebut+GTraductions.getValeur('AbsenceVS.exclusion').ucfirst()+lFin;case EGenrePunition.Retenues:case EGenrePunition.TIG:case EGenrePunition.Devoir:case EGenrePunition.Autre:return lDebut+GTraductions.getValeur('AbsenceVS.punition').ucfirst()+lFin;default:return'';}
break;case EGenreRessource.Sanction:return lDebut+GTraductions.getValeur('AbsenceVS.sanction').ucfirst()+lFin;case EGenreRessource.MesureConservatoire:return lDebut+GTraductions.getValeur('AbsenceVS.mesureConservatoire').ucfirst()+lFin;default:return'';}};ObjetFichePresence.prototype.surSaisieVS=function(aIndice){var lElement=this.donnees.GetElement(aIndice);var lInput=$('#'+this.getIDElementVS(aIndice).escapeJQ()).val();if(lInput===GTraductions.getValeur('AbsenceVS.saisissezCommentaire').ucfirst()||lInput===lElement.justification) return;lElement.justification=lInput;lElement.SetEtat(EGenreEtat.Modification);this.etatSaisie=this.donnees.existeElementPourValidation();if(this.etatSaisie){GHtml.setDisabled(this.idBouton,false);}
this.SetEtatSaisie(this.etatSaisie);};ObjetFichePresence.prototype.surSelection=function(aIndice){var lElement=this.donnees.GetElement(aIndice);lElement.estLue=true;lElement.SetEtat(EGenreEtat.Modification);$('#'+this.getIDCheckBox(aIndice).escapeJQ()).inputDisabled(true).data('disable',true);this.callback.appel(true,lElement);};ObjetFichePresence.prototype.surAR=function(aIndice){var lElement=this.donnees.GetElement(aIndice);lElement.parentAAccuseDeReception=true;lElement.SetEtat(EGenreEtat.Modification);$('#'+this.getIDCheckBox(aIndice).escapeJQ()).inputDisabled(true).data('disable',true);this.callback.appel(true,lElement);};ObjetFichePresence.prototype.surPreAffichage=function(){var lHeight=$('#'+this.idScroll.escapeJQ()).find('.ContenuTableauPresence').outerHeight(true);if(lHeight>this.hauteurMax)
GPosition.setHeight(this.idScroll,this.hauteurMax);var lWidth=Math.ceil($('#'+this.idScroll.escapeJQ()).find('.ContenuTableauPresence').outerWidth(true));$('#'+this.idScroll.escapeJQ()).find('.ContenuTableauPresence').parent().width(lWidth+1);};ObjetFichePresence.prototype.surPostAffichage=function(){var lHeight=$('#'+this.idScroll.escapeJQ()).find('.ContenuTableauPresence').outerHeight(true);GPosition.setHeight(this.idScroll,lHeight);if(lHeight>this.hauteurMax){GPosition.setHeight(this.idScroll,this.hauteurMax);GHtml.addClass(this.idScroll,'AvecScrollVertical');}
var lWidth=Math.ceil($('#'+this.idScroll.escapeJQ()).find('.ContenuTableauPresence').parent().outerWidth(true));if(lWidth>this.largeurMax){GPosition.setWidth(this.idScroll,this.largeurMax);GHtml.addClass(this.idScroll,'AvecScrollHorizontal');}
if(this.idScroll){var lJqScroll=$('#'+this.idScroll.escapeJQ());if(lJqScroll.data('jsp')) lJqScroll.data('jsp').destroy();lJqScroll=$('#'+this.idScroll.escapeJQ());if(lJqScroll.length===1) lJqScroll.jScrollPane({showArrows:true});}};})();;
MethodesObjet.heritagePrototype(ObjetFicheActualite,ObjetFiche);function ObjetFicheActualite(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.Largeur=300;this.Hauteur=150;this.largeurMax=750;this.hauteurMax=400;}
ObjetFicheActualite.prototype.SetDonnees=function(aActualite){this.actualite=aActualite;this.Afficher();};ObjetFicheActualite.prototype.surAfficher=function(){$('#'+this.Nom.escapeJQ()).find(':checkbox, :radio').jIECheckBox();};ObjetFicheActualite.prototype.GetTitre=function(){return this.actualite.GetLibelle();};ObjetFicheActualite.prototype.ComposeContenu=function(){var H=[];H.push('<div class="PetitEspace">');H.push('<div style="margin:5px;min-width:190px;min-height:90px;max-width:',(GNavigateur.EcranL-10),'px;max-height:',(GNavigateur.EcranH-10-24-10),'px;overflow:auto;">');H.push('<div id="'+'lIdDetail'+'" style="padding:0px 5px;position:relative;" class="AvecSelectionTexte">',this.actualite.message,'<span class="wai_hidden">tapez sur espace ou entrée pour archivage.</span></div>');if(this.actualite.listeDocumentsJoints&&this.actualite.listeDocumentsJoints.GetNbrElements()>0)
H.push('<div  style="clear: both" class="PetitEspace">',this.composeDocuments(this.actualite.listeDocumentsJoints),'</div>');if(this.actualite.titreQuestion) H.push('<div style="padding:0px 5px;">',this.actualite.titreQuestion,'</div>');H.push('<div id="',this.getIDReponse(),'">',this.composeReponse(),'</div>');H.push('</div>');if(this.actualite.genreReponse===TypeGenreReponseInternetActualite.Textuelle||this.actualite.genreReponse===TypeGenreReponseInternetActualite.ChoixUnique||this.actualite.genreReponse===TypeGenreReponseInternetActualite.ChoixMultiple){H.push('<ie-bouton style="float: right;" onclick="',this.Nom,'.surBouton ()">',GTraductions.getValeur('Valider'),'</ie-bouton>');}
H.push('</div>');return H.join('');};ObjetFicheActualite.prototype.composeDocuments=function(aListeDocumentsJoints){var lHtml=[];for(var I=0;I<aListeDocumentsJoints.GetNbrElements();I++){var lDocumentJoint=aListeDocumentsJoints.GetElement(I);lHtml.push(GChaine.composerURL(EGenreDocumentJoint.getUrl(lDocumentJoint,EGenreRessource.DocJointEtablissement),lDocumentJoint.GetLibelle(),lDocumentJoint.GetGenre()===EGenreDocumentJoint.Fichier));}
return lHtml.join('<br/>');};ObjetFicheActualite.prototype.getIDReponse=function(){return this.idActualites+'_reponse';};ObjetFicheActualite.prototype.surKeyUpReponse=function(){if(GNavigateur.IsToucheSelection())
this.surSaisieReponse();};ObjetFicheActualite.prototype.composeReponse=function(){var H=[];switch(this.actualite.genreReponse){case TypeGenreReponseInternetActualite.AvecAR:H.push('<div style="padding:5px 5px 1px 5px;"><ie-checkbox tabindex="-1" id="',this.getIDReponse(),'_0" class="',this._classActualiteSaisieDirect,'" ',GObjetWAI.composeAttribut({genre:EGenreAttribut.label,valeur:GTraductions.getValeur('accueil.prisConnaissance')}),'onclick="',this.Nom,'.surSaisieReponse ();"','onkeyup=" ',this.Nom,'.surKeyUpReponse();"',(this.actualite.avecReponse?' checked=checked disabled':''),'><label for="',this.getIDReponse(),'">',GTraductions.getValeur('accueil.prisConnaissance'),'</label></ie-checkbox></div>');break;case TypeGenreReponseInternetActualite.Textuelle:H.push('<div style="padding:1px 5px;"><textarea maxlength="0" tabindex="-1" id="',this.getIDReponse(),'_0" class="Texte10" style="width: 100%; overflow : hidden; ',GStyle.composeCouleurBordure(GCouleur.grisClair),'" rows="3" ',GObjetWAI.composeAttribut({genre:EGenreAttribut.label,valeur:GTraductions.getValeur('accueil.saisirReponse')}),'onkeyup="',this.Nom,'.surSaisieReponse (value)" maxlength="'+this.actualite.tailleReponse+'" placeholder="',GTraductions.getValeur('actualites.SaisirReponse'),'">',this.actualite.valeurReponse,'</textarea></div>');break;case TypeGenreReponseInternetActualite.ChoixUnique:case TypeGenreReponseInternetActualite.ChoixMultiple:for(var I=0;I<this.actualite.listeChoix.GetNbrElements();I++)
H.push('<div style="padding:',I===0?5:1,'px 5px 1px 5px;"><input id="',this.getIDReponse(),'_',I,'" name="coches" type="',(this.actualite.genreReponse===TypeGenreReponseInternetActualite.ChoixMultiple?'checkbox':'radio'),'" ',GObjetWAI.composeAttribut({genre:EGenreAttribut.label,valeur:this.actualite.listeChoix.GetLibelle(I)}),'onclick="',this.Nom,'.surSaisieReponse (value, checked)" value="',(I+1),'"'+(this.actualite.valeurReponse.GetValeur(I+1)?' checked=checked':'')+'><label for="',this.getIDReponse(),'_',I,'">'+this.actualite.listeChoix.GetLibelle(I)+'</label></div>');break;default:break;}
return H.join('');};ObjetFicheActualite.prototype.surSaisieReponse=function(aValeurReponse,aValeurCoche){if(this.actualite.genreReponse===TypeGenreReponseInternetActualite.Textuelle){if(aValeurReponse.length<=this.actualite.tailleReponse){this.actualite.valeurReponse=aValeurReponse;} else{GApplication.getMessage().Afficher(EGenreBoiteMessage.Information,null,GTraductions.getValeur('actualites.TailleMaximale'));GHtml.setValue(this.getIDReponse(),this.actualite.valeurReponse);}} else if(this.actualite.genreReponse===TypeGenreReponseInternetActualite.ChoixUnique||this.actualite.genreReponse===TypeGenreReponseInternetActualite.ChoixMultiple){if(this.actualite.genreReponse===TypeGenreReponseInternetActualite.ChoixUnique)
this.actualite.valeurReponse.Vider();this.actualite.valeurReponse.SetValeur(aValeurCoche,aValeurReponse);} else{this.actualite.SetEtat(EGenreEtat.Modification);}
this.actualite.avecReponse=true;if((this.actualite.genreReponse!==TypeGenreReponseInternetActualite.ChoixMultiple)&&(this.actualite.genreReponse!==TypeGenreReponseInternetActualite.Textuelle))
this.Fermer();};ObjetFicheActualite.prototype.surBouton=function(){this.actualite.SetEtat(EGenreEtat.Modification);this.Fermer();};;
ObjetAffichagePageAccueil.prototype.existeWidgetVieScolaire=function(){return!this.donnees||this.donnees.vieScolaire.listeAbsences;};ObjetAffichagePageAccueil.prototype.creerObjetstVieScolaire=function(){this.fichePresence=ObjetFenetre.creerInstance(window.ObjetFichePresence,{pere:this,evenement:this._evnFichePresence,initialiser:false});this.addFiche(this.fichePresence);this.utilitaireAbsence=new ObjetUtilitaireAbsence();};ObjetAffichagePageAccueil.prototype.initialiserObjetsVieScolaire=function(){this.fichePresence.Initialiser();};ObjetAffichagePageAccueil.prototype.composeWidgetVieScolaire=function(){var lCumulARegulariser=false,lCumulAutre=false;var H=[];if(this.donnees.vieScolaire.listeAbsences.GetNbrElements()>0){H.push('<div class="PetitEspace">');for(var I=0;I<this.donnees.vieScolaire.listeAbsences.GetNbrElements();I++){var lAbsence=this.donnees.vieScolaire.listeAbsences.GetElement(I);if(lAbsence.aRegulariser&&!lCumulARegulariser){lCumulARegulariser=true;H.push('<div class="PetitEspace Gras" style="',GStyle.composeCouleur(GCouleur.themeNeutre.legere2),'">',GTraductions.getValeur('AbsenceVS.ARegulariser'),'</div>');}
if(!lAbsence.aRegulariser&&!lCumulAutre&&lCumulARegulariser){lCumulAutre=true;H.push('<div class="PetitEspace Gras" style="',GStyle.composeCouleur(GCouleur.themeNeutre.legere2),'">',GTraductions.getValeur('AbsenceVS.Autres'),'</div>');}
H.push(this.composeAbsence(lAbsence,I));}
H.push('</div>');}
return H.join('');};ObjetAffichagePageAccueil.prototype.construireWidgetVieScolaire=function(){this.creerObjetstVieScolaire();var lWidget={html:this.composeWidgetVieScolaire(),nbrElements:this.donnees.vieScolaire.listeAbsences.GetNbrElements(),afficherMessage:this.donnees.vieScolaire.listeAbsences.GetNbrElements()===0};$.extend(true,this.donnees.vieScolaire,lWidget);this.construireWidget(this.donnees.vieScolaire);this.initialiserObjetsVieScolaire();};ObjetAffichagePageAccueil.prototype.composeAbsence=function(aAbsence,i){var H=[];var lLibelle=this.utilitaireAbsence.getChaineTraductionGenreAbsence({genre:aAbsence.GetGenre(),singulier:true,justifie:aAbsence.justifie}).ucfirst()+' '+this.utilitaireAbsence.getDate(aAbsence,true);H.push('<div ',GObjetWAI.composeRole(EGenreRole.Listitem),' ',GObjetWAI.composeAttribut({genre:EGenreAttribut.label,valeur:lLibelle}),' ','>');H.push('<div>');H.push('<div style="'+GStyle.composeWidth(this.tailleImages)+'" class="InlineBlock AlignementMilieuVertical ',EGenreRessource.getNomImageAbsence({genre:aAbsence.GetGenre(),genreNature:aAbsence.nature?aAbsence.nature.GetGenre():null,justifie:aAbsence.justifie,estLue:aAbsence.estLue,avecSursis:aAbsence.avecSursis}),'"></div>');H.push('<div class="InlineBlock AlignementMilieuVertical EspaceGauche">');H.push('<span class="LienAccueil" onclick="',this.Nom,'._surAbsence (',i,')">',this.utilitaireAbsence.getChaineTraductionGenreAbsence({genre:aAbsence.GetGenre(),singulier:true,justifie:aAbsence.justifie}).ucfirst(),'</span>');H.push('<span>','&nbsp;',this.utilitaireAbsence.getDate(aAbsence,true),'</span>');H.push('</div>');H.push('</div>');H.push('</div>');return H.join('');};ObjetAffichagePageAccueil.prototype._surAbsence=function(i){var lListeAbsencesFiche=new ObjetListeElements();var lAbsence=this.donnees.vieScolaire.listeAbsences.GetElement(i);lListeAbsencesFiche.AddElement(lAbsence);this.fichePresence.SetDonnees(null,this.utilitaireAbsence.getChaineTraductionGenreAbsence({genre:lAbsence.GetGenre(),singulier:true,justifie:lAbsence.justifie}).ucfirst(),lListeAbsencesFiche,this.autorisationsVS);};ObjetAffichagePageAccueil.prototype._evnFichePresence=function(aAvecSaisie,aAbsence){if(!aAvecSaisie) return;var lElement=this.donnees.vieScolaire.listeAbsences.GetElementParElement(aAbsence);if(((lElement.GetGenre()===EGenreRessource.Punition)&&lElement.nature&&lElement.nature.estAvecARParent)||(lElement.GetGenre()===EGenreRessource.ObservationProfesseurEleve)){this.SurValidation();} else{this.SetEtatSaisie(this.donnees.actualites.listeActualites.existeElementPourValidation()||this.donnees.vieScolaire.listeAbsences.existeElementPourValidation());}};function _getIdCombo(aIndice){return'_I_'+aIndice;}
function _initCombos(){var I,lCombo;for(I=0;I<this.donnees.listeAbsences.GetNbrElements();I++){lCombo=this.combos[_getIdCombo(I)];if(lCombo){lCombo.Initialiser();_actualiserCombo.bind(this)(I);}}}
function _actualiserCombo(aIndice){var lCombo=this.combos[_getIdCombo(aIndice)];if(!lCombo) return;var lAbsence=this.donnees.listeAbsences.GetElement(aIndice);var lListe=lAbsence.GetGenre()===EGenreRessource.Absence?GEtatUtilisateur.listeMotifsAbsences:GEtatUtilisateur.listeMotifsRetards;lCombo.SetDonnees(lListe);if(lAbsence.motifParent&&lAbsence.motifParent.existeNumero())
lCombo.SetSelectionParNumeroEtGenre(lAbsence.motifParent.GetNumero());else lCombo.SetContenu(GTraductions.getValeur('AbsenceVS.aPreciser'));}
function _creationCombos(){var I,lId,lAbsence;this.combos={};for(I=0;I<this.donnees.listeAbsences.GetNbrElements();I++){lAbsence=this.donnees.listeAbsences.GetElement(I);var lListe=lAbsence.GetGenre()===EGenreRessource.Absence?GEtatUtilisateur.listeMotifsAbsences:GEtatUtilisateur.listeMotifsRetards;var lSaisieMotif=false;switch(lAbsence.GetGenre()){case EGenreRessource.Absence:lSaisieMotif=this.autorisationsVS?this.autorisationsVS.saisieMotifAbsence:false;break;case EGenreRessource.Retard:lSaisieMotif=this.autorisationsVS?this.autorisationsVS.saisieMotifRetard:false;break;default:break;}
if(lSaisieMotif&&MethodesTableau.existe(lAbsence.GetGenre(),[EGenreRessource.Absence,EGenreRessource.Retard])&&lListe.GetNbrElements()>0){lId=_getIdCombo(I);this.combos[lId]=new ObjetSaisie(this.Nom+'.saisies'+lId,null,this,_surEvenementSaisie.bind(this,I));this.combos[lId].SetParametres(EGenreSaisie.Combo,'init dans fonction _creationCombos',true);this.combos[lId].setNbrLignes(4);}}}
function _surEvenementSaisie(aIndice,aGenreSelection,aElement,aSelection){var lAbsence=this.donnees.listeAbsences.GetElement(aIndice);if((aGenreSelection===EGenreEvenementObjetSaisie.selection&&aElement)&&(lAbsence.motifParent.GetNumero()!==aElement.GetNumero())){lAbsence.motifParent=aElement;lAbsence.SetEtat(EGenreEtat.Modification);this.SetEtatSaisie(true);}};
function TUtilitaireListePeriodes(){}(function(){TUtilitaireListePeriodes.choix={aujourdhui:1,hier:1,demain:1,semaineCourante:1,semainePrecedente:1,semaineSuivante:1,moisCourant:1,periodes:1,annee:1,mois:1};IE.MethodesObjet.indenterEnumere(TUtilitaireListePeriodes.choix);TUtilitaireListePeriodes.construireListePeriodes=function(aChoixPeriodes,aOptions){var lListe=new ObjetListeElements(),lOptions=$.extend({dateDebut:GParametres.PremiereDate,dateFin:GParametres.DerniereDate,dansBornes:function(aDate){return(aDate>this.dateDebut||GDate.estJourEgal(aDate,this.dateDebut))&&(aDate<this.dateFin||GDate.estJourEgal(aDate,this.dateFin));},datesOK:function(aDateDebut,aDateFin){return this.dansBornes(aDateDebut)||this.dansBornes(aDateFin);},borner:function(aDate){if(aDate<this.dateDebut)
return new Date(this.dateDebut.getTime());if(aDate>this.dateFin)
return new Date(this.dateFin.getTime());return aDate;}},aOptions);if(IE.MethodesObjet.isArray(aChoixPeriodes))
for(var i=0;i<aChoixPeriodes.length;i++){_ajouterChoix(lListe,aChoixPeriodes[i],lOptions);}
return lListe;};function _ajouterChoix(aListe,aChoix,aOptions){var lElement=null,lDate,lDateDebut,lDateFin,lCycle;function _ajouterElement(aLibelle,aDateDebut,aDateFin){var lElement=new ObjetElement(aLibelle);lElement.dates={debut:aOptions.borner(aDateDebut),fin:aOptions.borner(aDateFin)};lElement.choix=aChoix;aListe.AddElement(lElement);}
switch(aChoix){case TUtilitaireListePeriodes.choix.aujourdhui:_ajouterElement(GTraductions.getValeur('Aujourdhui').ucfirst(),GDate.getDateCourante(),GDate.getDateCourante());break;case TUtilitaireListePeriodes.choix.hier:lDate=GDate.GetJourSuivant(GDate.getDateCourante(),-1);if(aOptions.datesOK(lDate,lDate))
_ajouterElement(GTraductions.getValeur('Hier').ucfirst(),lDate,lDate);break;case TUtilitaireListePeriodes.choix.demain:lDate=GDate.GetJourSuivant(GDate.getDateCourante(),1);if(aOptions.datesOK(lDate,lDate))
_ajouterElement(GTraductions.getValeur('Demain').ucfirst(),lDate,lDate);break;case TUtilitaireListePeriodes.choix.semaineCourante:lCycle=IE.Cycles.cycleCourant();lDateDebut=IE.Cycles.dateDebutCycle(lCycle);lDateFin=IE.Cycles.dateFinCycle(lCycle);if(aOptions.datesOK(lDateDebut,lDateFin))
_ajouterElement(GTraductions.getValeur('SemaineEnCours'),lDateDebut,lDateFin);break;case TUtilitaireListePeriodes.choix.semainePrecedente:lCycle=IE.Cycles.cycleCourant()-1;if(IE.Cycles.cycleDansAnnee(lCycle)!==lCycle)
return;lDateDebut=IE.Cycles.dateDebutCycle(lCycle);lDateFin=IE.Cycles.dateFinCycle(lCycle);if(aOptions.datesOK(lDateDebut,lDateFin))
_ajouterElement(GTraductions.getValeur('SemainePrecedente'),lDateDebut,lDateFin);break;case TUtilitaireListePeriodes.choix.semaineSuivante:lCycle=IE.Cycles.cycleCourant()+1;if(IE.Cycles.cycleDansAnnee(lCycle)!==lCycle)
return;lDateDebut=IE.Cycles.dateDebutCycle(lCycle);lDateFin=IE.Cycles.dateFinCycle(lCycle);if(aOptions.datesOK(lDateDebut,lDateFin))
_ajouterElement(GTraductions.getValeur('SemaineSuivante'),lDateDebut,lDateFin);break;case TUtilitaireListePeriodes.choix.moisCourant:lDate=GDate.getDateCourante();lDateDebut=GDate.GetPremierJourDuMois(lDate.getFullYear(),lDate.getMonth());lDateFin=GDate.GetDernierJourDuMois(lDate.getFullYear(),lDate.getMonth());if(aOptions.datesOK(lDateDebut,lDateFin))
_ajouterElement(GTraductions.getValeur('MoisEnCours'),lDateDebut,lDateFin);break;case TUtilitaireListePeriodes.choix.periodes:var lListePeriodesSaisie=new ObjetListeElements();GParametres.listePeriodes.parcourir(function(D){if(D.GetGenre()>0&&D.GetGenre()!==3&&(aOptions.datesOK(D.dates.debut,D.dates.fin))){lElement=IE.MethodesObjet.dupliquer(D);lElement.choix=aChoix;lElement.dates.debut=aOptions.borner(D.dates.debut);lElement.dates.fin=aOptions.borner(D.dates.fin);lListePeriodesSaisie.AddElement(lElement);}});lListePeriodesSaisie.setTri([ObjetTri.init(function(D){return D.GetGenre()===3?0:1;}),ObjetTri.init(function(D){return D.GetGenre();})]);lListePeriodesSaisie.trier();aListe.FusionnerListe(lListePeriodesSaisie);break;case TUtilitaireListePeriodes.choix.annee:GParametres.listePeriodes.parcourir(function(D){if(D.GetGenre()===3){lElement=IE.MethodesObjet.dupliquer(D);lElement.SetLibelle(GTraductions.getValeur('AnneeComplete'));lElement.choix=aChoix;lElement.dates.debut=aOptions.borner(D.dates.debut);lElement.dates.fin=aOptions.borner(D.dates.fin);aListe.AddElement(lElement);return false;}});break;case TUtilitaireListePeriodes.choix.mois:GDate.getListeMoisAPartirDeDate(aOptions.dateDebut,aOptions.dateFin).parcourir(function(D){_ajouterElement(D.GetLibelle(),D.dateDebut,D.dateFin);});break;default:;}}})();;
function TUtilitaireInformations(){}(function(){TUtilitaireInformations.initialiserNouveauItem=function(aParam){var lInformation=aParam.actualite?new ObjetElement(GTraductions.getValeur('actualites.Edition.CopieDe',[aParam.actualite.GetLibelle()])):new ObjetElement('');lInformation.genreReponse=!aParam.genreReponse?aParam.actualite?aParam.actualite.genreReponse:TypeGenreReponseInternetActualite.AvecAR:aParam.genreReponse;lInformation.categorie=!aParam.categorie?!aParam.actualite?GEtatUtilisateur.listeCategories.GetElement(this.indiceCategorieParDefaut):aParam.actualite.categorie:aParam.categorie;lInformation.message=aParam.actualite?aParam.actualite.message:'';lInformation.auteur=GEtatUtilisateur.getUtilisateur().GetLibelle();lInformation.reponseAnonyme=false;lInformation.date='';lInformation.publie=aParam.actualite?false:true;lInformation.dateDebut=aParam.actualite?aParam.actualite.dateDebut:GDate.getDateCourante();lInformation.dateFin=aParam.actualite?aParam.actualite.dateFin:GDate.derniereDate;lInformation.etatPublication=TUtilitaireInformations.getEtatPublication.bind(this)(lInformation);lInformation.avecReponse=false;lInformation.lue=false;lInformation.tailleReponse=aParam.actualite?aParam.actualite.tailleReponse:200;lInformation.public=new ObjetElement('');lInformation.genrePublic= -1;lInformation.visible=true;lInformation.listeDocumentsJoints=aParam.actualite?_copierDocuments.bind(this)(aParam.actualite.listeDocumentsJoints):new ObjetListeElements();lInformation.listeChoix=aParam.actualite?_copierChoixReponses.bind(this)(aParam.actualite.listeChoix):new ObjetListeElements();lInformation.nombreDestinataire=aParam.actualite?aParam.actualite.nombreDestinataire:0;lInformation.nomDestinataire=aParam.actualite?aParam.actualite.nomDestinataire:GTraductions.getValeur('actualites.Aucun');lInformation.detailPublic=aParam.actualite?aParam.actualite.detailPublic:GTraductions.getValeur('actualites.AucunDestinataire');lInformation.avecModificationPublic=aParam.actualite||aParam.listePublic?true:false;lInformation.genresPublicEntite=aParam.actualite?IE.MethodesObjet.dupliquer(aParam.actualite.genresPublicEntite):new TypeEnsembleNombre();lInformation.listePublicEntite=aParam.actualite?IE.MethodesObjet.dupliquer(aParam.actualite.listePublicEntite):new ObjetListeElements();if(aParam.listePublic&&aParam.genresPublic){lInformation.listePublicEntite=new ObjetListeElements();lInformation.listePublicIndividu=new ObjetListeElements();if(aParam.genresPublic.length>0){if(($.inArray(EGenreRessource.Classe,this.genresRessourceAffDestinataire)>-1)||($.inArray(EGenreRessource.Groupe,this.genresRessourceAffDestinataire)>-1))
lInformation.listePublicEntite=aParam.listePublic;else lInformation.listePublicIndividu=aParam.listePublic;}} else{lInformation.listePublicEntite=aParam.actualite?IE.MethodesObjet.dupliquer(aParam.actualite.listePublicEntite):new ObjetListeElements();lInformation.listePublicIndividu=aParam.actualite?IE.MethodesObjet.dupliquer(aParam.actualite.listePublicIndividu):new ObjetListeElements();}
lInformation.getDate=TUtilitaireInformations.getDate.bind(lInformation);return lInformation;};TUtilitaireInformations.getDate=function(){return GTraductions.getValeur('Du')+GDate.FormatDate(this.dateDebut,' %JJ/%MM/%AAAA ')+GTraductions.getValeur('Au')+GDate.FormatDate(this.dateFin,' %JJ/%MM/%AAAA');};TUtilitaireInformations.getEtatPublication=function(aActualite){var lActualite=aActualite?aActualite:this.actualite;if(!lActualite.publie){return TypeEtatPublication.PasPubliee;} else{if(GDate.dateEstDansLaPeriode(GDate.getDateCourante(),lActualite.dateDebut ,lActualite.dateFin)){return TypeEtatPublication.PublieeDansDate;} else{return TypeEtatPublication.PublieeHorsDate;}}};function _copierDocuments(aListeDocuments){var lResult=IE.MethodesObjet.dupliquer(aListeDocuments);for(var i=0;i<lResult.GetNbrElements() ;i++){if(lResult.Existe(i)){var lElement=lResult.GetElement(i);lElement.SetEtat(EGenreEtat.Creation);}}
return lResult;}
function _copierChoixReponses(aListeChoix){var lResult=new ObjetListeElements();for(var i=0;i<aListeChoix.GetNbrElements() ;i++){if(aListeChoix.Existe(i)){var lElement=aListeChoix.GetElement(i);var lChoix=new ObjetElement(lElement.GetLibelle());lChoix.rang=lElement.rang;lChoix.SetEtat(EGenreEtat.Creation);lResult.AddElement(lChoix);}}
return lResult;}
TUtilitaireInformations.initListePeriodes=function(){return TUtilitaireListePeriodes.construireListePeriodes([TUtilitaireListePeriodes.choix.aujourdhui,TUtilitaireListePeriodes.choix.semaineCourante,TUtilitaireListePeriodes.choix.moisCourant,TUtilitaireListePeriodes.choix.annee,TUtilitaireListePeriodes.choix.periodes,TUtilitaireListePeriodes.choix.mois]);};TUtilitaireInformations.avecCumul=function(aListe){if(MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Parent,EGenreEspace.Mobile_Parent,EGenreEspace.Entreprise])){if(GEtatUtilisateur.Identification.ListeRessources.GetNbrElements()>1){return true;} else{var lGenre=(GEtatUtilisateur.GenreEspace===EGenreEspace.Entreprise)?EGenreRessource.MaitreDeStage:EGenreRessource.Responsable;return(aListe.getIndiceElementParFiltre(function(aElement){return(aElement.public.GetNumero()===GEtatUtilisateur.getUtilisateur().GetNumero())&&(aElement.public.GetNumero()===lGenre);})>-1);}} else{return false;}};TUtilitaireInformations.formaterListePourCumul=function(aListe){for(var I=0;I<aListe.GetNbrElements();I++){var lElement=aListe.GetElement(I);if(lElement.public){var lCumulPere=aListe.GetElementParNumeroEtGenre(lElement.public.GetNumero(),lElement.public.GetGenre());if(!lCumulPere){var lGenre=(GEtatUtilisateur.GenreEspace===EGenreEspace.Entreprise)?EGenreRessource.MaitreDeStage:EGenreRessource.Responsable;var lATitreIndividuel=(lElement.public.GetNumero()===GEtatUtilisateur.getUtilisateur().GetNumero())&&(lElement.public.GetGenre()===lGenre);var lLibelle=lATitreIndividuel?GTraductions.getValeur('actualites.ATitreIndividuel'):GTraductions.getValeur('actualites.AProposDe',[lElement.public.prenom?lElement.public.prenom:lElement.public.GetLibelle()]);lCumulPere=new ObjetElement(lLibelle,lElement.public.GetNumero(),lElement.public.GetGenre());lCumulPere.estUnDeploiement=true;lCumulPere.estDeploye=true;lCumulPere.aTitreIndividuel=lATitreIndividuel;aListe.AddElement(lCumulPere);}
lElement.pere=lCumulPere;}}
aListe.setTri([
ObjetTri.init(function(D){return D.estUnDeploiement?D.aTitreIndividuel:D.pere.aTitreIndividuel;}),ObjetTri.init(function(D){return D.estUnDeploiement?D.GetLibelle():D.pere.GetLibelle();}),ObjetTri.init(function(D){return!D.estUnDeploiement;}),ObjetTri.init(function(D){return D.estUnDeploiement?'':D.dateDebut;},EGenreTriElement.Decroissant),ObjetTri.init(function(D){return D.estUnDeploiement?'':D.dateFin;}),ObjetTri.init(function(D){return D.estUnDeploiement?'':D.GetLibelle();})
]);aListe.trier();};})();;
ObjetAffichagePageAccueil.prototype.existeWidgetActualites=function(){return!this.donnees||this.donnees.actualites.listeActualites;};ObjetAffichagePageAccueil.prototype.creerObjetstActualites=function(){this.ficheActualite=ObjetFenetre.creerInstance(window.ObjetFicheActualite,{pere:this,evenement:this._evenementSurFicheActualite});this.addFiche(this.ficheActualite);};ObjetAffichagePageAccueil.prototype.initialiserObjetsActualites=function(){this.ficheActualite.Initialiser();};ObjetAffichagePageAccueil.prototype.composeWidgetActualites=function(){var H=[];if(this.donnees.actualites.listeActualites.GetNbrElements()>0){for(var I=0;I<this.donnees.actualites.listeActualites.GetNbrElements();I++){var lElement=this.donnees.actualites.listeActualites.GetElement(I);H.push(this.composeActualite(lElement,I));}}
return H.join('');};ObjetAffichagePageAccueil.prototype.construireWidgetActualites=function(){this.creerObjetstActualites();var lAvecCumul=TUtilitaireInformations.avecCumul(this.donnees.actualites.listeActualites);this.donnees.actualites.listeActualites.setTri([ObjetTri.init(function(a){return a.categorie?a.categorie.GetLibelle():'';})]);this.donnees.actualites.listeActualites.trier();if(lAvecCumul)
TUtilitaireInformations.formaterListePourCumul(this.donnees.actualites.listeActualites);else{this.donnees.actualites.listeActualites.setTri([
ObjetTri.init('dateDebut',EGenreTriElement.Decroissant),ObjetTri.init('dateFin'),ObjetTri.init('Libelle')
]);this.donnees.actualites.listeActualites.trier();}
var lWidget={html:this.composeWidgetActualites(),nbrElements:this.donnees.actualites.listeActualites.GetNbrElements(),afficherMessage:this.donnees.actualites.listeActualites.GetNbrElements()===0};$.extend(true,this.donnees.actualites,lWidget);this.construireWidget(this.donnees.actualites);this.initialiserObjetsActualites();};ObjetAffichagePageAccueil.prototype.composeActualite=function(aActualite,i){var H=[];var lID=this.donnees.actualites.id+'_div_'+i;var lLabelWai=aActualite.GetLibelle()+(aActualite.signataire?' : '+aActualite.signataire:'');var lOnKeyUp='if (GNavigateur.IsToucheSelection()) GHtml.setFocus('+this.Nom+'.getIDReponse('+i+')+\'_0\');';H.push('<div id="',lID,'" ',' onkeyup="',lOnKeyUp,'" ',GObjetWAI.composeRole(EGenreRole.Treeitem),GObjetWAI.composeAttribut({genre:EGenreAttribut.expanded,valeur:(i===0?'true':'false')}) ,GObjetWAI.composeAttribut({genre:EGenreAttribut.labelledby,valeur:lID+'_wai'}) ,i===0?GObjetWAI.composeAttribut({genre:EGenreAttribut.describedby,valeur:lID+'_detail'}):'' ,' tabIndex="-1">');var lEstUneInformaition=aActualite.genreReponse===TypeGenreReponseInternetActualite.AvecAR||aActualite.genreReponse===TypeGenreReponseInternetActualite.SansAR;if(aActualite.estUnDeploiement){H.push('<div class="PetitEspace">');H.push('<div class="PetitEspace Gras" style="',GStyle.composeCouleur(GCouleur.themeNeutre.legere2),'">',aActualite.GetLibelle(),'</div>');H.push('</div>');} else{H.push('<div class="PetitEspace">');H.push('<span class="LienAccueil" title="',lEstUneInformaition?GTraductions.getValeur('accueil.informations.hintLien.information'):GTraductions.getValeur('accueil.informations.hintLien.sondage'),'" onclick="',this.Nom,'._surActualite (',i,')">',aActualite.GetLibelle(),aActualite.categorie&&aActualite.categorie.GetLibelle()?' ('+aActualite.categorie.GetLibelle()+')':'','</span>');H.push(aActualite.auteur?' '+aActualite.auteur:'');H.push('</div>');}
H.push(GObjetWAI.composeSpan(lLabelWai,lID+'_wai'));H.push('</div>');return H.join('');};ObjetAffichagePageAccueil.prototype._surActualite=function(i){this.ficheActualite.SetDonnees(this.donnees.actualites.listeActualites.GetElement(i));};ObjetAffichagePageAccueil.prototype._evenementSurFicheActualite=function(){if(this.ficheActualite.actualite&&(this.ficheActualite.actualite.avecReponse||this.ficheActualite.actualite.genreReponse===TypeGenreReponseInternetActualite.SansAR)&&!this.ficheActualite.actualite.lue){this.ficheActualite.actualite.lue=true;this.ficheActualite.actualite.marqueLueSeulement=false;this.ficheActualite.actualite.SetEtat(EGenreEtat.Modification);this.Valider();}};;
MethodesObjet.heritagePrototype(ObjetFicheEvenement,ObjetFiche);function ObjetFicheEvenement(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.Largeur=300;this.Hauteur=150;this.largeurMax=750;this.hauteurMax=400;}
ObjetFicheEvenement.prototype.SetDonnees=function(aListeEvenements,aEvenement){this.listeEvenements=aListeEvenements;this.evenement=aEvenement;this.Afficher();};ObjetFicheEvenement.prototype.GetTitre=function(){return this.evenement.GetLibelle();};ObjetFicheEvenement.prototype.ComposeContenu=function(){var H=[];H.push('<div class="PetitEspace">');H.push('<div style="clear: both" class="PetitEspace">','<div style="float: left; width: 12px; ',GStyle.composeCouleurFond(this.evenement.CouleurCellule),'">&nbsp;</div>','<div style="float: left; padding:0px 5px;">',this.listeEvenements._getDateEvenement({evenement:this.evenement}),'</div>','</div>');H.push('<div  style="clear: both" class="PetitEspace">',this.evenement.Commentaire,'</div>');if(this.evenement.listeDocJoints&&this.evenement.listeDocJoints.GetNbrElements()>0){H.push('<div  style="clear: both" class="PetitEspace">',this.composeDocuments(this.evenement.listeDocJoints),'</div>');}
H.push('</div>');return H.join('');};ObjetFicheEvenement.prototype.composeDocuments=function(aListeDocumentsJoints){var lHtml=[];for(var I=0;I<aListeDocumentsJoints.GetNbrElements();I++){var lDocumentJoint=aListeDocumentsJoints.GetElement(I);lHtml.push(GChaine.composerURL(lDocumentJoint.Url,lDocumentJoint.GetLibelle(),lDocumentJoint.GetGenre()===EGenreDocumentJoint.Fichier));}
return lHtml.join('<br/>');};;
ObjetAffichagePageAccueil.prototype.existeWidgetAgenda=function(){return!this.donnees||this.donnees.agenda.listeEvenements;};ObjetAffichagePageAccueil.prototype.creerObjetstAgenda=function(){this.ficheEvenement=ObjetFenetre.creerInstance(window.ObjetFicheEvenement,{pere:this,evenement:this.evenementSurFicheEvenement,initialiser:false});this.addFiche(this.ficheEvenement);};ObjetAffichagePageAccueil.prototype.initialiserObjetsAgenda=function(){this.ficheEvenement.Initialiser();};ObjetAffichagePageAccueil.prototype.composeWidgetAgenda=function(){var H=[];if(this.donnees.agenda.listeEvenements.GetNbrElements()>0){for(var I=0;I<this.donnees.agenda.listeEvenements.GetNbrElements();I++){H.push(this.composeEvenement(this.donnees.agenda.listeEvenements.GetElement(I),I));}}
return H.join('');};ObjetAffichagePageAccueil.prototype.construireWidgetAgenda=function(){this.creerObjetstAgenda();var lWidget={html:this.composeWidgetAgenda(),nbrElements:this.donnees.agenda.listeEvenements.GetNbrElements(),afficherMessage:this.donnees.agenda.listeEvenements.GetNbrElements()===0};$.extend(true,this.donnees.agenda,lWidget);this.construireWidget(this.donnees.agenda);this.initialiserObjetsAgenda();};ObjetAffichagePageAccueil.prototype.composeEvenement=function(aEvenement,i){var H=[];H.push('<div ',GObjetWAI.composeRole(EGenreRole.Listitem),' ',GObjetWAI.composeAttribut({genre:EGenreAttribut.label,valeur:aEvenement.GetLibelle()+' '+this.donnees.agenda.listeEvenements._getLibelleEvenement({evenement:aEvenement}).join(',')}),'>');H.push('<div class="PetitEspace">');H.push('<span class="LienAccueil" title="',GTraductions.getValeur('accueil.agenda.hintLien'),'" onclick="',this.Nom,'._surEvenement (',i,')">',aEvenement.GetLibelle(),'</span>');if(aEvenement.listeEleves&&aEvenement.listeEleves.length>0)
H.push('<span class="PetitEspaceGauche PetitEspaceDroit" style="float:right;',GStyle.composeCouleurTexte(GCouleur.grisFonce),'">'+aEvenement.listeEleves.join(', '),'</span>');H.push(' - '+this.donnees.agenda.listeEvenements._getDateEvenement({evenement:aEvenement}));H.push('</div>');H.push('</div>');return H.join('');};ObjetAffichagePageAccueil.prototype._surEvenement=function(i){this.ficheEvenement.SetDonnees(this.donnees.agenda.listeEvenements,this.donnees.agenda.listeEvenements.GetElement(i));};;
ObjetAffichagePageAccueil.prototype.existeWidgetDiscussions=function(){return!this.donnees||this.donnees.discussions.listeMessagerie;};ObjetAffichagePageAccueil.prototype.composeWidgetDiscussions=function(){var H=[];if(this.donnees.discussions.listeMessagerie&&this.donnees.discussions.listeMessagerie.GetNbrElements()>0){for(var I=0;I<this.donnees.discussions.listeMessagerie.GetNbrElements();I++){H.push(_composeItemDiscussion.bind(this)(this.donnees.discussions.listeMessagerie.GetElement(I),I));}}
return H.join('');};ObjetAffichagePageAccueil.prototype.construireWidgetDiscussions=function(){var lWidget={html:this.composeWidgetDiscussions(),nbrElements:this.donnees.discussions.listeMessagerie?this.donnees.discussions.listeMessagerie.GetNbrElements():0,afficherMessage:!this.donnees.discussions.listeMessagerie||(this.donnees.discussions.listeMessagerie.GetNbrElements()===0)};$.extend(true,this.donnees.discussions,lWidget);this.construireWidget(this.donnees.discussions);};function _composeItemDiscussion(aDiscussion,i){var H=[];H.push('<div ',GObjetWAI.composeRole(EGenreRole.Listitem),' ',GObjetWAI.composeAttribut({genre:EGenreAttribut.label,valeur:aDiscussion.objet}),'>');H.push(this._composeDiscussion(aDiscussion,i));H.push('</div>');return H.join('');}
ObjetAffichagePageAccueil.prototype._composeDiscussion=function(aDiscussion,i){var H=[];if(aDiscussion){H.push('<div class="LienAccueil PetitEspace InlineBlock" title="',GTraductions.getValeur('accueil.discussions.hintLien'),'" onclick="',this.Nom,'._surDiscussion (',i,')">');H.push(aDiscussion.objet+'&nbsp;'+'('+aDiscussion.nombreMessages+')'+'&nbsp;');H.push('</div>');H.push('<div class="InlineBlock">');H.push(aDiscussion.documentsJoints?'&nbsp;-&nbsp;'+'<div class="InlineBlock">'+GImage.composeImage('Image_TrombonePetit',11,false)+'</div>':'');H.push('&nbsp;-&nbsp;'+aDiscussion.libelleDate+'&nbsp;-&nbsp;');H.push(aDiscussion.public?aDiscussion.public:'<div '+(aDiscussion.listePublic?' title="'+aDiscussion.listePublic.join('\n')+'"':'')+' class="InlineBlock AlignementHaut" style="margin-left:">'+GImage.composeImage('Image_Messagerie_Groupe',16,false)+'</div>');H.push('</div>');}
return H.join('');};ObjetAffichagePageAccueil.prototype._surDiscussion=function(i){if(this.fenetreDiscussion)
this.fenetreDiscussion.Fermer();this.fenetreDiscussion=ObjetFenetre.creerInstance(window.ObjetFenetre_Discussion,{pere:this,evenement:this._evntFenetreDiscussion,initialiser:false});this._initFenetreDiscussion(this.fenetreDiscussion);this.fenetreDiscussion.Initialiser();this.fenetreDiscussion.SetDonnees({discussion:this.donnees.discussions.listeMessagerie.GetElement(i),listeMessagerie:this.donnees.discussions.listeMessagerie});};ObjetAffichagePageAccueil.prototype._initFenetreDiscussion=function(aInstance){aInstance.setOptions({avecListeDiscussions:false,discussionSelectionneeUniquementVisible:true});aInstance.SetParametres_Fenetre('',700,500,[GTraductions.getValeur('Fermer')],true);};ObjetAffichagePageAccueil.prototype._evntFenetreDiscussion=function(){this.RecupererDonnees([this.donnees.discussions.genre]);};;
ObjetAffichagePageAccueil.prototype.existeWidgetExecutionsQCM=function(){return!this.donnees||(this.donnees.QCM.listeExecutionsQCM&&this.donnees.QCM.listeExecutionsQCM.GetNbrElements());};ObjetAffichagePageAccueil.prototype.construireWidgetExecutionsQCM=function(){this.donnees.QCM.listeExecutionsQCM.setTri([ObjetTri.init('dateDebutPublication'),ObjetTri.init('Position')]);var H=[];if(this.donnees.QCM.listeExecutionsQCM.GetNbrElements()>0){for(var I=0;I<this.donnees.QCM.listeExecutionsQCM.GetNbrElements();I++){var lExecutionsQCM=this.donnees.QCM.listeExecutionsQCM.GetElement(I);H.push('<div class="PetitEspace">','<div class="Gras">',GDate.strDates(lExecutionsQCM.dateDebutPublication,lExecutionsQCM.dateFinPublication,true).ucfirst(),'</div>');H.push('<div>');H.push('<div class="EspaceGauche10 LienAccueil" style="float: left;"');if(lExecutionsQCM.fichierDispo&&lExecutionsQCM.estEnPublication) H.push(' onclick="'+this.Nom+'.surExecutionQCM (event, '+I+')"');if(!lExecutionsQCM.fichierDispo) H.push(' title="'+GTraductions.getValeur('ExecutionQCM.FichierIndispo')+'"');H.push('>');H.push(lExecutionsQCM.service.GetLibelle(),'</div>');H.push('<div style="float: left;">','&nbsp;-&nbsp;',lExecutionsQCM.QCM.GetLibelle(),'</div>');H.push('<div style="clear:both"></div>');H.push('</div>');H.push('</div>');}}
var lWidget={html:H.join(''),nbrElements:this.donnees.QCM.listeExecutionsQCM.GetNbrElements(),afficherMessage:this.donnees.QCM.listeExecutionsQCM.GetNbrElements()===0};$.extend(true,this.donnees.QCM,lWidget);this.construireWidget(this.donnees.QCM);};ObjetAffichagePageAccueil.prototype.surExecutionQCM=function(aEvent,I){var lExecutionsQCM=this.donnees.QCM.listeExecutionsQCM.GetElement(parseInt(I));this.afficherExecutionQCM(lExecutionsQCM);};ObjetAffichagePageAccueil.prototype.evenementSurVisuEleve=function(aParam){if(aParam.action==='close'){this.fermerFiches();this.RecupererDonnees();}};;
ObjetAffichagePageAccueil.prototype.existeWidgetNotes=function(){return!this.donnees||this.donnees.notes.listeDevoirs;};ObjetAffichagePageAccueil.prototype.construireWidgetNotes=function(){var H=[];if(this.donnees.notes.listeDevoirs.GetNbrElements()>0){for(var I=0;I<this.donnees.notes.listeDevoirs.GetNbrElements();I++)
H.push(this.composeNote(this.donnees.notes.listeDevoirs.GetElement(I),I));}
var lSeparateur='<div class="PetitEspace"><div style="'+GStyle.composeCouleurBordure(GCouleur.themeCouleur.claire,1,EGenreBordure.bas)+'"></div></div>';var lWidget={html:H.join(lSeparateur),nbrElements:this.donnees.notes.listeDevoirs.GetNbrElements(),afficherMessage:this.donnees.notes.listeDevoirs.GetNbrElements()===0};$.extend(true,this.donnees.notes,lWidget);this.construireWidget(this.donnees.notes);};ObjetAffichagePageAccueil.prototype.composeNote=function(aDevoir,aIndex){var lStrDate=GDate.FormatDate(aDevoir.date,'['+GTraductions.getValeur('Le')+' '+'%JJ/%MM'+']');var lStrClasse=aDevoir.moyenne?' - '+(aDevoir.estEnGroupe?GTraductions.getValeur('accueil.moyGroupe'):GTraductions.getValeur('accueil.moyClasse'))+'&nbsp;:&nbsp;'+aDevoir.moyenne.getNote()+(aDevoir.bareme.estBaremeParDefaut()?'':' '+'<span class="Texte9">'+aDevoir.bareme.getBaremeEntier()+'</span>'):'';var lStrNote=aDevoir.note.getNote()+(aDevoir.bareme.estBaremeParDefaut()?'':' '+'<span class="Texte9">'+aDevoir.bareme.getBaremeEntier()+'</span>');var lWAI=GObjetWAI.composeAttribut({genre:EGenreAttribut.label,valeur:aDevoir.service.GetLibelle()+' '+aDevoir.note.getNote()+' '+lStrDate+lStrClasse});var H=[];H.push('<div id="',this.Nom,'_notes_',aIndex,'" tabIndex="-1" class="PetitEspace" ',lWAI,'>');H.push('<div>');H.push('<div class="Gras" style="float: left;">',aDevoir.service.GetLibelle(),'</div>');H.push('<div style="float: right;">');if(aDevoir.libelleCorrige)
H.push('<a class="LienAccueil"',' title="',GTraductions.getValeur('AfficherCorrige'),'"',' href="',GChaine.GetChainePourUrl(GApplication.getCommunication().composeUrlFichierExterne(aDevoir.libelleCorrige,{"N":aDevoir.GetNumero(),"G":EGenreRessource.Devoir}),true),'" target="_blank"','>',lStrNote,'</a>');else if(aDevoir.executionQCM&&aDevoir.executionQCM.publierCorrige)
H.push('<div class="LienAccueil" onclick="',this.Nom,'.surNote (',aIndex,')">',lStrNote,'</div>');else H.push(lStrNote);H.push('</div>');H.push('<div style="clear: both;">','</div>');H.push('</div>');H.push('<div>');H.push('<div style="padding-left: 10px; float: left;">',lStrDate,'</div>');H.push(lStrClasse?'<div style="float: left;">'+'&nbsp;'+lStrClasse+'</div>':'');H.push('<div style="clear: both;">','</div>');H.push('</div>');H.push('</div>');return H.join('');};ObjetAffichagePageAccueil.prototype.surNote=function(I){var lDevoir=this.donnees.notes.listeDevoirs.GetElement(I);this.afficherExecutionQCM(lDevoir.executionQCM);};;
MethodesObjet.heritagePrototype(ObjetFenetre_Memo,ObjetFenetre);function ObjetFenetre_Memo(ANom,AIdent,APere,AEvenement){this.inheritedCreate(ANom,AIdent,APere,AEvenement);this.memo='';this.idTextArea=this.Nom+'_textarea';this.idDiv=this.Nom+'_div';this._parametres={contenu:'',titre:GTraductions.getValeur('EDT.TitreFenetreMemo'),callback:null,nonEditable:true,avecValidationAuto:true,tailleMaxSaisie:255};this.setOptionsFenetre({avecMessageValidationAuto:true,avecRetaillage:true,largeurMin:350,largeur:500,hauteur:150});}(function(){ObjetFenetre_Memo.prototype.SetDonnees=function(aParametres){$.extend(this._parametres,aParametres);this.SetTitre(this._parametres.titre);this.setVisibleValidationAuto(!this._parametres.nonEditable&&this._parametres.avecValidationAuto);if(!this._parametres.nonEditable)
this.SetListeBoutons([GTraductions.getValeur('Annuler'),GTraductions.getValeur('Valider')]);else this.SetListeBoutons([GTraductions.getValeur('Fermer')]);this.Afficher(this.ComposeContenu());if(!this._parametres.nonEditable){GHtml.getElement(this.idTextArea).focus();}};ObjetFenetre_Memo.prototype.ComposeContenu=function(){var T=[];T.push('<div class="Table">');T.push('<textarea id="',this.idTextArea,'" maxlength="',this._parametres.tailleMaxSaisie,'" class="Texte10" style="height:99%; width:100%;',GStyle.composeCouleurBordure(GCouleur.fenetre.bordure,1),'" ',this._parametres.nonEditable?'readonly':'','>'+this._parametres.contenu+'</textarea>');T.push('</div>');return T.join('');};ObjetFenetre_Memo.prototype.SurValidation=function(ANumeroBouton,aFermer){var lValue=GHtml.getValue(this.idTextArea),lCallback=this._parametres.callback;if(aFermer!==false)
this.Fermer();if(lCallback)
lCallback(ANumeroBouton,lValue);};})();;
var EGenreDiagnostic={DiagOccupe:47,DiagOccupeVerrouilleDure:49,DiagIndisponibiliteDureRessource:44,DiagIndisponibiliteEtablissement:52,DiagPeriodeCloturee:51,DiagAbsenceRessource:55,DiagPresenceConseil:62,DiagJourFerie:61,DiagChangementSemaineGAEV:65,DiagSitesIncompatiblesHeureTransition:37,DiagSitesIncompatiblesDureeTrajet:38,DiagSitesIncompatiblesNbTransitionsJour:39,DiagSitesIncompatiblesNbTransitionsHebdo:66,DiagDemiPensionPasDeService:40,DiagDemiPensionPasDeServiceSeul:75,DiagDemiPensionMaximaDepasses:41};var TUtilGenreDiagnostic={getDiagnosticsDP:function(){return[EGenreDiagnostic.DiagDemiPensionPasDeService,EGenreDiagnostic.DiagDemiPensionPasDeServiceSeul,EGenreDiagnostic.DiagDemiPensionMaximaDepasses];},getDiagnosticsSite:function(){return[EGenreDiagnostic.DiagSitesIncompatiblesHeureTransition,EGenreDiagnostic.DiagSitesIncompatiblesDureeTrajet,EGenreDiagnostic.DiagSitesIncompatiblesNbTransitionsJour,EGenreDiagnostic.DiagSitesIncompatiblesNbTransitionsHebdo];}};;
MethodesObjet.heritagePrototype(InterfaceSelectionRessourceCours,ObjetAbstraitInterface);function InterfaceSelectionRessourceCours(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);var lId=window.GUID.getId(),lClass=window.GUID.getClassCss();this.idLigneTitreRessource=lId+'_ltr';this.idLigneRessource=lId+'_lr_';this.idCBSalleAuMoins1=lId+'_cb_un';this.classCssScroll=lClass+'_scroll';this.cssEventLigneTitreRessource=lClass+'_ltr';this.cssEventLigneRessource=lClass+'_lr';}(function(){InterfaceSelectionRessourceCours.genreMenuContextuel={supprimer:1};InterfaceSelectionRessourceCours.construireListeGroupesParties=function(aListeGroupes,aListeParties){var lListeGroupes=new ObjetListeElements();lListeGroupes.setTri([ObjetTri.init(function(D){return D.GetGenre()===EGenreRessource.PartieDeClasse;}),ObjetTri.init('Position'),ObjetTri.init('Libelle')]);lListeGroupes.FusionnerListe(aListeGroupes);lListeGroupes.FusionnerListe(aListeParties);return lListeGroupes;};InterfaceSelectionRessourceCours.prototype.getControleur=function(){return{capacite:{getValue:function(){return this.instance._parametres.infosFiltreSalle.capacite;},setValue:function(aValue){var lCapacite=parseInt(aValue,10);if(MethodesObjet.isNumber(lCapacite)){this.instance._parametres.infosFiltreSalle.capacite=lCapacite;if(this.instance._parametres.infosFiltreSalle.callbackModificationCapacite)
this.instance._parametres.infosFiltreSalle.callbackModificationCapacite(lCapacite,false);}
else this.instance._parametres.infosFiltreSalle.capacite=0;},eventBlur:function(){if(this.instance._parametres.infosFiltreSalle.callbackModificationCapacite)
this.instance._parametres.infosFiltreSalle.callbackModificationCapacite(this.instance._parametres.infosFiltreSalle.capacite,true);}}};};InterfaceSelectionRessourceCours.prototype.ConstruireInstances=function(){this.identMenuContextuel=this.Add(window.ObjetMenuContextuel,_evenementSurMenuContextuel.bind(this));};InterfaceSelectionRessourceCours.prototype.SetParametresGeneraux=function(){this.GenreStructure=EStructureAffichage.Autre;};InterfaceSelectionRessourceCours.prototype.ConstruireStructureAffichageAutre=function(){return'&nbsp;';};InterfaceSelectionRessourceCours.prototype.setDonnees_SelectionRessourceCours=function(aParametres){this._parametres={nonEditable:false,ressources:{},ordreRessources:[],avecFiltreSalle:false,infosFiltreSalle:{checked:true,capacite:0,callbackCBSalle:null,callbackModificationCapacite:null},avecDiagnostic:true,diagnostic:null,diagnosticPlace:null,largeur:250,largeurColDiagno:70,ecartDiagnostics:1,largeurDiagnosticImage:9,largeurTitrePlus:8,hauteurLigneTitre:18,hauteurLigneContenu:15,couleurFondListe:GCouleur.blanc,couleurFond:null,callbackAjoutRessource:null,callbackSuppressionRessource:null};$.extend(this._parametres,aParametres);for(var iGenreRessource=0;iGenreRessource<this._parametres.ordreRessources.length;iGenreRessource++){var lGenreRessource=this._parametres.ordreRessources[iGenreRessource];this._parametres.ressources[lGenreRessource]=$.extend({genre:lGenreRessource,libelle:'',liste:new ObjetListeElements(),afficherNombreRessources:true,nbLignesMax:5,avecAjout:true,avecEdition:true,fonctionNonEditable:function(aRessource){return aRessource.nonEditable;},couleurCarre:null,tailleCarreCouleur:9},this._parametres.ressources[lGenreRessource]);}
this._parametres.couleur=GCouleur;this._donnees={selection:null};Invocateur.desabonner('selectionRessourceCours_DeselectionRessource',this);Invocateur.abonner('selectionRessourceCours_DeselectionRessource',_invocateur_DeselectionRessource.bind(this),this);$('#'+this.GetNom().escapeJQ()).IEHtml(_construireAffichage.bind(this)(),{controleur:this.controleur});$('.'+this.classCssScroll).jScrollPane({showArrows:true});$('.'+this.cssEventLigneTitreRessource).on('mouseup',{instance:this},_surMouseUpLigneTitreRessource);$('.'+this.cssEventLigneRessource).on({mouseup:_surMouseUpRessource,mousedown:_surMouseDownRessource},{instance:this});if(this._parametres.avecFiltreSalle){$('#'+this.idCBSalleAuMoins1.escapeJQ()).jIECheckBox().inputChecked(this._parametres.infosFiltreSalle.checked).click({instance:this},_surCBSalle);}};function _construireAffichage(){var H=[];H.push('<div class="SansMain" style="',GStyle.composeWidth(this._parametres.largeur),GStyle.composeCouleurBordure(this._parametres.couleur.bordure,1,EGenreBordure.haut+EGenreBordure.droite+EGenreBordure.gauche),'">');for(var iGenreRessource=0;iGenreRessource<this._parametres.ordreRessources.length;iGenreRessource++){var lGenreRessource=this._parametres.ordreRessources[iGenreRessource];var lDescripteurRessource=this._parametres.ressources[lGenreRessource];H.push(_construireGenreRessource.bind(this)(lDescripteurRessource));}
H.push('</div>');return H.join('');}
function _construireGenreRessource(aDescripteurRessource){var H=[];H.push(_construireTitreGenreRessource.bind(this)(aDescripteurRessource));if(aDescripteurRessource.liste&&aDescripteurRessource.liste.GetNbrElements()>0){H.push('<div style="',GStyle.composeWidth(this._parametres.largeur),GStyle.composeCouleurBordure(this._parametres.couleur.bordure,1,EGenreBordure.bas),'" ','>');H.push(_construireListeGenreRessource.bind(this)(aDescripteurRessource));H.push('</div>');}
return H.join('');}
function _construireTitreGenreRessource(aDescripteurRessource){var H=[];var lAvecAjout=!this._parametres.nonEditable&&aDescripteurRessource.avecAjout;H.push('<div style="',GStyle.composeWidth(this._parametres.largeur),GStyle.composeCouleurBordure(this._parametres.couleur.bordure,1,EGenreBordure.bas),GStyle.composeCouleurFond(this._parametres.couleurFond||this._parametres.couleur.themeNeutre.legere2),'" ','>');H.push('<div id="',this.idLigneTitreRessource+'_'+aDescripteurRessource.genre,'" ','class="NoWrap Texte10 ',lAvecAjout?'AvecMain '+this.cssEventLigneTitreRessource:'','" ','style="position:relative;',GStyle.composeHeight(this._parametres.hauteurLigneTitre),'line-height:',this._parametres.hauteurLigneTitre,'px;">');H.push('<div class="InlineBlock Texte14 Gras PetitEspaceDroit PetitEspaceGauche AlignementMilieuVertical" ','style="',GStyle.composeWidth(this._parametres.largeurTitrePlus),'">',lAvecAjout?'+':'&nbsp;','</div>');H.push('<div class="InlineBlock AlignementMilieuVertical">',aDescripteurRessource.libelle,'</div>');if(aDescripteurRessource.afficherNombreRessources){var lNbElements=aDescripteurRessource.liste.GetNbrElements();if(lNbElements>0){H.push('<div style="position:absolute; right: 2px; top:0px;">',lNbElements ,'</div>');}}
H.push('</div>');if(this._parametres.avecFiltreSalle&&aDescripteurRessource.genre===EGenreRessource.Salle){H.push('<div class="Espace">');H.push('<div class="NoWrap Texte10 EspaceBas">');H.push('<div class="InlineBlock AlignementMilieuVertical">','<input id="',this.idCBSalleAuMoins1,'" type="checkbox" class="AvecMain InlineBlock"></input>','</div>','<label for="'+this.idCBSalleAuMoins1+'" class="AvecMain AlignementMilieuVertical">'+GTraductions.getValeur('CreneauxLibres.AuMoinsUn')+'</label>');H.push('</div>');H.push('<div class="EspaceGauche">');H.push('<label class="EspaceDroit">',GTraductions.getValeur('CreneauxLibres.Capacite'),'</label>');H.push('<input ie-model="capacite" ie-event="blur->eventBlur" ie-mask="/[^0-9]/i" class="Gras EspaceInput Bordure Texte10" maxLength="3" ','style="',GStyle.composeCouleurBordure(this._parametres.couleur.bordure),GStyle.composeWidth(50),GStyle.composeHeight(17),'"/>');H.push('</div>');H.push('</div>');}
H.push('</div>');return H.join('');}
function _construireListeGenreRessource(aDescripteurRessource){var H=[];var lNbLignes=aDescripteurRessource.liste.GetNbrElements(),lILigne,lRessource,lRessourceDiagnostic,lAvecEdition=!this._parametres.nonEditable&&aDescripteurRessource.avecEdition;H.push('<div style="',lNbLignes>aDescripteurRessource.nbLignesMax?GStyle.composeHeight(this._parametres.hauteurLigneContenu*aDescripteurRessource.nbLignesMax):'',GStyle.composeCouleurFond(this._parametres.couleurFondListe),'"',lNbLignes>aDescripteurRessource.nbLignesMax?' class="Texte10 '+this.classCssScroll+'"':'','>');aDescripteurRessource.liste.trier();for(lILigne=0;lILigne<lNbLignes;lILigne++){lRessource=aDescripteurRessource.liste.GetElement(lILigne);lRessourceDiagnostic=null;if(this._parametres.avecDiagnostic&&this._parametres.diagnostic){if(lRessource.GetGenre()===EGenreRessource.PartieDeClasse){var lDiagnostic=new TypeEnsembleNombre();if(lRessource.listeParties)
for(var i=0;i<lRessource.listeParties.GetNbrElements();i++){var lPartie=lRessource.listeParties.GetElement(i);var lRessourceDiagnosticPartie=this._parametres.diagnostic.GetElementParNumeroEtGenre(lPartie.GetNumero(),EGenreRessource.PartieDeClasse);if(lRessourceDiagnosticPartie&&lRessourceDiagnosticPartie.diag)
lDiagnostic.add(lRessourceDiagnosticPartie.diag);}
if(lDiagnostic.count()>0)
lRessourceDiagnostic={diag:lDiagnostic};}
else lRessourceDiagnostic=this._parametres.diagnostic.GetElementParNumeroEtGenre(lRessource.GetNumero(),aDescripteurRessource.genre);}
H.push('<div id="',this.idLigneRessource+aDescripteurRessource.genre+'_'+lILigne+'" ','class="NoWrap ',lAvecEdition?'AvecMain '+this.cssEventLigneRessource:'','" ','" tabIndex="-1">');H.push(_construireRessource.bind(this)(lRessource,lRessourceDiagnostic,aDescripteurRessource));if(this._parametres.avecDiagnostic)
H.push(_construireDiagnosticDeRessource.bind(this)(lRessource,lRessourceDiagnostic,aDescripteurRessource.genre===EGenreRessource.Matiere?this._parametres.diagnosticPlace:null));H.push('</div>');}
H.push('</div>');return H.join('');}
function _construireRessource(aRessource,aDiagnosticRessource,aDescripteurRessource){var H=[];var lLargeurRessource=this._parametres.largeur+(this._parametres.avecDiagnostic?-this._parametres.largeurColDiagno-1:0),lLargeurLibelle=lLargeurRessource,lDiag=aDiagnosticRessource?aDiagnosticRessource.diag:null,lDiagComposantes=aDiagnosticRessource?aDiagnosticRessource.diagComposantes:null,lDiagnosticOccupe=lDiag&&(lDiag.contains(EGenreDiagnostic.DiagOccupe)||lDiag.contains(EGenreDiagnostic.DiagOccupeVerrouilleDure)),lDiagnosticOccupeComposantes=lDiagComposantes&&(lDiagComposantes.contains(EGenreDiagnostic.DiagOccupe)||lDiagComposantes.contains(EGenreDiagnostic.DiagOccupeVerrouilleDure)),lDiagnosticOccupeConseil=lDiag&&lDiag.contains(EGenreDiagnostic.DiagPresenceConseil),lChaineRessource=aRessource.GetLibelle(),lAvecCarreCouleur=aDescripteurRessource.couleurCarre&&aDescripteurRessource.couleurCarre(aRessource);if(lAvecCarreCouleur)
lLargeurLibelle=lLargeurRessource-aDescripteurRessource.tailleCarreCouleur-2;var lChaineTronquee=GChaine.GetChaine(lChaineRessource,10,true,lLargeurLibelle-4),lTitle=lDiagnosticOccupe?GChaine.Format(GTraductions.getValeur('diagnostic.RessourceOccupe'),[aRessource.GetLibelle()]):lDiagnosticOccupeConseil?GChaine.Format(GTraductions.getValeur('diagnostic.RessourceOccupeConseil'),[aRessource.GetLibelle()]):lDiagnosticOccupeComposantes?GChaine.Format(GTraductions.getValeur('diagnostic.ElevesOccupes'),[aRessource.GetLibelle()]):'';H.push('<div class="InlineBlock AlignementMilieuVertical" style="',GStyle.composeHeight(this._parametres.hauteurLigneContenu),GStyle.composeWidth(lLargeurRessource),this._parametres.avecDiagnostic?GStyle.composeCouleurBordure(this._parametres.couleur.bordure,1,EGenreBordure.droite):'','">');H.push('<div class="AlignementMilieuVertical" style="padding:1px 2px; line-height:',this._parametres.hauteurLigneContenu-2 ,'px;','">');if(lAvecCarreCouleur)
H.push('<div style="',GStyle.composeCouleurFond(aDescripteurRessource.couleurCarre(aRessource)),GStyle.composeWidth(aDescripteurRessource.tailleCarreCouleur),GStyle.composeHeight(aDescripteurRessource.tailleCarreCouleur),'margin-right:3px','" class="InlineBlock"></div>');H.push('<span style="',lDiagnosticOccupe||lDiagnosticOccupeConseil||lDiagnosticOccupeComposantes?GStyle.composeCouleurTexte(GCouleur.diagnostic.occupation):'','" ',(lChaineRessource!==lChaineTronquee?' title="'+GChaine.toTitle(lChaineRessource)+'"':''),'class="Gras" ',lTitle?'title="'+GChaine.toTitle(lTitle)+'"':'','>');H.push(lChaineTronquee);H.push('</span>');H.push('</div>');H.push('</div>');return H.join('');}
function _construireDiagnosticDeRessource(aRessource,aDiagnosticRessource,aDiagnosticPlace){var H=[];H.push('<div class="InlineBlock AlignementMilieuVertical" style="',GStyle.composeHeight(this._parametres.hauteurLigneContenu),GStyle.composeWidth(this._parametres.largeurColDiagno),'">');H.push('<div class="InlineBlock" style="padding: 2px;line-height : ',this._parametres.hauteurLigneContenu-4,'px;">');if(aDiagnosticPlace){if(aDiagnosticPlace.contains(EGenreDiagnostic.DiagJourFerie)){H.push(_construireDiagnosticJourFerie.bind(this)(aRessource));H.push('<div class="InlineBlock AlignementMilieuVertical" style="',GStyle.composeWidth(this._parametres.ecartDiagnostics),'"></div>');}}
var lDiagnostic=aDiagnosticRessource&&aDiagnosticRessource.diag;if(aDiagnosticRessource&&aDiagnosticRessource.diagComposantes){if(lDiagnostic)
lDiagnostic.add(aDiagnosticRessource.diagComposantes);else lDiagnostic=aDiagnosticRessource.diagComposantes;}
if(lDiagnostic){if(lDiagnostic.contains(EGenreDiagnostic.DiagIndisponibiliteDureRessource)){H.push(_construireDiagnosticIndispoDure.bind(this)(aRessource));H.push('<div class="InlineBlock AlignementMilieuVertical" style="',GStyle.composeWidth(this._parametres.ecartDiagnostics),'"></div>');}
if(lDiagnostic.contains(EGenreDiagnostic.DiagAbsenceRessource)){H.push(_construireDiagnosticAbsenceRessource.bind(this)(aRessource));H.push('<div class="InlineBlock AlignementMilieuVertical" style="',GStyle.composeWidth(this._parametres.ecartDiagnostics),'"></div>');}
var lDiagnosticsDP=new TypeEnsembleNombre().add(lDiagnostic).intersect(TUtilGenreDiagnostic.getDiagnosticsDP());if(lDiagnosticsDP.count()>0){H.push(_construireDiagnosticDP.bind(this)(aRessource,lDiagnosticsDP));H.push('<div class="InlineBlock AlignementMilieuVertical" style="',GStyle.composeWidth(this._parametres.ecartDiagnostics),'"></div>');}
var lDiagnosticsSite=new TypeEnsembleNombre().add(lDiagnostic).intersect(TUtilGenreDiagnostic.getDiagnosticsSite());if(lDiagnosticsSite.count()>0){H.push(_construireDiagnosticSite.bind(this)(aRessource,lDiagnosticsSite));H.push('<div class="InlineBlock AlignementMilieuVertical" style="',GStyle.composeWidth(this._parametres.ecartDiagnostics),'"></div>');}
if(lDiagnostic.contains(EGenreDiagnostic.DiagIndisponibiliteEtablissement)){H.push(_construireDiagnosticIndispoEtab.bind(this)(aRessource));H.push('<div class="InlineBlock AlignementMilieuVertical" style="',GStyle.composeWidth(this._parametres.ecartDiagnostics),'"></div>');}
if(lDiagnostic.contains(EGenreDiagnostic.DiagChangementSemaineGAEV)){H.push(_construireDiagnosticGAEV.bind(this)(aRessource));H.push('<div class="InlineBlock AlignementMilieuVertical" style="',GStyle.composeWidth(this._parametres.ecartDiagnostics),'"></div>');}}
H.push('</div>');H.push('</div>');return H.join('');}
function _construireDiagnosticJourFerie(aRessource){var lTitle=GTraductions.getValeur('diagnostic.JourFerie'),H=[];H.push('<div class="InlineBlock AlignementMilieuVertical Texte9 Gras" ','style="',GStyle.composeWidth(this._parametres.largeurDiagnosticImage),GStyle.composeHeight(this._parametres.hauteurLigneContenu-4),'" ','title="',GChaine.toTitle(lTitle),'">',GTraductions.getValeur('diagnostic.JourFerie_Abrev'),'</div>');return H.join('');}
function _construireDiagnosticIndispoDure(aRessource){var lTitle=GChaine.Format(GTraductions.getValeur('diagnostic.RessourceIndisponible'),[aRessource.GetLibelle()]),H=[];H.push('<div class="InlineBlock AlignementMilieuVertical" ','style="',GStyle.composeWidth(this._parametres.largeurDiagnosticImage),GStyle.composeHeight(this._parametres.hauteurLigneContenu-4),GStyle.composeCouleurFond(GCouleur.diagnostic.indisponibilite),'" ','title="',GChaine.toTitle(lTitle),'">','</div>');return H.join('');}
function _construireDiagnosticAbsenceRessource(aRessource){var H=[],lTitle=GTraductions.getValeur('diagnostic.RessourceAbsente');H.push('<div class="InlineBlock AlignementMilieuVertical AlignementMilieu Texte9 Gras" ','style="',GStyle.composeWidth(this._parametres.largeurDiagnosticImage),GStyle.composeHeight(this._parametres.hauteurLigneContenu-4),GStyle.composeCouleurFond(GCouleur.diagnostic.absenceRessource),GStyle.composeCouleurTexte(GCouleur.blanc),'" ','title="',GChaine.toTitle(lTitle),'">',GTraductions.getValeur('diagnostic.AbsenceRessource_Abrev'),'</div>');return H.join('');}
function _construireDiagnosticDP(aRessource,aDiagnostics){var H=[],lTitle=GTraductions.getValeur('diagnostic.AucunServiceDemiPension');H.push('<div class="InlineBlock AlignementMilieuVertical AlignementMilieu Texte9 Gras" ','style="',GStyle.composeWidth(this._parametres.largeurDiagnosticImage),GStyle.composeHeight(this._parametres.hauteurLigneContenu-4),GStyle.composeCouleurFond(GCouleur.diagnostic.demiPension),GStyle.composeCouleurTexte(GCouleur.blanc),'" ','title="',GChaine.toTitle(lTitle),'">',GTraductions.getValeur('diagnostic.DemiPension_Abrev'),'</div>');return H.join('');}
function _construireDiagnosticGAEV(aRessource,aDiagnostics){var H=[],lTitle=GTraductions.getValeur('diagnostic.ChangementSemaineGAEV');H.push('<div class="InlineBlock AlignementMilieuVertical AlignementMilieu Texte9 Gras" ','style="',GStyle.composeWidth(this._parametres.largeurDiagnosticImage),GStyle.composeHeight(this._parametres.hauteurLigneContenu-4),GStyle.composeCouleurFond(GCouleur.diagnostic.gaev),GStyle.composeCouleurTexte(GCouleur.blanc),'" ','title="',GChaine.toTitle(lTitle),'">',GTraductions.getValeur('diagnostic.GAEV_Abrev'),'</div>');return H.join('');}
function _construireDiagnosticSite(aRessource,aDiagnostics){var H=[],lTitle=[];if(aDiagnostics.contains(EGenreDiagnostic.DiagSitesIncompatiblesHeureTransition))
lTitle.push(GTraductions.getValeur('diagnostic.SitesIncompatiblesHeureTransition'));if(aDiagnostics.contains(EGenreDiagnostic.DiagSitesIncompatiblesDureeTrajet))
lTitle.push(GTraductions.getValeur('diagnostic.SitesIncompatiblesDureeTrajet'));if(aDiagnostics.contains(EGenreDiagnostic.DiagSitesIncompatiblesNbTransitionsHebdo))
lTitle.push(GTraductions.getValeur('diagnostic.SitesIncompatiblesNbTransitionsHebdo'));if(aDiagnostics.contains(EGenreDiagnostic.DiagSitesIncompatiblesNbTransitionsJour))
lTitle.push(GTraductions.getValeur('diagnostic.SitesIncompatiblesNbTransitionsJour'));H.push('<div class="InlineBlock AlignementMilieuVertical AlignementMilieu Texte9 Gras" ','style="',GStyle.composeWidth(9),GStyle.composeHeight(this._parametres.hauteurLigneContenu-4),GStyle.composeCouleurFond(GCouleur.diagnostic.site),GStyle.composeCouleurTexte(GCouleur.blanc),'" ','title="',GChaine.toTitle(lTitle.join('\n')),'">',GTraductions.getValeur('diagnostic.Site_Abrev'),'</div>');return H.join('');}
function _construireDiagnosticIndispoEtab(aRessource){var H=[],lTitle=GTraductions.getValeur('diagnostic.DJNonTravaille');H.push('<div class="InlineBlock AlignementMilieuVertical AlignementMilieu Texte9 Gras Image_Diagnostic_IndispoEtab" ','style="',GStyle.composeWidth(13),GStyle.composeHeight(this._parametres.hauteurLigneContenu-4),GStyle.composeCouleurFond(GCouleur.noir),GStyle.composeCouleurTexte(GCouleur.blanc),'" ','title="',GChaine.toTitle(lTitle),'">',GTraductions.getValeur('diagnostic.IndispoEtab_Abrev'),'</div>');return H.join('');}
function _surMouseUpLigneTitreRessource(event){var lTab=this.id.split('_'),lGenreRessource=parseInt(lTab[lTab.length-1],10),lInstance=event.data.instance;if(GNavigateur.BoutonSouris===EGenreBoutonSouris.Gauche)
if(lInstance._parametres.callbackAjoutRessource)
lInstance._parametres.callbackAjoutRessource(lGenreRessource);}
function _invocateur_DeselectionRessource(){if(this._donnees&&this._donnees.selection)
GHtml.delClass(this._donnees.selection.id,'Selection');}
function _surMouseDownRessource(event){var lInstance=event.data.instance,lInfosRessource=_getInfosIdRessource(this.id,lInstance);Invocateur.evenement('selectionRessourceCours_DeselectionRessource');lInstance._donnees.selection={id:this.id,genre:lInfosRessource.genre,indice:lInfosRessource.indice};var lDescripteurRessource=lInstance._parametres.ressources[lInfosRessource.genre];GHtml.addClass(this.id,'Selection');if(lInfosRessource.ressource)
if(!lDescripteurRessource.fonctionNonEditable||!lDescripteurRessource.fonctionNonEditable(lInfosRessource.ressource))
new IEClasses.Fantome({id:$('#'+lInstance.GetNom().escapeJQ()+' :first').get(0),libelle:lInfosRessource.ressource.GetLibelle(),callbackFin:_surSuppressionFantome.bind(lInstance,lInfosRessource),positionX:event.pageX,positionY:event.pageY});}
function _surMouseUpRessource(event){var lInfosRessource=_getInfosIdRessource(this.id,event.data.instance),lInstance=event.data.instance;_gererMouseUpRessource.bind(lInstance)(this,lInfosRessource);}
function _surSuppressionFantome(aInfosRessource,aDansId){if(!aDansId){if(this._parametres.callbackSuppressionRessource)
this._parametres.callbackSuppressionRessource(aInfosRessource.genre,aInfosRessource.indice);}}
function _gererMouseUpRessource(aElement,aInfosRessource){if(GNavigateur.BoutonSouris===EGenreBoutonSouris.Droite){var lDescripteurRessource=this._parametres.ressources[aInfosRessource.genre],lNonEditable=lDescripteurRessource.fonctionNonEditable&&lDescripteurRessource.fonctionNonEditable(aInfosRessource.ressource);var lMenuContextuel=this.GetInstance(this.identMenuContextuel);lMenuContextuel.vider();lMenuContextuel.AddCommande(InterfaceSelectionRessourceCours.genreMenuContextuel.supprimer,GTraductions.getValeur('liste.supprimer'),!lNonEditable);lMenuContextuel.Afficher();}
else{if(this._parametres.callbackAjoutRessource)
this._parametres.callbackAjoutRessource(aInfosRessource.genre,aInfosRessource.ressource);}}
function _getInfosIdRessource(aId,aInstance){var lTab=aId.split('_'),lGenre=parseInt(lTab[lTab.length-2],10),lIndice=parseInt(lTab[lTab.length-1],10);var lRessource=aInstance._parametres.ressources[lGenre].liste.GetElement(lIndice);return{genre:lGenre,indice:lIndice,ressource:lRessource};}
function _evenementSurMenuContextuel(aLigne,aElement){switch(aLigne.Numero){case InterfaceSelectionRessourceCours.genreMenuContextuel.supprimer:if(this._parametres.callbackSuppressionRessource)
this._parametres.callbackSuppressionRessource(this._donnees.selection.genre,this._donnees.selection.indice);}}
function _surCBSalle(event){var lInstance=event.data.instance;if(lInstance._parametres.infosFiltreSalle.callbackCBSalle)
lInstance._parametres.infosFiltreSalle.callbackCBSalle($(this).inputChecked());}})();;
var EGenreStatutCours={Normal:0,ConseilDeClasse:1,Remplacement:2,Historique:3};EGenreStatutCours.getCouleur=function(aCours){if(!aCours) return'';if(!aCours.estAnnule&&(aCours.estPermanence||aCours.GetGenre()===EGenreStatutCours.Remplacement))
return'blue';return'red';};;
MethodesObjet.heritagePrototype(TFicheCours,ObjetFiche);function TFicheCours(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.setOptions_Fiche({avecAbonnementBlocage:true});this._options={hauteurEnTete:65,ecartEntete:15,tailleEnteteSelection:2,ecartEnteteSelection:1,hauteurTitreCours:21,largeurContenu:200,largeurContenuAvecDignostic:230};var lId=window.GUID.getId();this.idEntete=lId+'_entete_';this.idContenu=lId+'_contenu';this.IdPremierElement=this.idContenu;}(function(){TFicheCours.prototype.getControleur=function(){return{btnRemplacementSalle:{event:function(aIndice){var lCours=this.instance._parametres.listeCours.GetElement(aIndice);_surModificationRessourceCours.bind(this.instance)(lCours,EGenreRessource.Salle,lCours.ListeSalles.GetElement(0));},getDisabled:function(aIndice){var lCours=this.instance._parametres.listeCours.GetElement(aIndice);return!lCours.ListeSalles||lCours.ListeSalles.GetNbrElements()!==1;}},btnSuppression:{event:function(aIndice){var lCours=this.instance._parametres.listeCours.GetElement(aIndice);if(this.instance._parametres.callbackSuppressionCours){this.instance._parametres.callbackSuppressionCours(lCours,lCours.numeroSemaine);}}},btnCDT:{event:function(aIndice){var lCours=this.instance._parametres.listeCours.GetElement(aIndice);if(lCours&&this.instance._parametres.callbackCDT){this.instance._parametres.callbackCDT(lCours,lCours.numeroSemaine);}}},btnMemo:{event:function(aIndice){var lCours=this.instance._parametres.listeCours.GetElement(aIndice);if(this.instance._parametres.callBackMemo)
this.instance._parametres.callBackMemo({cours:lCours,numeroSemaine:lCours.numeroSemaine,nonEditable:!_editionMemoPossible.bind(this.instance)(lCours)});}}};};TFicheCours.prototype.setDonnees_FicheCours=function(aParametres){this._parametres={id:'',listeCours:new ObjetListeElements(),coursSelectionne:null,afficherCDT:true,diagnosticPlace:null,numeroSemaine:-1,nonEditable:true,afficherMemo:true,avecEditionMemo:false,callbackSuppressionCours:null,callbackSuppressionRessource:null,callbackModificationRessource:null,callBackMemo:null,callbackCDT:null,callbackEntete:null,avecDiagnosticRessource:false,listeCoursDiagnostic:null};$.extend(this._parametres,aParametres);_afficher.bind(this)();};TFicheCours.prototype.apresAfficher=function(){this.inherited('apresAfficher');$('[id^="'+this.idEntete+'"]').on('focusin',function(){$(this).css('box-shadow','0 0 5px -1px '+GCouleur.noir);}).on('focusout',function(){$(this).css('box-shadow','none');});};TFicheCours.prototype.actualiser_FicheCours=function(aParametres){_detruireInstances.bind(this)();$.extend(this._parametres,aParametres);_afficher.bind(this)();};TFicheCours.prototype.actualiser=function(aParametres){this.actualiser_FicheCours(aParametres);};function _afficher(){this._parametres.listeCours.setTri([ObjetTri.init(function(D){return!D.estAnnule;}),ObjetTri.init('numeroSemaine'),ObjetTri.init('place'),ObjetTri.init('duree')]);this._parametres.listeCours.trier();this.afficherFiche({id:this._parametres.id});_initialiserEvents.bind(this)();}
function _detruireInstances(){this.DetruireInstancesFils();this.selec=[];}
TFicheCours.prototype.Fermer=function(ASurInteractionUtilisateur){this.inherited('Fermer',ASurInteractionUtilisateur);_detruireInstances.bind(this)();};TFicheCours.prototype.Compose=function(){this.selec=[];var H=[],I;H.push('<span class="wai_hidden" tabindex="0" onfocus="'+this.Nom+'.FocusSurPremierElement();"></span>');H.push('<div id="'+this.idContenu+'" tabindex="-1" class="Fenetre_Bordure NoWrap" ',GObjetWAI.composeRole(EGenreRole.Dialog),' ',GObjetWAI.composeAttribut({genre:EGenreAttribut.label,valeur:GTraductions.getValeur('WAI.FicheCours')[0]}),' style="'+GStyle.composeCouleurFond(GCouleur.fenetre.fond)+GStyle.composeBoxShadow(),GStyle.composeHeight(this._options.hauteurEnTete),'">');var lNombre=this._parametres.listeCours.GetNbrElements();if(lNombre>1) H.push('<div class="NoWrap" ',GObjetWAI.composeRole(EGenreRole.List),'>');H.push('<div class="InlineBlock AlignementHaut" style="',GStyle.composeWidth(this._options.ecartEntete),'"></div>');for(I=0;I<lNombre;I++){H.push(_composeCours.bind(this)(I));if(lNombre>1&&I===0){H.push('<div class="InlineBlock AlignementHaut" style="',GStyle.composeWidth(this._options.ecartEntete),'"></div>');}}
H.push('<div class="InlineBlock AlignementHaut" style="',GStyle.composeWidth(this._options.ecartEntete),'">');H.push('<div class="PetitEspaceHaut PetitEspaceDroit AlignementDroit">');H.push('<div class="AlignementHaut AvecMain Image_CroixFermeture" tabindex="0" width="1px" onkeyup="if (GNavigateur.IsToucheSelection ()) '+this.Nom+'.Fermer()" onclick="'+this.Nom+'.Fermer()" ',GObjetWAI.composeRole(EGenreRole.Button),' ',GObjetWAI.composeAttribut({genre:EGenreAttribut.label,valeur:GTraductions.getValeur('WAI.FermerFiche')}),'>','<div class="Texte10" style="width: 11px;">&nbsp;</div>','</div>');H.push('</div>');H.push('</div>');H.push('</div>');if(lNombre>1){H.push('</div>');}
H.push('<span class="wai_hidden" tabindex="0"  onfocus="'+this.Nom+'.FocusSurPremierElement();"></span>');return H.join('');};function _composeCours(aIndice){var lCours=this._parametres.listeCours.GetElement(aIndice);var H=[];H.push('<div ',GObjetWAI.composeRole(EGenreRole.Listitem),' id="',this.idContenu,'_',aIndice,'" tabindex="0" class="InlineBlock AlignementHaut Texte10">');H.push('<div style="',GStyle.composeHeight(this._options.hauteurTitreCours),'">');H.push('<div class="PetitEspace">');H.push(_composeBoutonsTitre.bind(this)(lCours,aIndice));H.push('</div>');H.push('</div>');H.push('<div class="EspaceGauche EspaceDroit">');H.push(_construireBlocEntete.bind(this)(lCours,aIndice));H.push('</div>','</div>');var lBordures=EGenreBordure.bas;if(aIndice<2){lBordures+=EGenreBordure.gauche;}
if(aIndice===0||aIndice===this._parametres.listeCours.GetNbrElements()-1){lBordures+=EGenreBordure.droite;}
H.push('<div class="Espace" style="',GStyle.composeCouleurFond(GCouleur.fenetre.fond),GStyle.composeCouleurBordure(GCouleur.fenetre.bordure,1,lBordures),GStyle.composeBoxShadow(),'">');this.selec[aIndice]=new InterfaceSelectionRessourceCours(this.GetNom()+'.selec['+aIndice+']',null,this);H.push('<div id="'+this.selec[aIndice].GetNom()+'"></div>');if(_modificationSallePossible.bind(this)(lCours)){H.push('<div class="EspaceHaut">','<ie-bouton ie-model="btnRemplacementSalle(',aIndice,')" style="',GStyle.composeWidth(_getLargeurContenu.bind(this)(lCours)),'">',GTraductions.getValeur('SaisieCours.RemplacerSalle'),'</ie-bouton>','</div>');}
if(!this._parametres.nonEditable&&(lCours.supprimable||lCours.modifAnnulable)&&!GParametres.domaineVerrou.GetValeur(lCours.numeroSemaine)&&GApplication.droits.get(IEEnum.droits.cours.estSemaineModifiable,lCours.numeroSemaine)){H.push('<div class="EspaceHaut">','<ie-bouton ie-model="btnSuppression(',aIndice,')" style="',GStyle.composeWidth(_getLargeurContenu.bind(this)(lCours)),'">',lCours.supprimable?GTraductions.getValeur('SaisieCours.SupprimerCours'):GTraductions.getValeur('SaisieCours.AnnulerModificationCours'),'</ie-bouton>','</div>');}
H.push('</div>');H.push('</div>');return H.join('');}
function _auMoinsUnAutreCoursEnteteCliquable(aCours){if(this._parametres.listeCours.GetNbrElements()>1){var lResult=false,lNumeroSemaine=this._parametres.numeroSemaine;this._parametres.listeCours.parcourir(function(D){if(D!==aCours&&D.numeroSemaine===lNumeroSemaine&&D.ressourcePresente){lResult=true;return false;}});return lResult;}
return false;}
function _construireBlocEntete(aCours,aIndiceCours){var lAfficherBlocSelection=this._parametres.listeCours.GetNbrElements()>1&&_estCoursSelectionne.bind(this)(aCours);var H=[];if(lAfficherBlocSelection){H.push('<div style="',GStyle.composeCouleurFond(GCouleur.ficheCours.coursSelectionne)+'padding:',this._options.tailleEnteteSelection+'px;">');H.push('<div style="',GStyle.composeCouleurFond(GCouleur.fenetre.fond)+'padding:',this._options.ecartEnteteSelection+'px;">');}
else{H.push('<div style="padding:',(this._options.tailleEnteteSelection+this._options.ecartEnteteSelection),'px;">');}
var lAvecClickEntete=this._parametres.callbackEntete&&aCours.numeroSemaine===this._parametres.numeroSemaine&&aCours.ressourcePresente&&(_auMoinsUnAutreCoursEnteteCliquable.bind(this)(aCours)||(GApplication.droits.get(IEEnum.droits.cours.deplacerCours)&&_modificationCoursPossible.bind(this)(aCours))) ;H.push('<div ',lAvecClickEntete?'id="'+this.idEntete+aIndiceCours+'" ':'',lAvecClickEntete?'tabindex="0" ':'','style="',GStyle.composeCouleurFond(GCouleur.grisFonce),GStyle.composeHeight(this._options.hauteurEnTete-this._options.hauteurTitreCours-(2*this._options.tailleEnteteSelection+2*this._options.ecartEnteteSelection)),GStyle.composeWidth(_getLargeurContenu.bind(this)(aCours)-(2*this._options.tailleEnteteSelection+2*this._options.ecartEnteteSelection)+4),'position:relative;" ',lAvecClickEntete?'class="AvecMain"':'','>');H.push('<div class="PetitEspace">');H.push('<div style="margin: 0 2px 0 2px;">',_getTitre.bind(this)(aCours),'</div>');H.push('<div style="position:relative;">');if(aCours.Statut){var lMarginRight=2;if(aCours.estGAEV){lMarginRight+=16 ;}
if(aCours.estCoEnseignement){lMarginRight+=17 ;}
if(aCours.estGAEV&&aCours.estCoEnseignement){lMarginRight+=2;}
H.push('<div class="FondBlanc" style="overflow:hidden; margin: 2px ',lMarginRight,'px 0 2px;">','<span class="PetitEspaceGauche PetitEspaceDroit NoWrap Gras" style="',GStyle.composeCouleurTexte(EGenreStatutCours.getCouleur(aCours)),'">',aCours.Statut,'</span>','</div>');}
if(aCours.estGAEV){H.push('<div class="Image_EstGAEV" style="position:absolute; top:0px; right:0px;"></div>');}
if(aCours.estCoEnseignement){var lRight=aCours.estGAEV?16+2:0;H.push('<div class="Image_CoursCoEnseignement" style="position:absolute; top:0px; right:',lRight,'px;"></div>');}
H.push('</div>');H.push('</div>');if(lAfficherBlocSelection){H.push('</div>');H.push('</div>');}
else{H.push('</div>');}
return H.join('');}
function _composeBoutonsTitre(aCours,aIndiceCours){var lAvecEditionMemo=_editionMemoPossible.bind(this)(aCours);var H=[];if(this._parametres.afficherCDT&&aCours.avecCDT){H.push('<div class="PetitEspaceDroit" style="float:right">','<ie-btnImage ie-model="btnCDT(',aIndiceCours,')"',' class="Image_CahierDeTexte6Etats" style="width:19px;"',' title="',GTraductions.getValeur('EDT.AfficherCDT'),'"></ie-btnImage>','</div>');}
if(this._parametres.afficherMemo){if(lAvecEditionMemo||aCours.memo){H.push('<div  style="float:right" class="PetitEspaceDroit">','<ie-btnImage ie-model="btnMemo(',aIndiceCours,')"',' class="',aCours.memo?'Image_PostIt':'Image_PostItVide','"',' style="width:18px;"',' title="',GTraductions.getValeur('EDT.AfficherMemo'),'"></ie-btnImage>','</div>');}}
return H.join('');}
function _initialiserEvents(){var i;$('#'+this.idContenu.escapeJQ()).bind({mousedown:_surMouseDownEntete,keyup:function(event){if(GNavigateur.IsToucheEchap()){event.data.instance.Fermer();}}},{instance:this});var lIdFiche=this.idContenu,lSuMouseDownSelec=function(){$('#'+lIdFiche.escapeJQ()).data('bloquerDeplacement',true);};if(!this._parametres.nonEditable){for(i in this.selec){$('#'+this.selec[i].GetNom().escapeJQ()).bind('mousedown',lSuMouseDownSelec);}}
$('[id^="'+this.idEntete+'"]').on('mouseup keyup',{instance:this},_surClickEntete);}
TFicheCours.prototype.getOptionsDraggable=function(){var lOptions=this.inherited('getOptionsDraggable');var i,lCancel;lCancel='';for(i in this.selec){if(lCancel.length>0){lCancel+=',';}
lCancel+='#'+this.selec[i].GetNom().escapeJQ();}
$.extend(lOptions,{handle:'',cancel:lCancel});return lOptions;};function _surMouseDownEntete(event){event.data.instance.EnPremierPlan();}
function _surClickEntete(event){if((event.type==='mouseup'&&event.which===1)||(event.type==='keyup'&&(event.which===ToucheClavier.RetourChariot||event.which===ToucheClavier.Espace))){var lTab=this.id.split('_'),lIndice=parseInt(lTab[lTab.length-1],10),lInstance=event.data.instance,lCours=lInstance._parametres.listeCours.GetElement(lIndice);if(lInstance._parametres.callbackEntete){lInstance._parametres.callbackEntete(lCours);}}}
function _modificationCoursPossible(aCours){return!this._parametres.nonEditable&&aCours.utilisateurPresent&&aCours.GetGenre()!==EGenreStatutCours.ConseilDeClasse&&!GParametres.domaineVerrou.GetValeur(aCours.numeroSemaine)&&GApplication.droits.get(IEEnum.droits.cours.estSemaineModifiable,aCours.numeroSemaine);}
function _editionMemoPossible(aCours){return _modificationCoursPossible.bind(this)(aCours)&&GApplication.droits.get(IEEnum.droits.cours.modifierMemo);}
function _modificationSallePossible(aCours){return _modificationCoursPossible.bind(this)(aCours)&&(!aCours.estAnnule||this._parametres.listeCours.GetNbrElements()===1)&&GApplication.droits.get(IEEnum.droits.cours.modifierSalles);}
function _initInterfaceSelectionRessources(aIndice,aCours){var
lModificationCoursPossible=_modificationCoursPossible.bind(this)(aCours)&&(!aCours.estAnnule||this._parametres.listeCours.GetNbrElements()===1),lAvecModificationSalle=_modificationSallePossible.bind(this)(aCours),lAvecModificationProf=lModificationCoursPossible&&GApplication.droits.get(IEEnum.droits.cours.modifierProfesseurs),lCoursDiagnostic=null,lDiagnosticRessource=null,lEstCoursSelectionne=_estCoursSelectionne.bind(this)(aCours);if(this._parametres.avecDiagnosticRessource&&this._parametres.listeCoursDiagnostic&&lEstCoursSelectionne){lCoursDiagnostic=this._parametres.listeCoursDiagnostic.GetElementParNumero(aCours.GetNumero());lDiagnosticRessource=lCoursDiagnostic&&lCoursDiagnostic.diagnosticRessource?lCoursDiagnostic.diagnosticRessource:null;}
var lParametres={nonEditable:this._parametres.nonEditable,largeur:_getLargeurContenu.bind(this)(aCours),ordreRessources:[EGenreRessource.Matiere,EGenreRessource.Enseignant,EGenreRessource.Classe,EGenreRessource.Groupe,EGenreRessource.Salle,EGenreRessource.Personnel],ressources:{},avecDiagnostic:this._parametres.avecDiagnosticRessource&&lEstCoursSelectionne,diagnostic:lDiagnosticRessource,diagnosticPlace:this._parametres.diagnosticPlace,couleurFond:GCouleur.fenetre.fond,callbackAjoutRessource:lAvecModificationSalle||lAvecModificationProf?_surModificationRessourceCours.bind(this,aCours):null,callbackSuppressionRessource:lAvecModificationSalle||lAvecModificationProf?_surSuppressionRessourceCours.bind(this,aCours):null};var lListeMatieres=new ObjetListeElements();lListeMatieres.AddElement(aCours.matiere);lParametres.ressources[EGenreRessource.Matiere]={libelle:GTraductions.getValeur('Matiere'),liste:lListeMatieres,couleurCarre:function(aRessource){return aRessource.CouleurFond;},avecAjout:false,avecEdition:false};if(lAvecModificationProf&&GEtatUtilisateur.GenreEspace===EGenreEspace.Professeur){var lProfesseurCourant=aCours.ListeProfesseurs.GetElementParNumero(GEtatUtilisateur.getRessource().GetNumero());if(lProfesseurCourant){lProfesseurCourant.nonEditable=true;}}
lParametres.ressources[EGenreRessource.Enseignant]={libelle:GTraductions.getValeur('Professeurs'),liste:aCours.ListeProfesseurs,avecAjout:!!lAvecModificationProf,avecEdition:!!lAvecModificationProf};lParametres.ressources[EGenreRessource.Classe]={libelle:GTraductions.getValeur('Classes'),liste:aCours.ListeClasses,avecAjout:false,avecEdition:false};var lListeGroupes=InterfaceSelectionRessourceCours.construireListeGroupesParties(aCours.ListeGroupes,aCours.ListeParties);lParametres.ressources[EGenreRessource.Groupe]={libelle:GTraductions.getValeur('Groupes'),liste:lListeGroupes ,avecAjout:false,avecEdition:false};aCours.ListeSalles.parcourir(function(D){if(D.nombre>1){if(!D.LibelleOrigine){D.LibelleOrigine=D.GetLibelle();}
D.Libelle=GChaine.Format('%s (x%s)',[D.LibelleOrigine,D.nombre]);}});lParametres.ressources[EGenreRessource.Salle]={libelle:GTraductions.getValeur('Salles'),liste:aCours.ListeSalles,avecAjout:!!lAvecModificationSalle,avecEdition:!!lAvecModificationSalle};lParametres.ressources[EGenreRessource.Personnel]={libelle:GTraductions.getValeur('Personnels'),liste:aCours.ListePersonnels,avecAjout:false,avecEdition:false};this.selec[aIndice].setDonnees_SelectionRessourceCours(lParametres);}
function _estCoursSelectionne(aCours){return this._parametres.coursSelectionne&&this._parametres.coursSelectionne.GetNumero()===aCours.GetNumero();}
function _getLargeurContenu(aCours){return this._parametres.avecDiagnosticRessource&&_estCoursSelectionne.bind(this)(aCours)?this._options.largeurContenuAvecDignostic:this._options.largeurContenu;}
function _surModificationRessourceCours(aCours ,aGenre,aRessource){if(aRessource&&aRessource.nonEditable){return;}
var lRessourceRemplacee=aRessource?new ObjetElement('',aRessource.GetNumero(),aGenre):undefined;if(this._parametres.callbackModificationRessource){this._parametres.callbackModificationRessource({cours:aCours,numeroSemaine:aCours.numeroSemaine,genreRessource:aGenre,ressourceRemplacee:lRessourceRemplacee});}}
function _surSuppressionRessourceCours(aCours,aGenre,aIndice){var lListeRessourcesOrigine;switch(aGenre){case EGenreRessource.Salle:lListeRessourcesOrigine=aCours.ListeSalles;break;case EGenreRessource.Enseignant:lListeRessourcesOrigine=aCours.ListeProfesseurs;break;default:;return;}
var lRessourceRemplacee=lListeRessourcesOrigine.GetElement(aIndice);if(this._parametres.callbackSuppressionRessource){this._parametres.callbackSuppressionRessource({cours:aCours,numeroSemaine:aCours.numeroSemaine,genreRessource:aGenre,listeRessources:new ObjetListeElements(),ressourceRemplacee:new ObjetElement(lRessourceRemplacee.GetLibelle(),lRessourceRemplacee.GetNumero(),aGenre)});}}
function _getTitre(ACours){return GChaine.Insecable(GDate.FormatDate(ACours.DateCours,'%JJ/%MM')+' '+GTraductions.getValeur('De')+' '+ACours.HeureDebut+' '+GTraductions.getValeur('A')+' '+ACours.HeureFin);}
TFicheCours.prototype.surPreAffichage=function(){var i;for(i=0;i<this._parametres.listeCours.GetNbrElements();i++){this.selec[i].Initialiser();_initInterfaceSelectionRessources.bind(this)(i,this._parametres.listeCours.GetElement(i));}
var lHauteur=0;for(i in this.selec){lHauteur=Math.max(lHauteur,$('#'+this.selec[i].GetNom().escapeJQ()).parent().height());}
for(i in this.selec){$('#'+this.selec[i].GetNom().escapeJQ()).parent().height(lHauteur);}
lHauteur=0;$('#'+this.idContenu.escapeJQ()+' > div').each(function(){lHauteur=Math.max(lHauteur,$(this).outerHeight());});$('#'+this.GetNom().escapeJQ()).height(lHauteur+5);};}());;
var EGenreAffichageGrilleDate={SansDate:0,AvecDate:1,AvecDateEtJour:2,AvecFrequence:3};MethodesObjet.heritagePrototype(_ObjetGrille,Identite);function _ObjetGrille(ANom,AIdent,APere,AEvenement){this.inheritedCreate(ANom,AIdent,APere,AEvenement);this.idReference=window.GUID.getId();this.classReference=window.GUID.getClassCss();this.idLigneTitre=this.idReference+'_titre';this.idLigneTitreG=this.idReference+'_titreG';this.idLigneTitreG_Haut=this.idReference+'_titreGH';this.idLigneTitreG_Bas=this.idReference+'_titreGB';this.idLignePied=this.idReference+'_pied';this.idConteneurGrille=this.idReference+'_c_g';this.idConteneurAbsGrille=this.idReference+'_ca';this.idConteneurGrilleInterne=this.idReference+'_c_gi';this.IdCellulePrefixe=this.idReference+'_Grille_';this.idColonne=this.idReference+'_col_';this.idNavigation=this.idReference+'_Navigation';this.classCelluleAvecMouseDown=this.classReference+'_c';this._cache={scrollHVisible:true};this._initialiserOptions();}(function(){_ObjetGrille.separateurLigne={vide:3,petit:2,moyen:1,plein:0};var EZoneScroll={TitreHaut:0,TitreLignes:1,Grille:2};_ObjetGrille.prototype._initialiserOptions=function(){this._options={hauteurMINPasHoraire:10,hauteurMAXPasHoraire:0,genreAffichageDate:EGenreAffichageGrilleDate.AvecDateEtJour,afficherPasHoraire:false,avecZoom:false,colonnesVisibles:new TypeEnsembleNombre(),hauteurPasHoraire:-1,hauteurPoliceMin:12,largeurHoraireGauche:40,largeurMaxCellule:null,largeurMinCellule:60,hauteurLigneTitre:20,couleurFond:GCouleur.grille.fond,couleurBordures:GCouleur.grille.bordure,couleurLibellesLignes:GCouleur.grille.texte,couleurLibellesColonnes:GCouleur.grille.texte,nombreLignes:0,pasHoraire:0,titresLignesParSequence:false,hauteurHeure:96,avecMouseDownCellule:false,callbackMouseDownCellule:null,scrollHorizontaleParPas:false,actualiserTitresLignes:true,avecShadowFocus:true};};_ObjetGrille.prototype.getControleur=function(){return{surEventGrille:function(aEvent){},getClassGrille:function(){return'NoWrap';},surMouseDownGrilleCellule:function(aEvent,aElement){if(this.instance._options.avecMouseDownCellule||this.instance._options.callbackMouseDownCellule){var lDataCellule=$(aElement).IEData();this.instance.surMouseDownGrilleCellule(lDataCellule.placeGrille,aElement,aEvent);}},surMouseUpGrilleCellule:function(){},getTitleCellule:function(){return'';},getTitleElement:function(I){var LCours=this.instance.ListeCours.GetElement(I),lTitle=[];if(LCours&&LCours.existeContenuMasque){var LContenu,N=LCours.ListeContenus.GetNbrElements();for(var J=0;J<N;J++){var LContenu=LCours.ListeContenus.GetElement(J);if(LContenu.GetLibelle().length&&(LContenu.Visible!==false)&&(LContenu.GetGenre()!==EGenreRessource.Service)){lTitle.push(LContenu.GetLibelle());}}}
return lTitle.join('<br/>');}};};_ObjetGrille.prototype.RecupererDonnees=function(){this.ScrollH=Identite.creerInstance(ObjetScroll,{pere:this,evenement:_evenementScrollH.bind(this),genre:EGenreScroll.Horizontal});this.ScrollV=Identite.creerInstance(ObjetScroll,{pere:this,evenement:_evenementScrollV.bind(this),genre:EGenreScroll.Vertical});this.ScrollH.Largeur=GNavigateur.GetLargeurBarreDeScroll();this.ScrollV.Largeur=GNavigateur.GetLargeurBarreDeScroll();if(this.avecEventResizeNavigateur()){this.ajouterEvenementGlobal(EEvent.SurPreResize,this.SurPreResize);this.ajouterEvenementGlobal(EEvent.SurPostResize,this.SurPostResize);}};_ObjetGrille.prototype.ConstruireAffichage=function(){if(!this.donneesRecus){return;}
this.EnAffichage=true;this.CalculerDebutEtFin();var lScrollY=GPosition.getScrollTop(this.ScrollV.GetIdZone(EZoneScroll.Grille));this.ScrollH.Vider();this.ScrollV.Vider();$('#'+this.Nom.escapeJQ()).IEHtml(_construireGrille.bind(this)(),{controleur:this.controleur});this.ScrollV.SetDonnees(EZoneScroll.TitreLignes,EZoneScroll.Grille);this.ScrollH.SetDonnees(EZoneScroll.TitreHaut,EZoneScroll.Grille);this.apresConstructionGrille();if(lScrollY>0){this.ScrollV.scrollTo(lScrollY);}};_ObjetGrille.prototype.effacer=function(aMessage){this.inherited('effacer',aMessage);this.EnAffichage=false;};_ObjetGrille.prototype.setOptions=function(aOptions){$.extend(this._options,aOptions);this.apresInitialisationOptions();};_ObjetGrille.prototype.apresInitialisationOptions=function(){this.EstAffiche=false;this.EnAffichage=false;if(this._options.titresLignesParSequence){this._options.actualiserTitresLignes=false;var lPlace,lLibelle;this._options.largeurHoraireGauche=20;for(lPlace=0;lPlace<=this._options.nombreLignes;lPlace++){lLibelle=this.getLibelleTitreLigne(lPlace);if(this.getAfficherPasHoraire()&&lLibelle){var lLargeurSequence=GChaine.GetLongueurChaineDansDiv(lLibelle,10,true);this._options.largeurHoraireGauche=Math.max(this._options.largeurHoraireGauche,lLargeurSequence);}}}};_ObjetGrille.prototype.apresConstructionGrille=function(){_actualiserLibellesHeure.bind(this)(0);};_ObjetGrille.prototype.evenementNavigation=function(){;};_ObjetGrille.prototype.setNavigation=function(aNavigation){if(this._options.avecShadowFocus){if(aNavigation){$('#'+this.idConteneurGrille.escapeJQ()).css('box-shadow','0 0 5px -1px '+GCouleur.noir);}
else{$('#'+this.idConteneurGrille.escapeJQ()).css('box-shadow','none');}}};_ObjetGrille.prototype.actualiserWAI=function(aTexte){GHtml.setHtml(this.idNavigation,aTexte);};_ObjetGrille.prototype.SelectionnerGrille=function(){GHtml.setFocus(this.idNavigation);};function _evenementScrollH(AGenre,APosition){switch(AGenre){case EGenreScrollEvenement.Deplacement:return this._options.scrollHorizontaleParPas?(this.largeurCellule)*Math.round(APosition/(this.largeurCellule)):APosition;case EGenreScrollEvenement.TailleZone:var lJConteneurGrille=$('#'+this.idConteneurGrille.escapeJQ()),lLargeur;lJConteneurGrille.width(0);try{lLargeur=_getLargeurMaxGrille.bind(this)();lLargeur=lLargeur-(lLargeur%this.largeurCellule)-1;}
finally{lJConteneurGrille.width('auto');}
return lLargeur;case EGenreScrollEvenement.TailleContenu:return $('#'+this.ScrollH.GetIdContenu(EZoneScroll.Grille).escapeJQ()).innerWidth()-1;}}
function _evenementScrollV(AGenre,APosition){switch(AGenre){case EGenreScrollEvenement.Deplacement:var lLigne=Math.round(APosition/this.hauteurCellule);var lValeur=this.hauteurCellule*lLigne;_actualiserLibellesHeure.bind(this)(Math.abs(lLigne));return lValeur;case EGenreScrollEvenement.TailleZone:var lJConteneurGrille=$('#'+this.idConteneurGrille.escapeJQ()),lHeightMax;lJConteneurGrille.height(0);try{lHeightMax=_getHauteurMaxGrille.bind(this)();}
finally{lJConteneurGrille.height('auto');}
return lHeightMax-(lHeightMax%this.hauteurCellule)-1;case EGenreScrollEvenement.TailleContenu:return $('#'+this.ScrollV.GetIdContenu(EZoneScroll.Grille).escapeJQ()).height();}}
function _getHauteurMaxGrille(){return GPosition.getHeight(this.GetNom())-this._options.hauteurLigneTitre-(this._cache.scrollHVisible?GNavigateur.GetLargeurBarreDeScroll():5)-2;}
function _getLargeurMaxGrille(){return GPosition.getWidth(this.GetNom())-this._options.largeurHoraireGauche-GNavigateur.GetLargeurBarreDeScroll()-2;}
function _calculerDimensions(){var estPremiereFois=this.hauteurCellule===undefined;var LWidth=_getLargeurMaxGrille.bind(this)(),LHeight=_getHauteurMaxGrille.bind(this)();this.largeurCellule=Math.floor(LWidth/this._options.colonnesVisibles.count());if(this._options.largeurMaxCellule>0){this.largeurCellule=Math.min(this.largeurCellule,this._options.largeurMaxCellule);}
this.largeurCellule=Math.max(this.largeurCellule,this._options.largeurMinCellule);this.ScrollH.pas=this.largeurCellule;this._cache.scrollHVisible=LWidth<((this.largeurCellule)*this._options.colonnesVisibles.count())+((this.Fin-this.Debut)*this.hauteurCellule>LHeight?GNavigateur.GetLargeurBarreDeScroll():0);LHeight=_getHauteurMaxGrille.bind(this)();this.hauteurCellule=this._options.hauteurPasHoraire!== -1?this._options.hauteurPasHoraire!== -2?this._options.hauteurPasHoraire:this._options.hauteurHeure/this._options.pasHoraire:Math.floor(LHeight/(1+this.Fin-this.Debut));this.hauteurCellule=Math.max(this.hauteurCellule,this._options.hauteurMINPasHoraire);if(this._options.hauteurMAXPasHoraire>0){this.hauteurCellule=Math.min(this.hauteurCellule,this._options.hauteurMAXPasHoraire);}
if(estPremiereFois) _calculerDimensions.bind(this)();}
function _construireGrille(){_calculerDimensions.bind(this)();this.ScrollH.pas=this._options.scrollHorizontaleParPas?this.largeurCellule:1;this.ScrollV.pas=this.hauteurCellule;this._colonneesAvecStage=[];var H=[];H.push('<div id="',this.idConteneurGrille,'">');H.push(_composeEnTete.bind(this)());H.push(_composeCorps.bind(this)());H.push(_composePied.bind(this)());H.push('</div>');this.SetPremierElement(this.idNavigation);H.push('<div id="',this.idNavigation,'" tabindex="0" ',GObjetWAI.composeRole(EGenreRole.Gridcell),' ',GObjetWAI.composeAttribut({genre:EGenreAttribut.live,valeur:'polite'}),' onfocus="',this.Nom,'.setNavigation (true)" onblur="',this.Nom,'.setNavigation (false)" onkeyup="',this.Nom,'.evenementNavigation ()" class="wai_hidden">Grille : ',GObjetWAI.composeSpan(EGenreObjet.Tableau)+GObjetWAI.composeSpan(EGenreObjet.AvecValidation));H.push('</div>');return H.join('');}
function _composeEnTete(){var H=[];H.push('<div id="',this.idLigneTitre ,'" class="NoWrap" style="',GStyle.composeHeight(this._options.hauteurLigneTitre),'">');H.push('<div id="',this.idLigneTitreG_Haut ,'" class="InlineBlock WhiteSpaceNormal AlignementMilieuVertical" style="',GStyle.composeWidth(this._options.largeurHoraireGauche),' height:100%; position:relative;">');H.push('</div>');H.push('<div class="InlineBlock WhiteSpaceNormal AlignementMilieuVertical">');H.push(_composeTitreColonnes.bind(this)());H.push('</div>');H.push('</div>');return H.join('');}
function _composeTitreColonnes(){var H=[],lIColonne,lFormatTitreColonnes=this.getFormatTitreColonnes(this._options.colonnesVisibles.count(),this.largeurCellule);H.push('<div id="',this.ScrollH.GetIdZone(EZoneScroll.TitreHaut),'" style="overflow:hidden;">');H.push('<div id="'+this.ScrollH.GetIdContenu(EZoneScroll.TitreHaut)+'" class="NoWrap">');for(lIColonne=0;lIColonne<this._options.colonnesVisibles.count();lIColonne++){H.push('<div class="InlineBlock WhiteSpaceNormal AlignementMilieuVertical AlignementMilieu" style="width:'+this.largeurCellule+'px">',this.ComposeDate(lIColonne,this.largeurCellule,lFormatTitreColonnes),'</div>');}
H.push('</div>');H.push('</div>');return H.join('');}
_ObjetGrille.prototype.getFormatTitreColonnes=function(aNombreColonnes,aLargeur){};_ObjetGrille.prototype.ComposeDate=function(I,ALargeur,aFormatTitreColonnes){return'';};function _composeCorps(){var H=[];H.push('<div class="NoWrap">');H.push('<div class="InlineBlock WhiteSpaceNormal AlignementHaut">');H.push(_composeTitreLignes.bind(this)());H.push('</div>');H.push('<div class="InlineBlock WhiteSpaceNormal AlignementHaut">');H.push(_composeGrille.bind(this)());H.push('</div>');H.push('<div class="InlineBlock WhiteSpaceNormal AlignementHaut">');H.push('<div id="'+this.ScrollV.GetIdScroll()+'" style="padding-top:1px;"></div>');H.push('</div>');H.push('</div>');return H.join('');}
_ObjetGrille.prototype.getLibelleTitreLigne=function(aLigne){return'';};_ObjetGrille.prototype._avecTitreLibelleLigne=function(aLigne){if(this._options.titresLignesParSequence){return false;}
return this.getAfficherPasHoraire()&&(this._options.afficherPasHoraire||!!this.getLibelleTitreLigne(aLigne));};_ObjetGrille.prototype.getTaillePoliceHeure=function(aPourHeure){if(this.hauteurCellule>=this._options.hauteurPoliceMin)
return 0;return 9;};function _getClasseTaillePoliceHeure(aPourHeure){var lTaille=this.getTaillePoliceHeure(aPourHeure);if(lTaille>0)
return'Texte'+lTaille;return'';}
_ObjetGrille.prototype._getClassTitreLigneDeLigne=function(aLigne){if(this._options.titresLignesParSequence){return _getClasseTaillePoliceHeure.call(this,true);}
else{var LGenreSeparateur=this.getGenreSeparateurLigne(aLigne-1);return _getClasseTaillePoliceHeure.call(this,LGenreSeparateur===_ObjetGrille.separateurLigne.plein);}};_ObjetGrille.prototype.getAfficherPasHoraire=function(){return true;};function _getDecalageTitrePoliceLigne(){var lTaille=this.getTaillePoliceHeure(true);if(lTaille<=0)
lTaille=10;return Math.floor((lTaille+2)/2);}
_ObjetGrille.prototype._composeTitresLignes=function(){var lAfficherPasHoraire=this.getAfficherPasHoraire()||(this.hauteurCellule>=this._options.hauteurMINPasHoraire),lAvecPremierHoraire=false,lClass,lLibelle,lNombreLignesCouvertes,H=[],lILigne;for(lILigne=this.Debut;lILigne<=this.Fin;lILigne++){H.push('<div style="',GStyle.composeHeight(this.hauteurCellule),GStyle.composeWidth(this._options.largeurHoraireGauche),'">');if(!this._options.titresLignesParSequence){if(lILigne>this.Debut&&(lAfficherPasHoraire||!lAvecPremierHoraire||(lILigne%this._options.nombreLignes===0)||(lILigne===this.Fin))){lLibelle=this.getLibelleTitreLigne(lILigne);if(lLibelle&&lLibelle.trim().length>0){lClass='AlignementDroit PetitEspaceDroit '+this._getClassTitreLigneDeLigne(lILigne);H.push('<div id="',this.idLigneTitreG+'_'+lILigne,'" class="',lClass,'"',' style="',GStyle.composeCouleurTexte(this._options.couleurLibellesLignes),GStyle.composeHeight(this._options.hauteurCellule),' position:relative; top:',-_getDecalageTitrePoliceLigne.call(this),'px;">',GChaine.AvecEspaceSiVide(lLibelle),'</div>');}
if(!lAvecPremierHoraire&&(lILigne%this._options.pasHoraire===0)){lAvecPremierHoraire=true;}}}
else{lLibelle=this.getLibelleTitreLigne(lILigne);var lAvecSequence=((lAfficherPasHoraire&&((lILigne!==this.Fin)||(this._options.pasHoraire===1)))||!lAvecPremierHoraire)&&lLibelle;if(lAvecSequence){lClass='AlignementDroit PetitEspaceDroit '+this._getClassTitreLigneDeLigne(lILigne);lNombreLignesCouvertes=this._options.pasHoraire;if(!lAvecPremierHoraire){lNombreLignesCouvertes=lNombreLignesCouvertes-lILigne%this._options.pasHoraire;}
lNombreLignesCouvertes=Math.min(lNombreLignesCouvertes,this.Fin-lILigne+1);if(lLibelle){H.push('<div ',' id="'+this.idLigneTitreG+'_'+lILigne+'" ',' class="'+lClass+'"',' style="'+GStyle.composeHeight(this.hauteurCellule)+GStyle.composeCouleurTexte(this._options.couleurLibellesLignes)+'position:relative; top:',Math.floor(this.hauteurCellule*lNombreLignesCouvertes/2)-_getDecalageTitrePoliceLigne.call(this)+1,'px">',GChaine.AvecEspaceSiVide(lLibelle),'</div>');}
if(!lAvecPremierHoraire&&lAvecSequence){lAvecPremierHoraire=true;}}}
H.push('</div>');}
return H.join('');};function _composeTitreLignes(){var H=[];H.push('<div id="',this.ScrollV.GetIdZone(EZoneScroll.TitreLignes),'" style="overflow:hidden;">');H.push('<div id="'+this.ScrollV.GetIdContenu(EZoneScroll.TitreLignes)+'" style="',GStyle.composeWidth(this._options.largeurHoraireGauche),'">');H.push(this._composeTitresLignes());H.push('</div>');H.push('</div>');return H.join('');}
_ObjetGrille.prototype._composeGrilleInterne=function(){var H=[],lIColonne;H.push('<div id="'+this.IdCellulePrefixe+'" ',' ie-event="iedown->{.'+this.classCelluleAvecMouseDown ,'}surMouseDownGrilleCellule"',' ie-event="ieup->{.'+this.classCelluleAvecMouseDown ,'}surMouseUpGrilleCellule"',' ie-event="iedown-ieup-ielongtouch->surEventGrille"',' ie-class="getClassGrille" style="display:table; border-width:0px; border-spacing:0px; padding:0px;',GStyle.composeCouleurFond(this.getCouleurFond()),'">');for(lIColonne=0;lIColonne<this._options.colonnesVisibles.count();lIColonne++){H.push('<div id="',this.idColonne+lIColonne+'" class="InlineBlock WhiteSpaceNormal AlignementHaut" style="position:relative">');H.push(this.composeColonne(lIColonne));H.push('</div>');}
H.push('</div>');return H.join('');};_ObjetGrille.prototype.composeColonne=function(aNumeroColonne){var H=[],lILigne;for(lILigne=this.Debut;lILigne<=this.Fin;lILigne++){H.push(_composeCelluleGrille.bind(this)(lILigne,aNumeroColonne));}
return H.join('');};function _composeGrille(){var H=[];H.push('<div id="',this.ScrollV.GetIdZone(EZoneScroll.Grille),'" style="overflow:hidden;',GStyle.composeCouleurBordure(this.getCouleurBordures()),'">');H.push('<div id="'+this.ScrollV.GetIdContenu(EZoneScroll.Grille)+'" style="position:relative;">');H.push('<div id="'+this.idConteneurAbsGrille+'" style="position:relative;">',this._composeContenuAbolueDansGrille(),'</div>');H.push('<div id="',this.idConteneurGrilleInterne,'">',this._composeGrilleInterne(),'</div>');H.push('</div>');H.push('</div>');return H.join('');}
_ObjetGrille.prototype._composeContenuAbolueDansGrille=function(){return'';};_ObjetGrille.prototype.getGenreSeparateurLigne=function(aLigne){return _ObjetGrille.separateurLigne.moyen;};_ObjetGrille.prototype._getPourcentageLargeurSeparateur=function(aGenreSeparateur){switch(aGenreSeparateur){case _ObjetGrille.separateurLigne.moyen:return 40;default:return 20;}};function _composeCelluleGrille(aLigne,aColonne){var T=[];var LGenreSeparateur=this.getGenreSeparateurLigne(aLigne);var LPos=this.GetPosition(aColonne,aLigne),lPlaceEdt=this.getPlaceDePosition({x:aColonne,y:aLigne}),lDerniereLigne=aLigne===this.Fin,lAvecTraitBas=LGenreSeparateur===_ObjetGrille.separateurLigne.plein&&!lDerniereLigne,lDerniereColonne=aColonne===this._options.colonnesVisibles.get(this._options.colonnesVisibles.count()-1),lLargeurMoitieCellule=Math.floor((this.largeurCellule-1)/2);var LClass=this.classCelluleAvecMouseDown+' '+this.getClasseSupplementaireDeCellule(aLigne,aColonne,lPlaceEdt);var lBordures=(!lDerniereColonne?EGenreBordure.droite:0)+(lAvecTraitBas?EGenreBordure.bas:0);var LStyle='position:relative; font-size:1px;'+GStyle.composeWidth(this.largeurCellule+(lDerniereColonne?0:-1))+GStyle.composeHeight(this.hauteurCellule+(lAvecTraitBas||lDerniereLigne?-1:0))+(lBordures>0?GStyle.composeCouleurBordure(this.getCouleurBordures(),1,lBordures):''),lContenu=LGenreSeparateur===_ObjetGrille.separateurLigne.plein||LGenreSeparateur===_ObjetGrille.separateurLigne.vide?'':'<div class="Cellule_Separateur_'+LGenreSeparateur+'" style="position:absolute; bottom:0px;left:'+(lLargeurMoitieCellule-Math.floor(lLargeurMoitieCellule*this._getPourcentageLargeurSeparateur(LGenreSeparateur)/100))+'px;'+GStyle.composeCouleurBordure(this.getCouleurBordures(),1,EGenreBordure.bas)+'"></div>',lCouleurFond=this.getCouleurFondDePlaceEDT(lPlaceEdt);if(lCouleurFond){LStyle+=GStyle.composeCouleurFond(lCouleurFond);}
LStyle+=this.getStyleSupplementaireDeCellule(aLigne,aColonne,lPlaceEdt)||'';var lContenuCellule=this.getContenuCellule(lPlaceEdt);if(lContenuCellule){lContenu+=lContenuCellule;}
T.push('<div id="'+this.IdCellulePrefixe+LPos+'" class="'+LClass+'" style="'+LStyle+'" ',IE.HTML.ieData({ligne:aLigne,colonne:aColonne,placeGrille:lPlaceEdt}),' ie-hint="getTitleCellule(',aLigne,',',aColonne,',',lPlaceEdt,')">'+
lContenu+'</div>');return T.join('');}
_ObjetGrille.prototype.getContenuCellule=function(aPlaceGrille){return'';};_ObjetGrille.prototype.getClasseSupplementaireDeCellule=function(aLigne,aColonne,aPlaceGrille){return'';};_ObjetGrille.prototype.getStyleSupplementaireDeCellule=function(aLigne,aColonne,aPlaceGrille){return'';};_ObjetGrille.prototype.getCouleurFond=function(){return this._options.couleurFond;};_ObjetGrille.prototype.getCouleurBordures=function(){return this._options.couleurBordures;};_ObjetGrille.prototype.getCouleurFondDePlaceEDT=function(aPlaceEdt){return null;};function _composePied(){var H=[];H.push('<div id="',this.idLignePied,'" class="NoWrap" style="',GStyle.composeHeight(this._cache.scrollHVisible?GNavigateur.GetLargeurBarreDeScroll():0),'">');H.push('<div id="',this.idLigneTitreG_Bas ,'" class="InlineBlock WhiteSpaceNormal AlignementHaut"  style="height:0px; ',GStyle.composeWidth(this._options.largeurHoraireGauche),' position:relative;">');H.push('</div>');H.push('<div class="InlineBlock WhiteSpaceNormal AlignementHaut">');H.push('<div id="'+this.ScrollH.GetIdScroll()+'"></div>');H.push('</div>');H.push('</div>');return H.join('');}
function _actualiserLibellesHeure(aLigneScroll){var H;if(!this._options.actualiserTitresLignes){return;}
aLigneScroll+=this.Debut;var lLigneMax=aLigneScroll+this.Fin-this.Debut+1;aLigneScroll=Math.min(aLigneScroll,lLigneMax);var lJPremierLibelle=$('#'+this.idLigneTitreG_Haut.escapeJQ());if(this._avecTitreLibelleLigne(aLigneScroll)){H=[];H.push('<div class="AlignementDroit PetitEspaceDroit ',this._getClassTitreLigneDeLigne(aLigneScroll),'" style="',GStyle.composeCouleurTexte(this._options.couleurLibellesColonnes),GStyle.composeHeight(this._options.hauteurMINPasHoraire),' position:relative; top:',this._options.hauteurLigneTitre-_getDecalageTitrePoliceLigne.call(this)+1,'px;">',GChaine.AvecEspaceSiVide(this.getLibelleTitreLigne(aLigneScroll)),'</div>');lJPremierLibelle.html(H.join(''));}
else{lJPremierLibelle.html('');}
var lJDernierLibelle=$('#'+this.idLigneTitreG_Bas.escapeJQ()),lDerniereLigneVisible=Math.min(Math.min(lLigneMax,aLigneScroll+Math.floor(GPosition.getHeight(this.ScrollV.GetIdZone(EZoneScroll.Grille))/this.hauteurCellule)),this._options.nombreLignes);if(this._avecTitreLibelleLigne(lDerniereLigneVisible)){H=[];H.push('<div class="AlignementDroit PetitEspaceDroit ',this._getClassTitreLigneDeLigne(lDerniereLigneVisible),'" style="',GStyle.composeCouleurTexte(this._options.couleurLibellesColonnes),GStyle.composeHeight(this._options.hauteurMINPasHoraire),' position:relative; top:',-_getDecalageTitrePoliceLigne.call(this)-1,'px;">',GChaine.AvecEspaceSiVide(this.getLibelleTitreLigne(lDerniereLigneVisible)),'</div>');lJDernierLibelle.html(H.join(''));}
else{lJDernierLibelle.html('');}
var lILigne;for(lILigne=this.Debut;lILigne<=this.Fin;lILigne++){var lId=this.idLigneTitreG+'_'+lILigne;if(lILigne>aLigneScroll&&lILigne<lDerniereLigneVisible){GStyle.setVisible(lId,true);}
else{GStyle.setVisible(lId,false);}}}
_ObjetGrille.prototype.surMouseDownGrilleCellule=function(aPlace,aElement,aEvent){if(this._options.callbackMouseDownCellule)
this._options.callbackMouseDownCellule(aPlace,aElement,aEvent);};_ObjetGrille.prototype.CalculerDebutEtFin=function(){this.Debut=0;this.Fin=this._options.nombreLignes-1;};_ObjetGrille.prototype.GetPosition=function(APosX,APosY){return APosY===null||APosY===undefined?APosX:APosX*this._options.nombreLignes+APosY;};_ObjetGrille.prototype.GetIdCellule=function(APosX,APosY){return this.IdCellulePrefixe+this.GetPosition(APosX,APosY);};_ObjetGrille.prototype.estPlaceVisible=function(aPlace){var lColonne=Math.floor(aPlace/this._options.nombreLignes);return this._options.colonnesVisibles.contains(lColonne);};_ObjetGrille.prototype.getNumeroJourDeColonne=function(aColonne){return this._options.colonnesVisibles.get(aColonne);};_ObjetGrille.prototype.getPositionDePlace=function(aPlace){var lColonne=IE.MethodesTableau.chercher(Math.floor(aPlace/this._options.nombreLignes),this._options.colonnesVisibles.items());if(lColonne<0){return{x:0,y:0};}
return{x:lColonne,y:aPlace%this._options.nombreLignes};};_ObjetGrille.prototype.getPlaceDePosition=function(aPosition){return this._options.colonnesVisibles.get(aPosition.x)*this._options.nombreLignes+aPosition.y;};_ObjetGrille.prototype.getPositionGrilleDePosition=function(aPosition){return{x:Math.floor(aPosition/this._options.nombreLignes),y:aPosition%this._options.nombreLignes};};_ObjetGrille.prototype.getPositionGrilleDePositionAbsolue=function(aPosition){var lElementGrille=GHtml.getElement(this.IdCellulePrefixe),lPosition={left:GPosition.getLeft(lElementGrille),top:GPosition.getTop(lElementGrille)};return{y:Math.borner(Math.floor(((aPosition.y||0)-(lPosition?lPosition.top:0))/this.hauteurCellule),0,this.Fin-this.Debut),x:Math.borner(Math.floor(((aPosition.x||0)-(lPosition?lPosition.left:0))/this.largeurCellule),0,this._options.colonnesVisibles.count()-1)};};_ObjetGrille.prototype.getPositionGrilleEvent=function(aEvent){return this.getPositionGrilleDePositionAbsolue(GPosition.getPositionEventJQuery(aEvent));};_ObjetGrille.prototype.getPositionGrilleDeSouris=function(){return this.getPositionGrilleDePositionAbsolue({x:GNavigateur.SourisX ,y:GNavigateur.SourisY});};_ObjetGrille.prototype.getNombrePlacesGrille=function(){return(this._options.colonnesVisibles.get(this._options.colonnesVisibles.count()-1)+1)*this._options.nombreLignes;};_ObjetGrille.prototype.SurPreResize=function(){if(this.EnAffichage){this.ScrollV.Vider();this.ScrollH.Vider();GHtml.setHtml(this.Nom,'&nbsp;');}};_ObjetGrille.prototype.SurPostResize=function(){if(this.EnAffichage)
this.ConstruireAffichage();};}());;

MethodesObjet.heritagePrototype(_ObjetGrillePN,_ObjetGrille);function _ObjetGrillePN(ANom,AIdent,APere,AEvenement){this.inheritedCreate(ANom,AIdent,APere,AEvenement);}(function(){_ObjetGrillePN.prototype._initialiserOptions=function(){this.inherited('_initialiserOptions');$.extend(this._options,{largeurMinCellule:55,premierLundi:GParametres.PremierLundi,joursOuvres:GParametres.JoursOuvres,joursFeries:GParametres.JoursFeries,nombreLignes:GParametres.PlacesParJour,pasHoraire:GParametres.PlacesParHeure,placeDemiJournee:GParametres.PlaceDemiJournee,recreations:GParametres.recreations,avecHeuresPleinesApresMidi:GParametres.AvecHeuresPleinesApresMidi,titresLignesParSequence:GParametres.afficherSequences,frequences:null});};_ObjetGrillePN.prototype.getLibelleTitreLigne=function(aLigne){if(this._options.titresLignesParSequence){if(this._options.avecHeuresPleinesApresMidi&&
aLigne<GParametres.finDemiPension&&(aLigne+this._options.pasHoraire-1>=GParametres.finDemiPension))
return'';if(aLigne+this._options.pasHoraire>this.Fin)
return'';var lLigne=this._options.avecHeuresPleinesApresMidi&&(aLigne>=GParametres.finDemiPension)?aLigne-(GParametres.finDemiPension%this._options.pasHoraire):aLigne;if(lLigne%this._options.pasHoraire===0){return GParametres.sequences[Math.floor(aLigne/GParametres.PlacesParHeure)]||'';}
return'';}
return aLigne<GParametres.LibellesHeures.GetNbrElements()&&GParametres.LibellesHeures.GetActif(aLigne)?GParametres.LibellesHeures.GetLibelle(aLigne):'';};_ObjetGrillePN.prototype.getGenreSeparateurLigne=function(aLigne){var JJ=this._options.avecHeuresPleinesApresMidi&&((aLigne+1)>=GParametres.finDemiPension)?(aLigne+1)-GParametres.finDemiPension:aLigne+1;return(JJ%this._options.pasHoraire)&&((aLigne)!==this.Fin)?2*JJ%this._options.pasHoraire?_ObjetGrille.separateurLigne.petit:_ObjetGrille.separateurLigne.moyen:_ObjetGrille.separateurLigne.plein;};_ObjetGrillePN.prototype._getClassTitreLigneDeLigne=function(aLigne){var lClass=this.inherited('_getClassTitreLigneDeLigne',aLigne);return lClass;};})();;

function ObjetCalculCoursMultiple(){}(function(){ObjetCalculCoursMultiple.prototype.calculer=function(aParametres){var lParametres={listeCours:null,avecCoursAnnules:true,avecCoursAnnulesSuperposes:true},I,lCours;$.extend(lParametres,aParametres);this.listeCours=lParametres.listeCours;if(this.listeCours.__listeCoursBackup){this.listeCours.ListeElements=this.listeCours.__listeCoursBackup.ListeElements;delete this.listeCours.__listeCoursBackup;}
this.listeCours.__listeCoursBackup=MethodesObjet.dupliquer(this.listeCours);var lNbCours=this.listeCours.GetNbrElements();this.listeCoursMultiples=new ObjetListeElements();if(!lParametres.avecCoursAnnules)
for(I=0;I<lNbCours;I++){lCours=this.listeCours.GetElement(I);if(lCours.estAnnule)
lCours.Visible=false;}
if(lParametres.avecCoursAnnules&&!lParametres.avecCoursAnnulesSuperposes){var lTrouveAnnuleInvisble=_rendreInvisibleCoursAnnulesSuperposes.bind(this)();while(lTrouveAnnuleInvisble){lTrouveAnnuleInvisble=_rendreInvisibleCoursAnnulesSuperposes.bind(this)();}}
this.placesOccupees=[];for(I=0;I<lNbCours;I++){lCours=this.listeCours.GetElement(I);if(lCours.Visible!==false)
for(var lPlace=lCours.Debut;lPlace<=lCours.Fin;lPlace++){if(MethodesObjet.isUndefined(this.placesOccupees[lPlace]))
this.placesOccupees[lPlace]=I;else{_creationCoursMultiSeances.bind(this)(I);break;}}}
for(I=0;I<this.listeCoursMultiples.GetNbrElements();I++){lCours=this.listeCoursMultiples.GetElement(I);if(lCours){lCours.listeCours.setTri([ObjetTri.init('estAnnule'),ObjetTri.init('placeDebutMS'),ObjetTri.init(function(E){return E.placeFinMS-E.placeDebutMS;}),ObjetTri.init(function(E){return E.Statut?E.Statut:'';}),ObjetTri.init('Position'),ObjetTri.init('Numero')]);lCours.listeCours.trier();_calculerPositionnementCouloir.bind(this)(lCours);this.listeCours.AddElement(lCours);}}};function _unePlaceEstOccupee(aPlacesCours,aPlacesCouloir){for(var I in aPlacesCours)
if(aPlacesCouloir[I])
return true;return false;}
function _calculerPositionnementCouloir(aCoursMultiple){aCoursMultiple.listeCours.nbCouloirs=0;aCoursMultiple.numeroCouloir=0;var lCouloirs=[];for(var I=0;I<aCoursMultiple.listeCours.GetNbrElements();I++)
lCouloirs[I]=[];for(I=0;I<aCoursMultiple.listeCours.GetNbrElements();I++){var lTabOccupation=[];var lCours=aCoursMultiple.listeCours.GetElement(I);for(var lPlace=lCours.Debut;lPlace<=lCours.Fin;lPlace++)
lTabOccupation[lPlace]=true;var lNumeroCouloir=0;while(_unePlaceEstOccupee(lTabOccupation,lCouloirs[lNumeroCouloir])){lNumeroCouloir++;aCoursMultiple.listeCours.nbCouloirs=Math.max(aCoursMultiple.listeCours.nbCouloirs,lNumeroCouloir+1);}
for(var J in lTabOccupation)
if(lTabOccupation[J])
lCouloirs[lNumeroCouloir][J]=true;lCours.numeroCouloir=lNumeroCouloir;}}
function _rendreInvisibleCoursAnnulesSuperposes(){var I,j,lNb=this.listeCours.GetNbrElements(),lCours,lCoursSuperpose,lPlaceOccupees=[];for(I=0;I<lNb;I++){lCours=this.listeCours.GetElement(I);if(lCours.Visible!==false)
for(var lPlace=lCours.Debut;lPlace<=lCours.Fin;lPlace++){if(MethodesObjet.isUndefined(lPlaceOccupees[lPlace]))
lPlaceOccupees[lPlace]=I;else{var lCoursSuperposees=_getTableauIndicesCoursSuperposesDeCours.bind(this)(I,lPlaceOccupees);var lAvecCoursAnnule=false,lAvecCoursNormal=false;for(j=0;j<lCoursSuperposees.length;j++){lCoursSuperpose=this.listeCours.GetElement(lCoursSuperposees[j]);if(!lAvecCoursNormal)
lAvecCoursNormal=!lCoursSuperpose.estAnnule;if(!lAvecCoursAnnule)
lAvecCoursAnnule=lCoursSuperpose.estAnnule;}
if(lAvecCoursNormal&&lAvecCoursAnnule)
for(j=0;j<lCoursSuperposees.length;j++){lCoursSuperpose=this.listeCours.GetElement(lCoursSuperposees[j]);if(lCoursSuperpose&&lCoursSuperpose.estAnnule){lCoursSuperpose.Visible=false;return true;}}
break;}}}
return false;}
function _getTableauIndicesCoursSuperposesDeCours(aIndiceCours,aPlaceOccupees){var lCours=this.listeCours.GetElement(aIndiceCours);var lCoursSuperposees=[aIndiceCours];for(var lPlace=lCours.Debut;lPlace<=lCours.Fin;lPlace++){var lIndiceCours=aPlaceOccupees[lPlace];if(!MethodesObjet.isUndefined(lIndiceCours)){if((lIndiceCours!==aIndiceCours)&&(!MethodesTableau.existe(lIndiceCours,lCoursSuperposees)))
lCoursSuperposees.push(lIndiceCours);}}
return lCoursSuperposees;}
function _creationCoursMultiSeances(aIndiceCours){var lCours=this.listeCours.GetElement(aIndiceCours);var lCoursSuperposees=_getTableauIndicesCoursSuperposesDeCours.bind(this)(aIndiceCours,this.placesOccupees);var lPlaceDebut=lCours.Debut;var lPlaceFin=lCours.Fin;var lListeCoursDansCoursMultiple=new ObjetListeElements();for(var I=0;I<lCoursSuperposees.length;I++){if(lCoursSuperposees[I]<0){var lIndice= -lCoursSuperposees[I]-1;lCours=this.listeCoursMultiples.GetElement(lIndice);for(var J=0;J<lCours.listeCours.GetNbrElements();J++)
lListeCoursDansCoursMultiple.AddElement(lCours.listeCours.GetElement(J));this.listeCoursMultiples.AddElement(null,lIndice);}
else{lCours=this.listeCours.GetElement(lCoursSuperposees[I]);var lCoursDuplique=MethodesObjet.dupliquer(lCours);lCoursDuplique.coursOrigine=lCours;lCoursDuplique.indiceCoursOrigine=lCoursSuperposees[I];lCoursDuplique.Visible=true;lCoursDuplique.placeDebutMS=lCoursDuplique.Debut;lCoursDuplique.placeFinMS=lCoursDuplique.Fin;lCoursDuplique.ResetTri();lListeCoursDansCoursMultiple.AddElement(lCoursDuplique);lCours.Visible=false;lCours.estCoursMS=true;lCours.coursCopie=lCoursDuplique;}
lPlaceDebut=Math.min(lPlaceDebut,lCours.Debut);lPlaceFin=Math.max(lPlaceFin,lCours.Fin);}
var lCoursMultiple=new ObjetElement(lCours.GetLibelle(),0);lCoursMultiple.coursMultiple=true;lCoursMultiple.Debut=lPlaceDebut;lCoursMultiple.Fin=lPlaceFin;lCoursMultiple.CouleurFond=GCouleur.nonEditable.fond;lCoursMultiple.CouleurTexte=GCouleur.noir;lCoursMultiple.listeCours=lListeCoursDansCoursMultiple;lCoursMultiple.ListeContenus=new ObjetListeElements();this.listeCoursMultiples.AddElement(lCoursMultiple);var lIndiceCoursMultiple=this.listeCoursMultiples.GetNbrElements();for(var lPlace=lPlaceDebut;lPlace<=lPlaceFin;lPlace++)
this.placesOccupees[lPlace]= -lIndiceCoursMultiple;}})();;
var EGenreDemiJours={Matin:0,ApresMidi:1};;
var EGenreEvenementEDT={SurCours:0,SurImage:1,SurMouseEnterCours:2,SurMouseLeaveCours:3,SurMenuContextuel:4,SurContenu:5};MethodesObjet.heritagePrototype(ObjetGrille,_ObjetGrillePN);function ObjetGrille(ANom,AIdent,APere,AEvenement){this.inheritedCreate(ANom,AIdent,APere,AEvenement);this.IdEmploiDuTemps=this.Nom+'_EmploiDuTemps';this.IdDatePrefixe=this.Nom+'_Date';this.IdListeElements=this.Nom+'_Grille_Elements';this.IdElementPrefixe=this.Nom+'_Element_';this.IdContenuPrefixe=this.Nom+'_ContenuPre_';this.IdStatutPrefixe=this.Nom+'_Statut_';this.IdImages=this.Nom+'_Images';this.IdElementCadreSlider=this.Nom+'_CadreSlider_';this.idAbsences=this.Nom+'_absences';this._parametresGrille={};this.idGabarit=this.Nom+'_gabarit_';this.idGabaritC=this.idGabarit+'C';this.classDroppable=GUID.getClassCss();}(function(){var EGenreOrdreGabarit={deplacement:0,retaillageHaut:1,retaillageBas:2};ObjetGrille.imageAlignementHorizontal={Gauche:0,Milieu:1,Droit:2};ObjetGrille.imageAlignementVertical={Haut:0,Milieu:1,Bas:2};ObjetGrille.prototype.getControleur=function(){return{eventCours:function(aIndiceCours,aEvent){switch(aEvent.type){case'mouseup':if(!this.instance._options.avecSelectionCours)
return;if(aEvent.which===3)
return;this.instance.SelectionnerElementParIndice(aIndiceCours,true);break;case'contextmenu':_surContextMenuCours.call(this.instance,aIndiceCours);break;case'mouseenter':case'mouseleave':this.instance.callback.appel({genre:aEvent.type==='mouseenter'?EGenreEvenementEDT.SurMouseEnterCours:EGenreEvenementEDT.SurMouseLeaveCours,id:this.instance.GetIdElement(aIndiceCours),cours:this.instance.ListeCours.GetElement(aIndiceCours),indiceCours:aIndiceCours});break;}},eventImageCours:function(aIndiceCours,aGenreImage,aEvent){this.instance.surEvenement(aEvent,EGenreEvenementEDT.SurImage,aIndiceCours,null,aGenreImage,false);},gabarit:{surEventHaut:function(aEvent){switch(aEvent.type){case'iedown':$('#'+this.instance.idGabarit.escapeJQ()).data('commande',{ordre:EGenreOrdreGabarit.retaillageHaut,placeOrigine:this.instance._parametresGrille.placeGabarit,dureeOrigine:this.instance._parametresGrille.dureeGbarit});_ajouterEventsGabarit.bind(this.instance)();break;}},surEventCentre:function(aEvent){switch(aEvent.type){case'iedown':var lPosition=this.instance.getPositionGrilleEvent(aEvent),lPlaceOrigine=this.instance.getPlaceDePosition(lPosition);$('#'+this.instance.idGabarit.escapeJQ()).data('commande',{ordre:EGenreOrdreGabarit.deplacement,decalagePlace:lPlaceOrigine-this.instance._parametresGrille.placeGabarit});_ajouterEventsGabarit.bind(this.instance)();break;case'contextmenu':if(this.instance._parametresGrille.callbackMenuContextuelGabarit){this.instance._parametresGrille.callbackMenuContextuelGabarit();}
break;case'iedblclick':if(this.instance._parametresGrille.callbackPoseGabarit)
this.instance._parametresGrille.callbackPoseGabarit({place:this.instance._parametresGrille.placeGabarit,duree:this.instance._parametresGrille.dureeGabarit});}},surEventBas:function(aEvent){switch(aEvent.type){case'iedown':$('#'+this.instance.idGabarit.escapeJQ()).data('commande',{ordre:EGenreOrdreGabarit.retaillageBas,placeOrigine:this.instance._parametresGrille.placeGabarit,dureeOrigine:this.instance._parametresGrille.dureeGbarit});_ajouterEventsGabarit.bind(this.instance)();break;}}}};};ObjetGrille.prototype._initialiserOptions=function(){this.inherited('_initialiserOptions');$.extend(this._options,{couloir:{const_valeurCouloirPlus:-2,const_valeurCouloirMoins:-1,largeurSlideMax:18,largeurSlideMin:13,largeurSlideMinExtreme:6},avecMouseInOutCours:false,avecIndisponibilite:false,avecDemiPension:true,avecRecreations:true,afficherDebutSelonCours:false,afficherFinSelonCours:false,opacitePourCoursEnStage:0.4,avecSelection:true,avecMenuContextuel:false,tailleTraitGabarit:3,delaiCallbackGabarit:100,avecDrop:false,callbackDropCellule:null,avecSelectionCours:true,estGrilleAbsence:false});};ObjetGrille.prototype.SetInformationWAI=function(){;};ObjetGrille.prototype.SetParametres_Affichage=function(){;};ObjetGrille.prototype.SetParametres_Grille=function(){;};ObjetGrille.prototype._DetruireInstances=function(){this.inherited('_DetruireInstances');_supprimerEventsGabarit.bind(this);};ObjetGrille.prototype.apresInitialisationOptions=function(){this.inherited('apresInitialisationOptions');if(!this._options.colonnesVisibles||this._options.colonnesVisibles.count()===0){this._options.colonnesVisibles=new TypeEnsembleNombre();for(var i=0;i<IE.Cycles.nombreJoursOuvresParCycle();i++){this._options.colonnesVisibles.add(i);}}
this.NumeroColonne=0;this.NumeroElement= -1;this.IndispoX= -1;this.IndispoY= -1;this.Indispo=false;this.EstAffiche=false;this.EnAffichage=false;};ObjetGrille.prototype.init_ParametresGrille=function(){this._parametresGrille={numeroSemaine:0,date:0,listeCours:null,joursStage:null,avecCoursAnnule:true,avecCoursAnnulesSuperposes:true,modeDiagnostic:false,diagnosticPlaces:null,diagnosticDeCours:null,positionGabarit:null,callbackDeplacementGabarit:null,callbackModificationTailleGabarit:null,callbackPoseGabarit:null,callbackMenuContextuelGabarit:null};};ObjetGrille.prototype.SetDonnees=function(aParametres){_supprimerEventsGabarit.bind(this);this.init_ParametresGrille();$.extend(this._parametresGrille,aParametres);if(this._parametresGrille.modeDiagnostic){_initialiserPlaceGabarit.bind(this)();}
this.donneesRecus=true;this._parametresGrille.numeroSemaine=this._parametresGrille.numeroSemaine===null||this._parametresGrille.numeroSemaine===undefined?IE.Cycles.cycleDeLaDate(this._parametresGrille.date):this._parametresGrille.numeroSemaine;this.Date=this._parametresGrille.date;this.joursStage=this._parametresGrille.joursStage;if(this.Date){this._options.colonnesVisibles.clear().add(IE.Cycles.dateEnJourCycle(this.Date));}
this.ListeCours=this._parametresGrille.listeCours;new ObjetCalculCoursMultiple().calculer({listeCours:this.ListeCours,avecCoursAnnules:this._parametresGrille.avecCoursAnnule,avecCoursAnnulesSuperposes:this._parametresGrille.avecCoursAnnulesSuperposes});this.NbrCours=this.ListeCours.GetNbrElements();this.NumeroColonne=0;this.NumeroElement= -1;for(var I=0;I<this.NbrCours;I++){var LCours=this.ListeCours.GetElement(I);for(var J=0;J<LCours.ListeContenus.GetNbrElements();J++){var LContenu=LCours.ListeContenus.GetElement(J);LContenu.Longueur=GChaine.GetLongueurChaine(LContenu.GetLibelle(),10,LContenu.Gras);}}
this._colonneesAvecStage=[];this.EstAffiche=true;this.arrayCoursPourNavigation=this.construireArrayCoursPourNavigation();this.ConstruireAffichage();};function _initialiserPlaceGabarit(){if(this._parametresGrille.positionGabarit){this._parametresGrille.placeGabarit=this._parametresGrille.positionGabarit.place;this._parametresGrille.dureeGabarit=this._parametresGrille.positionGabarit.duree;}
else if(this._parametresGrille.diagnosticDeCours){this._parametresGrille.placeGabarit=this._parametresGrille.diagnosticDeCours.Debut;this._parametresGrille.dureeGabarit=this._parametresGrille.diagnosticDeCours.Fin-this._parametresGrille.diagnosticDeCours.Debut+1;}}
ObjetGrille.prototype.apresConstructionGrille=function(){this.ComposeListeCours();this.ActualiserListeCours();if(this._options.estGrilleAbsence&&this._parametresGrille.utilitaireAbsences){GHtml.setHtml(this.idAbsences,this._parametresGrille.utilitaireAbsences.construireRetardsInfirmeriesPunitions(this),{controleur:this.controleur,ignorerScroll:true});}
this.SelectionnerColonne(this.NumeroColonne,false);this.inherited('apresConstructionGrille');_dessinerDemiPensionsEtRecreations.call(this);if(this._parametresGrille.modeDiagnostic&&this._parametresGrille.diagnosticDeCours){_positionnerGabarit.bind(this)();}
if(this._options.avecDrop){var lThis=this;$('.'+this.classDroppable).droppable({tolerance:'pointer',accept:'.classDraggableDeObjetListe',drop:function(event,ui){var lTab=this.id.split('_'),lPlace=parseInt(lTab[lTab.length-1],10);if($(this).data('dejaSelectionne')===true){$(this).data('dejaSelectionne',null);}
else{$(this).children('table').toggleClass('EmploiDuTemps_SansCadre EmploiDuTemps_AvecCadre');}
lThis.surDropGrilleCellule(event,ui,lPlace);},over:function(event,ui){if($(this).children('table').hasClass('EmploiDuTemps_AvecCadre')){$(this).data('dejaSelectionne',true);}
else $(this).children('table').toggleClass('EmploiDuTemps_SansCadre EmploiDuTemps_AvecCadre');},out:function(event,ui){if($(this).data('dejaSelectionne')===true){$(this).data('dejaSelectionne',null);}
else $(this).children('table').toggleClass('EmploiDuTemps_SansCadre EmploiDuTemps_AvecCadre');}});}};function _dessinerTraitsHoraireGrille(aParam){var lConteneur,lDiv,lDiv2,lParam=$.extend({place:-1,couleur:'red',afficherDoubleTrait:true,div:null},aParam);lDiv=$('<div style="height:1px;position:absolute;z-index:1;font-size:1px;'+GStyle.composeWidth(this.largeurCellule*this._options.colonnesVisibles.count())+GStyle.composeHeight(lParam.afficherDoubleTrait?1:2)+GStyle.composeCouleurFond(lParam.couleur)+GStyle.composeOpacite(0.7)+'"></div>').get(0);lConteneur=GHtml.getElement(this.idConteneurAbsGrille);if(lParam.place>0){GHtml.insererElementDOM(lConteneur,lDiv);GPosition.setPosition(lDiv,0,0+(lParam.place-this.Debut)*this.hauteurCellule-2);}
if(lParam.afficherDoubleTrait){lDiv2=lDiv.cloneNode(true);GHtml.insererElementDOM(lConteneur,lDiv2);GPosition.setPosition(lDiv2,0,0+(lParam.place-this.Debut)*this.hauteurCellule+0);}}
function _dessinerDemiPensionsEtRecreations(){var lAvecTraitDebut=false,lAvecTraitFin=false,lPlaceTraitDebut=0,lPlaceTraitFin=0,lCouleurTrait,lPlacesOccupes=new TypeEnsembleNombre();if(this._options.estGrilleAbsence){lAvecTraitDebut=true;lPlaceTraitDebut=this._options.placeDemiJournee;lCouleurTrait=GCouleur.grille.demiPensionInactive;}
else if(this._options.avecDemiPension){lAvecTraitDebut=GParametres.debutDemiPension>this.Debut&&GParametres.debutDemiPension<this.Fin+1;lAvecTraitFin=GParametres.finDemiPension>this.Debut&&GParametres.finDemiPension<this.Fin+1&&GParametres.debutDemiPension!==GParametres.finDemiPension;lPlaceTraitDebut=GParametres.debutDemiPension;lPlaceTraitFin=GParametres.finDemiPension;lCouleurTrait=GParametres.activationDemiPension?GCouleur.grille.demiPensionActive:GCouleur.grille.demiPensionInactive;}
if(lAvecTraitDebut||lAvecTraitFin){if(GEtatUtilisateur.getModeAccessible())
lCouleurTrait=GCouleur.getCouleurAccessible(lCouleurTrait);if(lAvecTraitDebut){_dessinerTraitsHoraireGrille.call(this,{couleur:lCouleurTrait,place:lPlaceTraitDebut,afficherDoubleTrait:true});lPlacesOccupes.add(lPlaceTraitDebut);}
if(lAvecTraitFin){_dessinerTraitsHoraireGrille.call(this,{couleur:lCouleurTrait,place:lPlaceTraitFin,afficherDoubleTrait:true});lPlacesOccupes.add(lPlaceTraitFin);}}
if(this._options.avecRecreations&&this._options.recreations){this._options.recreations.each(function(aPlace){if(!lPlacesOccupes.contains(aPlace))
_dessinerTraitsHoraireGrille.call(this,{couleur:GCouleur.grille.recreations,place:aPlace,afficherDoubleTrait:true});},this);}}
ObjetGrille.prototype.GetDateDeColonne=function(aColonne){return this._parametresGrille.date?this._parametresGrille.date:this._parametresGrille.numeroSemaine?IE.Cycles.jourCycleEnDate(this.getNumeroJourDeColonne(aColonne),this._parametresGrille.numeroSemaine):null;};ObjetGrille.prototype.getJourAnneeDeColonne=function(aColonne){return GDate.getNbrJoursEntreDeuxDates(this.GetDateDeColonne(aColonne),GParametres.dateDebutPremierCycle);};ObjetGrille.prototype.getFormatTitreColonnes=function(aNombreColonnes,aLargeur){if(this._options.genreAffichageDate!==EGenreAffichageGrilleDate.AvecDateEtJour){return null;}
var lLibelle,LDate;for(var i=0;i<aNombreColonnes;i++){LDate=this.GetDateDeColonne(i);lLibelle=GDate.FormatDate(LDate,'%JJJ %JJ %MMM');if(GChaine.GetLongueurChaineDansDiv(lLibelle,10,true)+4>aLargeur)
return'petit';}};ObjetGrille.prototype.ComposeDate=function(I,ALargeur,aFormatColonnes){var LDate=this.GetDateDeColonne(I);var lNumeroSemaine=IE.Cycles.cycleDeLaDate(LDate);var lLibelle='';ALargeur=this._options.genreAffichageDate===EGenreAffichageGrilleDate.AvecDateEtJour?Math.min(110,this.largeurCellule):65;var T=[];T.push('<table id="'+this.IdDatePrefixe+I+'" style="margin-left:auto; margin-right:auto;',GStyle.composeCouleurTexte(this._options.couleurLibellesColonnes),'" class="Texte10 NoWrap" width="'+ALargeur+'px;" border="0" cellspacing="0" cellpadding="0"><tr>');if((this._options.genreAffichageDate===EGenreAffichageGrilleDate.SansDate)||(LDate===null||LDate===undefined))
T.push('<font style="font-size:1px">&nbsp;</font>');else if((this._options.genreAffichageDate===EGenreAffichageGrilleDate.AvecFrequence)){lLibelle=GTraductions.getValeur('Semaine')+'&nbsp;'+(this._options.frequences[lNumeroSemaine].libelle?this._options.frequences[lNumeroSemaine].libelle:lNumeroSemaine);}
if(MethodesTableau.existe(this._options.genreAffichageDate,[EGenreAffichageGrilleDate.AvecDate,EGenreAffichageGrilleDate.AvecDateEtJour,EGenreAffichageGrilleDate.AvecFrequence])){var lLibelleSup='';if(this.joursStage&&this.joursStage.contains(this.getJourAnneeDeColonne(I))){this._colonneesAvecStage[I]=true;lLibelleSup=' ['+GTraductions.getValeur('EDT.EnStage')+']';}
else if(this._parametresGrille.utilitaireAbsences&&this._parametresGrille.utilitaireAbsences.getExclusionsEleveDeJourCycle(this.getNumeroJourDeColonne(I))){lLibelleSup=' ['+GTraductions.getValeur('EDT.Exclu')+']';}
if(this._options.genreAffichageDate===EGenreAffichageGrilleDate.AvecDateEtJour){lLibelle=aFormatColonnes==='petit'?lLibelle=GDate.FormatDate(LDate,'%JJ/%MM'):GDate.FormatDate(LDate,'%JJJ %JJ %MMM');if(aFormatColonnes!=='petit'&&lLibelleSup&&GChaine.GetLongueurChaineDansDiv(lLibelle+lLibelleSup,10,true)+4>ALargeur)
lLibelle=GDate.FormatDate(LDate,'%JJ/%MM');}
else if(this._options.genreAffichageDate!==EGenreAffichageGrilleDate.AvecFrequence){lLibelle=GDate.FormatDate(LDate,'%JJ/%MM');}
T.push('<td class="AlignementMilieu Insecable">'+lLibelle+lLibelleSup+'</td>');}
T.push('</tr></table>');return T.join('');};ObjetGrille.prototype.composeColonne=function(aNumeroColonne){var H=[];if(this._parametresGrille.utilitaireAbsences){H.push(this._parametresGrille.utilitaireAbsences.construireExclusions(this.getNumeroJourDeColonne(aNumeroColonne),this._options.placeDemiJournee,this.hauteurCellule));}
H.push(this.inherited('composeColonne',aNumeroColonne));return H.join('');};ObjetGrille.prototype.setNavigation=function(aNavigation){this.inherited('setNavigation',aNavigation);if(aNavigation)
this.SelectionnerGrille();};ObjetGrille.prototype.getStyleEmploiDuTemps=function(){return'';};ObjetGrille.prototype._composeContenuAbolueDansGrille=function(){var T=[];if(this._parametresGrille.modeDiagnostic&&this._parametresGrille.diagnosticDeCours){T.push(_construireGabarit.call(this));}
T.push('<div tabindex="-1" id="'+this.IdListeElements+'"></div>');if(this._options.estGrilleAbsence&&this._parametresGrille.utilitaireAbsences)
T.push('<div tabindex="-1" id="'+this.idAbsences+'"></div>');return T.join('');};ObjetGrille.prototype.getContenuCellule=function(aPlaceGrille){var T=[];var lPosition=this.getPositionDePlace(aPlaceGrille),lLigne=lPosition.y,lColonne=lPosition.x,LIndiceDemiJournee=lLigne<(this._options.estGrilleAbsence?this._options.placeDemiJournee:GParametres.debutDemiPension)?EGenreDemiJours.Matin:lLigne>=(this._options.estGrilleAbsence?this._options.placeDemiJournee:GParametres.debutDemiPension)?EGenreDemiJours.ApresMidi:-1,lPlaceNonTravaillee=false,LDate=this.GetDateDeColonne(lColonne),lJour=IE.Cycles.dateEnJourCycle(LDate),lJourAnnee=this.getJourAnneeDeColonne(lColonne);if(LIndiceDemiJournee>=0){lPlaceNonTravaillee=!GParametres.DemiJourneesOuvrees[LIndiceDemiJournee].contains(lJour);}
else{if(!GParametres.DemiJourneesOuvrees[EGenreDemiJours.Matin].contains(lJour)&&!GParametres.DemiJourneesOuvrees[EGenreDemiJours.ApresMidi].contains(lJour)){lPlaceNonTravaillee=true;}}
if(lPlaceNonTravaillee||this._options.joursFeries.GetValeur(lJourAnnee)||!GDate.estDateDansAnneeScolaire(LDate)){var lStyle='background-position:'+ -(lColonne*this.largeurCellule)+'px '+ -(lLigne*this.hauteurCellule)+'px;';T.push('<div class="Table Image_IndisponibiliteEtablissement" style="position:absolute;',lStyle,'"></div>');}
if(this._parametresGrille.modeDiagnostic){var lDiagnoPlace=_getDiagnosticDePlace.bind(this)(aPlaceGrille);if(!lDiagnoPlace){T.push(this._construireCarrePlaceLibre(true));}
else{var lAvecGabaritLibre=false;for(var lPlace=aPlaceGrille-1;lPlace>=0&&aPlaceGrille-lPlace<=this._parametresGrille.dureeGabarit-1;lPlace--)
if(!_getDiagnosticDePlace.bind(this)(lPlace)){lAvecGabaritLibre=true;break;}
if(lAvecGabaritLibre){T.push(this._construireCarrePlaceLibre(false));}}}
return T.join('');};function _getImageBackgroundSurCellule(aLigne,aColonne,aPlaceGrille){var lJourAnnee=this.getJourAnneeDeColonne(aColonne),LDate=this.GetDateDeColonne(aColonne);if(this._options.joursFeries.GetValeur(lJourAnnee)||!GDate.estDateDansAnneeScolaire(LDate)){return GParametres.langue.toLowerCase()==='it'?'Image_FerieInclinee_EDT_IT':'Image_FerieInclinee_EDT';}
return'';}
ObjetGrille.prototype.getClasseSupplementaireDeCellule=function(aLigne,aColonne,aPlaceGrille){return _getImageBackgroundSurCellule.bind(this)(aLigne,aColonne,aPlaceGrille);};ObjetGrille.prototype.getStyleSupplementaireDeCellule=function(aLigne,aColonne,aPlaceGrille){if(_getImageBackgroundSurCellule.bind(this)(aLigne,aColonne,aPlaceGrille)){var lStyle='background-position:0px '+ -((aLigne-this.Debut)*this.hauteurCellule)+'px;';if(IE.Support.avecBackgroundSize){lStyle+='background-size:'+this.largeurCellule+'px '+this.largeurCellule+'px;';}
return lStyle;}
return'';};function _getDiagnosticDePlace(aPlace){return this._parametresGrille.diagnosticPlaces&&this._parametresGrille.diagnosticPlaces[aPlace]?this._parametresGrille.diagnosticPlaces[aPlace].diag:null;}
ObjetGrille.prototype._construireCarrePlaceLibre=function(aLarge,aContenu){var lPourcentages={hauteur:aLarge?70:65,largeur:aLarge?90:80};var lHauteurMoitieCellule=(this.hauteurCellule-1)/2,lLargeurMoitieCellule=(this.largeurCellule-1)/2;return'<div style="position:absolute;'+GStyle.composeCouleurFond(GCouleur.grilleOccupation.placeLibre)+'width: '+lPourcentages.largeur+'%;'+'height:'+lPourcentages.hauteur+'%;'+'top:'+(lHauteurMoitieCellule-Math.round(lHauteurMoitieCellule*lPourcentages.hauteur/100))+'px;'+'left:'+(lLargeurMoitieCellule-Math.round(lLargeurMoitieCellule*lPourcentages.largeur/100))+'px;">'+(aContenu?aContenu:'')+'</div>';};function _construireCarrePlaceLibre(aPourcentageHauteur,aPourcentageLargeur){var lHauteurMoitieCellule=(this.hauteurCellule-1)/2,lLargeurMoitieCellule=(this.largeurCellule-1)/2;return'<div style="position:absolute;'+GStyle.composeCouleurFond(GCouleur.grilleOccupation.placeLibre)+'width: '+aPourcentageLargeur+'%;'+'height:'+aPourcentageHauteur+'%;'+'top:'+(lHauteurMoitieCellule-Math.round(lHauteurMoitieCellule*aPourcentageHauteur/100))+'px;'+'left:'+(lLargeurMoitieCellule-Math.round(lLargeurMoitieCellule*aPourcentageLargeur/100))+'px;"></div>';}
ObjetGrille.prototype.getCouleurFondDePlaceEDT=function(aPlaceEdt){if(this._options.estGrilleAbsence&&this._parametresGrille.utilitaireAbsences&&this._parametresGrille.utilitaireAbsences.existeAbsenceDansPlace(aPlaceEdt)){return this._parametresGrille.utilitaireAbsences.couleurs.absence;}
if(this._parametresGrille.modeDiagnostic)
return GCouleur.grilleOccupation.fond;return null;};function _surContextMenuCours(aIndiceCours){var lCours=this.ListeCours.GetElement(aIndiceCours);var lParam={genre:EGenreEvenementEDT.SurMenuContextuel,id:this.GetIdElement(aIndiceCours),cours:lCours};if(lCours.coursMultiple){this.callback.appel(lParam);return;}
else{var lParamsRetourSurNavigation={indice:aIndiceCours,avecActualisationWAI:false,selectionNonManuelle:false,action:function(){if(this.NumeroElement> -1){var LDate=IE.Cycles.jourCycleEnDate(this.getNumeroJourDeColonne(this.getNumeroJourDeColonne(this.NumeroColonne)),this._parametresGrille.numeroSemaine);lParam.date=LDate;this.callback.appel(lParam);}}};if(this.ControleNavigation&&this.Pere&&this.Pere.EvenementSurNavigation)
this.Pere.EvenementSurNavigation(this,lParamsRetourSurNavigation);else this.RetourSurNavigation(lParamsRetourSurNavigation);}}
ObjetGrille.prototype.ComposeListeCours=function(){var T=[];for(var I=0;I<this.NbrCours;I++){var lCours=this.ListeCours.GetElement(I);var LClass='EmploiDuTemps_Element';if(this._options.avecSelectionCours){if(this._options.avecMenuContextuel){LClass+=' Curseur_ClickDroit';}
else if(this._options.avecSelection&&lCours&&(lCours.avecSelection!==false)){LClass+=' AvecMain';}
else{LClass+=' SansMain';}}
if(this._options.avecDrop&&lCours&&lCours.utilisable){LClass+=' '+this.classDroppable;}
T.push('<div id="'+this.GetIdElement(I)+'" class="'+LClass+'" style="overflow:hidden; ',(lCours.coursMultiple?'z-index:2;':''),(lCours.estCoursMS?'visibility:hidden;':''),'"',' ie-event="mouseup-contextmenu',(this._options.avecMouseInOutCours?'-mouseenter-mouseleave':''),'->eventCours(',I,')" ie-hint="getTitleElement('+I+')">');T.push(this.ComposeCours(I));T.push('</div>');}
GHtml.setHtml(this.IdListeElements,T.join(''),{controleur:this.controleur,ignorerScroll:true});};ObjetGrille.prototype.CalculerDebutEtFin=function(){this.inherited('CalculerDebutEtFin');if(this.NbrCours){var I,LCours;if(this._options.afficherDebutSelonCours){this.Debut=this._options.nombreLignes-1;for(I=0;I<this.NbrCours;I++){LCours=this.ListeCours.GetElement(I);if((LCours.Debut%this._options.nombreLignes)<this.Debut)
this.Debut=LCours.Debut%this._options.nombreLignes;}}
if(this._options.afficherFinSelonCours){this.Fin=0;for(I=0;I<this.NbrCours;I++){LCours=this.ListeCours.GetElement(I);if((LCours.Fin%this._options.nombreLignes)>this.Fin)
this.Fin=LCours.Fin%this._options.nombreLignes;}}}};ObjetGrille.prototype.GetPositionX=function(ANumeroElement){return Math.floor((ANumeroElement===null||ANumeroElement===undefined?this.NumeroElement:ANumeroElement)/this._options.nombreLignes);};ObjetGrille.prototype.GetPositionY=function(ANumeroElement){return(ANumeroElement===null||ANumeroElement===undefined?this.NumeroElement:ANumeroElement)%this._options.nombreLignes;};ObjetGrille.prototype.GetIdElement=function(APos,aPourCadre){return this.IdElementPrefixe+'_'+(APos===null||APos===undefined?this.NumeroElement:APos)+(aPourCadre?'Cadre':'');};ObjetGrille.prototype.GetIdContenu=function(I){return this.IdContenuPrefixe+I;};ObjetGrille.prototype.GetIdStatut=function(I){return this.IdStatutPrefixe+I;};ObjetGrille.prototype.GetIdElementSlider=function(APos){return this.IdElementCadreSlider+(APos===null||APos===undefined?this.NumeroElement:APos);};ObjetGrille.prototype.SurPostResize=function(){if(this.EnAffichage){var lNumElement=this.NumeroElement;this.inherited('SurPostResize');if(lNumElement> -1)
this.SelectionnerElement(lNumElement);}};(function(){ObjetGrille.prototype._actualiserCoursMultiple=function(aIndice,aCours,aHeight){var lAvecFleches=false;var lLargeurSlide,lNbCouloirs;lNbCouloirs=Math.min(aCours.listeCours.nbCouloirs,Math.floor(aHeight/this._options.couloir.largeurSlideMin));if((lNbCouloirs<3)&&(lNbCouloirs<aCours.listeCours.nbCouloirs)){lNbCouloirs=Math.min(aCours.listeCours.nbCouloirs,Math.floor(aHeight/this._options.couloir.largeurSlideMinExtreme));lLargeurSlide=Math.floor(aHeight/lNbCouloirs);}
else if(lNbCouloirs<aCours.listeCours.nbCouloirs){lAvecFleches=true;if(Math.floor(aHeight/this._options.couloir.largeurSlideMax)>3){lNbCouloirs=Math.floor(aHeight/this._options.couloir.largeurSlideMax);}
lLargeurSlide=Math.floor(aHeight/lNbCouloirs);}
else{lLargeurSlide=Math.floor(aHeight/lNbCouloirs);}
lLargeurSlide=Math.min(Math.ceil(this.largeurCellule/4)-1,lLargeurSlide);lLargeurSlide=Math.min(lLargeurSlide,this._options.couloir.largeurSlideMax);GPosition.setWidth(this.GetIdElementSlider(aIndice),lLargeurSlide);_composeSliderCoursMultiple.bind(this)(GHtml.getElement(this.GetIdElementSlider(aIndice)),aIndice,aCours,lLargeurSlide,lNbCouloirs,lAvecFleches);if(this._options.estGrilleAbsence&&this._parametresGrille.utilitaireAbsences){this._parametresGrille.utilitaireAbsences.traiterCoursMultiple(aCours,lLargeurSlide);}
for(var I=0;I<aCours.listeCours.GetNbrElements();I++){var lCoursSuperpose=aCours.listeCours.GetElement(I);var lIndiceCours=MethodesTableau.chercher(lCoursSuperpose.coursOrigine,this.ListeCours.ListeElements);this.ListeCours.GetElement(lIndiceCours).Visible=(lCoursSuperpose.numeroCouloir===aCours.numeroCouloir);_actualiserCours.bind(this)(lIndiceCours,this.ListeCours.GetElement(lIndiceCours),true,lLargeurSlide+(IE.Support.bordureExterneDIV?0:1));}};function _composeSliderCoursMultiple(aParentDOM,aIndice,aCours,aTaille,aNbCouloirsVisible,aAvecFleches){var lNbCouloirs=aCours.listeCours.nbCouloirs;GHtml.setHtml(aParentDOM,'',true);var i;if(!aAvecFleches){for(i=0;i<lNbCouloirs;i++){_composeSelecteurCoursMultiple.bind(this)(aParentDOM,aIndice,aCours,i,aTaille);}}
else{if(!aCours.numeroDefilementCouloir) aCours.numeroDefilementCouloir=0;_composeSelecteurCoursMultiple.bind(this)(aParentDOM,aIndice,aCours,this._options.couloir.const_valeurCouloirMoins,aTaille);var lInc=0;i=aCours.numeroDefilementCouloir;while(lInc<aNbCouloirsVisible-2){if(i>=lNbCouloirs) i=0;_composeSelecteurCoursMultiple.bind(this)(aParentDOM,aIndice,aCours,i,aTaille);lInc++;i++;}
_composeSelecteurCoursMultiple.bind(this)(aParentDOM,aIndice,aCours,this._options.couloir.const_valeurCouloirPlus,aTaille);}}
function _getNbCoursDeCouloir(aCoursMultiple,aNumeroCouloir){var lResult=0;for(var i=0;i<aCoursMultiple.listeCours.GetNbrElements();i++){var lCours=aCoursMultiple.listeCours.GetElement(i);if(lCours.numeroCouloir===aNumeroCouloir)
lResult++;}
return lResult;}
function _selecteurCours(event){var lData=event.data;if(GNavigateur.BoutonSouris===EGenreBoutonSouris.Droite){return;}
event.stopPropagation();var lCours=lData.instance.ListeCours.GetElement(lData.indice);if(lData.numeroCouloir===lData.instance._options.couloir.const_valeurCouloirMoins){lCours.numeroDefilementCouloir-=1;if(lCours.numeroDefilementCouloir<0)
lCours.numeroDefilementCouloir=lCours.listeCours.nbCouloirs-1;}
else if(lData.numeroCouloir===lData.instance._options.couloir.const_valeurCouloirPlus){lCours.numeroDefilementCouloir+=1;if(lCours.numeroDefilementCouloir>=lCours.listeCours.nbCouloirs)
lCours.numeroDefilementCouloir=0;}
else lCours.numeroCouloir=lData.numeroCouloir;lData.instance.ActualiserListeCours(lData.indice);}
function _selecteurMouseSurvol(aEnSurvol,aSelectionne){var lElement=$(this)[0];lElement.style.fontSize=parseInt(lElement.style.fontSize)+(aEnSurvol?+1:-1);var lCouleurFond=aSelectionne?GCouleur.grilleSlider.fondBoutonSelectionne:aEnSurvol?GCouleur.grilleSlider.fondBoutonSurvol:GCouleur.grilleSlider.fondBouton;GStyle.setCouleurFond(lElement,lCouleurFond);}
function _composeSelecteurCoursMultiple(aParentDOM,aIndiceCoursMultiple,aCoursMultiple,aNumeroCouloir,aTaille){var lSelectionne=(aNumeroCouloir===aCoursMultiple.numeroCouloir);var lMarge=IE.Support.bordureExterneDIV?0:1;var lTailleCellule=aTaille-1-lMarge;var lTitle=(aNumeroCouloir!==this._options.couloir.const_valeurCouloirMoins)&&(aNumeroCouloir!==this._options.couloir.const_valeurCouloirPlus)?'title="'+_getNbCoursDeCouloir(aCoursMultiple,aNumeroCouloir)+' / '+aCoursMultiple.listeCours.GetNbrElements()+' '+GTraductions.getValeur('EDT.Cours')+'" ':'';var lDiv=GHtml.htmlToDOM('<div class="Texte AlignementMilieu AvecMain Gras" '+'style="'+GStyle.composeHeight(lTailleCellule)+
GStyle.composeWidth(lTailleCellule)+
GStyle.composeCouleur(lSelectionne?GCouleur.grilleSlider.fondBoutonSelectionne:GCouleur.grilleSlider.fondBouton,GCouleur.noir)+
GStyle.composeCouleurBordure(lSelectionne?GCouleur.grilleSlider.boutonBordureClaire:GCouleur.grilleSlider.boutonBordureFonce,1,EGenreBordure.bas+EGenreBordure.droite)+
GStyle.composeCouleurBordure(lSelectionne?GCouleur.grilleSlider.boutonBordureFonce:GCouleur.grilleSlider.boutonBordureClaire,1,EGenreBordure.haut+EGenreBordure.gauche)+'font-size:'+(aTaille-5)+'px;'+'line-height:'+(aTaille-2)+'px;'+'" '+
lTitle+'>'+'</div>');GHtml.insererElementDOM(aParentDOM,lDiv);$(lDiv).mouseup({instance:this,indice:aIndiceCoursMultiple,numeroCouloir:aNumeroCouloir},_selecteurCours);$(lDiv).hover(_selecteurMouseSurvol.bind(lDiv,true,lSelectionne),_selecteurMouseSurvol.bind(lDiv,false,lSelectionne));if((aNumeroCouloir!==this._options.couloir.const_valeurCouloirMoins)&&(aNumeroCouloir!==this._options.couloir.const_valeurCouloirPlus))
GHtml.setHtml(lDiv,aNumeroCouloir+1,true);else GHtml.setHtml(lDiv,'<div class="'+(aNumeroCouloir===this._options.couloir.const_valeurCouloirMoins?'Image_FlecheVersLeHaut':'Image_FlecheVersLeBas')+'" '+'style="height:100%; width:100%;position:relative; left: -1px;"></div>',true);}
function _actualiserContenuCours(I,AWidth,AHeight){var LCours=this.ListeCours.GetElement(I);var LMarge=2;AWidth-=2*LMarge+1;AHeight-=2*LMarge;var lHeightLine=GChaine.GetHauteurPolice(10);var lHtml=[],lHtmlAbsence=[],lAvecContenuAbsence=false;if(this._options.estGrilleAbsence&&this._parametresGrille.utilitaireAbsences){this._parametresGrille.utilitaireAbsences.ajouterAbsencesDansCours(this,LCours,lHtmlAbsence);lAvecContenuAbsence=lHtmlAbsence.length>0;}
if(LCours.Statut){var H=[];if(lAvecContenuAbsence){H.push(lHtmlAbsence.join(''));lHtmlAbsence=[];}
H.push('<div class="NoWrap" style="overflow:hidden;margin:0px 2px;',GStyle.composeWidth(AWidth-4-4),GStyle.composeCouleurFond(GCouleur.blanc),(lAvecContenuAbsence?'position:relative;':''),'">',LCours.Statut,'</div>');GHtml.setHtml(this.GetIdStatut(I),H.join(''),true);if(AHeight-lHeightLine-4<=0){GPosition.setHeight(this.GetIdStatut(I),AHeight);return;}
else GPosition.setHeight(this.GetIdStatut(I),lHeightLine);AHeight-=lHeightLine+4;}
else if(lAvecContenuAbsence){lHtml.push(lHtmlAbsence.join(''));}
var LHeight=0;LCours.existeContenuMasque=false;for(var J=0,lNb=LCours.ListeContenus.GetNbrElements();J<lNb;J++){var LContenu=LCours.ListeContenus.GetElement(J);if(LContenu.GetLibelle().length&&(LContenu.Visible!==false)&&(LContenu.GetGenre()!==EGenreRessource.Service)){if(LHeight+lHeightLine>=AHeight){if(J>0){LCours.existeContenuMasque=true;break;}
lHeightLine=AHeight-LHeight;if(lHeightLine<3){LCours.existeContenuMasque=true;break;}}
LHeight+=lHeightLine;var lWidth=LContenu.listeImages?AWidth-16*LContenu.listeImages.GetNbrElements():AWidth;var LClass=LContenu.Class?LContenu.Class:'Texte10 AlignementMilieu'+(LContenu.Gras?' Gras':'');var LStyle=(this._options.estGrilleAbsence?'':'color:'+LCours.CouleurTexte+';')+GStyle.composeHeight(lHeightLine)+'overflow:hidden;'+GStyle.composeWidth(AWidth);if(lAvecContenuAbsence){LStyle+='position:relative;';}
if(LContenu.Longueur>lWidth)
LCours.existeContenuMasque=true;lHtml.push('<div class="'+LClass+'" style="'+LStyle+'"','>');if(LContenu.listeImages){lHtml.push('<div class="AvecMain InlineBlock" onmouseup="'+this.Nom+'.surContenu (event, '+I+', '+J+');">');for(var iImage=0;iImage<LContenu.listeImages.GetNbrElements();iImage++){var lImage=LContenu.listeImages.GetElement(iImage);var lEvenement=lImage.GetGenre()>=0?' ie-event="mouseup->eventImageCours ('+I+', '+lImage.GetGenre()+')"':'';lTitle=lImage.title?' title="'+lImage.title+'"':'';lHtml.push('<div style="float: left; width: 16px;" '+lTitle+lEvenement+'>'+GImage.compose('Image_'+lImage.GetLibelle())+'</div>');}
var lLibelle=GChaine.GetChaine(LContenu.GetLibelle(),10,true,lWidth);lHtml.push('<div style="float: left;" class="'+LClass+'">'+GChaine.toTexte(lLibelle)+'</div>');lHtml.push('</div>');}
else lHtml.push(GChaine.toTexte(LContenu.GetLibelle()));lHtml.push('</div>');}}
if(this._options.estGrilleAbsence){var lAvecDispense=LCours.dispenseEleve;if(this._parametresGrille.utilitaireAbsences&&this._parametresGrille.utilitaireAbsences.cours&&this._parametresGrille.utilitaireAbsences.cours.GetNumero()===LCours.GetNumero()){lAvecDispense=this._parametresGrille.utilitaireAbsences.cours.avecDispense;}
if(lAvecDispense)
lHtml.push('<div style="position:absolute;z-index:2;left:0;right:0;bottom:1px;','" class="AlignemetnMilieu">','<div class="Image_StickerDispense InlineBlock"></div>','</div>');}
GHtml.setHtml(this.GetIdContenu(I),lHtml.join(''),{controleur:this.controleur,ignorerScroll:true});GHtml.setHtml(this.IdImages+'_'+I,this.ComposeCours_Images(I),{controleur:this.controleur,ignorerScroll:true});}
function _actualiserCours(aIndice,aCours,aActualisationCoursSuperpose,aModificateurTaille){if(!aActualisationCoursSuperpose&&aCours.estCoursMS)
return;var LCours=aCours;var lPosition=this.getPositionDePlace(LCours.Debut);var LAfficherElement=LCours.Visible!==false&&this._options.colonnesVisibles.contains(Math.floor(LCours.Debut/this._options.nombreLignes));var LIdElement=this.GetIdElement(aIndice);if(LAfficherElement){var LLeft=lPosition.x*this.largeurCellule-1,LTop=(this.hauteurCellule*((LCours.Debut-this.Debut)%this._options.nombreLignes))-1;if(this._colonneesAvecStage[Math.floor((LCours.Debut-this.Debut)/this._options.nombreLignes)]){GStyle.setOpacity(this.GetIdElement(aIndice),this._options.opacitePourCoursEnStage,true);}
var LWidth=this.largeurCellule+(IE.Support.bordureExterneDIV?1:-1);var LHeight=this.hauteurCellule*(LCours.Fin-LCours.Debut+1)+(IE.Support.bordureExterneDIV?1:-1);if(aCours.estCoursMS&&aModificateurTaille){LWidth-=aModificateurTaille;LLeft+=aModificateurTaille;}
else if(aCours.coursMultiple){this._actualiserCoursMultiple(aIndice,aCours,LHeight);}
GPosition.setPosition(LIdElement,LLeft,LTop);GPosition.setTaille(LIdElement,LWidth,LHeight);_actualiserContenuCours.bind(this)(aIndice,LWidth,LHeight);}
GStyle.setVisible(LIdElement,LAfficherElement);}
ObjetGrille.prototype.ActualiserListeCours=function(ANumeroElement){if(ANumeroElement>=0)
_actualiserCours.bind(this)(ANumeroElement,this.ListeCours.GetElement(ANumeroElement),false);else for(var I=0;I<this.NbrCours;I++){_actualiserCours.bind(this)(I,this.ListeCours.GetElement(I),false);}};})();ObjetGrille.prototype.SelectionnerColonne=function(ANumeroColonne,AAvecWAI){if(this._options.colonnesVisibles.contains(ANumeroColonne)){if(this.NumeroColonne> -1)
GHtml.delClass(this.IdDatePrefixe+this.NumeroColonne,'Gras');this.NumeroColonne=ANumeroColonne;GHtml.addClass(this.IdDatePrefixe+this.NumeroColonne,'Gras');this.DeselectionnerElement();if(AAvecWAI)
this.actualiserWAI(GDate.FormatDate(this.GetDateDeColonne(this.NumeroColonne),'%JJJJ %J %MMMM'));}};ObjetGrille.prototype._getIndiceCoursMultipleDeCours=function(aCours){var lNbCours=this.ListeCours.GetNbrElements();for(var i=lNbCours-1;i>=0;i--){var lCoursMultiple=this.ListeCours.GetElement(i);if(lCoursMultiple.listeCours)
for(var j=0,lNb=lCoursMultiple.listeCours.GetNbrElements();j<lNb;j++)
if(lCoursMultiple.listeCours.GetElementParNumeroEtGenre(aCours.GetNumero()))
return i;}
return-1;};ObjetGrille.prototype.avecSelectionElement=function(aNumeroElement){if(this._options.avecSelection)
return true;if((GNavigateur.BoutonSouris===EGenreBoutonSouris.Droite||GNavigateur.IsToucheMenuContextuel())&&this._options.avecMenuContextuel)
return true;return false;};ObjetGrille.prototype.getCoursSelectionne=function(){return this.cours;};ObjetGrille.prototype.SelectionnerElement=function(ANumeroElement,aSelectionNonManuelle,aAvecActualisationWAI){if(this.avecSelectionElement(ANumeroElement)){if(aSelectionNonManuelle)
this.DeselectionnerElement();this.NumeroElement=ANumeroElement;this.NumeroArticle=this.ListeCours.GetNumero(this.NumeroElement);this.cours=this.ListeCours.GetElement(this.NumeroElement);GHtml.setClass(this.GetIdElement(null,true),this._getClassCours(this.cours,true));if(aSelectionNonManuelle){var lCours=this.ListeCours.GetElement(this.NumeroElement);if(lCours.estCoursMS&&lCours.coursCopie){var lIndiceCoursMultiple=this._getIndiceCoursMultipleDeCours(lCours);if(lIndiceCoursMultiple>=0){var lCoursMultiple=this.ListeCours.GetElement(lIndiceCoursMultiple);var lCoursGrille_MS=lCoursMultiple.listeCours.GetElementParNumeroEtGenre(lCours.GetNumero());if(lCoursMultiple.numeroCouloir!==lCoursGrille_MS.numeroCouloir){lCoursMultiple.numeroCouloir=lCoursGrille_MS.numeroCouloir;this.ActualiserListeCours(lIndiceCoursMultiple);}}}}
if(aAvecActualisationWAI)
this.actualiserWAI(_composeDetailWAI(this.cours));}};function _composeDetailWAI(aCours){var lHtml=[];if(aCours.coursMultiple){for(var i=0;i<aCours.listeCours.GetNbrElements();i++){var lCours=aCours.listeCours.GetElement(i);lHtml.push(_composeDetailCoursWAI(lCours));lHtml.push(',');}} else lHtml.push(_composeDetailCoursWAI(aCours));return lHtml.join(' ');}
function _composeDetailCoursWAI(aCours){var lHtml=[];lHtml.push(GChaine.Insecable(GDate.FormatDate(aCours.DateDuCours,GTraductions.getValeur('EDT.WAI.CoursDe')+' %J %MMMM %xh '+GTraductions.getValeur('Heures').toLowerCase()+' %mm')));if(aCours.ListeContenus)
for(var J=0;J<aCours.ListeContenus.GetNbrElements();J++){var lContenu=aCours.ListeContenus.GetElement(J);if(lContenu.GetLibelle().length&&(lContenu.Visible!==false)&&(lContenu.GetGenre()!==EGenreRessource.Service)){if(lContenu.listeImages){for(var K=0;K<lContenu.listeImages.GetNbrElements();K++){var lImage=lContenu.listeImages.GetElement(K);lHtml.push(lImage.title);}
lHtml.push(GChaine.toTexte(lContenu.GetLibelle()));}
else lHtml.push(GChaine.toTexte(lContenu.GetLibelle()));}}
if(aCours.memo) lHtml.push(GTraductions.getValeur('EDT.WAI.memo')+' : '+aCours.memo);if(aCours.AvecCdT){if(aCours.AvecCdTPublie)
lHtml.push(GTraductions.getValeur('EDT.WAI.avecCDTpublie'));else lHtml.push(GTraductions.getValeur('EDT.WAI.avecCDT'));}
return lHtml.join('. ');}
ObjetGrille.prototype.DeselectionnerElement=function(){if(this.avecSelectionElement(this.NumeroElement)){if(this.NumeroElement> -1){GHtml.setClass(this.GetIdElement(null,true),this._getClassCours(this.cours,false));this.NumeroElement= -1;}}};ObjetGrille.prototype.evenementNavigation=function(){if(GNavigateur.IsToucheSelection()||GNavigateur.IsToucheMenuContextuel())
this.DeclencherEvenement();else if(GNavigateur.IsToucheFlecheDroite()||GNavigateur.IsToucheFlecheGauche())
this.EvenementNavigationColonne();else if(GNavigateur.IsToucheFlecheBas()||GNavigateur.IsToucheFlecheHaut()){this.EvenementNavigationElement();this.Pere.SetEtatSaisie(false);}};ObjetGrille.prototype.EvenementNavigationColonne=function(){var LSens=GNavigateur.IsToucheFlecheDroite()?1:-1;this.SelectionnerColonne(this.NumeroColonne+LSens,true);};ObjetGrille.prototype.construireArrayCoursPourNavigation=function(){var lPosX=0;var I,J,lNbCol=this._options.colonnesVisibles.count();var T=new Array(lNbCol);for(lPosX=0;lPosX<lNbCol;lPosX++)
T[lPosX]=new ObjetListeElements();for(I=0;I<this.NbrCours;I++){var lElement=this.ListeCours.GetElement(I);lPosX=this.GetPositionX(lElement.Debut);if(lPosX>=0&&lPosX<lNbCol){if(lElement.Visible!==false&&!lElement.estCoursMS)
T[lPosX].AddElement(lElement);}}
for(I=0;I<T.length;I++){T[I].setTri([ObjetTri.init('Debut'),ObjetTri.init('Fin')]);T[I].trier();for(var lICours=0;lICours<T[I].GetNbrElements();lICours++){var lCours=T[I].GetElement(lICours);if(lCours.coursMultiple){for(J=lCours.listeCours.GetNbrElements()-1;J>=0 ;J--){if(J===lCours.listeCours.GetNbrElements()-1)
T[I].AddElement(lCours.listeCours.GetElement(J),lICours);else T[I].insererElement(lCours.listeCours.GetElement(J),lICours);}}}}
return T;};ObjetGrille.prototype.EvenementNavigationElement=function(){if(this.NumeroColonne===null||this.NumeroColonne===undefined)
return;var lNumero;var I,lIndex;var T=this.arrayCoursPourNavigation?this.arrayCoursPourNavigation:this.construireArrayCoursPourNavigation();var lSens=GNavigateur.IsToucheFlecheBas()?1:-1;var lPosX=this.NumeroColonne;if(this.NumeroElement=== -1){if(T[lPosX].GetNbrElements()>0)
lNumero=T[lPosX].GetNumero(0);} else{var lCours=this.ListeCours.GetElement(this.NumeroElement);lIndex=T[lPosX].GetIndiceExisteParNumeroEtGenre(lCours.GetNumero());if(lIndex!==null&&(lIndex+lSens> -1)&&(lIndex+lSens<T[lPosX].GetNbrElements())){lIndex=(lIndex+lSens)%(T[lPosX].GetNbrElements());lNumero=T[lPosX].GetNumero(lIndex);}}
if((lNumero!==null&&lNumero!==undefined)){this.SelectionnerElementParNumero(lNumero,false,true,true);}};ObjetGrille.prototype.SelectionnerElementParIndice=function(I,AAvecEvenement,aSelectionNonManuelle,aAvecActualisationWAI){var lParamsRetourSurNavigation={indice:I,selectionNonManuelle:aSelectionNonManuelle,avecActualisationWAI:aAvecActualisationWAI};if(AAvecEvenement)
lParamsRetourSurNavigation.action=this.DeclencherEvenement;var lCours=this.ListeCours.GetElement(I);if(lCours.coursMultiple){return;}
if(this.ControleNavigation&&this.Pere&&this.Pere.EvenementSurNavigation)
this.Pere.EvenementSurNavigation(this,lParamsRetourSurNavigation);else this.RetourSurNavigation(lParamsRetourSurNavigation);return!!lCours;};ObjetGrille.prototype.RetourSurNavigation=function(aParamsRetourSurNavigation){this.SelectionnerColonne(this.GetPositionX(this.ListeCours.GetElement(aParamsRetourSurNavigation.indice).Debut),aParamsRetourSurNavigation.avecActualisationWAI);this.SelectionnerElement(aParamsRetourSurNavigation.indice,aParamsRetourSurNavigation.selectionNonManuelle,aParamsRetourSurNavigation.avecActualisationWAI);if(aParamsRetourSurNavigation.action)
aParamsRetourSurNavigation.action.call(this);};ObjetGrille.prototype.SelectionnerElementParNumero=function(ANumeroCours,aAvecEvenement,aSelectionNonManuelle,aAvecActualisationWAI){var lCours;for(var I=0;I<this.NbrCours;I++){lCours=this.ListeCours.GetElement(I);if(lCours.GetNumero()===ANumeroCours){if(lCours.Visible===false)
return false;this.SelectionnerElementParIndice(I,aAvecEvenement===null||aAvecEvenement===undefined?true:aAvecEvenement,aSelectionNonManuelle,aAvecActualisationWAI);return true;}}
return false;};ObjetGrille.prototype.surContenu=function(aEvent,aIndiceCours,aIndiceContenu){this.surEvenement(aEvent,EGenreEvenementEDT.SurContenu,aIndiceCours,aIndiceContenu,null,true);};ObjetGrille.prototype.surEvenement=function(aEvent,aGenre,aIndiceCours,aIndiceContenu,aGenreImage,aAvecSelection){if(GNavigateur.BoutonSouris===EGenreBoutonSouris.Gauche){GNavigateur.StopperEvenement(aEvent);var lCours=this.ListeCours.GetElement(aIndiceCours);var lContenu=aIndiceContenu===null||aIndiceContenu===undefined?lCours.ListeContenus.GetElement(aIndiceContenu):null;if(aAvecSelection)
this.SelectionnerElementParNumero(lCours.GetNumero(),false);var lParam={genre:aGenre,id:this.GetIdElement(aIndiceCours),cours:lCours,contenu:lContenu,genreImage:aGenreImage};this.callback.appel(lParam);}};ObjetGrille.prototype.DeclencherEvenement=function(){if(this.NumeroElement> -1){var LDate=IE.Cycles.jourCycleEnDate(this.getNumeroJourDeColonne(this.NumeroColonne),this._parametresGrille.numeroSemaine);var lParam={genre:GNavigateur.IsToucheMenuContextuel()?EGenreEvenementEDT.SurMenuContextuel:EGenreEvenementEDT.SurCours,id:this.GetIdElement(),cours:this.ListeCours.GetElement(this.NumeroElement),date:LDate};this.callback.appel(lParam);}};ObjetGrille.prototype.DupliquerCours=function(ACours,ADebut,AFin){var LCours=new ObjetElement(ACours.GetLibelle(),ACours.GetNumero(),ACours.GetGenre());LCours.Statut=ACours.Statut;LCours.CouleurFond=ACours.CouleurFond;LCours.CouleurTexte=ACours.CouleurTexte;LCours.Debut=ADebut;LCours.Fin=AFin;LCours.ListeContenus=ACours.ListeContenus;return LCours;};ObjetGrille.prototype._getClassCours=function(aCours,aEstSelectionne){return'Cours '+(aEstSelectionne?'EmploiDuTemps_AvecCadre Gras':'EmploiDuTemps_SansCadre')+' ';};ObjetGrille.prototype.ComposeCours=function(I){var LCours=this.ListeCours.GetElement(I);if(!LCours.Existe())
return'';if(LCours.coursMultiple)
return this.composeCours_MS(I);var H='',lCouleurFond=this._options.estGrilleAbsence&&this._parametresGrille.utilitaireAbsences?this._parametresGrille.utilitaireAbsences.couleurs.fondCours:LCours.CouleurFond;H+='<table id="'+this.GetIdElement(I,true)+'" class="'+this._getClassCours(LCours,false)+'"'+' style="position:relative;'+GStyle.composeCouleurFond(lCouleurFond)+'" border="0" cellspacing="0" cellpadding="0" >';if(LCours.Statut){H+='<tr><td height="10px" style="padding:2px;">'+'<div id="'+this.GetIdStatut(I)+'" style="overflow:hidden; '+GStyle.composeCouleurTexte(EGenreStatutCours.getCouleur(this.ListeCours.GetElement(I)))+';" '+'class="Texte10 Gras FondBlanc AlignementMilieu">'+'</div></td></tr>';}
H+='<tr><td id="'+this.GetIdContenu(I)+'" align="center" valign="middle">';H+='</td></tr>';H+='</table>';H+='<div id="'+this.IdImages+'_'+I+'">'+this.ComposeCours_Images(I)+'</div>' ;return H;};ObjetGrille.prototype.composeCours_MS=function(I){var lClassHachure=this._parametresGrille.modeDiagnostic?'Image_HachureCoursSuperposeDiag':'Image_HachureCoursSuperpose',lCouleurFond=this._parametresGrille.modeDiagnostic?GCouleur.grilleOccupation.fond:this._options.couleurFond;var H=[];H.push('<div class="Table Cours ',lClassHachure,'" style="'+GStyle.composeCouleurFond(lCouleurFond)+'">','<div id="'+this.GetIdElementSlider(I)+'" style="height:100%;',GStyle.composeCouleurFond(GCouleur.grilleSlider.fond),GStyle.composeCouleurBordure(GCouleur.grilleSlider.boutonBordureFonce,1,EGenreBordure.droite),'" onmouseup="',this.Nom+'._mouseUpCouloir (',I,')"></div>','</div>');return H.join('');};ObjetGrille.prototype._mouseUpCouloir=function(aIndiceCours){if(GNavigateur.BoutonSouris===EGenreBoutonSouris.Droite)
return;var lCours=this.ListeCours.GetElement(aIndiceCours);lCours.numeroCouloir+=1;if(lCours.numeroCouloir>=lCours.listeCours.nbCouloirs)
lCours.numeroCouloir=0;this.ActualiserListeCours(aIndiceCours);};function _composeCorpsImage(I,aListeImages,aCoin){var H=[];H.push('<table style="width:100%" border="0" cellspacing="0" cellpadding="0">');H.push('<tr>');if(aCoin===EGenreCoin.basD||aCoin===EGenreCoin.hautD)
H.push('<td>&nbsp;</td>');for(var J=0;J<aListeImages.GetNbrElements();J++){var lImage=aListeImages.GetElement(J);var lAvecEvenement=lImage.GetGenre()>=0,lEvenement=lAvecEvenement?' ie-event="mouseup->eventImageCours ('+I+', '+lImage.GetGenre()+');"':'',lClass=this._options.avecSelection&&lAvecEvenement?'AvecMain':'',lTitle=lImage.title?(' title="'+GChaine.toTitle(lImage.title)+'"'):'',lHint=lImage.hint?(' ie-hint="\''+GChaine.toTitle(lImage.hint)+'\'"'):'';H.push('<td class="'+lClass+'" style="',GStyle.composeWidth(lImage.width?lImage.width:20),'" '+(lImage.btnImage?'':lTitle+lHint)+lEvenement+'>'+(lImage.btnImage?'<ie-btnimage class="Image_'+lImage.GetLibelle()+'"'+lTitle+lHint+(lImage.width?' style="width:'+lImage.width+'px;':'')+'"></ie-btnimage>':GImage.compose('Image_'+lImage.GetLibelle()))+'</td>');}
if(aCoin===EGenreCoin.basG||aCoin===EGenreCoin.hautG)
H.push('<td>&nbsp;</td>');H.push('</tr>');H.push('</table>');return H.join('');}
ObjetGrille.prototype.ComposeCours_Images=function(I){var LCours=this.ListeCours.GetElement(I),lImagesCoins={},lCoin,H=[];if(LCours.ListeImages&&LCours.ListeImages.GetNbrElements())
LCours.ListeImages.parcourir(function(D){lCoin=EGenreCoin.basG;if(D.coin!==undefined)
lCoin=D.coin;if(!lImagesCoins[lCoin])
lImagesCoins[lCoin]=new ObjetListeElements();lImagesCoins[lCoin].AddElement(D);});for(lCoin in lImagesCoins)
if(lImagesCoins[lCoin]){lCoin=parseInt(lCoin);H.push('<div style="position:absolute; left:0px; top:0px; width:100%; height:100%;">');H.push('<table class="Table" border="0" cellspacing="0" cellpadding="2"><tr>','<td class="',lCoin===EGenreCoin.basG?'AlignementBas AlignementGauche':lCoin===EGenreCoin.basD?'AlignementBas AlignementDroit':lCoin===EGenreCoin.HautG?'AlignementHaut AlignementGauche':'AlignementHaut AlignementDroit','">');H.push(_composeCorpsImage.call(this,I,lImagesCoins[lCoin],lCoin));H.push('</td></tr></table>');H.push('</div>');}
return H.join('');};ObjetGrille.prototype.surDropGrilleCellule=function(aEvent,aUI,aPlace){if(this._options.callbackDropCellule)
this._options.callbackDropCellule(aPlace,aEvent,aUI);};function _construireGabarit(){var T=[];var lZIndex=parseInt(GHtml.chercherAttributReglesCss('.EmploiDuTemps_Element','zIndex'))+1;T.push('<div id="',this.idGabarit,'" class="Curseur_DoubleClick SansSelectionTexte IE_draggable" style="position:absolute; z-index:'+lZIndex+'; font-size:1px; width:auto; height:auto;',GStyle.composeCouleurBordure(GCouleur.grille.gabarit,this._options.tailleTraitGabarit,EGenreBordure.gauche+EGenreBordure.droite),'"',' title="',GTraductions.getValeur('SaisieCours.Gabarit.DblClickPlacerCours'),'">');if(IE.Support.tactile){T.push('<div class="AvecResizeVertical" style="position:absolute; width:33%;left:33%;top:-10px;border-radius:5px 5px 0 0;',GStyle.composeHeight(10),GStyle.composeCouleurFond(GCouleur.grille.gabarit),'"',' ie-event="iedown->gabarit.surEventHaut"></div>');T.push('<div class="AvecResizeVertical" style="position:absolute; width:33%;left:33%;bottom:-10px;border-radius:0 0 5px 5px;',GStyle.composeHeight(10),GStyle.composeCouleurFond(GCouleur.grille.gabarit),'"',' ie-event="iedown->gabarit.surEventBas"></div>');}
T.push('<div class="AvecResizeVertical" style="width :100%;',GStyle.composeHeight(this._options.tailleTraitGabarit),GStyle.composeCouleurFond(GCouleur.grille.gabarit),'"',' ie-event="iedown->gabarit.surEventHaut"></div>','<div id="',this.idGabaritC,'" class="Curseur_DoubleClick" style="',GStyle.composeCouleurBordure(GCouleur.blanc,1),'"',' ie-event="iedown-contextmenu-iedblclick->gabarit.surEventCentre">','<table class="Table" style="font-size:1px;',GStyle.composeCouleurFond(GCouleur.blanc),GStyle.composeOpacite(0) ,'" cellpadding="0" cellspacing="0" border="0"><tr><td>&nbsp;</td></tr></table>','</div>','<div class="AvecResizeVertical" style="width :100%;',GStyle.composeHeight(this._options.tailleTraitGabarit),GStyle.composeCouleurFond(GCouleur.grille.gabarit),'"',' ie-event="iedown->gabarit.surEventBas"></div>','</div>');return T.join('');}
function _positionnerGabarit(){var lLigne=this._parametresGrille.placeGabarit%this._options.nombreLignes,lColonne=Math.floor(this._parametresGrille.placeGabarit/this._options.nombreLignes),lLeft=lColonne*this.largeurCellule,lTop=lLigne*this.hauteurCellule;GPosition.setPosition(this.idGabarit,lLeft,lTop);var lHeight=Math.abs(this._parametresGrille.dureeGabarit*this.hauteurCellule-2*this._options.tailleTraitGabarit-1-(IE.Support.bordureExterneDIV?0:2));GPosition.setTaille(this.idGabaritC,this.largeurCellule-(IE.Support.bordureExterneDIV?1:3)-2*this._options.tailleTraitGabarit,lHeight);GPosition.setWidth(this.idGabarit,this.largeurCellule-(IE.Support.bordureExterneDIV?0:2*this._options.tailleTraitGabarit)-1);}
function _ajouterEventsGabarit(){$(document).on('iemove.ObjetGrille',{instance:this},_surMouseMove).on('ieup.ObjetGrille',{instance:this},_surMouseUp);}
function _surMouseMove(aEvent){_traiterMouseMove.bind(aEvent.data.instance)(aEvent);}
function _traiterMouseMove(aEvent){var lPosition=this.getPositionGrilleEvent(aEvent),lCommande=$('#'+this.idGabarit.escapeJQ()).data('commande'),lPositionOrigineGabarit,lPlace,lDureeGabarit;if(!lCommande){;_supprimerEventsGabarit();return;}
switch(lCommande.ordre){case EGenreOrdreGabarit.retaillageBas:lPositionOrigineGabarit=this.getPositionDePlace(this._parametresGrille.placeGabarit);lDureeGabarit=this._parametresGrille.dureeGabarit;this._parametresGrille.dureeGabarit=Math.max(1,lPosition.y-lPositionOrigineGabarit.y+1);if(lDureeGabarit!==this._parametresGrille.dureeGabarit){_positionnerGabarit.bind(this)();}
break;case EGenreOrdreGabarit.retaillageHaut:lPositionOrigineGabarit=this.getPositionDePlace(this._parametresGrille.placeGabarit);var lPositionGabarit={x:lPositionOrigineGabarit.x,y:Math.min(lPosition.y,lPositionOrigineGabarit.y+this._parametresGrille.dureeGabarit-1)};lPlace=this.getPlaceDePosition(lPositionGabarit);if(lPlace!==this._parametresGrille.placeGabarit){this._parametresGrille.placeGabarit=lPlace;this._parametresGrille.dureeGabarit=this._parametresGrille.dureeGabarit+lPositionOrigineGabarit.y-lPositionGabarit.y;_positionnerGabarit.bind(this)();}
break;case EGenreOrdreGabarit.deplacement:lPosition.y=Math.borner(lPosition.y-lCommande.decalagePlace,0,this._options.nombreLignes-this._parametresGrille.dureeGabarit);lPlace=this.getPlaceDePosition(lPosition);if(lPlace!==this._parametresGrille.placeGabarit){this._parametresGrille.placeGabarit=lPlace;_positionnerGabarit.bind(this)();if(this._parametresGrille.timeoutDeplacement){clearTimeout(this._parametresGrille.timeoutDeplacement);delete this._parametresGrille.timeoutDeplacement;}
if(this._parametresGrille.callbackDeplacementGabarit)
this._parametresGrille.timeoutDeplacement=setTimeout(this._parametresGrille.callbackDeplacementGabarit.bind(this,lPlace,this.idGabarit),this._options.delaiCallbackGabarit);}
break;default:;}}
function _surMouseUp(event){var lCommande=$('#'+event.data.instance.idGabarit.escapeJQ()).data('commande'),lInstance=event.data.instance;if(lCommande){if(lCommande.ordre!==EGenreOrdreGabarit.deplacement&&lInstance._parametresGrille.callbackModificationTailleGabarit&&(lInstance._parametresGrille.placeGabarit!==lCommande.placeOrigine||lInstance._parametresGrille.dureeGabarit!==lCommande.dureeOrigine)){lInstance._parametresGrille.callbackModificationTailleGabarit({id:lInstance.idGabarit,place:lInstance._parametresGrille.placeGabarit,duree:lInstance._parametresGrille.dureeGabarit});}
$('#'+event.data.instance.idGabarit.escapeJQ()).data('commande',null);}
_supprimerEventsGabarit();}
function _supprimerEventsGabarit(){$(document).off('iemove.ObjetGrille ieup.ObjetGrille');}})();;

MethodesObjet.heritagePrototype(ObjetGrille_MS,ObjetGrille);function ObjetGrille_MS(ANom,AIdent,APere,AEvenement){this.inheritedCreate(ANom,AIdent,APere,AEvenement);}(function(){ObjetGrille_MS.prototype.SetDonnees=function(aCoursMultiple,aNumeroSemaine){this.donneesRecus=true;this._parametresGrille={numeroSemaine:aNumeroSemaine};this.ListeCours=aCoursMultiple.listeCours;this.NbrCours=this.ListeCours.GetNbrElements();this._coursMultiple=aCoursMultiple;if(this.ListeCours.estCalcule){this._options.colonnesVisibles.clear();for(var i=0;i<this.ListeCours.nombreColonnes;i++){this._options.colonnesVisibles.add(i);}}
else{_calculerPositionnementCoursMS.bind(this)();this.ListeCours.nombreColonnes=this._options.colonnesVisibles.count();this.ListeCours.estCalcule=true;}
this.ConstruireAffichage();};ObjetGrille_MS.prototype.ComposeDate=function(I,ALargeur,AProportion){var T=[];T.push('<div class="Texte9 AlignementMilieu" style="',GStyle.composeWidth(ALargeur),GStyle.composeCouleurTexte(this._options.couleurLibellesColonnes),'">',I+1,'</div>');return T.join('');};ObjetGrille_MS.prototype._initialiserOptions=function(){this.inherited('_initialiserOptions');$.extend(this._options,{hauteurMAXPasHoraire:0,genreAffichageDate:EGenreAffichageGrilleDate.SansDate,couleurLibellesLignes:GCouleur.fenetre.texte,couleurLibellesColonnes:GCouleur.fenetre.texte,afficherDebutSelonCours:true,afficherFinSelonCours:true});};function _calculerPositionnementCoursMS(){function _unePlaceEstOccupee(aPlacesCours,aPlacesCouloir){for(var I in aPlacesCours)
if(aPlacesCouloir[I])
return true;return false;}
var lCouloirs=[];for(var I=0;I<this.NbrCours;I++)
lCouloirs[I]=[];var lNombreColonnes=1;for(I=0;I<this.NbrCours;I++){var lTabOccupation=[];var lCours=this.ListeCours.GetElement(I);for(var lPlace=lCours.placeDebutMS;lPlace<=lCours.placeFinMS;lPlace++)
lTabOccupation[lPlace]=true;var lCouloir=0;while(_unePlaceEstOccupee(lTabOccupation,lCouloirs[lCouloir])){lCouloir++;lNombreColonnes=Math.max(lNombreColonnes,lCouloir+1);}
for(var J in lTabOccupation)
if(lTabOccupation[J])
lCouloirs[lCouloir][J]=true;lCours.Debut=(lCours.placeDebutMS%this._options.nombreLignes)+lCouloir*this._options.nombreLignes;lCours.Fin=(lCours.placeFinMS%this._options.nombreLignes)+lCouloir*this._options.nombreLignes;}
this._options.colonnesVisibles.clear();for(I=0;I<lNombreColonnes;I++){this._options.colonnesVisibles.add(I);}}
ObjetGrille_MS.prototype.ActualiserWAI_SurColonne=function(){};ObjetGrille_MS.prototype.getNumeroJourDeColonne=function(aColonne){return this._coursMultiple.Debut%this._options.nombreLignes;};ObjetGrille_MS.prototype.GetDateDeColonne=function(I){return this._parametresGrille.numeroSemaine?IE.Cycles.jourCycleEnDate(this.getNumeroJourDeColonne(I),this._parametresGrille.numeroSemaine):null;};})();;
MethodesObjet.heritagePrototype(ObjetFenetre_EDT_MS,ObjetFenetre);function ObjetFenetre_EDT_MS(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.setOptionsFenetre({modale:false,avecRetaillage:true,largeur:310,largeurMin:190,hauteurMin:150});}(function(){ObjetFenetre_EDT_MS.prototype.ConstruireInstances=function(){this.identGrille=this.Add(window.ObjetGrille_MS,_evenementSurGrille.bind(this));};ObjetFenetre_EDT_MS.prototype.getInstanceGrille=function(){return this.GetInstance(this.identGrille);};function _evenementSurGrille(aParam){if(this._parametres.callbackGrille)
this._parametres.callbackGrille(aParam);}
ObjetFenetre_EDT_MS.prototype.SetDonnees=function(aParametres){var lInstanceGrille=this.GetInstance(this.identGrille);this._parametres={coursMultiple:null,numeroSemaine:GEtatUtilisateur.GetSemaineSelectionnee(),coursSelectionne:null,callbackGrille:null,hauteurCelluleGrille:lInstanceGrille._options.hauteurMINPasHoraire,optionsGrille:{}};$.extend(this._parametres,aParametres);lInstanceGrille.setOptions(this._parametres.optionsGrille);this.setOptionsFenetre({largeur:310,hauteur:300});this.SetListeBoutons([GTraductions.getValeur('Fermer')]);this.Afficher();this.SetTitre(_getTitre(this._parametres.coursMultiple,this._parametres.numeroSemaine));GPosition.declencherResize(lInstanceGrille.GetNom());lInstanceGrille.SetDonnees(this._parametres.coursMultiple,this._parametres.numeroSemaine);if(this._parametres.coursSelectionne)
lInstanceGrille.SelectionnerElementParNumero(this._parametres.coursSelectionne.GetNumero(),false,true);if(this.existeCoordonnees())
GPosition.setPosition(this.NomFenetre,this.coordonnees.left,this.coordonnees.top,true);else GPosition.centrer(this.NomFenetre,null,true);};ObjetFenetre_EDT_MS.prototype.ComposeContenu=function(){var T=[];T.push('<div id="',this.GetInstance(this.identGrille).GetNom(),'" style="position:relative;"></div>');return T.join('');};function _getTitre(aCoursMultiple,aNumeroSemaine){var LDebut=aCoursMultiple.Debut;var LFin=aCoursMultiple.Fin;var lDateDebut=GDate.placeEnDate(aNumeroSemaine,LDebut);var lDateFin=GDate.placeEnDate(aNumeroSemaine,LFin,true);return GChaine.Format(GTraductions.getValeur('EDT.coursMultipleDuDeA'),[aCoursMultiple.listeCours.GetNbrElements(),GDate.FormatDate(lDateDebut,'%JJJJ'),GDate.FormatDate(lDateDebut,'%xhh%mm'),GDate.FormatDate(lDateFin,'%xhh%mm')]);}
ObjetFenetre_EDT_MS.prototype.debutRetaillage=function(){this.inherited('debutRetaillage');GPosition.setHeight(this.GetInstance(this.identGrille).GetNom(),0);this.GetInstance(this.identGrille).SurPreResize();};ObjetFenetre_EDT_MS.prototype.finRetaillage=function(){this.inherited('finRetaillage');GPosition.declencherResize(this.GetInstance(this.identGrille).GetNom());this.GetInstance(this.identGrille).SurPostResize();};})();;
MethodesObjet.heritagePrototype(InterfaceGrilleEDT,ObjetAbstraitInterface);function InterfaceGrilleEDT(ANom,AIdent,APere,AEvenement){this.inheritedCreate(ANom,AIdent,APere,AEvenement);this._options={avecGrilleMultiple:true,minHeight:null};this._optionsGrille={avecSelection:true,avecDrop:false};this._optionsGrilleMS={couleurFond:GCouleur.fenetre.fond};}(function(){InterfaceGrilleEDT.prototype.setOptions_InterfaceGrilleEDT=function(aOptions){$.extend(this._options,aOptions);$.extend(this._optionsGrille,aOptions.optionsGrille);$.extend(this._optionsGrilleMS,aOptions.optionsGrilleMS);};InterfaceGrilleEDT.prototype.ConstruireInstances=function(){this.IdentGrille=this.Add(window.ObjetGrille ,_evenementSurCours.bind(this) ,_initialiserGrille.bind(this));if(this._options.avecGrilleMultiple){this.identFenetreCours_MS=this.addFenetre(window.ObjetFenetre_EDT_MS);this.IdentMenuContextuel=this.Add(window.ObjetMenuContextuel ,_evenementSurMenuContextuel.bind(this) ,null);}};InterfaceGrilleEDT.prototype.SetParametresGeneraux=function(){this.GenreStructure=EStructureAffichage.Autre;};InterfaceGrilleEDT.prototype.SelectionnerGrille=function(){this.GetInstance(this.IdentGrille).SelectionnerGrille();};InterfaceGrilleEDT.prototype.ConstruireStructureAffichageAutre=function(){var H=[];H.push('<div id="'+this.GetInstance(this.IdentGrille).GetNom()+'" style="height: 100%; ',(this._options.minHeight?'min-height:'+this._options.minHeight+'px;':''),'">','&nbsp;','</div>');return H.join('');};function _initialiserGrille(AInstance){AInstance.setOptions(this._optionsGrille);AInstance.SetControleNavigation(this.ControleNavigation);}
InterfaceGrilleEDT.prototype.RecupererDonnees=function(){this.inherited('RecupererDonnees');this.fermerFenetreMS();};InterfaceGrilleEDT.prototype.SetDonnees=function(aDonnees){this.fermerFenetreMS();for(var I=0;I<aDonnees.listeCours.GetNbrElements();I++){var lCours=aDonnees.listeCours.GetElement(I);this.actualisationImagesDuCours(lCours);}
this.GetInstance(this.IdentGrille).SetDonnees(aDonnees);};function _ajouterImagesCDT(aCours,aAvecEvenement,aAvecLienDS){var lImage,lAvecLienDS=false;if(aAvecLienDS&&aCours.cahierDeTextes){if(aCours.cahierDeTextes.estDevoir){lImage=new ObjetElement('IconeDS',null,aAvecEvenement?1:null);lImage.width=17;lImage.title=GTraductions.getValeur('CahierDeTexte.DevoirSurveille_Devoir');aCours.ListeImages.AddElement(lImage);lAvecLienDS=true;}
if(aCours.cahierDeTextes.estEval){lImage=new ObjetElement('IconeEvaluation',null,aAvecEvenement?1:null);lImage.width=17;lImage.title=GTraductions.getValeur('CahierDeTexte.DevoirSurveille_Evaluation');aCours.ListeImages.AddElement(lImage);lAvecLienDS=true;}}
if(!lAvecLienDS){if(aAvecEvenement){lImage=new ObjetElement(aCours.AvecVisa?'CahierDeTexte_Verrouille6Etats':'CahierDeTexte6Etats',null,1);lImage.btnImage=true;lImage.width=19;lImage.title=GTraductions.getValeur('EDT.AfficherCDT');aCours.ListeImages.AddElement(lImage);}
else{lImage=new ObjetElement(aCours.AvecVisa?'CahierDeTexte_Verrouille':'CahierDeTexte');lImage.width=17;aCours.ListeImages.AddElement(lImage);}}}
InterfaceGrilleEDT.prototype.actualisationImagesDuCours=function(aCours){if(!aCours){return;}
var lCours=aCours,lImage;lCours.avecSelection=this.avecFicheCours;lCours.ListeImages=new ObjetListeElements();if(lCours.memo){lImage=new ObjetElement('ColonnePostIt');lImage.hint=lCours.memo;lImage.width=18;lCours.ListeImages.AddElement(lImage);}
if(lCours.estGAEV)
lCours.ListeImages.AddElement(new ObjetElement('EstGAEV'));if(lCours.estCoEnseignement){lImage=new ObjetElement('CoursCoEnseignement');lImage.coin=EGenreCoin.hautG;lCours.ListeImages.AddElement(lImage);}
if(GEtatUtilisateur.GenreEspace===EGenreEspace.Professeur||GEtatUtilisateur.GenreEspace===EGenreEspace.Academie){if(lCours.AvecCdT){_ajouterImagesCDT(lCours,GEtatUtilisateur.getGenreOnglet()!==EGenreOnglet.SaisieCahierDeTextes,IE.MethodesTableau.existe(GEtatUtilisateur.getGenreOnglet(),[
EGenreOnglet.Accueil,EGenreOnglet.SaisieCahierDeTextes,EGenreOnglet.QCM_Saisie,EGenreOnglet.Affectation_Progression
]));}
if(lCours.AvecCdTPublie){lCours.ListeImages.AddElement(new ObjetElement('Publie'));}
if(lCours.avecChargeTAF)
if(GEtatUtilisateur.getGenreOnglet()===EGenreOnglet.SaisieCahierDeTextes||GEtatUtilisateur.getGenreOnglet()===EGenreOnglet.QCM_Saisie){lImage=new ObjetElement('TravailDonnePourCours',null,2);lImage.title=GTraductions.getValeur('CahierDeTexte.TravailPourCeCours');lImage.btnImage=true;lImage.width=18;lImage.coin=EGenreCoin.basD;lCours.ListeImages.AddElement(lImage);}} else{if(lCours.AvecCdTPublie||lCours.avecTafPublie){if(GEtatUtilisateur.getGenreOnglet()===EGenreOnglet.CahierDeTextesClasse)
lCours.ListeImages.AddElement(new ObjetElement('Publie'));}
if(lCours.cahierDeTextes){if(lCours.cahierDeTextes.estDevoir){lImage=new ObjetElement('IconeDS',null,null);lImage.width=17;lImage.coin=EGenreCoin.basD;lImage.title=GTraductions.getValeur('CahierDeTexte.DevoirSurveille_Devoir');lCours.ListeImages.AddElement(lImage);}
if(lCours.cahierDeTextes.estEval){lImage=new ObjetElement('IconeEvaluation',null,null);lImage.width=17;lImage.coin=EGenreCoin.basD;lImage.title=GTraductions.getValeur('CahierDeTexte.DevoirSurveille_Evaluation');lCours.ListeImages.AddElement(lImage);}}}
if(lCours.NomImageAppelFait){lImage=new ObjetElement(lCours.NomImageAppelFait);lImage.coin=EGenreCoin.hautD;lImage.width=16;lCours.ListeImages.AddElement(lImage);}
var lListeImages=new ObjetListeElements();lListeImages.AddElement(new ObjetElement('IconeTravailAFaire'));for(var J=0;J<lCours.ListeContenus.GetNbrElements();J++){var lContenu=lCours.ListeContenus.GetElement(J);if((lContenu.GetGenre()===EGenreRessource.Matiere)&&lCours.avecTafPublie){lContenu.Class='Texte10 Gras AlignementMilieu Souligne';lContenu.listeImages=lListeImages;}}};InterfaceGrilleEDT.prototype.fermerFenetreMS=function(aParam){if(this.Instances[this.identFenetreCours_MS])
this.GetInstance(this.identFenetreCours_MS).Fermer(aParam);};InterfaceGrilleEDT.prototype.getInstanceGrille=function(){return this.GetInstance(this.IdentGrille);};InterfaceGrilleEDT.prototype.effacer=function(aMessage){this.GetInstance(this.IdentGrille).effacer(aMessage);};function _evenementSurCours(aParam){var lParam={genre:null,id:'',cours:null};$.extend(lParam,aParam);switch(lParam.genre){case EGenreEvenementEDT.SurCours:case EGenreEvenementEDT.SurContenu:{this.actualisationSelectionSurGrillesDeCours(lParam.cours);this.callback.appel(aParam);break;}
case EGenreEvenementEDT.SurMenuContextuel:{if(lParam.cours.coursMultiple&&this._options.avecGrilleMultiple){var lInstanceMenu=this.GetInstance(this.IdentMenuContextuel);lInstanceMenu.vider();lInstanceMenu.AddCommande(0,GTraductions.getValeur('EDT.DetailCours'),true,{cours:lParam.cours});lInstanceMenu.Afficher();}
else{this.actualisationSelectionSurGrillesDeCours(lParam.cours);this.callback.appel(aParam);}
break;}
default:{this.callback.appel(aParam);}}}
function _evenementSurMenuContextuel(ALigne){if(ALigne)
switch(ALigne.Numero){case 0:if(!this._options.avecGrilleMultiple)
return;this.fermerFenetreMS({sansAnimation:true});this.GetInstance(this.identFenetreCours_MS).SetDonnees({coursMultiple:ALigne.data.cours,coursSelectionne:this.GetInstance(this.IdentGrille).getCoursSelectionne(),optionsGrille:this._optionsGrilleMS,hauteurCelluleGrille:this.GetInstance(this.IdentGrille).hauteurCellule,callbackGrille:_evenementSurCours.bind(this)});break;}}
InterfaceGrilleEDT.prototype.actualisationSelectionSurGrillesDeCours=function(aCours,aSelectionGrilleCourante){var lInstanceGrilleMS=this.Instances[this.identFenetreCours_MS]?this.GetInstance(this.identFenetreCours_MS).getInstanceGrille():null;var lInstanceGrille=this.GetInstance(this.IdentGrille);if(!aCours){lInstanceGrille.DeselectionnerElement();if(lInstanceGrilleMS)
lInstanceGrilleMS.DeselectionnerElement();}
else if(aCours.coursOrigine){lInstanceGrille.SelectionnerElement(lInstanceGrille.ListeCours.GetIndiceParNumeroEtGenre(aCours.coursOrigine.GetNumero()),true);if(aSelectionGrilleCourante&&lInstanceGrilleMS)
lInstanceGrilleMS.SelectionnerElement(lInstanceGrilleMS.ListeCours.GetIndiceParNumeroEtGenre(aCours.GetNumero()),true);}
else if(lInstanceGrilleMS&&aCours.estCoursMS){var lIndiceCours=lInstanceGrilleMS.ListeCours.GetIndiceParNumeroEtGenre(aCours.GetNumero());if(lIndiceCours>=0)
lInstanceGrilleMS.SelectionnerElement(lIndiceCours,true);else this.fermerFenetreMS();if(aSelectionGrilleCourante)
lInstanceGrille.SelectionnerElement(lInstanceGrille.ListeCours.GetIndiceParNumeroEtGenre(aCours.GetNumero()),true);}
else if(lInstanceGrilleMS){this.fermerFenetreMS();}};})();;
function ObjetRequeteFicheCours(aPere,aEvenementSurReussite,aEvenementSurEchec){this.inheritedCreate(aPere,aEvenementSurReussite,aEvenementSurEchec);}
IE.Requetes.inscrire('FicheCours',ObjetRequeteFicheCours,_ObjetRequeteXmlConsultationPN);ObjetRequeteFicheCours.prototype.lancerRequete=function(aParametres){var lParametres={cours:null,ressource:null,numeroSemaine:null};$.extend(lParametres,aParametres);this.JSON={cours:lParametres.cours,numeroSemaine:lParametres.numeroSemaine};if(lParametres.ressource)
this.JSON.ressource=lParametres.ressource;this.appelAsynchroneConsultation();};ObjetRequeteFicheCours.prototype.actionApresRequete=function(){this.callbackReussite.appel(this.JSONReponse.listeCours,this.JSONReponse.listeEleves,this.JSONReponse.afficherClasse);};;
var EGenreCommandeEDT={onglet:0,information:1,sondage:2,ajouterSalle:3,modifierSalle:4,supprimerSalle:5,annulerModification:6};ObjetAffichagePageAccueil.prototype.existeWidgetEDT=function(){return!this.donnees||this.donnees.EDT.listeCours;};ObjetAffichagePageAccueil.prototype.creerObjetsEDT=function(){this.initialierListeCommandes();this.avecEDTDuJour=GEtatUtilisateur.GenreEspace!==EGenreEspace.Professeur&&GEtatUtilisateur.GenreEspace!==EGenreEspace.Etablissement;if(!this.grilleEDT){this.grilleEDT=Identite.creerInstance(window.InterfaceGrilleEDT,{pere:this,evenement:this.evenementSurGrille});this.initialiserGrille(this.grilleEDT);}
if(!this.ficheCours){this.ficheCours=ObjetFenetre.creerInstance(window.TFicheCours,{pere:this,evenement:this.evenementFicheCours,initialiser:false});this.addFiche(this.ficheCours);}
if(!this.identFenetreMemo){this.identFenetreMemo=this.addFenetre(window.ObjetFenetre_Memo);}
if(!this.semaineEDT&&!this.dateEDT){if(this.avecEDTDuJour){this.dateEDT=Identite.creerInstance(window.ObjetCelluleDate,{pere:this,evenement:this._evenementDateEDT});this._initialiserDateEDT(this.dateEDT);} else{this.semaineEDT=Identite.creerInstance(window.ObjetSaisie,{pere:this,evenement:this._evenementSemaineEDT});this._initialiserSemaineEDT(this.semaineEDT);}}
if(!this.identBoutonCoursAnnule){var lAcces=GEtatUtilisateur.getAcces();if(GEtatUtilisateur.getAvecChoixCoursAnnule()&&lAcces.autoriseSurDate){this.identBoutonCoursAnnule=Identite.creerInstance(window.ObjetBoutonBandeau,{pere:this,evenement:this._evenementBoutonCoursAnnule});this._initBoutonCoursAnnule(this.identBoutonCoursAnnule);}}
if(!this.boutonsCommandes){this.boutonsCommandes=[];for(var I=0;I<this.liseCommandes.GetNbrElements();I++){var lCommande=this.liseCommandes.GetElement(I);if(lCommande.avecBouton){this.boutonsCommandes[I]=Identite.creerInstance(window.ObjetBoutonBandeau,{pere:this,evenement:_evenementSurBoutonCommande.bind(this,I)});this._initBoutonCommande(this.boutonsCommandes[I],lCommande);}}}
if(GEtatUtilisateur.GenreEspace===EGenreEspace.Professeur&&window.ObjetModule_EDTSaisie){this.moduleSaisie=new window.ObjetModule_EDTSaisie(this,_evenementSurModuleSaisie.bind(this));}};ObjetAffichagePageAccueil.prototype._initBoutonCoursAnnule=function(aObjet){aObjet.SetParametres('Image_AfficherCoursAnnules',true,this.donneesGrille.avecCoursAnnule,true,[GTraductions.getValeur('EDT.MasquerCoursAnnules'),GTraductions.getValeur('EDT.AfficherCoursAnnules'),GTraductions.getValeur('EDT.AfficherCoursAnnules')],20);};ObjetAffichagePageAccueil.prototype._initBoutonCommande=function(aObjet,aCommande){aObjet.SetParametres(aCommande.image,true,false,false,[aCommande.GetLibelle(),aCommande.GetLibelle(),aCommande.GetLibelle()],22,false,false);};ObjetAffichagePageAccueil.prototype.initialiserObjetsEDT=function(){this.grilleEDT.Initialiser();this.resizeColonne(this.donnees.EDT.genreColonne);this.grilleEDT.SetDonnees(this.donneesGrille);this.ficheCours.Initialiser();if(this.dateEDT){this.dateEDT.Initialiser();this.dateEDT.SetDonnees(this._getDateGrille());}
if(this.semaineEDT){this.semaineEDT.Initialiser();var lDomaineConsultation=GApplication.droits.get(IEEnum.droits.cours.domaineConsultationEDT);var lListeSemaines=GDate.getListeSemaines(lDomaineConsultation.GetValeur(this.numeroSemaineParDefaut-1)?this.numeroSemaineParDefaut-1:this.numeroSemaineParDefaut,lDomaineConsultation.GetValeur(this.numeroSemaineParDefaut+1)?this.numeroSemaineParDefaut+1:this.numeroSemaineParDefaut,EGenreTriElement.Croissant);this.semaineEDT.SetDonnees(lListeSemaines,lListeSemaines.GetIndiceParNumeroEtGenre(null,this.donneesRequete.numeroSemaine));}
if(this.identBoutonCoursAnnule)
this.identBoutonCoursAnnule.Initialiser();for(var I=0;I<this.liseCommandes.GetNbrElements();I++)
if(this.boutonsCommandes[I]){this.boutonsCommandes[I].Initialiser();}};ObjetAffichagePageAccueil.prototype.composeWidgetEDT=function(){var H=[];H.push('<table style="width: 100%; height: 100%;" border="0" cellspacing="0" cellpadding="0">','<tr>','<td id="',this.grilleEDT.GetNom(),'" style="height:100%;width:100%; box-sizing:border-box; padding:2px;">','</td>');if(this.liseCommandes.GetNbrElements()>0)
H.push('<td class="AlignementHaut" style="padding-top: 20px;">','<div style="width: 25px;">',this.composeWidgetEDT_Commandes(),'</div>','</td>');H.push('</tr>','</table>');return H.join('');};ObjetAffichagePageAccueil.prototype.composeWidgetEDT_Commandes=function(){var H=[];for(var I=0;I<this.liseCommandes.GetNbrElements();I++)
if(this.boutonsCommandes[I]){H.push('<div id="',this.boutonsCommandes[I].GetNom(),'" style="position: relative; left: -5px;">','</div>');}
return H.join('');};ObjetAffichagePageAccueil.prototype.construireWidgetEDT=function(){this.creerObjetsEDT();var lWidget={html:this.composeWidgetEDT(),titre:this.avecEDTDuJour?'':GTraductions.getValeur('accueil.emploiDuTemps')+' '+'('+GTraductions.getValeur('Semaine').toLowerCase()+' '+(MethodesTableau.existe(GParametres.frequences[IE.Cycles.cycleDeLaDate(this.donneesRequete.dateGrille)].genre,[EGenreDomaineFrequence.QZ1,EGenreDomaineFrequence.QZ2])?GParametres.frequences[IE.Cycles.cycleDeLaDate(this.donneesRequete.dateGrille)].libelle:GTraductions.getValeur('Feriee').toLowerCase())+')',hint:this.avecEDTDuJour?GTraductions.getValeur('accueil.info.edtJour'):GTraductions.getValeur('accueil.info.edtSemaine'),nbrElements:null,afficherMessage:false,idCombo:this.semaineEDT?this.semaineEDT.GetNom():null,idBouton:this.identBoutonCoursAnnule?this.identBoutonCoursAnnule.GetNom():null,idSelecteurDate:this.dateEDT?this.dateEDT.GetNom():null};$.extend(true,this.donnees.EDT,lWidget);this.construireWidget(this.donnees.EDT);this.initialiserObjetsEDT();};ObjetAffichagePageAccueil.prototype.initialierListeCommandes=function(){var lCommande;this.liseCommandes=new ObjetListeElements();if(GEtatUtilisateur.existeGenreOnglet(EGenreOnglet.SaisieCahierDeTextes)){lCommande=new ObjetElement(GTraductions.getValeur('accueil.EDT.commande.CDT'),null,EGenreCommandeEDT.onglet);lCommande.genreOnglet=EGenreOnglet.SaisieCahierDeTextes;lCommande.image='Image_CommandesEDT_CDT';lCommande.avecBouton=true;this.liseCommandes.AddElement(lCommande);}
if(GEtatUtilisateur.existeGenreOnglet(EGenreOnglet.SaisieAbsences_AppelEtSuivi)){lCommande=new ObjetElement(GTraductions.getValeur('accueil.EDT.commande.appel'),null,EGenreCommandeEDT.onglet);lCommande.genreOnglet=EGenreOnglet.SaisieAbsences_AppelEtSuivi;lCommande.image='Image_CommandesEDT_Appel';lCommande.avecBouton=true;this.liseCommandes.AddElement(lCommande);}
if(GEtatUtilisateur.existeGenreOnglet(EGenreOnglet.SaisieNotes)){lCommande=new ObjetElement(GTraductions.getValeur('accueil.EDT.commande.notes'),null,EGenreCommandeEDT.onglet);lCommande.genreOnglet=EGenreOnglet.SaisieNotes;lCommande.image='Image_CommandesEDT_Notes';lCommande.avecBouton=true;this.liseCommandes.AddElement(lCommande);}
if(GEtatUtilisateur.existeGenreOnglet(EGenreOnglet.Evaluation)){lCommande=new ObjetElement(GTraductions.getValeur('accueil.EDT.commande.evaluations'),null,EGenreCommandeEDT.onglet);lCommande.genreOnglet=EGenreOnglet.Evaluation;lCommande.image='Image_CommandesEDT_Evaluations';lCommande.avecBouton=true;this.liseCommandes.AddElement(lCommande);}
if(GEtatUtilisateur.existeGenreOnglet(EGenreOnglet.SaisieAppreciationsBulletin)){lCommande=new ObjetElement(GTraductions.getValeur('accueil.EDT.commande.appreciations'),null,EGenreCommandeEDT.onglet);lCommande.genreOnglet=EGenreOnglet.SaisieAppreciationsBulletin;lCommande.image='Image_CommandesEDT_Appreciations';lCommande.avecBouton=true;this.liseCommandes.AddElement(lCommande);}
if(MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Professeur,EGenreEspace.Etablissement])&&GApplication.droits.get(IEEnum.droits.actualite.avecSaisieActualite)){lCommande=new ObjetElement(' ',null,null);this.liseCommandes.AddElement(lCommande);lCommande=new ObjetElement(GTraductions.getValeur('accueil.EDT.commande.information'),null,EGenreCommandeEDT.information);lCommande.image='Image_CommandesEDT_Informations';lCommande.avecBouton=true;this.liseCommandes.AddElement(lCommande);lCommande=new ObjetElement(GTraductions.getValeur('accueil.EDT.commande.sondage'),null,EGenreCommandeEDT.sondage);lCommande.image='Image_CommandesEDT_Sondages';lCommande.avecBouton=true;this.liseCommandes.AddElement(lCommande);}
if(MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Professeur])&&GApplication.droits.get(IEEnum.droits.cours.modifierSalles)&&GApplication.droits.get(IEEnum.droits.cours.estSemaineModifiable,this.donneesRequete.numeroSemaine)){lCommande=new ObjetElement(' ',null,null);this.liseCommandes.AddElement(lCommande);lCommande=new ObjetElement(GTraductions.getValeur('SaisieCours.AjouterSalle'),null,EGenreCommandeEDT.ajouterSalle);lCommande.image='';this.liseCommandes.AddElement(lCommande);lCommande=new ObjetElement(GTraductions.getValeur('SaisieCours.RemplacerSalle'),null,EGenreCommandeEDT.modifierSalle);lCommande.image='';this.liseCommandes.AddElement(lCommande);lCommande=new ObjetElement(GTraductions.getValeur('SaisieCours.AnnulerModification'),null,EGenreCommandeEDT.annulerModification);lCommande.image='';this.liseCommandes.AddElement(lCommande);}};ObjetAffichagePageAccueil.prototype.getImageCommandeEDT=function(aGenre){switch(aGenre){case EGenreOnglet.SaisieAppreciationsBulletin:return'Image_CommandesEDT_Appreciations';}
return'';};ObjetAffichagePageAccueil.prototype._initialiserSemaineEDT=function(aObjet){aObjet.setOptions_ObjetSaisie({longueur:100,avecBoutonsPrecSuiv:true,avecBoutonsPrecSuivVisiblesInactifs:false});};ObjetAffichagePageAccueil.prototype._initialiserDateEDT=function(aInstance){aInstance.SetParametres(false,90,null,'Maigre',true,false,'%JJJ %JJ %MMM');aInstance.setParametres_Fenetre(GParametres.PremierLundi,GParametres.PremiereDate,GParametres.DerniereDate,GParametres.JoursOuvres,GApplication.droits.get(IEEnum.droits.cours.domaineConsultationEDT));};ObjetAffichagePageAccueil.prototype.initialiserGrille=function(aInstance){aInstance.setOptions_InterfaceGrilleEDT({optionsGrille:{hauteurMINPasHoraire:GNavigateur.isTactile?Math.max(10,550/GParametres.PlacesParJour):10,hauteurMAXPasHoraire:75,genreAffichageDate:!this.avecEDTDuJour?EGenreAffichageGrilleDate.AvecDateEtJour:EGenreAffichageGrilleDate.AvecFrequence,colonnesVisibles:!this.avecEDTDuJour?null:new TypeEnsembleNombre().add(0),frequences:GParametres.frequences,avecSelection:true,avecMenuContextuel:!this.avecEDTDuJour&&this.liseCommandes.GetNbrElements()>0?true:false,couleurFond:GCouleur.blanc,avecShadowFocus:false}});if(MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Parent,EGenreEspace.Eleve])){this.donneesGrille.joursStage=GEtatUtilisateur.getJoursStageDEleve(GEtatUtilisateur.getMembre());}};ObjetAffichagePageAccueil.prototype._evenementSemaineEDT=function(aGenre,aElement){if(aGenre===EGenreEvenementObjetSaisie.selection&&this.semaineEDT.InteractionUtilisateur){this.donneesRequete.dateGrille=null;this.donneesRequete.numeroSemaine=aElement.GetGenre();this.donnees.EDT.semaineSelectionnee=this.donneesRequete.numeroSemaine;this.RecupererDonnees([this.donnees.EDT.genre]);}};ObjetAffichagePageAccueil.prototype._evenementDateEDT=function(aDate){this.donneesRequete.dateGrille=aDate;this.donneesRequete.numeroSemaine=IE.Cycles.cycleDeLaDate(aDate);this.donnees.EDT.semaineSelectionnee=this.donneesRequete.numeroSemaine;this.RecupererDonnees([this.donnees.EDT.genre]);};ObjetAffichagePageAccueil.prototype.evenementFicheCours=function(aParam){this._gestionFocus_apresFicheCours(aParam);};ObjetAffichagePageAccueil.prototype.evenementSurGrille=function(aParam){this.cours=aParam.cours;this.donnees.EDT.coursSelectionne=this.cours;this.date=aParam.date;var lThis=this;this.cours.ListeContenus.parcourir(function(aElement){if(aElement.GetGenre()===EGenreRessource.Service&&aElement.classe){lThis.service=aElement;lThis.classe=aElement.classe;}});this.paramCours=aParam;this.idPositionFicheCDT=this.paramCours.id;switch(aParam.genre){case EGenreEvenementEDT.SurCours:this._actualiserBoutonsCommande();if(!aParam.cours.coursMultiple)
this._requeteFiche(aParam.cours);break;case EGenreEvenementEDT.SurContenu:case EGenreEvenementEDT.SurImage:{if(!aParam.cours.coursMultiple)
this._requeteFiche(aParam.cours);break;}
case EGenreEvenementEDT.SurMenuContextuel:{if(this.cours.coursMultiple)
break;this.fermerFiches();if(this.avecNavigationCours){_positionnementNavigationClavier.bind(this)(this.cours);_menuContextuel.bind(this)(this.cours,this.date);}
break;}}};ObjetAffichagePageAccueil.prototype._actualiserBoutonsCommande=function(){for(var I=0;I<this.liseCommandes.GetNbrElements();I++){var lCommande=this.liseCommandes.GetElement(I);if(this.boutonsCommandes[I]&&lCommande.avecBouton)
this.boutonsCommandes[I].setActif(this.cours&&this.date&&this._estCommandeActive(lCommande,this.cours,this.date));}};ObjetAffichagePageAccueil.prototype._estCommandeActive=function(aCommande,aCours,aDate){switch(aCommande.genreOnglet){case EGenreOnglet.SaisieAbsences_AppelEtSuivi:return aCours.utilisable&&(GEtatUtilisateur.getIndiceDateSaisieAbsence(aDate)>=0)&&!aCours.estAppelVerrouille&&!aCours.estAnnule;case EGenreOnglet.SaisieCahierDeTextes:return aCours.utilisable;default:return true;}};ObjetAffichagePageAccueil.prototype._estCommandeVisible=function(aCommande,aCours,aDate){switch(aCommande.Genre){case EGenreCommandeEDT.ajouterSalle:return aCours.nbrSalles===0;case EGenreCommandeEDT.modifierSalle:return aCours.nbrSalles===1;case EGenreCommandeEDT.supprimerSalle:return aCours.nbrSalles===1;case EGenreCommandeEDT.annulerModification:return aCours.modifAnnulable;default:return true;}};function _initialiserMenuContextuel(aCours,aDate ,aInstance){for(var I=0;I<this.liseCommandes.GetNbrElements();I++){var lCommande=this.liseCommandes.GetElement(I);if(this._estCommandeVisible(lCommande,aCours,aDate)){if(lCommande.Genre===null){aInstance.AddSeparateur();} else{var lCommandeMenu=aInstance.AddCommande(lCommande.GetGenre(),lCommande.GetLibelle(),this._estCommandeActive(lCommande,aCours,aDate));lCommandeMenu.genreOnglet=lCommande.genreOnglet;lCommandeMenu.image=lCommande.image;lCommandeMenu.largeurImage=22;}}}
this._actualiserBoutonsCommande();}
function _evenementSurMenuContextuel(aLigne){_surCommande.bind(this)(aLigne.GetNumero(),aLigne.genreOnglet);}
function _surCommande(aGenreCommande,aGenreOnglet){if(aGenreCommande===EGenreCommandeEDT.information){this._evenementBoutonInfoSondage(TypeGenreReponseInternetActualite.AvecAR);return;}
if(aGenreCommande===EGenreCommandeEDT.sondage){this._evenementBoutonInfoSondage(TypeGenreReponseInternetActualite.ChoixUnique);return;}
if(aGenreCommande===EGenreCommandeEDT.ajouterSalle){this.moduleSaisie.evenementSurMenuContextuelAccueil_ModifierSalle({cours:this.cours,numeroSemaine:this.donneesRequete.numeroSemaine});return;}
if(aGenreCommande===EGenreCommandeEDT.modifierSalle){this.moduleSaisie.evenementSurMenuContextuelAccueil_ModifierSalle({cours:this.cours,numeroSemaine:this.donneesRequete.numeroSemaine,ressourceRemplacee:this.cours.salleRemplacee});return;}
if(aGenreCommande===EGenreCommandeEDT.supprimerSalle){this.moduleSaisie.evenementSurMenuContextuelAccueil_SupprimerSalle({cours:this.cours,numeroSemaine:this.donneesRequete.numeroSemaine,ressourceRemplacee:this.cours.salleRemplacee});return;}
if(aGenreCommande===EGenreCommandeEDT.annulerModification){this.moduleSaisie.evenementSurMenuContextuelAccueil_SuppressionCours({cours:this.cours,numeroSemaine:this.donneesRequete.numeroSemaine});return;}
if(!aGenreOnglet){this._gestionFocus_apresFicheCours();return;}
if(this.classe&&this.classe.existeNumero()){GEtatUtilisateur.Navigation.SetRessource(EGenreRessource.Classe,this.classe.GetLibelle(),this.classe.GetNumero(),this.classe.GetGenre());}
if(this.service&&this.service.existeNumero()){GEtatUtilisateur.Navigation.SetRessource(EGenreRessource.Service,this.service.GetLibelle(),this.service.GetNumero(),null);}
GEtatUtilisateur.setNavigationCours(this.cours);GEtatUtilisateur.setNavigationDate(this.date);GEtatUtilisateur.SetSemaineSelectionnee(this.donneesRequete.numeroSemaine);this.evenementPage(this.genreEvenement.selectionPage,{Onglet:aGenreOnglet});}
function _evenementSurBoutonCommande(I){var lCommande=this.liseCommandes.GetElement(I);_surCommande.bind(this)(lCommande.GetGenre(),lCommande.genreOnglet);}
function _evenementSurModuleSaisie(){this.RecupererDonnees([this.donnees.EDT.genre,this.donnees.appelNonFait.genre,this.donnees.CDTNonSaisi.genre]);};ObjetAffichagePageAccueil.prototype._evenementBoutonInfoSondage=function(aGenre){var lFenetreEditionActu=ObjetFenetre.creerInstance(window.ObjetFenetre_EditionActualite,{pere:this,initialiser:false});lFenetreEditionActu.SetParametres_Fenetre('',700,700,new Array(GTraductions.getValeur('Annuler'),GTraductions.getValeur('Valider')));lFenetreEditionActu.Initialiser();lFenetreEditionActu.SetTitre(GTraductions.getValeur(aGenre===TypeGenreReponseInternetActualite.AvecAR?'actualites.creerInfo':'actualites.creerSondage'));lFenetreEditionActu.SetDonnees({donnee:null,creation:true,cours:this.cours,date:this.date,genresPublic:[EGenreRessource.Eleve,EGenreRessource.Enseignant,EGenreRessource.Personnel],avecChoixAnonyme:false,listePublic:new ObjetListeElements(),genreReponse:aGenre});};function _menuContextuel(aCours,aDate){ObjetMenuContextuel.afficher({pere:this,evenement:_evenementSurMenuContextuel.bind(this),initCommandes:_initialiserMenuContextuel.bind(this,aCours,aDate)});}
ObjetAffichagePageAccueil.prototype._evenementBoutonCoursAnnule=function(){GEtatUtilisateur.setAvecCoursAnnule(!GEtatUtilisateur.getAvecCoursAnnule());this.donneesGrille.avecCoursAnnule=GEtatUtilisateur.getAvecCoursAnnule();this.cours=null;this.date=null;this.service=null;this.classe=null;this._actualiserBoutonsCommande();_fermerFiches.call(this);this.grilleEDT.SetDonnees(this.donneesGrille);};function _estCoursSelectionneFicheCours(aCours){return this._parametresFicheCours&&this._parametresFicheCours.cours&&this._parametresFicheCours.cours.GetNumero()===aCours.GetNumero();}
function _fermerFiches(){this.ficheCours.Fermer();if(this.ficheCDT>=0) this.GetInstance(this.ficheCDT).Fermer();}
ObjetAffichagePageAccueil.prototype._requeteFiche=function(aCours){this._objGestionFocus_apresFiche={element:aCours,param:this.paramCours};if((this.paramCours.genre===EGenreEvenementEDT.SurImage)&&(this.paramCours.genreImage===1)){if(!_estCoursSelectionneFicheCours.bind(this)(aCours))
_fermerFiches.call(this);new ObjetRequeteFicheCDT(this,this._actionSurRequeteFicheCDT.bind(this,EGenreAffichageCahierDeTextes.ContenuDeCours)).lancerRequete({cours:aCours,numeroSemaine:this.donneesRequete.numeroSemaine});}
else if(this.paramCours.genre===EGenreEvenementEDT.SurContenu){if(!_estCoursSelectionneFicheCours.bind(this)(aCours))
_fermerFiches.call(this);new ObjetRequeteFicheCDT(this,this._actionSurRequeteFicheCDT.bind(this,EGenreAffichageCahierDeTextes.TravailAFaire)).lancerRequete({cours:aCours,numeroSemaine:this.donneesRequete.numeroSemaine});}
else{if(this.ficheCDT>=0) this.GetInstance(this.ficheCDT).Fermer();}};function _surEchecRequeteFicheCours(aMessage){var lMessage=aMessage&&(aMessage.length>0)?aMessage:GTraductions.getValeur('requete.erreur');GApplication.getMessage().afficher({message:lMessage});this.RecupererDonnees([this.donnees.EDT.genre]);}
function _positionnementNavigationClavier(aCours,aForcerNavigationClavier){if(GNavigateur.IsToucheMenuContextuel()||aForcerNavigationClavier){var lPlace=aCours.Debut;var lInstanceGrille=this.grilleEDT.getInstanceGrille();var lPosition=lInstanceGrille.getPositionDePlace(lPlace);var lElementGrille=GHtml.getElement(lInstanceGrille.IdCellulePrefixe);GNavigateur.SourisX=(lPosition.x+1)*lInstanceGrille.largeurCellule+GPosition.getLeft(lElementGrille);GNavigateur.SourisY=(lPosition.y)*lInstanceGrille.hauteurCellule+GPosition.getTop(lElementGrille);}}
function _surMemoFicheCours(aParams){this.GetInstance(this.identFenetreMemo).SetDonnees({contenu:aParams.cours.memo,nonEditable:true});}
function _surCDTFicheCours(aCours,aNumeroSemaine){new ObjetRequeteFicheCDT(this,this._actionSurRequeteFicheCDT.bind(this,EGenreAffichageCahierDeTextes.ContenuDeCours)).lancerRequete({cours:aCours,numeroSemaine:aNumeroSemaine});}
function _surEnteteFicheCours(aCours){this.grilleEDT.getInstanceGrille().SelectionnerElementParNumero(aCours.GetNumero(),true,true);}
ObjetAffichagePageAccueil.prototype._gestionFocus_apresFicheCours=function(aGenreEvenement){this.grilleEDT.SelectionnerGrille();};ObjetAffichagePageAccueil.prototype._getDateGrille=function(){if(MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Eleve,EGenreEspace.Parent,EGenreEspace.Entreprise]))
return this.donneesRequete.dateGrille?this.donneesRequete.dateGrille:this.donneesRequete.date;return null;};;
ObjetAffichagePageAccueil.prototype.existeWidgetTAF=function(){return!this.donnees||this.donnees.travailAFaire.listeTAF?true:false;};ObjetAffichagePageAccueil.prototype.construireWidgetTAF=function(){this.donnees.travailAFaire.listeTAF.setTri([ObjetTri.init('ordre'),ObjetTri.init(function(aElement){return aElement.matiere.GetLibelle();})]);this.donnees.travailAFaire.listeTAF.trier();var H=[];var lDate,lTaf,lMatiere;var T=[];if(this.donnees.travailAFaire.listeTAF.GetNbrElements()>0){for(var I=0;I<this.donnees.travailAFaire.listeTAF.GetNbrElements();I++){lTaf=this.donnees.travailAFaire.listeTAF.GetElement(I);lTaf.indice=I;if(!T[lTaf.pourLe])
T[lTaf.pourLe]=[];T[lTaf.pourLe].push(lTaf);}
H.push('<div style="margin: 3px;">');if(this.donnees.travailAFaire.listeTAF.GetNbrElements()>0){for(lDate in T){lMatiere=null;H.push(this.composeDate(new Date(lDate)));for(var i in T[lDate]){lTaf=T[lDate][i];if(!lMatiere||lMatiere.GetNumero()!==lTaf.matiere.GetNumero()){H.push(this.composeMatiere(lTaf));}
H.push(this.composeTAF(lTaf));lMatiere=lTaf.matiere;}}}
H.push('</div>');}
var lWidget={html:H.join(''),nbrElements:this.donnees.travailAFaire.listeTAF.GetNbrElements(),afficherMessage:this.donnees.travailAFaire.listeTAF.GetNbrElements()===0};$.extend(true,this.donnees.travailAFaire,lWidget);this.construireWidget(this.donnees.travailAFaire);};ObjetAffichagePageAccueil.prototype.getIdDate=function(aDate){return this.donnees.travailAFaire.id+'_date_'+aDate;};ObjetAffichagePageAccueil.prototype.composeDate=function(aDate){var H=[];H.push('<div id="',this.getIdDate(aDate),'" class="PetitEspace Gras" style="margin-top: 3px; ',GStyle.composeCouleur(GCouleur.themeNeutre.legere2),'">');H.push((GDate.estDateParticulier(aDate)?GTraductions.getValeur('accueil.pour').ucfirst():GTraductions.getValeur('accueil.pourle').ucfirst())+' '+GDate.FormatDate(aDate,'['+'%JJJJ %J %MMM'+']'));H.push('</div>');return H.join('');};ObjetAffichagePageAccueil.prototype.composeMatiere=function(aTaf){var H=[];H.push('<div class="LienNoir Gras" style="margin-top: 3px; margin-left: 10px;" onclick="',this.Nom,'.surTAF (',aTaf.indice,')" onkeyup="if (GNavigateur.IsToucheSelection ()) ',this.Nom,'.surTAF (',aTaf.indice,')">',aTaf.matiere.GetLibelle(),'</div>');return H.join('');};ObjetAffichagePageAccueil.prototype.composeTAF=function(aTaf){var H=[];H.push('<div style="margin-left: 20px;" class="ElmMatierePourNavigation" ',GObjetWAI.composeRole(EGenreRole.Listitem),' ',GObjetWAI.composeAttribut({genre:EGenreAttribut.labelledby,valeur:this.getIdDate(aTaf)}),'>');H.push('<div>',aTaf.descriptif,'</div>');if(aTaf.listeDocumentJoint&&(aTaf.listeDocumentJoint.GetNbrElements()>0)){for(var I=0;I<aTaf.listeDocumentJoint.GetNbrElements();I++){var lPieceJointe=aTaf.listeDocumentJoint.GetElement(I);H.push('<div>',GChaine.composerURL(EGenreDocumentJoint.getUrl(lPieceJointe,EGenreRessource.DocumentJoint),lPieceJointe.GetLibelle(),lPieceJointe.GetGenre()===EGenreDocumentJoint.Fichier,null,'LienAccueil'),'</div>');}}
H.push('</div>');return H.join('');};ObjetAffichagePageAccueil.prototype.surTAF=function(I){this.TAF=this.donnees.travailAFaire.listeTAF.GetElement(I);new ObjetRequeteFicheCDT(this,this._actionSurRequeteFicheCDT.bind(this,EGenreAffichageCahierDeTextes.TravailAFaire)).lancerRequete({matiere:this.TAF.matiere,date:this.TAF.pourLe});};;
ObjetAffichagePageAccueil.prototype.existeWidgetDS=function(){return!this.donnees||this.existeDS(EGenreLienDS.tGL_Devoir);};ObjetAffichagePageAccueil.prototype.existeDS=function(aGenreLienDS){if(this.donnees.devoirSurveille.listeDS)
for(var i=0;i<this.donnees.devoirSurveille.listeDS.GetNbrElements();i++)
if(this.donnees.devoirSurveille.listeDS.GetGenre(i)===aGenreLienDS)
return true;return false;};ObjetAffichagePageAccueil.prototype.construireWidgetDS=function(){this.donnees.devoirSurveille.listeDS.setTri([ObjetTri.init('dateDebut')]);this.donnees.devoirSurveille.listeDS.trier();var lWidget={html:this.composeWidgetDS(EGenreLienDS.tGL_Devoir)};$.extend(true,this.donnees.devoirSurveille,lWidget);this.construireWidget(this.donnees.devoirSurveille);};ObjetAffichagePageAccueil.prototype.composeWidgetDS=function(aGenreLienDS){var H=[];for(var i=0;i<this.donnees.devoirSurveille.listeDS.GetNbrElements();i++){var lDS=this.donnees.devoirSurveille.listeDS.GetElement(i);if(lDS.GetGenre()===aGenreLienDS){var lStrDate=GDate.FormatDate(lDS.dateDebut,'['+GTraductions.getValeur('Le')+' '+'%JJJJ %J %MMM'+']'+' '+GTraductions.getValeur('De')+' '+'%hhh%mm')+GDate.FormatDate(lDS.dateFin,' '+GTraductions.getValeur('A')+' '+'%hhh%mm');H.push('<div class="PetitEspace">','<div class="Gras">','&nbsp;',lStrDate.ucfirst(),lDS.listeSalles?' - '+(lDS.listeSalles.GetNbrElements()?GTraductions.getValeur('Salle'):GTraductions.getValeur('Salles'))+' '+lDS.listeSalles.getTableauLibelles().join(', '):'','</div>','<div class="EspaceGauche10">','<div style="float:left; margin-right: 3px; width: 8px; height: 10px; ',GStyle.composeCouleurFond(lDS.couleur)+'"></div>','<div class="LienAccueil" style="float: left;" onclick="',this.Nom,'.surDS (',i,')" onkeyup="if (GNavigateur.IsToucheSelection ()) ',this.Nom,'.surDS (',i,')">',lDS.matiere.GetLibelle(),'</div>','</div><div style="clear: both"></div>','</div>');}}
return H.join('');};ObjetAffichagePageAccueil.prototype.surDS=function(i){var lDS=this.donnees.devoirSurveille.listeDS.GetElement(i);new ObjetRequeteFicheCDT(this,this._actionSurRequeteFicheCDT.bind(this,EGenreAffichageCahierDeTextes.ContenuDeCours)).lancerRequete({contenu:lDS,matiere:lDS.matiere});};;
var EGenreRessourcePedagogique={documentJoint:0,site:1,QCM:2,corrige:3,kiosque:4,documentCloud:5};EGenreRessourcePedagogique.getImage=function(aGenreRessource){return['Image_Casier_DocumentJoint','Image_Insertion_Site','Image_Casier_IDevoir','Image_Casier_Corrige','Image_Casier_Kiosque','Image_Casier_DocumentCloud'][aGenreRessource];};EGenreRessourcePedagogique.getUrl=function(aGenreRessource,aRessource){switch(aGenreRessource){case(EGenreRessourcePedagogique.documentJoint):if(aRessource.url)
return aRessource.url;return GChaine.GetChainePourUrl(GApplication.getCommunication().composeUrlFichierExterne(aRessource.GetLibelle(),new ObjetElement('',aRessource.GetNumero(),aRessource.GetGenre())),true);case(EGenreRessourcePedagogique.documentCloud):return aRessource.url;case(EGenreRessourcePedagogique.site):return GChaine.GetChainePourUrl(GChaine.verifierURLHttp(aRessource.GetLibelle()),false);case(EGenreRessourcePedagogique.corrige):return GChaine.GetChainePourUrl(GApplication.getCommunication().composeUrlFichierExterne(aRessource.GetLibelle(),new ObjetElement('',aRessource.GetNumero(),aRessource.GetGenre())),true);}};EGenreRessourcePedagogique.getLibelleDeGenreEtNombre=function(aGenreRessource,aNombre){var lChaine='';switch(aGenreRessource){case EGenreRessourcePedagogique.documentJoint:lChaine=((aNombre===1)||(aNombre===undefined))?GTraductions.getValeur('RessourcePedagogique.DocJoint_S'):GTraductions.getValeur('RessourcePedagogique.DocJoint');break;case EGenreRessourcePedagogique.site:lChaine=((aNombre===1)||(aNombre===undefined))?GTraductions.getValeur('RessourcePedagogique.SitesWeb_S'):GTraductions.getValeur('RessourcePedagogique.SitesWeb');break;case EGenreRessourcePedagogique.QCM:lChaine=((aNombre===1)||(aNombre===undefined))?GTraductions.getValeur('RessourcePedagogique.IDevoirs_S'):GTraductions.getValeur('RessourcePedagogique.IDevoirs');break;case EGenreRessourcePedagogique.corrige:lChaine=((aNombre===1)||(aNombre===undefined))?GTraductions.getValeur('RessourcePedagogique.Corriges_S'):GTraductions.getValeur('RessourcePedagogique.Corriges');break;case EGenreRessourcePedagogique.kiosque:lChaine=((aNombre===1)||(aNombre===undefined))?GTraductions.getValeur('RessourcePedagogique.Kiosque_S'):GTraductions.getValeur('RessourcePedagogique.Kiosque');break;}
return lChaine;};;
ObjetAffichagePageAccueil.prototype.existeWidgetRessourcePedagogique=function(){return!this.donnees||this.donnees.ressourcePedagogique.listeRessources;};ObjetAffichagePageAccueil.prototype.creerObjetstRessourcePedagogique=function(){};ObjetAffichagePageAccueil.prototype.initialiserObjetsRessourcePedagogique=function(){};ObjetAffichagePageAccueil.prototype.composeWidgetRessourcePedagogique=function(){for(var i=0;i<this.donnees.ressourcePedagogique.listeRessources.GetNbrElements();i++){var lRessource=this.donnees.ressourcePedagogique.listeRessources.GetElement(i);var lMatiere=this.donnees.ressourcePedagogique.listeMatieres.GetElementParNumero(lRessource.matiere.GetNumero());if(lMatiere&&(!lMatiere.date||(lRessource.date>lMatiere.date)))
lMatiere.date=lRessource.date;}
this.donnees.ressourcePedagogique.listeMatieres.setTri([ObjetTri.init('date',EGenreTriElement.Decroissant)]);this.donnees.ressourcePedagogique.listeMatieres.trier();this.donnees.ressourcePedagogique.listeRessources.setTri([ObjetTri.init('date',EGenreTriElement.Decroissant)]);this.donnees.ressourcePedagogique.listeRessources.trier();var H=[];H.push(this.composeWidgetRessourcePedagogique_Matiere());return H.join('');};ObjetAffichagePageAccueil.prototype.composeWidgetRessourcePedagogique_Matiere=function(aMatiere){var lExisteDocument=[],H=[];for(var i=0;i<this.donnees.ressourcePedagogique.listeRessources.GetNbrElements();i++){var lRessource=this.donnees.ressourcePedagogique.listeRessources.GetElement(i);var lCle=lRessource.GetGenre()+'_'+(lRessource.ressource?lRessource.ressource.GetNumero():'');{lExisteDocument[lCle]=true;H.push(this.composeWidgetRessourcePedagogique_Ressource(i,lRessource));}}
return H.join('');};ObjetAffichagePageAccueil.prototype.composeWidgetRessourcePedagogique_Ressource=function(i,aDocument){var lMatiere=this.donnees.ressourcePedagogique.listeMatieres.GetElementParNumero(aDocument.matiere.GetNumero());var H=[];H.push('<div class="PetitEspace" style="display:flex;">');var lGenre=aDocument.GetGenre();if((lGenre===EGenreRessourcePedagogique.QCM)&&window.GUtilitaires.QCM.estCorrige(aDocument.ressource))
lGenre=EGenreRessourcePedagogique.corrige;H.push('<div class="',EGenreRessourcePedagogique.getImage(lGenre),' InlineBlock" style="width:18px; height:18px;"></div>');H.push('<div class="PetitEspaceGauche InlineBlock">');if(lMatiere)
H.push('<div class="Gras">',lMatiere.GetLibelle(),'</div>');if(aDocument.GetGenre()===EGenreRessourcePedagogique.kiosque){H.push('<div class="InlineBlock PetitEspaceGauche"><a class="LienAccueil" onclick="',this.Nom,'._surRessourceKiosque (',i,')">',aDocument.ressource.GetLibelle(),'</a>','</div>');} if(aDocument.GetGenre()===EGenreRessourcePedagogique.QCM){H.push('<div class="InlineBlock">',window.GUtilitaires.QCM.estCliquable(aDocument.ressource)?'<div class="LienAccueil" onclick="'+this.Nom+'._surRessourceQCM ('+i+')">'+aDocument.ressource.QCM.GetLibelle()+'</div>':'<div>'+aDocument.ressource.QCM.GetLibelle()+'</div>','</div>');H.push('<div class="InlineBlock">','&nbsp;',GChaine.Format(GTraductions.getValeur('accueil.ressourcePedagogique.deposeLe'),[GDate.FormatDate(aDocument.date,'%JJ/%MM')]),'</div>');} else{H.push('<span><a class="LienAccueil" href="',EGenreRessourcePedagogique.getUrl(aDocument.GetGenre(),aDocument.ressource),'">',aDocument.ressource.GetLibelle(),'</a>','</span>');H.push('<span>','&nbsp;',GChaine.Format(GTraductions.getValeur('accueil.ressourcePedagogique.deposeLe'),[GDate.FormatDate(aDocument.date,'%JJ/%MM')]),'</span>');}
H.push('</div>');H.push('</div>');return H.join('');};ObjetAffichagePageAccueil.prototype._surRessourceQCM=function(i){var lRessource=this.donnees.ressourcePedagogique.listeRessources.GetElement(i);this.afficherExecutionQCM(lRessource.ressource);};ObjetAffichagePageAccueil.prototype._surRessourceKiosque=function(i){var lRessource=this.donnees.ressourcePedagogique.listeRessources.GetElement(i);new ObjetRequeteSaisieURLKiosque(this,this._actionaisieURLKiosque).lancerRequete(lRessource);};ObjetAffichagePageAccueil.prototype._actionaisieURLKiosque=function(aUrlSSO){window.open(aUrlSSO);};ObjetAffichagePageAccueil.prototype.construireWidgetRessourcePedagogique=function(){this.creerObjetstRessourcePedagogique();var lWidget={html:this.composeWidgetRessourcePedagogique(),nbrElements:this.donnees.ressourcePedagogique.listeRessources.GetNbrElements(),afficherMessage:this.donnees.ressourcePedagogique.listeRessources.GetNbrElements()===0};$.extend(true,this.donnees.ressourcePedagogique,lWidget);this.construireWidget(this.donnees.ressourcePedagogique);this.initialiserObjetsRessourcePedagogique();};;
var EGenreNiveauDAcquisition={Multiple:100,Utilisateur:0,Expert:1,Acquis:2,PresqueAcquis:3,EnCoursAcquisition:4,DebutAcquisition:5,NonAcquis:6,Absent:7,NonEvalue:8};EGenreNiveauDAcquisition.getNomImage=function(aNiveauDAcquisition){return aNiveauDAcquisition.GetGenre()>=EGenreNiveauDAcquisition.Expert?'Image_NiveauDAcquisition_'+aNiveauDAcquisition.GetGenre():'';};EGenreNiveauDAcquisition.getImage=function(aNiveauDAcquisition,aAvecTitle,aPourImpression,aAlignementMilieu){return aNiveauDAcquisition?[
aAvecTitle?'<div '+(aAlignementMilieu?'class="AlignementMilieu" ':'')+'title="'+aNiveauDAcquisition.GetLibelle()+'">':'<div>',GParametres.afficherAbbreviationNiveauDAcquisition?(aNiveauDAcquisition.abbreviation?aNiveauDAcquisition.abbreviation:''):aNiveauDAcquisition.GetGenre()>=EGenreNiveauDAcquisition.Expert?GImage.composeImage(this.getNomImage(aNiveauDAcquisition),16,aPourImpression):'&nbsp;','</div>'
].join(''):'';};EGenreNiveauDAcquisition.estAcquis=function(aGenre){return(aGenre===this.Expert)||(aGenre===this.Acquis);};EGenreNiveauDAcquisition.ordre=function(){return[
this.Expert,this.Acquis,this.PresqueAcquis,this.EnCoursAcquisition,this.DebutAcquisition,this.NonAcquis,this.Absent,this.NonEvalue
];};;
MethodesObjet.heritagePrototype(DonneesListe_DetailEvaluationsCompetencesAccueil,ObjetDonneesListe);function DonneesListe_DetailEvaluationsCompetencesAccueil(aDonnees){this.inheritedCreate(aDonnees);}
DonneesListe_DetailEvaluationsCompetencesAccueil.genreColonne={evaluation:0,niveauAcqu:1};DonneesListe_DetailEvaluationsCompetencesAccueil.prototype.GetCouleurCellule=function(I,D){return D.estUnDeploiement?this.ECouleurCellule.Deploiement:this.ECouleurCellule.Blanc;};DonneesListe_DetailEvaluationsCompetencesAccueil.prototype.AvecSelection=function(I,D){return false;};DonneesListe_DetailEvaluationsCompetencesAccueil.prototype.AvecEdition=function(I,D){return false;};DonneesListe_DetailEvaluationsCompetencesAccueil.prototype.AvecSuppression=function(D){return false;};DonneesListe_DetailEvaluationsCompetencesAccueil.prototype.AvecDeploiement=function(I){return true;};DonneesListe_DetailEvaluationsCompetencesAccueil.prototype.GetValeur=function(I,D){switch(I){case DonneesListe_DetailEvaluationsCompetencesAccueil.genreColonne.evaluation:return D.GetLibelle();case DonneesListe_DetailEvaluationsCompetencesAccueil.genreColonne.niveauAcqu:return EGenreNiveauDAcquisition.getImage(D.niveauDAcquisition,true);}
return'';};DonneesListe_DetailEvaluationsCompetencesAccueil.prototype.getClass=function(I,D){switch(I){case DonneesListe_DetailEvaluationsCompetencesAccueil.genreColonne.niveauAcqu:return'AlignementMilieu';}
return'';};DonneesListe_DetailEvaluationsCompetencesAccueil.prototype.GetTypeValeur=function(I,D){switch(I){case DonneesListe_DetailEvaluationsCompetencesAccueil.genreColonne.evaluation:return this.ETypeCellule.Texte;case DonneesListe_DetailEvaluationsCompetencesAccueil.genreColonne.niveauAcqu:return this.ETypeCellule.Html;}};function ObjetFenetre_DetailEvaluationsCompetencesAccueil(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.idEvaluation=IE.GUID.getId();}
MethodesObjet.heritagePrototype(ObjetFenetre_DetailEvaluationsCompetencesAccueil,ObjetFenetre);ObjetFenetre_DetailEvaluationsCompetencesAccueil.prototype.ConstruireInstances=function(){this.identListeEvaluations=this.Add(window.ObjetListe,null,this.initListeEvaluations);};ObjetFenetre_DetailEvaluationsCompetencesAccueil.prototype.ComposeContenu=function(){var T=[];T.push('<div class="Texte10 Espace" id="',this.idEvaluation,'"></div>');T.push('<div id="'+this.GetNomInstance(this.identListeEvaluations)+'" style="width: 100%;"></div>');return T.join('');};ObjetFenetre_DetailEvaluationsCompetencesAccueil.prototype.SetDonnees=function(aPilier,aEvaluation){this.pilier=aPilier;this.evaluation=aEvaluation;this.SetTitre(this._composeTitre(aEvaluation));GHtml.setHtml(this.idEvaluation.escapeJQ(),this._composeEvaluation(this.pilier,this.evaluation));var lPosition=0,lLigne,lNiveauDAcquisition;this.listePourAffichage=new ObjetListeElements();for(var i=0;i<aEvaluation.listeNiveauxDAcquisitions.GetNbrElements();i++){lNiveauDAcquisition=aEvaluation.listeNiveauxDAcquisitions.GetElement(i);if(lNiveauDAcquisition.pilier.GetNumero()===aPilier.GetNumero()){if(lNiveauDAcquisition.domaine&&!this.listePourAffichage.GetElementParNumeroEtGenre(lNiveauDAcquisition.domaine.GetNumero(),EGenreRessource.ElementPilier)){lLigne=new ObjetElement(lNiveauDAcquisition.domaine.GetLibelle(),lNiveauDAcquisition.domaine.GetNumero());if(!lNiveauDAcquisition.item&&!lNiveauDAcquisition.sousItem)
lLigne.niveauDAcquisition=lNiveauDAcquisition;lLigne.Genre=EGenreRessource.ElementPilier;lLigne.estUnDeploiement=true;lLigne.estDeploye=true;lLigne.estPere=true;lLigne.pere=null;lLigne.Position=lPosition++;this.listePourAffichage.AddElement(lLigne);}
if(lNiveauDAcquisition.item||lNiveauDAcquisition.sousItem){lLigne=new ObjetElement();if(lNiveauDAcquisition.item)
lLigne.Libelle=lNiveauDAcquisition.item.GetLibelle();if(lNiveauDAcquisition.sousItem)
lLigne.Libelle=lNiveauDAcquisition.sousItem.GetLibelle();lLigne.niveauDAcquisition=lNiveauDAcquisition;lLigne.estUnDeploiement=false;lLigne.estDeploye=true;lLigne.estPere=false;lLigne.pere=lNiveauDAcquisition.domaine?this.listePourAffichage.GetElementParNumeroEtGenre(lNiveauDAcquisition.domaine.GetNumero(),EGenreRessource.ElementPilier):null;lLigne.Position=lPosition++;this.listePourAffichage.AddElement(lLigne);}}}
this.Afficher();$('#'+this.GetNomInstance(this.identListeEvaluations).escapeJQ()).height($('#'+this.IdContenu.escapeJQ()).height()-$('#'+this.idEvaluation.escapeJQ()).height());this.GetInstance(this.identListeEvaluations).SetDonnees(new DonneesListe_DetailEvaluationsCompetencesAccueil(this.listePourAffichage));};ObjetFenetre_DetailEvaluationsCompetencesAccueil.prototype.initListeEvaluations=function(aInstance){aInstance.SetParametres([GTraductions.getValeur('competence.itemsEvalues'),GTraductions.getValeur('competence.niveau')],['100%','50px']);};ObjetFenetre_DetailEvaluationsCompetencesAccueil.prototype._composeTitre=function(aEvaluation){return[aEvaluation.matiere.GetLibelle(),aEvaluation.individu.GetLibelle()].join(' - ');};ObjetFenetre_DetailEvaluationsCompetencesAccueil.prototype._composeEvaluation=function(aPilier,aEvaluation){var H=[];H.push('<div class="Gras EspaceBas">',aEvaluation.palier.GetLibelle(),'&nbsp;-&nbsp;',aPilier.GetLibelle(),'</div>');H.push('<div>');H.push('<span>',GDate.FormatDate(aEvaluation.date,'['+'%JJ/%MM'+']'),'&nbsp;(',aEvaluation.periode.GetLibelle(),')','</span>');H.push('<span >','&nbsp;-&nbsp;','</span>');H.push('<span >',aEvaluation.GetLibelle(),'</span>');H.push('</div>');H.push('<div>',aEvaluation.descriptif,'</div>');if(aEvaluation.libelleCorrige)
H.push('<div>','<span>',GTraductions.getValeur('Corrige'),'&nbsp;:&nbsp;','</span>','<a class="LienAccueil"',' title="',GTraductions.getValeur('AfficherCorrige'),'"',' href="',GChaine.GetChainePourUrl(GApplication.getCommunication().composeUrlFichierExterne(aEvaluation.libelleCorrige,{"N":aEvaluation.GetNumero(),"G":EGenreRessource.Evaluation}),true),'" target="_blank"','>',aEvaluation.libelleCorrige,'</a>','</div>');return H.join('');};;
ObjetAffichagePageAccueil.prototype.existeWidgetCompetences=function(){return!this.donnees||(this.donnees.competences.listeEvaluations&&this.donnees.competences.listeEvaluations.GetNbrElements());};ObjetAffichagePageAccueil.prototype.creerObjetstCompetences=function(){};ObjetAffichagePageAccueil.prototype.initialiserObjetsCompetences=function(){};ObjetAffichagePageAccueil.prototype.initialiserFenetreDetailEvaluations=function(){this.fenetreDetailEvaluations=ObjetFenetre.creerInstance(window.ObjetFenetre_DetailEvaluationsCompetencesAccueil,{pere:this,evenement:null,initialiser:false});this.fenetreDetailEvaluations.SetParametres_Fenetre('',700,300,[GTraductions.getValeur('Fermer')]);this.fenetreDetailEvaluations.Initialiser();};ObjetAffichagePageAccueil.prototype.construireWidgetCompetences=function(){this.creerObjetstCompetences();this.ordre=EGenreNiveauDAcquisition.ordre();var H=[],i,j;for(i=0;i<this.donnees.competences.listePiliers.GetNbrElements();i++){var lPilier=this.donnees.competences.listePiliers. GetElement(i);H.push('<div class="PetitEspace Gras" style="',GStyle.composeCouleur(GCouleur.themeNeutre.legere2),'">',lPilier.GetLibelle(),'</div>');for(j=0;j<this.donnees.competences.listeEvaluations.GetNbrElements();j++){var lEvaluation=this.donnees.competences.listeEvaluations.GetElement(j);H.push(this.composeEvaluation(lPilier,i,lEvaluation,j));}}
var lWidget={html:'<div class="PetitEspace">'+H.join('')+'</div>',nbrElements:this.donnees.competences.listeEvaluations.GetNbrElements(),afficherMessage:this.donnees.competences.listeEvaluations.GetNbrElements()===0};$.extend(true,this.donnees.competences,lWidget);this.construireWidget(this.donnees.competences);this.initialiserObjetsCompetences();};ObjetAffichagePageAccueil.prototype.composeEvaluation=function(aPilier,aIndicePilier,aEvaluation,aIndiceEvaluation){var H=[];var lNbrNiveauxDAcquisitions=[];var lExisteNiveauDAcquisition=false,lNiveauDAcquisition;for(var i=0;i<aEvaluation.listeNiveauxDAcquisitions.GetNbrElements();i++){lNiveauDAcquisition=aEvaluation.listeNiveauxDAcquisitions.GetElement(i);if(aPilier.GetNumero()===lNiveauDAcquisition.pilier.GetNumero()){if(!lNbrNiveauxDAcquisitions[lNiveauDAcquisition.GetGenre()])
lNbrNiveauxDAcquisitions[lNiveauDAcquisition.GetGenre()]=[];lNbrNiveauxDAcquisitions[lNiveauDAcquisition.GetGenre()].push(lNiveauDAcquisition);lExisteNiveauDAcquisition=true;}}
if(lExisteNiveauDAcquisition){H.push('<div class="PetitEspace">');H.push('<div class="InlineBlock" style="padding-left: '+(10-3)+'px;">',GDate.FormatDate(aEvaluation.date,'['+GTraductions.getValeur('Le')+' '+'%JJ/%MM'+']'),'</div>');H.push('<div class="InlineBlock">','&nbsp;-&nbsp;','</div>');H.push('<div class="InlineBlock LienAccueil" title="',GTraductions.getValeur('accueil.competences.hintLien'),'" onclick="',this.Nom,'._surEvaluation (',aIndicePilier,', ',aIndiceEvaluation,')">',aEvaluation.matiere.GetLibelle(),'</div>');H.push('<div style="float: right;">');for(i in this.ordre){var lGenre=this.ordre[i];if(lNbrNiveauxDAcquisitions[lGenre]&&lNbrNiveauxDAcquisitions[lGenre].length){lNiveauDAcquisition=lNbrNiveauxDAcquisitions[lGenre][0];H.push('<div style="float: left;" class="EspaceGauche">',lNbrNiveauxDAcquisitions[lGenre].length,'&nbsp;</div>');H.push('<div style="float: left;">',EGenreNiveauDAcquisition.getImage(lNiveauDAcquisition,true),'</div>');}}
H.push('</div>');H.push('</div>');}
return H.join('');};ObjetAffichagePageAccueil.prototype._surEvaluation=function(aIndicePilier,aIndiceEvaluation){var lPilier=this.donnees.competences.listePiliers.GetElement(aIndicePilier);var lEvaluation=this.donnees.competences.listeEvaluations.GetElement(aIndiceEvaluation);this.initialiserFenetreDetailEvaluations();this.fenetreDetailEvaluations.SetDonnees(lPilier,lEvaluation);};;
ObjetAffichagePageAccueil.prototype.existeWidgetDSEvaluation=function(){return!this.donnees||this.existeDS(EGenreLienDS.tGL_Evaluation);};ObjetAffichagePageAccueil.prototype.construireWidgetDSEvaluation=function(){this.donnees.devoirSurveille.listeDS.setTri([ObjetTri.init('dateDebut')]);this.donnees.devoirSurveille.listeDS.trier();var lWidget={html:this.composeWidgetDS(EGenreLienDS.tGL_Evaluation)};$.extend(true,this.donnees.devoirSurveilleEvaluation,lWidget);this.construireWidget(this.donnees.devoirSurveilleEvaluation);};;

MethodesObjet.heritagePrototype(ObjetDetailActualite,Identite);function ObjetDetailActualite(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.EGenreMessage={Message:0,Signataire:1,TitreReponse:2,TexteReponse:3};this.initOptions();this.classes={detailDestinataires:IE.GUID.getClassCss(),message:IE.GUID.getClassCss(),reponse:IE.GUID.getClassCss()};this.idDocs=IE.GUID.getId();this.idScroll=IE.GUID.getId();Invocateur.abonner(Invocateur.events.modeExclusif,this._setModeExclusif,this);}(function(){ObjetDetailActualite.prototype.initOptions=function(){this._options={avecEditionActualite:false};};ObjetDetailActualite.prototype.setOptions=function(aOptions){$.extend(this._options,aOptions);};ObjetDetailActualite.prototype.SetDonnees=function(aActualite){this.actualite=aActualite;this._actualiserDonnees();this.resize();};ObjetDetailActualite.prototype._actualiserDonnees=function(){this.ListeMessages=[];this.CouleurTexte='';if(this.actualite){_setMessage.bind(this)(this.EGenreMessage.Message ,this.actualite.message);this.CouleurTexte=this.actualite.avecReponse?'#646464':'';}
this.boutonValider=new ObjetBouton(this.Nom+'.boutonValider',null,this,this.surBtnValider.bind(this));this.boutonValider.setOptionsBouton({Libelles:[GTraductions.getValeur('Valider')],styleSite:true});GHtml.setHtml(this.Nom,this.ConstruireAffichage());if(this.actualite&&(this.actualite.genreReponse===TypeGenreReponseInternetActualite.Textuelle||this.actualite.genreReponse===TypeGenreReponseInternetActualite.ChoixUnique||this.actualite.genreReponse===TypeGenreReponseInternetActualite.ChoixMultiple)){this.boutonValider.SetActif(this.actualite.genreReponse===TypeGenreReponseInternetActualite.ChoixMultiple);} else $('#'+this.boutonValider.GetNom().escapeJQ()).hide();$('#'+this.Nom.escapeJQ()+' input').jIECheckBox();$('.'+this.classes.detailDestinataires.escapeJQ()).on('focusin',function(){$(this).parent().css('box-shadow','0 0 5px 1px '+GCouleur.bordure+' inset');}).on('focusout',function(){$(this).parent().css('box-shadow','none');});$('.'+this.classes.message.escapeJQ()+', .'+this.classes.reponse.escapeJQ()).on('focusin',function(){$(this).parents('.ClassBidonDescriptif').css('box-shadow','0 0 5px 1px '+GCouleur.bordure+' inset');}).on('focusout',function(){$(this).parents('.ClassBidonDescriptif').css('box-shadow','none');});if(!this._options.avecEditionActualite){$('#'+this.Nom.escapeJQ()+' textarea').focusin({aActualite:this.actualite},function(event){if(event&&event.data&&event.data.aActualite&&!event.data.aActualite.avecReponse&&!event.data.aActualite.valeurReponse){event.preventDefault();window.setTimeout(function(){$(event.target).select();},1);}});}
if(GApplication.getModeExclusif())
this._setModeExclusif(true);};ObjetDetailActualite.prototype.resize=function(){var lJQ=$('#'+this.idScroll.escapeJQ());if(lJQ&&lJQ.data('jsp')){lJQ.data('jsp').destroy();lJQ=$('#'+this.idScroll.escapeJQ());}
lJQ.height(0).css('max-height',function(){return parseInt($(this).parents('td[id$="_P3"]:first').height())-parseInt($(this).parents('table:first').height());}).height('').jScrollPane();};ObjetDetailActualite.prototype._setModeExclusif=function(aModeExclusif){if(this.actualite&&this.actualite.genreReponse===TypeGenreReponseInternetActualite.AvecAR)
$('#'+this.Nom.escapeJQ()+' input').inputDisabled(aModeExclusif);};ObjetDetailActualite.prototype.ConstruireAffichage=function(){if(!this.actualite||!this.actualite.existeNumero())
return this.composeMessage(GTraductions.getValeur('actualites.AucuneActualite'));var H=[];H.push('<div tabIndex="-1" class="AlignementHaut"><table style="width: 100%;" border="0" cellpadding="0" cellspacing="0">');if(this._options.avecEditionActualite&&this.actualite&&this.actualite.detailPublic) H.push(_composeDetailPublic.bind(this)());H.push(_composeDescriptif.bind(this)());if(this.actualite.genreReponse===TypeGenreReponseInternetActualite.AvecAR)
H.push(_composeBoutonLu.bind(this)());if(!this._options.avecEditionActualite)
H.push(_composeBoutonValider.bind(this)());H.push('</table></div>');return H.join('');};function _composeDocuments(){if(this.actualite.listeDocumentsJoints.GetNbrElements()===0)
return'';var lHtml=[];for(var I=0;I<this.actualite.listeDocumentsJoints.GetNbrElements();I++){var lDocumentJoint=this.actualite.listeDocumentsJoints.GetElement(I);lHtml.push('<a class="Texte10" href="'+EGenreDocumentJoint.getUrl(lDocumentJoint,EGenreRessource.DocJointEtablissement)+'" target="_blank">'+lDocumentJoint.GetLibelle()+'</a>');}
return'<tr><td class="AlignementHaut"><div class="Image_Trombone">&nbsp;</div></td><td class="Texte10 EspaceBas EspaceGauche" style="width: 100%;">'+lHtml.join('<br>')+'</td></tr>';}
function _composeDetailPublic(){var H=[];H.push('<tr><td>');H.push('<fieldset style="position:relative;display:block;padding: 3px 6px 6px 6px; border: 1px solid ',GCouleur.bordure,'; margin: 0px;">');H.push('<legend style="position:relative;">',GTraductions.getValeur('actualites.Edition.Destinataires'),'</legend>');H.push('<div tabIndex="0" class ="',this.classes.detailDestinataires,'">',GChaine.enleverEntites(this.actualite.detailPublic),'</div>');H.push('</fieldset>');H.push('</td></tr>');H.push('<tr><td colspan="2"><div style="height : 5px;"></div></td></tr>');return H.join('');}
function _composeDescriptif(){var H=[];H.push('<tr><td colspan="2" class="Texte10 ClassBidonDescriptif" xtyle="',GStyle.composeCouleurBordure(GCouleur.bordure),'"><div class="Texte10 FondBlanc Espace ClassBidonDescriptif" style="',GStyle.composeCouleurBordure(GCouleur.bordure),'">');H.push('<div id="',this.idDocs,'"><table style="width: 100%;" border="0" cellpadding="0" cellspacing="0">',_composeDocuments.bind(this)(),'</table></div>');H.push('<div id="',this.idScroll,'" style="overflow:auto;height:100%;">');H.push('<div tabIndex="0" class="EspaceBas AvecSelectionTexte ',this.classes.message,'" id="ZoneMessageActualite" style="position:relative; overflow:auto;">',_getMessage.bind(this)(this.EGenreMessage.Message),'</div>');if(this.actualite.genreReponse!==TypeGenreReponseInternetActualite.AvecAR&&this.actualite.genreReponse!==TypeGenreReponseInternetActualite.SansAR){H.push('<div tabIndex="0" class="EspaceBas" _tyle="position:relative; overflow:auto;">',this.actualite.reponseAnonyme?GTraductions.getValeur('actualites.InfoAnonyme'):GTraductions.getValeur('actualites.InfoNominatif'),'</div>');H.push('<div tabIndex="',this._options.avecEditionActualite?'0':'-1','" class="Texte10 FondBlanc ',this.classes.reponse,'"><table style="width: 100%;" border="0" cellpadding="0" cellspacing="0">');switch(this.actualite.genreReponse){case TypeGenreReponseInternetActualite.Textuelle:{H.push(_composeTexteArea.bind(this)());break;}
case TypeGenreReponseInternetActualite.ChoixUnique:{H.push(_composeCoches.bind(this)());break;}
case TypeGenreReponseInternetActualite.ChoixMultiple:{H.push(_composeCoches.bind(this)());break;}}
H.push('</table></div>');}
H.push('</div>');H.push('</div></td></tr>');return H.join('');}
function _composeBoutonLu(){return'<tr><td colspan="2" class="Texte10 EspaceHaut"><input id="'+this.Nom+'_prisconnaissance" type="checkbox" '+GObjetWAI.composeAttribut({genre:EGenreAttribut.label,valeur:GTraductions.getValeur('actualites.PrisConnaissance')})+(!this._options.avecEditionActualite&&this.actualite.avecReponse?' checked=checked':'')+(this.actualite.avecReponse||this._options.avecEditionActualite?' disabled':'')+' onclick="'+this.Nom+'.surSaisieReponse (); '+this.Nom+'.surValidation ()"><label for="'+this.Nom+'_prisconnaissance">'+GTraductions.getValeur('actualites.PrisConnaissance')+'</label></td></tr>';}
function _composeBoutonValider(){return'<tr><td colspan="2" class="Texte10 EspaceHaut AlignementDroit"><div id="'+this.boutonValider.GetNom()+'" style="display:none;">'+this.boutonValider.ConstruireAffichage()+'</div></td></tr>';}
function _composeTexteArea(){this.reponse=this.actualite.valeurReponse;var H=[];H.push('<tr><td class="Texte10 FondBlanc"><font color="'+this.CouleurTexte+'">','<textarea id="'+this.Nom+'_textArea" ',(this._options.avecEditionActualite?'disabled ':''),GObjetWAI.composeAttribut({genre:EGenreAttribut.label,valeur:(!this._options.avecEditionActualite&&this.actualite.avecReponse?this.actualite.valeurReponse:(!this._options.avecEditionActualite&&this.actualite.valeurReponse?this.actualite.valeurReponse:GTraductions.getValeur('actualites.SaisirReponse')))}),' class="Texte10" style="border: 1px solid #CCCCCC; width: 100%" rows="5" placeholder="',GTraductions.getValeur('actualites.SaisirReponse'),'"',' onkeyup="'+this.Nom+'.surSaisieReponse (value)">',this._options.avecEditionActualite?'':this.actualite.valeurReponse,'</textarea>','</font></td></tr>');return H.join('');}
function _composeCoches(){var H=[];for(var I=0;I<this.actualite.listeChoix.GetNbrElements();I++){var lChoix=this.actualite.listeChoix.GetElement(I);if(lChoix.Existe())
H.push('<tr><td class="Texte10 EspaceBas"><input '+GObjetWAI.composeAttribut({genre:EGenreAttribut.label,valeur:lChoix.GetLibelle()})+' name="coches" type="'+(this.actualite.genreReponse===TypeGenreReponseInternetActualite.ChoixMultiple?'checkbox':'radio')+'" onclick="'+this.Nom+'.surSaisieReponse (value, checked)" onchange="'+this.Nom+'.surChange ()" value="'+(lChoix.rang)+'"'+(!this._options.avecEditionActualite&&this.actualite.valeurReponse.GetValeur(lChoix.rang)?' checked=checked':'')+(this._options.avecEditionActualite?' disabled':'')+'><font color="'+this.CouleurTexte+'">'+lChoix.GetLibelle()+'</font></td></tr>');}
return H.join('');}
function _getMessage(aGenreMessage){return this.ListeMessages[aGenreMessage];}
function _setMessage(aGenreMessage,aMessage){this.ListeMessages[aGenreMessage]=aMessage?aMessage:'';}
ObjetDetailActualite.prototype.surSaisieReponse=function(aValeurReponse,aValeurCoche){if(this._options.avecEditionActualite) return;if(this.actualite.genreReponse===TypeGenreReponseInternetActualite.Textuelle){if(aValeurReponse.length<=this.actualite.tailleReponse){this.actualite.valeurReponse=aValeurReponse;} else{GApplication.getMessage().Afficher(EGenreBoiteMessage.Information,null,GTraductions.getValeur('actualites.TailleMaximale'));GHtml.setValue(this.Nom+'_textArea',this.actualite.valeurReponse);}
this.surChange();} else if(this.actualite.genreReponse===TypeGenreReponseInternetActualite.ChoixMultiple||this.actualite.genreReponse===TypeGenreReponseInternetActualite.ChoixUnique){if(this.actualite.genreReponse===TypeGenreReponseInternetActualite.ChoixUnique){this.actualite.valeurReponse.Vider();}
this.actualite.valeurReponse.SetValeur(aValeurCoche,aValeurReponse);}
if(this.actualite.genreReponse===TypeGenreReponseInternetActualite.AvecAR){this.actualite.avecReponse=true;}
this.actualite.lue=true;this.boutonValider.SetActif(true);};ObjetDetailActualite.prototype.surChange=function(){if(this._options.avecEditionActualite) return;if(this.actualite.genreReponse!==TypeGenreReponseInternetActualite.Textuelle||this.reponse!==this.actualite.valeurReponse){this.SetEtatSaisie(true);this.actualite.SetEtat(EGenreEtat.Modification);}};ObjetDetailActualite.prototype.surBtnValider=function(){this.actualite.lue=true;this.actualite.avecReponse=true;this.actualite.SetEtat(EGenreEtat.Modification);this.surValidation();};ObjetDetailActualite.prototype.surValidation=function(){if(this.actualite.avecReponse){this._setModeExclusif(this.actualite.avecReponse);if(this.Pere&&this.Evenement&&!this._options.avecEditionActualite)
this.callback.appel(this.actualite);}};})();;

function ObjetRequetePageActualites(aPere,aEvenementSurReussite,aEvenementSurEchec){this.inheritedCreate(aPere,aEvenementSurReussite,aEvenementSurEchec);}
IE.Requetes.inscrire('PageActualites',ObjetRequetePageActualites,_ObjetRequeteXmlConsultationPN);ObjetRequetePageActualites.prototype.lancerRequete=function(aParametres){this.JSON={};$.extend(this.JSON,aParametres);this.appelAsynchroneConsultation();};ObjetRequetePageActualites.prototype.actionApresRequete=function(aXml){var lListeCategories=this.JSONReponse.listeCategories;var lCategorie=new ObjetElement(GTraductions.getValeur('actualites.ToutesVategories'),0);lCategorie.toutesLesCategories=true;lListeCategories.AddElement(lCategorie);lListeCategories.setTri([ObjetTri.init(function(D){return!D.toutesLesCategories;}),ObjetTri.init('Libelle')]);lListeCategories.trier();var lListeActualites=this.JSONReponse.listeActualites;this.callbackReussite.appel({listeCategories:lListeCategories,listeActualites:lListeActualites,avecElementsSaisie:this.JSONReponse.avecElementsSaisie});};;
function ObjetRequetePageActualitesResultats(aPere,aEvenementSurReussite,aEvenementSurEchec){this.inheritedCreate(aPere,aEvenementSurReussite,aEvenementSurEchec);this.actualite=null;}
IE.Requetes.inscrire('PageActualitesResultats',ObjetRequetePageActualitesResultats,_ObjetRequeteXmlConsultationPN);ObjetRequetePageActualitesResultats.prototype.lancerRequete=function(aParametres){this.actualite=aParametres.actualite;this.JSON={};$.extend(this.JSON,aParametres);this.appelAsynchroneConsultation();};ObjetRequetePageActualitesResultats.prototype.actionApresRequete=function(aXml){var lNumeroPere;function _getIndicePere(aEle){if(aEle.NumeroArticleLigne===lNumeroPere) return true;else return false;}
function _getIndicePremierFils(aEle){if(aEle.NumeroArticlePere===lNumeroPere) return true;else return false;}
this.actualite.resultats=this.JSONReponse;this.actualite.niveauMaxCumul=0;if(this.actualite.resultats&&this.actualite.resultats.listeRepondant){for(var i=0;i<this.actualite.resultats.listeRepondant.GetNbrElements();i++){var lElement=this.actualite.resultats.listeRepondant.GetElement(i);if(lElement.estCumul){lElement.estDeploye=false;lNumeroPere=lElement.NumeroArticleLigne;lElement.estUnDeploiement=!this.actualite.reponseAnonyme||(this.actualite.resultats.listeRepondant.getIndiceElementParFiltre(_getIndicePremierFils)>-1);this.actualite.niveauMaxCumul=Math.max(this.actualite.niveauMaxCumul,lElement.niveauCumul);} else{lElement.estUnDeploiement=false;}
if(lElement.NumeroArticlePere!==0){lNumeroPere=lElement.NumeroArticlePere;var lIndicePere=this.actualite.resultats.listeRepondant.getIndiceElementParFiltre(_getIndicePere);if(lIndicePere> -1)
lElement.pere=this.actualite.resultats.listeRepondant.GetElement(lIndicePere);}}
this.actualite.niveauMaxCumul+=1;}
this.callbackReussite.appel(this.actualite);};;
function ObjetRequeteSaisieActualites(aPere,aEvenementSurReussite,aEvenementSurEchec){this.inheritedCreate(aPere,aEvenementSurReussite,aEvenementSurEchec);}
IE.Requetes.inscrire('SaisieActualites',ObjetRequeteSaisieActualites,_ObjetRequeteXmlSaisiePN);(function(){ObjetRequeteSaisieActualites.prototype.lancerRequete=function(aParam){this.validationDirecte=aParam.validationDirecte||false;this.saisieActualite=aParam.saisieActualite;this.genresAffDestinataire=aParam.genresAffDestinataire;this.genreAffDestinataire=aParam.genreAffDestinataire;aParam.listeActualite.setSerialisateurJSON({methodeSerialisation:_serialiser_Actualite.bind(this),ignorerEtatsElements:this.validationDirecte});this.JSON.listeActualites=aParam.listeActualite;this.JSON.saisieActualite=this.saisieActualite;if(aParam.listeDocuments){aParam.listeDocuments.setSerialisateurJSON({methodeSerialisation:_serialiser_Document.bind(this)});this.JSON.listeDocuments=aParam.listeDocuments;}
this.appelAsynchroneSaisie();};function _serialiser_Actualite(aActualite,aJSON){aJSON.validationDirecte=this.validationDirecte;aJSON.genrePublic=aActualite.genrePublic;aJSON.public=aActualite.public;aJSON.lue=aActualite.lue;aJSON.supprimee=!!aActualite.supprimee;aJSON.marqueLueSeulement=aActualite.marqueLueSeulement?aActualite.marqueLueSeulement:false;if(!aJSON.marqueLueSeulement){aJSON.avecReponse=aActualite.avecReponse;if(aActualite.genreReponse!==TypeGenreReponseInternetActualite.SansAR&&aActualite.genreReponse!==TypeGenreReponseInternetActualite.AvecAR){aJSON.valeurReponse=aActualite.valeurReponse;}}
aJSON.saisieActualite=this.saisieActualite;if(this.saisieActualite){aJSON.publie=aActualite.publie;aJSON.message=new TypeChaineBrute(aActualite.message);aJSON.categorie=aActualite.categorie;aJSON.dateDebut=aActualite.dateDebut;aJSON.dateFin=aActualite.dateFin;aJSON.genreReponse=aActualite.genreReponse;aJSON.tailleReponse=aActualite.tailleReponse;aJSON.reponseAnonyme=aActualite.reponseAnonyme;if(aActualite.avecModificationPublic){aJSON.avecModificationPublic=true;if($.inArray(EGenreRessource.Eleve,this.genresAffDestinataire)>-1){aJSON.avecEleve=aActualite.avecEleve;aJSON.avecResp1=aActualite.avecResp1;aJSON.avecResp2=aActualite.avecResp2;}
aJSON.genresPublicEntite=aActualite.genresPublicEntite;aActualite.listePublicEntite.setSerialisateurJSON({methodeSerialisation:null,ignorerEtatsElements:true});aJSON.listePublicEntite=aActualite.listePublicEntite;aActualite.listePublicIndividu.setSerialisateurJSON({methodeSerialisation:_serialiser_Individu.bind(this),ignorerEtatsElements:true});aJSON.listePublicIndividu=aActualite.listePublicIndividu;}
aActualite.listeChoix.setSerialisateurJSON({methodeSerialisation:_serialiser_Choix.bind(this),ignorerEtatsElements:false,nePasTrierPourValidation:true});aJSON.listeChoix=aActualite.listeChoix;aActualite.listeDocumentsJoints.setSerialisateurJSON({methodeSerialisation:_serialiser_Document.bind(this),ignorerEtatsElements:false});aJSON.listeDocuments=aActualite.listeDocumentsJoints;}}
function _serialiser_Document(aDocument,aJSON){var lIdFichier=aDocument.idFichier!==undefined?aDocument.idFichier:(aDocument.Fichier!==undefined?aDocument.Fichier.idFichier:null);if(lIdFichier!==null){aJSON.idFichier=GChaine.CardinalToStr(lIdFichier);}
aJSON.nomFichier=aDocument.nomFichier;aJSON.url=aDocument.url;}
function _serialiser_Individu(aIndividu,aJSON){aJSON.N=aIndividu.GetNumero();aJSON.G=aIndividu.GetGenre();aJSON.E=undefined;aJSON.L=undefined;}
function _serialiser_Choix(aChoix,aJSON){aJSON.rang=aChoix.rang;}})();;
MethodesObjet.heritagePrototype(DonneesListe_Actualites,ObjetDonneesListe);function DonneesListe_Actualites(aDonnees,aParam){this.inheritedCreate(aDonnees);this.callbackMenuContextuel=aParam.evenementMenuContextuel;this.modeAuteur=aParam.auteur;this.avecDeploiement=aParam.deploiement;this.estAffichageSaisie=aParam.estAffichageSaisie;this.droitSaisie=GApplication.droits.get(IEEnum.droits.actualite.avecSaisieActualite);}
DonneesListe_Actualites.genreColonne={genreActualite:0,categorie:1,titre:2,pieceJointe:3,auteur:4,AR:5,destinataire:6,publie:7,etatPublication:8,datePublication:9};DonneesListe_Actualites.genreAction={marquerLu:1,marquerNonLu:2,edition:3,publier:4,depublier:5,dupliquer:6,supprimer:7,creerInfo:8,creerSondage:9,supprimerConsult:10};DonneesListe_Actualites.prototype.AvecSuppression=function(D){return this.droitSaisie&&this.modeAuteur;};DonneesListe_Actualites.prototype.GetLibelleSupression=function(D){var lLibelle=D?D.GetLibelle():'';return lLibelle||'           ';};DonneesListe_Actualites.prototype.GetMessage_Suppression_Confirmation=function(D){return D.estVerrouille?GTraductions.getValeur('actualites.ConfirmationSuppression'):GTraductions.getValeur('liste.suppressionSelection');};DonneesListe_Actualites.prototype.AvecEvenement_Selection=function(I,D){return true;};DonneesListe_Actualites.prototype.AvecEdition=function(I,D){return this.droitSaisie&&this.modeAuteur&&!D.estVerrouille&&(I===DonneesListe_Actualites.genreColonne.publie||I===DonneesListe_Actualites.genreColonne.titre);};DonneesListe_Actualites.prototype.AvecEvenement_ApresEdition=function(aLigne,aColonne){return this.droitSaisie&&this.modeAuteur&&(aColonne===DonneesListe_Actualites.genreColonne.publie||aColonne===DonneesListe_Actualites.genreColonne.titre);};DonneesListe_Actualites.prototype.AvecMenuContextuel=function(aColonne,D,aLigne){if(aLigne===-1&&this.modeAuteur&&this.droitSaisie) return true;return D&&aLigne>=0?this.AvecSelection(aColonne,D):false;};DonneesListe_Actualites.prototype.avecContenuTronque=function(I,D){return true;};DonneesListe_Actualites.prototype.AvecDeploiement=function(D){return this.avecDeploiement;};DonneesListe_Actualites.prototype.AvecDeploiementSurColonne=function(I){return I===DonneesListe_Actualites.genreColonne.genreActualite;};DonneesListe_Actualites.prototype.getNiveauDeploiement=function(I,J){return this.avecDeploiement?2:1;};DonneesListe_Actualites.prototype.estCelluleDeFusionEnLigne=function(I,D){return(D.estUnDeploiement)&&I>DonneesListe_Actualites.genreColonne.genreActualite;};DonneesListe_Actualites.prototype.getClass=function(I,D){var lClass=[];if(I===DonneesListe_Actualites.genreColonne.pieceJointe) lClass.push('DonneesListe_Actualites_PourTitle');if(!D.lue&&!this.modeAuteur) lClass.push('Gras');lClass.push('AlignementGauche');return lClass.join(' ');};DonneesListe_Actualites.prototype.GetCouleurCellule=function(I,D){if(D.estUnDeploiement)
return this.ECouleurCellule.Deploiement;};DonneesListe_Actualites.prototype.GetTypeValeur=function(I,D){if(D.estUnDeploiement)
return this.ETypeCellule.Texte;switch(I){case DonneesListe_Actualites.genreColonne.genreActualite:case DonneesListe_Actualites.genreColonne.pieceJointe:case DonneesListe_Actualites.genreColonne.etatPublication:return this.ETypeCellule.Image;case DonneesListe_Actualites.genreColonne.AR:case DonneesListe_Actualites.genreColonne.publie:return this.ETypeCellule.Coche;case DonneesListe_Actualites.genreColonne.destinataire:return this.ETypeCellule.Texte;default:return this.ETypeCellule.Texte;}};DonneesListe_Actualites.prototype.getHintForce=function(aColonne,aDonnee){if(aDonnee.estUnDeploiement)
return'';switch(aColonne){case DonneesListe_Actualites.genreColonne.genreActualite:return aDonnee.genreReponse===TypeGenreReponseInternetActualite.AvecAR||aDonnee.genreReponse===TypeGenreReponseInternetActualite.SansAR?GTraductions.getValeur('actualites.Edition.Information'):GTraductions.getValeur('actualites.Edition.Questionnaire');case DonneesListe_Actualites.genreColonne.destinataire:return aDonnee.hintDestinataire||'';default:return'';}};DonneesListe_Actualites.prototype.getHintHtmlForce=function(aColonne,aLigne,aDonnee){if(aDonnee.estUnDeploiement)
return'';switch(aColonne){case DonneesListe_Actualites.genreColonne.pieceJointe:var lStrHint='';if(aDonnee.listeDocumentsJoints&&aDonnee.listeDocumentsJoints.GetNbrElementsExistes()>0){for(var lIndice=0;lIndice<aDonnee.listeDocumentsJoints.GetNbrElements();lIndice++){var lEltPJ=aDonnee.listeDocumentsJoints.GetElement(lIndice);if(lEltPJ.Existe()) lStrHint+=lEltPJ.GetLibelle()+'<br />';}}
return lStrHint;default:return'';}};DonneesListe_Actualites.prototype.GetValeur=function(I,D,K,aSurEdition){if(D.estUnDeploiement)
return D.GetLibelle();switch(I){case DonneesListe_Actualites.genreColonne.genreActualite:return D.genreReponse===TypeGenreReponseInternetActualite.AvecAR||D.genreReponse===TypeGenreReponseInternetActualite.SansAR?'Image_ActuInfo':'Image_ActuQuestion';case DonneesListe_Actualites.genreColonne.titre:return D.GetLibelle();case DonneesListe_Actualites.genreColonne.pieceJointe:return D.listeDocumentsJoints&&D.listeDocumentsJoints.GetNbrElements()>0?'Image_Trombone':'';case DonneesListe_Actualites.genreColonne.categorie:return D.categorie.GetLibelle();case DonneesListe_Actualites.genreColonne.auteur:return D.auteur;case DonneesListe_Actualites.genreColonne.AR:return D.avecReponse;case DonneesListe_Actualites.genreColonne.destinataire:if(D.nomDestinataire==='')
return GTraductions.getValeur('actualites.Multiple');else return D.nomDestinataire;break;case DonneesListe_Actualites.genreColonne.publie:return D.publie;case DonneesListe_Actualites.genreColonne.etatPublication:return this.getEtatPublication(D);case DonneesListe_Actualites.genreColonne.datePublication:if(this.estAffichageSaisie)
return D.getDate().ucfirst();else return GDate.FormatDate(D.dateDebut,'%JJ/%MM/%AAAA');break;default:return'';}};DonneesListe_Actualites.prototype.getEtatPublication=function(D){switch(D.etatPublication){case TypeEtatPublication.PublieeDansDate:return'Image_Publie';case TypeEtatPublication.PublieeHorsDate:return'Image_PublieEnAttente';case TypeEtatPublication.PasPubliee:return'Image_NonPublie';default:return'';}};DonneesListe_Actualites.prototype.GetVisible=function(D){return D.visible;};DonneesListe_Actualites.prototype.initialisationObjetContextuel=function(I,D,aInstance,aAvecCreation,aNonEditable,aLigne){if(!aInstance) return;if(aLigne===-1){aInstance.AddCommande(DonneesListe_Actualites.genreAction.creerInfo,GTraductions.getValeur('actualites.creerInfo'),true);aInstance.AddCommande(DonneesListe_Actualites.genreAction.creerSondage,GTraductions.getValeur('actualites.creerSondage'),true);} else if(!this.modeAuteur){aInstance.AddCommande(DonneesListe_Actualites.genreAction.marquerLu,GTraductions.getValeur('actualites.MarquerLu'),!D.lue);aInstance.AddCommande(DonneesListe_Actualites.genreAction.marquerNonLu,GTraductions.getValeur('actualites.MarquerNonLu'),D.lue);if(MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Professeur,EGenreEspace.Etablissement]))
aInstance.AddCommande(DonneesListe_Actualites.genreAction.supprimerConsult,GTraductions.getValeur('actualites.MarquerSupprimee'),true);} else if(this.droitSaisie){aInstance.AddCommande(DonneesListe_Actualites.genreAction.edition,GTraductions.getValeur('actualites.Edition.Modification'),this.droitSaisie);aInstance.AddCommande(DonneesListe_Actualites.genreAction.dupliquer,GTraductions.getValeur('actualites.Edition.Dupliquer'),this.droitSaisie);if(!D.publie)
aInstance.AddCommande(DonneesListe_Actualites.genreAction.publier,GTraductions.getValeur('actualites.Edition.Publier'),this.droitSaisie);else aInstance.AddCommande(DonneesListe_Actualites.genreAction.depublier,GTraductions.getValeur('actualites.Edition.Depublier'),this.droitSaisie);aInstance.AddSeparateur();aInstance.AddCommande(DonneesListe_Actualites.genreAction.supprimer,GTraductions.getValeur('actualites.Edition.Supprimer'),this.droitSaisie);}
aInstance.SetDonnees();};DonneesListe_Actualites.prototype.evenementMenuContextuel=function(aColonne,aLigne,aElement,aLigneMenuContextuel,aElementMenuContextuel){this.callbackMenuContextuel(aColonne,aLigne,aElement,aLigneMenuContextuel,aElementMenuContextuel);};DonneesListe_Actualites.prototype.getTri=function(aColonneDeTri,aGenreTri){if(aColonneDeTri===null||aColonneDeTri===undefined) return[];var lTris=[];if(this.avecDeploiement){lTris.push(ObjetTri.init(function(D){return D.estUnDeploiement?D.aTitreIndividuel:D.pere.aTitreIndividuel;}));lTris.push(ObjetTri.init(function(D){return D.estUnDeploiement?D.GetLibelle():D.pere.GetLibelle();}));lTris.push(ObjetTri.init(function(D){return!D.estUnDeploiement;}));}
switch(aColonneDeTri){case DonneesListe_Actualites.genreColonne.genreActualite:lTris.push(ObjetTri.init(function(D){return!(D.genreReponse===TypeGenreReponseInternetActualite.AvecAR||D.genreReponse===TypeGenreReponseInternetActualite.SansAR);},aGenreTri));break;case DonneesListe_Actualites.genreColonne.pieceJointe:lTris.push(ObjetTri.init(function(D){return!(D.listeDocumentsJoints&&D.listeDocumentsJoints.GetNbrElements()>0);},aGenreTri));break;case DonneesListe_Actualites.genreColonne.categorie:lTris.push(ObjetTri.init(function(D){return D.categorie.GetLibelle();},aGenreTri));break;case DonneesListe_Actualites.genreColonne.auteur:lTris.push(ObjetTri.init('auteurTri',aGenreTri));break;case DonneesListe_Actualites.genreColonne.destinataire:lTris.push(ObjetTri.init('nomDestinataire',aGenreTri));break;case DonneesListe_Actualites.genreColonne.datePublication:lTris.push(ObjetTri.init('dateDebut',aGenreTri));lTris.push(ObjetTri.init('dateFin',aGenreTri));break;case DonneesListe_Actualites.genreColonne.titre:lTris.push(ObjetTri.init('Libelle',aGenreTri));break;default:break;}
lTris.push(ObjetTri.init('Libelle'));return lTris;};DonneesListe_Actualites.prototype.SurEdition=function(I,D,V){switch(I){case DonneesListe_Actualites.genreColonne.titre:D.SetLibelle(V);break;case DonneesListe_Actualites.genreColonne.publie:D.publie=V;break;default:break;}};DonneesListe_Actualites.prototype.autoriserChaineVideSurEdition=function(I,D){return I===DonneesListe_Actualites.genreColonne.titre;};;
MethodesObjet.heritagePrototype(ObjetAffichagePageActualites,ObjetInterfacePage);function ObjetAffichagePageActualites(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.avecAuteur=MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Professeur,EGenreEspace.Etablissement]);this.idBandeauGauche=window.GUID.getId();this.idBandeauDroite=this.Nom+'_BandeauDroite';this.idDatePub=this.Nom+'_datePublication';this.idPublie=this.Nom+'_ImagePublieContenu';this.uniquementNonLues=GEtatUtilisateur.getUniquementNonLues();this.droitSaisie=GApplication.droits.get(IEEnum.droits.actualite.avecSaisieActualite);this.genresAffichages={reception:0,saisie:1};this.genreOnglet={Saisie:0,Resultats:1};this.ongletVisible=false;this.ongletSelectionne=this.genreOnglet.Saisie;this.genreAffichage=this.genresAffichages.reception;this.modeAuteur=false;this.listeElementsAff=new ObjetListeElements();this.listeElementsAff.AddElement(new ObjetElement(GTraductions.getValeur('actualites.Combo.Reception'),null,this.genresAffichages.reception));this.listeElementsAff.AddElement(new ObjetElement(GTraductions.getValeur('actualites.Combo.Saisie'),null,this.genresAffichages.saisie));}(function(){ObjetAffichagePageActualites.prototype.ConstruireInstances=function(){if(this.avecAuteur){this.identRB=this.Add(window.ObjetCheckBox ,_evenementRB.bind(this) ,_initialiserRB.bind(this));this.identOnglet=this.Add(window.ObjetTabOnglets ,_evenementTabOnglet.bind(this) ,_initialiserTabOnglet.bind(this));this.identResultats=this.Add(window.ObjetResultatsActualite);}
this.identNomAff=this.Add(window.ObjetZoneTexte ,null ,_initialiserNomAff.bind(this));this.identListe=this.Add(window.ObjetListe ,_evenementSurListe.bind(this) ,_initialiserListe.bind(this));this.identActualite=this.Add(window.ObjetDetailActualite ,_evenementSurValidationActualite.bind(this) ,_initialiserActualite.bind(this));this.identCBLue=this.Add(window.ObjetCheckBox ,_evenementSurCBLue.bind(this) ,_initialiserCBLue.bind(this));this.identCBPublie=this.Add(window.ObjetCheckBox ,_evenementSurCBPublie.bind(this) ,_initialiserCBPublie.bind(this));this.identCategorie=this.Add(window.ObjetSaisie ,_evenementSurCategorie.bind(this) ,_initialiserCategorie.bind(this));if(this.avecAuteur){this.identEdition=this.Add(window.ObjetBoutonBandeau ,_evenementSurBtnEdition.bind(this) ,_initialiserBtnEdition.bind(this));this.identEditionActu=this.addFenetre(window.ObjetFenetre_EditionActualite ,_evenementEditionActu.bind(this) ,_initialiserEditionActu.bind(this));}};ObjetAffichagePageActualites.prototype.SetParametresGeneraux=function(){this.GenreStructure=EStructureAffichage.Autre;this.IdentZoneAlClient=this.identActualite;};function _initialiserRB(aInstance){aInstance.setOptions_ObjetCheckBox({estRB:true,orientation:EGenreOrientationAffichage.Horizontal,liste:this.listeElementsAff,Selection:new TypeDomaine(1),classCss:'EspaceDroit'});aInstance.SetVisible(this.avecAuteur);}
function _initialiserNomAff(aInstance){aInstance.SetVisible(false);}
function _initialiserActualite(aInstance){aInstance.setOptions({avecEditionActualite:this.genreAffichage===this.genresAffichages.saisie});}
function _initialiserListe(aInstance){var lTitres=[{libelleHtml:'&nbsp;'},{libelle:GTraductions.getValeur('actualites.Colonnes.Categorie')},{libelle:GTraductions.getValeur('actualites.Colonnes.Titre')},{classeCssImage:'Image_Trombone'},{libelle:GTraductions.getValeur('actualites.Colonnes.Auteur')},{libelle:GTraductions.getValeur('actualites.Colonnes.AR')},{libelle:GTraductions.getValeur('actualites.Colonnes.Destinataire')},{classeCssImage:'Image_Publie'},{classeCssImage:'Image_Publie'},{libelle:GTraductions.getValeur('actualites.Colonnes.datePublication')}
];var lColonnesCachees=[];var lTailleDate='150';if(!this.avecAuteur){lColonnesCachees.push(DonneesListe_Actualites.genreColonne.auteur,DonneesListe_Actualites.genreColonne.destinataire,DonneesListe_Actualites.genreColonne.publie,DonneesListe_Actualites.genreColonne.etatPublication);lTailleDate='60';} else{if(this.genreAffichage===this.genresAffichages.saisie){lColonnesCachees.push(DonneesListe_Actualites.genreColonne.auteur,DonneesListe_Actualites.genreColonne.publie);} else{lColonnesCachees.push(DonneesListe_Actualites.genreColonne.destinataire,DonneesListe_Actualites.genreColonne.publie,DonneesListe_Actualites.genreColonne.etatPublication);}}
lColonnesCachees.push(DonneesListe_Actualites.genreColonne.AR);var lTailles=['18','100','100%','18','140','18','100','18','18',lTailleDate];aInstance.setOptionsListe({listeTailles:lTailles,listeTitres:lTitres,colonnesTriables:true,numeroColonneTriDefaut:{numero:DonneesListe_Actualites.genreColonne.datePublication,genre:EGenreTriElement.Decroissant},titreCreation:GTraductions.getValeur('actualites.Creation')});aInstance.setColonnesCachees(lColonnesCachees);}
function _initialiserCBLue(aInstance){var lListeElements=new ObjetListeElements();lListeElements.AddElement(new ObjetElement(GTraductions.getValeur('actualites.UniquementNonLues')+'&nbsp;'));aInstance.setOptions_ObjetCheckBox({liste:lListeElements,Selection:new TypeDomaine(false,2)});aInstance.setParametres_Affichage('Gras');}
function _initialiserCBPublie(aInstance){var lListeElements=new ObjetListeElements();lListeElements.AddElement(new ObjetElement(GTraductions.getValeur('actualites.Publiee')+'&nbsp;'));aInstance.setOptions_ObjetCheckBox({liste:lListeElements,Selection:new TypeDomaine(false,2)});aInstance.setParametres_Affichage('Gras');aInstance.SetVisible(false);}
function _initialiserCategorie(aInstance){aInstance.SetParametres(EGenreSaisie.Combo,150,null,true);}
function _initialiserBtnEdition(aInstance){aInstance.SetParametres('Image_AfficherCrayon',false,false,true,[GTraductions.getValeur('actualites.Edition.Modification'),GTraductions.getValeur('actualites.Edition.Modification'),GTraductions.getValeur('actualites.Edition.NonModifiable')],20,false,true);aInstance.SetVisible(false);}
function _initialiserEditionActu(aInstance){aInstance.SetParametres_Fenetre(GTraductions.getValeur('actualites.Edition.Creation'),700,700,new Array(GTraductions.getValeur('Annuler'),GTraductions.getValeur('Valider')));}
function _initialiserTabOnglet(aInstance){this.listeOnglets=new ObjetListeElements();this.listeOnglets.AddElement(new ObjetElement(GTraductions.getValeur('actualites.Edition.OngletSaisie'),null,this.genreOnglet.Saisie));this.listeOnglets.AddElement(new ObjetElement(GTraductions.getValeur('actualites.Edition.OngletResultats'),null,this.genreOnglet.Resultats));aInstance.SetParametres(this.listeOnglets,true,500,20);}
ObjetAffichagePageActualites.prototype.ConstruireStructureAffichageAutre=function(){var T=[];T.push('<div style="height:100%;">','<table class="AlignementHaut" style="width:100%; height:100%" border="0" cellpadding="0" cellspacing="5">');T.push('<tr id="',this.Nom,'_Page"><td id="',this.Nom+'_P">','<div>','<table class="Tableau" style="width:100%; height:100%;" border="0" cellpadding="0" cellspacing="0">','<tr>','<td id="'+this.Nom+'_ZoneGrille" style="width:10px; height:100%; vertical-align:top;">');T.push('<div>','<table class="Texte10" style="width:100%; height:100%;" border="0" cellpadding="0" cellspacing="0">','<tr><td>',composeBandeauGauche.bind(this)(),'</td></tr>','<tr><td id="',this.Nom+'_P2" style="width: 10px; height:100%;" lass="PetitEspaceHaut" valign="top">','<div class="EspaceHaut" style="width:',(parseInt(this._getLargeur())+GNavigateur.GetLargeurBarreDeScroll()),'px; height:100%;" id="',this.GetInstance(this.identListe).GetNom(),'">&nbsp;</div>','</td></tr>','</table>','</div>');T.push('</td>','<td id="'+this.Nom+'_ZoneGrilleD" class="EspaceGauche" style="height:100%;vertical-align:top;">');T.push('<div>','<table class="Texte10" style="width:100%; height:100%;" border="0" cellpadding="0" cellspacing="0">','<tr><td>',composeBandeauDroite.bind(this)(),'</td></tr>');if(this.GetInstance(this.identOnglet)) T.push('<tr><td id="',this.GetInstance(this.identOnglet).GetNom(),'" style="display:none;" class="EspaceHaut">&nbsp;</td></tr>');T.push('<tr><td id="',this.Nom+'_P3" style="width:100%; height:100%;" class="EspaceHaut" valign="top">');T.push('<div style="height:100%;" id="',this.GetInstance(this.identActualite).GetNom(),'">&nbsp;</div>');if(this.GetInstance(this.identResultats)) T.push('<div style="height:100%;display:none;" id="',this.GetInstance(this.identResultats).GetNom(),'">&nbsp;</div>');T.push('</td></tr>','</table>','</div>');T.push('</td>','</tr>','</table>','</div>','</td></tr>','</table>','</div>');return T.join('');};function composeBandeauGauche(){var T=[];var lHeight=22;T.push('<table class="Texte10" style="width:100%;',GStyle.composeHeight(lHeight),'" border="0" cellpadding="0" cellspacing="0">');T.push('<tr><td class="Gras EspaceGauche MaClasseBordure" style="'+GStyle.composeCouleur(GCouleur.bandeau.fond,GCouleur.bandeau.texte)+' height:',lHeight,'px;">');T.push('<table class="Texte10 Table" border="0" cellpadding="0" cellspacing="0" id="',this.idBandeauGauche,'" tabIndex="-1">');T.push('<tr>');T.push('<td id="',GApplication.idBreadcrumbPerso,'" class="PetitEspaceGauche Insecable">&nbsp</td>');if(this.GetInstance(this.identRB)){T.push('<td class="Gras"><div id="',this.GetInstance(this.identRB).GetNom(),'"></div></td>');}
T.push('<td style="width:100%">&nbsp;</td>');T.push('<td id="',this.GetInstance(this.identCBLue).GetNom(),'"></td>');T.push('<td id="',this.GetInstance(this.identCategorie).GetNom(),'"></td>');T.push('</tr>');T.push('</table>');T.push('</td></tr>');T.push('</table>');return T.join('');}
function composeBandeauDroite(){var T=[];var lHeight=22;T.push('<table class="Texte10" style="width:100%;',GStyle.composeHeight(lHeight),'" border="0" cellpadding="0" cellspacing="0">');T.push('<tr><td class="Gras EspaceGauche MaClasseBordure" style="'+GStyle.composeCouleur(GCouleur.bandeau.fond,GCouleur.bandeau.texte)+' height: ',lHeight,'px;">');T.push('<table class="Texte10 Table" border="0" cellpadding="0" cellspacing="0" id="',this.idBandeauDroite,'" tabIndex="-1">');T.push('<tr>');T.push('<td id="',this.idBandeauDroite,'_Texte" tabIndex="-1" class="Gras" style="width:100%;">','</td>');T.push('<td><div id="',this.idPublie,'" class="hide" style="width:29px"></div></td>');T.push('<td id="',this.GetInstance(this.identCBPublie).GetNom(),'"></td>');T.push('<td id="',this.idDatePub,'" class="Gras Insecable">','</td>');if(this.GetInstance(this.identEdition))
T.push('<td id="',this.GetInstance(this.identEdition).GetNom(),'">','</td>');T.push('</tr>');T.push('</table>');T.push('</td></tr>');T.push('</table>');return T.join('');}
ObjetAffichagePageActualites.prototype.RecupererDonnees=function(){if(!this.Pere.EnConstruction){if(this.GetInstance(this.identRB)){this.GetInstance(this.identRB).SetSelection(true,this.genreAffichage);} else this.ActualiserDonnees();}};ObjetAffichagePageActualites.prototype.ActualiserDonnees=function(){new ObjetRequetePageActualites(this,_actionSurRecupererDonnees.bind(this)).lancerRequete({estAuteur:this.modeAuteur});};ObjetAffichagePageActualites.prototype.AfficherPage=function(){if(this.actualite){this.GetInstance(this.identActualite).SetDonnees(this.actualite);} else this.GetInstance(this.identActualite).SetDonnees(null);};function _evenementSurMenuContextuelListe(aColonne,aLigne ,aElement,aItemMenuContextuel,aElementMenuContextuel){if(this.actualite||aLigne===-1){switch(aItemMenuContextuel.GetNumero()){case DonneesListe_Actualites.genreAction.marquerLu:if(!this.actualite.lue){_changerEtatLue.bind(this)(true);}
break;case DonneesListe_Actualites.genreAction.marquerNonLu:if(this.actualite.lue){_changerEtatLue.bind(this)(false);}
break;case DonneesListe_Actualites.genreAction.supprimerConsult:_changerEtatSupprimee.bind(this)();break;case DonneesListe_Actualites.genreAction.edition:_actionEdition.bind(this)();break;case DonneesListe_Actualites.genreAction.dupliquer:var lActualite=TUtilitaireInformations.initialiserNouveauItem({actualite:this.actualite});lActualite.SetEtat(EGenreEtat.Creation);this.listeActualites.AddElement(lActualite);this.GetInstance(this.identListe).Actualiser(true);this.SetEtatSaisie(true);break;case DonneesListe_Actualites.genreAction.publier:_changerEtatPublie.bind(this)(true,true);break;case DonneesListe_Actualites.genreAction.depublier:_changerEtatPublie.bind(this)(false,true);break;case DonneesListe_Actualites.genreAction.supprimer:if(this.actualite.estVerrouille)
GApplication.getMessage().Afficher(EGenreBoiteMessage.Confirmation,null,GTraductions.getValeur('actualites.ConfirmationSuppression'),null,this,this._evenementSuppression_ApresConfirmation);else this._evenementSuppression_ApresConfirmation(EGenreAction.Valider);break;case DonneesListe_Actualites.genreAction.creerInfo:if(this.GetInstance(this.identEditionActu)){this.GetInstance(this.identEditionActu).SetTitre(GTraductions.getValeur('actualites.creerInfo'));this.GetInstance(this.identEditionActu).SetDonnees({donnee:null,creation:true,genreReponse:TypeGenreReponseInternetActualite.AvecAR});}
break;case DonneesListe_Actualites.genreAction.creerSondage:if(this.GetInstance(this.identEditionActu)){this.GetInstance(this.identEditionActu).SetTitre(GTraductions.getValeur('actualites.creerSondage'));this.GetInstance(this.identEditionActu).SetDonnees({donnee:null,creation:true,genreReponse:TypeGenreReponseInternetActualite.ChoixUnique});}
break;default:break;}}}
function _actionEdition(){if(this.GetInstance(this.identEditionActu)){this.GetInstance(this.identEditionActu).SetTitre(GTraductions.getValeur('actualites.Edition.Modification'));this.GetInstance(this.identEditionActu).SetDonnees({donnee:this.actualite,creation:false});}}
function _evenementRB(aSelection){var lGenreAff=aSelection.GetValeur(1)?this.genresAffichages.reception:this.genresAffichages.saisie;this.actualite=null;this.EvenementSurNavigation(this,lGenreAff);}
ObjetAffichagePageActualites.prototype.RetourSurNavigation=function(aGenreAff){this.genreAffichage=aGenreAff ;this.modeAuteur=this.avecAuteur&&(this.genreAffichage===this.genresAffichages.saisie);var lColonnesCachees=[];var lTailleDate='150';if(!this.avecAuteur){lColonnesCachees.push(DonneesListe_Actualites.genreColonne.auteur,DonneesListe_Actualites.genreColonne.destinataire,DonneesListe_Actualites.genreColonne.publie,DonneesListe_Actualites.genreColonne.etatPublication);lTailleDate='60';} else{if(this.genreAffichage===this.genresAffichages.saisie){lColonnesCachees.push(DonneesListe_Actualites.genreColonne.auteur,DonneesListe_Actualites.genreColonne.publie);} else{lColonnesCachees.push(DonneesListe_Actualites.genreColonne.destinataire,DonneesListe_Actualites.genreColonne.publie,DonneesListe_Actualites.genreColonne.etatPublication);lTailleDate='60';}}
lColonnesCachees.push(DonneesListe_Actualites.genreColonne.AR);var lTailles=['18','100','100%','18','140','18','100','18','18',lTailleDate];if(this.modeAuteur&&GApplication.droits.get(IEEnum.droits.actualite.avecSaisieActualite)){this.GetInstance(this.identListe).setOptionsListe({listeCreations:1,creationLigne:-1,listeTailles:lTailles});} else{this.GetInstance(this.identListe).setOptionsListe({listeCreations:null,creationLigne:null,listeTailles:lTailles});}
$('#'+(this.Nom+'_P2').escapeJQ()).children().width(this._getLargeur());this.GetInstance(this.identListe).SetDonnees(this.listeDonneesActualites=new DonneesListe_Actualites(new ObjetListeElements(),{evenementMenuContextuel:_evenementSurMenuContextuelListe.bind(this),auteur:this.modeAuteur,deploiement:MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Parent,EGenreEspace.Mobile_Parent,EGenreEspace.Entreprise]),estAffichageSaisie:this.genreAffichage===this.genresAffichages.saisie}));this.GetInstance(this.identListe).setColonnesCachees(lColonnesCachees);this.GetInstance(this.identEdition).SetVisible(this.modeAuteur&&GApplication.droits.get(IEEnum.droits.actualite.avecSaisieActualite));this.GetInstance(this.identCBLue).SetVisible(this.genreAffichage===this.genresAffichages.reception);this.GetInstance(this.identActualite).setOptions({avecEditionActualite:this.genreAffichage===this.genresAffichages.saisie});this.ActualiserDonnees();};function _evenementSurCBLue(aSelection){this.uniquementNonLues=aSelection.GetValeur(1);if(!this.modeAuteur) GEtatUtilisateur.setUniquementNonLues(this.uniquementNonLues);_verifierEtatVisibilite.bind(this)();this.GetInstance(this.identListe).Actualiser(true);}
function _evenementSurCBPublie(aSelection,aUser){var lPublie=aSelection.GetValeur(1);_changerEtatPublie.bind(this)(lPublie,aUser);}
function _evenementSurCategorie(aGenreEvenement,aCategorie){if(aGenreEvenement===EGenreEvenementObjetSaisie.selection){this.categorie=aCategorie;GEtatUtilisateur.setCategorie(this.categorie);_verifierEtatVisibilite.bind(this)();this.GetInstance(this.identListe).Actualiser(true);}}
function _evenementSurBtnEdition(){if(this.GetInstance(this.identEditionActu)){this._objGestionFocus_apresFenetreEdition={id:this.GetInstance(this.identEdition).getPremierElement()};this.GetInstance(this.identEditionActu).SetTitre(GTraductions.getValeur('actualites.Edition.Modification'));this.GetInstance(this.identEditionActu).SetDonnees({donnee:this.actualite,creation:false});}}
function _evenementTabOnglet(aElement){this.ongletSelectionne=aElement.GetGenre();if(aElement.GetGenre()===this.genreOnglet.Saisie){$('#'+this.GetInstance(this.identActualite).GetNom().escapeJQ()).show();$('#'+this.GetInstance(this.identResultats).GetNom().escapeJQ()).hide();} else if(aElement.GetGenre()===this.genreOnglet.Resultats){new ObjetRequetePageActualitesResultats(this,_actionSurResultatsActualite.bind(this),function(){this.GetInstance(this.identOnglet).selectOnglet(this.listeOnglets.GetIndiceParNumeroEtGenre(null,this.genreOnglet.Saisie));}).lancerRequete({actualite:this.actualite});}}
function _evenementEditionActu(aGenreBouton,aParam){if(aGenreBouton===1&&aParam&&(this.actualite||aParam.creation)){if(aParam.creation){this.actualite=aParam.donnee;}
if(aParam.donnee.Etat!==EGenreEtat.Aucun){if(aParam.creation){GEtatUtilisateur.setNumeroActuSelectionnee(this.actualite.GetNumero());this.listeActualites.AddElement(this.actualite);}
this.RecupererDonnees();this.ActionSurValidation();}} else{if(this.GetInstance(this.identListe).GetSelection()===-1)
_actualiserActualite.bind(this)(null ,this.modeAuteur);}
_gestionFocus_apresFenetreEdition.bind(this)();}
function _evenementSurValidationActualite(aActualite,aAvecRecupDonnees){var lListeActualites=new ObjetListeElements();lListeActualites.AddElement(aActualite);var lObjetSaisie={listeActualite:lListeActualites,validationDirecte:true,saisieActualite:this.modeAuteur};new ObjetRequeteSaisieActualites(this,_reponseSaisieDirecte.bind(this,aActualite,aAvecRecupDonnees)).lancerRequete(lObjetSaisie);}
function _evenementSurListe(aGenreEvenementListe,aColonne,aLigne,aSurClavier){switch(aGenreEvenementListe){case EGenreEvenementListe.Selection:this.actualite=this.listeActualites.GetElement(aLigne);if(!this.actualite||this.actualite.estUnDeploiement){_actualiserActualite.bind(this)(null,this.modeAuteur);} else{GEtatUtilisateur.setNumeroActuSelectionnee(this.actualite.GetNumero());this.actualite.marqueLueSeulement=false;if((this.actualite.avecReponse||this.actualite.genreReponse===TypeGenreReponseInternetActualite.SansAR)&&!this.actualite.lue&&!this.modeAuteur){this.actualite.lue=true;this.actualite.marqueLueSeulement=true;_evenementSurValidationActualite.bind(this)(this.actualite);this.GetInstance(this.identListe).Actualiser(true);}
_actualiserActualite.bind(this)(this.actualite,this.modeAuteur);}
break;case EGenreEvenementListe.Creation:if(this.GetInstance(this.identEditionActu)){this.GetInstance(this.identEditionActu).SetTitre(GTraductions.getValeur('actualites.Edition.Creation'));this.GetInstance(this.identEditionActu).SetDonnees({donnee:null,creation:true});}
break;case EGenreEvenementListe.ApresEdition:this.actualite.etatPublication=TUtilitaireInformations.getEtatPublication.bind(this)();_actualiserActualite.bind(this)(this.actualite,this.modeAuteur);this.GetInstance(this.identListe).Actualiser(true);break;default:;break;}}
function _afficherReception(){var lDroitSaisie=GApplication.droits.get(IEEnum.droits.actualite.avecSaisieActualite);if(lDroitSaisie!==this.droitSaisie){this.droitSaisie=lDroitSaisie;var lListeCreations=null;var lCreationLigne=null;if(this.modeAuteur&&this.droitSaisie){lListeCreations=1;lCreationLigne= -1;}
this.GetInstance(this.identListe).setOptionsListe({listeCreations:lListeCreations,creationLigne:lCreationLigne});}
var lAvecCumul=TUtilitaireInformations.avecCumul(this.listeActualites);if(lAvecCumul){TUtilitaireInformations.formaterListePourCumul(this.listeActualites);}
this.GetInstance(this.identListe).SetDonnees(this.listeDonneesActualites=new DonneesListe_Actualites(this.listeActualites,{evenementMenuContextuel:_evenementSurMenuContextuelListe.bind(this),auteur:this.modeAuteur,deploiement:lAvecCumul,estAffichageSaisie:this.genreAffichage===this.genresAffichages.saisie}));this.GetInstance(this.identCBLue).SetSelection(this.uniquementNonLues,0);var lNrActualiteSelectionne=GEtatUtilisateur.getNumeroActuSelectionnee();if(lNrActualiteSelectionne){var lIndex=this.listeActualites.GetIndiceExisteParNumeroEtGenre(lNrActualiteSelectionne);if(lIndex> -1) this.actualite=this.listeActualites.GetElement(lIndex);else this.actualite=null;if((lIndex> -1)&&(this.modeAuteur||this.actualite.visible)){this.GetInstance(this.identListe).SelectionnerLigne({ligne:lIndex});_actualiserActualite.bind(this)(this.actualite ,this.modeAuteur);} else{_actualiserActualite.bind(this)(null ,this.modeAuteur);}} else{_actualiserActualite.bind(this)(null ,this.modeAuteur);}}
function _actualiserActualite(aActualite,aAvecSaisie){if(this.GetInstance(this.identOnglet)&&this.GetInstance(this.identResultats)) _gestionVisibiliteOnglet.bind(this)();if(aActualite){GHtml.setHtml(this.idBandeauDroite+'_Texte',aActualite.GetLibelle());GHtml.setTabIndex(this.idBandeauDroite+'_Texte',aActualite.GetLibelle()?'0':'-1');if(aAvecSaisie){if(this.GetInstance(this.identEdition))
this.GetInstance(this.identEdition).SetVisible(this.droitSaisie);this.GetInstance(this.identCBPublie).SetVisible(true);this.GetInstance(this.identCBPublie).SetSelection(aActualite.publie,0);if(this.GetInstance(this.identEdition)){this.GetInstance(this.identEdition).setActif(this.droitSaisie);}
this.GetInstance(this.identCBPublie).SetActif(this.droitSaisie);GHtml.setHtml(this.idDatePub,aActualite.getDate().toLowerCase()+'&nbsp;');$('#'+this.idPublie.escapeJQ()).removeClass("Image_Publie Image_NonPublie hide Image_PublieEnAttente").addClass(this.listeDonneesActualites.getEtatPublication(aActualite));}
this.GetInstance(this.identActualite).SetDonnees(aActualite);} else{this.GetInstance(this.identActualite).SetDonnees();GHtml.setHtml(this.idBandeauDroite+'_Texte','');GHtml.setTabIndex(this.idBandeauDroite+'_Texte','-1');if(this.GetInstance(this.identEdition))
this.GetInstance(this.identEdition).SetVisible(false);this.GetInstance(this.identCBPublie).SetVisible(false);GHtml.setHtml(this.idDatePub,'');$('#'+this.idPublie.escapeJQ()).removeClass("Image_Publie Image_NonPublie Image_PublieEnAttente").addClass("hide");}}
function _changerEtatLue(aEtat){this.actualite.lue=aEtat;_verifierEtatVisibilite.bind(this)();this.actualite.marqueLueSeulement=true;_evenementSurValidationActualite.bind(this)(this.actualite);this.GetInstance(this.identListe).Actualiser(true);}
function _changerEtatSupprimee(aEtat){this.actualite.supprimee=true;this.actualite.marqueLueSeulement=true;_evenementSurValidationActualite.bind(this)(this.actualite,true);this.GetInstance(this.identListe).Actualiser(true);}
function _changerEtatPublie(aPublie,aUser){if(this.actualite&&this.modeAuteur&&aUser){this.actualite.publie=aPublie;this.actualite.etatPublication=TUtilitaireInformations.getEtatPublication.bind(this)();this.actualite.SetEtat(EGenreEtat.Modification);this.SetEtatSaisie(true);_actualiserActualite.bind(this)(this.actualite,this.modeAuteur);this.GetInstance(this.identListe).Actualiser(true);}}
function _verifierEtatVisibilite(){for(var i=0 ;this.listeActualites&&(i<this.listeActualites.GetNbrElements());i++){var lActu=this.listeActualites.GetElement(i);if(lActu.estUnDeploiement)
lActu.visible=false;else lActu.visible=true;if(!lActu.estUnDeploiement){if(this.uniquementNonLues&&!this.modeAuteur)
lActu.visible=!lActu.lue;if(this.categorie&&this.categorie.existeNumero())
lActu.visible=lActu.categorie.GetNumero()===this.categorie.GetNumero();if(lActu.visible&&lActu.pere)
lActu.pere.visible=true;}}
if(this.actualite&&!this.actualite.visible){this.actualite=null;GEtatUtilisateur.setNumeroActuSelectionnee(null);_actualiserActualite.bind(this)(null ,this.modeAuteur);}}
function _gestionVisibiliteOnglet(){if(!this.actualite||!this.actualite.resultats) this.GetInstance(this.identOnglet).selectOnglet(this.listeOnglets.GetIndiceParNumeroEtGenre(null,this.genreOnglet.Saisie));if(this.genreAffichage===this.genresAffichages.saisie&&this.actualite&&this.actualite.genreReponse!==TypeGenreReponseInternetActualite.SansAR){$('#'+this.GetInstance(this.identOnglet).GetNom().escapeJQ()).show();$('#'+this.Nom.escapeJQ()+'_P3').addClass('Bordure Espace');this.ongletVisible=true;} else{$('#'+this.GetInstance(this.identOnglet).GetNom().escapeJQ()).hide();$('#'+this.Nom.escapeJQ()+'_P3').removeClass('Bordure Espace');this.ongletVisible=false;}
if(this.GetInstance(this.identOnglet).getElementSectionne().GetGenre()===this.genreOnglet.Saisie){$('#'+this.GetInstance(this.identActualite).GetNom().escapeJQ()).show();$('#'+this.GetInstance(this.identResultats).GetNom().escapeJQ()).hide();} else{$('#'+this.GetInstance(this.identActualite).GetNom().escapeJQ()).hide();$('#'+this.GetInstance(this.identResultats).GetNom().escapeJQ()).show();_actionSurResultatsActualite.bind(this)(this.actualite);}
this.surResizeInterface();}
function _getEtatPublication(aActualite){var lActualite=aActualite?aActualite:this.actualite;if(!lActualite.publie){return TypeEtatPublication.PasPubliee;} else{if(GDate.dateEstDansLaPeriode(GDate.getDateCourante(),lActualite.dateDebut ,lActualite.dateFin)){return TypeEtatPublication.PublieeDansDate;} else{return TypeEtatPublication.PublieeHorsDate;}}}
function _actionSurRecupererDonnees(aDonnees){this.listeCategories=aDonnees.listeCategories;this.GetInstance(this.identCategorie).SetDonnees(this.listeCategories,GEtatUtilisateur.getCategorie()?this.listeCategories.GetIndiceParElement(GEtatUtilisateur.getCategorie()):0);this.listeActualites=aDonnees.listeActualites;for(var i=0;i<this.listeActualites.GetNbrElements() ;i++){var lActualite=this.listeActualites.GetElement(i);lActualite.getDate=TUtilitaireInformations.getDate.bind(lActualite);}
_afficherReception.bind(this)();this.avecElementsSaisie=aDonnees.avecElementsSaisie;if(this.GetInstance(this.identRB))
this.GetInstance(this.identRB).SetVisible(this.avecAuteur&&(this.avecElementsSaisie||GApplication.droits.get(IEEnum.droits.actualite.avecSaisieActualite)));if(this.avecAuteur&&(this.avecElementsSaisie||GApplication.droits.get(IEEnum.droits.actualite.avecSaisieActualite))){if(this.GetInstance(this.identRB))
$('#'+this.GetInstance(this.identRB).GetNom().escapeJQ()).parent().show();} else{if(this.GetInstance(this.identRB))
$('#'+this.GetInstance(this.identRB).GetNom().escapeJQ()).parent().hide();$('#'+this.GetInstance(this.identNomAff).GetNom().escapeJQ()).show();}}
function _actionSurResultatsActualite(aActualite){$('#'+this.GetInstance(this.identActualite).GetNom().escapeJQ()).hide();$('#'+this.GetInstance(this.identResultats).GetNom().escapeJQ()).show();this.GetInstance(this.identResultats).SetDonnees(aActualite);}
function _reponseSaisie(){this.SetEtatSaisie(false);if(this.modeAuteur) this.RecupererDonnees();this.ActionSurValidation();}
function _reponseSaisieDirecte(aActualite,aAvecRecupDonnees){aActualite.marqueLueSeulement=false;if(!!aAvecRecupDonnees){this.RecupererDonnees();} else{this.GetInstance(this.identListe).Actualiser(true);}}
ObjetAffichagePageActualites.prototype._evenementSuppression_ApresConfirmation=function(aAccepte){if(aAccepte===EGenreAction.Valider){this.actualite.SetEtat(EGenreEtat.Suppression);this.actualite.visible=false;this.SetEtatSaisie(true);this.actualite=null;GEtatUtilisateur.setNumeroActuSelectionnee(null);this.GetInstance(this.identListe).Actualiser();_actualiserActualite.bind(this)(null ,this.modeAuteur);}};ObjetAffichagePageActualites.prototype.Valider=function(){var lObjetSaisie={listeActualite:this.listeActualites,validationDirecte:false,saisieActualite:this.modeAuteur};new ObjetRequeteSaisieActualites(this,_reponseSaisie.bind(this)).lancerRequete(lObjetSaisie);};ObjetAffichagePageActualites.prototype.surResizeInterface=function(){this.inherited('surResizeInterface');GPosition.declencherResize(this.Nom+'_P');GPosition.declencherResize(this.Nom+'_ZoneGrille');GPosition.declencherResize(this.Nom+'_ZoneGrilleD');GPosition.declencherResizeCommun([this.Nom+'_P2',this.Nom+'_P3'],[-5,this.ongletVisible?-13:-8]);this.GetInstance(this.identActualite).resize();};function _gestionFocus_apresFenetreEdition(){if(this._objGestionFocus_apresFenetreEdition&&this._objGestionFocus_apresFenetreEdition.id)
GHtml.setFocus(this._objGestionFocus_apresFenetreEdition.id);this._objGestionFocus_apresFenetreEdition=null;}
ObjetAffichagePageActualites.prototype._getLargeur=function(){return this.avecAuteur?650:500;};})();;
(function(){function _filtreSelonCategorie(aCategorie,aElement,aIndice){return((aCategorie.GetNumero()===aElement.categorie.GetNumero())||((!aCategorie.existeNumero()&&!aElement.avecReponse)));}
ObjetAffichagePageActualites.prototype.AfficherListe=function(){var lIdListe=this.Nom+'_Liste';this._objetListeArborescente=new ObjetListeArborescente(lIdListe,0,this,null);var lRacine=this._objetListeArborescente.construireRacine();this._objetListeArborescente.setParametres(false);var lPremierElement=true;var lTitre='';var I=0;var lElement;var lNoeudListeElements;var lNoeudElement;var lCategorie;var lListe=this.listeActualites;if(lListe.GetNbrElements()>0){lTitre=GEtatUtilisateur.getLibelleOnglet();lNoeudListeElements=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lRacine,lIdListe+'_Liste_'+I,lTitre,'Gras',lPremierElement,lPremierElement);lPremierElement=false;for(var J=0;J<lListe.GetNbrElements();J++){lElement=lListe.GetElement(J);lTitre=lElement.GetLibelle();lNoeudElement=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lNoeudListeElements,'',lTitre,'Gras');lTitre=this.composeDetailActualite(lElement);if(lTitre) this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudElement,'',lTitre);}}
GHtml.setHtml(this.Nom,this._objetListeArborescente.ConstruireAffichage());this._objetListeArborescente.SetDonnees(lRacine);};ObjetAffichagePageActualites.prototype.composeDetailActualite=function(aActualite){var H=[];H.push('<div style="padding:0px 5px;">',aActualite.message,'</div>');if(aActualite.listeDocumentsJoints&&aActualite.listeDocumentsJoints.GetNbrElements()>0)
H.push('<div style="padding:0px 5px;">',this.composeDocuments(aActualite.listeDocumentsJoints),'</div>');if(aActualite.signataire) H.push('<div class="Texte10" style="padding:0px 5px;">',aActualite.signataire,'</div>');return H.join('');};ObjetAffichagePageActualites.prototype.composeDocuments=function(aListeDocumentsJoints){var lHtml=[];for(var I=0;I<aListeDocumentsJoints.GetNbrElements();I++){var lDocumentJoint=aListeDocumentsJoints.GetElement(I);lHtml.push('<a class="Texte10" href="'+GChaine.GetChainePourUrl(GApplication.getCommunication().composeUrlFichierExterne(lDocumentJoint.GetLibelle(),{"N":lDocumentJoint.GetNumero(),"G":EGenreRessource.DocJointEtablissement}),true)+'" target="_blank">'+lDocumentJoint.GetLibelle()+'</a>');}
return lHtml.join(', ');};}());;
MethodesObjet.heritagePrototype(ObjetCalendrierAnnuel,Identite);function ObjetCalendrierAnnuel(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.options={premiereDate:GParametres.PremiereDate,derniereDate:GParametres.DerniereDate,avecJourCourant:true,avecFrequences:false,ligneDate:true,numeroJour:false,initialeJour:false,hauteurLigne:false,cadreTotal:false,joursOuvres:{fond:{couleur:GCouleur.cumul},texte:{couleur:GCouleur.blanc,alignement:"center",poid:"bold"},domaine:GParametres.JoursOuvres,symbolImpression:"-",editable:false,editablePeriode:false} ,joursFeries:{fond:{couleur:GCouleur.cumul},texte:{couleur:GCouleur.blanc,alignement:"center",poid:"bold"},domaine:GParametres.JoursFeries,symbolImpression:"-",editable:false,editablePeriode:false}};this.idTable=this.Nom+'_calannuel';this.idNumDay=this.Nom+'_numday_';this.idDays=this.Nom+'_day_';this.idMonths=this.Nom+'_month_';this.idJourCourantHov=this.Nom+'_currentdayhov';this.idMonthHov=this.Nom+'_monthhov';this.idDayHov=this.Nom+'_dayhov';this.classJourNonOuvre='ObjetCalendrierAnnuel_journonouvre';this.classNomJour='ObjetCalendrierAnnuel_nomjour';this.classNumeroJour='ObjetCalendrierAnnuel_numerojour';this.param={};this.donnees={};this.listeDonneesEditable=[];this.listeDonneesEditablePeriode=[];this.genreEditionPeriode={Ajout:0,Suppression:1};this.donneesEditionPeriode=null;this.SetParametres();}
ObjetCalendrierAnnuel.prototype.Afficher=function(H){this.inherited('Afficher');if(!$.isEmptyObject(this.donnees)){this.afficherDonnees();}
this.ajouterEvenement();};ObjetCalendrierAnnuel.prototype.SetParametres=function(aOptions){var lStyle={defaut:{bordure:{couleur:GCouleur.bordure,taille:'1px',style:'solid'},fond:{couleur:GCouleur.blanc},texte:{couleur:GCouleur.noir,alignement:"center",poid:"bold"}},surbrillance:{bordure:{couleur:GCouleur.themeCouleur.sombre,taille:'2px',style:'solid'}},jourCourant:{bordure:{couleur:GCouleur.themeCouleur.sombre,taille:'2px',style:'solid'}},titre:{bordure:{couleur:GCouleur.liste.titre.bordure,taille:'1px',style:'solid'},fond:{couleur:GCouleur.liste.titre.fond},texte:{couleur:GCouleur.liste.titre.texte,alignement:"center",poid:"bold"}},nomJour:{fond:{couleur:GCouleur.themeNeutre.legere},texte:{couleur:GCouleur.themeNeutre.sombre,alignement:"center",poid:"normal"},hauteur:0.35},editionPeriode:{ajout:{fond:{couleur:'green'},texte:{couleur:'black'}},suppression:{fond:{couleur:'red'},texte:{couleur:'white'}}}};var lOptionsTemp={style:lStyle,joursOuvres:{fond:{couleur:GCouleur.themeNeutre.claire},texte:{couleur:GCouleur.blanc}},joursFeries:{fond:{couleur:GCouleur.themeNeutre.sombre},texte:{couleur:GCouleur.blanc}}};$.extend(true,this.options,lOptionsTemp,aOptions);this.param.styleCelluleDefaut='border: '+this.options.style.defaut.bordure.couleur+' '+this.options.style.defaut.bordure.taille+' '+this.options.style.defaut.bordure.style+';background:'+this.options.style.defaut.fond.couleur+';color:'+this.options.style.defaut.texte.couleur+';text-align:'+this.options.style.defaut.texte.alignement+';font-weight:'+this.options.style.defaut.texte.poid+';padding:0;';this.param.styleCelluleNonOuvre='border: '+this.options.style.defaut.bordure.couleur+' '+this.options.style.defaut.bordure.taille+' '+this.options.style.defaut.bordure.style+';background:'+this.options.joursOuvres.fond.couleur+';color:'+this.options.joursOuvres.texte.couleur+';text-align:'+this.options.joursOuvres.texte.alignement+';font-weight:'+this.options.joursOuvres.texte.poid+';padding:0;';this.param.styleCelluleFerie='border: '+this.options.style.defaut.bordure.couleur+' '+this.options.style.defaut.bordure.taille+' '+this.options.style.defaut.bordure.style+';background:'+this.options.joursFeries.fond.couleur+';color:'+this.options.joursFeries.texte.couleur+';text-align:'+this.options.joursFeries.texte.alignement+';font-weight:'+this.options.joursFeries.texte.poid+';padding:0;';this.param.styleCelluleSurbrillance=':'+this.options.style.surbrillance.bordure.couleur+' '+this.options.style.surbrillance.bordure.taille+' '+this.options.style.surbrillance.bordure.style+';';this.param.styleCelluleJourCourant=':'+this.options.style.jourCourant.bordure.couleur+' '+this.options.style.jourCourant.bordure.taille+' '+this.options.style.jourCourant.bordure.style+';';this.param.styleCelluleTitre='border: '+this.options.style.titre.bordure.couleur+' '+this.options.style.titre.bordure.taille+' '+this.options.style.titre.bordure.style+';background:'+this.options.style.titre.fond.couleur+';color:'+this.options.style.titre.texte.couleur+';text-align:'+this.options.style.titre.texte.alignement+';font-weight:'+this.options.style.titre.texte.poid+';padding:0;';this.param.styleNomJour='background:'+this.options.style.nomJour.fond.couleur+';color:'+this.options.style.nomJour.texte.couleur+';text-align:'+this.options.style.nomJour.texte.alignement+';font-weight:'+this.options.style.nomJour.texte.poid+';height:'+(this.options.style.nomJour.hauteur*100)+'%;font-size:'+(this.options.style.nomJour.hauteur*200)+'%;';this.param.largeurColonne=Math.floor(100/(31+3));if(!this.options.hauteurLigne&&GNavigateur.IsIE){var lNbMois=0;while(new Date(this.options.premiereDate.getFullYear(),this.options.premiereDate.getMonth()+lNbMois)<this.options.derniereDate){lNbMois++;}
this.param.hauteurColonne=Math.floor(1000/(lNbMois+(this.options.ligneDate?1:0)))/10;}
this.Afficher();};ObjetCalendrierAnnuel.prototype.SetDonnees=function(aDonnees){var lDate,lElement;if($.isEmptyObject(this.options)){this.SetParametres();}
if(this.options.avecFrequences){this.donnees.frequences={donnees:new ObjetListeElements(),variables:['date'],couleur:this.options.joursOuvres.fond.couleur,texte:{couleur:this.options.joursOuvres.texte.couleur},symbolImpression:this.options.joursOuvres.symbolImpression,editable:false,editablePeriode:false,nonEditable:true};for(lDate=new Date(this.options.premiereDate.getTime());lDate<=this.options.derniereDate;lDate.setDate(lDate.getDate()+1)){lElement=new ObjetElement();lElement.date=new Date(lDate.getTime());lElement.couleur=EGenreDomaineFrequence.getCouleur(GParametres.frequences[GDate.GetSemaine(lDate)].genre);this.donnees.frequences.donnees.AddElement(lElement);}}
if(!this.options.joursOuvres.editable){this.donnees.joursOuvres={donnees:new ObjetListeElements(),variables:['date'],couleur:this.options.joursOuvres.fond.couleur,texte:{couleur:this.options.joursOuvres.texte.couleur},symbolImpression:this.options.joursOuvres.symbolImpression,editable:false,editablePeriode:false,nonEditable:true};for(lDate=new Date(this.options.premiereDate.getTime());lDate<=this.options.derniereDate;lDate.setDate(lDate.getDate()+1)){if(this.options.joursOuvres.domaine.GetValeur(GDate.GetJourDeDate(lDate)+1)){continue;}
lElement=new ObjetElement();lElement.date=new Date(lDate.getTime());this.donnees.joursOuvres.donnees.AddElement(lElement);}}
if(!this.options.joursFeries.editable){this.donnees.joursFeries={donnees:new ObjetListeElements(),variables:['date'],couleur:this.options.joursFeries.fond.couleur,texte:{couleur:this.options.joursFeries.texte.couleur},symbolImpression:this.options.joursFeries.symbolImpression,editable:false,editablePeriode:false,nonEditable:true};for(lDate=new Date(this.options.premiereDate.getTime());lDate<=this.options.derniereDate;lDate.setDate(lDate.getDate()+1)){if(!this.options.joursFeries.domaine.GetValeur(GDate.getNbrJoursDepuisPremiereDate(lDate))){continue;}
lElement=new ObjetElement();lElement.date=new Date(lDate.getTime());this.donnees.joursFeries.donnees.AddElement(lElement);}}
if(aDonnees){$.extend(true,this.donnees,aDonnees);this.afficherDonnees();}};ObjetCalendrierAnnuel.prototype.ConstruireAffichage=function(){var H=[],i=0;H.push('<div style="position:relative;width:100%;height:100%;">');if(this.options.avecJourCourant){H.push('<div id="'+this.idJourCourantHov+'" style="position:absolute;width:0;height:0;">');H.push('<div id="'+this.idJourCourantHov+'_top" style="position:absolute;border-top'+this.param.styleCelluleJourCourant+'"></div>');H.push('<div id="'+this.idJourCourantHov+'_left" style="position:absolute;border-left'+this.param.styleCelluleJourCourant+'"></div>');H.push('<div id="'+this.idJourCourantHov+'_bottom" style="position:absolute;border-top'+this.param.styleCelluleJourCourant+'"></div>');H.push('<div id="'+this.idJourCourantHov+'_right" style="position:absolute;border-left'+this.param.styleCelluleJourCourant+'"></div>');H.push('</div>');}
H.push('<div id="'+this.idMonthHov+'" style="position:absolute;display:none;border'+this.param.styleCelluleSurbrillance+'"></div>');H.push('<div id="'+this.idDayHov+'" style="position:absolute;display:none;border'+this.param.styleCelluleSurbrillance+'"></div>');H.push('<table id="'+this.idTable+'" class="Tableau" style="width:100%;'+(this.options.hauteurLigne?'':'height:100%;')+(this.options.cadreTotal?'border: '+this.options.style.defaut.bordure.couleur+' '+this.options.style.defaut.bordure.taille+' '+this.options.style.defaut.bordure.style+';':'')+'">');if(this.options.ligneDate){H.push('<tr>');H.push('<td style="width:'+3*this.param.largeurColonne+'%;"></td>');for(i=1;i<=31;i++){H.push('<td id="'+this.idNumDay+i+'_num" class="Titre" style="'+this.param.styleCelluleTitre+'width:'+this.param.largeurColonne+'%;'+(this.options.hauteurLigne?'height:'+this.options.hauteurLigne+';':'')+'">'+i+'</td>');}
H.push('</tr>');}
var lMoisActuel=this.options.premiereDate.getMonth();var lAnneeActuel=this.options.premiereDate.getFullYear();while(new Date(lAnneeActuel,lMoisActuel,1)<=this.options.derniereDate){H.push('<tr>');H.push('<td id="'+this.idMonths+lMoisActuel+'_'+lAnneeActuel+'_lib" style="'+this.param.styleCelluleTitre+'width:'+3*this.param.largeurColonne+'%;'+(this.options.hauteurLigne?'height:'+this.options.hauteurLigne+';':'')+'">'+GDate.StrMoisCourt(lAnneeActuel,lMoisActuel,true)+'</td>');for(i=1;i<=31;i++){var lDate=new Date(lAnneeActuel,lMoisActuel,i);var lExisteDansPeriode=lDate<=GDate.GetDernierJourDuMois(lAnneeActuel,lMoisActuel)&&lDate<=this.options.derniereDate&&lDate>=this.options.premiereDate;var lEstNonOuvre=!this.options.joursOuvres.domaine.GetValeur(GDate.GetJourDeDate(lDate)+1);var lEstFerie=this.options.joursFeries.domaine.GetValeur(GDate.getNbrJoursDepuisPremiereDate(lDate));if(lExisteDansPeriode){H.push('<td class="'+(lEstFerie?this.classJourFerie+' ':lEstNonOuvre?this.classJourNonOuvre+' ':'')+'AlignementHaut" id="'+this.idDays+i+'_'+lMoisActuel+'_'+lAnneeActuel+'_cel" style="'+(!lEstNonOuvre?this.param.styleCelluleDefaut:this.param.styleCelluleNonOuvre)+'width:'+this.param.largeurColonne+'%;'+(this.options.hauteurLigne?'height:'+this.options.hauteurLigne+';':(GNavigateur.IsIE?'height:'+this.param.hauteurColonne+'%;':''))+'">');if(this.options.initialeJour||this.options.numeroJour){H.push('<table cellpadding="0" cellspacing="0" style="margin:0;padding:0;width:100%;height:100%;" class="AlignementMilieu AlignementCentre">');if(this.options.initialeJour){H.push('<tr><td class="'+this.classNomJour+'" style="'+this.param.styleNomJour+'">'+GDate.FormatDate(lDate,'%JJJ').substr(0,1).toUpperCase()+'</td></tr>');}
if(this.options.numeroJour){H.push('<tr><td class="'+this.classNumeroJour+'">'+i+'</td></tr>');}
H.push('</table>');}
H.push('</td>');} else{H.push('<td style="','width:'+this.param.largeurColonne+'%;','"></td>');}}
H.push('</tr>');var lDateTemp=new Date(lAnneeActuel,lMoisActuel+1);lMoisActuel=lDateTemp.getMonth();lAnneeActuel=lDateTemp.getFullYear();}
H.push('</table>');H.push('</div>');return H.join('');};ObjetCalendrierAnnuel.prototype.ajouterEvenement=function(){$('#'+this.idTable.escapeJQ()).off('mouseenter mouseleave').on('mouseenter mouseleave','td[id$="_cel"]',{aObjet:this},this.celluleActive);if(this.options.avecJourCourant){var lDateCourante=GDate.getDateCourante();var lJqCellJourCourant=$('#'+this.idDays.escapeJQ()+lDateCourante.getDate()+'_'+lDateCourante.getMonth()+'_'+lDateCourante.getFullYear()+'_cel');if(lJqCellJourCourant.length===1){$('#'+this.idJourCourantHov.escapeJQ()).css({top:lJqCellJourCourant.position().top,left:lJqCellJourCourant.position().left});$('#'+this.idJourCourantHov.escapeJQ()+'_top').css({width:lJqCellJourCourant.width()+1,height:0,top:-1,left:-1});$('#'+this.idJourCourantHov.escapeJQ()+'_left').css({width:0,height:lJqCellJourCourant.height()+1,top:0,left:-1});$('#'+this.idJourCourantHov.escapeJQ()+'_bottom').css({width:lJqCellJourCourant.width()+2,height:0,top:lJqCellJourCourant.height(),left:0});$('#'+this.idJourCourantHov.escapeJQ()+'_right').css({width:0,height:lJqCellJourCourant.height()+1,top:-1,left:lJqCellJourCourant.width()});}}};ObjetCalendrierAnnuel.prototype.formaterPourImpression=function(aNoeudDom){var prop,i,j;$(aNoeudDom).find('.'+this.classJourNonOuvre).text(this.options.joursOuvres.symbolImpression);$(aNoeudDom).find('#'+this.idJourCourantHov.escapeJQ()).remove();for(prop in this.donnees){if(!$.isFunction(this.donnees[prop])){var lDonnees=$.isFunction(this.donnees[prop].filtre)?this.donnees[prop].donnees.getListeElements(this.donnees[prop].filtre):this.donnees[prop].donnees;for(i=0;i<lDonnees.GetNbrElements();i++){var lElement=lDonnees.GetElement(i);if(!lElement.Existe()){continue;}
var lStart=lElement[this.donnees[prop].variables[0]];var lStop=this.donnees[prop].variables[1]?lElement[this.donnees[prop].variables[1]]:lStart;for(j=lStart;j<=lStop;j=new Date(j.getFullYear(),j.getMonth(),j.getDate()+1)){var lJqCel=$(aNoeudDom).find('#'+this.idDays.escapeJQ()+j.getDate()+'_'+j.getMonth()+'_'+j.getFullYear()+'_cel');lJqCel.text(this.donnees[prop].symbolImpression||'');}}}}};ObjetCalendrierAnnuel.prototype.afficherDonnees=function(){function _onclick(event){if($(this).data('nonedit')!==true){if($(this).data('etatedit')===event.data.aValeur){var lEventCouleur=(event.data.aSuivant=== -1&&$(this).data("couleurOrigine"))?$(this).data("couleurOrigine"):event.data.aCouleur;var lEventCouleurTexte=(event.data.aSuivant=== -1&&$(this).data("couleurOrigineTexte"))?$(this).data("couleurOrigineTexte"):event.data.aCouleurTexte;$(this).css({backgroundColor:lEventCouleur,color:lEventCouleurTexte}).data('etatedit',event.data.aSuivant);event.stopImmediatePropagation();}}
return false;}
var lClassJourNonOuvre=this.classJourNonOuvre;var lCouleurNonOuvre=this.options.joursOuvres.fond.couleur;var lCouleurTexteNonOuvre=this.options.joursOuvres.texte.couleur;var lCouleurTexteOuvre=this.options.style.defaut.texte.couleur;var lCouleurDefaut=this.options.style.defaut.fond.couleur;var prop,i,j,lJqCel;$('#'+this.Nom.escapeJQ()+' td[id$="_cel"]').each(function(){$(this).css({backgroundColor:function(){return $(this).hasClass(lClassJourNonOuvre)?lCouleurNonOuvre:lCouleurDefaut;},color:function(){return $(this).hasClass(lClassJourNonOuvre)?lCouleurTexteNonOuvre:lCouleurTexteOuvre;}}).data("etatedit",-1);});this.listeDonneesEditable=[];this.listeDonneesEditablePeriode=[];$('.'+lClassJourNonOuvre).css({color:lCouleurTexteNonOuvre}).data("couleurOrigine",lCouleurNonOuvre).data("couleurOrigineTexte",lCouleurTexteNonOuvre);for(prop in this.donnees){if(!$.isFunction(this.donnees[prop])){var lDonnees=$.isFunction(this.donnees[prop].filtre)?this.donnees[prop].donnees.getListeElements(this.donnees[prop].filtre):this.donnees[prop].donnees;var lCouleur=this.donnees[prop].couleur;var lCouleurTexte=this.donnees[prop].texte&&this.donnees[prop].texte.couleur?this.donnees[prop].texte.couleur:this.options.style.defaut.texte.couleur;var lEstNonEditable=this.donnees[prop].nonEditable?true:false;var lEstEditable=false;if(this.donnees[prop].editable){this.listeDonneesEditable.push(prop);lEstEditable=true;if(this.donnees[prop].editablePeriode){this.listeDonneesEditablePeriode.push(this.listeDonneesEditable.length-1);}}
for(i=0;i<lDonnees.GetNbrElements();i++){var lElement=lDonnees.GetElement(i);if(!lElement.Existe()){continue;}
var lStart=lElement[this.donnees[prop].variables[0]];var lStop=this.donnees[prop].variables[1]?lElement[this.donnees[prop].variables[1]]:lStart;for(j=lStart;j<=lStop;j=new Date(j.getFullYear(),j.getMonth(),j.getDate()+1)){lJqCel=$('#'+this.idDays.escapeJQ()+j.getDate()+'_'+j.getMonth()+'_'+j.getFullYear()+'_cel');lJqCel.css({background:lElement.couleur||lCouleur,color:lCouleurTexte});if(lElement.Libelle!==""){lJqCel.data("title",lElement.Libelle);}
if(lEstNonEditable){lJqCel.data("nonedit",true);}
if(lEstEditable){lJqCel.data("etatedit",(this.listeDonneesEditable.length-1));} else{lJqCel.data("couleurOrigine",lCouleur);lJqCel.data("couleurOrigineTexte",lCouleurTexte);}}}}}
var lJqThis=$('#'+this.Nom.escapeJQ());lJqThis.off('click','td[id]');if(this.listeDonneesEditable.length>0){var lThis=this;lJqThis.find('td[id]').each(function(){if($(this).data('nonedit')!==true&&$(this).data('etatedit')===undefined){$(this).data('etatedit',-1);$(this).data('couleurOrigine',lThis.options.style.defaut.fond.couleur);$(this).data('couleurOrigineTexte',lThis.options.style.defaut.texte.couleur);}});for(i=-1;i<this.listeDonneesEditable.length;i++){var lValeurNext,lCouleurEvent,lCouleurTexteEvent;if(i===this.listeDonneesEditable.length-1){lValeurNext= -1;lCouleurEvent=this.options.style.defaut.fond.couleur;lCouleurTexteEvent=this.options.style.defaut.texte.couleur;} else{lValeurNext=i+1;lCouleurEvent=this.donnees[this.listeDonneesEditable[i+1]].couleur;lCouleurTexteEvent=this.donnees[this.listeDonneesEditable[i+1]].texte&&this.donnees[this.listeDonneesEditable[i+1]].texte.couleur?this.donnees[this.listeDonneesEditable[i+1]].texte.couleur:this.options.style.defaut.texte.couleur;}
lJqThis.on('click','td[id]',{aValeur:i,aCouleur:lCouleurEvent,aCouleurTexte:lCouleurTexteEvent,aSuivant:lValeurNext},_onclick);}
;if(this.listeDonneesEditablePeriode.length===1){lJqThis.on('mousedown','td[id]',{aThis:this,aValeur:this.listeDonneesEditablePeriode[0]},function(event){var lThis=event.data.aThis;if($(this).data('nonedit')!==true&&lThis.donneesEditionPeriode===null){if($(this).data('etatedit')===event.data.aValeur||$(this).data('etatedit')=== -1){var lDate=this.id.match(/([0-9]{1,2})_([0-9]{1,2})_([0-9]{4})_cel$/);lThis.donneesEditionPeriode={mode:$(this).data('etatedit')===event.data.aValeur?lThis.genreEditionPeriode.Suppression:lThis.genreEditionPeriode.Ajout,start:new Date(lDate[3],lDate[2],lDate[1])};event.stopImmediatePropagation();}} else{lThis.donneesEditionPeriode=null;}
return false;});lJqThis.on('mouseenter','td[id]',{aThis:this,aValeur:this.listeDonneesEditablePeriode[0]},function(event){var lThis=event.data.aThis;if(lThis.donneesEditionPeriode!==null){var lDate=this.id.match(/([0-9]{1,2})_([0-9]{1,2})_([0-9]{4})_cel$/);var lDateStart=lThis.donneesEditionPeriode.start;var lDateStop=lThis.donneesEditionPeriode.stop;var lStart,lStop;if(lDateStart<=lDateStop||lDateStop===undefined){lStart=lDateStart;lStop=lDateStop;} else{lStart=lDateStop;lStop=lDateStart;}
if(lDateStop!==undefined) for(j=lStart;j<=lStop;j=new Date(j.getFullYear(),j.getMonth(),j.getDate()+1)){lJqCel=$('#'+lThis.idDays.escapeJQ()+j.getDate()+'_'+j.getMonth()+'_'+j.getFullYear()+'_cel');lJqCel.find('td.ObjetCalendrierAnnuel_numerojour').css({backgroundColor:'',color:''});}
lThis.donneesEditionPeriode.stop=lDateStop=new Date(lDate[3],lDate[2],lDate[1]);if(lDateStart<=lDateStop){lStart=lDateStart;lStop=lDateStop;} else{lStart=lDateStop;lStop=lDateStart;}
for(j=lStart;j<=lStop;j=new Date(j.getFullYear(),j.getMonth(),j.getDate()+1)){lJqCel=$('#'+lThis.idDays.escapeJQ()+j.getDate()+'_'+j.getMonth()+'_'+j.getFullYear()+'_cel');if(lJqCel.data('etatedit')=== -1||lJqCel.data('etatedit')===event.data.aValeur){lJqCel.find('td.ObjetCalendrierAnnuel_numerojour').css({backgroundColor:(lThis.donneesEditionPeriode.mode===lThis.genreEditionPeriode.Suppression)?lThis.options.style.editionPeriode.suppression.fond.couleur:lThis.options.style.editionPeriode.ajout.fond.couleur,color:(lThis.donneesEditionPeriode.mode===lThis.genreEditionPeriode.Suppression)?lThis.options.style.editionPeriode.suppression.texte.couleur:lThis.options.style.editionPeriode.ajout.texte.couleur});}}
event.stopImmediatePropagation();return false;}});lJqThis.on('mouseup','td[id]',{aThis:this,aValeur:this.listeDonneesEditablePeriode[0]},function(event){var lThis=event.data.aThis;if(lThis.donneesEditionPeriode!==null){var lDateStart=lThis.donneesEditionPeriode.start;var lDateStop=lThis.donneesEditionPeriode.stop;var lStart,lStop;if(lDateStart<=lDateStop){lStart=lDateStart;lStop=lDateStop;} else{lStart=lDateStop;lStop=lDateStart;}
for(j=lStart;j<=lStop;j=new Date(j.getFullYear(),j.getMonth(),j.getDate()+1)){lJqCel=$('#'+lThis.idDays.escapeJQ()+j.getDate()+'_'+j.getMonth()+'_'+j.getFullYear()+'_cel');lJqCel.find('td.ObjetCalendrierAnnuel_numerojour').css({backgroundColor:'',color:''});}
for(j=lStart;j<=lStop;j=new Date(j.getFullYear(),j.getMonth(),j.getDate()+1)){lJqCel=$('#'+lThis.idDays.escapeJQ()+j.getDate()+'_'+j.getMonth()+'_'+j.getFullYear()+'_cel');if(lJqCel.data('nonedit')!==true&&(lJqCel.data('etatedit')=== -1||lJqCel.data('etatedit')===event.data.aValeur)){var lValeurVoulue=lThis.donneesEditionPeriode.mode===lThis.genreEditionPeriode.Suppression?-1:event.data.aValeur;var lGardeFou=10;var lCompteur=0;while(lJqCel.data('etatedit')!==lValeurVoulue&&lCompteur<lGardeFou){lJqCel.trigger('click');lCompteur+=1;;}}}}
lThis.donneesEditionPeriode=null;event.stopImmediatePropagation();return false;});}}};ObjetCalendrierAnnuel.prototype.updateDonnees=function(){var lModif=false,i,j;function _sort(a,b){return a-b;}
function _mapDonnees(index,element){if($(element).data('etatedit')===parseInt(i)){var lDate=element.id.match(/_([0-9]+)_([0-9]+)_([0-9]+)_cel$/i);return new Date(lDate[3],lDate[2],lDate[1]);}}
for(i in this.listeDonneesEditable){var lDonneesEditees=$('#'+this.Nom.escapeJQ()).find('td[id]').map(_mapDonnees).get().sort(_sort);var lDateDebut=this.donnees[this.listeDonneesEditable[i]].variables[0];var lDonneesOrigine=this.donnees[this.listeDonneesEditable[i]].donnees;lDonneesOrigine.setTri([ObjetTri.init(lDateDebut,EGenreTriElement.Croissant)]);lDonneesOrigine.trier();var lIndiceOrigine=0;var lTailleOrigine=lDonneesOrigine.GetNbrElementsExistes();var lTravailSurPeriodes=this.donnees[this.listeDonneesEditable[i]].variables.length===2;if(!lTravailSurPeriodes){for(j in lDonneesEditees){while(lIndiceOrigine<lTailleOrigine&&lDonneesOrigine.GetElement(lIndiceOrigine)[lDateDebut].setHours(0,0,0,0)<lDonneesEditees[j].getTime()){lDonneesOrigine.GetElement(lIndiceOrigine).SetEtat(EGenreEtat.Suppression);if(!lModif){lModif=true;}
lIndiceOrigine++;}
if(lIndiceOrigine<lTailleOrigine&&lDonneesOrigine.GetElement(lIndiceOrigine)[lDateDebut].setHours(0,0,0,0)===lDonneesEditees[j].getTime()){lIndiceOrigine++;}
else if(lIndiceOrigine>=lTailleOrigine||lDonneesOrigine.GetElement(lIndiceOrigine)[lDateDebut].setHours(0,0,0,0)>lDonneesEditees[j].getTime()){var lElement=new ObjetElement();lElement[lDateDebut]=lDonneesEditees[j];lElement.SetEtat(EGenreEtat.Creation);lDonneesOrigine.AddElement(lElement);if(!lModif){lModif=true;}}}
while(lIndiceOrigine<lTailleOrigine){lDonneesOrigine.GetElement(lIndiceOrigine).SetEtat(EGenreEtat.Suppression);if(!lModif){lModif=true;}
lIndiceOrigine++;}}}
return lModif;};ObjetCalendrierAnnuel.prototype.composeImpression=function(){var lJqReturn=$('#'+this.idTable.escapeJQ()).parent().clone();this.formaterPourImpression(lJqReturn);return lJqReturn.html();};ObjetCalendrierAnnuel.prototype.celluleActive=function(event){var lThis=event.data.aObjet;var lDate=this.id.match(/_([0-9]+)_([0-9]+_[0-9]+)_/i);var lJour=lDate[1];var lMoisAnnee=lDate[2];var lJqMonth=$('#'+lThis.Nom.escapeJQ()+' td[id$="'+lMoisAnnee+'_lib"]');var lJqDay=$('#'+lThis.Nom.escapeJQ()+' td[id$="'+lJour+'_num"]');if(event.type==="mouseenter"){var lBorderBaseSize=parseInt(lThis.options.style.defaut.bordure.taille,10);var lBorderHovSize=parseInt(lThis.options.style.surbrillance.bordure.taille,10);var lPosition,lWidth,lHeight;if(lThis.options.ligneDate){lPosition=lJqDay.position();lWidth=lJqDay.outerWidth()-lBorderHovSize;lHeight=lJqDay.outerHeight()-lBorderHovSize;$('#'+lThis.idDayHov.escapeJQ()).css({display:'',top:lPosition.top-lBorderBaseSize,left:lPosition.left-lBorderBaseSize,width:lWidth,height:lHeight});}
lPosition=lJqMonth.position();lWidth=lJqMonth.outerWidth()-lBorderHovSize;lHeight=lJqMonth.outerHeight()-lBorderHovSize;$('#'+lThis.idMonthHov.escapeJQ()).css({display:'',top:lPosition.top-lBorderBaseSize,left:lPosition.left-lBorderBaseSize,width:lWidth,height:lHeight});if($(this).data("title")&&$(this).data("title")!==""){IE.Hint.start($(this).data("title"));}} else{$('#'+lThis.Nom.escapeJQ()).find('#'+lThis.idDayHov.escapeJQ()+', #'+lThis.idMonthHov.escapeJQ()).css({display:'none'});IE.Hint.stop();}};;
MethodesObjet.heritagePrototype(ObjetAffichagePageVacances,ObjetInterfacePage);function ObjetAffichagePageVacances(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.AvecImpressionListeArborescente=true;this.idLegende=this.Nom+'_legende';this.IdPremierElement=this.Nom+'_WAI';this.largeurLegende=GEtatUtilisateur.estModeAccessible()?0:200;this.couleur={jour:GCouleur.blanc,weekend:GCouleur.themeNeutre.legere,vacance:GCouleur.themeCouleur.claire};this.SymboleWE='-';this.SymboleVacances='x';}
ObjetAffichagePageVacances.prototype.ConstruireInstances=function(){if(!GEtatUtilisateur.estModeAccessible())
this.IdentVacances=this.Add(window.ObjetCalendrierAnnuel,null,null);else this.IdentVacances=this.Add(window.ObjetListeArborescente,null,null);};ObjetAffichagePageVacances.prototype.SetParametresGeneraux=function(){this.IdentZoneAlClient=this.IdentVacances;this.GenreStructure=EStructureAffichage.Autre;this.avecBandeau=true;};ObjetAffichagePageVacances.prototype.ConstruireStructureAffichageAutre=function(){var H=[];H.push('<div style="position:relative;width:100%;height:100%;">');H.push('<div style="position:absolute;top:5px;left:0;width:'+this.largeurLegende+'px;bottom:5px;" id="'+this.idLegende+'">'+(GEtatUtilisateur.estModeAccessible()?'':this.composeLegende())+'</div>');H.push('<div id="'+this.Instances[this.IdentVacances].GetNom()+'" style="position:absolute;top:5px;left:'+this.largeurLegende+'px;right:5px;bottom:5px;"></div>');H.push('</div>');return H.join('');};ObjetAffichagePageVacances.prototype.composeLegende=function(aPourImpression){this.HauteurCelluleLegende=25;this.LargeurCelluleLegende=17;var T=[];T.push('<table class="Texte10" border="0" cellpadding="0" cellspacing="5">');T.push('<tr>');T.push('<td width="'+this.LargeurCelluleLegende+'px" height="'+this.HauteurCelluleLegende+'px" class="AlignementMilieu Gras Texte14" style="'+GStyle.composeCouleur(this.couleur.weekend,this.couleur.weekend)+'">'+this.SymboleWE+'</td>');T.push('<td>',GTraductions.getValeur('Vacances.WeekEnd'),'</td>');T.push('</tr>');T.push('<tr>');T.push('<td width="'+this.LargeurCelluleLegende+'px" height="'+this.HauteurCelluleLegende+'px" class="AlignementMilieu Gras Texte14" style="'+GStyle.composeCouleur(this.couleur.vacance,this.couleur.vacance)+'">'+this.SymboleVacances+'</td>');T.push('<td>',GTraductions.getValeur('Vacances.Vacances'),'</td>');T.push('</tr>');T.push('</table>');T.push('<div id="'+this.Nom+'_WAI" tabindex="0" class="Texte10 Espace" ',GObjetWAI.composeRole(EGenreRole.List),' ',GObjetWAI.composeAttribut({genre:EGenreAttribut.label,valeur:GTraductions.getValeur('Onglet.Libelle')[EGenreOnglet.Vacances]}),'>',this.composeListeLibelles(),'</div>');return T.join('');};ObjetAffichagePageVacances.prototype.composeListeLibelles=function(){var lHtml=[];for(var i=0;i<GParametres.listeJoursFeries.GetNbrElements();i++){var lElement=GParametres.listeJoursFeries.GetElement(i);if(lElement.GetLibelle()){var LPeriode=GDate.estDateEgale(lElement.dateDebut,lElement.dateFin)?GTraductions.getValeur('Le')+' '+GDate.FormatDate(lElement.dateDebut,'%JJ %MMMM'):GTraductions.getValeur('Du')+' '+GDate.FormatDate(lElement.dateDebut,'%JJ %MMMM')+' '+GTraductions.getValeur('Au')+' '+GDate.FormatDate(lElement.dateFin,'%JJ %MMMM');lHtml.push('<div tabindex="0" ',GObjetWAI.composeAttribut({genre:EGenreAttribut.label,valeur:lElement.GetLibelle()+":"+LPeriode}),' ',GObjetWAI.composeAttribut({genre:EGenreAttribut.readonly,valeur:'true'}),' ',GObjetWAI.composeRole(EGenreRole.Listitem),' class="EspaceBas GrasSurFocus">' ,lElement.GetLibelle() ,' : ');lHtml.push('<div class="Gras">' ,LPeriode ,'</div></div>');}}
return lHtml.join('');};ObjetAffichagePageVacances.prototype.RecupererDonnees=function(){if(!GEtatUtilisateur.estModeAccessible()){this.Instances[this.IdentVacances].SetParametres({avecJourCourant:true,style:{defaut:{fond:{couleur:this.couleur.jour}}},joursOuvres:{fond:{couleur:this.couleur.weekend},symbolImpression:this.SymboleWE}});this.Instances[this.IdentVacances].SetDonnees({vacances:{donnees:GParametres.listeJoursFeries,variables:['dateDebut','dateFin'],couleur:this.couleur.vacance,symbolImpression:this.SymboleVacances}});}
this.AfficherInterfaceGraphique();window.Invocateur.evenement(window.Invocateur.events.activationImpression,EGenreImpression.Normale,this);this.surResizeInterface();};ObjetAffichagePageVacances.prototype.GetRacineListeArborescente=function(){return this.Instances[this.IdentVacances].GetListeArborescente();};ObjetAffichagePageVacances.prototype.AfficherInterfaceGraphique=function(){if(GEtatUtilisateur.estModeAccessible())
this.AfficherListe();else this.Instances[this.IdentVacances].Afficher();};ObjetAffichagePageVacances.prototype.GetPageImpression=function(){return{titre1:GTraductions.getValeur('Onglet.Libelle')[EGenreOnglet.Vacances],contenu:'<div style="width:19%;float:left;">'+this.composeLegende(true)+'</div><div style="width:80%;float:left;">'+this.Instances[this.IdentVacances].composeImpression()+'</div>'};};ObjetAffichagePageVacances.prototype.surResizeInterface=function(){if(this.Instances[this.IdentVacances]&&this.Instances[this.IdentVacances].ajouterEvenement)
this.Instances[this.IdentVacances].ajouterEvenement();};;
ObjetAffichagePageVacances.prototype.AfficherListe=function(){var lRacine=this.Instances[this.IdentVacances].construireRacine();if((!$.isEmptyObject(GParametres.listeJoursFeries))&&(GParametres.listeJoursFeries.GetNbrElements()>0)){this.Instances[this.IdentVacances].setParametres(true);var LPremiereDate=GDate.FormatDate(GParametres.PremiereDate,'%JJJJ %J %MMMM %AAAA');var LDerniereDate=GDate.FormatDate(GParametres.DerniereDate,'%JJJJ %J %MMMM %AAAA');var LNoeudAnnee=this.Instances[this.IdentVacances].ajouterUnNoeudAuNoeud(lRacine,this.Nom+'_Annee',GTraductions.getValeur('AnneeScolaire')+' '+GTraductions.getValeur('Du')+' '+LPremiereDate+' '+GTraductions.getValeur('Au')+' '+LDerniereDate+' : Vacances',"Gras EspaceGauche MargeHaut MargeBas",true,true);var lDonnees=GParametres.listeJoursFeries;for(var i=0;i<lDonnees.GetNbrElements();i++){var lElement=lDonnees.GetElement(i);var LLibelle='';var LPeriode=GDate.estDateEgale(lElement.dateDebut,lElement.dateFin)?GTraductions.getValeur('Le_Maj')+' '+GDate.FormatDate(lElement.dateDebut,'%J %MMMM'):GTraductions.getValeur('Du')+' '+GDate.FormatDate(lElement.dateDebut,'%J %MMMM')+' '+GTraductions.getValeur('Au')+' '+GDate.FormatDate(lElement.dateFin,'%J %MMMM');LLibelle+='<font class="Gras">'+LPeriode+'</font>';if(lElement.Libelle&&lElement.Libelle.length) LLibelle+=' - '+lElement.Libelle;this.Instances[this.IdentVacances].ajouterUneFeuilleAuNoeud(LNoeudAnnee,this.Nom+'_'+i,LLibelle,"MargeHaut MargeBas");}} else this.Instances[this.IdentVacances].ajouterUneFeuilleAuNoeud(lRacine,this.Nom+'_Message',GTraductions.getValeur('Vacances.MessageVacancesNonDefinis'),"Gras MargeHaut AlignementMilieu");$('#'+this.Instances[this.IdentVacances].Nom.escapeJQ()).replaceWith(this.Instances[this.IdentVacances].ConstruireAffichage());this.Instances[this.IdentVacances].SetDonnees(lRacine);};;
var EGenreEvenementNotesEtAppreciations={SaisieAppreciation:1000,MethodeCalculMoyenne:1001,SelectionLigne:1002,ExecutionQCM:1003,DetailEvaluationsCompetences:1004};;
var EGenreAppreciationGenerale={AG_Assiduite:1,AG_Autonomie:2,AG_Globale:3,AG_Commentaire1:4,AG_Commentaire2:5,AG_Commentaire3:6,AG_CPE:7,AG_Mention:8};;
var ETypeAppreciation={Appreciations:0,Progression:1,Conseil:2,Assiduite:3,Autonomie:4,Globale:5,Commentaire1:6,Commentaire2:7,Commentaire3:8,CPE:9,FG_Annuelle:10};ETypeAppreciation.getTypeAppreciation=function(aGenreOnglet,aAppreciation,aAppreciationGenerale){var lTabTypeAppreciation=[];switch(aGenreOnglet){case EGenreOnglet.FicheScolaire:case EGenreOnglet.LivretScolaire_Fiche:case EGenreOnglet.LivretScolaire_Appreciations:case EGenreOnglet.LivretScolaire_Competences:case EGenreOnglet.FicheBrevet:case EGenreOnglet.SaisieAppreciationsFicheBrevet:lTabTypeAppreciation.push(ETypeAppreciation.FG_Annuelle);break;case EGenreOnglet.ConseilDeClasse:lTabTypeAppreciation.push(ETypeAppreciation.Assiduite);lTabTypeAppreciation.push(ETypeAppreciation.Autonomie);lTabTypeAppreciation.push(ETypeAppreciation.Globale);break;case EGenreOnglet.SaisieAppreciationsReleve:lTabTypeAppreciation.push(ETypeAppreciation.Appreciations);lTabTypeAppreciation.push(ETypeAppreciation.Progression);lTabTypeAppreciation.push(ETypeAppreciation.Conseil);break;case EGenreOnglet.Releve:if(aAppreciationGenerale){lTabTypeAppreciation.push(ETypeAppreciation.Assiduite);lTabTypeAppreciation.push(ETypeAppreciation.Autonomie);lTabTypeAppreciation.push(ETypeAppreciation.Globale);}
else{lTabTypeAppreciation.push(ETypeAppreciation.Appreciations);lTabTypeAppreciation.push(ETypeAppreciation.Progression);lTabTypeAppreciation.push(ETypeAppreciation.Conseil);}
break;case EGenreOnglet.SaisieAppreciationsGenerales:switch(aAppreciation.GetGenre()){case EGenreAppreciationGenerale.AG_Assiduite:lTabTypeAppreciation.push(ETypeAppreciation.Assiduite);break;case EGenreAppreciationGenerale.AG_Autonomie:lTabTypeAppreciation.push(ETypeAppreciation.Autonomie);break;case EGenreAppreciationGenerale.AG_Globale:lTabTypeAppreciation.push(ETypeAppreciation.Globale);break;case EGenreAppreciationGenerale.AG_Commentaire1:lTabTypeAppreciation.push(ETypeAppreciation.Commentaire1);break;case EGenreAppreciationGenerale.AG_Commentaire2:lTabTypeAppreciation.push(ETypeAppreciation.Commentaire2);break;case EGenreAppreciationGenerale.AG_Commentaire3:lTabTypeAppreciation.push(ETypeAppreciation.Commentaire3);break;case EGenreAppreciationGenerale.AG_CPE:lTabTypeAppreciation.push(ETypeAppreciation.CPE);break;}
break;case EGenreOnglet.SaisieAppreciationsBulletin:switch(aAppreciation.GetGenre()){case 1:lTabTypeAppreciation.push(ETypeAppreciation.Appreciations);break;case 2:lTabTypeAppreciation.push(ETypeAppreciation.Progression);break;case 3:lTabTypeAppreciation.push(ETypeAppreciation.Conseil);break;}
break;case EGenreOnglet.Bulletins:if(aAppreciationGenerale){switch(aAppreciation.GetGenre()){case EGenreAppreciationGenerale.AG_Assiduite:lTabTypeAppreciation.push(ETypeAppreciation.Assiduite);break;case EGenreAppreciationGenerale.AG_Autonomie:lTabTypeAppreciation.push(ETypeAppreciation.Autonomie);break;case EGenreAppreciationGenerale.AG_Globale:lTabTypeAppreciation.push(ETypeAppreciation.Globale);break;case EGenreAppreciationGenerale.AG_Commentaire1:lTabTypeAppreciation.push(ETypeAppreciation.Commentaire1);break;case EGenreAppreciationGenerale.AG_Commentaire2:lTabTypeAppreciation.push(ETypeAppreciation.Commentaire2);break;case EGenreAppreciationGenerale.AG_Commentaire3:lTabTypeAppreciation.push(ETypeAppreciation.Commentaire3);break;case EGenreAppreciationGenerale.AG_CPE:lTabTypeAppreciation.push(ETypeAppreciation.CPE);break;}}
else{switch(aAppreciation.GetGenre()){case 1:lTabTypeAppreciation.push(ETypeAppreciation.Appreciations);break;case 2:lTabTypeAppreciation.push(ETypeAppreciation.Progression);break;case 3:lTabTypeAppreciation.push(ETypeAppreciation.Conseil);break;case 9:lTabTypeAppreciation.push(ETypeAppreciation.Assiduite);lTabTypeAppreciation.push(ETypeAppreciation.Autonomie);lTabTypeAppreciation.push(ETypeAppreciation.Globale);break;}}
break;case EGenreOnglet.BulletinCompetences:if(aAppreciationGenerale){switch(aAppreciation.GetGenre()){case EGenreAppreciationGenerale.AG_Assiduite:lTabTypeAppreciation.push(ETypeAppreciation.Assiduite);break;case EGenreAppreciationGenerale.AG_Autonomie:lTabTypeAppreciation.push(ETypeAppreciation.Autonomie);break;case EGenreAppreciationGenerale.AG_Globale:lTabTypeAppreciation.push(ETypeAppreciation.Globale);break;case EGenreAppreciationGenerale.AG_Commentaire1:lTabTypeAppreciation.push(ETypeAppreciation.Commentaire1);break;case EGenreAppreciationGenerale.AG_Commentaire2:lTabTypeAppreciation.push(ETypeAppreciation.Commentaire2);break;case EGenreAppreciationGenerale.AG_Commentaire3:lTabTypeAppreciation.push(ETypeAppreciation.Commentaire3);break;case EGenreAppreciationGenerale.AG_CPE:lTabTypeAppreciation.push(ETypeAppreciation.CPE);break;}}
else{lTabTypeAppreciation.push(ETypeAppreciation.Appreciations);lTabTypeAppreciation.push(ETypeAppreciation.Progression);lTabTypeAppreciation.push(ETypeAppreciation.Conseil);}
break;default:break;}
return lTabTypeAppreciation;};;

MethodesObjet.heritagePrototype(ObjetChoixTypeAppreciationListe,ObjetDonneesListe);function ObjetChoixTypeAppreciationListe(aDonnees){this.inheritedCreate(aDonnees);}
ObjetChoixTypeAppreciationListe.prototype.AvecSelection=function(I,D){return true;};ObjetChoixTypeAppreciationListe.prototype.AvecEdition=function(I,D){return false;};ObjetChoixTypeAppreciationListe.prototype.AvecSuppression=function(D){return false;};ObjetChoixTypeAppreciationListe.prototype.AvecEvenement_Selection=function(I,D){return true;};ObjetChoixTypeAppreciationListe.prototype.GetTri=function(D){return D.Tri;};ObjetChoixTypeAppreciationListe.prototype.GetValeur=function(I,D){return D.GetLibelle();};ObjetChoixTypeAppreciationListe.prototype.GetCouleurCellule=function(I,D){return this.ECouleurCellule.Blanc;};MethodesObjet.heritagePrototype(ObjetFenetre_ChoixTypeAppreciation,ObjetFenetre);function ObjetFenetre_ChoixTypeAppreciation(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);}
ObjetFenetre_ChoixTypeAppreciation.prototype.ConstruireInstances=function(){this.identListeTypesAppreciation=this.Add(window.ObjetListe,this.evenementSurListeTypesAppreciation,this.initialiserListeTypesAppreciation);};ObjetFenetre_ChoixTypeAppreciation.prototype.initialiserListeTypesAppreciation=function(aInstance){aInstance.SetParametres(new Array(''),new Array('100%'));};ObjetFenetre_ChoixTypeAppreciation.prototype.evenementSurListeTypesAppreciation=function(aGenreEvenementListe,aColonne,aLigne){switch(aGenreEvenementListe){case EGenreEvenementListe.Selection:this.typeAppreciationCourant=this.listeTypesAppreciation.GetElement(aLigne).GetLibelle();this.SetBoutonActif(1,true);break;}};ObjetFenetre_ChoixTypeAppreciation.prototype.ComposeContenu=function(){var T=[];T.push('<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">');T.push('<tr>');T.push('<td height="100%" id="'+this.GetNomInstance(this.identListeTypesAppreciation)+'"></td>');T.push('</tr>');T.push('</table>');return T.join('');};ObjetFenetre_ChoixTypeAppreciation.prototype.SetDonnees=function(aListeTypeAppreciation){this.Afficher();this.listeTypesAppreciation=aListeTypeAppreciation;this.SetBoutonActif(1,false);this.GetInstance(this.identListeTypesAppreciation).SetDonnees(new ObjetChoixTypeAppreciationListe(aListeTypeAppreciation));};;
MethodesObjet.heritagePrototype(DonneesListe_AssSaisie_Appreciation,ObjetDonneesListe);function DonneesListe_AssSaisie_Appreciation(aDonnees,aTailleMax){this.inheritedCreate(aDonnees);this.tailleMax=aTailleMax||0;this.creerIndexUnique('Libelle');}
DonneesListe_AssSaisie_Appreciation.prototype.GetCle=function(D){return D.Libelle;};DonneesListe_AssSaisie_Appreciation.prototype.GetTri=function(D){return D.Tri;};DonneesListe_AssSaisie_Appreciation.prototype.SurCreation=function(D,V){D.Libelle=V[0];D.Editable=true;D.Supprimable=true;D.AddTri(D.Libelle);};DonneesListe_AssSaisie_Appreciation.prototype.GetCouleurCellule=function(I,D){return this.ECouleurCellule.Blanc;};DonneesListe_AssSaisie_Appreciation.prototype.getClass=function(I,D){var lClass=[];if(!D.Supprimable){lClass.push('Gras');}
return lClass.join(' ');};DonneesListe_AssSaisie_Appreciation.prototype.Suppression_Impossible=function(D){return!D.Supprimable;};DonneesListe_AssSaisie_Appreciation.prototype.AvecEdition=function(I,D){return false;};DonneesListe_AssSaisie_Appreciation.prototype.GetTypeValeur=function(I,D){return this.ETypeCellule.ZoneTexte;};DonneesListe_AssSaisie_Appreciation.prototype.AvecEvenement_Edition=function(I){return true;};DonneesListe_AssSaisie_Appreciation.prototype.AvecEvenement_Creation=function(I){return true;};DonneesListe_AssSaisie_Appreciation.prototype.AvecEvenement_Selection=function(I,D){return true;};DonneesListe_AssSaisie_Appreciation.prototype.AvecEvenement_Suppression=function(D){return true;};DonneesListe_AssSaisie_Appreciation.prototype.GetValeur=function(I,D){return D.GetLibelle();};DonneesListe_AssSaisie_Appreciation.prototype.GetMessage_Suppression_Impossible=function(D){return GTraductions.getValeur('Appreciations.MsgSuppressionApprecInterdit');};DonneesListe_AssSaisie_Appreciation.prototype.SurSelectionLigne=function(J,D,V){D.ligneSelectionnee=J;};DonneesListe_AssSaisie_Appreciation.prototype.GetTailleTexteMax=function(I,D){return this.tailleMax;};DonneesListe_AssSaisie_Appreciation.prototype.GetMessage_TailleMaximaleSaisie=function(I,D){return GTraductions.getValeur('MessageTailleMaxAppr');};;
MethodesObjet.heritagePrototype(DonneesListe_AssSaisie_Categorie,ObjetDonneesListe);function DonneesListe_AssSaisie_Categorie(aDonnees){this.inheritedCreate(aDonnees);this.creerIndexUnique([
function(D){return(D.estUnDeploiement||!D.pere)?D.GetLibelle():D.pere.GetLibelle();},function(D){return(D.estUnDeploiement||!D.pere)?null:D.GetLibelle();}
]);}
DonneesListe_AssSaisie_Categorie.prototype.GetTri=function(D){return D.Tri;};DonneesListe_AssSaisie_Categorie.prototype.GetCouleurCellule=function(I,D){return(D.estUneCategorie?this.ECouleurCellule.Blanc:new ObjectCouleurCellule(GCouleur.grisFonce,GCouleur.noir,GCouleur.fenetre.bordure));};DonneesListe_AssSaisie_Categorie.prototype.getClass=function(I,D){var lClass=[];if(!D.estUneCategorie||!D.Supprimable){lClass.push('Gras');}
return lClass.join(' ');};DonneesListe_AssSaisie_Categorie.prototype.SurCreation=function(D,V){D.Libelle=V[0];D.Editable=true;D.Supprimable=true;D.listeAppreciations=new ObjetListeElements();D.estUneCategorie=true;D.estUnDeploiement=false;D.estDeploye=false;D.pere=null;D.traiterApresCreation=true;};DonneesListe_AssSaisie_Categorie.prototype.SurEdition=function(I,D,V){D.Libelle=V;};DonneesListe_AssSaisie_Categorie.prototype.Suppression_Impossible=function(D){return!D.Supprimable;};DonneesListe_AssSaisie_Categorie.prototype.AvecEdition=function(I,D){return D.Editable;};DonneesListe_AssSaisie_Categorie.prototype.AvecDeploiement=function(I){return true;};DonneesListe_AssSaisie_Categorie.prototype.AvecEvenement_Creation=function(I){return true;};DonneesListe_AssSaisie_Categorie.prototype.AvecEvenement_Selection=function(I,D){return true;};DonneesListe_AssSaisie_Categorie.prototype.AvecEvenement_Suppression=function(D){return true;};DonneesListe_AssSaisie_Categorie.prototype.AvecEvenement_ApresSuppression=function(){return true;};DonneesListe_AssSaisie_Categorie.prototype.AvecEvenement_ApresCreation=function(){return true;};DonneesListe_AssSaisie_Categorie.prototype.GetValeur=function(I,D){return D.GetLibelle();};DonneesListe_AssSaisie_Categorie.prototype.GetMessage_Suppression_Impossible=function(D){return GTraductions.getValeur('Appreciations.MsgSuppressionCategInterdit');};DonneesListe_AssSaisie_Categorie.prototype.SurSelectionLigne=function(J,D,V){D.ligneSelectionnee=J;};DonneesListe_AssSaisie_Categorie.prototype.GetMessage_Suppression_Confirmation=function(D){var lNbrAppreciations=D.listeAppreciations.GetNbrElements();var lMsg=[];if(lNbrAppreciations>0){if(lNbrAppreciations===1){lMsg.push(GTraductions.getValeur('Appreciations.MsgSupprCategAppr'));lMsg.push(GTraductions.getValeur('Appreciations.MsgSupprCategApprDetail'));}
else{lMsg.push(GTraductions.getValeur('Appreciations.MsgSupprCategXAppr'));lMsg.push(GTraductions.getValeur('Appreciations.MsgSupprCategXApprDetail',[lNbrAppreciations]));}
lMsg.push(GTraductions.getValeur('Appreciations.MsgConfirmSuppr'));}
else lMsg.push(GTraductions.getValeur('Appreciations.MsgConfirmSupprDirect'));return lMsg.join('\n');};;

var EBoutonFenetreAssistantSaisie={Fermer:0,PasserEnSaisie:1,Valider:2};MethodesObjet.heritagePrototype(ObjetFenetre_AssistantSaisie,ObjetFenetre);function ObjetFenetre_AssistantSaisie(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);}
ObjetFenetre_AssistantSaisie.prototype.ConstruireInstances=function(){this.identListeCategories=this.Add(window.ObjetListe,this.evntSurListeCategories,this.initListeCategories);this.identListeAppreciations=this.Add(window.ObjetListe,this.evntSurListeAppreciations,this.initListeAppreciations);this.identFenetreChoixTypeAppreciation=this.Add(window.ObjetFenetre_ChoixTypeAppreciation,this.evntChoixTypeAppreciation,this.initFenetreChoixTypeAppreciation);this.identCheckBox=this.Add(window.ObjetCheckBox,this.evntSurCheckBox ,this.initCheckBox);};ObjetFenetre_AssistantSaisie.prototype.initListeCategories=function(aInstance){aInstance.SetParametres([GTraductions.getValeur('Appreciations.TitreColCategorie')],['100%'],0,-1,GTraductions.getValeur('Appreciations.LigneCreationCategorie'));aInstance.setParametres_Affichage(false);};ObjetFenetre_AssistantSaisie.prototype.initListeAppreciations=function(aInstance){aInstance.SetParametres([GTraductions.getValeur('Appreciations.TitreColAppreciation')],['100%'],0,-1,GTraductions.getValeur('Appreciations.LigneCreationAppreciation'));aInstance.setParametres_Affichage(false);};ObjetFenetre_AssistantSaisie.prototype.initFenetreChoixTypeAppreciation=function(aInstance){aInstance.SetParametres_Fenetre(GTraductions.getValeur('Appreciations.SelectionnerTypeAppr'),200,200,[GTraductions.getValeur('Annuler'),GTraductions.getValeur('Valider')]);};ObjetFenetre_AssistantSaisie.prototype.initCheckBox=function(aInstance){var lListeElements=new ObjetListeElements();lListeElements.AddElement(new ObjetElement(GTraductions.getValeur('Appreciations.NePasUtiliserAssistant')));aInstance.setOptions_ObjetCheckBox({liste:lListeElements,Selection:new TypeDomaine()});};ObjetFenetre_AssistantSaisie.prototype.evntSurListeCategories=function(aGenreEvenementListe,aColonne,aLigne){var lElmt;switch(aGenreEvenementListe){case EGenreEvenementListe.Creation:this.afficherMessageZoneAppreciations();break;case EGenreEvenementListe.Selection:lElmt=this.listeCategoriesPourAffichage.GetElement(aLigne);if(lElmt.estUneCategorie){this.initListeAppreciations(this.GetInstance(this.identListeAppreciations));this.GetInstance(this.identListeAppreciations).SetTitres([this.getTitreListeAppreciations(lElmt.typeAppreciation)]);this.categorieCourante=aLigne;var llisteAppreciations=lElmt.listeAppreciations;if(llisteAppreciations)
this.GetInstance(this.identListeAppreciations).SetDonnees(this.objetAppreciationAssSaisieListe=new DonneesListe_AssSaisie_Appreciation(this.listeAppreciationsAssSaisie=llisteAppreciations,this.tailleMaxAppreciation));}
else{this.afficherMessageZoneAppreciations();}
break;case EGenreEvenementListe.ApresSuppression:if(!this.selectionCategorieParDefaut()){this.GetInstance(this.identListeAppreciations).SetDonnees();}
break;case EGenreEvenementListe.ApresCreation:for(var I=0;I<this.listeCategoriesPourAffichage.GetNbrElements();I++){lElmt=this.listeCategoriesPourAffichage.GetElement(I);if((lElmt.Etat===EGenreEtat.Creation)&&(lElmt.traiterApresCreation)){lElmt.ResetTri();if(this.listeElementsTypeAppreciation.GetNbrElements()===1){this.listeElementsTypeAppreciation.GetElement(0).listeCategories.AddElement(lElmt);lElmt.AddTri(lElmt.Libelle);}
else{this.elementCourant=lElmt;this.GetInstance(this.identFenetreChoixTypeAppreciation).SetDonnees(this.listeElementsTypeAppreciation);}
lElmt.traiterApresCreation=false;}}
break;}};ObjetFenetre_AssistantSaisie.prototype.afficherMessageZoneAppreciations=function(){GHtml.setHtml(this.GetNomInstance(this.identListeAppreciations),this.composeMessage(GTraductions.getValeur('Appreciations.SelectionnerCategorie')));};ObjetFenetre_AssistantSaisie.prototype.evntSurListeAppreciations=function(aGenreEvenementListe,aColonne,aLigne){switch(aGenreEvenementListe){case EGenreEvenementListe.Selection:this.appreciationCourante=aLigne;this.SetBoutonActif(EBoutonFenetreAssistantSaisie.Valider,true);break;case EGenreEvenementListe.Edition:this.SurValidation(EBoutonFenetreAssistantSaisie.Valider);break;case EGenreEvenementListe.Suppression:case EGenreEvenementListe.Creation:this.listeCategoriesPourAffichage.GetElement(this.categorieCourante).SetEtat(EGenreEtat.Modification);break;}};ObjetFenetre_AssistantSaisie.prototype.evntChoixTypeAppreciation=function(aNumeroBouton){switch(aNumeroBouton){case(1):var lLibelleTypeAppreciationSelectionne=this.GetInstance(this.identFenetreChoixTypeAppreciation).typeAppreciationCourant;var lElmt=this.listeCategoriesPourAffichage.GetElementParLibelle(lLibelleTypeAppreciationSelectionne);if(!lElmt.estUneCategorie){this.elementCourant.pere=lElmt;this.elementCourant.typeAppreciation=lElmt.GetGenre();this.listeElementsTypeAppreciation.GetElementParGenre(this.elementCourant.typeAppreciation).listeCategories.AddElement(this.elementCourant);this.elementCourant.AddTri(lElmt.GetLibelle());this.elementCourant.AddTri(this.elementCourant.Libelle);this.GetInstance(this.identListeCategories).Actualiser();var lIndice=this.listeCategoriesPourAffichage.getIndiceParTri(this.elementCourant.Tri);this.selectionnerElementDansListeCategorie(lIndice);}
else this.annulerCreation();break;case 0:this.annulerCreation();break;default:break;}};ObjetFenetre_AssistantSaisie.prototype.annulerCreation=function(){this.listeCategoriesPourAffichage.DelElement();this.GetInstance(this.identListeCategories).Actualiser();};ObjetFenetre_AssistantSaisie.prototype.getAppreciationSelectionnee=function(){return this.listeCategoriesPourAffichage.GetElement(this.categorieCourante).listeAppreciations.GetElement(this.appreciationCourante);};ObjetFenetre_AssistantSaisie.prototype.evntSurCheckBox=function(aSelection){this.assistantActif=!aSelection.GetValeur(1);};ObjetFenetre_AssistantSaisie.prototype.ComposeContenu=function(){var T=[];T.push('<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">');T.push('<tr>');T.push('<td id="'+this.GetNomInstance(this.identListeCategories)+'" height="100%" width="250px">&nbsp;</td>');T.push('<td id="'+this.GetNomInstance(this.identListeAppreciations)+'" height="100%">&nbsp;</td>');T.push('</tr>');T.push('<tr>');T.push('<td id="'+this.GetNomInstance(this.identCheckBox)+'"></td>');T.push('</tr>');T.push('</table>');return T.join('');};ObjetFenetre_AssistantSaisie.prototype.setParametres=function(aTailleMaxAppreciation){this.tailleMaxAppreciation=aTailleMaxAppreciation;};ObjetFenetre_AssistantSaisie.prototype.SetDonnees=function(aListeElementsTypeAppreciation){this.assistantActif=true;this.GetInstance(this.identCheckBox).SetSelection(false);this.listeElementsTypeAppreciation=aListeElementsTypeAppreciation;this.listeCategoriesPourAffichage=new ObjetListeElements();var lNbrTypeAppreciation=aListeElementsTypeAppreciation.GetNbrElements();for(var I=0;I<lNbrTypeAppreciation;I++){var lElementTypeAppreciation=new ObjetElement();if(lNbrTypeAppreciation>1){lElementTypeAppreciation.Genre=aListeElementsTypeAppreciation.GetElement(I).GetGenre();lElementTypeAppreciation.SetLibelle(this.getTitreListeAppreciations(lElementTypeAppreciation.Genre));aListeElementsTypeAppreciation.GetElement(I).SetLibelle(lElementTypeAppreciation.Libelle);lElementTypeAppreciation.estUneCategorie=false;lElementTypeAppreciation.estUnDeploiement=true;lElementTypeAppreciation.estDeploye=true;lElementTypeAppreciation.pere=null;lElementTypeAppreciation.AddTri(lElementTypeAppreciation.Libelle);lElementTypeAppreciation.AddTri(" ");this.listeCategoriesPourAffichage.AddElement(lElementTypeAppreciation);}
for(var J=0;J<aListeElementsTypeAppreciation.GetElement(I).listeCategories.GetNbrElements();J++){var lCategorieCourante=aListeElementsTypeAppreciation.GetElement(I).listeCategories.GetElement(J);lCategorieCourante.estUneCategorie=true;lCategorieCourante.estUnDeploiement=false;lCategorieCourante.estDeploye=false;lCategorieCourante.pere=(lNbrTypeAppreciation>1)?lElementTypeAppreciation:null;if(lNbrTypeAppreciation>1) lCategorieCourante.AddTri(lCategorieCourante.pere.Libelle);lCategorieCourante.AddTri(lCategorieCourante.Libelle);this.listeCategoriesPourAffichage.AddElement(lCategorieCourante);}}
this.listeCategoriesPourAffichage.Trier();this.Afficher(null);this.SetTitre(this.getTitreFenetre());this.SetBoutonActif(EBoutonFenetreAssistantSaisie.Valider,false);this.GetInstance(this.identListeCategories).SetDonnees(new DonneesListe_AssSaisie_Categorie(this.listeCategoriesPourAffichage));if(!this.selectionCategorieParDefaut()){this.GetInstance(this.identListeAppreciations).SetDonnees();}};ObjetFenetre_AssistantSaisie.prototype.actualiserContenu=function(){this.GetInstance(this.identListeCategories).SetDonnees(new DonneesListe_AssSaisie_Categorie(this.listeCategoriesPourAffichage));if(this.objetAppreciationAssSaisieListe)
this.GetInstance(this.identListeAppreciations).SetDonnees(this.objetAppreciationAssSaisieListe);else this.afficherMessageZoneAppreciations();};ObjetFenetre_AssistantSaisie.prototype.selectionCategorieParDefaut=function(){var lNbrElmts=this.listeCategoriesPourAffichage.GetNbrElements();for(var lLigne=0;lLigne<lNbrElmts;lLigne++){var lElement=this.listeCategoriesPourAffichage.GetElement(lLigne);if((lElement.estUneCategorie)&&(lElement.Etat!==EGenreEtat.Suppression)){this.selectionnerElementDansListeCategorie(lLigne);return true;}}
return false;};ObjetFenetre_AssistantSaisie.prototype.selectionnerElementDansListeCategorie=function(aLigne){this.GetInstance(this.identListeCategories).SelectionnerLigne({ligne:aLigne,avecEvenement:true});};ObjetFenetre_AssistantSaisie.prototype.getTitreFenetre=function(){switch(GEtatUtilisateur.getGenreOnglet()){case EGenreOnglet.FicheScolaire:case EGenreOnglet.LivretScolaire_Fiche:case EGenreOnglet.LivretScolaire_Appreciations:case EGenreOnglet.LivretScolaire_Competences:case EGenreOnglet.FicheBrevet:case EGenreOnglet.SaisieAppreciationsFicheBrevet:return GTraductions.getValeur('Appreciations.TitreAss_Brevet');case EGenreOnglet.BulletinCompetences:case EGenreOnglet.ConseilDeClasse:case EGenreOnglet.Bulletins:case EGenreOnglet.SaisieAppreciationsBulletin:return GTraductions.getValeur('Appreciations.TitreAss_Bulletin');case EGenreOnglet.Releve:case EGenreOnglet.SaisieAppreciationsReleve:return GTraductions.getValeur('Appreciations.TitreAss_Releve');case EGenreOnglet.SaisieAppreciationsGenerales:return GTraductions.getValeur('Appreciations.TitreAss_Bulletin');default:return'';}};ObjetFenetre_AssistantSaisie.prototype.getTitreListeAppreciations=function(aTypeAppreciation){switch(aTypeAppreciation){case ETypeAppreciation.Appreciations:return GTraductions.getValeur('Appreciations.ApprA');case ETypeAppreciation.Progression:return GTraductions.getValeur('Appreciations.ApprB');case ETypeAppreciation.Conseil:return GTraductions.getValeur('Appreciations.ApprC');case ETypeAppreciation.Assiduite:return GTraductions.getValeur('Appreciations.ApprA');case ETypeAppreciation.Autonomie:return GTraductions.getValeur('Appreciations.ApprB');case ETypeAppreciation.Globale:return GTraductions.getValeur('Appreciations.ApprC');case ETypeAppreciation.Commentaire1:return GTraductions.getValeur('Appreciations.CommA');case ETypeAppreciation.Commentaire2:return GTraductions.getValeur('Appreciations.CommB');case ETypeAppreciation.Commentaire3:return GTraductions.getValeur('Appreciations.CommC');case ETypeAppreciation.CPE:return GTraductions.getValeur('Appreciations.CPE');case ETypeAppreciation.FG_Annuelle:return GTraductions.getValeur('Appreciations.Annuelle');default:return'';}};ObjetFenetre_AssistantSaisie.prototype.debutRetaillage=function(){this.inherited('debutRetaillage');this.GetInstance(this.identListeCategories).SurPreResize();this.GetInstance(this.identListeAppreciations).SurPreResize();};ObjetFenetre_AssistantSaisie.prototype.finRetaillage=function(){this.inherited('finRetaillage');this.GetInstance(this.identListeCategories).SurPostResize();this.GetInstance(this.identListeAppreciations).SurPostResize();};;
MethodesObjet.heritagePrototype(_PageAppreciations,ObjetInterfacePage);function _PageAppreciations(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.avecScrollV=true;}
_PageAppreciations.prototype._getInterface=function(aCoordonneesCellule){var lInterface=this;for(var I=aCoordonneesCellule.interfaces.length-1;I>=0 ;I--){var lNomInterface=aCoordonneesCellule.interfaces[I];lInterface=lInterface.getInstanceParNom(lNomInterface);}
return lInterface;};_PageAppreciations.prototype._getCellule=function(aCoordonneesCellule){var lInterface=this._getInterface(aCoordonneesCellule);var lInstance=lInterface?lInterface.getInstanceParNom(aCoordonneesCellule.nomObjet):null;var lLigne=lInstance?lInstance.Liste.GetElement(aCoordonneesCellule.numLigne):null;var lAppreciation=lLigne?lLigne.ListeAppreciations.GetElement(aCoordonneesCellule.numAppreciation):null;return{interfac:lInterface,instance:lInstance,ligne:lLigne,appreciation:lAppreciation};};_PageAppreciations.prototype.initialiserBoutonAssistant=function(aInstance){aInstance.SetParametres('Image_AssistantSaisie',true,GEtatUtilisateur.assistantSaisieActif,true,[GTraductions.getValeur('Appreciations.DesactiverAssistantSaisie'),GTraductions.getValeur('Appreciations.ActiverAssistantSaisie'),''],20);};_PageAppreciations.prototype.evenementSurAssistant=function(){GEtatUtilisateur.inverserEtatAssistantSaisie();this.GetInstance(this.IdentPage).Afficher();if(this.identPied&&this.GetInstance(this.identPied).evenementSurAssistant) this.GetInstance(this.identPied).evenementSurAssistant();};_PageAppreciations.prototype.initialiserAssistantSaisie=function(aInstance){aInstance.SetParametres_Fenetre(GTraductions.getValeur('Appreciations.AssistantSaisie'),700,200,[GTraductions.getValeur('Fermer'),GTraductions.getValeur('Appreciations.PasserEnSaisie'),GTraductions.getValeur('Valider'),''],true,true,false,600,150);};_PageAppreciations.prototype.avecAssistantSaisie=function(){return GApplication.droits.get(IEEnum.droits.assistantSaisieAppreciations);};_PageAppreciations.prototype.getListeTypesAppreciations=function(){if(this.avecAssistantSaisie())
this.requeteDonneesAssistantSaisie();else this.listeTypesAppreciations=new ObjetListeElements();};_PageAppreciations.prototype.requeteDonneesAssistantSaisie=function(){new ObjetRequeteAssistantSaisie(this,this.actionSurRequeteDonneesAssistantSaisie).lancerRequete();};_PageAppreciations.prototype.actionSurRequeteDonneesAssistantSaisie=function(aListeTypesAppreciations){this.listeTypesAppreciations=aListeTypesAppreciations;};_PageAppreciations.prototype.evenementSaisieSurCellule=function(aParamEvnt){;var aCoordonneesCellule=aParamEvnt.coordonneesCellule;this.coordonneesAppreciationCourante=aCoordonneesCellule;if(this.avecAssistantSaisie()&&(!this.GetInstance(this.identFenetreAssistantSaisie))){aCoordonneesCellule.interfaces.push(this.Nom);this.Pere.evenementSaisieSurCellule(aParamEvnt);}
else{var lCell=this._getCellule(aCoordonneesCellule);if(lCell.appreciation&&lCell.appreciation.GetGenre()===EGenreAppreciationGenerale.AG_Mention){lCell.interfac.evenementOuvrirMentions();}
else{if(GEtatUtilisateur.assistantSaisieActif&&lCell.appreciation)
this.evenementOuvrirAssistantSaisie({tabTypeAppreciation:ETypeAppreciation.getTypeAppreciation(GEtatUtilisateur.getGenreOnglet(),lCell.appreciation,lCell.instance.appreciationGenerale?lCell.instance.appreciationGenerale:false),tailleMaxAppreciation:aParamEvnt.tailleMaxAppreciation});}}};_PageAppreciations.prototype.evenementOuvrirAssistantSaisie=function(aParam){this.GetInstance(this.identFenetreAssistantSaisie).setParametres(aParam.tailleMaxAppreciation);var lListeElementsTypeAppreciation=new ObjetListeElements();for(var I=0;I<aParam.tabTypeAppreciation.length;I++){var lElementTypeAppreciation=this.listeTypesAppreciations.GetElementParGenre(aParam.tabTypeAppreciation[I]);lListeElementsTypeAppreciation.AddElement(lElementTypeAppreciation);}
this.GetInstance(this.identFenetreAssistantSaisie).SetDonnees(lListeElementsTypeAppreciation);};_PageAppreciations.prototype.evenementAssistantSaisie=function(aNumeroBouton){var lCell=this._getCellule(this.coordonneesAppreciationCourante);switch(aNumeroBouton){case(EBoutonFenetreAssistantSaisie.Valider):var lElmtSelectionne=this.GetInstance(this.identFenetreAssistantSaisie).getAppreciationSelectionnee();var lTailleMax=this.GetInstance(this.identFenetreAssistantSaisie).tailleMaxAppreciation;var lControle=GChaine.controleTailleTexte({chaine:lElmtSelectionne.GetLibelle(),tailleTexteMax:lTailleMax});if(lControle.controleOK){this.traiterValidationAppreciationSelectionnee(lElmtSelectionne);}
else{GApplication.getMessage().Afficher(EGenreBoiteMessage.Information,GTraductions.getValeur('Appreciations.titreMsgDepasseTailleMax'),GTraductions.getValeur('Appreciations.msgDepasseTailleMax',[lTailleMax]));}
break;case(EBoutonFenetreAssistantSaisie.PasserEnSaisie):lCell.instance.passerEnSaisieSurCellule();break;case(EBoutonFenetreAssistantSaisie.Fermer):var lAssistantActif=this.GetInstance(this.identFenetreAssistantSaisie).assistantActif;if(GEtatUtilisateur.assistantSaisieActif!==lAssistantActif){this.GetInstance(this.identBoutonAssistant).setSelection(lAssistantActif);}
lCell.instance.deselectionnerLigne();break;default:this._gestionFocus_apresFenetreAssistantSaisie(aNumeroBouton);break;}};_PageAppreciations.prototype.traiterValidationAppreciationSelectionnee=function(aElmtAppreciationSelectionne){var lCell=this._getCellule(this.coordonneesAppreciationCourante);this.SetEtatSaisie(true);lCell.ligne.SetEtat(EGenreEtat.Modification);if(aElmtAppreciationSelectionne&&aElmtAppreciationSelectionne.existeNumero()){lCell.appreciation.SetEtat(EGenreEtat.Modification);lCell.appreciation.Libelle=aElmtAppreciationSelectionne.GetLibelle();}
lCell.instance.setLibelleCellule(this.coordonneesAppreciationCourante,lCell.appreciation.Libelle);lCell.instance.passerFocusSuivant(+1,+1);this.coordonneesAppreciationCourante.numLigne=lCell.instance.NumLigne-1;this.coordonneesAppreciationCourante.numAppreciation=lCell.instance.NumColonne-1;var lParamEvnt={genreEvnt:EGenreEvenementNotesEtAppreciations.SaisieAppreciation,coordonneesCellule:this.coordonneesAppreciationCourante,tailleMaxAppreciation:(this.identFenetreAssistantSaisie>=0)&&this.GetInstance(this.identFenetreAssistantSaisie)?this.GetInstance(this.identFenetreAssistantSaisie).tailleMaxAppreciation:0};this.evenementSaisieSurCellule(lParamEvnt);};_PageAppreciations.prototype.initialiserMentions=function(aInstance){aInstance.setParametres_Mention(GTraductions.getValeur('Appreciations.Mentions'));aInstance.SetParametres_Fenetre(GTraductions.getValeur('Appreciations.SaisieMentions'),300,300,[GTraductions.getValeur('Annuler'),GTraductions.getValeur('Valider')]);};_PageAppreciations.prototype.evenementMention=function(aGenreBouton){var lPositionMentionSelectionnee=this.GetInstance(this.IdentFenetreMentions).getPosMentionSelectionnee();var lElmtMention=this.listeMentions.GetElement(lPositionMentionSelectionnee);this.traiterSelectionMention(aGenreBouton,lElmtMention);this._gestionFocus_apresFenetreMentions(aGenreBouton);};_PageAppreciations.prototype.evenementOuvrirMentions=function(){var lCell=this._getCellule(this.coordonneesAppreciationCourante);if(lCell&&lCell.ligne) this.GetInstance(this.IdentFenetreMentions).traiterSelectionEleve(lCell.ligne);this.GetInstance(this.IdentFenetreMentions).SetDonnees(this.listeMentions);this.GetInstance(this.IdentFenetreMentions).FocusSurPremierElement();};_PageAppreciations.prototype._gestionFocus_apresFenetreMentions=function(aGenreBouton){if(aGenreBouton===1){var lInstanceFen=this.GetInstance(this.IdentFenetreMentions);var lInstanceListe=lInstanceFen.GetInstance(lInstanceFen.IdentListe);lInstanceListe.FocusSurPremierElement();}
else{this.focusSurPremierObjet();}};_PageAppreciations.prototype._gestionFocus_apresFenetreAssistantSaisie=function(aGenreBouton){this.focusSurPremierObjet();};;
MethodesObjet.heritagePrototype(_PageResultat,_PageAppreciations);function _PageResultat(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);}
_PageResultat.prototype.ConstruireStructureAffichageAutre=function(){var H=[];H.push('<div>');H.push('<table class="Table AlignementHaut" border="0" cellpadding="0" cellspacing="5">');H.push('<tr><td class="AlignementHaut" id="'+this.GetInstance(this.IdentPage).GetNom()+'"></td></tr>');H.push('<tr><td><div id="'+this.GetInstance(this.identPied).GetNom()+'"></div></td></tr>');H.push('</table>');H.push('</div>');return H.join('');};_PageResultat.prototype.surResizeInterface=function(){if(this.GetInstance(this.IdentPage).heightPiedDePage<$('#'+this.GetInstance(this.identPied).GetNom().escapeJQ()).height()) this.GetInstance(this.IdentPage).heightPiedDePage=$('#'+this.GetInstance(this.identPied).GetNom().escapeJQ()).height();this.inherited('surResizeInterface');GPosition.declencherResize(this.GetInstance(this.IdentPage).GetNom());$('#'+this.GetInstance(this.IdentPage).GetNom().escapeJQ()).height('');this.GetInstance(this.IdentPage).heightPage=$('#'+this.GetNom().escapeJQ()).height();};_PageResultat.prototype.RecupererDonnees=function(){if(this.Instances[this.IdentCombo]){this.IdPremierElement=this.GetInstance(this.IdentCombo).getPremierElement();this.listePeriodes=GEtatUtilisateur.getOngletListePeriodes();if(this.listePeriodes&&this.listePeriodes.GetNbrElements()){this.Instances[this.IdentCombo].SetVisible(true);this.Instances[this.IdentCombo].SetDonnees(this.listePeriodes);this.Instances[this.IdentCombo].setSelectionParElement(GEtatUtilisateur.getPeriode(),0);} else{this.Instances[this.IdentCombo].SetVisible(false);this.EvenementAfficherMessage(this.genreMessage);this.GetInstance(this.IdentPage).IdPremierElement=this.idMessageActionRequise;}}};_PageResultat.prototype.SetDonnees_Affichage=function(){this.GetInstance(this.IdentPage).SetDonnees_Affichage(this.Affichage);};_PageResultat.prototype.SetDonnees_Services=function(){this.GetInstance(this.IdentPage).SetDonnees(this.ServiceEditable,this.ListeElements,this.NbrMaxServices,this.NbrMaxDevoirs,this.tableauSurMatieres);};_PageResultat.prototype.SetDonnees_Absences=function(){this.GetInstance(this.identPied).setDonnees_Absences(this.donneesAbsences);};_PageResultat.prototype.setDonnees_General=function(){this.GetInstance(this.IdentPage).SetDonnees_General(this.MoyenneGenerale);};_PageResultat.prototype.ActionSurRecupererBulletin=function(aParam){if(aParam.Message){this.EvenementAfficherMessage(aParam.Message);this.GetInstance(this.IdentPage).IdPremierElement=this.idMessageActionRequise;$('#'+this.GetInstance(this.identPied).GetNom().escapeJQ()).css('display','none');}
else{$('#'+this.GetInstance(this.identPied).GetNom().escapeJQ()).css('display','');$.extend(this,aParam.aCopier);this.donneesAbsences=aParam.absences;this.AfficherInterfaceGraphique(true);var lGenreImpression=this.getGenreImpression();window.Invocateur.evenement(window.Invocateur.events.activationImpression,lGenreImpression,this,lGenreImpression===EGenreImpression.GenerationPDF?this.getParametresPDF.bind(this):null);this.GetInstance(this.IdentPage).setPremierElement();if(GEtatUtilisateur.estModeAccessible()&&this.GetInstance(this.IdentPage)) this.GetInstance(this.IdentPage).setFocus();}};_PageResultat.prototype.getGenreImpression=function(){return(GEtatUtilisateur.GenreEspace===EGenreEspace.Professeur)||(GEtatUtilisateur.GenreEspace===EGenreEspace.Parent)||(GEtatUtilisateur.GenreEspace===EGenreEspace.Etablissement)?(GEtatUtilisateur.getGenreOnglet()===EGenreOnglet.Releve||GEtatUtilisateur.getGenreOnglet()===EGenreOnglet.Bulletins||GEtatUtilisateur.getGenreOnglet()===EGenreOnglet.ConseilDeClasse?EGenreImpression.GenerationPDF:EGenreImpression.Format):EGenreImpression.Aucune;};_PageResultat.prototype.GetPageImpression=function(aFormat){return{titre1:GEtatUtilisateur.getLibelleImpression(this.LibelleImpression,true,true,true,null),contenu:this.GetInstance(this.IdentPage).ComposeImpression(aFormat)};};;
var EGenreMessage={SelectionClasse:0,SelectionGroupe:1,SelectionEleve:2,SelectionService:3,SelectionAppreciation:4,SelectionPeriode:5,AucunElevePourPeriode:6,AucunService:7,AucunAppreciation:8,PasDeNotes:9,SelectionClasseOuGroupe:10,AucunElevePourClasse:11,SelectionPilier:12,AucunClassePourPilier:13,AucunPilierPourEleve:14,AucunBulletinPourEleve:15,AucunRelevePourEleve:16,AucunConseilPourEleve:17,AucunClassePourProfesseur:18,AucunMatierePourClasseProf:19,SelectionDisciplineBrevet:20,AucuneDiciplineBrevet:21,SelectionPalier:22,AucunPalier:23,SelectionMatiere:24,AucunMatiere:25,SelectionCompetence:26,SelectionSalle:27,AucunElevePourGroupe:28,SelectionDisciplineLivret:29,AucuneDiciplineLivret:30,SelectionProfesseur:31,AucuneClasseDisponible:32,AucunBulletinDeCompetencesPourEleve:33,AucuneSalleDisponible:34,SelectionPersonnel:35};;
MethodesObjet.heritagePrototype(_PageResultatReleve,_PageResultat);function _PageResultatReleve(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.genreImpression=EGenreImpression.GenerationPDF;}
_PageResultatReleve.prototype.ActionSurRecupererBulletin=function(aParam){this.inherited('ActionSurRecupererBulletin',aParam);if(!aParam.Message){this.afficherBandeau(true);GHtml.setHtml(this.Nom+'_ComplementBandeau','&nbsp;&#45;&nbsp;'+GTraductions.getValeur('Classe')+'&nbsp;'+this.classe.GetLibelle());}};_PageResultatReleve.prototype.AfficherInterfaceGraphique=function(aAfficher){var lArbrePied;if(aAfficher){if(this.ExisteDevoir){this.SetDonnees_Affichage();this.SetDonnees_Services();this.setDonnees_General();this.SetDonnees_Absences();lArbrePied=this.GetInstance(this.identPied).setDonnees_PiedDePage(this.PiedDePage);}}
if(this.ExisteDevoir){this.GetInstance(this.IdentPage).actualiser(lArbrePied);}
else{this.EvenementAfficherMessage(this.ExisteService?EGenreMessage.PasDeNotes:EGenreMessage.AucunService);}
this.surResizeInterface();};_PageResultatReleve.prototype.surEvenementReleve=function(aParamEvnt){switch(aParamEvnt.genreEvnt){case EGenreEvenementNotesEtAppreciations.SaisieAppreciation:this.evenementSaisieSurCellule(aParamEvnt);break;case EGenreEvenementNotesEtAppreciations.MethodeCalculMoyenne:this.evenementMethodeCalculMoyenne(aParamEvnt);break;case EGenreEvenementNotesEtAppreciations.ExecutionQCM:this.evenementExecutionQCM(aParamEvnt);break;}};_PageResultatReleve.prototype.getParametresCalcul=function(aParamEvnt){;var lPeriode=(aParamEvnt.periode?aParamEvnt.periode:GEtatUtilisateur.Navigation.GetRessource(EGenreRessource.Periode));return{libelleEleve:null,numeroEleve:null,libelleClasse:null,numeroClasse:null,libelleServiceNotation:aParamEvnt.service.GetLibelle(),numeroServiceNotation:aParamEvnt.service.GetNumero(),numeroPeriodeNotation:lPeriode.GetNumero(),genreChoixNotation:lPeriode.GetGenre(),moyenneTrimestrielle:aParamEvnt.moyTrimestrielle,pourMoyenneNette:true,ordreChronologique:true};};_PageResultatReleve.prototype.evenementMethodeCalculMoyenne=function(aParamEvnt){if(this.identFenetreMethodeCalculMoyenne)
this.GetInstance(this.identFenetreMethodeCalculMoyenne).SetDonnees(this.getParametresCalcul(aParamEvnt));};_PageResultatReleve.prototype.evenementExecutionQCM=function(aParamEvnt){if(aParamEvnt&&aParamEvnt.executionQCM&&this.GetInstance(this.interfaceFicheVisu)){this.GetInstance(this.interfaceFicheVisu).setParametres(aParamEvnt.executionQCM.GetNumero());this.GetInstance(this.interfaceFicheVisu).setDonnees(aParamEvnt.executionQCM);}};_PageResultatReleve.prototype.initialiserMethodeCalculMoyenne=function(aInstance){aInstance.SetParametres_Fenetre(GTraductions.getValeur('BulletinEtReleve.TitreFenetreCalculMoyenne'),600,300,new Array(GTraductions.getValeur('principal.fermer')),false,false,false,600,150);};_PageResultatReleve.prototype.surModifContexteAffichage=function(){var lFenetre=this.GetInstance(this.identFenetreMethodeCalculMoyenne);if(lFenetre.EstAffiche)
lFenetre.Fermer();};;

MethodesObjet.heritagePrototype(_PiedBulletinReleve,_PageAppreciations);function _PiedBulletinReleve(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.avecScrollV=false;}
_PiedBulletinReleve.prototype.actualiserDimensions=function(aPourImpression,aNumeroImpression){if(aPourImpression){this.TailleTexte=[14,12,10,8][aNumeroImpression];}
else this.TailleTexte=10;this.taillePolice='Texte'+this.TailleTexte;};_PiedBulletinReleve.prototype.composeSeparateur=function(aPourImpression){return'<div class="PetitEspaceHaut PetitEspaceBas" style="height: 5px;"><div style="margin-left: 50px; width: 300px; '+GStyle.composeCouleurBordure(aPourImpression?GCouleur.noir:GCouleur.liste.titre.bordure,1,EGenreBordure.bas)+'">'+'</div></div>';};_PiedBulletinReleve.prototype.setDonnees_Absences=function(aParam){this.absences=[];if(aParam.strAbsences) this.absences .push(aParam.strAbsences);if(aParam.strRetards) this.absences .push(aParam.strRetards);if(aParam.strPunitions) this.absences .push(aParam.strPunitions);if(aParam.strSanctions) this.absences .push(aParam.strSanctions);};_PiedBulletinReleve.prototype.composeAbsences=function(){return this.absences.join(' - ');};_PiedBulletinReleve.prototype.setDonnees_PiedDePage=function(aPiedDePage){this.PiedDePage=aPiedDePage;if(this.PiedDePage.ListeAppreciations){if(this.identAppreciationGenerale>=0)
this.GetInstance(this.identAppreciationGenerale).setDonnees(this.PiedDePage.ListeAppreciations.general,this.PiedDePage.avecSaisieAG);if(this.identAppConseilDeClasse>=0)
this.GetInstance(this.identAppConseilDeClasse).setDonnees(this.PiedDePage.ListeAppreciations.conseilDeClasse,this.PiedDePage.avecSaisieAG,true);if(this.identAppCommentaires>=0)
this.GetInstance(this.identAppCommentaires).setDonnees(this.PiedDePage.ListeAppreciations.commentaires,this.PiedDePage.avecSaisieAG,true);if(this.identAppCPE>=0)
this.GetInstance(this.identAppCPE).setDonnees(this.PiedDePage.ListeAppreciations.cpe,this.PiedDePage.avecSaisieAG,false);}
this.donneesRecues=true;if(GEtatUtilisateur.estModeAccessible()){return this.AfficherListe();} else this.Afficher();};;

MethodesObjet.heritagePrototype(_PiedDeReleve,_PiedBulletinReleve);function _PiedDeReleve(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.donneesRecues=false;this.idAbsences=this.Nom+'_absences';}
_PiedDeReleve.prototype.SetParametresGeneraux=function(){this.GenreStructure=EStructureAffichage.Autre;};_PiedDeReleve.prototype.ConstruireStructureAffichageAutre=function(){var H=[];H.push('<div id="'+this.idAbsences+'"></div>');H.push('<div id="'+this.GetInstance(this.identAppreciationGenerale).GetNom()+'" class="',GEtatUtilisateur.estModeAccessible()?'':'EspaceBas','"></div>');return H.join('');};_PiedDeReleve.prototype.ConstruireAffichage=function(){if(this.donneesRecues){this.actualiserDimensions();this.setHtml(this.idAbsences,this.composeAbsences());this.inherited('ConstruireAffichage');}};_PiedDeReleve.prototype.setHtml=function(aId,aHtml){if(aHtml)
aHtml='<div class="EspaceBas '+this.taillePolice+'">'+aHtml+'</div>';GHtml.setHtml(aId,aHtml);};_PiedDeReleve.prototype.ComposePage=function(aPourImpression,aNumeroImpression){var lPourImpression=(aPourImpression?aPourImpression:false);this.actualiserDimensions(lPourImpression,aNumeroImpression);var H=[];if(GEtatUtilisateur.estModeAccessible()) return'';if(this.donneesRecues){var lHTML_Absences=this.composeAbsences();H.push('<table class="'+this.taillePolice+'" style="width: 100%" border="0" cellpadding="0" cellspacing="0">');if(lHTML_Absences.length){H.push('<tr>');H.push('<td class="EspaceHaut">');H.push(lHTML_Absences);H.push('</td>');H.push('</tr>');}
H.push('<tr><td><div>'+this.GetInstance(this.identAppreciationGenerale).ComposePage(aPourImpression,aNumeroImpression)+'</div></td></tr>');H.push('</table>');}
return H.join('');};;
_PiedDeReleve.prototype.AfficherListe=function(){this._objetListeArborescente=new ObjetListeArborescente(this.Nom+'_Liste',0,this,null);var lRacine=this._objetListeArborescente.construireRacine();this._objetListeArborescente.setParametres(false);for(var I=0;I<this.absences.length;I++)
this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lRacine,'',this.absences[I]);if(this.PiedDePage.ListeAppreciations){var lListe=this.PiedDePage.ListeAppreciations.general;lListe.setTri([ObjetTri.init('Genre')]);lListe.trier();for(I=0;I<lListe.GetNbrElements();I++){var lElement=lListe.GetElement(I);if(lElement&&(lElement.ListeAppreciations.GetElement(0).GetLibelle()!=='')){var lLibelle=GChaine.AvecEspaceSiVide(lElement.Intitule)+' : '+lElement.ListeAppreciations.GetElement(0).GetLibelle();this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lRacine,'',lLibelle);}}}
return lRacine;};;
var EGenreModeSaisie={edition:1,selection:2};;

var EGenreCelluleEditable={appreciation:0,ECTS:1,CompetenceLivretScolaire:2,Note:3};var EGenreNoteMoy={moyProposee:1,moyDeliberee:2};function EltCell(){this.impression=false;this.saisie=false;this.modeSaisie=EGenreModeSaisie.edition;this.libelle='';this.hint='';this.ligne=0;this.colonne=0;this.nom='';this.styleClass='';this.style='';this.width=0;this.colspan=null;this.rowspan=null;this.role= -1;this.libelleWAI='';this.attributWAI=null;this.id='';this.tabindex=null;}
EltCell.prototype.creerCelluleTitre=function(aPourImpression,aWidth,aLibelle,aHint,aRoleWAI,aTabindex,aAttributWAI,aId){this.styleClass='AlignementMilieu Titre';this.style=GTableau.styleTitre(aPourImpression,true,EGenreBordure.bas+EGenreBordure.droite);this.impression=aPourImpression;this.libelle=aLibelle;this.width=aWidth;if(aHint) this.hint=aHint+'';if(aRoleWAI) this.role=aRoleWAI;if((aTabindex!==null)&&(aTabindex!==undefined)) this.tabindex=aTabindex;if(aAttributWAI) this.attributWAI=aAttributWAI;if(aId) this.id=aId;};EltCell.prototype.creerCelluleStd=function(aPourImpression,aWidth,aLibelle,aLigne,aNom,aClass,aStyle,aHint,aRowspan,aRoleWAI,aTabindex,aAttributWAI,aId){this.style=GTableau.styleCellule(aPourImpression,true,EGenreBordure.droite+EGenreBordure.bas,false);this.impression=aPourImpression;this.libelle=''+aLibelle;this.width=aWidth;this.nom=aNom;this.ligne=aLigne;if(aClass) this.styleClass=aClass;if(aStyle) this.style=aStyle;if(aHint) this.hint=''+aHint;if(aRowspan) this.rowspan=aRowspan;if(aRoleWAI) this.role=aRoleWAI;if(aAttributWAI) this.attributWAI=aAttributWAI;if(aTabindex!==null) this.tabindex=aTabindex;if(aId) this.id=aId;};EltCell.prototype.creerCelluleEditable=function(aPourImpression,aWidth,aLibelle,aLigne,aCol,aNom,aClass,aStyle,aModeSaisie,aHint,aRowspan,aAttributWAI){this.saisie=true;this.style=GTableau.styleCellule(aPourImpression,true,EGenreBordure.droite+EGenreBordure.bas,true);this.genreCelluleEditable=EGenreCelluleEditable.appreciation;this.impression=aPourImpression;this.libelle=aLibelle;this.nom=aNom;this.ligne=aLigne;this.colonne=aCol;this.width=aWidth;if(aClass) this.styleClass=aClass;if(aStyle) this.style=aStyle;if(aModeSaisie) this.modeSaisie=aModeSaisie;if(aHint) this.hint=aHint;if(aRowspan) this.rowspan=aRowspan;if(aAttributWAI) this.attributWAI=aAttributWAI;};EltCell.prototype.creerCelluleEditableECTS=function(aPourImpression,aWidth,aLibelle,aLigne,aNom,aClass,aStyle,aModeSaisie,aHint,aRowspan,aAttributWAI){this.saisie=true;this.style=GTableau.styleCellule(aPourImpression,true,EGenreBordure.droite+EGenreBordure.bas,true);this.genreCelluleEditable=EGenreCelluleEditable.ECTS;this.impression=aPourImpression;this.libelle=aLibelle;this.nom=aNom;this.ligne=aLigne;this.width=aWidth;if(aClass) this.styleClass=aClass;if(aStyle) this.style=aStyle;if(aModeSaisie) this.modeSaisie=aModeSaisie;if(aHint) this.hint=aHint;if(aRowspan) this.rowspan=aRowspan;if(aAttributWAI) this.attributWAI=aAttributWAI;};EltCell.prototype.creerCelluleEditableNote=function(aParam){this.creerCelluleEditable(aParam.pourImpression,aParam.width,aParam.libelle,aParam.ligne,aParam.col,aParam.nom,aParam.classe,aParam.style,aParam.modeSaisie,aParam.hint,aParam.rowspan,aParam.attributWAI);this.genreNote=aParam.genreNote;this.genreCelluleEditable=EGenreCelluleEditable.Note;};EltCell.prototype.creerCelluleEditableCompetenceLivretScolaire=function(aPourImpression,aWidth,aLibelle,aLigne,aCol,aNom,aClass,aStyle,aModeSaisie,aHint,aRowspan,aCenterVertical){this.saisie=true;this.style=GTableau.styleCellule(aPourImpression,true,EGenreBordure.droite+EGenreBordure.bas,true);this.genreCelluleEditable=EGenreCelluleEditable.CompetenceLivretScolaire;this.impression=aPourImpression;this.libelle=aLibelle;this.nom=aNom;this.ligne=aLigne;this.colonne=aCol;this.centerVertical=aCenterVertical;this.width=aWidth;if(aClass) this.styleClass=aClass;if(aStyle) this.style=aStyle;if(aModeSaisie) this.modeSaisie=aModeSaisie;if(aHint) this.hint=aHint;if(aRowspan) this.rowspan=aRowspan;};MethodesObjet.heritagePrototype(_ObjetGrilleAffichage,Identite);function _ObjetGrilleAffichage(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.NombreColonnes=1;this._modeEnSaisieSurCellule=false;this.id_saisie='saisie';this.id_divSaisie='divsaisie';this.id_appreciation='cellule';this.id_ECTS='celluleECTS';this.id_saisieECTS='ects';this.id_divECTS='divEcts';this.id_Note='celluleNote';this.id_saisieNote='note';this.id_divNote='divNote';this._indiceNom=0;this._indicePrefixe=1;this._indiceLigne=2;this._indiceColonne=3;}
_ObjetGrilleAffichage.prototype._getLigneDeIdCell=function(aId){return aId.split('_')[this._indiceLigne];};_ObjetGrilleAffichage.prototype._getGenreCelluleDeIdCell=function(aId){var lPrefixe=aId.split('_')[this._indicePrefixe];switch(lPrefixe){case this.id_saisieECTS:return EGenreCelluleEditable.ECTS;case this.id_saisieNote:return EGenreCelluleEditable.Note;default:return EGenreCelluleEditable.appreciation;}};_ObjetGrilleAffichage.prototype._getColonneDeIdCell=function(aId){var lId=aId.split('_');return(lId.length>this._indiceColonne?lId[this._indiceColonne]:0);};_ObjetGrilleAffichage.prototype._getNomDeIdCell=function(aId){return aId.split('_')[this._indiceNom];};_ObjetGrilleAffichage.prototype.idCell=function(aPrefixe,aLigne,aColonne){return this.Nom+'_'+aPrefixe+'_'+aLigne+(aColonne?'_'+aColonne:'');};_ObjetGrilleAffichage.prototype.composeCelluleTitre=function(aPourImpression,aWidth,aLibelle,aHint,aRoleWAI,aTabindex,aAttributWAI,aId){var lCell=new EltCell();lCell.creerCelluleTitre(aPourImpression,aWidth,aLibelle,aHint,aRoleWAI,aTabindex,aAttributWAI,aId);return this.composeCellule(lCell);};_ObjetGrilleAffichage.prototype.composeCelluleTitreAppreciation=function(aPourImpression,aWidth,aLibelle){var lCell=new EltCell();lCell.creerCelluleTitre(aPourImpression,aWidth,aLibelle);lCell.style=GTableau.styleColonneFixe(aPourImpression,true,EGenreBordure.bas+EGenreBordure.gauche)+' vertical-align : top; ';lCell.styleClass='Gras';return this.composeCellule(lCell);};_ObjetGrilleAffichage.prototype.composeCelluleStd=function(aPourImpression,aWidth,aLibelle,aLigne,aNom,aClass,aStyle,aHint,aRowspan,aHauteurLigne,aRoleWAI,aTabindex,aAttributWAI){var lCell=new EltCell();lCell.creerCelluleStd(aPourImpression,aWidth,aLibelle,aLigne,aNom,aClass,aStyle,aHint,aRowspan,aRoleWAI,aTabindex,aAttributWAI);if(aHauteurLigne) lCell.hauteurLigne=aHauteurLigne;return this.composeCellule(lCell);};_ObjetGrilleAffichage.prototype.composeCelluleAppreciation=function(aPourImpression,aWidth,aLibelle,aLigne,aCol,aNom,aClass,aStyle,aModeSaisie,aHint,aRowspan,aHauteurLigne,aHauteurFixeNonEditable,aAttributWAI){var lCell=new EltCell();lCell.creerCelluleEditable(aPourImpression,aWidth,aLibelle,aLigne,aCol,aNom,aClass,aStyle,aModeSaisie,aHint,aRowspan,aAttributWAI);if(aHauteurLigne) lCell.hauteurLigne=aHauteurLigne;if((aHauteurFixeNonEditable===false)&&!aHauteurLigne) lCell.heightAuto=true;if(aHauteurFixeNonEditable&&aPourImpression) lCell.hauteurFixeImpression=true;return this.composeCellule(lCell);};_ObjetGrilleAffichage.prototype.composeCelluleNote=function(aParam){var lCell=new EltCell();lCell.creerCelluleEditableNote(aParam);return this.composeCellule(lCell);};_ObjetGrilleAffichage.prototype.composeCelluleECTS=function(aPourImpression,aWidth,aLibelle,aLigne,aNom,aClass,aStyle,aModeSaisie,aHint,aRowspan,aHauteurLigne,aAttributWAI){var lCell=new EltCell();lCell.creerCelluleEditableECTS(aPourImpression,aWidth,aLibelle,aLigne,aNom,aClass,aStyle,aModeSaisie,aHint,aRowspan,aAttributWAI);if(aHauteurLigne) lCell.hauteurLigne=aHauteurLigne;return this.composeCellule(lCell);};_ObjetGrilleAffichage.prototype.composeCelluleCompetenceLivretScolaire=function(aPourImpression,aWidth,aLibelle,aLigne,aCol,aNom,aClass,aStyle,aModeSaisie,aHint,aRowspan,aHauteurLigne,aCenterVertical){var lCell=new EltCell();lCell.creerCelluleEditableCompetenceLivretScolaire(aPourImpression,aWidth,aLibelle,aLigne,aCol,aNom,aClass,aStyle,aModeSaisie,aHint,aRowspan,aCenterVertical);if(aHauteurLigne) lCell.hauteurLigne=aHauteurLigne;return this.composeCellule(lCell);};_ObjetGrilleAffichage.prototype.composeCellule=function(aCell){var I=aCell.ligne;var lHint=(aCell.hint!=='')?' title="'+GChaine.toTitle(aCell.hint)+'"':'';var lColspan=(aCell.colspan)?' colspan="'+aCell.colspan+'"':'';var lRowspan=(aCell.rowspan)?' rowspan="'+aCell.rowspan+'"':'';var lHauteur=aCell.hauteurLigne?GStyle.composeHeight(aCell.hauteurLigne+(IE.Support.bordureExterneTD?0:-4-1)):'';var lRoleWAI=aCell.role!== -1?GObjetWAI.composeRole(aCell.role):GObjetWAI.composeRole(EGenreRole.Gridcell);var lTabindex=aCell.tabindex!==null?' tabindex="'+aCell.tabindex+'" ':'';var lAttributWAI=aCell.attributWAI?GObjetWAI.composeAttribut(aCell.attributWAI):'';var lId=aCell.id?' id="'+aCell.id+'" ':(!aCell.saisie)?' id="'+this.idCell(aCell.nom,I)+'" ':'';if(aCell.impression){var lLibelle=MethodesObjet.isString(aCell.libelle)?GChaine.ToStringHtml(GChaine.AvecEspaceSiVide((aCell.libelle))):aCell.libelle;if(aCell.hauteurFixeImpression){var lHauteurDiv=aCell.hauteurLigne?GStyle.composeHeight(aCell.hauteurLigne-4-1):'';lLibelle='<div style="overflow:hidden;'+lHauteurDiv+'">'+lLibelle+'</div>';}
return'<td '+lId+lRoleWAI+lTabindex+lAttributWAI+' width="'+aCell.width+'" class="Cellule '+aCell.styleClass+'"'+' style="'+aCell.style+lHauteur+'" '+lColspan+' '+lRowspan+'>'+lLibelle+'</td>';}
else if(!aCell.saisie)
return'<td  '+lId+lRoleWAI+lTabindex+lAttributWAI+' class="Cellule '+aCell.styleClass+'"'+' style="'+GStyle.composeWidth(aCell.width)+aCell.style+lHauteur+'"'+((I===0)?'':(' onmouseup="'+this.Nom+'._surFocus (id)" onfocus="'+this.Nom+'._surFocus (id)"'))+lHint+' '+lColspan+' '+lRowspan+'>'+GChaine.AvecEspaceSiVide((aCell.libelle))+'</td>';switch(aCell.genreCelluleEditable){case EGenreCelluleEditable.appreciation:return this._composeCelluleAppreciation(aCell);case EGenreCelluleEditable.ECTS:return this._composeCelluleECTS(aCell);case EGenreCelluleEditable.CompetenceLivretScolaire:return this._composeCelluleCompetenceLivretScolaire(aCell);case EGenreCelluleEditable.Note:return this._composeCelluleNote(aCell);default:return'';}};_ObjetGrilleAffichage.prototype.selectionnerLigne=function(){};_ObjetGrilleAffichage.prototype.deselectionnerLigne=function(){};_ObjetGrilleAffichage.prototype.surModificationECTS=function(){};_ObjetGrilleAffichage.prototype.GetHauteurCellule=function(){return 3;};_ObjetGrilleAffichage.prototype.setCellule=function(aNumLigne,aNumColonne,aGenreCell){this.NumLigne=parseInt(aNumLigne);this.NumColonne=parseInt(aNumColonne);this.GenreCellule=aGenreCell;this.Ligne=this.NumLigne>0?this.Liste.GetElement(this.NumLigne-1):null;};_ObjetGrilleAffichage.prototype._surBlur=function(aId){this._idCellule=null;this.deselectionnerLigne(this._getLigneDeIdCell(aId));this.setCellule(0,0,null);};_ObjetGrilleAffichage.prototype._setColonne=function(aNumColonne){this.setCellule(this.NumLigne,aNumColonne,this.GenreCellule);};_ObjetGrilleAffichage.prototype._recupererCoordonneesCellule=function(aId){if(aId===null||aId===undefined)
aId=this._idCellule;if(aId){return{numLigne:this._getLigneDeIdCell(aId)-1,numAppreciation:this._getColonneDeIdCell(aId)-1,nomObjet:this._getNomDeIdCell(aId),interfaces:[]};}};_ObjetGrilleAffichage.prototype._composeCelluleAppreciation=function(aCell){var I=aCell.ligne;var J=aCell.colonne;var lColspan=(aCell.colspan)?' colspan="'+aCell.colspan+'"':'';var lRowspan=(aCell.rowspan)?' rowspan="'+aCell.rowspan+'"':'';var lHauteur=aCell.hauteurLigne?GStyle.composeHeight(aCell.hauteurLigne+(IE.Support.bordureExterneTD?0:-4-1)):'';var lElement=this.Liste.GetElement(I-1);var lEditable=lElement.Editable&&!lElement.Cloture;var lCouleur=lElement.Titre&&!lEditable?GCouleur.liste.cumul[1].getFond():(lElement.Editable?GCouleur.liste.editable.getFond():GCouleur.liste.nonEditable.getFond());var lTabIndex=!lElement.Editable||lElement.Cloture?'tabindex="-1" ':'';var lAttributWAI=aCell.attributWAI?' '+GObjetWAI.composeAttribut(aCell.attributWAI)+' ':'';var lRoleWAI=aCell.role!== -1?GObjetWAI.composeRole(aCell.role):GObjetWAI.composeRole(EGenreRole.Gridcell);var T=[];var lClass=[];var lOnFocus='';if(!lEditable&&aCell.heightAuto&&!aCell.hauteurLigne){lHauteur=GStyle.composeHeight(((aCell.rowspan)?aCell.rowspan:1)*((lElement.Titre?1:this.GetHauteurCellule())*GChaine.GetHauteurPolice(10))+(IE.Support.bordureExterneTD?0:-4-1));lClass.push('AlignementHaut','AvecInterdiction');lOnFocus=' onclick="'+this.Nom+'._surFocusTD ('+I+','+J+')"';}
else lClass.push('AlignementMilieuVertical');T.push('<td style="padding:2px;'+aCell.style+' '+GStyle.composeWidth(aCell.width)+' '+lHauteur+' background-color:'+lCouleur+'" id="'+this.idCell(aCell.nom,I,J)+'" class="' ,lClass.join(' '),'" '+lColspan+' '+lRowspan+lOnFocus+'>');T.push('<div style="'+GStyle.composeWidth(aCell.width)+' background-color:'+lCouleur+'" id="'+this.idCell(this.id_divSaisie,I,J)+'" class="SaisieAppreciation_Cellule">');var lHauteurCellule;if(lEditable){lHauteurCellule=aCell.hauteurLigne?aCell.hauteurLigne-4-1-2:1+((aCell.rowspan)?aCell.rowspan:1)*(this.GetHauteurCellule()*GChaine.GetHauteurPolice(10));T.push('<textarea ');T.push('style="'+GStyle.composeCouleurFond(lCouleur)+GStyle.composeHeight(lHauteurCellule)+'" id="'+this.idCell(this.id_saisie,I,J)+'" ');if(aCell.libelleWai) T.push(GObjetWAI.composeAttribut({genre:EGenreAttribut.label,valeur:aCell.libelleWai}));T.push('class="Texte10 CelluleSaisie '+aCell.styleClass+'" ');T.push(aCell.modeSaisie===EGenreModeSaisie.edition?'onfocus="'+this.Nom+'._surFocus (id)" ':'onfocus="'+this.Nom+'._surFocusEnModeSelection (id)" ');T.push(aCell.modeSaisie===EGenreModeSaisie.edition?'onblur="'+this.Nom+'._surBlur (id)" ':'onblur="'+this.Nom+'._surBlurEnModeSelection (id)" ');T.push('onchange="'+this.Nom+'._surModification (id)" onkeyup="'+this.Nom+'._surModification (id)" ');T.push(aCell.modeSaisie===EGenreModeSaisie.edition?'':'onclick="'+this.Nom+'._surSaisieEnModeSelection (id)"');T.push(lTabIndex);T.push(lAttributWAI);T.push(' '+lRoleWAI+' ');T.push(((aCell.modeSaisie===EGenreModeSaisie.edition)?'':'readOnly')+'>');T.push(aCell.libelle+'</textarea>');} else{if(!aCell.heightAuto)
lHauteurCellule=aCell.hauteurLigne?aCell.hauteurLigne-6-1:((aCell.rowspan)?aCell.rowspan:1)*((lElement.Titre?1:this.GetHauteurCellule())*GChaine.GetHauteurPolice(10));T.push('<div style="'+GStyle.composeCouleurFond(lCouleur)+(!aCell.heightAuto?GStyle.composeHeight(lHauteurCellule+2):'height:auto;')+'overflow:hidden;" class="'+aCell.styleClass+' AvecInterdiction" id="'+this.idCell(this.id_saisie,I,J)+'" onclick="'+this.Nom+'._surFocus (id)">',GChaine.AvecEspaceSiVide(aCell.libelle),'</div>');}
T.push('</div>');T.push('</td>');return T.join('');};_ObjetGrilleAffichage.prototype.setParametres=function(aTailleMaxAppreciation,aAvecCorrige){this.tailleMaxSaisie=aTailleMaxAppreciation;this.avecCorrige=aAvecCorrige;};_ObjetGrilleAffichage.prototype.setLibelleCellule=function(aCoordonneesAppreciation,aLibelle){var lNumLigne=aCoordonneesAppreciation.numLigne+1;var lNumAppreciation=aCoordonneesAppreciation.numAppreciation+1;var lId=this.idCell(this.id_saisie,lNumLigne,lNumAppreciation);GHtml.setHtml(lId,aLibelle);};_ObjetGrilleAffichage.prototype._surFocusTD=function(I,J){this._surFocus(this.idCell(this.id_saisie,I,J));};_ObjetGrilleAffichage.prototype._surFocus=function(aId){this._attacherGestionnaireEvenement(aId);this._idCellule=aId;if(this.deselectionnerLigne&&((this.NumLigne!==0)||(this.NumColonne!==0)))
this.deselectionnerLigne(this.NumLigne);this.setCellule(this._getLigneDeIdCell(aId),this._getColonneDeIdCell(aId),this._getGenreCelluleDeIdCell(aId));if(this.Ligne.Editable&&this.Ligne.Cloture&&(this.NumColonne>0))
GApplication.getMessage().Afficher(EGenreBoiteMessage.Information,GTraductions.getValeur('SaisieImpossible'),GTraductions.getValeur('PeriodeCloturee'));if(!this.Ligne.Editable||this.Ligne.Cloture)
this._setColonne(0);this.selectionnerLigne(aId);};_ObjetGrilleAffichage.prototype._attacherGestionnaireEvenement=function(aId){$('#'+aId.escapeJQ()).unbind('keydown').bind('keydown',{instance:this},this._surKeyDown);};_ObjetGrilleAffichage.prototype._surModification=function(aId){if(aId===null||aId===undefined)
aId=this._idCellule;if(aId){var lCellule=this._recupererCoordonneesCellule(aId);var lNumLigne=lCellule.numLigne;var lNumAppreciation=lCellule.numAppreciation;var lLigne=this.Liste.GetElement(lNumLigne);var lLigneSousService=null;if((lLigne.estService===false)&&(this.Affichage.AvecAppreciationParSousService===false)&&lLigne.pere){lLigneSousService=lLigne;lLigne=lLigne.pere;}
var lAppreciation=lLigne.ListeAppreciations.GetElement(lNumAppreciation);var lValeur=GHtml.getValue(aId),lValeurSansEntites=GChaine.enleverEntites(lValeur);if(lValeur!==null){if(lValeurSansEntites.length>this._getTailleMaxSaisie(lCellule)){GHtml.setValue(aId,lAppreciation.Libelle);GApplication.getMessage().Afficher(EGenreBoiteMessage.Information,null,GTraductions.getValeur('MessageTailleMaxAppr'));} else if(lAppreciation&&(lAppreciation.Libelle!==lValeur)){this.SetEtatSaisie(true);lLigne.SetEtat(EGenreEtat.Modification);if(lLigneSousService)
lLigneSousService.SetEtat(EGenreEtat.Modification);lAppreciation.SetEtat(EGenreEtat.Modification);lAppreciation.Libelle=lValeur;}}}};_ObjetGrilleAffichage.prototype._surFocusEnModeSelection=function(aId){this._surFocus(aId);if(!this._modeEnSaisieSurCellule)
this._surSaisieEnModeSelection(aId);};_ObjetGrilleAffichage.prototype._surBlurEnModeSelection=function(aId){if(this._modeEnSaisieSurCellule){this.deselectionnerLigne(this.NumLigne);this._modeEnSaisieSurCellule=false;}};_ObjetGrilleAffichage.prototype._surSaisieEnModeSelection=function(aId){var lCoordonneesCellule=this._recupererCoordonneesCellule(aId);var lParamEvnt={genreEvnt:EGenreEvenementNotesEtAppreciations.SaisieAppreciation,coordonneesCellule:lCoordonneesCellule,tailleMaxAppreciation:this._getTailleMaxSaisie(lCoordonneesCellule)};this.callback.appel(lParamEvnt);};_ObjetGrilleAffichage.prototype._surSaisieCompetenceLS=function(aId){var lCoordonneesCellule=this._recupererCoordonneesCellule(aId);var lParamEvnt={saisieCompetenceLivretScolaire:true,coordonneesCellule:lCoordonneesCellule};this.callback.appel(lParamEvnt);};_ObjetGrilleAffichage.prototype._surKeyDown=function(aEvent){var lInstance=aEvent.data.instance;GNavigateur.SetCodeTouche(aEvent);var lIdSaisie=lInstance.idCell(lInstance.id_saisie,lInstance.NumLigne,lInstance.NumColonne);if(GNavigateur.CodeTouche===ToucheClavier.Echap){GHtml.setFocus(lIdSaisie,false);return false;}
if((GNavigateur.CodeTouche===ToucheClavier.RetourChariot)&&!GNavigateur.ShiftTouche){GNavigateur.bloquerValeurEvenement(aEvent);lInstance.passerFocusSuivant(+1,+1);return false;}
if(GNavigateur.CodeTouche===ToucheClavier.FlecheHaut){lInstance.passerFocusSuivant(-1,0);return false;}
if(GNavigateur.CodeTouche===ToucheClavier.FlecheBas){lInstance.passerFocusSuivant(+1,0);return false;}
if((lInstance.NumColonne>0)&&!GNavigateur.EstToucheSpeciale()&&(GChaine.enleverEntites(GHtml.getValue(lIdSaisie)).length>lInstance._getTailleMaxSaisie())){GApplication.getMessage().Afficher(EGenreBoiteMessage.Information,null,GTraductions.getValeur('MessageTailleMaxAppr'));return false;}};_ObjetGrilleAffichage.prototype._getTailleMaxSaisie=function(aCellule){var lNumLigne,lNumAppreciation,lLigne,lAppreciation;var lResult;if(!!aCellule){lNumLigne=aCellule.numLigne;lNumAppreciation=aCellule.numAppreciation;} else{lNumLigne=this.NumLigne-1;lNumAppreciation=this.NumColonne-1;lLigne=this.Ligne;}
if(!lLigne)
lLigne=this.Liste.GetElement(lNumLigne);lAppreciation=lLigne.ListeAppreciations.GetElement(lNumAppreciation);if(lAppreciation&&lAppreciation.tailleMaxSaisie)
lResult=lAppreciation.tailleMaxSaisie;else lResult=this.tailleMaxSaisie;return lResult;};_ObjetGrilleAffichage.prototype.passerFocusSuivant=function(aSensLigne,aSensColonne){var lNumLigne=this.NumLigne;var lNumColonne=this.NumColonne,lLigne;if(this.NumLigne>0){if(aSensColonne&&(this.Liste.GetElement(lNumLigne-1).Editable)){if(lNumColonne<this.NombreColonnes){lNumColonne=lNumColonne+aSensColonne;}}
if((lNumLigne<this.Liste.GetNbrElements()||lNumLigne+aSensLigne<this.Liste.GetNbrElements())&&(this.NumColonne===lNumColonne)){do{lNumLigne=lNumLigne+aSensLigne;lLigne=this.Liste.GetElement(lNumLigne-1);} while((lNumLigne>=1)&&(lNumLigne<=this.Liste.GetNbrElements())&&(!lLigne.Editable||lLigne.Cloture));if(aSensColonne)
lNumColonne=1;}
if((lNumLigne>=1)&&(lNumLigne<=this.Liste.GetNbrElements()))
this._surFocus(this.idCell(this.id_saisie,lNumLigne,lNumColonne));}};_ObjetGrilleAffichage.prototype.setFocus=function(){if(GEtatUtilisateur.estModeAccessible()&&this._objetListeArborescente) this._objetListeArborescente.setFocus();};_ObjetGrilleAffichage.prototype.passerEnSaisieSurCellule=function(){this._modeEnSaisieSurCellule=true;GHtml.setReadOnly(this.idCell(this.id_saisie,this.NumLigne,this.NumColonne),false);this.passerFocusSuivant(0,0);};_ObjetGrilleAffichage.prototype.determinerCurseurPourCellule=function(aAppreciation,aPourImpression){return((GApplication.droits.get(IEEnum.droits.assistantSaisieAppreciations)&&GEtatUtilisateur.assistantSaisieActif&&(!aPourImpression))?'Curseur_AssistantSaisieActif':'');};_ObjetGrilleAffichage.prototype.determinerModeSaisiePourCellule=function(){return((GApplication.droits.get(IEEnum.droits.assistantSaisieAppreciations)&&GEtatUtilisateur.assistantSaisieActif)?EGenreModeSaisie.selection:EGenreModeSaisie.edition);};_ObjetGrilleAffichage.prototype._composeCelluleECTS=function(aCell){var I=aCell.ligne;var J=0;var lColspan=(aCell.colspan)?' colspan="'+aCell.colspan+'"':'';var lRowspan=(aCell.rowspan)?' rowspan="'+aCell.rowspan+'"':'';var lHauteur=aCell.hauteurLigne?GStyle.composeHeight(aCell.hauteurLigne+(IE.Support.bordureExterneTD?0:-4-1)):'';var lElement=this.Liste.GetElement(I-1);var lEditable=lElement.ECTSEditable&&!lElement.Cloture;var lCouleur=lElement.Titre&&!lEditable?GCouleur.liste.cumul[1].getFond():(lElement.ECTSEditable?GCouleur.liste.editable.getFond():GCouleur.liste.nonEditable.getFond());var lTabIndex=!lElement.ECTSEditable||lElement.Cloture?'tabindex="-1" ':'';var T=[];var lClass=[];var lOnFocus='';if(!lEditable&&aCell.heightAuto&&!aCell.hauteurLigne){lHauteur=GStyle.composeHeight(((aCell.rowspan)?aCell.rowspan:1)*((lElement.Titre?1:this.GetHauteurCellule())*GChaine.GetHauteurPolice(10))+(IE.Support.bordureExterneTD?0:-4-1));lClass.push('AlignementHaut','AvecInterdiction');}
else lClass.push('AlignementMilieuVertical');T.push('<td style="padding:2px;'+aCell.style+' '+GStyle.composeWidth(aCell.width)+' '+lHauteur+' background-color:'+lCouleur+'" id="'+this.idCell(aCell.nom,I,J)+'" class="' ,lClass.join(' '),'" '+lColspan+' '+lRowspan+lOnFocus+'>');T.push('<div style="width:100%; background-color:'+lCouleur+'" id="'+this.idCell(this.id_divECTS,I,J)+'">');var lHauteurCellule;if(lEditable){lHauteurCellule=aCell.hauteurLigne?aCell.hauteurLigne-4-1-2:1+((aCell.rowspan)?aCell.rowspan:1)*(this.GetHauteurCellule()*GChaine.GetHauteurPolice(10));T.push('<textarea ');T.push('style="padding-right : 1px; '+GStyle.composeCouleurFond(lCouleur)+GStyle.composeHeight(lHauteurCellule)+'" id="'+this.idCell(this.id_saisieECTS,I,J)+'" ');if(aCell.libelleWai) T.push(GObjetWAI.composeAttribut({genre:EGenreAttribut.label,valeur:aCell.libelleWai}));T.push('class="Texte10 CelluleSaisie '+aCell.styleClass+'" ');T.push('onfocus="'+this.Nom+'._surFocusECTS (id)" ');T.push('onblur="'+this.Nom+'._surBlur (id)" ');T.push('onkeyup="'+this.Nom+'._surModificationECTS (id)" ');T.push('onchange="'+this.Nom+'._surModificationECTS (id)" ');T.push('onkeypress="'+this.Nom+'._surKeyPressECTS (event)" ');T.push(lTabIndex);T.push('>');T.push(aCell.libelle+'</textarea>');} else{if(!aCell.heightAuto)
lHauteurCellule=aCell.hauteurLigne?aCell.hauteurLigne-6-1:((aCell.rowspan)?aCell.rowspan:1)*((lElement.Titre?1:this.GetHauteurCellule())*GChaine.GetHauteurPolice(10));T.push('<div style="'+GStyle.composeCouleurFond(lCouleur)+(!aCell.heightAuto?GStyle.composeHeight(lHauteurCellule+2):'height:auto;')+'overflow:hidden;" class="'+aCell.styleClass+' AvecInterdiction" id="'+this.idCell(this.id_saisieECTS,I,J)+'" onclick="'+this.Nom+'._surFocusECTS (id)">',(aCell.libelle),'</div>');}
T.push('</div>');T.push('</td>');return T.join('');};_ObjetGrilleAffichage.prototype._composeCelluleCompetenceLivretScolaire=function(aCell){var I=aCell.ligne;var J=aCell.colonne;var lHint=(aCell.hint!=='')?'title="'+GChaine.toTitle(aCell.hint)+'" ':'';var lColspan=(aCell.colspan)?' colspan="'+aCell.colspan+'"':'';var lRowspan=(aCell.rowspan)?' rowspan="'+aCell.rowspan+'"':'';var lHauteur=aCell.hauteurLigne?GStyle.composeHeight(aCell.hauteurLigne+(IE.Support.bordureExterneTD?0:-4-1)):'';var lElement=this.Liste.GetElement(I-1);var lEditable=lElement.livretEditable&&((lElement.itemLivretScolaire&&(lElement.avecServices||lElement.estSansObligationDeNotation))||lElement.listeCompetences);var lCouleur=lEditable?GCouleur.liste.editable.getFond():GCouleur.liste.nonEditable.getFond();var T=[];var lClass=[];var lOnFocus='';if(!lEditable&&aCell.heightAuto&&!aCell.hauteurLigne){lHauteur=GStyle.composeHeight(((aCell.rowspan)?aCell.rowspan:1)*((lElement.Titre?1:this.GetHauteurCellule())*GChaine.GetHauteurPolice(10))+(IE.Support.bordureExterneTD?0:-4-1));lClass.push('AlignementHaut','AvecInterdiction');}
else lClass.push('AlignementMilieuVertical');T.push('<td style="padding:2px;'+aCell.style+' '+GStyle.composeWidth(aCell.width)+' '+lHauteur+' background-color:'+lCouleur+'" id="'+this.idCell(aCell.nom,I,J)+'" class="' ,lClass.join(' '),'" '+lColspan+' '+lRowspan+lOnFocus+'>');T.push('<div style="'+GStyle.composeWidth(aCell.width)+' background-color:'+lCouleur+'" id="'+this.idCell(aCell.nom+'Div',I,J)+'">');var lHauteurCellule;if(lEditable){lHauteurCellule=aCell.hauteurLigne?aCell.hauteurLigne-4-1-2:1+((aCell.rowspan)?aCell.rowspan:1)*(this.GetHauteurCellule()*GChaine.GetHauteurPolice(10));if(!aCell.heightAuto)
lHauteurCellule=aCell.hauteurLigne?aCell.hauteurLigne-6-1:((aCell.rowspan)?aCell.rowspan:1)*((lElement.Titre?1:this.GetHauteurCellule())*GChaine.GetHauteurPolice(10));T.push('<div tabindex="0" style="'+GStyle.composeCouleurFond(lCouleur)+(!aCell.heightAuto?GStyle.composeHeight(lHauteurCellule+2):'height:auto;')+'overflow:hidden;" class="'+aCell.styleClass+' AvecMain" ');T.push('id="'+this.idCell(aCell.nom+'Saisie',I,J)+'" ');if(aCell.libelleWai) T.push(GObjetWAI.composeAttribut({genre:EGenreAttribut.label,valeur:aCell.libelleWai}));T.push(lHint);T.push('onclick="'+this.Nom+'._surSaisieCompetenceLS (id)" ');T.push('onfocus="'+this.Nom+'._surFocus (id)" ');T.push('onblur="'+this.Nom+'._surBlur (id)"');T.push('>');if(aCell.centerVertical)
T.push('<div class="InlineBlock" style="height: 100%; vertical-align: middle;"></div><div class="InlineBlock" style="vertical-align: middle;">');T.push(aCell.libelle);if(aCell.centerVertical)
T.push('</div>');T.push('</div>');} else{if(!aCell.heightAuto)
lHauteurCellule=aCell.hauteurLigne?aCell.hauteurLigne-6-1:((aCell.rowspan)?aCell.rowspan:1)*((lElement.Titre?1:this.GetHauteurCellule())*GChaine.GetHauteurPolice(10));T.push('<div style="'+GStyle.composeCouleurFond(lCouleur)+(!aCell.heightAuto?GStyle.composeHeight(lHauteurCellule+2):'height:auto;')+'overflow:hidden;" class="'+aCell.styleClass+'" id="'+this.idCell(aCell.nom+'Saisie',I,J)+'" '+lHint+'>');if(aCell.centerVertical)
T.push('<div class="InlineBlock" style="height: 100%; vertical-align: middle;"></div><div class="InlineBlock" style="vertical-align: middle;">');T.push(aCell.libelle);if(aCell.centerVertical)
T.push('</div>');T.push('</div>');}
T.push('</div>');T.push('</td>');return T.join('');};_ObjetGrilleAffichage.prototype._surFocusECTS=function(aId){GHtml.setFocus(aId,true);this._attacherGestionnaireEvenementECTS(aId);this._idCellule=aId;if(this.deselectionnerLigne&&(this.NumLigne!==0))
this.deselectionnerLigne(this.NumLigne);this.setCellule(this._getLigneDeIdCell(aId),this._getColonneDeIdCell(aId),this._getGenreCelluleDeIdCell(aId));if(this.Ligne.ECTSEditable&&this.Ligne.Cloture)
GApplication.getMessage().Afficher(EGenreBoiteMessage.Information,GTraductions.getValeur('SaisieImpossible'),GTraductions.getValeur('PeriodeCloturee'));if(!this.Ligne.ECTSEditable||this.Ligne.Cloture)
this._setColonne(0);this.selectionnerLigne();};_ObjetGrilleAffichage.prototype._surModificationECTS=function(aId){if(aId===null||aId===undefined)
aId=this._idCellule;if(aId){var lCellule=this._recupererCoordonneesCellule(aId);var lNumLigne=lCellule.numLigne;var lLigne=this.Liste.GetElement(lNumLigne);var lValeur=GHtml.getValue(aId);if(lValeur!==null){if((lValeur!=='')&&isNaN(GChaine.strToDouble(lValeur))){this._surSaisieIncorrecte(null,aId);return;}
var lValeurECTS=lValeur===''?false:GChaine.strToDouble(lValeur);if(lLigne&&(lValeurECTS!==lLigne.ECTS)){var lNbECTSService=lLigne.nbECTSService===false?1000:lLigne.nbECTSService;if((lValeurECTS===false)||(lValeurECTS<=lNbECTSService)){this.SetEtatSaisie(true);lLigne.SetEtat(EGenreEtat.Modification);lLigne.ECTS=lValeurECTS;this.surModificationECTS();}else{GHtml.setValue(aId,lLigne.ECTS!==false?lLigne.ECTS:'');GApplication.getMessage().Afficher(EGenreBoiteMessage.Information,GTraductions.getValeur('BulletinEtReleve.SaisieIncorrecte'),GTraductions.getValeur('BulletinEtReleve.InfoBornesSaisie',[0,lNbECTSService]),null,this,this._surSaisieIncorrecte,aId);}}}}};_ObjetGrilleAffichage.prototype._surSaisieIncorrecte=function(aGenreBouton,aId){if(aId===null||aId===undefined)
aId=this._idCellule;if(aId){var lCellule=this._recupererCoordonneesCellule(aId);var lNumLigne=lCellule.numLigne;var lLigne=this.Liste.GetElement(lNumLigne);GHtml.setValue(aId,lLigne.ECTS!==false?lLigne.ECTS:'');GHtml.setFocus(aId,true);}};_ObjetGrilleAffichage.prototype._attacherGestionnaireEvenementECTS=function(aId){$('#'+aId.escapeJQ()).unbind('keydown').bind('keydown',{instance:this},this._surKeyDownECTS);};_ObjetGrilleAffichage.prototype._surKeyDownECTS=function(aEvent){var lInstance=aEvent.data.instance;GNavigateur.SetCodeTouche(aEvent);var lIdECTS=lInstance.idCell(lInstance.id_saisieECTS,lInstance.NumLigne,lInstance.NumColonne);if(GNavigateur.CodeTouche===27){GHtml.setFocus(lIdECTS,false);return false;}
if(GNavigateur.CodeTouche===13){GNavigateur.bloquerValeurEvenement(aEvent);lInstance.passerFocusECTSSuivant(+1);return false;}
if(GNavigateur.CodeTouche===38){lInstance.passerFocusECTSSuivant(-1);return false;}
if(GNavigateur.CodeTouche===40){lInstance.passerFocusECTSSuivant(+1);return false;}};_ObjetGrilleAffichage.prototype.passerFocusECTSSuivant=function(aSensLigne){var lNumLigne=this.NumLigne,lLigne;if(this.NumLigne>0){if(lNumLigne<this.Liste.GetNbrElements()){do{lNumLigne=lNumLigne+aSensLigne;lLigne=this.Liste.GetElement(lNumLigne-1);} while((lNumLigne>=1)&&(lNumLigne<=this.Liste.GetNbrElements())&&(!lLigne.ECTSEditable||lLigne.Cloture));}
if((lNumLigne>=1)&&(lNumLigne<=this.Liste.GetNbrElements()))
this._surFocusECTS(this.idCell(this.id_saisieECTS,lNumLigne,0));}};_ObjetGrilleAffichage.prototype._surKeyPressECTS=function(aEvent){GNavigateur.SetCaractereTouche(aEvent);if(!GNavigateur.estCaractereNote(false,true,false))
GNavigateur.bloquerValeurEvenement(aEvent);};_ObjetGrilleAffichage.prototype._composeCelluleNote=function(aCell){var I=aCell.ligne;var J=aCell.colonne;var lColspan=(aCell.colspan)?' colspan="'+aCell.colspan+'"':'';var lRowspan=(aCell.rowspan)?' rowspan="'+aCell.rowspan+'"':'';var lHauteur=aCell.hauteurLigne?GStyle.composeHeight(aCell.hauteurLigne+(IE.Support.bordureExterneTD?0:-4-1)):'';var lElement=this.Liste.GetElement(I-1);var lEditable=false;var lCouleur;switch(aCell.genreNote){case EGenreNoteMoy.moyDeliberee:lEditable=lElement.moyDelibereeEditable&&!lElement.moyDelibereeCloture;lCouleur=lElement.moyDelibereeEditable?GCouleur.liste.editable.getFond():GCouleur.liste.nonEditable.getFond();break;case EGenreNoteMoy.moyProposee:lEditable=lElement.moyProposeeEditable&&!lElement.moyProposeeCloture;lCouleur=lElement.moyProposeeEditable?GCouleur.liste.editable.getFond():GCouleur.liste.nonEditable.getFond();break;default:lEditable=lElement.Editable&&!lElement.Cloture;lCouleur=lElement.Editable?GCouleur.liste.editable.getFond():GCouleur.liste.nonEditable.getFond();break;}
var lTabIndex=!lEditable?'tabindex="-1" ':'';var T=[];var lClass=[];var lOnFocus='';if(!lEditable&&aCell.heightAuto&&!aCell.hauteurLigne){lHauteur=GStyle.composeHeight(((aCell.rowspan)?aCell.rowspan:1)*((lElement.Titre?1:this.GetHauteurCellule())*GChaine.GetHauteurPolice(10))+(IE.Support.bordureExterneTD?0:-4-1));lClass.push('AlignementHaut','AvecInterdiction');}
else lClass.push('AlignementMilieuVertical');T.push('<td style="padding:2px;'+aCell.style+' '+GStyle.composeWidth(aCell.width)+' '+lHauteur+' background-color:'+lCouleur+'" id="'+this.idCell(aCell.nom,I,J)+'" class="' ,lClass.join(' '),'" '+lColspan+' '+lRowspan+lOnFocus+'>');T.push('<div style="width:100%; background-color:'+lCouleur+'" id="'+this.idCell(this.id_divNote,I,J)+'">');var lHauteurCellule;if(lEditable){lHauteurCellule=aCell.hauteurLigne?aCell.hauteurLigne-4-1-2:1+((aCell.rowspan)?aCell.rowspan:1)*(this.GetHauteurCellule()*GChaine.GetHauteurPolice(10));var lIdSaisieNote=this.idCell(this.id_saisieNote,I,J);T.push('<textarea ');T.push('style="padding-right : 1px; '+GStyle.composeCouleurFond(lCouleur)+GStyle.composeHeight(lHauteurCellule)+'" id="'+lIdSaisieNote+'" ');if(aCell.libelleWai) T.push(GObjetWAI.composeAttribut({genre:EGenreAttribut.label,valeur:aCell.libelleWai}));T.push('class="Texte10 CelluleSaisie '+aCell.styleClass+'" ');T.push('onfocus="'+this.Nom+'._surFocusNote (id, ',aCell.genreNote,')" ');T.push('onblur="'+this.Nom+'._surModificationNote (id, ',aCell.genreNote,')" ');T.push('onkeypress="'+this.Nom+'._surKeyPressNote (id, event)" ');T.push(lTabIndex);T.push('>');T.push(aCell.libelle+'</textarea>');} else{if(!aCell.heightAuto)
lHauteurCellule=aCell.hauteurLigne?aCell.hauteurLigne-6-1:((aCell.rowspan)?aCell.rowspan:1)*((lElement.Titre?1:this.GetHauteurCellule())*GChaine.GetHauteurPolice(10));T.push('<div style="'+GStyle.composeCouleurFond(lCouleur)+(!aCell.heightAuto?GStyle.composeHeight(lHauteurCellule+2):'height:auto;')+'overflow:hidden;" class="'+aCell.styleClass+' AvecInterdiction" id="'+this.idCell(this.id_saisieNote,I,J)+'" onclick="'+this.Nom+'._surFocusNote (id, ',aCell.genreNote,')">',(aCell.libelle),'</div>');}
T.push('</div>');T.push('</td>');return T.join('');};_ObjetGrilleAffichage.prototype._surFocusNote=function(aId,aGenreNote){GHtml.setFocus(aId,true);$('#'+aId.escapeJQ()).unbind('keydown').bind('keydown',{instance:this},this._surKeyDownNote);this._idCellule=aId;if(this.deselectionnerLigne&&(this.NumLigne!==0))
this.deselectionnerLigne(this.NumLigne);this.setCellule(this._getLigneDeIdCell(aId),this._getColonneDeIdCell(aId),this._getGenreCelluleDeIdCell(aId));var lEstEditableEtCloture=false;switch(aGenreNote){case EGenreNoteMoy.moyDeliberee:lEstEditableEtCloture=this.Ligne.moyDelibereeEditable&&this.Ligne.moyDelibereeCloture;break;case EGenreNoteMoy.moyProposee:lEstEditableEtCloture=this.Ligne.moyProposeeEditable&&this.Ligne.moyProposeeCloture;break;}
if(lEstEditableEtCloture)
GApplication.getMessage().Afficher(EGenreBoiteMessage.Information,GTraductions.getValeur('SaisieImpossible'),GTraductions.getValeur('PeriodeCloturee'));var lNonEditable=true;switch(aGenreNote){case EGenreNoteMoy.moyDeliberee:lNonEditable=!this.Ligne.moyDelibereeEditable||this.Ligne.moyDelibereeCloture;break;case EGenreNoteMoy.moyProposee:lNonEditable=!this.Ligne.moyProposeeEditable||this.Ligne.moyProposeeCloture;break;}
if(lNonEditable)
this._setColonne(0);this.selectionnerLigne();};_ObjetGrilleAffichage.prototype._surVerificationNote=function(aId,aGenreNote){var lValueNote=GHtml.getValue(aId);if(lValueNote.search(/^[0-9]*(,|\.)[0-9]+/)===0){lValueNote=lValueNote.replace(/^([0-9]*(,|\.)[0-9]{2}).*$/,"$1");GHtml.setValue(aId,lValueNote);}
var lNote=new TypeNote(lValueNote);var lCellule=this._recupererCoordonneesCellule(aId);var lNumLigne=lCellule.numLigne;var lLigne=this.Liste.GetElement(lNumLigne);var lAncienneNote=(aGenreNote===EGenreNoteMoy.moyDeliberee)?lLigne.moyenneDeliberee:(aGenreNote===EGenreNoteMoy.moyProposee)?lLigne.moyenneProposee:new TypeNote('');var lNoteMin=new TypeNote(0.00);var lNoteMax=GParametres.baremeNotation;if(!lNote.estUneNoteValide(lNoteMin,lNoteMax,true,true)){if(!lAncienneNote.estUneNoteValide(lNoteMin,lNoteMax,true,true))
GHtml.setValue(aId,'');else GHtml.setValue(aId,lAncienneNote.getNote());GPosition.setSelect(aId);this._objGestionFocus_apresMessage={id:aId};GApplication.getMessage().afficher({type:EGenreBoiteMessage.Information,message:GChaine.Format(GTraductions.getValeur('Notes.Message.NoteEntre'),[lNoteMin.getNote(),lNoteMax.getNote()]),callback:new Callback(this,this._gestionFocus_apresMessage),avecDecalageFocusBouton:true});}};_ObjetGrilleAffichage.prototype._gestionFocus_apresMessage=function(){GHtml.setFocus(this._objGestionFocus_apresMessage.id);};_ObjetGrilleAffichage.prototype._surModificationNote=function(aId,aGenreNote){if(aId===null||aId===undefined)
aId=this._idCellule;if(aId){this._surVerificationNote(aId,aGenreNote);var lValeur=GHtml.getValue(aId);var lCellule=this._recupererCoordonneesCellule(aId);var lNumLigne=lCellule.numLigne;var lLigne=this.Liste.GetElement(lNumLigne);if(lLigne){var lValeurNote=new TypeNote(lValeur);if(lValeur.charAt(lValeur.length-1)==='*'){lValeurNote=new TypeNote('0,00');var lMasque=new TypeNote(lValeur.substr(0,lValeur.length-1));lValeurNote.setMasque(lMasque);}
var lAncienneNote=(aGenreNote===EGenreNoteMoy.moyDeliberee)?lLigne.moyenneDeliberee:(aGenreNote===EGenreNoteMoy.moyProposee)?lLigne.moyenneProposee:new TypeNote('');if((lValeurNote.getNote()!==lAncienneNote.getNote())){GHtml.setValue(aId,lValeurNote.getNote());this.SetEtatSaisie(true);lLigne.SetEtat(EGenreEtat.Modification);switch(aGenreNote){case EGenreNoteMoy.moyDeliberee:lLigne.moyenneDeliberee=lValeurNote;break;case EGenreNoteMoy.moyProposee:lLigne.moyenneProposee=lValeurNote;break;}}}
this._surBlur(aId);}};_ObjetGrilleAffichage.prototype._surKeyDownNote=function(aEvent){var lInstance=aEvent.data.instance;GNavigateur.SetCodeTouche(aEvent);var lIdNote=lInstance.idCell(lInstance.id_saisieNote,lInstance.NumLigne,lInstance.NumColonne);if(GNavigateur.CodeTouche===27){GHtml.setFocus(lIdNote,false);return false;}
if(GNavigateur.CodeTouche===13){GNavigateur.bloquerValeurEvenement(aEvent);lInstance.passerFocusNoteSuivant(+1);return false;}
if(GNavigateur.CodeTouche===38){lInstance.passerFocusNoteSuivant(-1);return false;}
if(GNavigateur.CodeTouche===40){lInstance.passerFocusNoteSuivant(+1);return false;}};_ObjetGrilleAffichage.prototype.passerFocusNoteSuivant=function(aSensLigne){var lNumLigne=this.NumLigne,lEstLigneEditable;if(this.NumLigne>0){if(lNumLigne<this.Liste.GetNbrElements()){do{lNumLigne=lNumLigne+aSensLigne;var lLigne=this.Liste.GetElement(lNumLigne-1);lEstLigneEditable=(this.NumColonne===EGenreNoteMoy.moyDeliberee)?(!lLigne.moyDelibereeEditable||lLigne.moyDelibereeCloture):((this.NumColonne===EGenreNoteMoy.moyProposee)?(!lLigne.moyProposeeEditable||lLigne.moyProposeeCloture):false) ;} while((lNumLigne>=1)&&(lNumLigne<=this.Liste.GetNbrElements())&&(lEstLigneEditable));}
if((lNumLigne>=1)&&(lNumLigne<=this.Liste.GetNbrElements()))
this._surFocusNote(this.idCell(this.id_saisieNote,lNumLigne,this.NumColonne),this.NumColonne);}};_ObjetGrilleAffichage.prototype._surKeyPressNote=function(aId,aEvent){GNavigateur.SetCaractereTouche(aEvent);if(GNavigateur.estCaractereNote(true,true,false,new TypeNote().getCaractereAnnotation([EGenreAnnotation.absent,EGenreAnnotation.dispense,EGenreAnnotation.nonNote]))){var lChaineAnnotation=new TypeNote().getChaineAnnotationDeCaractere(GNavigateur.CaractereTouche);if(lChaineAnnotation){GHtml.setValue(aId,lChaineAnnotation);GPosition.setSelect(aId);GNavigateur.bloquerValeurEvenement(aEvent);}} else{GNavigateur.bloquerValeurEvenement(aEvent);}};;
MethodesObjet.heritagePrototype(_ObjetBulletinEtReleve,_ObjetGrilleAffichage);function _ObjetBulletinEtReleve(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.idPage=this.Nom+'_Page';this.idPourIdPremierElement=IE.GUID.getId();this.heightPage=0;this.heightPiedDePage=0;this.NbrMaxProfesseurs=10;this.ScrollH=new ObjetScroll(this.Nom+'.ScrollH',null,this,this.GetScrollLeft,EGenreScroll.Horizontal);this.ScrollV=new ObjetScroll(this.Nom+'.ScrollV',null,this,this.GetScrollTop ,EGenreScroll.Vertical);this.ajouterEvenementGlobal(EEvent.SurPreResize ,this.SurPreResize);this.ajouterEvenementGlobal(EEvent.SurPostResize,this.SurPostResize);this._options={labelWAI:''};}
_ObjetBulletinEtReleve.prototype.setOptions_ObjetBulletinEtReleve=function(aOptions){$.extend(this._options,aOptions);};_ObjetBulletinEtReleve.prototype.effacer=function(aMessage){this.inherited('effacer',aMessage);this.donneesRecues=false;};_ObjetBulletinEtReleve.prototype.GetIdTitre=function(){return this.Nom+'_Titre';};_ObjetBulletinEtReleve.prototype.GetIdGeneral=function(){return this.Nom+'_General';};_ObjetBulletinEtReleve.prototype._getListeDonneesLineaire=function(aListeElements){var lService,lSousService,lCmpActifs,lIndiceDernier,lIndiceDernierActif,J,I,lNbr;var lListe=new ObjetListeElements();for(I=0,lNbr=aListeElements.GetNbrElements();I<lNbr ;I++){lService=aListeElements.GetElement(I);lService.estService=true;lService.nbSousServicesTotal=lService.ListeElements.GetNbrElements();lService.regroupement=lService.SurMatiere.GetNumero();lService.avecAppreciationParSousService=lService.AvecAppreciationParSousService;lCmpActifs=0;lIndiceDernier=0;lIndiceDernierActif=0;for(J=0;J<lService.nbSousServicesTotal;J++){if(lService.ListeElements.GetElement(J).Actif){lCmpActifs++;lIndiceDernierActif=J;}
lIndiceDernier=J;}
lService.nbSousServicesActifs=lCmpActifs;lListe.AddElement(lService);for(J=0;J<lService.nbSousServicesTotal;J++){lSousService=lService.ListeElements.GetElement(J);lSousService.estService=false;lSousService.estDernier=(J===lIndiceDernier);lSousService.estDernierActif=(J===lIndiceDernierActif);lSousService.regroupement=lService.regroupement;lSousService.avecAppreciationParSousService=lService.avecAppreciationParSousService;lListe.AddElement(lSousService);}}
return lListe;};_ObjetBulletinEtReleve.prototype.composeImpression=function(){return'';};_ObjetBulletinEtReleve.prototype.composePageBulletin=function(){return'';};_ObjetBulletinEtReleve.prototype.ComposePage=function(aPourImpression,aNumeroImpression){var lPourImpression=(aPourImpression?aPourImpression:false);this.actualiserDimensions(lPourImpression,aNumeroImpression);if(lPourImpression){return this.composeImpression();}
else{return this.composePageBulletin();}};_ObjetBulletinEtReleve.prototype.ConstruireAffichage=function(){if(!this.donneesRecues) return;this.IdPremierElement=this.idPourIdPremierElement;this.NombreLignes=0;this.Pere.surResizeInterface();this.Afficher(this.ComposePage());this.ScrollV.SetDonnees(0);};_ObjetBulletinEtReleve.prototype.setPremierElement=function(){this.IdPremierElement=this.idPourIdPremierElement;};_ObjetBulletinEtReleve.prototype.SetDonnees_General=function(aGeneral){this.General=aGeneral;};_ObjetBulletinEtReleve.prototype.composeTitre=function(aParam){var lParam={libelle:'',title:'',taille:null,bordGauche:false,bordBas:false,nbrCol:1,nbrLignes:1,visible:true,pourImpression:false,role:null,id:null};$.extend(lParam,aParam);return lParam.visible?'<td '+(lParam.role?GObjetWAI.composeRole(lParam.role)+' ':'')+
this.ComposeClassEtStyleTitre(lParam.bordGauche,lParam.bordBas,lParam.pourImpression)+' width="'+(lParam.taille?lParam.taille+'px':'auto')+'" rowspan="'+lParam.nbrLignes+'" colspan="'+lParam.nbrCol+'">'+'<div '+(lParam.id?' id="'+lParam.id+'"':'')+'tabIndex="-1" style="width:'+lParam.taille+'px; overflow:hidden" title="'+lParam.title+'">'+lParam.libelle+'</div>'+'</td>':'';};_ObjetBulletinEtReleve.prototype.composeService=function(aParam){var lDefault={service:null,avecAlignementGauche:true,largeur:0,bordGauche:true,bordBas:true,bordRegroupement:false,id:'',actif:false,pourImpression:false,role:null};var lParam=$.extend({},lDefault,aParam);var lAlignement=lParam.avecAlignementGauche?'AlignementGauche':'AlignementDroit';lParam.largeur=lParam.largeur-(lParam.bordRegroupement?5:0)-6;var N=lParam.service&&lParam.service.ListeProfesseurs?lParam.service.ListeProfesseurs.GetNbrElements():0;var lEstChaineTropLongue=false;var lListeProfesseurs=[],lLibelle;for(var I=0;I<N;I++){lLibelle=lParam.service.ListeProfesseurs.GetLibelle(I);if(GChaine.EstChaineTropLongue(lLibelle,10,false,lParam.largeur))
lEstChaineTropLongue=true;lListeProfesseurs.push(lLibelle);}
var lTitle=(N>this.NbrMaxProfesseurs)||lEstChaineTropLongue?' title="'+lListeProfesseurs.join('\n')+'"':'';var H=[];H.push('<td ',lParam.role?GObjetWAI.composeRole(lParam.role):'',' id="'+lParam.id+'" '+this.ComposeClassEtStyleService(lParam.bordGauche,lParam.bordBas,lParam.bordRegroupement,lParam.pourImpression)+lTitle+'>');H.push('<div style="width:'+lParam.largeur+'px; height: ',(this.HauteurService-6-1),'px">');if(lParam.service){var lStyleInactif=lParam.actif?'style="'+GStyle.composeCouleurTexte(GCouleur.liste.colonneFixe.getTexte(lParam.pourImpression))+'"':'style="color:#CCCCCC;"';H.push('<table class="'+this.taillePolice+'" width="100%" '+lStyleInactif+'border="0" cellpadding="0" cellspacing="0">');lLibelle=lParam.service.Matiere.GetLibelle()===''?'&nbsp;':GChaine.GetChaine(lParam.service.Matiere.GetLibelle(),this.TailleTexte,true,lParam.largeur);H.push('<tr><td class="'+lAlignement+'">'+lLibelle+'</td></tr>');if(lParam.service.AvecLibelleEnseignantMatiereSurMemeLigne){var lLibelles=lParam.service.ListeProfesseurs.getTableauLibelles().join(', ');H.push('<tr><td class="'+lAlignement+'" title="'+lLibelles+'">'+GChaine.toTexte(GChaine.GetChaine(lLibelles,this.TailleTexte,false,lParam.largeur))+'</td></tr>');} else{for(I=0;I<Math.min(N,this.NbrMaxProfesseurs);I++){var lProfesseur=lParam.service.ListeProfesseurs.GetElement(I);H.push('<tr><td class="'+lAlignement+'">'+GChaine.toTexte(GChaine.GetChaine(lProfesseur.GetLibelle(),this.TailleTexte,false,lParam.largeur))+'</td></tr>');}}
H.push('</table>');} else H.push('&nbsp;');H.push('</div>');H.push('</td>');return H.join('');};_ObjetBulletinEtReleve.prototype.composeAppreciation=function(aParam){var lDefault={pourImpression:false,saisie:null,libelle:'',largeur:0,rowspan:1,ligne:0,col:0,hauteurLigne:null,hauteurFixeNonEditable:false};var lParam=$.extend({},lDefault,aParam);var lAppreciation=aParam.appreciation?aParam.appreciation:this.Liste.GetElement(lParam.ligne-1).ListeAppreciations.GetElement(lParam.col-1);var lModeSaisie=(lParam.saisie?this.determinerModeSaisiePourCellule(lAppreciation):null);var lCurseur=(lParam.saisie?this.determinerCurseurPourCellule(lAppreciation,lParam.pourImpression):'');var lLabelWAI=this._options.labelWAI?{genre:EGenreAttribut.label,valeur:this._options.labelWAI}:null;var H=[];if(lParam.rowspan>0){var lClass=lCurseur+' '+this.taillePolice;var lStyle=GTableau.styleCellule(lParam.pourImpression,true,EGenreBordure.gauche+EGenreBordure.bas,false)+' vertical-align : top; ';if(lParam.saisie)
H.push(this.composeCelluleAppreciation(lParam.pourImpression,lParam.largeur-4,lParam.libelle,lParam.ligne,lParam.col,this.id_appreciation,lClass,lStyle,lModeSaisie,lParam.libelle,lParam.rowspan,lParam.hauteurLigne,lParam.hauteurFixeNonEditable,lLabelWAI));else H.push(this.composeCelluleStd(lParam.pourImpression,lParam.largeur-4,lParam.libelle,lParam.ligne,this.id_appreciation,lClass,lStyle,lParam.libelle,lParam.rowspan,lParam.hauteurLigne,null,null,lLabelWAI));}
return H.join('');};_ObjetBulletinEtReleve.prototype.composeECTS=function(aParam){var H=[];var lDefault={pourImpression:false,saisie:null,libelle:'',largeur:0,rowspan:1,ligne:0,styleClass:''};var lParam=$.extend({},lDefault,aParam);var lClass=(lParam.styleClass?' '+lParam.styleClass+' ':' ')+this.taillePolice;var lStyle=GTableau.styleCellule(lParam.pourImpression,true,EGenreBordure.gauche+EGenreBordure.bas,false)+' vertical-align : top; ';if(lParam.saisie)
H.push(this.composeCelluleECTS(lParam.pourImpression,lParam.largeur-4,lParam.libelle,lParam.ligne,this.id_ECTS,lClass,lStyle));else H.push(this.composeCelluleStd(lParam.pourImpression,lParam.largeur-4,lParam.libelle,lParam.ligne,this.id_ECTS,lClass,lStyle,lParam.libelle,lParam.rowspan,lParam.hauteurLigne));return H.join('');};_ObjetBulletinEtReleve.prototype.composeRegroupement=function(aParam){var lDefault={surMatiere:null,service:null,numeroZone:0,pourImpression:false,nePasCompleter:false};var lParam=$.extend({},lDefault,aParam);var H=[];var lServicePourRegroupement=lParam.service.estService?lParam.service:lParam.service.pere;if(lServicePourRegroupement.SurMatiere.existeNumero()&&lServicePourRegroupement.estDebutRegroupement){H.push('<tr>');if(lParam.numeroZone===0)
H.push('<td '+this.ComposeClassEtStyleRegroupement(lParam.numeroZone,false,lParam.pourImpression)+' height="'+this.HauteurTitre+'px">'+lServicePourRegroupement.SurMatiere.GetLibelle()+'</td>');if(lParam.surMatiere){if(this.Affichage.AvecVolumeHoraire) H.push('<td '+this.ComposeClassEtStyleRegroupement(lParam.numeroZone,true,lParam.pourImpression)+'>&nbsp;</td>');if(this.Affichage.AvecCoefficient) H.push('<td '+this.ComposeClassEtStyleRegroupement(lParam.numeroZone,true,lParam.pourImpression)+'>',GChaine.AvecEspaceSiVide(lParam.surMatiere.Coefficient.getNote()),'</td>');if(this.Affichage.avecECTS) H.push('<td '+this.ComposeClassEtStyleRegroupement(lParam.numeroZone,true,lParam.pourImpression)+'>',GChaine.AvecEspaceSiVide(lParam.surMatiere.ECTS),'</td>');if(this.Affichage.AvecNombreDevoirs) H.push('<td '+this.ComposeClassEtStyleRegroupement(lParam.numeroZone,true,lParam.pourImpression)+'>',GChaine.AvecEspaceSiVide(lParam.surMatiere.NombreDevoirs),'</td>');if(this.Affichage.AvecClassementEleve) H.push('<td '+this.ComposeClassEtStyleRegroupement(lParam.numeroZone,true,lParam.pourImpression)+'>&nbsp;</td>');if(this.Affichage.AvecEvolution) H.push('<td '+this.ComposeClassEtStyleRegroupement(lParam.numeroZone,true,lParam.pourImpression)+'>&nbsp;</td>');if(this.Affichage.AvecMoyenneAnnuelle) H.push('<td '+this.ComposeClassEtStyleRegroupement(lParam.numeroZone,true,lParam.pourImpression)+'>',GChaine.AvecEspaceSiVide(lParam.surMatiere.MoyenneAnnuelle.getNote()),'</td>');for(var I=0;I<this.Affichage.NombreMoyennesPeriodes;I++)
H.push('<td '+this.ComposeClassEtStyleRegroupement(lParam.numeroZone,true,lParam.pourImpression)+'">',GChaine.AvecEspaceSiVide(lParam.surMatiere.ListeMoyennesPeriodes[I].getNote()),'</td>');if(this.Affichage.AvecNombrePointsEleve) H.push('<td '+this.ComposeClassEtStyleRegroupement(lParam.numeroZone,true,lParam.pourImpression)+'>',GChaine.AvecEspaceSiVide(lParam.surMatiere.NombrePointsEleve.getNote()),'</td>');if(this.Affichage.AvecMoyenneEleve) H.push('<td '+this.ComposeClassEtStyleRegroupement(lParam.numeroZone,true,lParam.pourImpression)+'>',GChaine.AvecEspaceSiVide(lParam.surMatiere.MoyenneEleve.getNote()),'</td>');if(this.Affichage.AvecMoyenneClasse) H.push('<td '+this.ComposeClassEtStyleRegroupement(lParam.numeroZone,true,lParam.pourImpression)+'>',GChaine.AvecEspaceSiVide(lParam.surMatiere.MoyenneClasse.getNote()),'</td>');if(this.Affichage.AvecMoyenneInfSup) H.push('<td '+this.ComposeClassEtStyleRegroupement(lParam.numeroZone,true,lParam.pourImpression)+'>',GChaine.AvecEspaceSiVide(lParam.surMatiere.MoyenneInf.getNote()),'</td>');if(this.Affichage.AvecMoyenneInfSup) H.push('<td '+this.ComposeClassEtStyleRegroupement(lParam.numeroZone,true,lParam.pourImpression)+'>',GChaine.AvecEspaceSiVide(lParam.surMatiere.MoyenneSup.getNote()),'</td>');}
if(!lParam.nePasCompleter)
H.push('<td '+this.ComposeClassEtStyleRegroupement(lParam.numeroZone,true,lParam.pourImpression)+' height="'+this.HauteurTitre+'px" colspan="50">&nbsp;</td>');H.push('</tr>');}
return H.join('');};_ObjetBulletinEtReleve.prototype.composeNote=function(aParam){var lDefault={note:null,largeur:0,visible:true,avecGras:true,estMoyenneGenerale:false,pourImpression:false};var lParam=$.extend({},lDefault,aParam);return lParam.visible?'<td '+this.ComposeClassEtStyleNote(lParam.avecGras,lParam.estMoyenneGenerale,lParam.pourImpression)+' width="'+(lParam.largeur-6)+'px">'+'<div style="'+GStyle.composeWidth(lParam.largeur-6)+'">'+GChaine.AvecEspaceSiVide((lParam.note!==null)&&(lParam.note!==false)?lParam.note.getNote?lParam.note.getNote():lParam.note+'':'')+'</div>'+'</td>':'';};_ObjetBulletinEtReleve.prototype.composeNoteEdit=function(aParam){var H=[];if(aParam.visible){if(aParam.saisie){$.extend(aParam,{style:GTableau.styleCellule(aParam.pourImpression,true,EGenreBordure.gauche+EGenreBordure.bas,false)+' vertical-align : top; '});H.push(this.composeCelluleNote(aParam));}
else H.push(this.composeNote(aParam));}
return H.join('');};_ObjetBulletinEtReleve.prototype.ComposeStyleBord=function(aCouleurGauche,aCouleurBas,aTailleGauche){aTailleGauche=aTailleGauche===null||aTailleGauche===undefined?1:aTailleGauche;return GStyle.composeCouleurBordure(aCouleurGauche,aTailleGauche,EGenreBordure.gauche)+' '+GStyle.composeCouleurBordure(aCouleurBas,1,EGenreBordure.bas)+' ';};_ObjetBulletinEtReleve.prototype.ComposeStyleTexte=function(aCouleurFond,aCouleurTexte){return GStyle.composeCouleur(aCouleurFond,aCouleurTexte);};_ObjetBulletinEtReleve.prototype.composeSeparateur=function(aPourImpression){return'<div class="PetitEspaceHaut PetitEspaceBas" style="height: 5px;"><div style="margin-left: 50px; width: 300px; '+GStyle.composeCouleurBordure(aPourImpression?GCouleur.noir:GCouleur.liste.titre.bordure,1,EGenreBordure.haut)+'">'+'</div></div>';};_ObjetBulletinEtReleve.prototype.ComposeClassEtStyleTitre=function(aBordGauche,aBordBas,aPourImpression){var lCouleurBordGauche=aPourImpression?GCouleur.noir:GCouleur.liste.titre.bordure;var lCouleurBordBas=aPourImpression?GCouleur.noir:GCouleur.liste.titre.bordure;var lCouleurFond=aPourImpression?GCouleur.blanc:GCouleur.liste.titre.fond;var lCouleurTexte=aPourImpression?GCouleur.noir:GCouleur.liste.titre.texte;return'class="'+this.taillePolice+' AlignementMilieu Titre" style="'+this.ComposeStyleBord(lCouleurBordGauche,lCouleurBordBas)+' '+this.ComposeStyleTexte(lCouleurFond,lCouleurTexte)+'" ';};_ObjetBulletinEtReleve.prototype.ComposeClassEtStyleService=function(aBordGauche,aBordBas,aBordRegroupement,aPourImpression){var lCouleurBordGauche=!aBordRegroupement?!aBordGauche?'red':GCouleur.liste.colonneFixe.getBordure(aPourImpression):(aPourImpression?GCouleur.noir:GCouleur.liste.total.getFond(aPourImpression));var lCouleurBordBas=aBordBas?GCouleur.liste.colonneFixe.getBordure(aPourImpression):GCouleur.liste.colonneFixe.getFond(aPourImpression);return'class="'+this.taillePolice+' PetitEspace AlignementHaut" style="'+GStyle.composeCouleur(GCouleur.liste.colonneFixe.getFond(aPourImpression),GCouleur.liste.colonneFixe.getTexte(aPourImpression))+' '+this.ComposeStyleBord(lCouleurBordGauche,lCouleurBordBas,aBordRegroupement?5:1)+'" ';};_ObjetBulletinEtReleve.prototype.ComposeClassEtStyleDevoir=function(aPourImpression){return'style="'+GTableau.styleCellule(aPourImpression,true,EGenreBordure.gauche+EGenreBordure.bas,false)+'" ';};_ObjetBulletinEtReleve.prototype.ComposeClassEtStyleAppreciation=function(aPourImpression){return'class="'+this.taillePolice+' PetitEspace AlignementHaut AlignementGauche" style="'+GTableau.styleCellule(aPourImpression,true,EGenreBordure.gauche+EGenreBordure.bas,false)+'" ';};_ObjetBulletinEtReleve.prototype.ComposeClassEtStyleRegroupement=function(aNumeroZone,aEstUneNote,aPourImpression){var lCouleurBordGauche=aPourImpression?GCouleur.noir:GCouleur.liste.total.getFond(aPourImpression);var lCouleurBordBas=GCouleur.liste.total.getBordure(aPourImpression);var lCouleurFond=GCouleur.liste.total.getFond(aPourImpression);var lCouleurTexte=GCouleur.liste.total.getTexte(aPourImpression);var lLargeurBord=(aNumeroZone===0)&&!aEstUneNote?5:1;return'class="'+this.taillePolice+' Gras '+(aEstUneNote?'AlignementDroit':'AlignementGauche')+'" style="line-height: '+(this.HauteurTitre-3-3-1)+'px; padding: 3px; '+GStyle.composeCouleurBordure(lCouleurBordBas,1,EGenreBordure.bas)+' '+GStyle.composeCouleurBordure(lCouleurBordGauche,lLargeurBord,EGenreBordure.gauche)+' '+GStyle.composeCouleur(lCouleurFond,lCouleurTexte)+'"';};_ObjetBulletinEtReleve.prototype.ComposeClassEtStyleNote=function(aAvecGras,aEstMoyenneGenerale,aPourImpression){return'class="'+this.taillePolice+' PetitEspace AlignementHaut AlignementDroit'+(aAvecGras&&!aPourImpression?' Gras':'')+'" style="'+GTableau.styleMoyenne(aPourImpression,true,EGenreBordure.gauche+EGenreBordure.bas,aEstMoyenneGenerale)+'" ';};_ObjetBulletinEtReleve.prototype.SurPreResize=function(){if(!this.donneesRecues) return;if(this.ScrollV) this.ScrollV.Vider();if(this.ScrollH) this.ScrollH.Vider();this.Afficher('&nbsp;');};_ObjetBulletinEtReleve.prototype.SurPostResize=function(){if(!this.donneesRecues) return;this.actualiser();};_ObjetBulletinEtReleve.prototype.actualiser=function(){if(GEtatUtilisateur.estModeAccessible()){var lArbrePrincipal=this.AfficherListe();GHtml.setHtml(this.Nom,this._objetListeArborescente.ConstruireAffichage(this.heightPage-15));this._objetListeArborescente.SetDonnees(lArbrePrincipal,arguments);} else this.Afficher();};_ObjetBulletinEtReleve.prototype.GetIdLigne=function(I){return this.Nom+'_Ligne_'+I;};_ObjetBulletinEtReleve.prototype.GetTopLigne=function(I){return(I===this.NombreLignes?GPosition.getTop(this.GetIdLigne(I-1))+GPosition.getHeight(this.GetIdLigne(I-1)):GPosition.getTop(this.GetIdLigne(I)))-GPosition.getTop(this.ScrollV.GetIdZone());};_ObjetBulletinEtReleve.prototype.GetScrollTop=function(aGenre,aScrollTop){if(aGenre===EGenreScrollEvenement.TailleZone){aScrollTop=this.heightPage-this.heightPiedDePage-$('#'+this.idPage.escapeJQ()).height()-15 ;}
var I;switch(aGenre){case EGenreScrollEvenement.Deplacement:{var lResult=0;for(I=0;(I<this.NombreLignes);I++){if((aScrollTop<=lResult))
break;else lResult+=this.GetTopLigne(I+1)-this.GetTopLigne(I);}
return lResult;}
case EGenreScrollEvenement.TailleZone:for(I=0;(I<=this.NombreLignes)&&(aScrollTop>this.GetTopLigne(I));I++){$.noop();}
return(I<4)?0:this.GetTopLigne(I-1);case EGenreScrollEvenement.TailleContenu:return null;}};_ObjetBulletinEtReleve.prototype.actualiserDimensions=function(aPourImpression,aNumeroImpression){if(aPourImpression){this.TailleTexte=[14,12,10,8][aNumeroImpression];this.LargeurService=[275,225,175,125][aNumeroImpression];this.LargeurSousService=[225,175,125,75][aNumeroImpression];this.LargeurNote=[60,50,40,30][aNumeroImpression];this.HauteurTitre=[28,24,20,16][aNumeroImpression];this.HauteurService=[95,75,55,35][aNumeroImpression];}
else{this.TailleTexte=10;this.LargeurService=175;this.LargeurSousService=125;this.LargeurNote=45;this.HauteurTitre=20;this.HauteurService=35;}
this.taillePolice='Texte'+this.TailleTexte;};_ObjetBulletinEtReleve.prototype.ComposeImpression=function(aFormat){if(GEtatUtilisateur.estModeAccessible()) return this._objetListeArborescente.GetListeArborescente().outerHTML;else return this.ComposePage(true,aFormat);};_ObjetBulletinEtReleve.prototype.selectionnerLigne=function(){if(this.Affichage&&this.Affichage.avecECTS){if((this.GenreCellule!==EGenreCelluleEditable.ECTS)||(0!==this.NumColonne)||!this.Ligne.ECTSEditable||this.Ligne.Cloture){if(this.Saisie){GCouleur.setCouleurSelection(this.idCell(this.id_ECTS,this.NumLigne));GCouleur.setCouleurSelection(this.idCell(this.id_divECTS,this.NumLigne));GCouleur.setCouleurSelection(this.idCell(this.id_saisieECTS,this.NumLigne));}}
else GStyle.setCouleurTexte(this.idCell(this.id_saisieECTS,this.NumLigne),GCouleur.selection.fond);}
if(this.Affichage&&this.Affichage.AvecMoyenneProposee){if((this.GenreCellule===EGenreCelluleEditable.Note)&&(this.NumColonne===EGenreNoteMoy.moyProposee)&&this.Ligne.moyProposeeEditable&&!this.Ligne.moyProposeeCloture){GStyle.setCouleurTexte(this.idCell(this.id_saisieNote,this.NumLigne,this.NumColonne),GCouleur.selection.fond);}
else{GCouleur.setCouleurSelection(this.idCell(this.id_Note,this.NumLigne,EGenreNoteMoy.moyProposee));GCouleur.setCouleurSelection(this.idCell(this.id_divNote,this.NumLigne,EGenreNoteMoy.moyProposee));GCouleur.setCouleurSelection(this.idCell(this.id_saisieNote,this.NumLigne,EGenreNoteMoy.moyProposee));}}
if(this.Affichage&&this.Affichage.AvecMoyenneDeliberee){if((this.GenreCellule===EGenreCelluleEditable.Note)&&(this.NumColonne===EGenreNoteMoy.moyDeliberee)&&this.Ligne.moyDelibereeEditable&&!this.Ligne.moyDelibereeCloture){GStyle.setCouleurTexte(this.idCell(this.id_saisieNote,this.NumLigne,this.NumColonne),GCouleur.selection.fond);}
else{GCouleur.setCouleurSelection(this.idCell(this.id_Note,this.NumLigne,EGenreNoteMoy.moyDeliberee));GCouleur.setCouleurSelection(this.idCell(this.id_divNote,this.NumLigne,EGenreNoteMoy.moyDeliberee));GCouleur.setCouleurSelection(this.idCell(this.id_saisieNote,this.NumLigne,EGenreNoteMoy.moyDeliberee));}}
for(var J=1;J<=this.NombreColonnes;J++){var lIdSaisie=this.idCell(this.id_saisie,this.NumLigne,J);var lIdAppr=this.idCell(this.id_appreciation,this.NumLigne,J);if((this.GenreCellule===EGenreCelluleEditable.appreciation)&&(J===this.NumColonne)&&this.Ligne.Editable){var lModeSaisie=this.getModeSaisie(this.NumLigne,J);if(lModeSaisie!==EGenreModeSaisie.edition){GStyle.setCouleurTexte(lIdSaisie,GCouleur.liste.nonEditable.getTexte(false));GStyle.setCouleurFond(lIdAppr,GCouleur.liste.nonEditable.getFond(false));GStyle.setCouleurFond(lIdSaisie,GCouleur.liste.nonEditable.getFond(false));}
else GStyle.setCouleurTexte(lIdSaisie,GCouleur.selection.fond);GHtml.setFocus(lIdSaisie);}
else{GCouleur.setCouleurSelection(lIdAppr);GCouleur.setCouleurSelection(this.idCell(this.id_divSaisie,this.NumLigne,J));GCouleur.setCouleurSelection(lIdSaisie);}}};_ObjetBulletinEtReleve.prototype.deselectionnerLigne=function(ANumLigne){ANumLigne=(ANumLigne===null||ANumLigne===undefined)?this.NumLigne:ANumLigne;var LLigne=this.Liste.GetElement(ANumLigne-1);if(ANumLigne>0){var LCouleurAppreciationFond,LCouleurAppreciationTexte;if(LLigne.Titre){LCouleurAppreciationFond=GCouleur.liste.cumul[1].getFond();LCouleurAppreciationTexte=GCouleur.liste.cumul[1].getTexte();} else{var lCouleurAppreciation=LLigne.Editable?GCouleur.liste.editable:GCouleur.liste.nonEditable;LCouleurAppreciationFond=lCouleurAppreciation.getFond();LCouleurAppreciationTexte=lCouleurAppreciation.getTexte();}
if(this.Affichage&&this.Affichage.avecECTS){if((0!==this.NumColonne)||!this.Ligne.ECTSEditable){GStyle.setCouleur(this.idCell(this.id_ECTS,ANumLigne),LCouleurAppreciationFond,LCouleurAppreciationTexte);GStyle.setCouleur(this.idCell(this.id_divECTS,ANumLigne),LCouleurAppreciationFond,LCouleurAppreciationTexte);GStyle.setCouleur(this.idCell(this.id_saisieECTS,ANumLigne),LCouleurAppreciationFond,LCouleurAppreciationTexte);}
else{GStyle.setCouleurTexte(this.idCell(this.id_saisieECTS,ANumLigne),'black');GStyle.setCouleurFond(this.idCell(this.id_ECTS,ANumLigne),'white');GStyle.setCouleurFond(this.idCell(this.id_saisieECTS,ANumLigne),'white');}}
if(this.Affichage&&this.Affichage.AvecMoyenneProposee){if((EGenreNoteMoy.moyProposee!==this.NumColonne)||!this.Ligne.moyProposeeEditable){GStyle.setCouleur(this.idCell(this.id_Note,ANumLigne,EGenreNoteMoy.moyProposee),LCouleurAppreciationFond,LCouleurAppreciationTexte);GStyle.setCouleur(this.idCell(this.id_divNote,ANumLigne,EGenreNoteMoy.moyProposee),LCouleurAppreciationFond,LCouleurAppreciationTexte);GStyle.setCouleur(this.idCell(this.id_saisieNote,ANumLigne,EGenreNoteMoy.moyProposee),LCouleurAppreciationFond,LCouleurAppreciationTexte);}
else{GStyle.setCouleurTexte(this.idCell(this.id_saisieNote,ANumLigne,EGenreNoteMoy.moyProposee),'black');GStyle.setCouleurFond(this.idCell(this.id_Note,ANumLigne,EGenreNoteMoy.moyProposee),'white');GStyle.setCouleurFond(this.idCell(this.id_saisieNote,ANumLigne,EGenreNoteMoy.moyProposee),'white');}}
if(this.Affichage&&this.Affichage.AvecMoyenneDeliberee){if((EGenreNoteMoy.moyDeliberee!==this.NumColonne)||!this.Ligne.moyDelibereeEditable){GStyle.setCouleur(this.idCell(this.id_Note,ANumLigne,EGenreNoteMoy.moyDeliberee),LCouleurAppreciationFond,LCouleurAppreciationTexte);GStyle.setCouleur(this.idCell(this.id_divNote,ANumLigne,EGenreNoteMoy.moyDeliberee),LCouleurAppreciationFond,LCouleurAppreciationTexte);GStyle.setCouleur(this.idCell(this.id_saisieNote,ANumLigne,EGenreNoteMoy.moyDeliberee),LCouleurAppreciationFond,LCouleurAppreciationTexte);}
else{GStyle.setCouleurTexte(this.idCell(this.id_saisieNote,ANumLigne,EGenreNoteMoy.moyDeliberee),'black');GStyle.setCouleurFond(this.idCell(this.id_Note,ANumLigne,EGenreNoteMoy.moyDeliberee),'white');GStyle.setCouleurFond(this.idCell(this.id_saisieNote,ANumLigne,EGenreNoteMoy.moyDeliberee),'white');}}
for(var J=1;J<=this.NombreColonnes;J++){var lIdSaisie=this.idCell(this.id_saisie,ANumLigne,J);var lIdAppr=this.idCell(this.id_appreciation,ANumLigne,J);if((J!==this.NumColonne)||!LLigne.Editable){GStyle.setCouleur(lIdAppr,LCouleurAppreciationFond,LCouleurAppreciationTexte);GStyle.setCouleur(this.idCell(this.id_divSaisie,ANumLigne,J),LCouleurAppreciationFond,LCouleurAppreciationTexte);GStyle.setCouleur(lIdSaisie,LCouleurAppreciationFond,LCouleurAppreciationTexte);}
else{GStyle.setCouleurTexte(lIdSaisie,'black');GStyle.setCouleurFond(lIdAppr,'white');GStyle.setCouleurFond(lIdSaisie,'white');}}}};_ObjetBulletinEtReleve.prototype.getModeSaisie=function(ANumLigne,ANumColonne){var LAppreciation=this.Liste.GetElement(ANumLigne-1).ListeAppreciations.GetElement(ANumColonne-1);return this.determinerModeSaisiePourCellule(LAppreciation);};;
var EGenreEvolution={Progres:1,Regularite:2,Regression:3};;
_ObjetBulletinEtReleve.prototype.AfficherListe=function(){this._objetListeArborescente=new ObjetListeArborescente(this.Nom+'_Liste',0,this,null);var lRacine=this._objetListeArborescente.construireRacine();this._objetListeArborescente.setParametres(false);var lNoeudMatieres=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lRacine,this.Nom+'_Matieres',GTraductions.getValeur('BulletinEtReleve.Matieres'),null,true,true);var lNoeudRegroupement;for(var I=0;I<this.Liste.GetNbrElements();I++){var lService=this.Liste.GetElement(I);if(lService.estService||lService.estPremierActif)
if(lService.regroupement&&(lService.estDebutRegroupement)){var lLibelleRegroupement=lService.SurMatiere.GetLibelle();lNoeudRegroupement=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lNoeudMatieres,'',lLibelleRegroupement);}
var lNoeudPere=lService.regroupement?lNoeudRegroupement:lNoeudMatieres;this._construireListeArborescente_Service(lService,lNoeudPere);}
this._ajouterMoyenneGenerale(lRacine);return lRacine;};_ObjetBulletinEtReleve.prototype._ajouterMoyennes=function(aService,aNoeud){if((this.Affichage.AvecMoyenneEleve)||(this.Affichage.AvecMoyenneClasse)||(this.Affichage.AvecMoyenneInfSup)||this.Affichage.AvecNombrePointsEntre||this.Affichage.AvecMoyenneDeliberee||this.Affichage.AvecMoyenneProposee){var lNoeudMoyennes=this._objetListeArborescente.ajouterUnNoeudAuNoeud(aNoeud,'',GTraductions.getValeur('BulletinEtReleve.Moyennes'),'');if(this.Affichage.AvecMoyenneDeliberee)
this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudMoyennes,'' ,GTraductions.getValeur('BulletinEtReleve.MoyDeliberee')+' : '+(aService.moyenneDeliberee?aService.moyenneDeliberee:''));if(this.Affichage.AvecMoyenneProposee)
this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudMoyennes,'' ,GTraductions.getValeur('BulletinEtReleve.MoyProposee')+' : '+(aService.moyenneProposee?aService.moyenneProposee:''));if(this.Affichage.AvecMoyenneEleve)
this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudMoyennes,'' ,GTraductions.getValeur('BulletinEtReleve.Eleve')+' : '+(aService.MoyenneEleve?aService.MoyenneEleve:''));if(this.Affichage.AvecMoyenneClasse)
this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudMoyennes,'' ,GTraductions.getValeur('BulletinEtReleve.Classe')+' : '+(aService.MoyenneClasse?aService.MoyenneClasse:''));if(this.Affichage.AvecMoyenneInfSup){this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudMoyennes,'' ,'- : '+(aService.MoyenneInf?aService.MoyenneInf:''));this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudMoyennes,'' ,'+ : '+(aService.MoyenneSup?aService.MoyenneSup:''));}
if(this.Affichage.AvecNombrePointsEntre){this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudMoyennes,'' ,'< 8 : '+(aService.NombreNotesEntre?aService.NombreNotesEntre[0]:''));this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudMoyennes,'' ,'8 - 12 : '+(aService.NombreNotesEntre?aService.NombreNotesEntre[1]:''));this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudMoyennes,'' ,'> 12 : '+(aService.NombreNotesEntre?aService.NombreNotesEntre[2]:''));}}};_ObjetBulletinEtReleve.prototype._ajouterAppreciations=function(aService,aNoeud){if(this.Affichage.NombreAppreciations>0){var lNoeudAppreciations=this._objetListeArborescente.ajouterUnNoeudAuNoeud(aNoeud,'',GTraductions.getValeur('BulletinEtReleve.Appreciations'),'');for(var J=0;J<this.Affichage.NombreAppreciations;J++){this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudAppreciations,'',this.Affichage.ListeIntitulesAppreciations.GetLibelle(J)+' : '+GChaine.AvecEspaceSiVide(aService.ListeAppreciations.GetLibelle(J)));}}};_ObjetBulletinEtReleve.prototype._ajouterDetails=function(aService,aNoeud){if((this.Affichage.AvecVolumeHoraire)||(this.Affichage.AvecCoefficient)||(this.Affichage.AvecNombreDevoirs)||(this.Affichage.AvecClassementEleve)||(this.Affichage.AvecEvolution)||(this.Affichage.AvecMoyenneAnnuelle)||(this.Affichage.AvecNombrePointsEleve)){var lNoeudDetail=this._objetListeArborescente.ajouterUnNoeudAuNoeud(aNoeud,'',GTraductions.getValeur('BulletinEtReleve.Detail'),'');if(this.Affichage.AvecDureeDesAbsences)
this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudDetail,'' ,GTraductions.getValeur('BulletinEtReleve.DureeDesAbsences')+' : '+(aService.DureeDesAbsences?aService.DureeDesAbsences:''));if(this.Affichage.AvecVolumeHoraire)
this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudDetail,'' ,GTraductions.getValeur('BulletinEtReleve.VolH')+' : '+(aService.VolumeHoraire?aService.VolumeHoraire:''));if(this.Affichage.AvecCoefficient)
this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudDetail,'' ,GTraductions.getValeur('BulletinEtReleve.Coeff')+' : '+(aService.Coefficient?aService.Coefficient:''));if(this.Affichage.avecECTS)
this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudDetail,'' ,GTraductions.getValeur('BulletinEtReleve.ECTS')+' : '+(aService.ECTS?aService.ECTS:''));if(this.Affichage.AvecNombreDevoirs)
this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudDetail,'' ,GTraductions.getValeur('BulletinEtReleve.NbrNotes')+' : '+(aService.NombreDevoirs?aService.NombreDevoirs:''));if(this.Affichage.AvecClassementEleve)
this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudDetail,'' ,GTraductions.getValeur('BulletinEtReleve.Rang')+' : '+(aService.ClassementEleve>0?aService.ClassementEleve:''));if(this.Affichage.AvecEvolution){var LLibelleEvolution=(aService.Evolution.GetGenre()===EGenreEvolution.Progres?GTraductions.getValeur('BulletinEtReleve.Progres'):(aService.Evolution.GetGenre()===EGenreEvolution.Regularite?GTraductions.getValeur('BulletinEtReleve.Regulier'):(aService.Evolution.GetGenre()===EGenreEvolution.Regression?GTraductions.getValeur('BulletinEtReleve.Regression'):'')));this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudDetail,'' ,GTraductions.getValeur('BulletinEtReleve.Evol')+' : '+(aService.Evolution.GetGenre()?LLibelleEvolution:''));}
if(this.Affichage.AvecMoyenneAnnuelle)
this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudDetail,'' ,GTraductions.getValeur('BulletinEtReleve.MoyAnnee')+' : '+(aService.MoyenneAnnuelle?aService.MoyenneAnnuelle:''));for(var I=0;I<this.Affichage.NombreMoyennesPeriodes;I++)
this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudDetail,'' ,this.Affichage.listePeriodes.GetLibelle(I)+' : '+(aService.ListeMoyennesPeriodes[I]?aService.ListeMoyennesPeriodes[I]:''));if(this.Affichage.AvecNombrePointsEleve)
this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudDetail,'' ,GTraductions.getValeur('BulletinEtReleve.Pts')+' : '+(aService.NombrePointsEleve?aService.NombrePointsEleve:''));}};_ObjetBulletinEtReleve.prototype._construireListeArborescente_Service=function(aService,aNoeud){var lLibelle=this._getLibelleService(aService);var lNoeudMatiere=this._objetListeArborescente.ajouterUnNoeudAuNoeud(aNoeud,'',lLibelle);this._ajouterMoyennes(aService,lNoeudMatiere);this._ajouterAppreciations(aService,lNoeudMatiere);this._ajouterDetails(aService,lNoeudMatiere);};_ObjetBulletinEtReleve.prototype._ajouterMoyenneGenerale=function(aNoeud){if(this.Affichage.AvecMoyenneGenerale){var lNoeudMoyGenerale=this._objetListeArborescente.ajouterUnNoeudAuNoeud(aNoeud,this.Nom+'_MoyGenerale',GTraductions.getValeur('BulletinEtReleve.MoyGen'),null,false);if(this.Affichage.AvecClassementEleve)
this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudMoyGenerale,'' ,GTraductions.getValeur('BulletinEtReleve.RangEleve')+' : '+(this.General.ClassementEleve>0?this.General.ClassementEleve:''));if(this.Affichage.AvecEvolution){var lLibelleEvolution=(this.General.Evolution.GetGenre()===EGenreEvolution.Progres?GTraductions.getValeur('BulletinEtReleve.Progres'):(this.General.Evolution.GetGenre()===EGenreEvolution.Regularite?GTraductions.getValeur('BulletinEtReleve.Regulier'):(this.General.Evolution.GetGenre()===EGenreEvolution.Regression?GTraductions.getValeur('BulletinEtReleve.Regression'):'')));this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudMoyGenerale,'' ,GTraductions.getValeur('BulletinEtReleve.Evol')+' : '+(this.General.Evolution.GetGenre()?lLibelleEvolution:''));}
if(this.Affichage.AvecMoyenneAnnuelle)
this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudMoyGenerale,'' ,GTraductions.getValeur('BulletinEtReleve.MoyAnnuelle')+' : '+(this.General.MoyenneAnnuelle?this.General.MoyenneAnnuelle:''));if(this.Affichage.AvecMoyennePeriode)
for(var I=0;I<this.Affichage.NombreMoyennesPeriodes;I++)
this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudMoyGenerale,'' ,this.Affichage.listePeriodes.GetLibelle(I)+' : '+(this.General.ListeMoyennesPeriodes[I]?this.General.ListeMoyennesPeriodes[I]:''));if(this.Affichage.AvecMoyenneEleve)
this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudMoyGenerale,'' ,GTraductions.getValeur('BulletinEtReleve.MoyEleve')+' : '+(this.General.MoyenneEleve?this.General.MoyenneEleve:''));if(this.Affichage.AvecMoyenneClasse)
this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudMoyGenerale,'' ,GTraductions.getValeur('BulletinEtReleve.MoyClasse')+' : '+(this.General.MoyenneClasse?this.General.MoyenneClasse:''));}};_ObjetBulletinEtReleve.prototype._getLibelleService=function(aService,aCmpDevoirs){var lLibelle=[];lLibelle.push('<strong>'+aService.Matiere.GetLibelle()+'</strong>');if(aCmpDevoirs)
lLibelle.push('&nbsp;[',aCmpDevoirs,' '+(aCmpDevoirs>1?GTraductions.getValeur('BulletinEtReleve.Devoirs'):GTraductions.getValeur('BulletinEtReleve.Devoir')),']');for(var K=0;K<aService.ListeProfesseurs.GetNbrElements();K++){var lProfesseur=aService.ListeProfesseurs.GetElement(K);if(K>0) lLibelle.push(' |');else lLibelle.push('<br>');lLibelle.push(lProfesseur.GetLibelle());}
return lLibelle.join('');};;

MethodesObjet.heritagePrototype(ObjetApprPiedDeBulletin,_ObjetBulletinEtReleve);function ObjetApprPiedDeBulletin(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.donneesRecues=false;this.assistantSaisieActif=true;}
ObjetApprPiedDeBulletin.prototype.construireListeAppreciations=function(aPourImpression){var H=[];if(this.Liste)
for(var I=0;I<this.Liste.GetNbrElements();I++){var lElement=this.Liste.GetElement(I);if((!this.Saisie)||aPourImpression){if(lElement&&(lElement.ListeAppreciations.GetElement(0).GetLibelle()!=='')){H.push('<div class="'+this.taillePolice+'">');if(lElement.Intitule!=='')
H.push('<span>'+GChaine.AvecEspaceSiVide(lElement.Intitule)+'&nbsp;:&nbsp;'+'</span>');H.push('<span class="Gras">'+GChaine.toTexte(lElement.ListeAppreciations.GetElement(0).GetLibelle())+'</span>');H.push('</div>');}}
else{if(lElement){var lLibelle=lElement.ListeAppreciations.GetElement(0).GetLibelle();H.push('<tr class="Texte10">');H.push(this.composeCelluleTitreAppreciation(aPourImpression,300,GChaine.AvecEspaceSiVide(lElement.Intitule)));this.setOptions_ObjetBulletinEtReleve({labelWAI:lElement.Intitule+lLibelle});H.push(this.composeAppreciation({pourImpression:aPourImpression,saisie:this.Saisie,libelle:lLibelle,largeur:400,ligne:parseInt(I)+1,col:1,hauteurFixeNonEditable:null}));H.push('</tr>');}}}
return H.join('');};ObjetApprPiedDeBulletin.prototype.ConstruireAffichage=function(aPourImpression){var H=[];var lHtml=this.construireListeAppreciations(aPourImpression);if(((!this.Saisie)||aPourImpression)&&(lHtml!=='')){if(this.avecSeparateur)
H.push(this.composeSeparateur(aPourImpression));H.push(lHtml);} else{H.push('<div class="EspaceBas">');H.push('<table style="'+GStyle.composeCouleurBordure(GCouleur.liste.getBordure(aPourImpression),1,EGenreBordure.haut+EGenreBordure.droite)+'" class="'+this.taillePolice+' FondBlanc" border="0" cellpadding="0" cellspacing="0">');H.push(lHtml);H.push('</table>');H.push('</div>');}
return H.join('');};ObjetApprPiedDeBulletin.prototype.ComposePage=function(aPourImpression,aNumeroImpression){var lPourImpression=(aPourImpression?aPourImpression:false);this.actualiserDimensions(lPourImpression,aNumeroImpression);var H=[];var lClass=aPourImpression?'class="EspaceHaut"':'';H.push('<div '+lClass+'>');H.push(this.ConstruireAffichage(aPourImpression));H.push('</div>');return H.join('');};ObjetApprPiedDeBulletin.prototype.Initialiser=function(){if(this.donneesRecues) this.Afficher(this.ComposePage());};ObjetApprPiedDeBulletin.prototype.GetHauteurCellule=function(){return 2;};ObjetApprPiedDeBulletin.prototype.setDonnees=function(aListeAppreciations,aAvecSaisieAG,aAvecSeparateur){this.donneesRecues=true;this.Liste=aListeAppreciations;if(this.Liste){this.Liste.setTri([ObjetTri.init('Genre')]);this.Liste.trier();}
this.Saisie=aAvecSaisieAG;this.avecSeparateur=aAvecSeparateur;this.appreciationGenerale=true;};ObjetApprPiedDeBulletin.prototype.activerAssistantSaisie=function(aActiver){this.assistantSaisieActif=aActiver;};ObjetApprPiedDeBulletin.prototype.determinerModeSaisiePourCellule=function(aAppreciation){return(aAppreciation&&aAppreciation.Genre===EGenreAppreciationGenerale.AG_Mention?EGenreModeSaisie.selection:(this.assistantSaisieActif&&GApplication.droits.get(IEEnum.droits.assistantSaisieAppreciations)&&GEtatUtilisateur.assistantSaisieActif?EGenreModeSaisie.selection:EGenreModeSaisie.edition));};ObjetApprPiedDeBulletin.prototype.determinerCurseurPourCellule=function(aAppreciation,aPourImpression){return(aAppreciation&&aAppreciation.Genre===EGenreAppreciationGenerale.AG_Mention?'':(this.assistantSaisieActif&&GApplication.droits.get(IEEnum.droits.assistantSaisieAppreciations)&&GEtatUtilisateur.assistantSaisieActif&&(!aPourImpression)?'Curseur_AssistantSaisieActif':''));};;

MethodesObjet.heritagePrototype(PiedDeReleve,_PiedDeReleve);function PiedDeReleve(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);}
PiedDeReleve.prototype.ConstruireInstances=function(){this.identAppreciationGenerale=this.Add(window.ObjetApprPiedDeBulletin);};;
MethodesObjet.heritagePrototype(ObjetReleve,_ObjetBulletinEtReleve);function ObjetReleve(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.NbrMaxProfesseurs=3;this.LargeurDansRegroupement=5;}
ObjetReleve.prototype.GetLargeurInformations=function(){return 1+this.LargeurService+Number(this.Affichage.AvecSousService)*(this.LargeurSousService+1)+Number(this.Affichage.AvecMoyenneEleve)*(this.LargeurDevoir+1)+Number(this.Affichage.AvecMoyenneClasse)*(this.LargeurDevoir+1)+Number(this.Affichage.AvecMoyenneInfSup)*2*(this.LargeurDevoir+1)+Number(this.Affichage.AvecMoyenneAnnuelle)*(this.LargeurDevoir+1)+this.Affichage.NombreMoyennesPeriodes*(this.LargeurDevoir+1);};ObjetReleve.prototype.getLargeurGeneral=function(){return 1+this.LargeurService+Number(this.Affichage.AvecSousService)*(this.LargeurSousService+1);};ObjetReleve.prototype.SetDonnees=function(aSaisie,aListeElements,aNbrMaxServices,aNbrMaxDevoirs){this.Saisie=aSaisie;this.Liste=this._getListeDonneesLineaire(aListeElements);this.NbrMaxServices=aNbrMaxServices;this.NbrMaxDevoirs=aNbrMaxDevoirs;this.donneesRecues=true;};ObjetReleve.prototype._getListeDonneesLineaire=function(aListeElements){var lService,lSousService,lCmpActifs,lIndiceDernier,lIndicePremier,lIndiceDernierActif,J,lIndicePremierActif;var lListe=new ObjetListeElements();var lNbrMaxTotDevoirs=0;for(var I=0;I<aListeElements.GetNbrElements();I++){lService=aListeElements.GetElement(I);lService.estService=true;lService.nbSousServicesTotal=lService.ListeElements.GetNbrElements();lService.regroupement=lService.SurMatiere.GetNumero();lService.avecAppreciationParSousService=this.Affichage.AvecAppreciationParSousService;if(lService.nbSousServicesTotal>0){lCmpActifs=0;lIndiceDernier=0;lIndicePremier=null;lIndiceDernierActif=0;lIndicePremierActif=null;for(J=0;J<lService.nbSousServicesTotal;J++){if(lIndicePremier===null||lIndicePremier===undefined) lIndicePremier=J;if(lService.ListeElements.GetElement(J).Actif){if(lIndicePremierActif===null||lIndicePremierActif===undefined) lIndicePremierActif=J;lCmpActifs++;lIndiceDernierActif=J;}
lIndiceDernier=J;}
lService.nbSousServicesActifs=lCmpActifs;for(J=0;J<lService.nbSousServicesTotal;J++){lSousService=lService.ListeElements.GetElement(J);if(lSousService.ListeDevoirs.GetNbrElements()>lNbrMaxTotDevoirs) lNbrMaxTotDevoirs=lSousService.ListeDevoirs.GetNbrElements();lSousService.estService=false;lSousService.estDernier=(J===lIndiceDernier);lSousService.estPremier=(J===lIndicePremier);lSousService.estDernierActif=(J===lIndiceDernierActif);lSousService.estPremierActif=(J===lIndicePremierActif);lSousService.regroupement=lService.regroupement;lSousService.avecAppreciationParSousService=lService.avecAppreciationParSousService;lSousService.pere=lService;lListe.AddElement(lSousService);}}
else{if(lService.ListeDevoirs.GetNbrElements()>lNbrMaxTotDevoirs) lNbrMaxTotDevoirs=lService.ListeDevoirs.GetNbrElements();lListe.AddElement(lService);}}
this.nbrMaxTotDevoirs=lNbrMaxTotDevoirs;return lListe;};ObjetReleve.prototype.SetDonnees_Affichage=function(AAffichage){this.Affichage=AAffichage;this.NbrMoyennes=Number(this.Affichage.AvecMoyenneEleve)+Number(this.Affichage.AvecMoyenneClasse)+2*Number(this.Affichage.AvecMoyenneInfSup)+Number(this.Affichage.AvecMoyenneAnnuelle)+this.Affichage.NombreMoyennesPeriodes;};ObjetReleve.prototype.ConstruireAffichage=function(){if(!this.donneesRecues) return;this.NombreLignes=0;this.Pere.surResizeInterface();this.Afficher(this.ComposePage());this.ScrollV.SetDonnees(0,1,2);this.ScrollH.SetDonnees(1);};ObjetReleve.prototype.actualiserDimensions=function(aPourImpression,aNumeroImpression){this.inherited('actualiserDimensions',aPourImpression,aNumeroImpression);if(aPourImpression){this.LargeurDevoir=[ 80,65,55,40][aNumeroImpression];this.LargeurAppreciation=[275,225,175,125][aNumeroImpression];if(this.Affichage.avecDevoirComplet)
this.HauteurService=[85,75,65,55][aNumeroImpression];else this.HauteurService=[75,65,55,45][aNumeroImpression];}
else{this.LargeurDevoir=55;this.LargeurAppreciation=175;this.HauteurService=this.Affichage.avecDevoirComplet?65:55;}
this.NombreColonnes=this.Affichage.NombreAppreciations;};ObjetReleve.prototype.composeImpression=function(){var H=[];H.push('<table style="'+GStyle.composeCouleurBordure(GCouleur.liste.getBordure(true),1,EGenreBordure.haut+EGenreBordure.droite)+'" border="0" cellspacing="0" cellpadding="0">');H.push('<tr>');H.push('<td colspan="3">'+this.ComposeLigneTitre(true)+'</td>');H.push('</tr>');H.push('<tr>');H.push('<td>'+this.ComposeReleve(0,true)+'</td>');H.push('<td>'+this.ComposeReleve(1,true)+'</td>');if(this.Affichage.NombreAppreciations)
H.push('<td>'+this.ComposeReleve(2,true)+'</td>');H.push('</tr>');H.push('</table>');H.push(this.ComposeGeneral(true));return H.join('');};ObjetReleve.prototype.composePageBulletin=function(){var H=[];H.push('<table id="'+this.idPage+'" border="0" cellspacing="0" cellpadding="0">');H.push('<tr>');H.push('<td style="'+GStyle.composeCouleurBordure(GCouleur.liste.getBordure(),1,EGenreBordure.haut+EGenreBordure.droite)+'" colspan="'+(this.Affichage.NombreAppreciations?3:2)+'">'+this.ComposeLigneTitre()+'</td>');H.push('<td width="'+this.ScrollV.GetLargeur()+'"></td>');H.push('</tr>');H.push('<tr>');H.push('<td><div tabIndex="-1" id="'+this.ScrollV.GetIdZone(0)+'" style="width:'+this.GetLargeurInformations()+'px; height:1px; overflow:hidden;">'+this.ComposeReleve(0)+'</div></td>');H.push('<td style="'+(this.Affichage.NombreAppreciations===0?GStyle.composeCouleurBordure(GCouleur.liste.getBordure(),1,EGenreBordure.droite):'')+'"><div tabIndex="-1" id="'+this.ScrollV.GetIdZone(1)+'" style="width:1px; height:1px; overflow:hidden;">'+this.ComposeReleve(1)+'</div></td>');if(this.Affichage.NombreAppreciations)
H.push('<td style="'+GStyle.composeCouleurBordure(GCouleur.liste.getBordure(),1,EGenreBordure.droite)+'"><div tabIndex="-1" id="'+this.ScrollV.GetIdZone(2)+'" style="width:'+this.LargeurAppreciation+'px; height:1px; overflow:hidden;" onscroll="',this.Nom,'.ScrollV.Actualiser(2)">'+this.ComposeReleve(2)+'</div></td>');H.push('<td id="'+this.ScrollV.GetIdScroll()+'"></td>');H.push('</tr>');H.push('<tr>');H.push('<td class="AlignementHaut">'+this.ComposeGeneral()+'</td>');H.push('<td class="AlignementBas" id="'+this.ScrollH.GetIdScroll()+'"></td>');H.push('<td></td>');H.push('<td></td>');H.push('</tr>');H.push('</table>');return H.join('');};ObjetReleve.prototype.GetScrollLeft=function(AGenre,AScrollLeft){if(AGenre===EGenreScrollEvenement.TailleZone)
AScrollLeft=GPosition.getWidth(this.Nom)-GPosition.getWidth(this.idPage);switch(AGenre){case EGenreScrollEvenement.Deplacement:return Math.min(Math.floor(AScrollLeft/(this.LargeurDevoir+1))*(this.LargeurDevoir+1),(this.LargeurDevoir+1)*this.NbrMaxDevoirs);case EGenreScrollEvenement.TailleZone:return Math.min(Math.floor(AScrollLeft/(this.LargeurDevoir+1))*(this.LargeurDevoir+1),(this.LargeurDevoir+1)*this.NbrMaxDevoirs);case EGenreScrollEvenement.TailleContenu:return null;}};ObjetReleve.prototype.ComposeReleve=function(aNumeroZone,aPourImpression){var H=[];H.push('<table ',(aPourImpression?'':'id="'+this.ScrollV.GetIdContenu(aNumeroZone)+'"'),'class="FondBlanc" border="0" cellpadding="0" cellspacing="0">');for(var I=0;I<this.Liste.GetNbrElements();I++)
H.push(this.composeLigneService(aPourImpression,this.Liste.GetElement(I),I,aNumeroZone));H.push('</table>');return H.join('');};ObjetReleve.prototype.ComposeLigneTitre=function(aPourImpression){var H=[];var lDefaut={taille:this.LargeurDevoir,bordGauche:true,bordBas:true,pourImpression:aPourImpression};H.push('<table style="width: 100%" border="0" cellpadding="0" cellspacing="0">');H.push('<tr style="height: '+this.HauteurTitre+'px">');H.push(this.composeTitre($.extend({},lDefaut,{libelle:GTraductions.getValeur('Matieres'),taille:this.LargeurService,bordGauche:false,nbrLignes:2,id:this.idPourIdPremierElement})));H.push(this.composeTitre($.extend({},lDefaut,{libelle:'&nbsp',taille:this.LargeurSousService,nbrLignes:2,visible:this.Affichage.AvecSousService})));H.push(this.composeTitre($.extend({},lDefaut,{libelle:this.NbrMoyennes>1?GTraductions.getValeur('Moyennes'):GTraductions.getValeur('BulletinEtReleve.Moy'),taille:this.LargeurDevoir*this.NbrMoyennes,bordBas:false,nbrCol:this.NbrMoyennes,visible:this.NbrMoyennes})));H.push(this.composeTitre($.extend({},lDefaut,{libelle:GTraductions.getValeur('Devoirs'),taille:aPourImpression?(this.LargeurDevoir+1)*this.nbrMaxTotDevoirs-1:'',nbrCol:aPourImpression?this.nbrMaxTotDevoirs:this.NbrMaxDevoirs,nbrLignes:2})));H.push(this.composeTitre($.extend({},lDefaut,{libelle:GTraductions.getValeur('Appreciation'),taille:this.LargeurAppreciation-1,nbrLignes:2,visible:this.Affichage.NombreAppreciations})));H.push('</tr>');H.push('<tr style="height: '+this.HauteurTitre+'px">');H.push(this.composeTitre($.extend({},lDefaut,{libelle:GTraductions.getValeur('Eleve'),visible:this.Affichage.AvecMoyenneEleve})));H.push(this.composeTitre($.extend({},lDefaut,{libelle:GTraductions.getValeur('Classe'),visible:this.Affichage.AvecMoyenneClasse})));H.push(this.composeTitre($.extend({},lDefaut,{libelle:GTraductions.getValeur('BulletinEtReleve.Annuelle'),visible:this.Affichage.AvecMoyenneAnnuelle})));for(var I=0;I<this.Affichage.NombreMoyennesPeriodes;I++)
H.push(this.composeTitre($.extend({},lDefaut,{libelle:this.Affichage.listePeriodes.GetLibelle(I)})));H.push(this.composeTitre($.extend({},lDefaut,{libelle:'-',visible:this.Affichage.AvecMoyenneInfSup})));H.push(this.composeTitre($.extend({},lDefaut,{libelle:'+',visible:this.Affichage.AvecMoyenneInfSup})));H.push('</tr>');H.push('</table>');return H.join('');};ObjetReleve.prototype.estDernierAffiche=function(aService,aPourImpression){if(aService.estService){return true;}
else return aPourImpression?aService.estDernierActif:aService.estDernier;};ObjetReleve.prototype.composeLigneService=function(aPourImpression,aService,aLigne,aNumeroZone){var H=[];if(!aPourImpression||aService.Actif){if(aService.estService||aService.estPremier)
H.push(this.composeRegroupement({service:aService,numeroZone:aNumeroZone,pourImpression:aPourImpression}));H.push('<tr>');var ldefaultParamDevoir={devoir:null,indiceDevoir:-1,avecCommentaire:false,moyenne:null,estMoyenne:false,estMoyenneEleve:false,indiceLigne:aLigne,pourImpression:aPourImpression,avecMethCalculMoyenne:false,moyTrim:false,periode:null};var lParamDevoir,J;switch(aNumeroZone){case 0:{var lDansRegroupement=aService.regroupement;var lId=this.GetIdLigne(this.NombreLignes++);var lBordBas=this.estDernierAffiche(aService,aPourImpression);var lService=(aService.estService?aService:(aService.estPremierActif||(aService.estPremier&&(aService.pere.nbSousServicesActifs===0))?aService.pere:null));var lActif=(aService.estService?aService.Actif:(aService.pere.nbSousServicesActifs!==0));H.push(this.composeService({service:lService,largeur:this.LargeurService,bordBas:lBordBas,bordRegroupement:lDansRegroupement,id:lId,actif:lActif,pourImpression:aPourImpression}));if(this.Affichage.AvecSousService)
H.push(this.composeService({service:aService.estService?null:aService,largeur:this.LargeurSousService,actif:aService.Actif,pourImpression:aPourImpression}));if(this.Affichage.AvecMoyenneEleve){lParamDevoir={moyenne:aService.MoyenneEleve,estMoyenne:true,estMoyenneEleve:true,avecMethCalculMoyenne:true};H.push(this._composeDevoir($.extend({},ldefaultParamDevoir,lParamDevoir)));}
if(this.Affichage.AvecMoyenneClasse){lParamDevoir={moyenne:aService.MoyenneClasse,estMoyenne:true};H.push(this._composeDevoir($.extend({},ldefaultParamDevoir,lParamDevoir)));}
if(this.Affichage.AvecMoyenneAnnuelle){lParamDevoir={moyenne:aService.MoyenneAnnuelle,estMoyenne:true,avecMethCalculMoyenne:true,moyTrim:true};H.push(this._composeDevoir($.extend({},ldefaultParamDevoir,lParamDevoir)));}
for(var I=0;I<this.Affichage.NombreMoyennesPeriodes;I++){lParamDevoir={moyenne:aService.ListeMoyennesPeriodes[I],estMoyenne:true,avecMethCalculMoyenne:true,periode:this.Affichage.listePeriodes.GetElement(I)};H.push(this._composeDevoir($.extend({},ldefaultParamDevoir,lParamDevoir)));}
if(this.Affichage.AvecMoyenneInfSup){lParamDevoir={moyenne:aService.MoyenneInf,estMoyenne:true};H.push(this._composeDevoir($.extend({},ldefaultParamDevoir,lParamDevoir)));lParamDevoir={moyenne:aService.MoyenneSup,estMoyenne:true};H.push(this._composeDevoir($.extend({},ldefaultParamDevoir,lParamDevoir)));}
break;}
case 1:{var lAvecCommentaire=false;for(J=0;!lAvecCommentaire&&(J<this.NbrMaxDevoirs);J++){var lDevoir=aService.ListeDevoirs.GetElement(J);if(lDevoir&&lDevoir.Commentaire)
lAvecCommentaire=true;}
for(J=0;J<this.NbrMaxDevoirs;J++){lParamDevoir={devoir:aService.ListeDevoirs.GetElement(J),indiceDevoir:J,avecCommentaire:lAvecCommentaire,moyenne:false};H.push(this._composeDevoir($.extend({},ldefaultParamDevoir,lParamDevoir)));}
break;}
case 2:{var lNbrLignes=(this.Affichage.AvecAppreciationParSousService?1:(aService.estService?1:(aService.estPremier?(aPourImpression?aService.pere.nbSousServicesActifs:aService.pere.nbSousServicesTotal):0)));if(!aService.estService&&!this.Affichage.AvecAppreciationParSousService) aService=aService.pere;var lLabelWAI=GTraductions.getValeur('Appreciation')+' ';lLabelWAI+=(aService?GTraductions.getValeur('Matieres')+' '+aService.GetLibelle()+' ':' ');lLabelWAI+=(this.Affichage.AvecMoyenneEleve?GTraductions.getValeur('Moyennes')+' '+GTraductions.getValeur('Eleve')+' '+aService.MoyenneEleve:' ');lLabelWAI+=(this.Affichage.AvecMoyenneClasse?GTraductions.getValeur('Moyennes')+' '+GTraductions.getValeur('Classe')+' '+aService.MoyenneClasse:' ');lLabelWAI+=(this.Affichage.AvecMoyenneAnnuelle?GTraductions.getValeur('Moyennes')+' '+GTraductions.getValeur('BulletinEtReleve.Annuelle')+' '+aService.MoyenneAnnuelle:' ');lLabelWAI+=(this.Affichage.AvecMoyenneInfSup?GTraductions.getValeur('Moyennes')+'inf. '+' '+aService.MoyenneInf+' ':' ');lLabelWAI+=(this.Affichage.AvecMoyenneInfSup?GTraductions.getValeur('Moyennes')+'sup. '+' '+aService.MoyenneSup+' ':' ');for(J=0;aService.ListeDevoirs.GetElement(J)&&J<this.NbrMaxDevoirs;J++){lLabelWAI+=GTraductions.getValeur('Devoirs')+' '+J+' ';lLabelWAI+=(aService.ListeDevoirs.GetElement(J).Commentaire?'Commentaire '+aService.ListeDevoirs.GetElement(J).Commentaire+' ':' ');lLabelWAI+=(aService.ListeDevoirs.GetElement(J).Bareme?'Bareme '+aService.ListeDevoirs.GetElement(J).Bareme.getNote()+' ':' ');lLabelWAI+=(aService.ListeDevoirs.GetElement(J).Coefficient?'Coefficient '+aService.ListeDevoirs.GetElement(J).Coefficient.getNote()+' ':' ');lLabelWAI+=(aService.ListeDevoirs.GetElement(J).Note?'Note '+aService.ListeDevoirs.GetElement(J).Note.getNote()+' ':' ');}
this.setOptions_ObjetBulletinEtReleve({labelWAI:lLabelWAI});H.push(this.composeAppreciation({pourImpression:aPourImpression,saisie:this.Saisie,libelle:GChaine.toTexte(aService.ListeAppreciations.GetLibelle(0)),largeur:this.LargeurAppreciation,rowspan:lNbrLignes,ligne:aLigne+1,col:0+1,hauteurLigne:lNbrLignes*this.HauteurService,hauteurFixeNonEditable:aPourImpression}));break;}}
H.push('</tr>');}
return H.join('');};ObjetReleve.prototype.surEvntMethodeCalculMoyenne=function(aIndiceLigne,aMoyTrimestrielle,aNumPeriode,aGenrePeriode){var lParamEvnt={genreEvnt:EGenreEvenementNotesEtAppreciations.MethodeCalculMoyenne,service:this.Liste.GetElement(aIndiceLigne),moyTrimestrielle:aMoyTrimestrielle};if(aNumPeriode&&aGenrePeriode){var lPeriode=new ObjetElement('',aNumPeriode,aGenrePeriode);$.extend(lParamEvnt,{periode:lPeriode});}
this.callback.appel(lParamEvnt);};ObjetReleve.prototype.surEvntNote=function(aIndiceLigne,aIndiceDevor){var lService=this.Liste.GetElement(aIndiceLigne);var lDevoir=lService.ListeDevoirs.GetElement(aIndiceDevor);var lParamEvnt={genreEvnt:EGenreEvenementNotesEtAppreciations.ExecutionQCM,executionQCM:lDevoir.executionQCM};this.callback.appel(lParamEvnt);};ObjetReleve.prototype._composeDevoir=function(aParam){var H=[];var LDate='&nbsp;';var lCoefficient='&nbsp;';var lBareme='';var LNote='&nbsp;';if(aParam.devoir&&aParam.devoir.Note){LNote=aParam.devoir.Note.getNote();if(aParam.devoir.estFacultatif)
LNote='('+LNote+')';if(this.Affichage.avecDevoirDate&&aParam.devoir.Date)
LDate=GDate.FormatDate(aParam.devoir.Date,'%JJ/%MM/%AA');if(this.Affichage.avecDevoirCoefficient&&(aParam.devoir.Coefficient)&&(!aParam.devoir.Coefficient.estCoefficientParDefaut())){lCoefficient='<span title="'+GTraductions.getValeur('ReleveDeNotes.CoeffficientDevoir')+'">'+GTraductions.getValeur('ReleveDeNotes.AbreviationCoef')+'&nbsp;'+aParam.devoir.Coefficient.getNote()+'</span>';} if(aParam.devoir.Bareme&&(!aParam.devoir.Bareme.estBaremeParDefaut())){lBareme='<span class="Texte'+(this.TailleTexte-1)+' Gris" title="'+GTraductions.getValeur('ReleveDeNotes.BaremeDevoir')+'">'+' '+aParam.devoir.Bareme.getBaremeEntier()+'</span>';}}
else if(aParam.moyenne)
LNote=aParam.moyenne.getNote();var LStyle='style="'+(aParam.estMoyenne?GTableau.styleTotal(aParam.pourImpression,false):GTableau.styleCellule(aParam.pourImpression,false,null,true))+'" ';var LCouleurFond_Date=aParam.pourImpression||(LDate==='&nbsp;')?'':GCouleur.themeNeutre.claire;var LCouleurTexte_Date=GCouleur.noir;var lCellpadding=aParam.pourImpression?1:0;var lCellspacing=aParam.pourImpression?0:2;var lAvecMethodeCalculMoyenne=(aParam.avecMethCalculMoyenne&&(!aParam.pourImpression)&&(aParam.moyenne.getNote()!==''));var lCurseur=lAvecMethodeCalculMoyenne?' Curseur_MethodeCalculMoyenneActif':'';var lSurClick;if(aParam.periode){var lNumPeriode="'"+aParam.periode.GetNumero()+"'";lSurClick=lAvecMethodeCalculMoyenne?'onclick="'+this.Nom+'.surEvntMethodeCalculMoyenne('+aParam.indiceLigne+','+aParam.moyTrim+','+lNumPeriode+','+aParam.periode.GetGenre()+')"':'';}
else lSurClick=lAvecMethodeCalculMoyenne?'onclick="'+this.Nom+'.surEvntMethodeCalculMoyenne('+aParam.indiceLigne+','+aParam.moyTrim+')"':'';H.push('<td '+this.ComposeClassEtStyleDevoir(aParam.pourImpression)+' height="'+(this.HauteurService-1)+'px" class="AlignementBas '+lCurseur+'" '+lSurClick+'>');H.push('<table width="'+this.LargeurDevoir+'px" height="'+(this.HauteurService-1)+'px" '+LStyle+' border="0" cellpadding="'+lCellpadding+'" cellspacing="'+lCellspacing+'">');if(this.Affichage.avecDevoirsCommentaire&&aParam.avecCommentaire){var lCommentaire=aParam.avecCommentaire&&aParam.devoir&&aParam.devoir.Commentaire?aParam.devoir.Commentaire:'';var lTitleCommentaire=aParam.pourImpression?'':lCommentaire;H.push('<tr><td colspan="2" class="Texte'+(this.TailleTexte-2)+'" height="10px" title ="'+lTitleCommentaire+'">'+(lCommentaire?GChaine.GetChaine(lCommentaire,this.TailleTexte-2,false,this.LargeurDevoir-6-2):'&nbsp;')+'</td></tr>');}
H.push('<tr><td colspan="2" class="Texte'+(this.TailleTexte-1)+' AlignementMilieu" style="'+GStyle.composeCouleur(LCouleurFond_Date,LCouleurTexte_Date)+'" height="10px">'+LDate+'</td></tr>');H.push('<tr><td class="Texte'+(this.TailleTexte-1)+' Gris AlignementDroit AlignementBas">'+lCoefficient+'</td></tr>');H.push('<tr>');if(this.avecCorrige&&aParam.devoir&&aParam.devoir.libelleCorrige&&!aParam.pourImpression){H.push('<td colspan="2" class="'+this.taillePolice+' AlignementDroit" height="10px">');H.push('<a class="Texte10" title="',GTraductions.getValeur('AfficherCorrige'),'" href="'+GChaine.GetChainePourUrl(GApplication.getCommunication().composeUrlFichierExterne(aParam.devoir.libelleCorrige,{"N":aParam.devoir.GetNumero(),"G":EGenreRessource.Devoir}),true)+'" target="_blank">');H.push(LNote);H.push('</a>');H.push(lBareme);H.push('</td>');} else if(this.avecCorrige&&aParam.devoir&&aParam.devoir.executionQCM&&aParam.devoir.executionQCM.publierCorrige&&!aParam.pourImpression){H.push('<td colspan="2" class="'+this.taillePolice+' AlignementDroit Gras" height="10px">');H.push('<span class="Gras Souligne AvecMain" onclick="',this.Nom,'.surEvntNote ('+aParam.indiceLigne+','+aParam.indiceDevoir,')">',LNote,'</span>');H.push(lBareme);H.push('</td>');} else{H.push('<td colspan="2" class="'+this.taillePolice+' AlignementDroit'+(aParam.moyenne&&!aParam.estMoyenne?'':' Gras')+'" height="10px">');H.push(LNote+lBareme);H.push('</td>');}
H.push('</tr>');H.push('</table>');H.push('</td>');return H.join('');};ObjetReleve.prototype.ComposeGeneral=function(aPourImpression){var H=[];var lDefault={largeur:this.LargeurDevoir,estMoyenneGenerale:true,pourImpression:aPourImpression};if(this.Affichage.AvecMoyenneGenerale&&(this.Affichage.AvecMoyenneEleve||this.Affichage.AvecMoyenneClasse)){H.push('<table class="'+this.taillePolice+'" style="'+GStyle.composeCouleurBordure(GCouleur.liste.getBordure(aPourImpression),aPourImpression||this.Affichage.AvecMoyenneInfSup?1:0,EGenreBordure.droite)+'" border="0" cellpadding="0" cellspacing="0">');H.push('<tr>');H.push('<td class="Gras AlignementDroit EspaceDroit"><div style="width:'+(this.getLargeurGeneral()-5)+'px" class="Gras">'+GTraductions.getValeur('MoyenneGenerale')+'</div></td>');H.push(this.composeNote($.extend({},lDefault,{note:this.General.MoyenneEleve,visible:this.Affichage.AvecMoyenneEleve})));H.push(this.composeNote($.extend({},lDefault,{note:this.General.MoyenneClasse,visible:this.Affichage.AvecMoyenneClasse})));H.push('</tr>');H.push('</table>');}
return H.join('');};;
ObjetReleve.prototype.AfficherListe=function(){this._objetListeArborescente=new ObjetListeArborescente(this.Nom+'_Liste',0,this,null);var lRacine=this._objetListeArborescente.construireRacine(),lNoeudRegroupement;this._objetListeArborescente.setParametres(false);var lNoeudMatieres=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lRacine,'','<strong>'+GTraductions.getValeur('Matieres')+'</strong>',null,true,true);for(var I=0;I<this.Liste.GetNbrElements();I++){var lService=this.Liste.GetElement(I);if(lService.estService||lService.estPremierActif)
if(lService.regroupement&&(lService.estDebutRegroupement)){var lLibelleRegroupement=lService.SurMatiere.GetLibelle();lNoeudRegroupement=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lNoeudMatieres,'',lLibelleRegroupement);}
var lNoeudPere=lService.regroupement?lNoeudRegroupement:lNoeudMatieres;this._construireListeArborescente_Service(lService,lNoeudPere);}
return lRacine;};ObjetReleve.prototype._getNbrDevoirs=function(aService){var lDevoir,J;var lCmpDevoirs=0;for(J=0;J<aService.ListeDevoirs.GetNbrElements();J++){lDevoir=aService.ListeDevoirs.GetElement(J);if(lDevoir&&lDevoir.Note) lCmpDevoirs++;}
return lCmpDevoirs;};ObjetReleve.prototype._ajouterMoyennes=function(aService,aNoeud){if((this.Affichage.AvecMoyenneEleve&&aService.MoyenneEleve)||(this.Affichage.AvecMoyenneAnnuelle&&aService.MoyenneAnnuelle)||(this.Affichage.AvecMoyenneInfSup&&(aService.MoyenneInf||aService.MoyenneSup))||this.Affichage.NombreMoyennesPeriodes){var lNoeudMoyennes=this._objetListeArborescente.ajouterUnNoeudAuNoeud(aNoeud,'',GTraductions.getValeur('Moyennes'),'');if(this.Affichage.AvecMoyenneEleve)
this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudMoyennes,'' ,GTraductions.getValeur('Eleve')+' : '+(aService.MoyenneEleve?aService.MoyenneEleve:''));if(this.Affichage.AvecMoyenneAnnuelle)
this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudMoyennes,'' ,GTraductions.getValeur('Eleve')+' : '+(aService.MoyenneAnnuelle?aService.MoyenneAnnuelle:''));if(this.Affichage.AvecMoyenneInfSup){this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudMoyennes,'' ,'- : '+(aService.MoyenneInf?aService.MoyenneInf:''));this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudMoyennes,'' ,'+ : '+(aService.MoyenneSup?aService.MoyenneSup:''));}
for(var I=0;I<this.Affichage.NombreMoyennesPeriodes;I++){this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudMoyennes,'',this.Affichage.listePeriodes.GetLibelle(I)+' : '+aService.ListeMoyennesPeriodes[I]);}}};ObjetReleve.prototype._ajouterDevoirs=function(aService,aNoeud){var lCmpDevoirs=this._getNbrDevoirs(aService),lNoeudDevoirs;if(lCmpDevoirs>0)
lNoeudDevoirs=this._objetListeArborescente.ajouterUnNoeudAuNoeud(aNoeud,'',GTraductions.getValeur('Devoirs'),'');else this._objetListeArborescente.ajouterUneFeuilleAuNoeud(aNoeud,'',GTraductions.getValeur('BulletinEtReleve.aucunDevoir'),'');var lDevoir,J;for(J=0;J<this.NbrMaxDevoirs;J++){lDevoir=aService.ListeDevoirs.GetElement(J);if(lDevoir&&lDevoir.Note){var lLibelleDevoir=[];lLibelleDevoir.push(GTraductions.getValeur('BulletinEtReleve.Devoir'));if(lDevoir.Date) lLibelleDevoir.push(' '+GTraductions.getValeur('Du')+' ',GDate.FormatDate(lDevoir.Date,'%JJ/%MM/%AAAA'));if((lDevoir.Commentaire)&&(lDevoir.Commentaire!=='')) lLibelleDevoir.push(' [',lDevoir.Commentaire,']');var lNoeudDateDevoir=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lNoeudDevoirs,'',lLibelleDevoir.join(''),'');if(lDevoir.Note)
this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudDateDevoir,'',GTraductions.getValeur('ReleveDeNotes.Note')+' : '+lDevoir.Note);if(lDevoir.Coefficient)
this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudDateDevoir,'',GTraductions.getValeur('ReleveDeNotes.CoeffficientDevoir')+' : '+lDevoir.Coefficient);if(lDevoir.Bareme)
this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudDateDevoir,'',GTraductions.getValeur('ReleveDeNotes.BaremeDevoir')+' : '+lDevoir.Bareme);}}};ObjetReleve.prototype._ajouterAppreciations=function(aService,aNoeud){if(this.Affichage.NombreAppreciations){if(this.Affichage.AvecAppreciationParSousService){var lLibelleAppreciation=aService.ListeAppreciations.GetLibelle(0);var lStrLibelleAppreciation=(lLibelleAppreciation!==''?GTraductions.getValeur('Appreciation')+' : '+GChaine.AvecEspaceSiVide(lLibelleAppreciation):GTraductions.getValeur('ReleveDeNotes.AucuneAppreciation'));this._objetListeArborescente.ajouterUneFeuilleAuNoeud(aNoeud,'',lStrLibelleAppreciation);}}};ObjetReleve.prototype._construireListeArborescente_Service=function(lService,aNoeud){var lCmpDevoirs=this._getNbrDevoirs(lService);var lLibelle=this._getLibelleService(lService,lCmpDevoirs);var lNoeudMatiere=this._objetListeArborescente.ajouterUnNoeudAuNoeud(aNoeud,'',lLibelle);this._ajouterMoyennes(lService,lNoeudMatiere);this._ajouterDevoirs(lService,lNoeudMatiere);this._ajouterAppreciations(lService,lNoeudMatiere);};;
function ObjetRequeteMethodeCalculMoyenne(aPere,aEvenementSurReussite,aEvenementSurEchec){this.inheritedCreate(aPere,aEvenementSurReussite,aEvenementSurEchec);}
IE.Requetes.inscrire('MethodeCalculMoyenne',ObjetRequeteMethodeCalculMoyenne,_ObjetRequeteXmlConsultationPN);ObjetRequeteMethodeCalculMoyenne.prototype.lancerRequete=function(aParametres){this.JSON={Eleve:new ObjetElement(null,aParametres.numeroEleve),Classe:new ObjetElement(null,aParametres.numeroClasse),Service:new ObjetElement(null,aParametres.numeroServiceNotation),Periode:new ObjetElement(null,aParametres.numeroPeriodeNotation,aParametres.genreChoixNotation),MoyenneTrimestrielle:aParametres.moyenneTrimestrielle,MoyenneNette:aParametres.pourMoyenneNette,OrdreChronologique:aParametres.ordreChronologique};this.appelAsynchroneConsultation();};ObjetRequeteMethodeCalculMoyenne.prototype.actionApresRequete=function(){this.callbackReussite.appel(this.JSONReponse);};;

MethodesObjet.heritagePrototype(ObjetFenetre_MethodeCalculMoyenne,ObjetFenetre);function ObjetFenetre_MethodeCalculMoyenne(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.donneesRecues=false;}
ObjetFenetre_MethodeCalculMoyenne.prototype.composeTitreFormule=function(){if(this.titreFenetre){this.SetTitre(this.titreFenetre+'&nbsp;');}
if(this.titreFormule){return this.titreFormule;}
var lLibelleMatiere=this.parametresCalcul.module?this.parametresCalcul.module.GetLibelle():(this.parametresCalcul.service?(this.parametresCalcul.service.matiere?this.parametresCalcul.service.matiere.GetLibelle():this.parametresCalcul.service.GetLibelle()):'');var lTitre;if(lLibelleMatiere.length>0)
lTitre=this.parametresCalcul.pourMoyenneNette?GTraductions.getValeur('BulletinEtReleve.FenetreCalculMoyenneNetteAvecMatiere'):GTraductions.getValeur('BulletinEtReleve.FenetreCalculMoyenneBruteAvecMatiere');else lTitre=this.parametresCalcul.pourMoyenneNette?GTraductions.getValeur('BulletinEtReleve.FenetreCalculMoyenneNette'):GTraductions.getValeur('BulletinEtReleve.FenetreCalculMoyenneBrute');return GChaine.Format(lTitre,[this.parametresCalcul.libelleEleve,lLibelleMatiere]);};ObjetFenetre_MethodeCalculMoyenne.prototype.ComposeContenu=function(){var T=[];if(this.donneesRecues){T.push('<div class="Texte10 Espace Gras" style="margin-bottom: 5px;">',this.composeTitreFormule(),'</div>');T.push('<div class="Texte10 Espace FondBlanc">'+this.formuleHTML+'</div>');}
return T.join('');};ObjetFenetre_MethodeCalculMoyenne.prototype.SetDonnees=function(aParametresCalcul){this.parametresCalcul=aParametresCalcul;new ObjetRequeteMethodeCalculMoyenne(this,this.actionSurReponseRequete).lancerRequete(aParametresCalcul);};ObjetFenetre_MethodeCalculMoyenne.prototype.actionSurReponseRequete=function(aJSON){this.formuleHTML=aJSON.FormuleHTML;this.titreFormule=aJSON.titreFormule;this.titreFenetre=aJSON.titreFenetre;this.donneesRecues=true;this.Actualiser();this.Afficher();};;
MethodesObjet.heritagePrototype(_ObjetRequeteResultat,_ObjetRequeteXmlConsultationPN);function _ObjetRequeteResultat(aPere,aEvenementSurReussite,aEvenementSurEchec){this.inheritedCreate(aPere,aEvenementSurReussite,aEvenementSurEchec);}
_ObjetRequeteResultat.prototype.CreerParametresAffichage=function(AXml){this.Affichage=new ObjetElement();var LNoeud=AXml.GetCategorie(null,'ParametresAffichage');this.Affichage.AvecAppreciationParSousService=AXml.GetVariable(LNoeud,'AvecAppreciationParSousService');this.Affichage.AvecDureeDesAbsenses=AXml.GetVariable(LNoeud,'AvecDureeDesAbsenses');this.Affichage.AvecVolumeHoraire=AXml.GetVariable(LNoeud,'AvecVolumeHoraire');this.Affichage.AvecCoefficient=AXml.GetVariable(LNoeud,'AvecCoefficient');this.Affichage.AvecNombreDevoirs=AXml.GetVariable(LNoeud,'AvecNombreDevoirs');this.Affichage.AvecClassementEleve=AXml.GetVariable(LNoeud,'AvecClassementEleve');this.Affichage.AvecNombrePointsEleve=AXml.GetVariable(LNoeud,'AvecNombrePointsEleve');this.Affichage.AvecNombrePointsEntre=AXml.GetVariable(LNoeud,'AvecNombrePointsEntre');this.Affichage.AvecEvolution=AXml.GetVariable(LNoeud,'AvecEvolution');this.Affichage.NombreMoyennesPeriodes=AXml.GetVariable(LNoeud,'NombreMoyennesPeriodes');this.Affichage.AvecMoyenneEleve=AXml.GetVariable(LNoeud,'AvecMoyenneEleve');this.Affichage.AvecMoyenneProposee=AXml.GetVariable(LNoeud,'AvecMoyenneProposee');this.Affichage.AvecMoyenneDeliberee=AXml.GetVariable(LNoeud,'AvecMoyenneDeliberee');this.Affichage.AvecMoyenneClasse=AXml.GetVariable(LNoeud,'AvecMoyenneClasse');this.Affichage.AvecMoyenneInfSup=AXml.GetVariable(LNoeud,'AvecMoyenneInfSup');this.Affichage.AvecMoyennePeriode=AXml.GetVariable(LNoeud,'AvecMoyennePeriode');this.Affichage.AvecMoyenneAnnuelle=AXml.GetVariable(LNoeud,'AvecMoyenneAnnuelle');this.Affichage.NombreAppreciations=AXml.GetVariable(LNoeud,'NombreAppreciations');this.Affichage.avecECTS=AXml.GetVariable(LNoeud,'AvecECTS');this.Affichage.avecDevoirsCommentaire=AXml.GetVariable(LNoeud,'AvecDevoirsCommentaire');this.Affichage.avecDevoirDate=AXml.GetVariable(LNoeud,'AvecDevoirsDate');this.Affichage.avecDevoirCoefficient=AXml.GetVariable(LNoeud,'AvecDevoirsCoefficient');this.Affichage.avecDevoirComplet=this.Affichage.avecDevoirsCommentaire;this.Affichage.ListeIntitulesAppreciations=AXml.GetListeElements(LNoeud,'IntituleAppreciation');this.Affichage.listePeriodes=AXml.GetListeElements(LNoeud,'Periode');this.Affichage.AvecMoyenneGenerale=AXml.GetVariable(LNoeud,'AvecMoyenneGenerale');this.Affichage.AvecSousService=false;};_ObjetRequeteResultat.prototype.CreerListeServices=function(AXml){function getCoefficient(T){var R=0;for(var I in T)
if(T[I].Coefficient){var V=T[I].Coefficient.getValeur();if(!isNaN(V))
R+=V;}
return new TypeNote(R);}
function getMoyenne(T,aNom){var R=0,N=0;for(var I in T){var lExiste=T[I][aNom];if(lExiste){var V=T[I][aNom].getValeur();if(!isNaN(V)){R+=T[I].Coefficient.getValeur()*V;N+=T[I].Coefficient.getValeur();}}}
return N>0?new TypeNote(R/N):new TypeNote('');}
function getNombreDevoirs(T){var R1=0,R2=0,N=0;for(var I in T)
if((T[I])&&T[I].NombreDevoirs){R1+=parseInt(T[I].NombreDevoirs.split('/')[0]);R2+=parseInt(T[I].NombreDevoirs.split('/')[1]);N++;}
return N>0?R1+(isNaN(R2)?'':'/'+R2):'';}
function getNombrePointsEleve(T){var R=0;for(var I in T)
if((T[I])&&T[I].NombrePointsEleve)
R+=T[I].NombrePointsEleve.getValeur();return new TypeNote(R>0?R:'');}
function calculerEstDebutRegroupement(aListeElements,aTableauDebutRegroupement){for(var I=0;I<aListeElements.GetNbrElements();I++){var lElement=aListeElements.GetElement(I);var lNumeroSurMatiere=lElement.SurMatiere.GetNumero();if(lElement.SurMatiere.existeNumero()&&(lElement.OrdreDansRegroupement===aTableauDebutRegroupement[lNumeroSurMatiere]))
lElement.estDebutRegroupement=true;if(lElement.ListeElements)
calculerEstDebutRegroupement(lElement.ListeElements,aTableauDebutRegroupement);}}
this.ServiceEditable=AXml.GetVariable(null,'Editable');this.ExisteDevoir=false;this.ExisteService=false;this.NbrMaxServices=0;this.NbrMaxDevoirs=0;this.tableauSurMatieres=[];this.tableauDebutRegroupement=[];this.ListeElements=new ObjetListeElements();AXml.Parcourir(AXml.GetCategorie(null,'ListeServices'),'Service',this,this.AjouterService,false,this.ListeElements);this.ListeElements.Trier();calculerEstDebutRegroupement(this.ListeElements,this.tableauDebutRegroupement);for(var lNumero in this.tableauSurMatieres){this.tableauSurMatieres[lNumero].Coefficient=getCoefficient(this.tableauSurMatieres[lNumero].tableauServices);this.tableauSurMatieres[lNumero].NombreDevoirs=getNombreDevoirs(this.tableauSurMatieres[lNumero].tableauServices);this.tableauSurMatieres[lNumero].NombrePointsEleve=getNombrePointsEleve(this.tableauSurMatieres[lNumero].tableauServices);this.tableauSurMatieres[lNumero].MoyenneAnnuelle=getMoyenne(this.tableauSurMatieres[lNumero].tableauServices,'MoyenneAnnuelle');this.tableauSurMatieres[lNumero].MoyenneEleve=getMoyenne(this.tableauSurMatieres[lNumero].tableauServices,'MoyenneEleve');this.tableauSurMatieres[lNumero].MoyenneClasse=getMoyenne(this.tableauSurMatieres[lNumero].tableauServices,'MoyenneClasse');this.tableauSurMatieres[lNumero].MoyenneInf=getMoyenne(this.tableauSurMatieres[lNumero].tableauServices,'MoyenneInf');this.tableauSurMatieres[lNumero].MoyenneSup=getMoyenne(this.tableauSurMatieres[lNumero].tableauServices,'MoyenneSup');this.tableauSurMatieres[lNumero].ListeMoyennesPeriodes=[];for(var I=0;I<this.Affichage.NombreMoyennesPeriodes;I++)
this.tableauSurMatieres[lNumero].ListeMoyennesPeriodes[I]=getMoyenne(this.tableauSurMatieres[lNumero].tableauServices,'ListeMoyennesPeriodes['+I+']');}};_ObjetRequeteResultat.prototype.CreerMoyenneGenerale=function(AXml){this.MoyenneGenerale=this.AjouterService(AXml,AXml.GetCategorie(null,'General'));};_ObjetRequeteResultat.prototype.AjouterService=function(AXml,ANoeud,I,AParametre,P){var LElement=AXml.GetElement(ANoeud);this.ExisteService=true;LElement.Matiere=AXml.GetElement(ANoeud,'Matiere');LElement.ListeProfesseurs=AXml.GetListeElements(ANoeud,'Professeur');LElement.ListeMoyennesPeriodes=AXml.GetListeVariables(ANoeud,'MoyennePeriode');LElement.ListeAppreciations=AXml.GetListeElements(ANoeud,'Appreciation');LElement.OrdreRegroupement=AXml.GetVariable(ANoeud,'OrdreRegroupement');LElement.OrdreDansRegroupement=AXml.GetVariable(ANoeud,'OrdreDansRegroupement');LElement.DureeDesAbsences=AXml.GetVariable(ANoeud,'DureeDesAbsences');LElement.VolumeHoraire=AXml.GetVariable(ANoeud,'VolumeHoraire');LElement.Coefficient=AXml.GetVariable(ANoeud,'Coefficient');LElement.NombreDevoirs=AXml.GetVariable(ANoeud,'NombreDevoirs');LElement.ClassementEleve=AXml.GetVariable(ANoeud,'ClassementEleve');LElement.NombrePointsEleve=AXml.GetVariable(ANoeud,'NombrePointsEleve');LElement.Evolution=AXml.GetElement(ANoeud,'Evolution');LElement.MoyenneAnnuelle=AXml.GetVariable(ANoeud,'MoyenneAnnuelle');LElement.MoyenneEleve=AXml.GetVariable(ANoeud,'MoyenneEleve');LElement.MoyenneClasse=AXml.GetVariable(ANoeud,'MoyenneClasse');LElement.MoyenneInf=AXml.GetVariable(ANoeud,'MoyenneInf');LElement.MoyenneSup=AXml.GetVariable(ANoeud,'MoyenneSup');LElement.NombreNotesEntre=AXml.GetListeVariables(ANoeud,'NombreNotesEntre');LElement.SurMatiere=AXml.GetElement(ANoeud,'SurMatiere');LElement.AvecAppreciationParSousService=AXml.GetVariable(ANoeud,'AvecAppreciationParSousService');LElement.AvecLibelleEnseignantMatiereSurMemeLigne=AXml.GetVariable(ANoeud,'AvecLibelleEnseignantMatiereSurMemeLigne');LElement.AvecMoyenneRegroupement=AXml.GetVariable(ANoeud,'AvecMoyenneRegroupement');LElement.Editable=AXml.GetVariable(ANoeud,'Editable');LElement.Cloture=AXml.GetVariable(ANoeud,'Cloture');LElement.ECTS=AXml.GetVariable(ANoeud,'ECTS');LElement.nbECTSService=AXml.GetVariable(ANoeud,'nbECTSService');LElement.ECTSEditable=AXml.GetVariable(ANoeud,'ECTSEditable');LElement.moyenneProposee=AXml.GetVariable(ANoeud,'MoyenneProposee');LElement.moyProposeeEditable=AXml.GetVariable(ANoeud,'MoyProposeeEditable');LElement.moyProposeeCloture=AXml.GetVariable(ANoeud,'MoyProposeeCloture');LElement.moyenneDeliberee=AXml.GetVariable(ANoeud,'MoyenneDeliberee');LElement.moyDelibereeEditable=AXml.GetVariable(ANoeud,'MoyDelibereeEditable');LElement.moyDelibereeCloture=AXml.GetVariable(ANoeud,'MoyDelibereeCloture');var lEstService=P===0;var lNumeroSurMatiere=LElement.SurMatiere.GetNumero();if(LElement.SurMatiere.existeNumero()){if((this.tableauDebutRegroupement[lNumeroSurMatiere]===null||this.tableauDebutRegroupement[lNumeroSurMatiere]===undefined)||(LElement.OrdreDansRegroupement<this.tableauDebutRegroupement[lNumeroSurMatiere]))
this.tableauDebutRegroupement[lNumeroSurMatiere]=LElement.OrdreDansRegroupement;}
if(LElement.AvecMoyenneRegroupement&&lEstService&&LElement.SurMatiere.existeNumero()){if(this.tableauSurMatieres[lNumeroSurMatiere]===null||this.tableauSurMatieres[lNumeroSurMatiere]===undefined){this.tableauSurMatieres[lNumeroSurMatiere]={};this.tableauSurMatieres[lNumeroSurMatiere].tableauServices=[];}
this.tableauSurMatieres[lNumeroSurMatiere].tableauServices.push(LElement);}
if(AParametre){LElement.AddTri(LElement.OrdreRegroupement);LElement.AddTri(LElement.OrdreDansRegroupement);LElement.AddTri(LElement.Matiere.GetLibelle());if(LElement.ListeProfesseurs.GetNbrElements())
LElement.AddTri(LElement.ListeProfesseurs.GetLibelle(0));LElement.ListeElements=new ObjetListeElements();AXml.Parcourir(ANoeud,'Service',this,this.AjouterService,false,LElement.ListeElements,P+1);LElement.ListeElements.Trier();if(LElement.ListeElements.GetNbrElements())
this.Affichage.AvecSousService=true;else this.NbrMaxServices++;LElement.ListeDevoirs=new ObjetListeElements();AXml.Parcourir(ANoeud,'Devoir',this,this.AjouterDevoir,false,LElement.ListeDevoirs);LElement.ListeDevoirs.setTri([ObjetTri.init('Date',true),ObjetTri.init('Position')]);LElement.ListeDevoirs.trier();if(LElement.ListeElements.GetNbrElements()===0)
this.NbrMaxDevoirs=Math.max(this.NbrMaxDevoirs,LElement.ListeDevoirs.GetNbrElements());AParametre.AddElement(LElement);} else return LElement;};;
function ObjetRequetePageReleve(aPere,aEvenementSurReussite,aEvenementSurEchec){this.inheritedCreate(aPere,aEvenementSurReussite,aEvenementSurEchec);}
IE.Requetes.inscrire('PageReleve',ObjetRequetePageReleve,_ObjetRequeteResultat);ObjetRequetePageReleve.prototype.lancerRequete=function(aParam){var lParam={numeroEleve:0,numeroClasse:0,genrePeriode:0,numeroPeriode:0};$.extend(lParam,aParam);var P=this.XML;if(lParam.numeroClasse)
P.CreerCategorie(null,'Classe' ,null,lParam.numeroClasse);P.CreerCategorie(null,'Eleve' ,null,lParam.numeroEleve);P.CreerCategorie(null,'Periode' ,lParam.genrePeriode,lParam.numeroPeriode);this.appelAsynchroneConsultation();};ObjetRequetePageReleve.prototype.actionApresRequete=function(aXml){var lParam={aCopier:{},absences:{}};lParam.Message=aXml.GetVariable(null,'Message');if(!lParam.Message){lParam.aCopier.classe=aXml.GetElement(null,'Classe');this.CreerParametresAffichage(aXml);lParam.aCopier.Affichage=this.Affichage;this.CreerListeServices(aXml);lParam.aCopier.ServiceEditable=this.ServiceEditable;lParam.aCopier.ExisteDevoir=this.ExisteDevoir;lParam.aCopier.ExisteService=this.ExisteService;lParam.aCopier.NbrMaxServices=this.NbrMaxServices;lParam.aCopier.NbrMaxDevoirs=this.NbrMaxDevoirs;lParam.aCopier.tableauSurMatieres=this.tableauSurMatieres;lParam.aCopier.tableauDebutRegroupement=this.tableauDebutRegroupement;lParam.aCopier.ListeElements=this.ListeElements;this.CreerMoyenneGenerale(aXml);lParam.aCopier.MoyenneGenerale=this.MoyenneGenerale;$.extend(lParam.absences,new UtilitaireDeserialiserPiedBulletin().creerAbsences(aXml));lParam.aCopier.PiedDePage=new UtilitaireDeserialiserPiedBulletin().creerPiedDePage(aXml);}
this.callbackReussite.appel(lParam);};ObjetRequetePageReleve.prototype.AjouterDevoir=function(AXml,ANoeud,I,AParametre){this.ExisteDevoir=true;var LElement=AXml.GetElement(ANoeud);LElement.Date=AXml.GetVariable(ANoeud,'Date');LElement.Bareme=AXml.GetVariable(ANoeud,'Bareme');LElement.Coefficient=AXml.GetVariable(ANoeud,'Coefficient');LElement.Note=AXml.GetVariable(ANoeud,'Note');LElement.Commentaire=AXml.GetVariable(ANoeud,'Commentaire');LElement.estBonus=AXml.GetVariable(ANoeud,'EstBonus');LElement.estFacultatif=AXml.GetVariable(ANoeud,'EstFacultatif');var lNoteAffichee=AXml.GetVariable(ANoeud,'NoteAffichee');if(lNoteAffichee)
LElement.Note.setNoteAffichee(lNoteAffichee);var lMasque=AXml.GetVariable(ANoeud,'Masque','');if(lMasque)
LElement.Note.setMasque(lMasque);var lExecutionQCM=AXml.GetVariable(ANoeud,'ExcecutionQCM');if(lExecutionQCM){LElement.executionQCM=lExecutionQCM?new ObjetElement().fromJSON(lExecutionQCM):null;new ObjetDeserialiser()._ajouterQCM(lExecutionQCM,LElement.executionQCM);}
LElement.libelleCorrige=AXml.GetVariable(ANoeud,'LibelleCorrige');AParametre.AddElement(LElement);};;
MethodesObjet.heritagePrototype(PageResultatReleve,_PageResultatReleve);function PageResultatReleve(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.genreMessage=EGenreMessage.AucunRelevePourEleve;this.avecCorrige=true;}
PageResultatReleve.prototype.ConstruireInstances=function(){this.IdentCombo=this.Add(window.ObjetSaisiePN ,this.EvenementSurCombo,this.InitialiserCombo);this.IdentPage=this.Add(window.ObjetReleve,this.surEvenementReleve,this.InitialiserReleve);this.identPied=this.Add(window.PiedDeReleve);this.identFenetreMethodeCalculMoyenne=this.Add(window.ObjetFenetre_MethodeCalculMoyenne,null,this.initialiserMethodeCalculMoyenne);if(this.avecCorrige)
this.interfaceFicheVisu=this.Add(window.InterfaceFicheVisuEleveQCM,null,null);};PageResultatReleve.prototype.SetParametresGeneraux=function(){this.GenreStructure=EStructureAffichage.Autre;this.avecBandeau=true;this.AddSurZone=['',this.IdentCombo];this.IdentZoneAlClient=this.IdentPage;};PageResultatReleve.prototype.InitialiserReleve=function(aInstance){aInstance.setParametres(null,this.avecCorrige);};PageResultatReleve.prototype.InitialiserCombo=function(aInstance){aInstance.setOptions_ObjetSaisie({labelWAIZone:GTraductions.getValeur('WAI.ListeSelectionPeriode'),roleWAIEdit:EGenreRole.Option});};PageResultatReleve.prototype.EvenementSurCombo=function(aGenreEvenement,aElement){if(aGenreEvenement===EGenreEvenementObjetSaisie.selection){this.surModifContexteAffichage();GEtatUtilisateur.Navigation.SetRessource(EGenreRessource.Periode,aElement);var lParam={numeroEleve:GEtatUtilisateur.GetNumeroEleve(),genrePeriode:aElement.GetGenre(),numeroPeriode:aElement.GetNumero()};new ObjetRequetePageReleve(this,this.ActionSurRecupererBulletin).lancerRequete(lParam);}};PageResultatReleve.prototype.getParametresPDF=function(){var lResult={genreGenerationPDF:TypeHttpGenerationPDF.ReleveDeNotes,eleve:new ObjetElement('',GEtatUtilisateur.GetNumeroEleve()),periode:GEtatUtilisateur.Navigation.GetRessource(EGenreRessource.Periode)};return lResult;};PageResultatReleve.prototype.getParametresCalcul=function(aParamEvnt){return $.extend(this.inherited('getParametresCalcul',aParamEvnt),{libelleEleve:GEtatUtilisateur.GetLibelleEleve(),numeroEleve:GEtatUtilisateur.GetNumeroEleve(),libelleClasse:GEtatUtilisateur.Identification.GetLibelleClasse(),numeroClasse:GEtatUtilisateur.Identification.GetNumeroClasse()});};;
MethodesObjet.heritagePrototype(ObjetAgenda,Identite);function ObjetAgenda(ANom,AIdent,APere,AEvenement){this.inheritedCreate(ANom,AIdent,APere,AEvenement);this.idSelecteur=this.Nom+'_selecteur';this.idTable=this.Nom+'_Table';this.parametres={largeurSelecteur:2};this.ajouterEvenementGlobal(EEvent.SurPreResize,this._surPreResize);this.ajouterEvenementGlobal(EEvent.SurPostResize,this._surPostResize);}(function(){ObjetAgenda.prototype.ConstruireAffichage=function(){if(!this.DonneesRecues) return'';return this.ComposePage();};ObjetAgenda.prototype.SetDonnees=function(aParametres){var lParametres={NumeroSemaine:0,libelleImpression:'',listeEvenements:null};$.extend(lParametres,aParametres);this.numeroSemaine=lParametres.NumeroSemaine;this.LibelleImpression=lParametres.libelleImpression;this.listeEvenements=lParametres.listeEvenements;this.avecSaisie=GApplication.droits.get(IEEnum.droits.agenda.avecSaisieAgenda);this.selection=null;_traiterEvenements.bind(this)();var lcelluleDisponible=[],lEvenement;for(var J=0;J<this.listeEvenements.GetNbrElements();J++)
lcelluleDisponible[J]=new Array(true,true,true,true,true,true,true);for(var I=0;I<this.listeEvenements.GetNbrElements();I++){lEvenement=this.listeEvenements.GetElement(I);if(lEvenement.Existe()&&lEvenement.Visible){var lLigneDisponible= -1;for(J=0;(lLigneDisponible=== -1)&&(J<this.listeEvenements.GetNbrElements());J++){lLigneDisponible=J;for(var K=lEvenement.Debut;K<=lEvenement.Fin;K++)
if(!lcelluleDisponible[J][K])
lLigneDisponible= -1;if(lLigneDisponible>=0){lEvenement.Ligne=lLigneDisponible;lEvenement.Colonne=lEvenement.Debut;for(var l2=lEvenement.Debut;l2<=lEvenement.Fin;l2++)
lcelluleDisponible[J][l2]=false;}}}}
this.tableauEvenements=[];for(I=0;I<7;I++)
this.tableauEvenements[I]=[];for(I=0;I<this.listeEvenements.GetNbrElements();I++){lEvenement=this.listeEvenements.GetElement(I);if(lEvenement.Existe()&&lEvenement.Visible){if(this.tableauEvenements[lEvenement.Colonne]===null||this.tableauEvenements[lEvenement.Colonne]===undefined)
this.tableauEvenements[lEvenement.Colonne]=[];this.tableauEvenements[lEvenement.Colonne][lEvenement.Ligne]=lEvenement;}}
this.DonneesRecues=true;this._ids=[];this.Afficher();_positionnerSelecteur.bind(this)(false);_ajouterEventsAgendas.bind(this)();};function _traiterEvenements(){var lDateDebutSemaine=GDate.GetJour(IE.CyclesCompletSemaine.dateDebutCycle(this.numeroSemaine));var lDateFinSemaine=GDate.GetJour(IE.CyclesCompletSemaine.dateFinCycle(this.numeroSemaine));var lPremierJour=GDate.GetJourDeSemaine(lDateDebutSemaine);for(var I=0,lNb=this.listeEvenements.GetNbrElements();I<lNb;I++){var lEvenement=this.listeEvenements.GetElement(I);if(lEvenement.Existe()){lEvenement.Visible=!((GDate.GetJour(lEvenement.DateDebut)>lDateFinSemaine)||(GDate.GetJour(lEvenement.DateFin)<lDateDebutSemaine));lEvenement.DebordementDebut=lEvenement.DateDebut<lDateDebutSemaine&&!GDate.estJourEgal(lEvenement.DateDebut,lDateDebutSemaine);lEvenement.DebordementFin=lEvenement.DateFin>=lDateFinSemaine&&!GDate.estJourEgal(lEvenement.DateFin,lDateFinSemaine);if(lEvenement.DebordementDebut)
lEvenement.Debut=0;else{lEvenement.Debut=GDate.GetJourDeSemaine(lEvenement.DateDebut)-lPremierJour;if(lEvenement.Debut<0)
lEvenement.Debut=7+lEvenement.Debut;}
if(lEvenement.DebordementFin)
lEvenement.Fin=6;else{lEvenement.Fin=GDate.GetJourDeSemaine(lEvenement.DateFin)-lPremierJour;if(lEvenement.Fin<0)
lEvenement.Fin=7+lEvenement.Fin;}
lEvenement.Duree=lEvenement.Fin-lEvenement.Debut+1;}}}
function _ajouterEventsAgendas(){if(!this.avecSaisie) return;for(var i in this._ids){var lId=this._ids[i];var lElement=$('#'+lId.escapeJQ());lElement.mouseup({instance:this},_surMouseUpAgenda);lElement.bind('contextmenu',function(event){event.stopPropagation();return false;});}}
function _surMouseUpAgenda(event){event.stopPropagation();var lInstance=event.data.instance;var lId=this.id;var lTabId=lId.split('_');var lItem=lTabId[lTabId.length-1];var lJour=lTabId[lTabId.length-3];var lAgenda=lInstance.tableauEvenements[lJour][lItem];_positionnerSelecteur.bind(lInstance)(true,lJour,lItem);lInstance.selection={agenda:lAgenda,jour:lJour,item:lItem};lInstance.callback.appel({selection:{agenda:lAgenda},sourisDroite:GNavigateur.estSourisBoutonDroit()});}
ObjetAgenda.prototype.focusAgenda=function(aEvent,aId,aI,aJ){_positionnerSelecteur.bind(this)(true,aI,aJ);};ObjetAgenda.prototype.keyUpAgenda=function(aEvent,aId,aI,aJ){this.NavigationClavier(aId);if(GNavigateur.IsToucheFleche()||GNavigateur.IsToucheSelection()) GNavigateur.StopperEvenement(aEvent);var lAgenda=this.tableauEvenements[aI][aJ];this.selection={agenda:lAgenda,jour:aI,item:aJ};if(GNavigateur.IsToucheSelection()||GNavigateur.IsToucheMenuContextuel()){GNavigateur.positionnerMenuContextuelSurId(aId,0,0);this.Pere.selection={agenda:lAgenda};this.callback.appel({selection:{agenda:lAgenda},sourisDroite:GNavigateur.IsToucheMenuContextuel()});}};ObjetAgenda.prototype.ComposePage=function(APourImpression){var H=[],lJ,I,lDateJour,lStyle;var LTabIndex=APourImpression?'tabIndex="-1"':'tabIndex="0"';this.IdPremierElement=this.Nom+'_Agenda_Div';H.push('<div ',GObjetWAI.composeAttribut({genre:EGenreAttribut.label,valeur:GTraductions.getValeur('Agenda.AgendaDe')+' '+GEtatUtilisateur.GetLibelleEleve()+'. '+GObjetWAI.getInfo(EGenreObjet.Tableau)}),' style="width: 100%; max-height:100%; height: 100%;" id="'+this.IdPremierElement+'" align="center" '+LTabIndex+' '+GObjetWAI.composeRole(EGenreRole.Grid)+' onfocus="'+this.Nom+'.DoTableau (0)">');H.push('<div id="',this.idSelecteur,'_l" style="position:absolute ;z-index:1; display:none;',GStyle.composeWidth(this.parametres.largeurSelecteur),GStyle.composeCouleurFond(GCouleur.selection.getFond()),'"></div>','<div id="',this.idSelecteur,'_r" style="position:absolute ;z-index:1; display:none;',GStyle.composeWidth(this.parametres.largeurSelecteur),GStyle.composeCouleurFond(GCouleur.selection.getFond()),'"></div>','<div id="',this.idSelecteur,'_t" style="position:absolute ;z-index:1; display:none;',GStyle.composeHeight(this.parametres.largeurSelecteur),GStyle.composeCouleurFond(GCouleur.selection.getFond()),'"></div>','<div id="',this.idSelecteur,'_b" style="position:absolute ;z-index:1; display:none;',GStyle.composeHeight(this.parametres.largeurSelecteur),GStyle.composeCouleurFond(GCouleur.selection.getFond()),'"></div>');H.push('<table id="',this.idTable,'" class="Tableau" style="width: 100%; height: 100%; '+GTableau.styleTableau(APourImpression,true)+'" border="0" cellpadding="0" cellspacing="0" onmouseup="',this.Nom,'.mouseUpGrille ()">');H.push('<tr>');var LIdPrecedent='';for(I=0;I<7;I++){var LId=this.Nom+'_Jour_'+I;if(LIdPrecedent!=='')
this.AjouterAuTableaux(LIdPrecedent,LId,EGenreDirection.DeuxSenses);LIdPrecedent=LId;H.push('<td class="Tableau_Titre Titre" style="width: 10%;'+GTableau.styleTitre(APourImpression)+'">');H.push(this.ComposeElementNavigation(LId,GDate.FormatDate(IE.CyclesCompletSemaine.jourCycleEnDate(I,this.numeroSemaine),'%JJJJ %J'),EGenreRole.Columnheader,this.Nom+'.keyUpGrille(event,id,'+I+');',null,null));H.push('</td>');}
H.push('</tr>');var lNomsVacances=[],lJourF;for(I=0;I<7;I++){lJourF=_jourFerie.call(this,I);if(lJourF&&lJourF.nom){lNomsVacances[I]=lJourF.nom;}}
if(lNomsVacances.length>0){H.push('<tr>');for(I=0;I<7;I++){H.push('<td class="Tableau_Colonne PetitEspace Gras" style="',_getStyleCelluleSansEvenement.call(this,I,APourImpression),'">',lNomsVacances[I]?lNomsVacances[I]:'&nbsp;','</td>');}
H.push('</tr>');}
for(var J=0;J<this.listeEvenements.GetNbrElements();J++){var lExisteEvenement=false;for(I=0;I<7;I++)
if(this.tableauEvenements[I][J])
lExisteEvenement=true;if(lExisteEvenement){H.push('<tr>');for(I=0;I<7;I++){lDateJour=IE.CyclesCompletSemaine.jourCycleEnDate(I,this.numeroSemaine);lStyle=lDateJour<GParametres.PremiereDate||lDateJour>GParametres.DerniereDate?GStyle.composeCouleurFond(GCouleur.fond):'';if(this.tableauEvenements[I][J]){var LColor=GCouleur.getCouleurCorrespondance(this.tableauEvenements[I][J].CouleurCellule);H.push('<td class="Tableau_Colonne" style="',GTableau.styleCellule(APourImpression,true,EGenreBordure.droite),lStyle,'" colspan="'+this.tableauEvenements[I][J].Duree+'" valign="top" align="left">');var LIdAgendaPrecedent;if(J===0) LIdAgendaPrecedent=this.Nom+'_Jour_'+I;else{lJ=J;while(lJ>0&&!this.tableauEvenements[I][lJ-1]) lJ--;LIdAgendaPrecedent=(lJ===0)?this.Nom+'_Jour_'+I:this.Nom+'_Jour_'+I+'_Item_'+(lJ-1);}
var LIdAgenda=this.Nom+'_Jour_'+I+'_Item_'+J;this._ids.push(LIdAgenda);if(LIdAgendaPrecedent!==''){this.AjouterAuTableaux(LIdAgendaPrecedent,LIdAgenda,null,EGenreDirection.DeuxSenses);if(I!==6) this.AjouterAuTableaux(LIdAgenda,this.Nom+'_Jour_'+(I+1),EGenreDirection.SensNormal);if(I!==0) this.AjouterAuTableaux(this.Nom+'_Jour_'+(I-1),LIdAgenda,EGenreDirection.SensInverse);}
var S='';var labelS='';S+='<div style="width: 100%; background-color:'+this.tableauEvenements[I][J].CouleurCellule+'">';S+='<table class="Texte10" border="0" cellpadding="0" cellspacing="0"><tr>';if(this.tableauEvenements[I][J].DebordementDebut)
S+=this.ComposePoints(LColor);S+='<td class="PetitEspace AlignementHaut" style="height: 74px;'+GStyle.composeCouleurTexte(LColor)+'">';if(!this.tableauEvenements[I][J].publie)
S+='<span class="InlineBlock"><div class="Image_NonPublie PetitEspaceDroit"></div></span>';var lTab=this.listeEvenements._getLibelleEvenement({evenement:this.tableauEvenements[I][J],avecTitre:true,avecDateDuJour:false,avecDetailConseil:true});for(var K=0;K<lTab.length;K++)
if(lTab[K]&&(lTab.length>0)){S+='<span class="'+(K===0?'Gras':'')+'">'+lTab[K]+'</span><br>';labelS+=lTab[K]+' ';}
var lEvenement=this.tableauEvenements[I][J];if(!APourImpression&&(lEvenement.listeDocJoints.GetNbrElements()>0)){for(K=0;K<lEvenement.listeDocJoints.GetNbrElements();K++){var lDocJoint=lEvenement.listeDocJoints.GetElement(K);if(lDocJoint.Existe()){S+='<div class="Image_Insertion_PieceJointe_hover InlineBlock'+(lDocJoint.Url?' AvecMain':'')+'" style="margin-top:3px; margin-right:5px;" title="'+GChaine.toTitle(lDocJoint.GetLibelle())+'"'+(lDocJoint.Url?' onclick="'+this.Nom+'.ouvrirDocJoint('+I+','+J+','+K+')"':'')+'>&nbsp;</div>';labelS+=GChaine.toTitle(lEvenement.listeDocJoints.GetElement(K).GetLibelle())+' ';}}}
S+='</td>';if(this.tableauEvenements[I][J].DebordementFin)
S+=this.ComposePoints(LColor);S+='</tr>';S+='</table>';if(this.tableauEvenements[I][J].listeEleves){S+='<div class="PetitEspaceGauche PetitEspaceDroit PetitEspaceBas AlignementDroit" style="'+GStyle.composeCouleurTexte(LColor)+'">';S+=GChaine.AvecEspaceSiVide(this.tableauEvenements[I][J].listeEleves.join(', '));S+='</div>';}
S+='</div>';H.push(this.ComposeElementNavigation(LIdAgenda,S,EGenreRole.Gridcell,this.Nom+'.keyUpAgenda(event,id,'+I+','+J+');',null,this.Nom+'.focusAgenda(event,id,'+I+','+J+');',null,null,null,null,labelS));H.push('</td>');I+=Math.max(0,parseInt(this.tableauEvenements[I][J].Duree)-1);}
else{H.push('<td class="Tableau_Colonne" style="',_getStyleCelluleSansEvenement.call(this,I,APourImpression),lStyle,'">&nbsp;</td>');}}
H.push('</tr>');}}
H.push('<tr>');for(I=0;I<7;I++){if(I===0)
H.push('<td id="',this.getIdResize(),'" class="Tableau_Colonne PetitEspace" style="',_getStyleCelluleSansEvenement.call(this,I,APourImpression),'">&nbsp;</td>');else H.push('<td class="Tableau_Colonne PetitEspace" style="',_getStyleCelluleSansEvenement.call(this,I,APourImpression),'">&nbsp;</td>');}
H.push('</tr>');H.push('</table>');H.push('</div>');return H.join('');};function _jourFerie(aIndiceJour){var lDateJour=IE.CyclesCompletSemaine.jourCycleEnDate(aIndiceJour,this.numeroSemaine),lResult=null;GParametres.listeJoursFeries.parcourir(function(aFerie){if((aFerie.dateDebut<lDateJour&&aFerie.dateFin>lDateJour)||GDate.estJourEgal(lDateJour,aFerie.dateDebut)||GDate.estJourEgal(lDateJour,aFerie.dateFin)){lResult={};if(aFerie.GetLibelle()&&(GDate.estJourEgal(lDateJour,aFerie.dateDebut)||(aIndiceJour===0&&aFerie.dateDebut<lDateJour)))
lResult.nom=aFerie.GetLibelle();return false;}});return lResult;}
function _getStyleCelluleSansEvenement(aIndiceJour,APourImpression){var lDateJour=IE.CyclesCompletSemaine.jourCycleEnDate(aIndiceJour,this.numeroSemaine),lHorsGrille=lDateJour<GParametres.PremiereDate||lDateJour>GParametres.DerniereDate;return GStyle.composeCouleur(lHorsGrille?GCouleur.fond:!!_jourFerie.call(this,aIndiceJour)?GCouleur.themeCouleur.claire:GCouleur.liste.getFond(APourImpression),GCouleur.liste.getTexte(APourImpression))+GStyle.composeCouleurBordure(GCouleur.liste.getBordure(APourImpression),1,EGenreBordure.droite);}
ObjetAgenda.prototype.mouseUpGrille=function(){if(!this.avecSaisie) return;var lTable=$('#'+this.idTable.escapeJQ());var lHeightTable=lTable.height();var lPositionTable=lTable.position();if(GNavigateur.SourisY>lPositionTable.top+lHeightTable)
return;if(GNavigateur.SourisX<lPositionTable.left)
return;if(GNavigateur.SourisX>lPositionTable.left+lTable.width())
return;for(var I=0;I<7;I++){var LId=this.Nom+'_Jour_'+I;var lElement=$('#'+LId.escapeJQ());var lPositionTitre=lElement.position();var lWidthTitre=lElement.outerWidth();if(GNavigateur.SourisY<lPositionTitre.top)
return;if((GNavigateur.SourisX>=lPositionTitre.left)&&(GNavigateur.SourisX<lPositionTitre.left+lWidthTitre)){var lDateJour=IE.CyclesCompletSemaine.jourCycleEnDate(I,this.numeroSemaine);if(lDateJour<GParametres.PremiereDate||lDateJour>GParametres.DerniereDate){return;}
_positionnerSelecteur.bind(this)(true,I);this._clickJour=true;this.selection={jour:I};this.callback.appel({selection:this.selection,sourisDroite:GNavigateur.estSourisBoutonDroit()});return;}}};ObjetAgenda.prototype.keyUpGrille=function(aEvent,aId,aI){this.NavigationClavier(aId);if(GNavigateur.IsToucheFleche()||GNavigateur.IsToucheSelection()) GNavigateur.StopperEvenement(aEvent);if(!this.avecSaisie) return;if(GNavigateur.IsToucheSelection()||GNavigateur.IsToucheMenuContextuel()){this._clickJour=true;this.selection={jour:aI};this.Pere.selection={jour:aI};GNavigateur.positionnerMenuContextuelSurId(aId,0,0);this.callback.appel({selection:this.selection,sourisDroite:GNavigateur.IsToucheMenuContextuel()});return;}};function _positionnerSelecteur(aAfficher,aJour,aItem){if(!this.avecSaisie)
aAfficher=false;var lSelecteurTop=$('#'+this.idSelecteur.escapeJQ()+'_t');var lSelecteurBottom=$('#'+this.idSelecteur.escapeJQ()+'_b');var lSelecteurLeft=$('#'+this.idSelecteur.escapeJQ()+'_l');var lSelecteurRight=$('#'+this.idSelecteur.escapeJQ()+'_r');if(aAfficher){var lValeur={},lElement,LIdAgenda,LId,lTable,lPosition;if(aJour>=0&&aItem>=0){LIdAgenda=this.Nom+'_Jour_'+aJour+'_Item_'+aItem;lElement=$('#'+LIdAgenda.escapeJQ());lPosition=lElement.position();lValeur.top=lPosition.top;lValeur.left=lPosition.left;lValeur.width=lElement.outerWidth();lValeur.height=lElement.outerHeight();}
else if(aJour>=0&&(aItem===undefined)){lTable=$('#'+this.idTable.escapeJQ());LId=this.Nom+'_Jour_'+aJour;lElement=$('#'+LId.escapeJQ());var lElementTr=$(GHtml.getParent(lElement[0]));lPosition=lElementTr.position();var lHeightTitre=lElementTr.outerHeight(true);lValeur.top=lPosition.top+lHeightTitre;lValeur.left=lPosition.left;lValeur.width=lElementTr.outerWidth();lValeur.height=lTable.innerHeight()-lHeightTitre;}
GPosition.setPosition(lSelecteurTop[0],lValeur.left,lValeur.top);lSelecteurTop.width(lValeur.width);GPosition.setPosition(lSelecteurBottom[0],lValeur.left,lValeur.top+lValeur.height-this.parametres.largeurSelecteur);lSelecteurBottom.width(lValeur.width);GPosition.setPosition(lSelecteurLeft[0],lValeur.left,lValeur.top+this.parametres.largeurSelecteur);lSelecteurLeft.height(lValeur.height-2*this.parametres.largeurSelecteur);GPosition.setPosition(lSelecteurRight[0],lValeur.left+lValeur.width-this.parametres.largeurSelecteur,lValeur.top+this.parametres.largeurSelecteur);lSelecteurRight.height(lValeur.height-2*this.parametres.largeurSelecteur);}
GHtml.setDisplay(lSelecteurTop[0],aAfficher);GHtml.setDisplay(lSelecteurBottom[0],aAfficher);GHtml.setDisplay(lSelecteurLeft[0],aAfficher);GHtml.setDisplay(lSelecteurRight[0],aAfficher);}
ObjetAgenda.prototype.getIdResize=function(){return this.Nom+'_Res';};ObjetAgenda.prototype.getIdDocJoint=function(i,j,k){return this.Nom+'_DJ_'+i+'_'+j+'_'+k;};ObjetAgenda.prototype.DoTableau=function(I){var LId=this.Nom+'_Jour_'+I;GHtml.setFocus(LId);};ObjetAgenda.prototype.ComposePoints=function(AColor){return'<td class="AlignementHaut PetitEspace"><font color="'+AColor+'">...</font></td>';};ObjetAgenda.prototype.ouvrirDocJoint=function(I,J,K){var lEvenement=this.tableauEvenements[I][J];var lDocJoint=lEvenement.listeDocJoints.GetElement(K);window.open(GChaine.GetChainePourUrl(lDocJoint.Url,true));};ObjetAgenda.prototype.resize=function(){GPosition.declencherResize(this.getIdResize(),(IE.Support.bordureExterneTD?0:-6)-2);};ObjetAgenda.prototype._surPreResize=function(){if(this.selection&&this.avecSaisie){$('[id^="'+this.idSelecteur.escapeJQ()+'"]').hide();}};ObjetAgenda.prototype._surPostResize=function(){if(this.selection&&this.avecSaisie){$('[id^="'+this.idSelecteur.escapeJQ()+'"]').show();_positionnerSelecteur.bind(this)(true,this.selection.jour,this.selection.item);}};})();;
var EGenreICal={EDT:0,Agenda:1};;
MethodesObjet.heritagePrototype(_ObjetFenetre_ICal,ObjetFenetre);function _ObjetFenetre_ICal(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.idHrefICal=this.Nom+'_lien';this.idLienPermanent=this.idHrefICal+'_permanent';this.idQRCode=this.idHrefICal+'_qrcode';this.genreICal=EGenreICal.EDT;}
_ObjetFenetre_ICal.prototype.setGenreICal=function(aGenre){this.genreICal=aGenre;};_ObjetFenetre_ICal.prototype.SetDonnees=function(aElement,aParametreExportICal,aGenreRessource,aDomaine,aFiltre){this.element=aElement;this.ParametreExportICal=aParametreExportICal;this.genreRessource=aGenreRessource;this.domaine=(aDomaine!==null&&aDomaine!==undefined)?aDomaine:0;this.filtre=aFiltre;this.semainesPubliees=true;this.fuseauHoraire=this.getValeurFuseauHoraireParDefaut();GHtml.setCheckBox(this.Nom+'SemainesPubliees' ,true);this.setLien();this.Afficher();$('#'+this.Nom.escapeJQ()+' input').jIECheckBox();};_ObjetFenetre_ICal.prototype.getValeurFuseauHoraireParDefaut=function(){return 1;};_ObjetFenetre_ICal.prototype.setLien=function(){;};_ObjetFenetre_ICal.prototype.ComposeContenu=function(){var T=[];T.push('<table class="Texte10 Espace" width="100%" border="0" cellpadding="0" cellspacing="0">');T.push('<tr><td class="Gras">',this.getTraductionsSousTitre1(),'</td></tr>');T.push('<tr><td class="EspaceHaut10 GrandEspaceGauche">','<div class="AvecMain" onclick="',this.Nom ,'.surSelectRadioSemaines (true)">','<input ',GObjetWAI.composeAttribut({genre:EGenreAttribut.label,valeur:this.getTraductionsSousTitre1()+' '+GTraductions.getValeur('iCal.fenetre.semainesPubliees')}),' id="',this.Nom,'SemainesPubliees" type=radio name="Semaines" value="true"/>&nbsp;',GTraductions.getValeur('iCal.fenetre.semainesPubliees'),'</div>','<div class="AvecMain" onclick="'+this.Nom+'.surSelectRadioSemaines (false)">','<input ',GObjetWAI.composeAttribut({genre:EGenreAttribut.label,valeur:GTraductions.getValeur('iCal.fenetre.sousTitre1')+' '+GTraductions.getValeur('iCal.fenetre.semainesSelectionnees')}),' id="'+this.Nom+'SemainesSelectionnees" type=radio name="Semaines" value="false"/>&nbsp;'+GTraductions.getValeur('iCal.fenetre.semainesSelectionnees'),'</div>','</td></tr>');T.push('<tr><td class="Gras EspaceHaut10">',this.getTraductionsSousTitre2(),'</td></tr>');T.push('<tr><td class="EspaceHaut10">','-&nbsp;',this.getTraductionsTitreFichier(),'</td></tr>');T.push('<tr><td class="GrandEspaceGauche"><a id="',this.idHrefICal,'" target="_blank" href="',this.href,'" ',GObjetWAI.composeAttribut({genre:EGenreAttribut.label,valeur:this.getTraductionsSousTitre2()+' '+this.getTraductionsICalExporter()}),'>',this.getTraductionsICalExporter(),'</a>','</td></tr>');T.push('<tr><td class="EspaceHaut10">','-&nbsp;',this.getTraductionsTitreLienPermanent(),'</td></tr>');T.push('<tr><td id="'+this.idLienPermanent+'_td" class="PetitEspaceHaut">','<input type="text" class="Fenetre_Bordure Texte10" style="width:100%; height: 18px; margin:0px; padding-left: 3px; padding-right: 3px;',GStyle.composeBordureArrondi(3),'" ',GObjetWAI.composeAttribut({genre:EGenreAttribut.label,valeur:this.getTraductionsTitreLienPermanent()}),' id="',this.idLienPermanent,'" onclick="this.select()" value=',this.href?GChaine.GetChainePourUrl(this.href,true):'',' readonly/>','</td></tr>');T.push('<tr><td class="EspaceHaut10">',this.getTraductionsQRCode(),'</td></tr>');T.push('<tr><td id="'+this.idQRCode+'_td" class="PetitEspaceHaut">','<div style="width:175px; height: 175px; margin:0px auto; background-color:#fff;" id="',this.idQRCode,'"></div>','</td></tr>');T.push('</table>');return T.join('');};_ObjetFenetre_ICal.prototype.getTraductionsSousTitre1=function(){return GTraductions.getValeur('iCal.fenetre.sousTitre1');};_ObjetFenetre_ICal.prototype.getTraductionsSousTitre2=function(){return GTraductions.getValeur('iCal.fenetre.sousTitre2');};_ObjetFenetre_ICal.prototype.getTraductionsICalExporter=function(){return GTraductions.getValeur('iCal.hint');};_ObjetFenetre_ICal.prototype.getTraductionsTitreFichier=function(){return GTraductions.getValeur('iCal.fenetre.titreFichier');};_ObjetFenetre_ICal.prototype.getTraductionsTitreLienPermanent=function(){return GTraductions.getValeur('iCal.fenetre.titreLienPermanent');};_ObjetFenetre_ICal.prototype.getTraductionsQRCode=function(){return GTraductions.getValeur('iCal.fenetre.QRCode');};_ObjetFenetre_ICal.prototype.surSelectRadioSemaines=function(aValue){GHtml.setCheckBox(this.Nom+'SemainesPubliees' ,aValue);GHtml.setCheckBox(this.Nom+'SemainesSelectionnees',!aValue);this.semainesPubliees=aValue;this.setLien();};_ObjetFenetre_ICal.prototype.getPrefixICal=function(){switch(this.genreICal){case EGenreICal.EDT:return'Edt';case EGenreICal.Agenda:return'Agenda';default:;break;}
return'';};_ObjetFenetre_ICal.prototype.SurAfficher=function(){};;

MethodesObjet.heritagePrototype(ObjetFenetre_ICal,_ObjetFenetre_ICal);function ObjetFenetre_ICal(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.avecTailleSelonContenu=true;}
ObjetFenetre_ICal.prototype.setLien=function(){var lInformationMasquee='icalsecurise='+this.ParametreExportICal+'&version='+GParametres.versionPN;var lParams='fh='+this.fuseauHoraire;if(!this.semainesPubliees)
lParams+='&d='+GChaine.domaineToStr(GEtatUtilisateur.GetDomaineSelectionne());if(this.genreICal)
lParams+='&o='+this.genreICal;var lLibelle=GChaine.enleverEntites(this.element.GetLibelle());lLibelle=GChaine.latinize(lLibelle);lLibelle=lLibelle.replace(/[^a-zA-Z0-9]/g,"_");var lHref='ical/'+this.getPrefixICal()+'_'+lLibelle+'.ics';lHref=lHref+'?'+(lInformationMasquee)+'&param='+forge.util.createBuffer(lParams).toHex();GHtml.setLien(this.idHrefICal,lHref);GHtml.setValue(this.idLienPermanent,GChaine.GetChainePourUrl(GNavigateur.getHost()+lHref,true));$('#'+this.idQRCode.escapeJQ()).html('').qrcode({render:'div',size:175,text:GNavigateur.getHost()+lHref});};ObjetFenetre_ICal.prototype.getTraductionsSousTitre2=function(){return GTraductions.getValeur('iCal.fenetre.sousTitre2')[this.genreICal];};ObjetFenetre_ICal.prototype.getTraductionsICalExporter=function(){return GTraductions.getValeur('iCal.hint')[this.genreICal];};ObjetFenetre_ICal.prototype.getTraductionsTitreFichier=function(){return GTraductions.getValeur('iCal.fenetre.titreFichier')[this.genreICal];};ObjetFenetre_ICal.prototype.getTraductionsTitreLienPermanent=function(){return GTraductions.getValeur('iCal.fenetre.titreLienPermanent')[this.genreICal];};;

function _Cache(){this._actif=true;this._donnees=[];}
_Cache.prototype.setActif=function(aActif){this._actif=aActif;};_Cache.prototype.getActif=function(){if(GApplication.getDebug()&&GApplication.getDebug().optionsDebug&&GApplication.getDebug().optionsDebug.desactiver_Cache)
return false;return this._actif;};_Cache.prototype.getCle=function(aTableauElements){var lCle='';for(var i=0;i<aTableauElements.length;i++)
lCle+=aTableauElements[i].getCle();return lCle;};_Cache.prototype.vider=function(aCle){if(aCle){if(this.existeDonnee(aCle)){this.effacer(aCle);}} else{this._donnees=[];}};_Cache.prototype.effacer=function(aCle){var x;var tmpArray=[];for(x in this._donnees){if(x!==aCle){tmpArray[x]=this._donnees[x];}}
this._donnees=tmpArray;};_Cache.prototype.existeDonnee=function(aCle){if(GApplication.getDebug()&&GApplication.getDebug().optionsDebug&&GApplication.getDebug().optionsDebug.desactiver_Cache)
return false;if(!this.getActif()) return false;return(this._donnees[aCle]!==undefined);};_Cache.prototype.getDonnee=function(aCle){;return this._donnees[aCle];};_Cache.prototype.setDonnee=function(aCle,aObjetDonnee){this._donnees[aCle]=aObjetDonnee;};;
MethodesObjet.heritagePrototype(Cache,_Cache);function Cache(){this.inheritedCreate();this._init();}
Cache.prototype._init=function(){this.general=new _Cache();this.ficheScolaire=new _Cache();this.resultatsClasses=new _Cache();this.dossierVS=new _Cache();this.agenda=new _Cache();this.livretScolaire=new _Cache();this.creneauxLibres=new _Cache();};Cache.prototype.reset=function(){this._init();};var GCache=new Cache();;
function ObjetRequetePageAgenda(aPere,aEvenementSurReussite,aEvenementSurEchec){this.inheritedCreate(aPere,aEvenementSurReussite,aEvenementSurEchec);}
IE.Requetes.inscrire('PageAgenda',ObjetRequetePageAgenda,_ObjetRequeteXmlConsultationPN);(function(){ObjetRequetePageAgenda.prototype.lancerRequete=function(aNumeroSemaine){this.JSON={NumeroSemaine:aNumeroSemaine,AvecListeClasses:window.GCache&&!GCache.agenda.existeDonnee('listeClassesGroupes')};this.numeroSemaine=aNumeroSemaine;this.appelAsynchroneConsultation();};ObjetRequetePageAgenda.prototype.actionApresRequete=function(aXml){var lParam={DomaineDePresence:this.JSONReponse.DomaineDePresence,ListeClassesGroupes:null,parametreExportICal:this.JSONReponse.ParametreExportiCal,avecExportICal:this.JSONReponse.AvecExportiCal};lParam.listeEvenements=new ObjetDeserialiser().getListeEvenements(this.JSONReponse.ListeEvenements);if(window.GCache){if(this.JSONReponse.ListeClassesGroupes){lParam.listeClassesGroupes=new ObjetListeElements().fromJSON(this.JSONReponse.ListeClassesGroupes,_ajouterClassesGroupes.bind(this));GCache.agenda.setDonnee('listeClassesGroupes',lParam.listeClassesGroupes);}
else if(GCache.agenda.existeDonnee('listeClassesGroupes'))
lParam.listeClassesGroupes=GCache.agenda.getDonnee('listeClassesGroupes');}
this.callbackReussite.appel(lParam);};function _ajouterClassesGroupes(aJSON,aElement){if(aJSON.niveau)
aElement.niveau=aJSON.niveau?new ObjetElement().fromJSON(aJSON.niveau):null;if(aJSON.EPeda)
aElement.equipePedagogique=new ObjetListeElements().fromJSON(aJSON.EPeda);}})();;
MethodesObjet.heritagePrototype(ObjetAffichagePageAgenda,ObjetInterfacePage);function ObjetAffichagePageAgenda(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.donnees={NumeroSemaine:0,libelleImpression:'',listeEvenements:null};}(function(){ObjetAffichagePageAgenda.genreMenuContextuel={creation:0,modification:1,suppression:2,copier:3,coller:4};ObjetAffichagePageAgenda.prototype.ConstruireInstances=function(){this.IdentCalendrier=this.Add(window.ObjetCalendrier ,this.EvenementSurCalendrier ,this.InitialiserCalendrier);this.IdPremierElement=this.GetInstance(this.IdentCalendrier).getPremierElement();this.IdentAgenda=this.Add(window.ObjetAgenda ,_evenementSurAgenda.bind(this) ,null);this.IdentICal=this.Add(window.ObjetBoutonBandeau,this.evenementSurICal,this.initialiserICal);this.IdentFenetreICal=this.addFenetre(window.ObjetFenetre_ICal ,this.evenementSurFenetreICal,this.initialiserFenetreICal);if(MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Professeur,EGenreEspace.Etablissement])){this.identMenuContextuel=this.Add(window.ObjetMenuContextuel ,_evenementSurMenuContextuel.bind(this) ,null);this.identFenetreSaisieAgenda=this.addFenetre(window.ObjetFenetre_SaisieAgenda,_evenementFenetreSaisieAgenda.bind(this),_initialiserFenetreSaisieAgenda);this.identEditionPieceJointe=this.Add(window.ObjetFenetre_PieceJointe,_evenementEditionDocumentJoint.bind(this),_initialiserEditionPieceJointe);this.idInputFile=this.addFenetre(window.ObjetInputFile ,_evenementInputFile.bind(this));}};ObjetAffichagePageAgenda.prototype.DetruireInstances=function(){if(window.GCache)
GCache.agenda.vider();};ObjetAffichagePageAgenda.prototype.SetParametresGeneraux=function(){this.avecBandeau=true;this.IdentZoneAlClient=this.IdentAgenda;if(MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Professeur,EGenreEspace.Eleve,EGenreEspace.Parent,EGenreEspace.Etablissement]))
this.AddSurZone.push({ident:this.IdentICal,alignementDroite:true});};function _initialiserFenetreSaisieAgenda(aInstance){aInstance.setOptionsFenetre({largeur:500});}
function _initialiserEditionPieceJointe(aInstance){aInstance.SetParametres_Fenetre('',500,450,new Array(GTraductions.getValeur('principal.fermer')));}
ObjetAffichagePageAgenda.prototype.initialiserFenetreICal=function(aInstance){aInstance.SetParametres_Fenetre(GTraductions.getValeur('iCal.fenetre.titre'),425,265,new Array(GTraductions.getValeur('Fermer')));aInstance.setTraductions(GTraductions.getValeur('iCal'));aInstance.setGenreICal(EGenreICal.Agenda);};ObjetAffichagePageAgenda.prototype.initialiserICal=function(aInstance){var lTraduction=GTraductions.getValeur('iCal.hint')[EGenreICal.Agenda];aInstance.SetParametres('Image_IcalDownload',true,false,true,[lTraduction,lTraduction],20,false);aInstance.SetVisible(false);};ObjetAffichagePageAgenda.prototype.InitialiserCalendrier=function(AInstance){AInstance.SetParametres(GParametres.PremierLundi,GParametres.DerniereDate,false,GParametres.conserverNumerosCalendaires,null,null,IE.CyclesCompletSemaine);AInstance.setTraductions(GTraductions.getValeur('MoisCourt'),GTraductions.getValeur('Semaine'),GTraductions.getValeur('Du'),GTraductions.getValeur('Au'));AInstance.SetControleNavigation(true);};ObjetAffichagePageAgenda.prototype.RecupererDonnees=function(){this.AfficherPage();if(this.idInputFile) this.GetInstance(this.idInputFile).setDonnees({guid:this.Nom,genrePJ:EGenreDocumentJoint.Fichier,maxSize:GApplication.droits.get(IEEnum.droits.tailleMaxDocJointEtablissement),maxFiles:0,elements:[]});};ObjetAffichagePageAgenda.prototype.AfficherPage=function(){window.Invocateur.evenement(window.Invocateur.events.activationImpression,EGenreImpression.Normale,this);this.SetEtatSaisie(false);this.selection=null;this.GetInstance(this.IdentCalendrier).SetSelection(GEtatUtilisateur.GetSemaineSelectionnee());};ObjetAffichagePageAgenda.prototype.EvenementSurCalendrier=function(ASelection,AObjSelection,AGenreDomaine,aEstDansPeriodeConsultation,AIsToucheSelection){GHtml.setDisplay(this.GetInstance(this.IdentICal).GetNom(),this.parametreExportICal);if(AIsToucheSelection){this.Instances[this.IdentAgenda].FocusSurPremierElement();} else{if((ASelection!==null&&ASelection!==undefined))
this.donnees.NumeroSemaine=ASelection;GEtatUtilisateur.SetSemaineSelectionnee(this.donnees.NumeroSemaine);new ObjetRequetePageAgenda(this,this.SurReponseRequetePageAgenda).lancerRequete(this.donnees.NumeroSemaine);}};ObjetAffichagePageAgenda.prototype.evenementSurICal=function(){this._objGestionFocus_apresFenetreICal={id:this.GetInstance(this.IdentICal).getPremierElement()};this.GetInstance(this.IdentFenetreICal).SetDonnees(GEtatUtilisateur.getMembre(),this.parametreExportICal);};ObjetAffichagePageAgenda.prototype.evenementSurFenetreICal=function(){this._gestionFocus_apresFenetreICal();};ObjetAffichagePageAgenda.prototype._gestionFocus_apresFenetreICal=function(){if(this._objGestionFocus_apresFenetreICal&&this._objGestionFocus_apresFenetreICal.id)
GHtml.setFocus(this._objGestionFocus_apresFenetreICal.id);this._objGestionFocus_apresFenetreICal=null;};ObjetAffichagePageAgenda.prototype.GetPageImpression=function(){if(GEtatUtilisateur.estModeAccessible())
return this._objetListeArborescente.GetListeArborescente().outerHTML;else{return{titre1:this.donnees.libelleImpression,contenu:this.Instances[this.IdentAgenda].ComposePage(true)};}};function _getEvenementParDefaut(aJour){var lJour=MethodesObjet.isNumber(aJour)?aJour:null;var lEvenement=new ObjetElement('');lEvenement.SetEtat(EGenreEtat.Creation);lEvenement.DateDebut=new Date(IE.CyclesCompletSemaine.jourCycleEnDate(lJour,this.donnees.NumeroSemaine));lEvenement.DateFin=new Date(IE.CyclesCompletSemaine.jourCycleEnDate(lJour,this.donnees.NumeroSemaine));lEvenement.DateDebut.setHours(9);lEvenement.DateFin.setHours(17);lEvenement.sansHoraire=true;lEvenement.publie=true;lEvenement.proprietaire=true;lEvenement.Commentaire='';lEvenement.CouleurCellule="#FFFF00";lEvenement.Public={listeClassesGroupes:new ObjetListeElements(),listeProfs:new ObjetListeElements()};lEvenement.listeDocJoints=new ObjetListeElements();return lEvenement;}
function _evenementSurAgenda(aParametres){var lSelection=aParametres.selection;var lAvecSaisie=GApplication.droits.get(IEEnum.droits.agenda.avecSaisieAgenda)&&lSelection&&(!lSelection.agenda||lSelection.agenda.proprietaire);var lAgenda=lSelection.agenda?lSelection.agenda:_getEvenementParDefaut.bind(this)(lSelection.jour);this._objGestionFocus_apresFenetreSaisieAgenda={id:GHtml.getElementEnFocus().id};if(aParametres.sourisDroite&&lAvecSaisie){var lInstanceMenu=this.GetInstance(this.identMenuContextuel);var lData={agenda:lAgenda,jour:lSelection.jour};lInstanceMenu.vider();lInstanceMenu.AddCommande(ObjetAffichagePageAgenda.genreMenuContextuel.creation,GTraductions.getValeur('Agenda.CreerEvenement'),!!lAvecSaisie&&!lSelection.agenda,lData);lInstanceMenu.AddCommande(ObjetAffichagePageAgenda.genreMenuContextuel.coller,GTraductions.getValeur('Agenda.CollerEvenement'),!!lAvecSaisie&&!lSelection.agenda&&!!this.copieAgenda,lData);lInstanceMenu.AddCommande(ObjetAffichagePageAgenda.genreMenuContextuel.copier,GTraductions.getValeur('Agenda.CopierEvenement'),!!lAvecSaisie&&!!lSelection.agenda,lData);lInstanceMenu.AddCommande(ObjetAffichagePageAgenda.genreMenuContextuel.modification,GTraductions.getValeur('Agenda.ModifierEvenement'),!!lAvecSaisie&&!!lSelection.agenda,lData);lInstanceMenu.AddCommande(ObjetAffichagePageAgenda.genreMenuContextuel.suppression,GTraductions.getValeur('Agenda.SupprimerEvenement'),!!lAvecSaisie&&!!lSelection.agenda,lData);lInstanceMenu.Afficher();}
else if(lAvecSaisie&&this.selection&&lSelection&&((lSelection.jour>=0&&this.selection.jour===lSelection.jour)||(lSelection.agenda&&this.selection.agenda===lSelection.agenda))){this.GetInstance(this.identFenetreSaisieAgenda).SetDonnees({agenda:lAgenda,listeClassesGroupes:this.donnees.listeClassesGroupes,etat:lSelection.agenda?EGenreEtat.Modification:EGenreEtat.Creation,avecSaisie:lAvecSaisie,listePJ:this.listePiecesJointes});}
this.selection=lSelection;}
function _evenementFenetreSaisieAgenda(aParametres){if(aParametres.surDocJoint){this.GetInstance(this.identEditionPieceJointe).afficherFenetrePJ({listePJTot:this.listePiecesJointes,listePJContexte:aParametres.evenement.listeDocJoints,genreFenetrePJ:EGenreDocumentJoint.Fichier,genrePJ:EGenreDocumentJoint.Fichier,genreRessourcePJ:EGenreRessource.DocJointEtablissement,instanceInputFile:this.GetInstance(this.idInputFile),guidInputFile:this.Nom});}
else if(aParametres.numeroBouton===1){if(aParametres.evenement){this.SetEtatSaisie(true);if(aParametres.etat===EGenreEtat.Creation){this.donnees.listeEvenements.AddElement(aParametres.evenement);}
else{var lIndice=this.donnees.listeEvenements.GetIndiceParElement(aParametres.evenementOrigine);;aParametres.evenement.SetEtat(EGenreEtat.Modification);this.donnees.listeEvenements.AddElement(aParametres.evenement,lIndice);}
this.donnees.listeEvenements.trier();_actualiserAgenda.bind(this)();}}
this._gestionFocus_apresFenetreSaisieAgenda();}
function _evenementInputFile(aParam){this.GetInstance(this.identEditionPieceJointe).evenementSurSelecteurFichier(aParam.eltFichier.Etat,aParam.eltFichier);}
function _actualiserAgenda(){if(GEtatUtilisateur.estModeAccessible())
this.AfficherListe(this.GetNomInstance(this.IdentAgenda));else{this.GetInstance(this.IdentAgenda).SetDonnees(this.donnees);window.Invocateur.evenement(window.Invocateur.events.activationImpression,EGenreImpression.Normale,this);this.surResizeInterface();}}
function _evenementEditionDocumentJoint(aNumeroBouton){this.GetInstance(this.identFenetreSaisieAgenda).majPiecesJointes(this.listePiecesJointes);}
function _evenementSurMenuContextuel(ALigne){var lAgenda;if(ALigne){switch(ALigne.Numero){case ObjetAffichagePageAgenda.genreMenuContextuel.creation:this.GetInstance(this.identFenetreSaisieAgenda).SetDonnees({agenda:ALigne.data.agenda,listeClassesGroupes:this.donnees.listeClassesGroupes,etat:EGenreEtat.Creation,avecSaisie:true,listePJ:this.listePiecesJointes});break;case ObjetAffichagePageAgenda.genreMenuContextuel.modification:this.GetInstance(this.identFenetreSaisieAgenda).SetDonnees({agenda:ALigne.data.agenda,listeClassesGroupes:this.donnees.listeClassesGroupes,etat:EGenreEtat.Modification,avecSaisie:true,listePJ:this.listePiecesJointes});break;case ObjetAffichagePageAgenda.genreMenuContextuel.suppression:lAgenda=ALigne.data.agenda;if(lAgenda.proprietaire){lAgenda.SetEtat(EGenreEtat.Suppression);this.SetEtatSaisie(true);_actualiserAgenda.bind(this)();this.GetInstance(this.IdentAgenda).DoTableau(ALigne.data.agenda.Colonne);}
break;case ObjetAffichagePageAgenda.genreMenuContextuel.copier:this.copieAgenda=IE.MethodesObjet.dupliquer(ALigne.data.agenda);var lListe=this.copieAgenda.listeDocJoints=new ObjetListeElements();ALigne.data.agenda.listeDocJoints.parcourir(function(D){if(D.Etat!==EGenreEtat.Suppression){var lElement=IE.MethodesObjet.dupliquer(D);if(lElement.Etat===EGenreEtat.Aucun){lElement.SetEtat(EGenreEtat.Creation);}
lListe.AddElement(lElement);}});break;case ObjetAffichagePageAgenda.genreMenuContextuel.coller:lAgenda=IE.MethodesObjet.dupliquer(this.copieAgenda);lAgenda.Etat=EGenreEtat.Aucun;lAgenda.Numero=null;lAgenda.SetEtat(EGenreEtat.Creation);var lDateDebutOrigine=lAgenda.DateDebut,lDateFinOrigine=lAgenda.DateFin,lEcartJour=GDate.getNbrJoursEntreDeuxDates(lAgenda.DateFin,lAgenda.DateDebut)-1;lAgenda.DateDebut=new Date(IE.CyclesCompletSemaine.jourCycleEnDate(ALigne.data.jour,this.donnees.NumeroSemaine));lAgenda.DateFin=GDate.getDateBornee(GDate.GetJourSuivant(lAgenda.DateDebut,lEcartJour));lAgenda.DateDebut.setHours(lDateDebutOrigine.getHours());lAgenda.DateDebut.setMinutes(lDateDebutOrigine.getMinutes());lAgenda.DateFin.setHours(lDateFinOrigine.getHours());lAgenda.DateFin.setMinutes(lDateFinOrigine.getMinutes());this.GetInstance(this.identFenetreSaisieAgenda).SetDonnees({agenda:lAgenda,listeClassesGroupes:this.donnees.listeClassesGroupes,etat:EGenreEtat.Creation,avecSaisie:true,listePJ:this.listePiecesJointes});break;}}
else this._gestionFocus_apresFenetreSaisieAgenda();}
ObjetAffichagePageAgenda.prototype.SurReponseRequetePageAgenda=function(aParam){this.SetEtatSaisie(false);this.parametreExportICal=aParam.parametreExportICal;GHtml.setDisplay(this.GetInstance(this.IdentICal).GetNom(),aParam.avecExportICal?aParam.avecExportICal:false);GStyle.setVisible(this.GetInstance(this.IdentICal).GetNom(),aParam.avecExportICal?aParam.avecExportICal:false);if(GEtatUtilisateur.listeDonnees&&GEtatUtilisateur.listeDonnees[TypeHttpNotificationDonnes.THND_ListeDocJointEtablissement])
this.listePiecesJointes=MethodesObjet.dupliquer(GEtatUtilisateur.listeDonnees[TypeHttpNotificationDonnes.THND_ListeDocJointEtablissement]);this.donnees.listeEvenements=aParam.listeEvenements;this.donnees.libelleImpression=this.Pere.getLibelleSousOnglet(GDate.strSemaine(this.donnees.NumeroSemaine,'%JJ/%MM/%AA','%JJ/%MM/%AA',GTraductions.getValeur('Agenda.SemaineDu'),' '+GTraductions.getValeur('Au')+' '),true,true,true);this.donnees.listeClassesGroupes=MethodesObjet.dupliquer(aParam.listeClassesGroupes);this.GetInstance(this.IdentCalendrier).setFrequences(null,true);this.GetInstance(this.IdentCalendrier).SetDomaineInformation(aParam.DomaineDePresence,EGenreDomaineInformation.AvecContenu);var lExisteAgenda=!(this.donnees.listeEvenements.GetNbrElements()===0&&!GApplication.droits.get(IEEnum.droits.agenda.avecSaisieAgenda));if(!lExisteAgenda)
window.Invocateur.evenement(window.Invocateur.events.activationImpression,EGenreImpression.Aucune);if(lExisteAgenda||GEtatUtilisateur.estModeAccessible())
_actualiserAgenda.bind(this)();else this.EvenementAfficherMessage(GTraductions.getValeur('Agenda.AucunEvenement'));};ObjetAffichagePageAgenda.prototype.surResizeInterface=function(){this.inherited('surResizeInterface');this.GetInstance(this.IdentAgenda).resize();this.GetInstance(this.IdentCalendrier).SurPostResize();};ObjetAffichagePageAgenda.prototype.Valider=function(aParam){if(aParam){ObjetFenetre_FichiersCloud.traiterReponseUrl(this.listePiecesJointes,aParam);}
if(!ObjetFenetre_FichiersCloud.traiterListeAValider(this.listePiecesJointes,this.Valider.bind(this))){var lInstancePJ=this.GetInstance(this.identEditionPieceJointe);new ObjetRequeteSaisieAgenda(this,this.ActionSurValidation).addUpload({listeFichiers:lInstancePJ.ListeFichiers,callback:function(){lInstancePJ.Reset();}}).lancerRequete({listeEvenements:this.donnees.listeEvenements,listePiecesJointes:this.listePiecesJointes});}};ObjetAffichagePageAgenda.prototype._gestionFocus_apresFenetreSaisieAgenda=function(){if(this._objGestionFocus_apresFenetreSaisieAgenda&&this._objGestionFocus_apresFenetreSaisieAgenda.id)
GHtml.setFocus(this._objGestionFocus_apresFenetreSaisieAgenda.id);this._objGestionFocus_apresFenetreSaisieAgenda=null;};})();;
ObjetAffichagePageAgenda.prototype.AfficherListe=function(aNom){this._objetListeArborescente=new ObjetListeArborescente(this.Nom+'_Liste',0,this,null);var lRacine=this._objetListeArborescente.construireRacine();this._objetListeArborescente.setParametres(false);var lTitre=GDate.strSemaine(this.donnees.NumeroSemaine,'%JJJJ %JJ %MMMM','%JJJJ %JJ %MMMM',GEtatUtilisateur.getLibelleOnglet()+' '+GTraductions.getValeur('Du')+' ',' '+GTraductions.getValeur('Au')+' ');var lNoeud=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lRacine,'',lTitre,'Gras',true,true);var I;if(this.donnees.listeEvenements.GetNbrElements()>0){for(I=0;I<this.donnees.listeEvenements.GetNbrElements();I++){var lElement=this.donnees.listeEvenements.GetElement(I);var lNoeudElement=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lNoeud,'',lElement.GetLibelle(),'Gras');if(lElement.listeEleves&&lElement.listeEleves.length>0)
this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudElement,'',lElement.listeEleves.join(', '));this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudElement,'',this.donnees.listeEvenements._getLibelleEvenement({evenement:lElement}).join('<br>'));this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudElement,'',lElement.listeDocJoints&&lElement.listeDocJoints.GetNbrElements()>0?this.composeDocuments(lElement.listeDocJoints):'');}} else{this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lRacine,'',GTraductions.getValeur('Agenda.AucunEvenement'));}
GHtml.setHtml(aNom,this._objetListeArborescente.ConstruireAffichage());this._objetListeArborescente.SetDonnees(lRacine);};ObjetAffichagePageAgenda.prototype.composeDocuments=function(aListeDocumentsJoints){var lHtml=[];for(var I=0;I<aListeDocumentsJoints.GetNbrElements();I++){var lDocumentJoint=aListeDocumentsJoints.GetElement(I);lHtml.push(GChaine.composerURL(EGenreDocumentJoint.getUrl(lDocumentJoint,EGenreRessource.DocJointEtablissement),lDocumentJoint.GetLibelle(),lDocumentJoint.GetGenre()===EGenreDocumentJoint.Fichier));}
return lHtml.join(', ');};;
var EGenreGrilleCalendrier={Jour:0,Midi:1,Soir:2,MidiEtSoir:3};MethodesObjet.heritagePrototype(ObjetGrilleCalendrier,Identite);function ObjetGrilleCalendrier(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.idBarSelecteur=this.Nom+'_BarSelecteur';this.idGrille=this.Nom+'_GrilleCalendrier';this.IdPremierElement=this.idBarSelecteur;this.setTraductions();this.nombreDeGenreAffichage=2;this.genrePartiJour={midi:0,soir:1};this.cycles=IE.Cycles;this.genreGrille=EGenreGrilleCalendrier.Jour;this.ajouterEvenementGlobal(EEvent.SurPreResize,this.SurPreResize);this.ajouterEvenementGlobal(EEvent.SurPostResize,this.SurPostResize);this.elementCourant=null;this.modeAffichage=ObjetGrilleCalendrier.genreAffichage.fermer;this._initialiserOptions();this.avecEvenement=$.isFunction(this.callback.evenement);}
ObjetGrilleCalendrier.genreAffichage={fermer:0,deployer:1};ObjetGrilleCalendrier.prototype._initialiserOptions=function(){this._options={avecDeploiement:false,avecSelection:false};};ObjetGrilleCalendrier.prototype.getModeAffichage=function(){return this.modeAffichage;};ObjetGrilleCalendrier.prototype.changeModeAffichage=function(){this.modeAffichage=(this.modeAffichage+1)%this.nombreDeGenreAffichage;};ObjetGrilleCalendrier.prototype.setGenreGrille=function(aGenreGrille){this.genreGrille=aGenreGrille;if(this.genreGrille===EGenreGrilleCalendrier.MidiEtSoir)
this.avecTitreSemaine=false;};ObjetGrilleCalendrier.prototype.SurPreResize=function(){if(!this.avecDonnees) return;GHtml.setHtml(this.Nom,'&nbsp;');};ObjetGrilleCalendrier.prototype.SurPostResize=function(){if(!this.avecDonnees) return;this.Afficher();this.composeDonnees();};ObjetGrilleCalendrier.prototype.setCycles=function(aInstanceCycles){if(aInstanceCycles){this.cycles=aInstanceCycles;}};ObjetGrilleCalendrier.prototype.SetParametres=function(aPremiereDate,aDerniereDate,aJoursOuvres,aAvecSelecteur,aAvecTitreSemaine,aAvecJourCourant,aGriseJoursAvant,aAvecScrollSurCellules,aAvecBordure,aDonneesAvecFondBlanc){this.premiereDate=aPremiereDate;this.derniereDate=aDerniereDate;this.joursOuvres=aJoursOuvres;this.avecSelecteur=aAvecSelecteur||false;this.avecTitreSemaine=aAvecTitreSemaine||false;this.avecJourCourant=aAvecJourCourant||false;this.griseJoursAvant=aGriseJoursAvant||false;this.IdPremierElement=this.avecSelecteur?this.idBarSelecteur:this.idGrille;this.avecScrollSurCellules=(aAvecScrollSurCellules!==null&&aAvecScrollSurCellules!==undefined)?aAvecScrollSurCellules:true;this.avecBordure=(aAvecBordure!==null&&aAvecBordure!==undefined)?aAvecBordure:true;this.donneesAvecFondBlanc=(aDonneesAvecFondBlanc!==null&&aDonneesAvecFondBlanc!==undefined)?aDonneesAvecFondBlanc:true;};ObjetGrilleCalendrier.prototype.setOptions=function(aOptions){$.extend(this._options,aOptions);};ObjetGrilleCalendrier.prototype.setJoursOuvres=function(aJoursOuvres){this.joursOuvres=aJoursOuvres;};ObjetGrilleCalendrier.prototype.SetDonnees=function(aDateDebut,aDateFin,aListeDonnees,aAvecDeploiement){var lID;this.dateDebut=aDateDebut;this.dateFin=aDateFin;this.nombreSemaines=this.cycles.cycleDeLaDate(this.dateFin)-this.cycles.cycleDeLaDate(this.dateDebut)+1;this.listeDonnees=aListeDonnees;this._options.avecDeploiement=aAvecDeploiement;this.avecDonnees=true;this.Afficher();$('#'+this.idGrille.escapeJQ()).find('.Tableau_Titre').on('focusin',function(){$(this).css('text-decoration','underline');}).on('focusout',function(){$(this).css('text-decoration','none');}).attr('tabIndex','-1').first().attr('tabIndex','0');$('#'+this.idGrille.escapeJQ()).find('.Tableau_Titre').on('keyup',{aObjet:this},function(event){var lJQArrayTitres,lIndex;if(event.which===ToucheClavier.FlecheDroite){lJQArrayTitres=$(this).parent().parent().find('.Tableau_Titre[tabindex]');lIndex=lJQArrayTitres.index(this);if(lIndex<lJQArrayTitres.length)
lJQArrayTitres.eq(lIndex+1).focus();} else if(event.which===ToucheClavier.FlecheGauche){lJQArrayTitres=$(this).parent().parent().find('.Tableau_Titre[tabindex]');lIndex=lJQArrayTitres.index(this);if(lIndex>0)
lJQArrayTitres.eq(lIndex-1).focus();} else if(event.which===ToucheClavier.FlecheBas){var lDate=event.data.aObjet.getDateID($(this).get(0).id);var lGenrePartiJour=(event.data.aObjet.genreGrille===EGenreGrilleCalendrier.Soir)?event.data.aObjet.genrePartiJour.soir:event.data.aObjet.genrePartiJour.midi;lID=event.data.aObjet.getIdCellule(lDate,event.data.aObjet.genreGrille!==EGenreGrilleCalendrier.Jour?lGenrePartiJour:null,false);if(event.data.aObjet.nbrElementsParDate(lDate)>0){var lJQFirst=$('#'+lID.escapeJQ()).find('.ElementPourNavigation:first');lJQFirst.focus();event.data.aObjet.evenementSurGrille(lJQFirst.get(0).id,null,true);}}
event.stopPropagation();});for(var I=0;I<this.listeDonnees.GetNbrElements();I++){var lElement=this.listeDonnees.GetElement(I);lID=this.getIdCellule(lElement.Date,this.genreGrille!==EGenreGrilleCalendrier.Jour?lElement.Genre:null,false);}
this.composeDonnees();$('#'+this.idGrille.escapeJQ()).find('.ElementPourNavigation').on('keyup',{aObjet:this},function(event){var lDate,lGenrePartiJour,lID,lJQTitre,lJQArrayTitres,lIndex,lJQ;if(event.which===ToucheClavier.FlecheDroite){lDate=event.data.aObjet.getDateID($(this).get(0).id);lGenrePartiJour=(event.data.aObjet.genreGrille===EGenreGrilleCalendrier.Soir)?event.data.aObjet.genrePartiJour.soir:event.data.aObjet.genrePartiJour.midi;lID=event.data.aObjet.getIdCellule(lDate,event.data.aObjet.genreGrille!==EGenreGrilleCalendrier.Jour?lGenrePartiJour:null,false)+'_titre';lJQTitre=$('#'+lID.escapeJQ());lJQArrayTitres=lJQTitre.parent().parent().find('.Tableau_Titre[tabindex]');lIndex=lJQArrayTitres.index(lJQTitre);if(lIndex<lJQArrayTitres.length){lJQArrayTitres.eq(lIndex+1).focus();if(event.data.aObjet.elementCourant)
event.data.aObjet.activerElement(event.data.aObjet.elementCourant,false);}} else if(event.which===ToucheClavier.FlecheGauche){lDate=event.data.aObjet.getDateID($(this).get(0).id);lGenrePartiJour=(event.data.aObjet.genreGrille===EGenreGrilleCalendrier.Soir)?event.data.aObjet.genrePartiJour.soir:event.data.aObjet.genrePartiJour.midi;lID=event.data.aObjet.getIdCellule(lDate,event.data.aObjet.genreGrille!==EGenreGrilleCalendrier.Jour?lGenrePartiJour:null,false)+'_titre';lJQTitre=$('#'+lID.escapeJQ());lJQArrayTitres=lJQTitre.parent().parent().find('.Tableau_Titre[tabindex]');lIndex=lJQArrayTitres.index(lJQTitre);if(lIndex>0){lJQArrayTitres.eq(lIndex-1).focus();if(event.data.aObjet.elementCourant)
event.data.aObjet.activerElement(event.data.aObjet.elementCourant,false);}} else if(event.which===ToucheClavier.FlecheBas&&$(this).nextAll('.ElementPourNavigation').length>0){lJQ=$(this).nextAll('.ElementPourNavigation:first');lJQ.focus();event.data.aObjet.evenementSurGrille(lJQ.get(0).id,null,true);} else if(event.which===ToucheClavier.FlecheHaut&&$(this).prevAll('.ElementPourNavigation').length>0){lJQ=$(this).prevAll('.ElementPourNavigation:first');lJQ.focus();event.data.aObjet.evenementSurGrille(lJQ.get(0).id,null,true);} else if(event.which===ToucheClavier.RetourChariot||event.which===ToucheClavier.Espace){lID=$(this).get(0).id;if(lID){lDate=event.data.aObjet.getDateID(lID);lIndex=event.data.aObjet.getIndexID(lID);if(lIndex> -1)
event.data.aObjet.evenementSurGrille(lID,lIndex,false,true);}}
event.stopPropagation();});};ObjetGrilleCalendrier.prototype.ConstruireAffichage=function(){return this.ComposePage();};ObjetGrilleCalendrier.prototype.ComposePage=function(aPourImpression){var html=[];this.hauteurGrille=GPosition.getHeight(this.Nom)-7;if(this.avecDonnees){if(this.avecSelecteur){html.push('<div id="',this.idBarSelecteur,'" style="height:30px;">',this.composeBarSelecteur(),'</div>');this.hauteurGrille-=30;}
html.push('<div id="',this.idGrille,'" class="" style="width:100%;height:',this.hauteurGrille,'px;overflow:hidden;">',this.composeGrille(aPourImpression),'</div>');}
return html.join('');};ObjetGrilleCalendrier.prototype.composeBarSelecteur=function(){var html=[];html.push('<table style="width:100%; height:100%;" class="Tableau" border="0" cellpadding="0" cellspacing="0"><tr>','<td>|xx|<td>','<td>|x|</td>','<td style="width:100%">Titre</td>','<td>|y|<td>','<td>|yy|</td>','</tr></table>');return html.join('');};ObjetGrilleCalendrier.prototype.composeGrille=function(aPourImpression){var html=[];var I,N=0;html.push('<table class="Tableau" ',GObjetWAI.composeRole(EGenreRole.Grid),' style="width: 100%; height: 100%; '+GTableau.styleTableau(aPourImpression,true)+'" border="0" cellspacing="0" cellpadding="0">');if(this.avecTitreSemaine){html.push('<tr>');html.push('<td class="Tableau_Titre Titre" ',GObjetWAI.composeRole(EGenreRole.Gridcell),' style="width:70px; height:20px; ',GTableau.styleTitre(aPourImpression),'">&nbsp;</td>');for(N=0;N<this.cycles.nombreJoursOuvresParCycle();N++){html.push('<td class="Tableau_Titre Titre" ',GObjetWAI.composeRole(EGenreRole.Gridcell),' style="',GTableau.styleTitre(aPourImpression),'">',I ,'</td>');}
html.push('</tr>');}
var lLargeurObjet=(this.avecTitreSemaine?GPosition.getWidth(this.Nom)-78:GPosition.getWidth(this.Nom)-8)-GNavigateur.GetLargeurBarreDeScroll();var lLargeurColonne=Math.floor(lLargeurObjet/this.cycles.nombreJoursOuvresParCycle())-0+'px';var lLargeurColonneDiv=lLargeurColonne;if(aPourImpression){lLargeurColonne=Math.floor(100/this.cycles.nombreJoursOuvresParCycle())+'%';lLargeurColonneDiv='100%';}
var lHauteurObjet=this.hauteurGrille-(this.avecTitreSemaine?22:2);var lHauteur=Math.floor(lHauteurObjet/this.nombreSemaines)-8-(this.nombreSemaines===1?1:0)-(this.avecTitreSemaine?15:22);var lClassScroll=this.avecScrollSurCellules&&!aPourImpression?'AvecScrollVerticalAuto':'';var lStyleHauteur=this.avecScrollSurCellules&&!aPourImpression?'height: '+lHauteur+'px;':'';var K;var lGenrePartiJour=(this.genreGrille===EGenreGrilleCalendrier.Soir)?this.genrePartiJour.soir:this.genrePartiJour.midi,lCycle,lCycleDebut=this.cycles.cycleDeLaDate(this.dateDebut),lDate;for(lCycle=lCycleDebut;lCycle<lCycleDebut+this.nombreSemaines;lCycle++){var lID=this.getIdCellule(this.cycles.dateDebutCycle(lCycle),this.genreGrille!==EGenreGrilleCalendrier.Jour?lGenrePartiJour:null,aPourImpression);html.push('<tr>');if(this.avecTitreSemaine){html.push('<td id="',lID,'_titre" class="Tableau_Titre Titre" ',GObjetWAI.composeRole(EGenreRole.Gridcell),' tabindex="-1" style="',GTableau.styleTitre(aPourImpression),'">',GDate.FormatDate(this.cycles.dateDebutCycle(lCycle),'%J %MMM'),'<br>-<br>',GDate.FormatDate(this.cycles.dateFinCycle(lCycle),'%J %MMM'),'</td>');} else{for(N=0;N<this.cycles.nombreJoursOuvresParCycle();N++){lDate=this.cycles.jourCycleEnDate(N,lCycle);lID=this.getIdCellule(lDate,this.genreGrille!==EGenreGrilleCalendrier.Jour?lGenrePartiJour:null,aPourImpression);var lTitre='<div class="Espace">'+GDate.FormatDate(lDate,'%JJJJ %JJ %MMMM')+'</div>';if(this.genreGrille!==EGenreGrilleCalendrier.Jour){if(lGenrePartiJour===0)
lTitre+='<div class="EspaceBas">'+GTraductions.getValeur('GrilleCalendrier.midi')+'</div>';else{if(this.genreGrille===EGenreGrilleCalendrier.Soir)
lTitre+='<div class="EspaceBas">'+GTraductions.getValeur('GrilleCalendrier.soir')+'</div>';else lTitre='<div class="Espace">'+GTraductions.getValeur('GrilleCalendrier.soir')+'</div>';}}
html.push('<td id="',lID,'_titre" ',GObjetWAI.composeRole(EGenreRole.Gridcell),' tabindex="-1" class="Tableau_Titre Titre" style="',GTableau.styleTitre(aPourImpression),'">',lTitre,'</td>');}
html.push('</tr><tr>');}
for(N=0;N<this.cycles.nombreJoursOuvresParCycle();N++){lDate=this.cycles.jourCycleEnDate(N,lCycle);var lStrDate=this.avecTitreSemaine?GDate.FormatDate(lDate,'%J'):GDate.FormatDate(lDate,'%JJJJ %JJ %MMMM');var lStyleJour=(GDate.estJourCourant(lDate)&&this.avecJourCourant)?GTableau.styleTitre(aPourImpression):GTableau.styleCellule(aPourImpression);lStyleJour=(GDate.estAvantJourCourant(lDate)&&this.griseJoursAvant)?GStyle.composeCouleur(aPourImpression?GCouleur.blanc:GCouleur.nonEditable.fond,GCouleur.liste.nonEditable.texte,GCouleur.liste.editable.getBordure(aPourImpression)):lStyleJour;var lClass=GDate.estJourCourant(lDate)&&this.avecJourCourant?' Gras':'';if(this.avecTitreSemaine)
html.push('<td class="AlignementDroit AlignementHaut" style="width:',lLargeurColonne,';',lStyleJour,'">','<div class="PetitEspaceBas ',lClass,'" style="width:',lLargeurColonneDiv,'; height:12px;">',lStrDate,'</div>','<div id="',this.getIdCellule(lDate,this.genreGrille!==EGenreGrilleCalendrier.Jour?lGenrePartiJour:null,aPourImpression),'" class="',lClassScroll,'" style="width:',lLargeurColonneDiv,'; min-height: 100px; ',lStyleHauteur,'">','</div>','</td>');else html.push('<td class="AlignementDroit AlignementHaut" style="width:',lLargeurColonne,';',lStyleJour,'">','<div id="',this.getIdCellule(lDate,this.genreGrille!==EGenreGrilleCalendrier.Jour?lGenrePartiJour:null,aPourImpression),'" class="',lClassScroll,'" style="width:',lLargeurColonneDiv,'; min-height: 100px; ',lStyleHauteur,'">','</div>','</td>');}
html.push('</tr>');if(this.genreGrille===EGenreGrilleCalendrier.MidiEtSoir)
if(lGenrePartiJour===this.genrePartiJour.midi){lGenrePartiJour=this.genrePartiJour.soir;lCycle=lCycle-1;} else{if(lCycle<lCycleDebut+this.nombreSemaines)
lGenrePartiJour=this.genrePartiJour.midi;}}
html.push('</table>');return html.join('');};ObjetGrilleCalendrier.prototype.composeDonnees=function(aPourImpression){var lHtml='';var lID='';var lLargeur=0;var lLargeurDiv=0;var lMaxElements=0;var lNbrElements=0;var lMarge='';var lContent='';var lStyle='';for(var I=0;I<this.listeDonnees.GetNbrElements();I++){var lElement=this.listeDonnees.GetElement(I);lID=this.getIdCellule(lElement.Date,this.genreGrille!==EGenreGrilleCalendrier.Jour?lElement.Genre:null,aPourImpression);lNbrElements=this.nbrElementsParDate(lElement.Date);var lMonID=lID+'/Matiere'+I;if(this.avecBordure)
lStyle=GStyle.composeCouleurBordure(lElement.couleurBordure);lHtml=GHtml.getHtml(lID);lMaxElements=Math.floor(GPosition.getHeight(lID)/(GNavigateur.IsIE?24:23));lLargeur=GPosition.getWidth(lID)-10-16-6-2-(lNbrElements>lMaxElements?19:0);var lLibelle=GChaine.GetLongueurChaine(lElement.Libelle,10,true,lLargeur);var lTitle=(lElement.Libelle===lLibelle)?'':'title="'+lElement.Libelle+'"';lMarge=GStyle.composeMarge((lHtml===''?3:2),1,(lElement.estUneSuite?0:3),(lElement.aUneSuite?0:3));lLargeurDiv=GPosition.getWidth(lID)-(lElement.estUneSuite?0:3)-(lElement.aUneSuite?0:3);lContent=lElement.html[this.modeAffichage];var lEvenement=aPourImpression?'':'onclick="'+this.Nom+'.evenementSurGrille(id,'+I+');" ';lHtml+='<div id="'+lMonID+'" tabindex="-1" '+GObjetWAI.composeRole(EGenreRole.Gridcell)+' '+lEvenement+'class="ElementPourNavigation AlignementGauche'+(this.avecEvenement?' AvecMain':'')+(this.donneesAvecFondBlanc?' FondBlanc':'')+'" style="overflow-x: auto; '+GStyle.composeWidth(lLargeurDiv)+lMarge+lStyle+'" '+lTitle+'>';lHtml+=lContent;lHtml+='</div>';GHtml.setHtml(lID,lHtml);}
var lJqGrille=$('#'+this.idGrille.escapeJQ());if(lJqGrille.prop('scrollHeight')>lJqGrille.outerHeight()){lJqGrille.jScrollPane({showArrows:true});}};ObjetGrilleCalendrier.prototype.nbrElementsParDate=function(aDate){var lCount=0;for(var I=0;I<this.listeDonnees.GetNbrElements();I++){if(GDate.estJourEgal(aDate,this.listeDonnees.GetElement(I).Date))
lCount++;}
return lCount;};ObjetGrilleCalendrier.prototype.getIdCellule=function(aDate,aGenre,aPourImpression){return this.Nom+'_sD'+GDate.FormatDate(aDate,'%JJ/%MM/%AA')+'eD_'+(aGenre===null||aGenre===undefined?'':aGenre)+(aPourImpression?'_imp':'');};ObjetGrilleCalendrier.prototype.evenementSurGrille=function(aID,aNumero,aSansEvenement,aEvenementClavier){if(this._options.avecSelection&&this.modeAffichage===ObjetGrilleCalendrier.genreAffichage.fermer){if(this.elementCourant)
this.activerElement(this.elementCourant,false);this.activerElement(aID,true);this.elementCourant=aID;}
if(!aSansEvenement){var lElement=this.listeDonnees.GetElement(aNumero);this.callback.appel(aID,lElement,aEvenementClavier);}};ObjetGrilleCalendrier.prototype.activerElement=function(aID,aActive){if(aID){var lDate=this.getDateID(aID);var lCouleur=!aActive?(GDate.estAvantJourCourant(lDate)&&this.griseJoursAvant)?GCouleur.liste.editable:GCouleur.liste.editable:GCouleur.selection;GStyle.setCouleur(aID,lCouleur.fond,lCouleur.texte);}};ObjetGrilleCalendrier.prototype.resetElement=function(){this.activerElement(this.elementCourant,false);this.elementCourant=null;};ObjetGrilleCalendrier.prototype.getDateID=function(aID){var patt1=/(?:_sD)([\d\/]{8,10})(?=eD_)/i;return GDate.getDateDeChaine(aID.match(patt1)[1]);};ObjetGrilleCalendrier.prototype.getIndexID=function(aID){var lResult= -1;var patt1=/Matiere([0-9]+)/i;var lMatch;if(patt1){lMatch=aID.match(patt1);if(lMatch&&lMatch[1])
lResult=parseInt(lMatch[1]);}
return lResult;};;
function ObjetRequetePageMenus(aPere,aEvenementSurReussite,aEvenementSurEchec){this.inheritedCreate(aPere,aEvenementSurReussite,aEvenementSurEchec);}
IE.Requetes.inscrire('PageMenus',ObjetRequetePageMenus,_ObjetRequeteXmlConsultationPN);ObjetRequetePageMenus.prototype.lancerRequete=function(aDate){this.JSON.date=aDate;this.appelAsynchroneConsultation();};ObjetRequetePageMenus.prototype.actionApresRequete=function(){this.callbackReussite.appel(this.JSONReponse.ListeJours,this.JSONReponse.DomaineDePresence,this.JSONReponse.AvecRepasMidi,this.JSONReponse.AvecRepasSoir,this.JSONReponse.JoursCantine);};;
MethodesObjet.heritagePrototype(ObjetAffichagePageMenus,ObjetInterfacePage);function ObjetAffichagePageMenus(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);}
ObjetAffichagePageMenus.prototype.ConstruireInstances=function(){this.IdentCalendrier=this.Add(window.ObjetCalendrier ,this.EvenementSurCalendrier ,this.InitialiserCalendrier);this.IdPremierElement=this.GetInstance(this.IdentCalendrier).getPremierElement();this.identPage=this.Add(window.ObjetGrilleCalendrier ,null ,this.initialiserGrilleCalendrier);};ObjetAffichagePageMenus.prototype.GetPageImpression=function(){if(GEtatUtilisateur.estModeAccessible())
return this._objetListeArborescente.GetListeArborescente().outerHTML;else{return{titre1:this.Pere.getLibelleSousOnglet(this.ComposePeriodeImpression(),false,false,false),contenu:$('#'+this.GetInstance(this.identPage).GetNom().escapeJQ()).clone().find('*').css({'height':'auto','overflow':'','color':'#000','background-color':'','border-color':'#000'}).attr('class',function(index,attr){return attr?attr.replace(/jsp[^\s]*?/g,''):'';}).end().html()};}};ObjetAffichagePageMenus.prototype.completerImpression=function(){if(!GEtatUtilisateur.estModeAccessible())
this.GetInstance(this.identPage).composeDonnees(true);};ObjetAffichagePageMenus.prototype.SetParametresGeneraux=function(){this.IdentZoneAlClient=this.identPage;this.avecBandeau=true;};ObjetAffichagePageMenus.prototype.RecupererDonnees=function(){this.Instances[this.IdentCalendrier].SetSelection(GEtatUtilisateur.GetSemaineSelectionnee());window.Invocateur.evenement(window.Invocateur.events.activationImpression,EGenreImpression.Normale,this);};ObjetAffichagePageMenus.prototype.InitialiserCalendrier=function(AObjet){AObjet.SetParametres(GParametres.PremierLundi,GParametres.DerniereDate,false,GParametres.conserverNumerosCalendaires,null,null,IE.CyclesCompletSemaine);};ObjetAffichagePageMenus.prototype.initialiserGrilleCalendrier=function(aObjet){aObjet.setCycles(IE.CyclesCompletSemaine);aObjet.SetParametres(GParametres.PremiereDate,GParametres.DerniereDate,GParametres.JoursOuvres,false,false,false,true,false,false,false);aObjet.setTraductions(GTraductions.getValeur('GrilleCalendrier'));};ObjetAffichagePageMenus.prototype.EvenementSurCalendrier=function(ASelection,AObjSelection,AGenreDomaine,aEstDansPeriodeConsultation,AIsToucheSelection){if(AIsToucheSelection){this.Instances[this.identPage].FocusSurPremierElement();} else{GEtatUtilisateur.SetSemaineSelectionnee(ASelection);new ObjetRequetePageMenus(this,this.ActionSurCalendrier).lancerRequete(IE.CyclesCompletSemaine.dateDebutCycle(ASelection));}};ObjetAffichagePageMenus.prototype.ActionSurCalendrier=function(aListeJours,aDomainePresence,aAvecRepasMidi,aAvecRepasSoir,aJoursCantine){this.ListeJours=aListeJours;this.joursCantine=aJoursCantine;if(this.ListeJours.GetNbrElements()===0)
this.EvenementAfficherMessage(GTraductions.getValeur('menus.Message.AucunJourPublie'));else{var lDomainePresence=aDomainePresence;this.GetInstance(this.IdentCalendrier).setFrequences(null ,true);this.GetInstance(this.IdentCalendrier).SetDomaineInformation(lDomainePresence,EGenreDomaineInformation.AvecContenu);if(GEtatUtilisateur.estModeAccessible()){this.AfficherListe();} else{var lCycles=new ObjetCycles();var lJoursOuvres=new TypeEnsembleNombre(),lNbJoursOuvres=0;for(var i=0;i<7;i++){if(aJoursCantine.GetValeur(i+1)){lJoursOuvres.add(i);lNbJoursOuvres+=1;}}
if(lNbJoursOuvres===0){this.EvenementAfficherMessage(GTraductions.getValeur('menus.Message.AucunJourPublie'));return;}
lCycles.init({premiereDate:GParametres.PremierLundi,derniereDate:GParametres.DerniereDate,joursOuvresParCycle:lNbJoursOuvres,joursOuvres:lJoursOuvres,joursFeries:IE.CyclesCompletSemaine.donneesCycles.joursFeries});var lDonnees=this.formatDonnees(this.ListeJours,aAvecRepasMidi,aAvecRepasSoir);this.GetInstance(this.identPage).setCycles(lCycles);this.GetInstance(this.identPage).setGenreGrille(aAvecRepasMidi&&aAvecRepasSoir?EGenreGrilleCalendrier.MidiEtSoir:EGenreGrilleCalendrier.Jour);this.GetInstance(this.identPage).SetDonnees(lCycles.dateDebutCycle(GEtatUtilisateur.GetSemaineSelectionnee()),lCycles.dateFinCycle(GEtatUtilisateur.GetSemaineSelectionnee()),lDonnees);}}};ObjetAffichagePageMenus.prototype.formatDonnees=function(aListeJours,aAvecRepasMidi,aAvecRepasSoir){var lResult=new ObjetListeElements();var I=0;var lElement=null;for(I=0;I<aListeJours.GetNbrElements();I++){lElement=aListeJours.GetElement(I);if(lElement.ListeRepas){for(var J=0;lElement.ListeRepas&&J<lElement.ListeRepas.GetNbrElements();J++){var lRepas=lElement.ListeRepas.GetElement(J);var newElement=new ObjetElement(lRepas.Libelle,lRepas.Numero,lRepas.Genre,lRepas.Position,lRepas.Actif);newElement.Date=lElement.Date;newElement.couleurBordure=GCouleur.liste.bordure;newElement.estUneSuite=false;newElement.aUneSuite=false;newElement.html=[];newElement.html[0]=this.composeHTML(lRepas,aAvecRepasMidi&&aAvecRepasSoir);newElement.AddTri(newElement.Date,EGenreType.Date);newElement.AddTri(newElement.Libelle);lResult.AddElement(newElement);}}}
lResult.Trier();return lResult;};ObjetAffichagePageMenus.prototype.composeHTML=function(aElement){var lHtml=[];lHtml.push('<table class="Menus_Tableau Texte10 AlignementMilieu" ',GObjetWAI.composeRole(EGenreRole.Gridcell),' border="0" cellpadding="0" cellspacing="0">');if(aElement.Libelle)
lHtml.push('<tr><td class="Espace Menus_CelluleTitre Gras">',aElement.Libelle,'</td></tr>');lHtml.push('<tr><td class="Espace">',this.ComposeRepas(aElement),'</td></tr>');lHtml.push('</table>');return lHtml.join('');};ObjetAffichagePageMenus.prototype.ComposePlat=function(APlat){var H=[];for(var I=0;I<APlat.ListeAliments.GetNbrElements();I++){H.push(APlat.ListeAliments.GetLibelle(I));}
return H.join('<br>ou<br>');};ObjetAffichagePageMenus.prototype.ComposeRepas=function(ARepas){var H=[];for(var I=0;I<ARepas.ListePlats.GetNbrElements();I++){H.push(this.ComposePlat(ARepas.ListePlats.GetElement(I)));}
return H.join('<br><br>~.~<br><br>');};ObjetAffichagePageMenus.prototype.ComposeDate=function(AJour){return GDate.FormatDate(AJour.Date,'%JJJJ %JJ');};ObjetAffichagePageMenus.prototype.ComposePeriode=function(ALibelle,AFormat){var N=this.ListeJours.GetNbrElements();return ALibelle+' '+GTraductions.getValeur('Du')+' '+GDate.FormatDate(this.ListeJours.GetElement(0).Date,AFormat)+' '+GTraductions.getValeur('Au')+' '+GDate.FormatDate(this.ListeJours.GetElement(N-1).Date,AFormat);};ObjetAffichagePageMenus.prototype.ComposePeriodeImpression=function(){return this.ComposePeriode(GTraductions.getValeur('Semaine'),'%JJ %MMMM');};;
ObjetAffichagePageMenus.prototype.AfficherListe=function(){var lIdListe=this.Nom+'_Liste';this._objetListeArborescente=new ObjetListeArborescente(lIdListe,0,this,null);var lRacine=this._objetListeArborescente.construireRacine();this._objetListeArborescente.setParametres(false);var lPremierElement=true;var lTitre='';var I,J=0;var lElement;var lNoeudListeElements;var lNoeudElement;var lSemaine=GEtatUtilisateur.GetSemaineSelectionnee();var lDateDebSemaine=GDate.FormatDate(IE.CyclesCompletSemaine.dateDebutCycle(lSemaine),'%JJJJ %JJ %MMMM');var lDateFinSemaine=GDate.FormatDate(IE.CyclesCompletSemaine.dateDernierJourOuvreCycle(lSemaine),'%JJJJ %JJ %MMMM');lTitre=GTraductions.getValeur('accueil.menu')+' '+GTraductions.getValeur('Du')+' '+lDateDebSemaine+' '+GTraductions.getValeur('Au')+' '+lDateFinSemaine ;lNoeudListeElements=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lRacine,lIdListe+'_ListeMenu',lTitre,'Gras',true,lPremierElement);lPremierElement=false;if(this.ListeJours.GetNbrElements()>0){for(I=0;I<this.ListeJours.GetNbrElements();I++){var lJour=this.ListeJours.GetElement(I);var lJourDeLaSemaine=GDate.GetJourDeSemaine(lJour.Date);if(this.joursCantine.GetValeur(lJourDeLaSemaine+1)){lTitre=GDate.FormatDate(lJour.Date,'%JJJJ %JJ %MMMM');var lDeploye=GDate.estJourCourant(lJour.Date);lNoeudElement=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lNoeudListeElements,lIdListe+'_Jour_'+I,lTitre,'Gras',lDeploye);if(lJour.ListeRepas&&lJour.ListeRepas.GetNbrElements()>0){for(J=0;J<lJour.ListeRepas.GetNbrElements();J++){lElement=lJour.ListeRepas.GetElement(J);lTitre=lElement.Libelle;if(lTitre) lTitre='<div class="Gras">&quot;'+lTitre+'&quot;</div>';lTitre+=this.composeRepasAccessible(lElement);if(lTitre) this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudElement,'',lTitre);}} else{this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudElement,'',GTraductions.getValeur('accueil.pasDeMenu'));}}}} else{this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudListeElements,'',GTraductions.getValeur('menus.Message.AucunJourPublie'));}
GHtml.setHtml(this.GetNomInstance(this.identPage),this._objetListeArborescente.ConstruireAffichage());this._objetListeArborescente.SetDonnees(lRacine);};ObjetAffichagePageMenus.prototype.composePlatAccessible=function(aPlat){var H=[];for(var I=0;I<aPlat.ListeAliments.GetNbrElements();I++){H.push(aPlat.ListeAliments.GetLibelle(I));}
return H.join(' '+GTraductions.getValeur('Menus.Ou')+' ');};ObjetAffichagePageMenus.prototype.composeRepasAccessible=function(aRepas){var lHtml=[];var H=[];for(var I=0;I<aRepas.ListePlats.GetNbrElements();I++){H.push('<div>'+this.composePlatAccessible(aRepas.ListePlats.GetElement(I))+'</div>');}
lHtml.push(H.join(''));return lHtml.join('');};;
MethodesObjet.heritagePrototype(_PageResultatBulletins,_PageResultat);function _PageResultatBulletins(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.genreImpression=EGenreImpression.GenerationPDF;}
_PageResultatBulletins.prototype.ActionSurRecupererBulletin=function(aParam){this.inherited('ActionSurRecupererBulletin',aParam);if(!aParam.Message){this.afficherBandeau(true);GHtml.setHtml(this.Nom+'_ComplementBandeau','&nbsp;&#45;&nbsp;'+GTraductions.getValeur('Classe')+'&nbsp;'+this.classe.GetLibelle());if(aParam.aCopier.graph!==undefined) GEtatUtilisateur.setGraphe({image:[aParam.aCopier.graph],titre:GTraductions.getValeur('BulletinEtReleve.titreGraphe'),message:GTraductions.getValeur('BulletinEtReleve.pasDAffichageGraphe')});}};_PageResultatBulletins.prototype.AfficherInterfaceGraphique=function(AXml){var lArbrePied;if(AXml){this.SetDonnees_Affichage();this.SetDonnees_Services();this.SetDonnees_Absences();this.setDonnees_General(this.MoyenneGenerale);lArbrePied=this.GetInstance(this.identPied).setDonnees_PiedDePage(this.PiedDePage);}
this.GetInstance(this.IdentPage).actualiser(lArbrePied);this.surResizeInterface();};;
MethodesObjet.heritagePrototype(ObjetBulletin,_ObjetBulletinEtReleve);function ObjetBulletin(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.id_General=this.Nom+'_GeneralBulletin';}
ObjetBulletin.prototype.getLargeurService=function(){return this.LargeurService+(Number(this.Affichage.AvecDureeDesAbsenses)+Number(this.Affichage.AvecVolumeHoraire)+Number(this.Affichage.AvecCoefficient)+Number(this.Affichage.avecECTS)+Number(this.Affichage.AvecNombreDevoirs)+Number(this.Affichage.AvecClassementEleve)+Number(this.Affichage.AvecEvolution)+this.Affichage.NombreMoyennesPeriodes+Number(this.Affichage.AvecMoyenneProposee)+Number(this.Affichage.AvecMoyenneDeliberee)+Number(this.Affichage.AvecMoyenneEleve)+Number(this.Affichage.AvecMoyenneClasse)+2*Number(this.Affichage.AvecMoyenneInfSup)+3*Number(this.Affichage.AvecNombrePointsEntre)+Number(this.Affichage.AvecMoyenneAnnuelle)+Number(this.Affichage.AvecNombrePointsEleve))*(this.LargeurNote+1);};ObjetBulletin.prototype.getLargeurGeneral=function(){return this.LargeurService+(Number(this.Affichage.AvecVolumeHoraire)+Number(this.Affichage.AvecCoefficient)+Number(this.Affichage.AvecNombreDevoirs))*(this.LargeurNote+1)+1;};ObjetBulletin.prototype.SetDonnees_Affichage=function(aAffichage){this.Affichage=aAffichage;this.NbrMoyennes=Number(this.Affichage.AvecMoyenneEleve)+Number(this.Affichage.AvecMoyenneClasse)+2*Number(this.Affichage.AvecMoyenneInfSup)+3*Number(this.Affichage.AvecNombrePointsEntre);};ObjetBulletin.prototype.SetDonnees=function(aSaisie,aListeElements,aNbrMaxServices,aNbrMaxDevoirs,aTableauSurMatieres){this.Saisie=aSaisie;this.Liste=this._getListeDonneesLineaire(aListeElements);this.NumLigne=null;this.NumColonne=null;this.NbrMaxServices=aNbrMaxServices;this.NbrMaxDevoirs=aNbrMaxDevoirs;this.tableauSurMatieres=aTableauSurMatieres;this.donneesRecues=true;};ObjetBulletin.prototype.actualiserDimensions=function(aPourImpression,aNumeroImpression){this.inherited('actualiserDimensions',aPourImpression,aNumeroImpression);if(aPourImpression){this.LargeurAppreciation=this.Affichage.NombreAppreciations?[450,420,390][aNumeroImpression]/this.Affichage.NombreAppreciations:0;}
else{if(this.Affichage.NombreAppreciations){var lLongueurPourAppreciations=GPosition.getWidth(this.Nom)-this.ScrollV.GetLargeur()-this.getLargeurService();this.LargeurAppreciation=Math.floor(lLongueurPourAppreciations/this.Affichage.NombreAppreciations);this.LargeurService+=lLongueurPourAppreciations-this.Affichage.NombreAppreciations*(this.LargeurAppreciation+1)-2;}}
this.NombreColonnes=this.Affichage.NombreAppreciations;};ObjetBulletin.prototype.composeImpression=function(){var H=[];H.push('<table ',GObjetWAI.composeRole(EGenreRole.Grid),' style="'+GStyle.composeCouleurBordure(GCouleur.liste.getBordure(true),1,EGenreBordure.haut+EGenreBordure.droite)+'" cellspacing="0" cellpadding="0"><tr><td>');H.push(this.ComposeLigneTitre(true));H.push(this.ComposeBulletin(0,true));H.push('</td></tr></table>');H.push(this.ComposeGeneral(true));return H.join('');};ObjetBulletin.prototype.composePageBulletin=function(){var H=[];H.push('<table ',GObjetWAI.composeRole(EGenreRole.Grid),' id="'+this.idPage+'" border="0" cellspacing="0" cellpadding="0">');H.push('<tr>');H.push('<td style="'+GStyle.composeCouleurBordure(GCouleur.liste.getBordure(),1,EGenreBordure.haut+EGenreBordure.droite)+'">'+this.ComposeLigneTitre()+'</td>');H.push('<td width="'+this.ScrollV.GetLargeur()+'"></td>');H.push('</tr>');H.push('<tr>');H.push('<td style="'+GStyle.composeCouleurBordure(GCouleur.liste.getBordure(),1,EGenreBordure.droite)+'"><div tabIndex="-1" id="'+this.ScrollV.GetIdZone()+'" onscroll="'+this.Nom+'.ScrollV.Actualiser (); " style="height:1px; overflow:hidden;">'+this.ComposeBulletin(0)+'</div></td>');H.push('<td id="'+this.ScrollV.GetIdScroll()+'"></td>');H.push('</tr>');H.push('<tr><td id="'+this.id_General+'" >'+this.ComposeGeneral()+'</td><td>&nbsp;</td></tr>');H.push('</table>');return H.join('');};ObjetBulletin.prototype.ComposeLigneTitre=function(aPourImpression){var H=[],I;var lDefaut={taille:this.LargeurNote,bordGauche:true,bordBas:true,nbrLignes:2,pourImpression:aPourImpression,role:EGenreRole.Columnheader};H.push('<table ',GObjetWAI.composeRole(EGenreRole.Row),' id="'+this.GetIdTitre()+'" class="Tableau '+this.taillePolice+'" border="0" cellpadding="0" cellspacing="0">');H.push('<tr height="'+this.HauteurTitre+'px">');H.push(this.composeTitre($.extend({},lDefaut,{libelle:GTraductions.getValeur('BulletinEtReleve.Matieres'),taille:this.LargeurService,bordGauche:false})));H.push(this.composeTitre($.extend({},lDefaut,{libelle:GTraductions.getValeur('BulletinEtReleve.VolH'),visible:this.Affichage.AvecVolumeHoraire})));H.push(this.composeTitre($.extend({},lDefaut,{libelle:GTraductions.getValeur('BulletinEtReleve.Coeff'),visible:this.Affichage.AvecCoefficient})));H.push(this.composeTitre($.extend({},lDefaut,{libelle:GTraductions.getValeur('BulletinEtReleve.NbrNotes'),visible:this.Affichage.AvecNombreDevoirs})));H.push(this.composeTitre($.extend({},lDefaut,{libelle:GTraductions.getValeur('BulletinEtReleve.Rang'),visible:this.Affichage.AvecClassementEleve})));H.push(this.composeTitre($.extend({},lDefaut,{libelle:GTraductions.getValeur('BulletinEtReleve.Evol'),visible:this.Affichage.AvecEvolution})));H.push(this.composeTitre($.extend({},lDefaut,{libelle:GTraductions.getValeur('BulletinEtReleve.MoyAnnee'),visible:this.Affichage.AvecMoyenneAnnuelle})));for(I=0;I<this.Affichage.NombreMoyennesPeriodes;I++)
H.push(this.composeTitre($.extend({},lDefaut,{libelle:this.Affichage.listePeriodes.GetLibelle(I)})));H.push(this.composeTitre($.extend({},lDefaut,{libelle:GTraductions.getValeur('BulletinEtReleve.MoyProposee'),visible:this.Affichage.AvecMoyenneProposee})));H.push(this.composeTitre($.extend({},lDefaut,{libelle:GTraductions.getValeur('BulletinEtReleve.MoyDeliberee'),visible:this.Affichage.AvecMoyenneDeliberee})));H.push(this.composeTitre($.extend({},lDefaut,{libelle:GTraductions.getValeur('BulletinEtReleve.Pts'),visible:this.Affichage.AvecNombrePointsEleve})));H.push(this.composeTitre($.extend({},lDefaut,{libelle:GTraductions.getValeur('BulletinEtReleve.ECTS'),visible:this.Affichage.avecECTS})));H.push(this.composeTitre($.extend({},lDefaut,{libelle:this.Affichage.AvecMoyenneProposee||this.Affichage.AvecMoyenneDeliberee?GTraductions.getValeur('BulletinEtReleve.MoyCalculee'):this.NbrMoyennes>1?GTraductions.getValeur('BulletinEtReleve.Moyennes'):GTraductions.getValeur('BulletinEtReleve.Moy'),taille:this.LargeurNote*this.NbrMoyennes,bordBas:false,nbrCol:this.NbrMoyennes,nbrLignes:1,visible:this.NbrMoyennes})));H.push(this.composeTitre($.extend({},lDefaut,{libelle:GTraductions.getValeur('BulletinEtReleve.RS_HAbs'),visible:this.Affichage.AvecDureeDesAbsenses})));for(I=0;I<this.Affichage.NombreAppreciations;I++)
H.push(this.composeTitre($.extend({},lDefaut,{libelle:this.Affichage.ListeIntitulesAppreciations.GetLibelle(I),taille:this.LargeurAppreciation})));H.push('</tr>');H.push('<tr height="'+this.HauteurTitre+'px">');H.push(this.composeTitre($.extend({},lDefaut,{libelle:GTraductions.getValeur('Eleve'),nbrLignes:1,visible:this.Affichage.AvecMoyenneEleve})));H.push(this.composeTitre($.extend({},lDefaut,{libelle:GTraductions.getValeur('Classe'),nbrLignes:1,visible:this.Affichage.AvecMoyenneClasse})));H.push(this.composeTitre($.extend({},lDefaut,{libelle:'-',nbrLignes:1,visible:this.Affichage.AvecMoyenneInfSup})));H.push(this.composeTitre($.extend({},lDefaut,{libelle:'+',nbrLignes:1,visible:this.Affichage.AvecMoyenneInfSup})));H.push(this.composeTitre($.extend({},lDefaut,{libelle:'< 8' ,nbrLignes:1,visible:this.Affichage.AvecNombrePointsEntre})));H.push(this.composeTitre($.extend({},lDefaut,{libelle:'8 - 12',nbrLignes:1,visible:this.Affichage.AvecNombrePointsEntre})));H.push(this.composeTitre($.extend({},lDefaut,{libelle:'> 12' ,nbrLignes:1,visible:this.Affichage.AvecNombrePointsEntre})));H.push('</tr>');if(!aPourImpression)
H.push('</table>');return H.join('');};ObjetBulletin.prototype.ComposeBulletin=function(aNumeroZone,aPourImpression){var H=[];if(!aPourImpression)
H.push('<table id="'+this.ScrollV.GetIdContenu()+'" class="'+this.taillePolice+' FondBlanc" border="0" cellpadding="0" cellspacing="0">');var lService;for(var I=0;I<this.Liste.GetNbrElements();I++){lService=this.Liste.GetElement(I);H.push(this.composeLigneService(aPourImpression,lService,I,aNumeroZone));}
H.push('</table>');return H.join('');};ObjetBulletin.prototype.ComposeGeneral=function(aPourImpression){var H=[];var lDefault={largeur:this.LargeurNote,pourImpression:aPourImpression,estMoyenneGenerale:true};if(this.Affichage.AvecMoyenneGenerale){H.push('<table id="'+this.GetIdGeneral()+'" class="'+this.taillePolice+'" style="'+GStyle.composeCouleurBordure(GCouleur.liste.getBordure(aPourImpression),1,EGenreBordure.droite)+'" border="0" cellpadding="0" cellspacing="0">');H.push('<tr>');H.push('<td class="Gras AlignementDroit" width="'+this.getLargeurGeneral()+'px"><div class="Gras Espace">',GTraductions.getValeur('BulletinEtReleve.MoyGen'),'</div></td>');H.push(this.composeNote($.extend({},lDefault,{note:this.General.ClassementEleve,visible:this.Affichage.AvecClassementEleve})));H.push(this.ComposeEvolution(this.General.Evolution.GetGenre(),false ,this.Affichage.AvecEvolution,aPourImpression));H.push(this.composeNote($.extend({},lDefault,{note:this.General.MoyenneAnnuelle,visible:this.Affichage.AvecMoyenneAnnuelle})));for(var I=0;I<this.Affichage.NombreMoyennesPeriodes;I++)
H.push(this.composeNote($.extend({},lDefault,{note:this.General.ListeMoyennesPeriodes[I],visible:this.Affichage.AvecMoyennePeriode})));H.push(this.composeNote($.extend({},lDefault,{note:'',visible:this.Affichage.AvecMoyenneProposee})));H.push(this.composeNote($.extend({},lDefault,{note:'',visible:this.Affichage.AvecMoyenneDeliberee})));this.General.NombrePointsEleve=this.calculerNombrePointsEleve();H.push(this.composeNote($.extend({},lDefault,{note:(this.General.NombrePointsEleve.valeur>0)?this.General.NombrePointsEleve.note:'',visible:this.Affichage.AvecNombrePointsEleve})));this.General.TotalECTS=this.calculerTotalECTS();H.push(this.composeNote($.extend({},lDefault,{note:(this.General.TotalECTS>0)?this.General.TotalECTS:'',visible:this.Affichage.avecECTS})));H.push(this.composeNote($.extend({},lDefault,{note:this.General.MoyenneEleve,visible:this.Affichage.AvecMoyenneEleve})));H.push(this.composeNote($.extend({},lDefault,{note:this.General.MoyenneClasse,visible:this.Affichage.AvecMoyenneClasse})));H.push('</tr>');H.push('</table>');}
return H.join('');};ObjetBulletin.prototype.ComposeEvolution=function(aGenreEvolution,aEstMoyenne,aVisible,aPourImpression){aVisible=aVisible===null?true:aVisible;return aVisible?'<td class="PetitEspace AlignementHaut AlignementMilieu" style="'+GTableau.styleMoyenne(aPourImpression,true,EGenreBordure.gauche+EGenreBordure.bas,aEstMoyenne)+'"><div style="width:'+(this.LargeurNote-6)+'px;">'+(aGenreEvolution?'<img src="images/evolution_'+aGenreEvolution+'.gif"></img>':'')+'</div></td>':'';};ObjetBulletin.prototype.getNombreSousServices=function(aService,aPourImpression){return aService.estService?(aPourImpression?aService.nbSousServicesActifs:aService.nbSousServicesTotal):0;};ObjetBulletin.prototype.estDernierAffiche=function(aService,aPourImpression){if(aService.estService){return aPourImpression?(aService.nbSousServicesActifs===0):(aService.nbSousServicesTotal===0);}
else{return aPourImpression?aService.estDernierActif:aService.estDernier;}};ObjetBulletin.prototype.composeLigneService=function(aPourImpression,aService,aLigne,aNumeroZone){var H=[];var lDefault={largeur:this.LargeurNote,avecGras:aService.estService,pourImpression:aPourImpression,estMoyenneGenerale:false};var lLabel='';if(!aPourImpression||aService.Actif){if(aService.estService)
H.push(this.composeRegroupement({surMatiere:this.tableauSurMatieres[aService.regroupement],service:aService,numeroZone:aNumeroZone,pourImpression:aPourImpression}));H.push('<tr ',GObjetWAI.composeRole(EGenreRole.Row),'>');if(aNumeroZone===0){var lDansRegroupement=aService.regroupement;var lId=this.GetIdLigne(this.NombreLignes++);var lNbrLignes=!aService.avecAppreciationParSousService?aService.estService?this.getNombreSousServices(aService,aPourImpression)+1:0:1;var lBordBas=this.estDernierAffiche(aService,aPourImpression);var I;H.push(this.composeService({service:aService,avecAlignementGauche:aService.estService,largeur:this.LargeurService,bordBas:lBordBas,bordRegroupement:lDansRegroupement,id:lId,actif:aService.Actif,pourImpression:aPourImpression,role:EGenreRole.Rowheader}));H.push(this.composeNote($.extend({},lDefault,{note:aService.VolumeHoraire ,visible:this.Affichage.AvecVolumeHoraire})));H.push(this.composeNote($.extend({},lDefault,{note:aService.Coefficient ,visible:this.Affichage.AvecCoefficient})));H.push(this.composeNote($.extend({},lDefault,{note:aService.NombreDevoirs ,visible:this.Affichage.AvecNombreDevoirs})));H.push(this.composeNote($.extend({},lDefault,{note:aService.ClassementEleve>0?aService.ClassementEleve:null ,visible:this.Affichage.AvecClassementEleve})));H.push(this.ComposeEvolution(aService.Evolution.GetGenre() ,false,this.Affichage.AvecEvolution ,aPourImpression));H.push(this.composeNote($.extend({},lDefault,{note:aService.MoyenneAnnuelle,visible:this.Affichage.AvecMoyenneAnnuelle})));for(I=0;I<this.Affichage.NombreMoyennesPeriodes;I++)
H.push(this.composeNote($.extend({},lDefault,{note:aService.ListeMoyennesPeriodes[I],visible:true})));H.push(this.composeNoteEdit($.extend({},lDefault,{note:aService.moyenneProposee,saisie:this.Saisie,visible:this.Affichage.AvecMoyenneProposee,libelle:aService.moyenneProposee===false?'':aService.moyenneProposee,ligne:aLigne+1,styleClass:'AlignementDroit AlignementHaut',width:this.LargeurNote-4,genreNote:EGenreNoteMoy.moyProposee,col:EGenreNoteMoy.moyProposee,nom:this.id_Note})));H.push(this.composeNoteEdit($.extend({},lDefault,{note:aService.moyenneDeliberee,saisie:this.Saisie,visible:this.Affichage.AvecMoyenneDeliberee,libelle:aService.moyenneDeliberee===false?'':aService.moyenneDeliberee,ligne:aLigne+1,styleClass:'AlignementDroit AlignementHaut',width:this.LargeurNote-4,genreNote:EGenreNoteMoy.moyDeliberee,col:EGenreNoteMoy.moyDeliberee,nom:this.id_Note})));H.push(this.composeNote($.extend({},lDefault,{note:aService.NombrePointsEleve,visible:this.Affichage.AvecNombrePointsEleve})));if(this.Affichage.avecECTS)
H.push(this.composeECTS({pourImpression:aPourImpression,saisie:this.Saisie,libelle:aService.ECTS===false?'':aService.ECTS,largeur:this.LargeurNote,ligne:aLigne+1,styleClass:'AlignementDroit AlignementHaut'}));H.push(this.composeNote($.extend({},lDefault,{note:aService.MoyenneEleve,estMoyenneGenerale:true,visible:this.Affichage.AvecMoyenneEleve})));H.push(this.composeNote($.extend({},lDefault,{note:aService.MoyenneClasse,visible:this.Affichage.AvecMoyenneClasse})));H.push(this.composeNote($.extend({},lDefault,{note:aService.MoyenneInf,visible:this.Affichage.AvecMoyenneInfSup})));H.push(this.composeNote($.extend({},lDefault,{note:aService.MoyenneSup,visible:this.Affichage.AvecMoyenneInfSup})));H.push(this.composeNote($.extend({},lDefault,{note:aService.NombreNotesEntre[0],visible:this.Affichage.AvecNombrePointsEntre})));H.push(this.composeNote($.extend({},lDefault,{note:aService.NombreNotesEntre[1],visible:this.Affichage.AvecNombrePointsEntre})));H.push(this.composeNote($.extend({},lDefault,{note:aService.NombreNotesEntre[2],visible:this.Affichage.AvecNombrePointsEntre})));H.push(this.composeNote($.extend({},lDefault,{note:aService.DureeDesAbsences,visible:this.Affichage.AvecDureeDesAbsenses})));for(I=0;I<this.Affichage.NombreAppreciations;I++){lLabel=aService.GetLibelle()+'.Coefficient:'+aService.Coefficient+'.Moyenne élève:'+aService.MoyenneEleve+'.Moyenne classe:'+aService.MoyenneClasse+'.'+this.Affichage.ListeIntitulesAppreciations.GetLibelle(I);this.setOptions_ObjetBulletinEtReleve({labelWAI:lLabel});H.push(this.composeAppreciation({pourImpression:aPourImpression,saisie:this.Saisie,libelle:GChaine.toTexte(aService.ListeAppreciations.GetLibelle(I)),largeur:this.LargeurAppreciation,rowspan:lNbrLignes,ligne:aLigne+1,col:I+1}));}}
H.push('</tr>');}
return H.join('');};ObjetBulletin.prototype.calculerTotalECTS=function(){var lTotalECTS=0;if(this.Affichage.avecECTS){var lService;for(var I=0;I<this.Liste.GetNbrElements();I++){lService=this.Liste.GetElement(I);if(lService.ECTS!==false)
lTotalECTS+=lService.ECTS;}}
return lTotalECTS.toFixed(3);};ObjetBulletin.prototype.calculerNombrePointsEleve=function(){var lTotal=0;if(this.Affichage.AvecNombrePointsEleve){var lService;for(var I=0;I<this.Liste.GetNbrElements();I++){lService=this.Liste.GetElement(I);if(lService.NombrePointsEleve)
lTotal+=lService.NombrePointsEleve.valeur;}}
return new TypeNote(lTotal,2);};ObjetBulletin.prototype.surModificationECTS=function(){GHtml.setHtml(this.id_General,this.ComposeGeneral(false));};;

MethodesObjet.heritagePrototype(_PiedDeBulletin,_PiedBulletinReleve);function _PiedDeBulletin(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.donneesRecues=false;this.idAbsences=this.Nom+'_absences';this.idOrientations=this.Nom+'_orientations';this.idAttestations=this.Nom+'_attestations';this.idPaliers=this.Nom+'_paliers';this.idStages=this.Nom+'_Stages';}
_PiedDeBulletin.prototype.SetParametresGeneraux=function(){this.GenreStructure=EStructureAffichage.Autre;};_PiedDeBulletin.prototype.ConstruireStructureAffichageAutre=function(){var H=[];H.push('<div id="'+this.idAbsences+'"></div>');if(this.identAppreciationGenerale>=0)
H.push('<div id="'+this.GetInstance(this.identAppreciationGenerale).GetNom()+'"></div>');H.push('<div id="'+this.GetInstance(this.identAppCPE).GetNom()+'"></div>');H.push('<div id="'+this.idOrientations+'"></div>');H.push('<div id="'+this.idAttestations+'"></div>');H.push('<div id="'+this.idPaliers+'"></div>');H.push('<div id="'+this.GetInstance(this.identAppConseilDeClasse).GetNom()+'"></div>');H.push('<div id="'+this.GetInstance(this.identAppCommentaires).GetNom()+'"></div>');H.push('<div id="'+this.idStages+'"></div>');return H.join('');};_PiedDeBulletin.prototype.ConstruireAffichage=function(){if(this.donneesRecues){this.actualiserDimensions();this.setHtml(this.idAbsences ,this.composeAbsences(),false);this.setHtml(this.idOrientations,this.composeOrientations(),true);this.setHtml(this.idPaliers ,this.composePaliers(),true);this.setHtml(this.idAttestations,this.composeAttestations(),true);this.setHtml(this.idStages ,this.composeStages(),true);this.inherited('ConstruireAffichage');}};_PiedDeBulletin.prototype.setHtml=function(aId,aHtml,aAvecSeparateur){if(aHtml)
aHtml=(aAvecSeparateur&&!this.PiedDePage.avecSaisieAG?this.composeSeparateur():'')+'<div class="EspaceBas '+this.taillePolice+'">'+aHtml+'</div>';GHtml.setHtml(aId,aHtml);};_PiedDeBulletin.prototype.ComposePage=function(aPourImpression,aNumeroImpression){var lPourImpression=(aPourImpression?aPourImpression:false);this.actualiserDimensions(lPourImpression,aNumeroImpression);var H=[];if(this.donneesRecues){var lHTML_Orientations=this.composeOrientations();var lHTML_Absences=this.composeAbsences();var lHTML_Paliers=this.composePaliers(aPourImpression);var lHTML_Attestations=this.composeAttestations();var lHTML_Stages=this.composeStages();H.push('<table class="'+this.taillePolice+'" style="width: 100%" border="0" cellpadding="0" cellspacing="0">');H.push('<tr>');H.push('<td class="EspaceHaut">');if(this.identAppreciationGenerale>=0)
H.push('<div>'+this.GetInstance(this.identAppreciationGenerale).ComposePage(aPourImpression,aNumeroImpression)+'</div>');if(lHTML_Absences.length){H.push('<div>');H.push(lHTML_Absences);H.push('</div>');}
H.push('<div>'+this.GetInstance(this.identAppCPE).ComposePage(aPourImpression,aNumeroImpression)+'</div>');if(lHTML_Absences.length)
H.push('</div>');H.push('</td>');H.push('</tr>');if(lHTML_Orientations.length){H.push('<tr>');H.push('<td class="EspaceHaut">');H.push(this.composeSeparateur(aPourImpression));H.push(lHTML_Orientations);H.push('</td>');H.push('</tr>');}
if(lHTML_Attestations.length){H.push('<tr>');H.push('<td class="EspaceHaut">');H.push(this.composeSeparateur(aPourImpression));H.push(lHTML_Attestations);H.push('</td>');H.push('</tr>');}
if(lHTML_Paliers.length){H.push('<tr>');H.push('<td class="EspaceHaut">');H.push(this.composeSeparateur(aPourImpression));H.push(lHTML_Paliers);H.push('</td>');H.push('</tr>');}
if(lHTML_Stages.length){H.push('<tr>');H.push('<td class="EspaceHaut">');H.push(this.composeSeparateur(aPourImpression));H.push(lHTML_Stages);H.push('</td>');H.push('</tr>');}
H.push('<tr><td><div>'+this.GetInstance(this.identAppConseilDeClasse).ComposePage(aPourImpression,aNumeroImpression)+'</div></td></tr>');H.push('<tr><td><div>'+this.GetInstance(this.identAppCommentaires).ComposePage(aPourImpression,aNumeroImpression)+'</div></td></tr>');H.push('</table>');}
return H.join('');};_PiedDeBulletin.prototype.composeOrientations=function(){var H=[];if(this.PiedDePage.ListeOrientations&&this.PiedDePage.ListeOrientations.GetNbrElements()){for(var I=0;I<this.PiedDePage.ListeOrientations.GetNbrElements();I++){var lElement=this.PiedDePage.ListeOrientations.GetElement(I);var lLibelle=lElement.GetLibelle()+' : ';for(var J=0;lElement.Intitule&&(J<lElement.Intitule.length);J++){H.push('<div>');H.push('<span style="width:150px">'+(J===0?lLibelle:'&nbsp;')+'</span>');H.push('<span class="Gras">'+GChaine.AvecEspaceSiVide(lElement.Intitule[J])+'</span>');H.push('</div>');}}}
return H.join('');};_PiedDeBulletin.prototype.composePaliers=function(){var H=[];if(this.PiedDePage.listePaliers)
for(var I=0;I<this.PiedDePage.listePaliers.GetNbrElements();I++){var lPalier=this.PiedDePage.listePaliers.GetElement(I);if(lPalier.listePiliers.GetNbrElements()){if(I>0) H.push('<div class="EspaceHaut">');H.push('<table class="'+this.taillePolice+'" style="border-collapse : collapse" border="0" cellpadding="0" cellspacing="0">');H.push('<tr>');H.push('<td style="width: 450px;">',lPalier.GetLibelle(),'</td>');H.push('<td style="width: 80px;">',GTraductions.getValeur('ValideeLe'),'</td>');H.push('</tr>');for(var J=0;J<lPalier.listePiliers.GetNbrElements();J++){var lPilier=lPalier.listePiliers.GetElement(J);H.push('<tr>');H.push('<td class="EspaceGauche">',lPilier.GetLibelle()+(lPilier.service.GetLibelle().length?' : '+lPilier.service.GetLibelle():''),'</td>');H.push('<td class="EspaceGauche Gras">',lPilier.date?GDate.FormatDate(lPilier.date,'%JJ/%MM/%AA'):'&nbsp;','</td>');H.push('</tr>');}
if(lPalier.validation!==undefined&&lPalier.validation!==false){H.push('<tr>');if(lPalier.validation===0) H.push('<td colspan="2" class="Italique">'+GTraductions.getValeur('BulletinEtReleve.MaitrisePalierPasAttestee')+'</td>');else H.push('<td colspan="2" class="Italique">'+GTraductions.getValeur('BulletinEtReleve.MaitrisePalierAttestee',[lPalier.GetLibelle(),GDate.FormatDate(lPalier.validation,'%JJ/%MM/%AA')])+'</td>');H.push('</tr>');}
H.push('</table>');if(I>0) H.push('</div>');}}
return H.join('');};_PiedDeBulletin.prototype.composeAttestations=function(){var H=[];if(this.PiedDePage.ListeAttestations&&this.PiedDePage.ListeAttestations)
for(var I=0;I<this.PiedDePage.ListeAttestations.GetNbrElements();I++){var lLibelle=this.PiedDePage.ListeAttestations.GetLibelle(I)+' : ';H.push('<div>');H.push('<span>'+lLibelle+'</span>');H.push('<span class="EspaceGauche Gras">'+GChaine.AvecEspaceSiVide(this.PiedDePage.ListeAttestations.GetElement(I).Intitule[0])+'</span>');H.push('</div>');}
return H.join('');};_PiedDeBulletin.prototype.composeStages=function(){var H=[];if(this.PiedDePage.listeStages)
for(var I=0;I<this.PiedDePage.listeStages.GetNbrElements();I++){var lStage=this.PiedDePage.listeStages.GetElement(I);H.push('<div>');H.push(lStage.GetLibelle());H.push('</div>');for(var J=0;J<lStage.listeDemandeurs.GetNbrElements();J++){var lDemandeur=lStage.listeDemandeurs.GetElement(J);if(lDemandeur.appreciation){H.push('<div class="EspaceGauche">');H.push('<span>'+lDemandeur.GetLibelle()+' : '+'</span>');H.push('<span class="Gras">'+lDemandeur.appreciation+'</span>');H.push('</div>');}}}
return H.join('');};;
_PiedDeBulletin.prototype.AfficherListe=function(){this._objetListeArborescente=new ObjetListeArborescente(this.Nom+'_Liste',0,this,null);var lRacine=this._objetListeArborescente.construireRacine();this._objetListeArborescente.setParametres(false);for(var I=0;I<this.absences.length;I++)
this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lRacine,'',this.absences[I]);if(this.PiedDePage.ListeAppreciations)
this._ajouterAG(lRacine,this.PiedDePage.ListeAppreciations.cpe,GTraductions.getValeur('PiedDeBulletin.VieScolaire'));this._ajouterOrientations(lRacine);if(this.PiedDePage.ListeAppreciations)
this._ajouterAttestations(lRacine);if(this.PiedDePage.ListeAppreciations)
this._ajouterAG(lRacine,this.PiedDePage.ListeAppreciations.conseilDeClasse,GTraductions.getValeur('PiedDeBulletin.AppConseilDeClasse'));this._ajouterCompetences(lRacine);if(this.PiedDePage.ListeAppreciations)
this._ajouterAG(lRacine,this.PiedDePage.ListeAppreciations.commentaires,GTraductions.getValeur('PiedDeBulletin.Commentaires'));return lRacine;};_PiedDeBulletin.prototype._ajouterAG=function(aRacine,aListe,aLibelleTitre){var lNbAppr=0,I,lElement;var lAvecAppreciation=false;for(I=0;I<aListe.GetNbrElements();I++){lElement=aListe.GetElement(I);if(lElement.ListeAppreciations.GetElement(0).GetLibelle()) lNbAppr++;}
if(lNbAppr) for(I=0;I<aListe.GetNbrElements();I++){lElement=aListe.GetElement(I);var lGenre=lElement.GetGenre(),lNoeudAppreciation;if(!lAvecAppreciation){lNoeudAppreciation=this._objetListeArborescente.ajouterUnNoeudAuNoeud(aRacine,'',aLibelleTitre,null,false);lAvecAppreciation=true;}
if(lElement.ListeAppreciations.GetElement(0).GetLibelle()){var lLibelle=GChaine.AvecEspaceSiVide(lElement.Intitule[0])+' : '+lElement.ListeAppreciations.GetElement(0).GetLibelle();this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudAppreciation,'',lLibelle);}}};_PiedDeBulletin.prototype._ajouterOrientations=function(aRacine){if(this.PiedDePage.ListeOrientations){var lCmp=0;for(var i=0;i<this.PiedDePage.ListeOrientations.GetNbrElements();i++) if(this.PiedDePage.ListeOrientations.GetElement(i).Intitule.length>0) lCmp++;if(lCmp){var lNoeudOrientations=this._objetListeArborescente.ajouterUnNoeudAuNoeud(aRacine,'',GTraductions.getValeur('PiedDeBulletin.Orientations'),null,false);for(var I=0;I<this.PiedDePage.ListeOrientations.GetNbrElements();I++){var lElement=this.PiedDePage.ListeOrientations.GetElement(I);var lLibelle=lElement.GetLibelle()+' : ';for(var J=0;lElement.Intitule&&(J<lElement.Intitule.length);J++){lLibelle+='<br>'+lElement.Intitule[J];}
this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudOrientations,'',lLibelle);}}}};_PiedDeBulletin.prototype._ajouterAttestations=function(aRacine){var lCmp=0;for(var i=0;i<this.PiedDePage.ListeAttestations.GetNbrElements();i++) if(this.PiedDePage.ListeAttestations.GetElement(i).Intitule.length>0) lCmp++;if(lCmp>0){var lNoeudAttestations=this._objetListeArborescente.ajouterUnNoeudAuNoeud(aRacine,'',GTraductions.getValeur('PiedDeBulletin.Attestations'),null,false);for(var I=0;I<this.PiedDePage.ListeAttestations.GetNbrElements();I++){var lLibelle=this.PiedDePage.ListeAttestations.GetLibelle(I)+' : ';this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudAttestations,'',lLibelle+GChaine.AvecEspaceSiVide(this.PiedDePage.ListeAttestations.GetElement(I).Intitule[0]));}}};_PiedDeBulletin.prototype._ajouterCompetences=function(aRacine){if(this.PiedDePage.listePaliers){var lCmp=0;for(var i=0;i<this.PiedDePage.listePaliers.GetNbrElements();i++) if(this.PiedDePage.listePaliers.GetElement(i).listePiliers.GetNbrElements()>0) lCmp++;if(lCmp>0){var lNoeudCompetences=this._objetListeArborescente.ajouterUnNoeudAuNoeud(aRacine,'',GTraductions.getValeur('PiedDeBulletin.Compétences'),null,false);for(var I=0;I<this.PiedDePage.listePaliers.GetNbrElements();I++){var lPalier=this.PiedDePage.listePaliers.GetElement(I);var lNoeudPalier=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lNoeudCompetences,'',lPalier.GetLibelle(),null,false);if(lPalier.listePiliers.GetNbrElements()){for(var J=0;J<lPalier.listePiliers.GetNbrElements();J++){var lPilier=lPalier.listePiliers.GetElement(J);var lLibelle=lPilier.GetLibelle()+(lPilier.service.GetLibelle().length?' : '+lPilier.service.GetLibelle():'');lLibelle+=lPilier.date?' : '+GTraductions.getValeur('ValideeLe')+' '+GDate.FormatDate(lPilier.date,'%JJ/%MM/%AA'):'&nbsp;';this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudPalier,'',lLibelle);}}}}}};;
MethodesObjet.heritagePrototype(PiedDeBulletin,_PiedDeBulletin);function PiedDeBulletin(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);}
PiedDeBulletin.prototype.ConstruireInstances=function(){this.identAppCPE=this.Add(window.ObjetApprPiedDeBulletin);this.identAppConseilDeClasse=this.Add(window.ObjetApprPiedDeBulletin);this.identAppCommentaires=this.Add(window.ObjetApprPiedDeBulletin);};;
MethodesObjet.heritagePrototype(ObjetFicheGraphe,ObjetFiche);function ObjetFicheGraphe(ANom,AIdent,APere,AEvenement){this.inheritedCreate(ANom,AIdent,APere,AEvenement);this.setOptions_Fiche({avecAbonnementBlocage:true});this.avecBandeau=true;this.avecBoutonFermer=true;this.avecDeplacementSurBandeau=true;this.avecDeplacementSurFiche=false;this.choixGraphe=0;this.idGraphe=IE.GUID.getId();this.idChoixGraphe=IE.GUID.getId();}
ObjetFicheGraphe.prototype.SetDonnees=function(aGraphe){this.graphe=aGraphe;this.afficherFiche({left:this.EnAffichage?null:10,top:this.EnAffichage?null:10,positionSurSouris:false});$('#'+this.Nom.escapeJQ()+' input[type="radio"]').jIECheckBox();};ObjetFicheGraphe.prototype.surAfficher=function(){if(this.graphe.image[this.choixGraphe]){var lHtml='<img alt="" src="data:image/png;base64,'+this.graphe.image[this.choixGraphe]+'"/>';GHtml.setHtml(this.idGraphe,lHtml);}};ObjetFicheGraphe.prototype.GetTitre=function(){return this.graphe.titre;};ObjetFicheGraphe.prototype.ComposeContenu=function(){var lHtml=[];if(this.graphe.titreChoixGraphe){lHtml.push('<div class="Espace">','<fieldset class="Texte10" style="border:1px solid ',GCouleur.fenetre.intermediaire,';">','<legend class="Espace">','<label>',this.graphe.titreChoixGraphe,'</label>','</legend>');for(var I=0;I<this.graphe.libelleChoixGraphe.length;I++)
lHtml.push('<div style="float: left;" class="GrandEspaceGauche">','<input type="radio" name="',this.idChoixGraphe,'" id="',this.idChoixGraphe+'_'+I,'" value="',I,'" ',I===this.choixGraphe?' checked="checked"':'','onclick="',this.Nom,'.surChoixGraphe (value)">','<label for="',this.idChoixGraphe+'_'+I,'">',this.graphe.libelleChoixGraphe[I],'</label>','</input>','</div>');lHtml.push('</fieldset>','</div>');}
lHtml.push('<div id="',this.idGraphe,'" style="margin: 5px;"></div>');return lHtml.join('');};ObjetFicheGraphe.prototype.surChoixGraphe=function(aChoixGraphe){this.choixGraphe=parseInt(aChoixGraphe);this.surAfficher();};;
function ObjetRequetePageBulletins(aPere,aEvenementSurReussite,aEvenementSurEchec){this.inheritedCreate(aPere,aEvenementSurReussite,aEvenementSurEchec);}
IE.Requetes.inscrire('PageBulletins',ObjetRequetePageBulletins,_ObjetRequeteResultat);ObjetRequetePageBulletins.prototype.lancerRequete=function(aParam){var lParam={eleve:new ObjetElement(),classe:new ObjetElement(),periode:new ObjetElement()};$.extend(lParam,aParam);var P=this.XML;P.CreerElement(null,'Classe' ,lParam.classe);P.CreerElement(null,'Eleve' ,lParam.eleve);P.CreerElement(null,'Periode',lParam.periode);this.appelAsynchroneConsultation();};ObjetRequetePageBulletins.prototype.actionApresRequete=function(aXml){var lParam={aCopier:{},absences:{}};lParam.Message=aXml.GetVariable(null,'Message');if(!lParam.Message){lParam.aCopier.classe=aXml.GetElement(null,'Classe');this.CreerParametresAffichage(aXml);lParam.aCopier.Affichage=this.Affichage;this.CreerListeServices(aXml);lParam.aCopier.ServiceEditable=this.ServiceEditable;lParam.aCopier.ExisteDevoir=this.ExisteDevoir;lParam.aCopier.ExisteService=this.ExisteService;lParam.aCopier.NbrMaxServices=this.NbrMaxServices;lParam.aCopier.NbrMaxDevoirs=this.NbrMaxDevoirs;lParam.aCopier.tableauSurMatieres=this.tableauSurMatieres;lParam.aCopier.tableauDebutRegroupement=this.tableauDebutRegroupement;lParam.aCopier.ListeElements=this.ListeElements;this.CreerMoyenneGenerale(aXml);lParam.aCopier.MoyenneGenerale=this.MoyenneGenerale;lParam.aCopier.graph=aXml.GetVariable(null,'graphe');$.extend(lParam.absences,new UtilitaireDeserialiserPiedBulletin().creerAbsences(aXml));lParam.aCopier.PiedDePage=new UtilitaireDeserialiserPiedBulletin().creerPiedDePage(aXml);}
this.callbackReussite.appel(lParam);};;
MethodesObjet.heritagePrototype(PageResultatBulletins,_PageResultatBulletins);function PageResultatBulletins(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.genreMessage=EGenreMessage.AucunBulletinPourEleve;}
PageResultatBulletins.prototype.ConstruireInstances=function(){this.IdentCombo=this.Add(window.ObjetSaisiePN ,this.EvenementSurCombo,this.InitialiserCombo);this.IdentPage=this.Add(window.ObjetBulletin);this.identPied=this.Add(window.PiedDeBulletin);this.identBtnFicheGraphe=this.Add(window.ObjetBoutonBandeau,this.evtSurBtnFicheGraphe,this.initialiserBtnGraphe);this.identFicheGraphe=this.Add(window.ObjetFicheGraphe);};PageResultatBulletins.prototype.SetParametresGeneraux=function(){this.GenreStructure=EStructureAffichage.Autre;this.avecBandeau=true;this.AddSurZone=['',this.IdentCombo,this.identBtnFicheGraphe];this.IdentZoneAlClient=this.IdentPage;};PageResultatBulletins.prototype.InitialiserCombo=function(aInstance){aInstance.setOptions_ObjetSaisie({labelWAIZone:GTraductions.getValeur('WAI.ListeSelectionPeriode'),roleWAIEdit:EGenreRole.Option});};PageResultatBulletins.prototype.EvenementSurCombo=function(aGenreEvenement,aElement){if(aGenreEvenement===EGenreEvenementObjetSaisie.selection){GEtatUtilisateur.Navigation.SetRessource(EGenreRessource.Periode,aElement);var lParam={eleve:GEtatUtilisateur.getMembre(),periode:aElement};new ObjetRequetePageBulletins(this,this.ActionSurRecupererBulletin).lancerRequete(lParam);}};PageResultatBulletins.prototype.getParametresPDF=function(){var lResult={genreGenerationPDF:TypeHttpGenerationPDF.Bulletin,eleve:new ObjetElement('',GEtatUtilisateur.GetNumeroEleve()),periode:GEtatUtilisateur.Navigation.GetRessource(EGenreRessource.Periode)};return lResult;};;
function ObjetRequetePageEmploiDuTemps_DomaineDePresence(aPere,aEvenementSurReussite,aEvenementSurEchec){this.inheritedCreate(aPere,aEvenementSurReussite,aEvenementSurEchec);}
IE.Requetes.inscrire('PageEmploiDuTemps_DomainePresence',ObjetRequetePageEmploiDuTemps_DomaineDePresence,_ObjetRequeteXmlConsultationPN);ObjetRequetePageEmploiDuTemps_DomaineDePresence.prototype.lancerRequete=function(aRessource){this.JSON.Ressource=aRessource;this.appelAsynchroneConsultation();};ObjetRequetePageEmploiDuTemps_DomaineDePresence.prototype.actionApresRequete=function(){this.callbackReussite.appel(this.JSONReponse.Domaine,this.JSONReponse.JoursStage,this.JSONReponse.joursPresence);};;

MethodesObjet.heritagePrototype(ObjetRequetePageEmploiDuTemps,_ObjetRequeteXmlConsultationPN);function ObjetRequetePageEmploiDuTemps(aPere,aEvenementSurReussite,aEvenementSurEchec){this.inheritedCreate(aPere,aEvenementSurReussite,aEvenementSurEchec);}
IE.Requetes.inscrire('PageEmploiDuTemps',ObjetRequetePageEmploiDuTemps,_ObjetRequeteXmlConsultationPN);ObjetRequetePageEmploiDuTemps.prototype.lancerRequete=function(aParametres){var lParametres={ressource:null,numeroSemaine:null,dateDebut:null,dateFin:null,domaine:null,matiere:null,niveau:null,dossierProgression:null,elementProgression:null,avecAbsencesEleve:false,estEDTPermanence:false};$.extend(lParametres,aParametres);var P=this.XML;if(lParametres.ressource)
P.CreerElement(null,'Ressource' ,lParametres.ressource);if((lParametres.domaine!==null&&lParametres.domaine!==undefined))
P.CreerVariable(null,'Domaine',EGenreType.Domaine,lParametres.domaine);else if((lParametres.numeroSemaine!==null&&lParametres.numeroSemaine!==undefined))
P.CreerVariable(null,'NumeroSemaine',EGenreType.Cardinal,lParametres.numeroSemaine);else{;P.CreerVariable(null,'DateDebut',EGenreType.Date,lParametres.dateDebut);if((lParametres.dateFin!==null&&lParametres.dateFin!==undefined))
P.CreerVariable(null,'DateFin',EGenreType.Date,lParametres.dateFin);}
if(lParametres.matiere) P.CreerElement(null,'Matiere',lParametres.matiere);if(lParametres.niveau) P.CreerElement(null,'Niveau' ,lParametres.niveau);if(lParametres.dossierProgression) P.CreerElement(null,'DossierProgression' ,lParametres.dossierProgression);if(lParametres.elementProgression) P.CreerElement(null,'ElementProgression' ,lParametres.elementProgression);if(lParametres.avecAbsencesEleve){this.JSON.avecAbsencesEleve=true;}
if(lParametres.estEDTPermanence){this.JSON.estEDTPermanence=true;}
this.appelAsynchroneConsultation();};ObjetRequetePageEmploiDuTemps.prototype.actionApresRequete=function(aXml){var lParam={};lParam.ParametreExportICal=aXml.GetVariable(null,'ParametreExportiCal');lParam.avecExportICal=aXml.GetVariable(null,'AvecExportiCal');lParam.avecCoursAnnule=aXml.GetVariable(null,'AvecCoursAnnule');if(aXml.Existe(null,'Message')){lParam.message=aXml.GetVariable(null,'Message');} else{this.listeCours=new ObjetDeserialiser().listeCours(this.JSONReponse);lParam.listeCours=this.listeCours;lParam.placeCourante=aXml.GetVariable(null,'PlaceCourante');}
lParam.existeCDTsDetaches=this.JSONReponse.existeCDTsDetaches;lParam.absences=this.JSONReponse.absences;this.callbackReussite.appel(lParam);};ObjetRequetePageEmploiDuTemps.prototype.getIndiceCoursParPlace=function(aPlaceCourante){var lEcartAvant= -1000;var lIndiceAvant;if(MethodesObjet.isNumber(aPlaceCourante))
for(var I=0;I<this.listeCours.GetNbrElements();I++){var lCours=this.listeCours.GetElement(I);if(lCours&&lCours.Visible!==false&&GDate.estJourEgal(lCours.DateDuCours,new Date()))
if((aPlaceCourante>=lCours.Debut)&&((lCours.Fin-aPlaceCourante)>lEcartAvant)){lEcartAvant=lCours.Fin-aPlaceCourante;lIndiceAvant=I;}}
return lIndiceAvant;};;

MethodesObjet.heritagePrototype(ObjetAffichagePageEmploiDuTemps,ObjetInterfacePage);function ObjetAffichagePageEmploiDuTemps(ANom,AIdent,APere,AEvenement){this.inheritedCreate(ANom,AIdent,APere,AEvenement);this.ajouterEvenementGlobal(EEvent.SurPreResize ,this.surPreResize);this.avecFicheCours=true;this.avecFicheCdT=true;this.avecListeEleves=MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Professeur,EGenreEspace.Etablissement]);this.avecComboEleve=MethodesTableau.existe(GEtatUtilisateur.getGenreOnglet(),[EGenreOnglet.EmploiDuTempsEleve]);this.avecComboClasse=MethodesTableau.existe(GEtatUtilisateur.getGenreOnglet(),[EGenreOnglet.EmploiDuTempsClasse,EGenreOnglet.CahierDeTextesClasse]);this.avecComboSalle=MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Professeur,EGenreEspace.Etablissement])&&(GEtatUtilisateur.getGenreOnglet()===EGenreOnglet.EmploiDuTempsSalle);this.avecComboProfesseur=GEtatUtilisateur.getGenreOnglet()===EGenreOnglet.EmploiDuTempsProfesseur;this.avecComboPersonnel=GEtatUtilisateur.getGenreOnglet()===EGenreOnglet.EmploiDuTempsPersonnelEtablissement;this.ressource=this.avecComboSalle||this.avecComboClasse||this.avecComboEleve||this.avecComboProfesseur||this.avecComboPersonnel?null:GEtatUtilisateur.getMembre();this.genreImpression=EGenreImpression.GenerationPDF;if(GEtatUtilisateur.GenreEspace===EGenreEspace.Professeur&&window.ObjetModule_EDTSaisie){this.moduleSaisie=new window.ObjetModule_EDTSaisie(this);}
this.donneesGrille={avecCoursAnnule:GEtatUtilisateur.getAvecCoursAnnule(),avecCoursAnnulesSuperposes:!GEtatUtilisateur.estEspacePourEleve(),numeroSemaine:0,listeCours:null,joursStage:null,modeDiagnostic:false,diagnostic:null};}(function(){var EGenreCreationListeEleves={choixEleves:0,choisSemaines:1};ObjetAffichagePageEmploiDuTemps.prototype.ConstruireInstances=function(){this.IdentCalendrier=this.Add(window.ObjetCalendrier ,this.EvenementSurCalendrier ,this.InitialiserCalendrier);if((this.IdentCalendrier!==null&&this.IdentCalendrier!==undefined)&&this.GetInstance(this.IdentCalendrier)!==null) this.IdPremierElement=this.GetInstance(this.IdentCalendrier).getPremierElement();this.IdentGrille=this.Add(window.InterfaceGrilleEDT ,this.EvenementSurCours ,this.InitialiserGrille);if(this.avecListeEleves)
this.identListeEleves=this.Add(window.ObjetListe,this.evenementSurListeEleves,this.initialiserListeEleves);this.IdentFicheCours=this.Add(window.TFicheCours,this.evenementFicheCours);this.identFenetreMemo=this.addFenetre(window.ObjetFenetre_Memo);if(this.avecFicheCdT)
this.identFicheCdt=this.Add(window.ObjetFicheCDT ,this.evenementFicheCdt ,this.initialiserFicheCdt);this.IdentICal=this.Add(window.ObjetBoutonBandeau,this.evenementSurICal ,this.initialiserICal);var lAcces=GEtatUtilisateur.getAcces();if(GEtatUtilisateur.getAvecChoixCoursAnnule()&&lAcces.autoriseSurDate)
this.IdentBtnCoursAnnule=this.Add(window.ObjetBoutonBandeau,this.evenementSurBtnCoursAnnule,this.initialiserBtnCoursAnnule);this.IdentFenetreICal=this.addFenetre(window.ObjetFenetre_ICal ,this.evenementSurFenetreICal,this.initialiserFenetreICal);if(GEtatUtilisateur.GenreEspace===EGenreEspace.Professeur)
this.idFenetreChoixEleveGAEV=this.addFenetre(window.ObjetFenetre_ChoixEleveGAEV,this.evenementSurFenetreChoixEleveGAEV,this.initialiserFenetreChoixEleveGAEV);if(this.avecComboEleve||this.avecComboClasse||this.avecComboSalle||this.avecComboProfesseur||this.avecComboPersonnel)
this.identTripleCombo=this.Add(window.ObjetAffichagePageAvecMenusDeroulants,this.evenementSurDernierMenuDeroulant,this.initialiserTripleCombo);this.interfaceFicheVisu=this.Add(window.InterfaceFicheVisuEleveQCM,this.evenementSurVisuEleve,null);this.identMenuContextuel=this.Add(window.ObjetMenuContextuel,_evenementSurMenuContextuel.bind(this));this.identBandeau=this.Add(window.ObjetBandeau,null,null);};ObjetAffichagePageEmploiDuTemps.prototype.SetParametresGeneraux=function(){this.GenreStructure=EStructureAffichage.Autre;this.avecBandeau=true;this.IdentZoneAlClient=this.IdentGrille;this.AddSurZone=[];if(this.identTripleCombo)
this.AddSurZone.push(this.identTripleCombo);this.AddSurZone.push(this.identBandeau);if(this.IdentBtnOccupationProf)
this.AddSurZone.push({ident:this.IdentBtnOccupationProf,alignementDroite:true});this.AddSurZone.push({ident:this.IdentBtnCoursAnnule,alignementDroite:true});if(MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Professeur,EGenreEspace.Eleve,EGenreEspace.Parent]))
this.AddSurZone.push({ident:this.IdentICal,alignementDroite:true});};ObjetAffichagePageEmploiDuTemps.prototype.ConstruireStructureAffichageAutre=function(){var H=[];var lAcces=GEtatUtilisateur.getAcces();if(!lAcces.autorise)
return this.composeMessage(GTraductions.getValeur('EDT.EDTNonConsultable'));else if(!lAcces.autoriseSurDate)
return this.composeMessage(GTraductions.getValeur('EDT.EDTconsultableDuAu',[GDate.FormatDate(lAcces.dateDebut,'%JJ/%MM/%AA'),GDate.FormatDate(lAcces.dateFin,'%JJ/%MM/%AA')]));var LCadre=0;var LStyle=this.couleurFond?GStyle.composeCouleurFond(this.couleurFond):'';H.push('<div>');H.push('<table class="AlignementHaut Espace"');H.push(' style="'+LStyle+'width:100%; height:100%;" border="0" cellpadding="0" cellspacing="'+LCadre+'">');H.push('<tr id="">');H.push('<td class="AlignementHaut" id="'+this.GetInstance(this.IdentCalendrier).GetNom()+'" style="width: 100%; height:10px">',GHtml.composeBlanc(),'</td>');if(this.avecListeEleves)
H.push('<td class="AlignementHaut EspaceGauche" rowspan="2"><div id="',this.GetInstance(this.identListeEleves).GetNom(),'" style="width:200px">','</div></td>');H.push('</tr>');H.push('<tr>');H.push('<td class="AlignementHaut" id="'+this.GetInstance(this.IdentGrille).GetNom()+'" style="height: 100%">',GHtml.composeBlanc(),'</td>');H.push('</tr>');H.push('</table>');H.push('</div>');return H.join('');};ObjetAffichagePageEmploiDuTemps.prototype.initialiserTripleCombo=function(aInstance){if(this.avecComboSalle)
aInstance.SetParametres([EGenreRessource.Salle]);else if(this.avecComboEleve)
aInstance.SetParametres([EGenreRessource.Classe,EGenreRessource.Eleve]);else if(this.avecComboProfesseur){aInstance.SetParametres([EGenreRessource.Enseignant]);}
else if(this.avecComboPersonnel){aInstance.SetParametres([EGenreRessource.Personnel]);}
else aInstance.SetParametres([EGenreRessource.Classe],true);};ObjetAffichagePageEmploiDuTemps.prototype.InitialiserCalendrier=function(AInstance){AInstance.SetParametres(GParametres.PremierLundi,GParametres.DerniereDate,false,GParametres.conserverNumerosCalendaires);};ObjetAffichagePageEmploiDuTemps.prototype.InitialiserGrille=function(AInstance){};ObjetAffichagePageEmploiDuTemps.prototype.initialiserListeEleves=function(aInstance){aInstance.setParametres_Affichage(true,false,true);aInstance.SetParametres([GTraductions.getValeur('Eleve'),GTraductions.getValeur('Classe')],['100%','50'],null,null,GTraductions.getValeur('ChoixEleveGAEV.nouveau'));aInstance.setOptionsListe({avecFondBlanc:false});aInstance.setColonnesCachees([window.DonneesListe_Eleves.genreColonne.Classe]);};ObjetAffichagePageEmploiDuTemps.prototype.initialiserFicheCdt=function(aObjet){aObjet.setAvecInfoDevoirPersonalise(MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Parent,EGenreEspace.Eleve])?true:false);};ObjetAffichagePageEmploiDuTemps.prototype.initialiserICal=function(aInstance){var lTraduction=GTraductions.getValeur('iCal.hint')[EGenreICal.EDT];aInstance.SetParametres('Image_IcalDownload',true,false,true,[lTraduction,lTraduction],20,false);aInstance.SetVisible(false);};ObjetAffichagePageEmploiDuTemps.prototype.initialiserBtnCoursAnnule=function(aInstance){aInstance.SetParametres('Image_AfficherCoursAnnules',true,this.donneesGrille.avecCoursAnnule,true,[GTraductions.getValeur('EDT.MasquerCoursAnnules'),GTraductions.getValeur('EDT.AfficherCoursAnnules'),GTraductions.getValeur('EDT.AfficherCoursAnnules')],20);};ObjetAffichagePageEmploiDuTemps.prototype.initialiserFenetreChoixEleveGAEV=function(aInstance){aInstance.SetParametres_Fenetre(GTraductions.getValeur('ChoixEleveGAEV.titre'),500,600,[GTraductions.getValeur('Annuler'),GTraductions.getValeur('Valider')],true);};ObjetAffichagePageEmploiDuTemps.prototype.initialiserFenetreICal=function(aInstance){aInstance.SetParametres_Fenetre(GTraductions.getValeur('iCal.fenetre.titre'),425,265,new Array(GTraductions.getValeur('Fermer')));aInstance.setTraductions(GTraductions.getValeur('iCal'));aInstance.setGenreICal(EGenreICal.EDT);};function _getOptionsGrille_MS(){return{afficherPasHoraire:false,avecZoom:false,avecIndisponibilite:false,premierLundi:GParametres.PremierLundi,joursOuvres:GParametres.JoursOuvres,joursFeries:GParametres.JoursFeries,nombreLignes:GParametres.PlacesParJour,pasHoraire:GParametres.PlacesParHeure,placeDemiJournee:GParametres.PlaceDemiJournee,avecHeuresPleinesApresMidi:GParametres.AvecHeuresPleinesApresMidi,listeHeures:GParametres.LibellesHeures};}
ObjetAffichagePageEmploiDuTemps.prototype.RecupererDonnees=function(){var lAcces=GEtatUtilisateur.getAcces();if(lAcces.autoriseSurDate&&lAcces.dateDebut&&lAcces.dateFin)
this.GetInstance(this.identBandeau).SetLibelle('('+GTraductions.getValeur('EDT.consultableDuAu',[GDate.FormatDate(lAcces.dateDebut,'%JJ/%MM/%AA'),GDate.FormatDate(lAcces.dateFin,'%JJ/%MM/%AA')])+')');if(this.avecListeEleves){GStyle.setVisible(this.GetInstance(this.identListeEleves).GetNom(),false);}
this.viderAffichage();this.lancerAffichage();};ObjetAffichagePageEmploiDuTemps.prototype.viderAffichage=function(){this.GetInstance(this.IdentGrille).fermerFenetreMS();if(this.avecListeEleves){var lListe=this.GetInstance(this.identListeEleves);lListe.setOptionsListe({listeCreations:null,creationLigne:null});lListe.SetDonnees(new window.DonneesListe_Eleves(new ObjetListeElements()));lListe.setColonnesCachees([window.DonneesListe_Eleves.genreColonne.Classe]);}};ObjetAffichagePageEmploiDuTemps.prototype.lancerAffichage=function(){if(!this.ressource){GHtml.setDisplay(this.GetInstance(this.IdentCalendrier).GetNom(),false);}
else if(!GEtatUtilisateur.getDomainePresence(this.ressource))
this.requeteDomaineDePresence();else this.actionSurRecupererDonnees();};ObjetAffichagePageEmploiDuTemps.prototype.requeteDomaineDePresence=function(){new ObjetRequetePageEmploiDuTemps_DomaineDePresence(this,this.actionSurRecupererDonnees).lancerRequete(this.ressource);};ObjetAffichagePageEmploiDuTemps.prototype.actionSurRecupererDonnees=function(aDomainePresence,aJoursStage){if(aDomainePresence)
GEtatUtilisateur.setDomainePresence(this.ressource,aDomainePresence,aJoursStage);this.initialisationCalendrier(GEtatUtilisateur.getDomainePresence(this.ressource));};ObjetAffichagePageEmploiDuTemps.prototype.initialisationCalendrier=function(aDomainePresence){var lCalendrier=this.GetInstance(this.IdentCalendrier);lCalendrier.setFrequences(GParametres.frequences,true);lCalendrier.SetDomaineInformation(aDomainePresence ,EGenreDomaineInformation.AvecContenu);lCalendrier.SetPeriodeDeConsultation(GApplication.droits.get(IEEnum.droits.cours.domaineConsultationEDT));if(!GApplication.droits.get(IEEnum.droits.cours.domaineConsultationEDT).GetValeur(GEtatUtilisateur.GetSemaineSelectionnee())){GEtatUtilisateur.SetSemaineSelectionnee(GApplication.droits.get(IEEnum.droits.cours.domaineConsultationEDT).GetPremierePosition());}
lCalendrier.SetSelection(GEtatUtilisateur.GetSemaineSelectionnee());if(this.moduleSaisie&&this.moduleSaisie.afficherDomaineClotureCalendrier()){lCalendrier.SetDomaineInformation(GParametres.domaineVerrou,EGenreDomaineInformation.Cloturee);}};ObjetAffichagePageEmploiDuTemps.prototype.EvenementSurCalendrier=function(ASelection,ABidon,AGenreDomaineInformation,aEstDansPeriodeConsultation,AIsToucheSelection){if(AIsToucheSelection){this.SetIdCourant(this.Instances[this.IdentGrille].getInstanceGrille().getPremierElement());this.SetFocusIdCourant();} else{this.SetIdCourant(this.Instances[this.IdentCalendrier].IdPremierElement);this.SetEtatIdCourant(false);GEtatUtilisateur.SetSemaineSelectionnee(ASelection);this.Selection=ASelection;if(AGenreDomaineInformation===EGenreDomaineInformation.Feriee){window.Invocateur.evenement(window.Invocateur.events.activationImpression,EGenreImpression.Aucune);this.GetInstance(this.IdentGrille).getInstanceGrille().Afficher(this.composeMessage(GTraductions.getValeur('SemaineFeriee')));this.SetEtatIdCourant(true);}
else this.requetePageEmploiDuTemps();}};ObjetAffichagePageEmploiDuTemps.prototype.requetePageEmploiDuTemps=function(){new ObjetRequetePageEmploiDuTemps(this,this.ActionSurCalendrier).lancerRequete({ressource:this.ressource,numeroSemaine:this.Selection});};ObjetAffichagePageEmploiDuTemps.prototype.ActionSurCalendrier=function(aParam){var lInstanceGrille=this.GetInstance(this.IdentGrille);if(this.avecListeEleves){GStyle.setVisible(this.GetInstance(this.identListeEleves).GetNom(),true);}
this.ParametreExportICal=aParam.ParametreExportICal;GHtml.setDisplay(this.GetInstance(this.IdentICal).GetNom(),aParam.avecExportICal?aParam.avecExportICal:false);if(!GEtatUtilisateur.getAvecChoixCoursAnnule()){GEtatUtilisateur.setAvecCoursAnnule(aParam.avecCoursAnnule);this.donneesGrille.avecCoursAnnule=GEtatUtilisateur.getAvecCoursAnnule();}
this.GetInstance(this.IdentFicheCours).Fermer(this.Instances[this.IdentCalendrier].EstUneInteractionUtilisateur());if(this.identFicheCdt) this.GetInstance(this.identFicheCdt).Fermer(this.Instances[this.identFicheCdt].EstUneInteractionUtilisateur());this.viderAffichage();this.nomCompletRessource=this.ressource.GetLibelle();var LNumeroSemaine=GEtatUtilisateur.GetSemaineSelectionnee();if(GEtatUtilisateur.getAcces().autoriseSurDate)
window.Invocateur.evenement(window.Invocateur.events.activationImpression,EGenreImpression.GenerationPDF,this,_getParametresPDF.bind(this));this.donneesGrille.numeroSemaine=LNumeroSemaine;this.donneesGrille.listeCours=aParam.listeCours;this.donneesGrille.joursStage=GEtatUtilisateur.getJoursStageDEleve(this.ressource);this.donneesGrille.modeDiagnostic=false;this.donneesGrille.diagnostic=null;if(GEtatUtilisateur.estModeAccessible())
this.AfficherListe();else{this.surResizeInterface();lInstanceGrille.getInstanceGrille().setOptions({callbackMouseDownCellule:null});lInstanceGrille.SetDonnees(this.donneesGrille);if(GEtatUtilisateur._coursASelectionner){lInstanceGrille.getInstanceGrille().SelectionnerElementParNumero(GEtatUtilisateur._coursASelectionner.GetNumero());delete GEtatUtilisateur._coursASelectionner;}}
this.SetEtatIdCourant(true);if(this.Instances[this.IdentCalendrier].EstUneInteractionUtilisateur())
this.SetFocusIdCourant();};ObjetAffichagePageEmploiDuTemps.prototype.evenementFicheCdt=function(aParam){if(aParam&&aParam.executionQCM){this.GetInstance(this.interfaceFicheVisu).setParametres(aParam.executionQCM.GetNumero(),MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Professeur,EGenreEspace.Academie])||GApplication.getDemo());this.GetInstance(this.interfaceFicheVisu).setDonnees(aParam.executionQCM);}
this._gestionFocus_apresFiche(aParam);};ObjetAffichagePageEmploiDuTemps.prototype.evenementFicheCours=function(aParam){this._gestionFocus_apresFiche(aParam);};ObjetAffichagePageEmploiDuTemps.prototype.evenementSurICal=function(){this.GetInstance(this.IdentFenetreICal).SetDonnees(this.ressource,this.ParametreExportICal);};ObjetAffichagePageEmploiDuTemps.prototype.evenementSurBtnCoursAnnule=function(){GEtatUtilisateur.setAvecCoursAnnule(!GEtatUtilisateur.getAvecCoursAnnule());this.donneesGrille.avecCoursAnnule=GEtatUtilisateur.getAvecCoursAnnule();if(this.moduleSaisie)
this.moduleSaisie.sortieModeDiagnostic_RestaurerOptions();this.GetInstance(this.IdentFicheCours).Fermer();if(this.identFicheCdt) this.GetInstance(this.identFicheCdt).Fermer();this.GetInstance(this.IdentGrille).SetDonnees(this.donneesGrille);};ObjetAffichagePageEmploiDuTemps.prototype.evenementSurFenetreICal=function(aNumeroBouton){};ObjetAffichagePageEmploiDuTemps.prototype.evenementSurFenetreChoixEleveGAEV=function(aGenreBouton,aListeElevesGAEV,aDomaine){if(aGenreBouton===1)
new window.ObjetRequeteSaisieElevesGAEV(this,_surReponseRequeteSaisieElevesGAEV.bind(this)).lancerRequete({cours:this.paramCours.cours,domaine:aDomaine,listeElevesGAEV:aListeElevesGAEV});else this.SetEtatSaisie(false);};ObjetAffichagePageEmploiDuTemps.prototype.evenementSurDernierMenuDeroulant=function(){GHtml.setDisplay(this.GetInstance(this.IdentCalendrier).GetNom(),true);GStyle.setVisible(this.GetInstance(this.IdentBtnCoursAnnule).GetNom(),true);GStyle.setVisible(this.GetInstance(this.IdentICal).GetNom(),true);if(this.avecListeEleves)
GStyle.setDisplay(this.GetNomInstance(this.identListeEleves),true);if(this.IdentBtnOccupationProf)
GStyle.setVisible(this.GetInstance(this.IdentBtnOccupationProf).GetNom(),true);if(this.avecComboSalle)
this.ressource=GEtatUtilisateur.Navigation.GetRessource(EGenreRessource.Salle);else if(this.avecComboEleve){this.ressource=GEtatUtilisateur.Navigation.GetRessource(EGenreRessource.Eleve);if(!this.ressource.existeNumero())
this.ressource=GEtatUtilisateur.Navigation.GetRessource(EGenreRessource.Classe);} else if(this.avecComboProfesseur)
this.ressource=GEtatUtilisateur.Navigation.GetRessource(EGenreRessource.Enseignant);else if(this.avecComboPersonnel)
this.ressource=GEtatUtilisateur.Navigation.GetRessource(EGenreRessource.Personnel);else this.ressource=GEtatUtilisateur.Navigation.GetRessource(EGenreRessource.Classe);this.surResizeInterface();this.lancerAffichage();};ObjetAffichagePageEmploiDuTemps.prototype.EvenementSurCours=function(aParam){var lParam={genre:null,id:'',cours:null};$.extend(lParam,aParam);this.paramCours=aParam;if(this.moduleSaisie)
this.moduleSaisie.sortieModeDiagnostic();switch(lParam.genre){case EGenreEvenementEDT.SurCours:case EGenreEvenementEDT.SurContenu:case EGenreEvenementEDT.SurImage:{if((lParam.genre!==EGenreEvenementEDT.SurCours)||this.avecFicheCours){if(!lParam.cours.coursMultiple)
this._requeteFiche(lParam.cours);} else{this.GetInstance(this.IdentFicheCours).Fermer();if(this.identFicheCdt) this.GetInstance(this.identFicheCdt).Fermer();}
break;}
case EGenreEvenementEDT.SurMenuContextuel:{if(!lParam.cours.coursMultiple){this.fermerFiches();if(_estCoursDejaSelectionne.bind(this)(lParam.cours)&&_avecMenuContextuel.bind(this)()){this._afficherMenuContextuelDeCours(lParam.cours);}
else if(this.avecListeEleves){_requeteFicheCours.bind(this)(lParam.cours ,{cours:lParam.cours,forcerNavigationClavier:GNavigateur.IsToucheMenuContextuel()});}}
break;}
default:{;}}};function _avecMenuContextuel(){return this.moduleSaisie?this.moduleSaisie.avecMenuContextuel():false;}
function _evenementSurMenuContextuelCreationListeEleves(aLigne){switch(aLigne.GetNumero()){case EGenreCreationListeEleves.choixEleves:this.GetInstance(this.idFenetreChoixEleveGAEV).SetDonnees(this.paramCours.cours,this.Selection);break;case EGenreCreationListeEleves.choixSemaines:var lFenetre=ObjetFenetre.creerInstance(window.ObjetFenetre_ChoixSemainesEleveGAEV,{pere:this,evenement:function(aGenreBouton,aNumeroSemaine){if(aGenreBouton===1){var lDomaine=new TypeDomaine();lDomaine.SetValeur(true,this.Selection);new window.ObjetRequeteSaisieElevesGAEV(this,_surReponseRequeteSaisieElevesGAEV.bind(this)).lancerRequete({cours:this.paramCours.cours,domaine:lDomaine,numeroSemaineSource:aNumeroSemaine});}}});lFenetre.Afficher();break;}}
ObjetAffichagePageEmploiDuTemps.prototype.evenementSurListeEleves=function(aParam){if(aParam===EGenreEvenementListe.Creation){if(this._autorisationEditionGroupeGAEVSurContexte()&&this.GetInstance(this.idFenetreChoixEleveGAEV)){ObjetMenuContextuel.afficher({pere:this,initCommandes:function(aInstance){aInstance.AddCommande(EGenreCreationListeEleves.choixEleves,GTraductions.getValeur('ChoixEleveGAEV.nouveau'));aInstance.AddCommande(EGenreCreationListeEleves.choixSemaines,GTraductions.getValeur('ChoixEleveGAEV.AffecterLesEleves'));},evenement:_evenementSurMenuContextuelCreationListeEleves.bind(this)});return EGenreEvenementListe.Creation;}}};ObjetAffichagePageEmploiDuTemps.prototype.evenementSurVisuEleve=function(aParam){if(aParam.action==='close'){this.RecupererDonnees();}};ObjetAffichagePageEmploiDuTemps.prototype._positionnementNavigationClavier=function(aCours,aForcerNavigationClavier){if(GNavigateur.IsToucheMenuContextuel()||aForcerNavigationClavier){var lPlace=aCours.Debut;var lInstanceGrille=this.GetInstance(this.IdentGrille).getInstanceGrille();var lPosition=lInstanceGrille.getPositionDePlace(lPlace);var lElementGrille=GHtml.getElement(lInstanceGrille.IdCellulePrefixe);GNavigateur.positionnerMenuContextuelSurId(lElementGrille,(lPosition.x+1)*lInstanceGrille.largeurCellule,(lPosition.y)*lInstanceGrille.hauteurCellule);}};function _estCoursDejaSelectionne(aCours){return this._parametres&&this._parametres.cours&&this._parametres.cours.GetNumero()===aCours.GetNumero();}
ObjetAffichagePageEmploiDuTemps.prototype._afficherMenuContextuelDeCours=function(aCours,aForcerNavigationClavier){if(this.moduleSaisie){var lInstanceMenu=this.GetInstance(this.identMenuContextuel);this.moduleSaisie.remplirMenuContextuelDeCours(lInstanceMenu,aCours,aForcerNavigationClavier);lInstanceMenu.Afficher();}};ObjetAffichagePageEmploiDuTemps.prototype.fermerFiches=function(){this.GetInstance(this.IdentFicheCours).Fermer();if(this.identFicheCdt) this.GetInstance(this.identFicheCdt).Fermer();};ObjetAffichagePageEmploiDuTemps.prototype._requeteFiche=function(aCours,aActualiser){this._objGestionFocus_apresFiche=null;if((this.paramCours.genre===EGenreEvenementEDT.SurImage)&&(this.paramCours.genreImage===1)){new ObjetRequeteFicheCDT(this,this._actionSurRequeteFicheCDT.bind(this,EGenreAffichageCahierDeTextes.ContenuDeCours)).lancerRequete({cours:aCours,numeroSemaine:this.Selection});} else if(this.paramCours.genre===EGenreEvenementEDT.SurContenu)
new ObjetRequeteFicheCDT(this,this._actionSurRequeteFicheCDT.bind(this,EGenreAffichageCahierDeTextes.TravailAFaire)).lancerRequete({cours:aCours,numeroSemaine:this.Selection});else{var lInstanceFicheCours=this.GetInstance(this.IdentFicheCours);if(this.moduleSaisie&&this.moduleSaisie.autorisationEditionCoursAutoriseeSurContexte()&&(aActualiser!==true)&&_estCoursDejaSelectionne.bind(this)(aCours)&&lInstanceFicheCours&&lInstanceFicheCours.EnAffichage&&!aCours.coursOrigine&&aCours.deplacable&&GApplication.droits.get(IEEnum.droits.cours.deplacerCours)){this._parametres.cours=aCours;this.moduleSaisie.requeteEvaluation(aCours,this.Selection);}
else{_requeteFicheCours.bind(this)(aCours);}}};function _requeteFicheCours(aCours,aParamMenuContextuel){this._parametres={cours:aCours};new ObjetRequeteFicheCours(this,_actionSurRequeteFicheCours.bind(this,aParamMenuContextuel),_surEchecFicheCours).lancerRequete({cours:aCours,numeroSemaine:this.Selection,ressource:this.ressource});}
ObjetAffichagePageEmploiDuTemps.prototype._autorisationEditionGroupeGAEVSurContexte=function(){return this.paramCours.cours.estGAEV&&GEtatUtilisateur.GenreEspace===EGenreEspace.Professeur&&GEtatUtilisateur.getGenreOnglet()===EGenreOnglet.EmploiDuTemps&&GApplication.droits.get(IEEnum.droits.absences.avecGestionGroupesGAEV);};ObjetAffichagePageEmploiDuTemps.prototype._actionSurRequeteFicheCDT=function(aGenreAffichageEDT ,aCahierDeTextes){if(this.identFicheCdt) this.GetInstance(this.identFicheCdt).Fermer();this.GetInstance(this.identFicheCdt).SetDonnees(this.paramCours.id,aCahierDeTextes.Matiere,aCahierDeTextes.ListeTravailAFaire,aGenreAffichageEDT,aCahierDeTextes);};function _surEchecFicheCours(aMessage){var lMessage=aMessage&&(aMessage.length>0)?aMessage:GTraductions.getValeur('requete.erreur');GApplication.getMessage().Afficher(EGenreBoiteMessage.Information,null,lMessage);this.AfficherPage();}
function _actionSurRequeteFicheCours(aParamMenuContextuel ,aListeCours,aListeEleves,aAfficherClasse){var lFicheCoursOuvert=this.GetInstance(this.IdentFicheCours)&&this.GetInstance(this.IdentFicheCours).EnAffichage;var lEvenementMenuContextuel=aParamMenuContextuel&&aParamMenuContextuel.cours;this.fermerFiches();if(this.avecListeEleves){this.paramCours.listeEleves=aListeEleves;GStyle.setVisible(this.GetInstance(this.identListeEleves).GetNom(),true);if(this._autorisationEditionGroupeGAEVSurContexte())
this.GetInstance(this.identListeEleves).setOptionsListe({listeCreations:1,creationLigne:-1});else this.GetInstance(this.identListeEleves).setOptionsListe({listeCreations:null,creationLigne:null});this.GetInstance(this.identListeEleves).SetDonnees(new window.DonneesListe_Eleves(aListeEleves));this.GetInstance(this.identListeEleves).setColonnesCachees(aAfficherClasse?[]:[window.DonneesListe_Eleves.genreColonne.Classe]);}
if(lFicheCoursOuvert||!lEvenementMenuContextuel){var lDonnees={id:this.paramCours.id,listeCours:aListeCours,coursSelectionne:this.paramCours.cours,numeroSemaine:this.Selection,nonEditable:true,callBackMemo:_surMemoFicheCours.bind(this),callbackCDT:_surCDTFicheCours.bind(this),callbackEntete:_surEnteteFicheCours.bind(this)};if(this.moduleSaisie){$.extend(lDonnees,this.moduleSaisie.getDonneesFicheCours());}
this.GetInstance(this.IdentFicheCours).setDonnees_FicheCours(lDonnees);}
if(lEvenementMenuContextuel){var lCours=aParamMenuContextuel.cours;if(_avecMenuContextuel.bind(this)()){this._afficherMenuContextuelDeCours(lCours,aParamMenuContextuel.forcerNavigationClavier);}}}
function _surMemoFicheCours(aParams){if(this.GetInstance(this.IdentFicheCours))
this._objGestionFocus_apresFiche={id:this.GetInstance(this.IdentFicheCours).IdPremierElement};else this._objGestionFocus_apresFiche=null;this.GetInstance(this.identFenetreMemo).SetDonnees({contenu:aParams.cours.memo,nonEditable:aParams.nonEditable,callback:this.moduleSaisie?this.moduleSaisie.evenementSurMemo.bind(this.moduleSaisie,aParams):_evenementSurMemo.bind(this,aParams)});}
function _evenementSurMemo(aParams ,aNumeroBouton,aMemo){this._gestionFocus_apresFiche();}
function _surReponseRequeteSaisieElevesGAEV(aJSON,aGenreReponse){this._requeteFiche(this.paramCours.cours,true);this.SetEtatSaisie(false);}
function _surCDTFicheCours(aCours,aNumeroSemaine){if(this.GetInstance(this.IdentFicheCours))
this._objGestionFocus_apresFiche={id:this.GetInstance(this.IdentFicheCours).IdPremierElement};else this._objGestionFocus_apresFiche=null;new ObjetRequeteFicheCDT(this,this._actionSurRequeteFicheCDT.bind(this,EGenreAffichageCahierDeTextes.ContenuDeCours)).lancerRequete({cours:aCours,numeroSemaine:aNumeroSemaine});}
function _surEnteteFicheCours(aCours){this.GetInstance(this.IdentGrille).getInstanceGrille().SelectionnerElementParNumero(aCours.GetNumero(),true,true);}
ObjetAffichagePageEmploiDuTemps.prototype.AfficherPage=function(){this.RecupererDonnees();};ObjetAffichagePageEmploiDuTemps.prototype.EvenementAfficherMessage=function(aGenreMessage){GStyle.setDisplay(this.GetNomInstance(this.IdentCalendrier),false);GStyle.setVisible(this.GetNomInstance(this.IdentICal),false);GStyle.setVisible(this.GetNomInstance(this.IdentBtnCoursAnnule),false);if(this.avecListeEleves)
GStyle.setDisplay(this.GetNomInstance(this.identListeEleves),false);if(this.IdentBtnOccupationProf)
GStyle.setVisible(this.GetInstance(this.IdentBtnOccupationProf).GetNom(),false);this._EvenementAfficherMessage(aGenreMessage);};ObjetAffichagePageEmploiDuTemps.prototype.surResizeInterface=function(){this.inherited('surResizeInterface');if(this.avecListeEleves)
GPosition.setHeight(this.GetInstance(this.identListeEleves).GetNom(),0);GPosition.declencherResize(this.GetInstance(this.IdentGrille).GetNom(),0,true);if(this.avecListeEleves)
GPosition.setHeight(this.GetInstance(this.identListeEleves).GetNom(),GPosition.getHeight(this.Nom)-10);this.GetInstance(this.IdentCalendrier).SurPostResize();};function _getParametresPDF(){var lRenvois=[TypeGestionRenvoisImp.impRenvoisAucun,TypeGestionRenvoisImp.impRenvoisSousBloc,TypeGestionRenvoisImp.impRenvoisApresPage];var lResult={genreGenerationPDF:TypeHttpGenerationPDF.EDT,ressource:this.ressource,numeroSemaine:this.Selection,avecCoursAnnules:this.donneesGrille.avecCoursAnnule,PARAMETRE_FENETRE:{choixRenvois:lRenvois}};return lResult;}
function _evenementSurMenuContextuel(aLigne){if(aLigne){var lTraite=false;if(this.moduleSaisie){lTraite=this.moduleSaisie.evenementSurMenuContextuel(aLigne);}
;}
else this._gestionFocus_apresMenuContextuel();}
ObjetAffichagePageEmploiDuTemps.prototype._gestionFocus_apresFiche=function(aGenreEvenement){if(this._objGestionFocus_apresFiche&&this._objGestionFocus_apresFiche.id){GHtml.setFocus(this._objGestionFocus_apresFiche.id);this._objGestionFocus_apresFiche=null;}
else this.GetInstance(this.IdentGrille).SelectionnerGrille();};ObjetAffichagePageEmploiDuTemps.prototype._gestionFocus_apresMenuContextuel=function(aGenreEvenement){if(this._gestionFocus_apresMenuContext&&this._gestionFocus_apresMenuContext.id){GHtml.setFocus(this._gestionFocus_apresMenuContext.id);this._gestionFocus_apresMenuContext=null;}
else this.GetInstance(this.IdentGrille).SelectionnerGrille();};})();;
ObjetAffichagePageEmploiDuTemps.prototype.AfficherListe=function(){this._objetListeArborescente=new ObjetListeArborescente(this.Nom+'_Liste',0,this,null);var lRacine=this._objetListeArborescente.construireRacine();this._objetListeArborescente.setParametres(false);var lTitre=GDate.strSemaine(this.donneesGrille.numeroSemaine,'%JJJJ %JJ %MMMM','%JJJJ %JJ %MMMM',GEtatUtilisateur.getLibelleOnglet()+' '+GTraductions.getValeur('Du')+' ',' '+GTraductions.getValeur('Au')+' ');var lNoeudListeCours=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lRacine,'',lTitre,'Gras',true,true);var lJour=null,lNoeudJours;for(var I=0;I<this.donneesGrille.listeCours.GetNbrElements();I++){var lCours=this.donneesGrille.listeCours.GetElement(I);if(!lJour||!GDate.estJourEgal(lJour,lCours.DateDuCours)){lJour=GDate.GetJour(lCours.DateDuCours);lNoeudJours=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lNoeudListeCours,'',GDate.FormatDate(lJour,'%JJJJ %JJ %MMMM'),'Gras');}
var lMatiere=lCours.ListeContenus.GetElementParGenre(EGenreRessource.Matiere);if(lMatiere){var lLibelleCours=lMatiere.GetLibelle()+' '+GTraductions.getValeur('A')+' '+GDate.FormatDate(lCours.DateDuCours,'%hhh%mm');if(lCours.Statut)
lLibelleCours+=' '+'('+lCours.Statut+')';var lNoeudCours=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lNoeudJours,'',lLibelleCours,'Gras');var lHtml=[];for(var J=0;J<lCours.ListeContenus.GetNbrElements();J++){var lContenu=lCours.ListeContenus.GetElement(J);if(lContenu.GetLibelle().length&&(lContenu.Visible!==false)&&(lContenu.GetGenre()!==EGenreRessource.Matiere)&&!lContenu.nePasImprimer)
lHtml.push('<div>',lContenu.GetLibelle(),'</div>');}
this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudCours,'',lHtml.join(''));}}
GHtml.setHtml(this.GetNomInstance(this.IdentGrille),this._objetListeArborescente.ConstruireAffichage());this._objetListeArborescente.SetDonnees(lRacine);};;
MethodesObjet.heritagePrototype(_ObjetAffichagePagePresence,ObjetAbstraitInterface);function _ObjetAffichagePagePresence(ANom,AIdent,APere,AEvenement){this.inheritedCreate(ANom,AIdent,APere,AEvenement);this.donnees={listeRecapitulatifs:new ObjetListeElements(),listeAbsences:new ObjetListeElements(),apresValidation:false,elementSelection:null};}
_ObjetAffichagePagePresence.prototype.getChaineTraductionGenreAbsenceTitre=function(aObjet){switch(aObjet.genre){case EGenreRessource.ObservationProfesseurEleve:if(aObjet.estLue)
return aObjet.singulier?GTraductions.getValeur('AbsenceVS.observationLue'):GTraductions.getValeur('AbsenceVS.observationsLue');else return aObjet.singulier?GTraductions.getValeur('AbsenceVS.observationNonLue'):GTraductions.getValeur('AbsenceVS.observationsNonLue');break;case EGenreRessource.Absence:if(aObjet.justifie)
return aObjet.singulier?GTraductions.getValeur('AbsenceVS.absenceCoursJust'):GTraductions.getValeur('AbsenceVS.absencesCoursJust');else return aObjet.singulier?GTraductions.getValeur('AbsenceVS.absenceCoursNonJust'):GTraductions.getValeur('AbsenceVS.absencesCoursNonJust');break;case EGenreRessource.AbsenceRepas:return aObjet.singulier?GTraductions.getValeur('AbsenceVS.absenceRepas'):GTraductions.getValeur('AbsenceVS.absencesRepas');case EGenreRessource.AbsenceInternat:return aObjet.singulier?GTraductions.getValeur('AbsenceVS.absenceInternat'):GTraductions.getValeur('AbsenceVS.absencesInternat');case EGenreRessource.Retard:return aObjet.singulier?GTraductions.getValeur('AbsenceVS.retard'):GTraductions.getValeur('AbsenceVS.retards');case EGenreRessource.Infirmerie:return aObjet.singulier?GTraductions.getValeur('AbsenceVS.infirmerie'):GTraductions.getValeur('AbsenceVS.infirmeries');case EGenreRessource.Exclusion:return aObjet.singulier?GTraductions.getValeur('AbsenceVS.exclusion'):GTraductions.getValeur('AbsenceVS.exclusions');case EGenreRessource.Punition:switch(aObjet.genreNature){case EGenrePunition.Exclusion:return aObjet.singulier?GTraductions.getValeur('AbsenceVS.exclusion'):GTraductions.getValeur('AbsenceVS.exclusions');case EGenrePunition.Retenues:case EGenrePunition.TIG:case EGenrePunition.Devoir:case EGenrePunition.Autre:return aObjet.singulier?GTraductions.getValeur('AbsenceVS.punition'):GTraductions.getValeur('AbsenceVS.punitions');default:;return'';}
break;case EGenreRessource.MesureConservatoire:return aObjet.singulier?GTraductions.getValeur('AbsenceVS.mesureConservatoire'):GTraductions.getValeur('AbsenceVS.mesuresConservatoires');case EGenreRessource.Sanction:return aObjet.singulier?GTraductions.getValeur('AbsenceVS.sanction'):GTraductions.getValeur('AbsenceVS.sanctions');case EGenreRessource.Incident:return aObjet.singulier?GTraductions.getValeur('AbsenceVS.incident'):GTraductions.getValeur('AbsenceVS.incidents');default:;return'';}};_ObjetAffichagePagePresence.prototype.getChaineTraductionGenreAbsence=function(aObjet){switch(aObjet.genre){case EGenreRessource.ObservationProfesseurEleve:if(aObjet.estLue)
return GTraductions.getValeur('AbsenceVS.observationLue');else return GTraductions.getValeur('AbsenceVS.observationNonLue');break;case EGenreRessource.Absence:if(aObjet.justifie)
return GTraductions.getValeur('AbsenceVS.absencesRecapJust');else return GTraductions.getValeur('AbsenceVS.absencesRecapNonJust');break;case EGenreRessource.AbsenceRepas:return GTraductions.getValeur('AbsenceVS.absenceRepas');case EGenreRessource.AbsenceInternat:return GTraductions.getValeur('AbsenceVS.absenceInternat');case EGenreRessource.Retard:return GTraductions.getValeur('AbsenceVS.retard');case EGenreRessource.Infirmerie:return GTraductions.getValeur('AbsenceVS.infirmerie');case EGenreRessource.Exclusion:return GTraductions.getValeur('AbsenceVS.exclusion');case EGenreRessource.Punition:if(aObjet.estLIncident)
return GTraductions.getValeur('AbsenceVS.incidentPunition');switch(aObjet.genreNature){case EGenrePunition.Exclusion:return GTraductions.getValeur('AbsenceVS.exclusion');case EGenrePunition.Retenues:return GTraductions.getValeur('AbsenceVS.retenue');case EGenrePunition.TIG:return GTraductions.getValeur('AbsenceVS.TIG');case EGenrePunition.Devoir:return GTraductions.getValeur('AbsenceVS.devoirSuppl');case EGenrePunition.Autre:return GTraductions.getValeur('AbsenceVS.punitionAutre');default:;return'';}
break;case EGenreRessource.MesureConservatoire:return aObjet.libelle?aObjet.libelle:GTraductions.getValeur('AbsenceVS.mesureConservatoire');case EGenreRessource.Sanction:return aObjet.libelle?aObjet.libelle:GTraductions.getValeur('AbsenceVS.sanctionAutre');case EGenreRessource.Incident:switch(aObjet.genreNature){case EGenreRessource.Punition:return GTraductions.getValeur('AbsenceVS.LieAPunition');case EGenreRessource.Sanction:return GTraductions.getValeur('AbsenceVS.LieASanction');case EGenreRessource.MesureConservatoire:return GTraductions.getValeur('AbsenceVS.LieAMesureConservatoire');case EGenreRessource.Aucune:return GTraductions.getValeur('AbsenceVS.SansMesureDiciplinaire');default:;return'';}
break;default:;return'';}};_ObjetAffichagePagePresence.prototype.getLigne2AbsenceAccessible=function(aAbsence){var lResult='';switch(aAbsence.Genre){case EGenreRessource.ObservationProfesseurEleve:lResult+=this.utilitaireAbsence.getDemandeurDecideur(aAbsence,true);break;case EGenreRessource.Absence:case EGenreRessource.Retard:lResult+=this.utilitaireAbsence.getMotifAbsence({donnee:aAbsence,enListe:false});break;case EGenreRessource.AbsenceRepas:case EGenreRessource.AbsenceInternat:lResult+=(aAbsence.listeMotifs&&aAbsence.listeMotifs.GetNbrElements()>0)?aAbsence.listeMotifs.getTableauLibelles().join(', '):'';break;case EGenreRessource.Infirmerie:break;case EGenreRessource.Exclusion:case EGenreRessource.Punition:case EGenreRessource.Sanction:lResult+=this.utilitaireAbsence.getModalitesPunitionSanction(aAbsence);break;default:break;}
return lResult.ucfirst();};_ObjetAffichagePagePresence.prototype.surResizeInterface=function(){this.inherited('surResizeInterface');};;
MethodesObjet.heritagePrototype(ObjetAffichageAnnuel,Identite);function ObjetAffichageAnnuel(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.tableauIDs=[];this.hauteurCellule=0;this.largeurCellule=0;this.parametres={premiereDate:null,derniereDate:null,avecJoursOuvres:true,avecBordure:false,alignementVertical:'AlignementMilieu',avecImage3Points:false,hauteurMinimal:21,largeurMinimal:21};}
ObjetAffichageAnnuel.prototype.SetParametres=function(aParametres){$.extend(this.parametres,aParametres);this.largeurMinimalObjet=(78+(31*(this.parametres.largeurMinimal+1)));this.hauteurMinimalObjet=20+20+(GDate.NombreMoisSurPeriode(this.parametres.premiereDate,this.parametres.derniereDate)*(this.parametres.hauteurMinimal+4));};ObjetAffichageAnnuel.prototype.SetDonnees=function(aListeDonnees){this.DonneesRecues=true;this.listeDonnees=aListeDonnees;this.actualiser(true);};ObjetAffichageAnnuel.prototype.getAvecDonnees=function(){return this.DonneesRecues;};ObjetAffichageAnnuel.prototype.getLargeurMinimalGrille=function(){return this.largeurMinimalObjet;};ObjetAffichageAnnuel.prototype.getHauteurMinimalGrille=function(){return this.hauteurMinimalObjet;};ObjetAffichageAnnuel.prototype.actualiserGrille=function(){this.actualisationEnCours=true;this.actualiser(false);this.actualisationEnCours=false;};ObjetAffichageAnnuel.prototype.actualiserDonnees=function(aListeDonnees,aViderDoneesExistantes){if(aViderDoneesExistantes)
this.viderGrille();this.DonneesRecues=true;this.listeDonnees=aListeDonnees;this.composeDonnees();};ObjetAffichageAnnuel.prototype.actualiser=function(aAvecDonnees){if(GDate.estDateValide(this.parametres.premiereDate)&&GDate.estDateValide(this.parametres.derniereDate)){GHtml.setHtml(this.Nom,'');this.tableauIDs=[];this.Afficher();this.calculerDimensions();if(aAvecDonnees&&this.DonneesRecues)
this.composeDonnees();} else ;};ObjetAffichageAnnuel.prototype.ConstruireAffichage=function(){if(!this.DonneesRecues&&!this.actualisationEnCours)
return'';return this.ComposePage(false);};ObjetAffichageAnnuel.prototype.ComposePage=function(aPourImpression){var T=[];T.push('<div style="height:100%">');T.push(this.composeTableauAnnuel(aPourImpression));T.push('</div>');return T.join('');};ObjetAffichageAnnuel.prototype.composeTableauAnnuel=function(aPourImpression){var lAnnee=this.parametres.premiereDate.getFullYear();var lMois=this.parametres.premiereDate.getMonth();var lDate;var lStyle;var lID=null;var lHtml=[];lMois--;lHtml.push('<table class="Tableau Table Texte10 Gras ',this.parametres.alignementVertical,'" style="',GTableau.styleTableau(aPourImpression,true),'" border="0" cellpadding="0" cellspacing="0">');var N=GDate.NombreMoisSurPeriode(this.parametres.premiereDate,this.parametres.derniereDate)+1;for(var I=0;I<N;I++){if(I>0){lMois++;if(lMois===12){lMois=0;lAnnee++;}}
lHtml.push('<tr>');for(var J=0;J<=31;J++){if((I===0)||(J===0))
lStyle=GTableau.styleTitre(aPourImpression);else lStyle=GStyle.composeCouleurBordure(GCouleur.liste.getBordure(aPourImpression));var lCellule='',lCouleur;if(I>0&&J>0){if(!GDate.JourEstDansLaPeriode(lAnnee,lMois,J,this.parametres.premiereDate,this.parametres.derniereDate)||(!GDate.EstUnJourDuMois(lAnnee,lMois,J))){lID=null;lCouleur=aPourImpression?GCouleur.fenetre.fond:GCouleur.fond;lStyle+=' '+GStyle.composeCouleur(lCouleur);if(!GDate.EstUnJourDuMois(lAnnee,lMois,J))
lStyle=GStyle.composeCouleurBordure(GCouleur.liste.cellule.getFond(aPourImpression),1,EGenreBordure.droite+(I===N-1?EGenreBordure.bas:0));} else{lDate=new Date(lAnnee,lMois,J);var lEstUnJourOuvre=GDate.estUnJourOuvre(lDate);lID=this.getIdCellule(lDate,null,aPourImpression);this.tableauIDs.push(lID);lCouleur=!this.parametres.avecJoursOuvres||lEstUnJourOuvre?GCouleur.blanc:(aPourImpression?GCouleur.fenetre.nonEditable.fond:GCouleur.nonEditable.fond);lStyle+=' '+GStyle.composeCouleur(lCouleur);lCellule='<div id="'+lID+'" style="'+GStyle.composeWidth(100,'%')+GStyle.composeHeight(100,'%')+'"></div>';}}
lHtml.push('<td',(lID?' id="'+lID+'_td"':''),' class="',(I===0||J===0?'AlignementMilieu':this.parametres.alignementVertical),'" ','style="',lStyle,GStyle.composeWidth(3.125,'%'),' min-width : '+(this.parametres.largeurMinimal)+'px;',(I===0?' height : 20px;':' min-height : '+(this.parametres.hauteurMinimal+1+(this.parametres.avecImage3Points?4:0))+'px;'),'">');if(I===0)
lHtml.push(J===0?'&nbsp;':J);else lHtml.push(J===0?'<div class="PetitEspace">'+GDate.StrMoisCourt(lAnnee,lMois,true)+'</div>':lCellule);lHtml.push('</td>');}
lHtml.push('</tr>');}
lHtml.push('</table>');return lHtml.join('');};ObjetAffichageAnnuel.prototype.composeDonnees=function(aPourImpression){var lHtml='';var lID='';var lMarge='';var lContent='';var lStyle='';for(var I=0;I<this.listeDonnees.GetNbrElements();I++){var lElement=this.listeDonnees.GetElement(I);lID=this.getIdCellule(lElement.Date,null,aPourImpression);var lMonID=lID+'_Item'+I;if(this.parametres.avecBordure)
lStyle=GStyle.composeCouleurBordure(lElement.couleurBordure);lHtml=GHtml.getHtml(lID);lMarge=GStyle.composeMarge(lHtml===''?2:1,1,lElement.estUneSuite?0:2,lElement.aUneSuite?0:2);lContent=lElement.html;lHtml+='<div id="'+lMonID+'" '+(aPourImpression?'':'onclick="'+this.Nom+'.evenementSurGrille(id,'+I+');" ')+'class="Table AlignementGauche AvecMain'+(this.donneesAvecFondBlanc?' FondBlanc':'')+'" style="overflow-x: auto; '+lMarge+lStyle+'" '+'>';lHtml+=lContent;lHtml+='</div>';GHtml.setHtml(lID,lHtml);if(lElement.title)
GHtml.setTitle(lMonID,lElement.title);if(lElement.couleurFond)
GStyle.setCouleurFond(lID+'_td',lElement.couleurFond);if(this.parametres.avecImage3Points&&lElement.avec3Points){GHtml.setHtml(lID+'_td',GHtml.getHtml(lID+'_td')+'<div class="Image_3Points" style="float:right"></div>');}}};ObjetAffichageAnnuel.prototype.viderGrille=function(){for(var i=0;i<this.tableauIDs.length;i++){GHtml.setHtml(this.tableauIDs[i],'');var lHtml=GHtml.getHtml(this.tableauIDs[i]+'_td');lHtml=lHtml.replace(/<div\sclass="Image_3Points".*?<\/div>/gi,'');GHtml.setHtml(this.tableauIDs[i]+'_td',lHtml);}};ObjetAffichageAnnuel.prototype.calculerDimensions=function(){if(this.tableauIDs.length>0){this.largeurCellule=Math.max(Math.floor(GPosition.getWidth(this.tableauIDs[0]+'_td'))-2,this.parametres.largeurMinimal);this.hauteurCellule=Math.max(Math.floor(GPosition.getHeight(this.tableauIDs[0]+'_td'))-2-(this.parametres.avecImage3Points?4:0),this.parametres.hauteurMinimal);for(var i=0;i<this.tableauIDs.length;i++){GPosition.setTaille(this.tableauIDs[i],this.largeurCellule,this.hauteurCellule);GPosition.setHeight(this.tableauIDs[i]+'_td',this.hauteurCellule+1+(this.parametres.avecImage3Points?4:0));GHtml.addClass(this.tableauIDs[i],'SansOverflow');}} else{this.hauteurCellule=0;this.largeurCellule=0;}};ObjetAffichageAnnuel.prototype.getIdCellule=function(aDate,aGenre,aPourImpression){return this.Nom+'_sD'+GDate.FormatDate(aDate,'%JJ_%MM_%AA')+'eD_'+(aGenre===null||aGenre===undefined?'':aGenre)+(aPourImpression?'_imp':'');};ObjetAffichageAnnuel.prototype.getDateID=function(aID){var rExp=/(?:_sD)([\d_]{8,10})(?=eD_)/i;return GDate.getDateDeChaine(aID.match(rExp)[1]);};ObjetAffichageAnnuel.prototype.evenementSurGrille=function(aID,aNumero){var lElement=this.listeDonnees.GetElement(aNumero);this.callback.appel(aID,lElement);};;
MethodesObjet.heritagePrototype(ObjetAffichagePagePresence_enGrille,_ObjetAffichagePagePresence);function ObjetAffichagePagePresence_enGrille(ANom,AIdent,APere,AEvenement){this.inheritedCreate(ANom,AIdent,APere,AEvenement);this.idRecapitulatif=this.Nom+'_Recapitulatif';this.nombreRecapitulatifs=0;this.tailleImages=17;this.widthRecapitulatif=285;this.minWidthInterface=0;this.minCelWidth=22;this.minCelHeight=22;this.couleurExclusionDefinive='#FFD3D3';this.avecDonneesSurJoursNonOuvre=false;}
ObjetAffichagePagePresence_enGrille.prototype.ConstruireInstances=function(){this.identGrilleAnnuel=this.Add(window.ObjetAffichageAnnuel ,this.evenementAffichageAnnuel ,this.initialiserAffichageAnnuel);this.IdentFichePresence=this.Add(window.ObjetFichePresence ,this.evenementFichePresence ,this.initialiserFiche);};ObjetAffichagePagePresence_enGrille.prototype.SetParametresGeneraux=function(){this.GenreStructure=EStructureAffichage.Autre;};ObjetAffichagePagePresence_enGrille.prototype.ConstruireStructureAffichageAutre=function(){var lHtml=[];lHtml.push('<div class="Table" style="position: relative; min-height :',(this.GetInstance(this.identGrilleAnnuel).getHauteurMinimalGrille()+12),'px;">','<div id="',(this.GetInstance(this.identGrilleAnnuel).GetNom()),'" style="position: absolute; top: 6px; bottom: 5px; left: 5px; right: ',(this.widthRecapitulatif+10),'px;"></div>','<div id="',this.idRecapitulatif,'" style="position: absolute; width : ',this.widthRecapitulatif,'px; right: 5px;"></div>','</div>');return lHtml.join('');};ObjetAffichagePagePresence_enGrille.prototype.initialiserAffichageAnnuel=function(aInstance){aInstance.SetParametres({premiereDate:GParametres.PremiereDate,derniereDate:GParametres.DerniereDate,avecJoursOuvres:true,avecBordure:false,alignementVertical:'AlignementHaut',avecImage3Points:true,hauteurMinimal:this.minCelHeight,largeurMinimal:this.minCelWidth});};ObjetAffichagePagePresence_enGrille.prototype.initialiserFiche=function(aInstance){};ObjetAffichagePagePresence_enGrille.prototype.setDonnees=function(aDonnees,aSeulementActualiser){if(this.GetInstance(this.IdentFichePresence)&&this.donnees.elementSelection!==aDonnees.elementSelection)
this.GetInstance(this.IdentFichePresence).Fermer(false);$.extend(this.donnees,aDonnees);this.listeAbsences=this.listeAbsencesSelonSelection(this.donnees.elementSelection);if(GEtatUtilisateur.estModeAccessible()){this.AfficherListe();} else{if(this.donnees.message){GHtml.setHtml(this.Nom,this.composeMessage(this.donnees.message));} else if(this.donnees.listeAbsences.GetNbrElements()===0){GHtml.setHtml(this.Nom,this.composeMessage(GTraductions.getValeur('AbsenceVS.AucuneAbsence')));} else{GHtml.setHtml(this.idRecapitulatif,this.composeAffichageRecapitulatif(this.donnees.listeRecapitulatifs));if(this.GetInstance(this.identGrilleAnnuel)){if(!aSeulementActualiser) this.GetInstance(this.identGrilleAnnuel).actualiserGrille();var lDonnees=this.formatDonnees(this.listeAbsences,this.GetInstance(this.identGrilleAnnuel).hauteurCellule,this.GetInstance(this.identGrilleAnnuel).largeurCellule-4);this.GetInstance(this.identGrilleAnnuel).actualiserDonnees(lDonnees,aSeulementActualiser);}}}};(function(){function _filtreAbsencesDeJourCalendrier(aElementCalendrier,aElement,aIndice){return MethodesTableau.existe(aIndice,aElementCalendrier.indices);}
ObjetAffichagePagePresence_enGrille.prototype.evenementAffichageAnnuel=function(aID,aElementCalendrier){var lListeAbsencesFiche=this.listeAbsences.getListeElements(_filtreAbsencesDeJourCalendrier.bind(this,aElementCalendrier));this.GetInstance(this.IdentFichePresence).SetDonnees(aID,GDate.FormatDate(aElementCalendrier.Date,GTraductions.getValeur('Le').ucfirst()+' %J %MMMM %AAAA'),lListeAbsencesFiche,this.donnees.autorisations);};}());(function(){function _filtreAbsencesSelonGenreDeCombo(aElementSelection,aElement){return aElementSelection.GetGenre()===aElement.GetGenre()&&(aElementSelection.GetGenre()!==EGenreRessource.Absence||aElementSelection.justifie===aElement.justifie)&&(aElementSelection.GetGenre()!==EGenreRessource.ObservationProfesseurEleve||aElementSelection.estLue===aElement.estLue)&&((aElementSelection.GetGenre()!==EGenreRessource.Punition)||(aElementSelection.estPunitionExclusion&&aElement.nature.GetGenre()===EGenrePunition.Exclusion)||(!aElementSelection.estPunitionExclusion&&aElement.nature.GetGenre()!==EGenrePunition.Exclusion));}
ObjetAffichagePagePresence_enGrille.prototype.listeAbsencesSelonSelection=function(aElementSelection){return aElementSelection===null||aElementSelection===undefined||aElementSelection.GetGenre()=== -1?this.donnees.listeAbsences:this.donnees.listeAbsences.getListeElements(_filtreAbsencesSelonGenreDeCombo.bind(this,aElementSelection));};}());ObjetAffichagePagePresence_enGrille.prototype.evenementFichePresence=function(aAvecSaisie,aAbsence){this.callback.appel(aAvecSaisie,aAbsence);};ObjetAffichagePagePresence_enGrille.prototype.composeAffichageRecapitulatif=function(aListeRecapitulatifs){var lHtml=[];var lID=this.Nom+'_recapitulatif';lHtml.push('<fieldset class="',GClass.getZone(),' FondBlanc" style="margin:0px 0px 0px 0px; ',GStyle.composeHeight(100,'%'),'">','<legend id="',lID,'" class="Texte10 Gras" ','tabIndex="0" class="wai_hidden" onfocus="',this.Nom,'.ActiverBordureAbsence (id, true);" ','onblur="',this.Nom,'.ActiverBordureAbsence (id, false);" ','onkeyup="',this.Nom,'.NavigationClavier (id); if (GNavigateur.IsToucheFleche () || GNavigateur.IsToucheSelection ()) GNavigateur.StopperEvenement (event);">',this.getRecapitulatif_Titre(),'</legend>','<div id="',lID,'_grille" class="BordureNavigationInactive" style="padding-top : 0px; padding-left : 5px; ','" tabIndex="-1">',GObjetWAI.composeSpan(this.getRecapitulatif_Titre()));var lListe=aListeRecapitulatifs.getListeElements(function(aElement,aIndice){return aElement.Nombre>0;});if(lListe.GetNbrElements()){this.AjouterAuTableaux(this.IdMatPrecedent,lID,null,EGenreDirection.SensNormal);this.IdRecapPrecedent=lID;lHtml.push('<table class="Table Texte10" border="0" cellspacing="0" cellpadding="0">');for(var I=0;I<lListe.GetNbrElements();I++)
lHtml.push(this.composeLigneDeRecapitulatif(lListe.GetElement(I)));lHtml.push('</table>');} else{lHtml.push('<table class="Table Texte10 Gras" border="0" cellspacing="0" cellpadding="0">','<tr><td width="25"></td><td><div tabIndex="0">',GTraductions.getValeur('AbsenceVS.AucuneAbsence'),'</div></td></tr>','</table>');}
lHtml.push('</div>','</fieldset>');this.ancienGenreRecapitulatif=null;return lHtml.join('');};ObjetAffichagePagePresence_enGrille.prototype.composeLigneDeRecapitulatif=function(aRecapitulatif){var lGenre=aRecapitulatif.Genre;var lJust=aRecapitulatif.justifie?'_Just_':'_Njust_';var lID=this.Nom+'_Recap_'+lGenre+lJust+((lGenre===EGenreRessource.Punition||lGenre===EGenreRessource.Sanction)?aRecapitulatif.genreNature:'');var lOnFocus=this.Nom+'.ActiverBordureAbsence (id, true);';var lOnBlur=this.Nom+'.ActiverBordureAbsence (id, false);';var H=[];var lImage='';if(aRecapitulatif.Nombre){if(((lGenre===EGenreRessource.Punition)||lGenre===EGenreRessource.Sanction||lGenre===EGenreRessource.Incident)&&(lGenre!==this.ancienGenreRecapitulatif)){H.push(this.composeLigneVideRecap());H.push('<tr>');H.push('<td class="Texte10 AlignementHaut" style="'+GStyle.composeWidth(25)+'">');lImage=EGenreRessource.getNomImageAbsence({genre:aRecapitulatif.Genre,genreNature:aRecapitulatif.genreNature,justifie:aRecapitulatif.justifie,estProgrammation:aRecapitulatif.estProgrammation,estLue:aRecapitulatif.estLue});H.push('<div class="'+lImage+'" style="'+GStyle.composeWidth(this.tailleImages)+'"></div>');H.push('</td>');H.push('<td class="Texte10 AlignementHaut PetitEspaceHaut" style="line-height: 12px; padding-top: 2px;">');H.push('<div class="Texte10 Gras">'+this.getChaineTraductionGenreAbsenceTitre({genre:aRecapitulatif.Genre,justifie:aRecapitulatif.justifie,genreNature:aRecapitulatif.genreNature,estLue:aRecapitulatif.estLue,singulier:true}).toUpperCase()+'</div>');H.push(this.ComposeElementNavigation(lID,this.getRecapitulatif_Libelle(aRecapitulatif,true),null,null,null,lOnFocus,lOnBlur,null,true,null,this.getRecapitulatif_Libelle(aRecapitulatif,true)));H.push('<span id="'+lID+'_grille" class="BordureNavigationInactive Texte10 Gras">'+this.getRecapitulatif_Libelle(aRecapitulatif)+'&nbsp;:</span>');H.push('</td>');H.push('<td class="AlignementDroit AlignementBas" style="line-height: 12px; padding-top: 2px;"><span class="Texte10 Gras">'+aRecapitulatif.Nombre+'</span></td>');H.push('</tr>');this.ancienGenreRecapitulatif=lGenre;} else{if(!(lGenre===this.ancienGenreRecapitulatif&&lGenre!==EGenreRessource.Absence))
H.push(this.composeLigneVideRecap());H.push('<tr>');H.push('<td class="Texte10 AlignementHaut" style="'+GStyle.composeWidth(25)+'">');lImage=lGenre===this.ancienGenreRecapitulatif&&lGenre!==EGenreRessource.Absence&&lGenre!==EGenreRessource.ObservationProfesseurEleve?'':EGenreRessource.getNomImageAbsence({genre:aRecapitulatif.Genre,genreNature:aRecapitulatif.genreNature,justifie:aRecapitulatif.justifie,estProgrammation:aRecapitulatif.estProgrammation,estLue:aRecapitulatif.estLue});H.push('<div class="'+lImage+'" style="'+GStyle.composeWidth(this.tailleImages)+'"></div>');H.push('</td>');H.push('<td class="Texte10 AlignementHaut PetitEspaceHaut" style="line-height: 12px; padding-top: 2px;">');H.push(this.ComposeElementNavigation(lID,this.getRecapitulatif_Libelle(aRecapitulatif,true),null,null,null,lOnFocus,lOnBlur,null,true,null,this.getRecapitulatif_Libelle(aRecapitulatif,true)));H.push('<span id="'+lID+'_grille" class="BordureNavigationInactive Texte10 Gras">'+this.getRecapitulatif_Libelle(aRecapitulatif)+'&nbsp;:</span>');if(aRecapitulatif.Genre===EGenreRessource.Absence)
H.push('<br><span class="Texte10">'+this.getCoursManquees(aRecapitulatif)+'</span>');if(aRecapitulatif.Genre===EGenreRessource.Absence&&!aRecapitulatif.justifie)
H.push('<br><div class="Texte10 Italique PetitEspaceHaut">'+GTraductions.getValeur('AbsenceVS.InfoNonJustifie')+'</div>');H.push('</td>');H.push('<td class="AlignementDroit AlignementHaut" style="line-height: 12px; padding-top: 2px;"><span class="Texte10 Gras">'+aRecapitulatif.Nombre+'</span></td>');H.push('</tr>');}
this.AjouterAuTableaux(this.IdRecapPrecedent,lID,null,EGenreDirection.DeuxSenses);this.IdRecapPrecedent=lID;this.ancienGenreRecapitulatif=lGenre;if(lGenre===EGenreRessource.Punition&&(aRecapitulatif.genreNature===EGenrePunition.Exclusion))
this.ancienGenreRecapitulatif=null;}
return H.join('');};ObjetAffichagePagePresence_enGrille.prototype.composeLigneVideRecap=function(){return'<tr style="'+GStyle.composeHeight(8)+'"><td colspan="3" style="'+GStyle.composeHeight(8)+'"><div style="'+GStyle.composeHeight(8)+'"></div></td></tr>';};ObjetAffichagePagePresence_enGrille.prototype.getRecapitulatif_Titre=function(){var lAnnee=GParametres.PremiereDate.getFullYear();return GTraductions.getValeur('AbsenceVS.Recapitulatif_TitreAnnuel',[lAnnee+' / '+(lAnnee+1)]);};ObjetAffichagePagePresence_enGrille.prototype.getRecapitulatif_Libelle=function(aRecapitulatif,aWai){var lResult=this.getChaineTraductionGenreAbsence({genre:aRecapitulatif.Genre,justifie:aRecapitulatif.justifie,genreNature:aRecapitulatif.genreNature,libelle:aRecapitulatif.Genre!==EGenreRessource.Sanction?aRecapitulatif.Genre!==EGenreRessource.MesureConservatoire?null:aRecapitulatif.GetLibelle().toUpperCase():aRecapitulatif.GetLibelle(),estLue:aRecapitulatif.estLue});if(aWai){lResult+=' : '+aRecapitulatif.Nombre+'. ';if(aRecapitulatif.Genre===EGenreRessource.Absence)
lResult+=this.getCoursManquees(aRecapitulatif,aWai);}
return lResult.ucfirst();};ObjetAffichagePagePresence_enGrille.prototype.getCoursManquees=function(aRecapitulatif,aWai){return GTraductions.getValeur('AbsenceVS.heuresCoursManquees',aWai?[GObjetWAI.formatHeure(aRecapitulatif.NbrHeures)]:[aRecapitulatif.NbrHeures]);};ObjetAffichagePagePresence_enGrille.prototype.ActiverBordureAbsence=function(aID,aBool,aDetail){var lID=aID+'_grille';if(aBool){GHtml.delClass(lID,'BordureNavigationInactive');GHtml.addClass(lID,'BordureNavigationActive');} else{GHtml.delClass(lID,'BordureNavigationActive');GHtml.addClass(lID,'BordureNavigationInactive');}};(function(){function _filtreParJour(aDate,aElement){return GDate.estJourEgal(aDate,aElement.Date);}
ObjetAffichagePagePresence_enGrille.prototype.formatDonnees=function(aListeDonnees,aHauteur,aLargeur){var lResult=new ObjetListeElements();var lImage;var I=0;var lElement=null;for(I=0;I<aListeDonnees.GetNbrElements();I++){lElement=aListeDonnees.GetElement(I);if(lElement.dateDebut&&lElement.dateFin){var lDateDebut=new Date(lElement.dateDebut.getFullYear(),lElement.dateDebut.getMonth(),lElement.dateDebut.getDate());var lDateFin=new Date(lElement.dateFin.getFullYear(),lElement.dateFin.getMonth(),lElement.dateFin.getDate());for(var lDate=lDateDebut;lDate<=lDateFin;lDate=GDate.GetJourSuivant(lDate))
if(GDate.estUnJourOuvre(lDate)||this.avecDonneesSurJoursNonOuvre){var lIndice=lResult.getIndiceElementParFiltre(_filtreParJour.bind(this,lDate));var newElement;if(lIndice> -1){newElement=lResult.GetElement(lIndice);newElement.indices.push(I);if(lElement.Genre===EGenreRessource.Sanction&&lElement.nature.Genre===EGenreSanction.ExclusionDefinitive&&!lElement.avecSursis)
newElement.couleurFond=this.couleurExclusionDefinive;if(!newElement.avec3Points){if(newElement.html){if(aLargeur-1-newElement.width>this.tailleImages||aHauteur-1-newElement.height>this.tailleImages){lImage=EGenreRessource.getNomImageAbsence({genre:lElement.GetGenre(),genreNature:lElement.nature?lElement.nature.GetGenre():null,justifie:lElement.justifie,estProgrammation:lElement.estProgrammation,estLue:lElement.estLue,avecSursis:lElement.avecSursis});if(lImage&&(lElement.Genre!==EGenreRessource.Sanction||lElement.nature.Genre!==EGenreSanction.ExclusionDefinitive||lDate===lDateDebut)){newElement.html+='<div class="'+lImage+'" style="display: inline-block; margin-right: 1px; margin-bottom: 1px; '+GStyle.composeWidth(this.tailleImages)+'"></div>';if(aLargeur-1-newElement.width>this.tailleImages)
newElement.width=newElement.width+this.tailleImages+1;else{newElement.height=newElement.height+this.tailleImages+1;newElement.width=this.tailleImages;}}} else newElement.avec3Points=true;} else{lImage=EGenreRessource.getNomImageAbsence({genre:lElement.Genre,genreNature:lElement.nature?lElement.nature.Genre:null,justifie:lElement.justifie,estProgrammation:lElement.estProgrammation,estLue:lElement.estLue,avecSursis:lElement.avecSursis});if(lImage&&(lElement.Genre!==EGenreRessource.Sanction||lElement.nature.Genre!==EGenreSanction.ExclusionDefinitive||lDate===lDateDebut)){newElement.html+='<div class="'+lImage+'" style="display: inline-block; margin-right: 1px; margin-bottom: 1px; '+GStyle.composeWidth(this.tailleImages)+'"></div>';newElement.width=this.tailleImages;newElement.height=this.tailleImages;}}}} else{newElement=new ObjetElement(lElement.Libelle,lElement.Numero,lElement.Genre,lElement.Position,lElement.Actif);newElement.indices=[];newElement.indices.push(I);newElement.Date=lDate;if(lElement.Genre===EGenreRessource.Sanction&&lElement.nature.Genre===EGenreSanction.ExclusionDefinitive&&!lElement.avecSursis)
newElement.couleurFond=this.couleurExclusionDefinive;lImage=EGenreRessource.getNomImageAbsence({genre:lElement.Genre,genreNature:lElement.nature?lElement.nature.Genre:null,justifie:lElement.justifie,estProgrammation:lElement.estProgrammation,estLue:lElement.estLue,avecSursis:lElement.avecSursis});if(lImage&&(lElement.Genre!==EGenreRessource.Sanction||lElement.nature.Genre!==EGenreSanction.ExclusionDefinitive||lDate===lDateDebut)){newElement.html='<div class="'+lImage+'" style="display: inline-block; margin-right: 1px; margin-bottom: 1px; '+GStyle.composeWidth(this.tailleImages)+'"></div>';newElement.width=this.tailleImages;newElement.height=this.tailleImages;} else if(lElement.Genre===EGenreRessource.Sanction&&lElement.nature.Genre===EGenreSanction.ExclusionDefinitive&&lDate>lDateDebut){newElement.title=GTraductions.getValeur('AbsenceVS.excluDefinitive',[GDate.FormatDate(lDateDebut,' %J %MMMM %AAAA')]);newElement.html='';} else newElement.html='';lResult.AddElement(newElement);}}}}
return lResult;};}());ObjetAffichagePagePresence_enGrille.prototype.surResizeInterface=function(){this.inherited('surResizeInterface');if(this.minWidthInterface===0&&$('#'+this.GetInstance(this.identGrilleAnnuel).GetNom().escapeJQ()).find('table tr td:first-child').length>0){this.minWidthInterface=$('#'+this.GetInstance(this.identGrilleAnnuel).GetNom().escapeJQ()).find('table tr td:first-child').width()+31*(this.minCelWidth+1)+(this.widthRecapitulatif+10)+5+20;$('#'+this.Nom.escapeJQ()).css({minWidth:this.minWidthInterface+'px'});}
if(this.GetInstance(this.identGrilleAnnuel)&&this.GetInstance(this.identGrilleAnnuel).getAvecDonnees()){this.GetInstance(this.identGrilleAnnuel).actualiserGrille();var lDonnees=this.formatDonnees(this.listeAbsences,this.GetInstance(this.identGrilleAnnuel).hauteurCellule,this.GetInstance(this.identGrilleAnnuel).largeurCellule-4);this.GetInstance(this.identGrilleAnnuel).actualiserDonnees(lDonnees);}};ObjetAffichagePagePresence_enGrille.prototype.Valider=function(){if(this.Pere&&this.Pere.Valider)
this.Pere.Valider();};;
ObjetAffichagePagePresence_enGrille.prototype.AfficherListe=function(){this.utilitaireAbsence=new ObjetUtilitaireAbsence();var lIdListe=this.Nom+'_Liste';this._objetListeArborescente=new ObjetListeArborescente(lIdListe,0,this,null);var lRacine=this._objetListeArborescente.construireRacine();this._objetListeArborescente.setParametres(false);var lTitre=GTraductions.getValeur('AbsenceVS.DetailsVieScolaire');var lNoeudListe=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lRacine,lIdListe+'_ListeVieScolaire',lTitre,'Gras',true,true);var I,lElement;this.listeAbsences.setTri([ObjetTri.init('DateDebut')]);this.listeAbsences.trier();if(this.donnees.message){this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudListe,'',this.donnees.message);} else if(this.listeAbsences.GetNbrElements()===0){this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudListe,'',GTraductions.getValeur('AbsenceVS.AucuneAbsence'));} else{for(I=0;I<this.listeAbsences.GetNbrElements();I++){lElement=this.listeAbsences.GetElement(I);lTitre=this.utilitaireAbsence.getChaineTraductionGenreAbsence({genre:lElement.GetGenre(),singulier:true,justifie:lElement.justifie,estLue:lElement.estLue}).ucfirst()+' '+this.utilitaireAbsence.getDate(lElement,true);var lNoeudElement=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lNoeudListe,'',lTitre,'Gras');lTitre=this.getLigne2AbsenceAccessible(lElement);if(lTitre) this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudElement,'',lTitre);lTitre=this.utilitaireAbsence.getInfoAbsenceAccessible(lElement);if(lTitre) this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudElement,'',lTitre);}
lTitre=this.getRecapitulatif_Titre();lNoeudListe=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lRacine,lIdListe+'_ListeRecap',lTitre,'Gras',true,false);for(I=0;I<this.donnees.listeRecapitulatifs.GetNbrElements();I++){lElement=this.donnees.listeRecapitulatifs.GetElement(I);lTitre=this.getChaineTraductionGenreAbsenceTitre({genre:lElement.Genre,justifie:lElement.justifie,genreNature:lElement.genreNature,estLue:lElement.estLue,singulier:true}).toUpperCase();lTitre=this.getRecapitulatif_Libelle(lElement)+' : '+lElement.Nombre;if(lTitre&&lElement.Nombre>0) this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudListe,'',lTitre);}}
GHtml.setHtml(this.Nom,this._objetListeArborescente.ConstruireAffichage());this._objetListeArborescente.SetDonnees(lRacine);};;
IE.Invocateur.abonner(IE.Invocateur.events.modificationThemeCouleur,function(){GHtml.modifierRegleCss(".listeAbsenceTitre",'background-color',GCouleur.liste.titre.fond);GHtml.modifierRegleCss(".listeAbsenceTitre",'color',GCouleur.liste.titre.texte);GHtml.modifierRegleCss(".listeAbsenceTitre",'border-right',GCouleur.liste.bordure+' 1px solid');GHtml.modifierRegleCss(".listeAbsenceTitre",'border-left',GCouleur.liste.bordure+' 1px solid');GHtml.modifierRegleCss(".listeAbsenceTitre",'border-top',GCouleur.liste.bordure+' 1px solid');GHtml.modifierRegleCss(".listeAbsenceListe",'border-left',GCouleur.liste.bordure+' 1px solid');GHtml.modifierRegleCss(".listeAbsenceListeBas",'border-right',GCouleur.liste.bordure+' 1px solid');GHtml.modifierRegleCss(".listeAbsenceListeBas",'border-left',GCouleur.liste.bordure+' 1px solid');GHtml.modifierRegleCss(".listeAbsenceListeBas",'border-bottom',GCouleur.liste.bordure+' 1px solid');GHtml.modifierRegleCss(".listeAbsenceTable",'background-color',GCouleur.liste.titre.fond);GHtml.modifierRegleCss(".listeAbsenceTableEntete",'color',GCouleur.liste.titre.texte);GHtml.modifierRegleCss(".listeAbsenceTableEntete",'border-right',GCouleur.liste.bordure+' 1px solid');GHtml.modifierRegleCss(".listeAbsenceTableEntete",'border-bottom',GCouleur.liste.bordure+' 1px solid');GHtml.modifierRegleCss(".listeAbsenceTableCellule",'background-color',GCouleur.liste.editable.fond);GHtml.modifierRegleCss(".listeAbsenceTableCellule",'border-right',GCouleur.liste.bordure+' 1px solid');GHtml.modifierRegleCss(".listeAbsenceTableCellule",'border-bottom',GCouleur.liste.bordure+' 1px solid');});MethodesObjet.heritagePrototype(ObjetListeAbsence,Identite);function ObjetListeAbsence(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.deploye=true;this.idTitre=this.Nom+'_titre';this.idDeploiement=this.Nom+'_titreImage';this.idLibelle=this.Nom+'_titreLabel';this.idListe=this.Nom+'_Liste';this.donneesRecues=false;this.classColonneVariable=IE.GUID.getClassCss();this.utilitaireAbsence=new ObjetUtilitaireAbsence();Invocateur.abonner(Invocateur.events.modeExclusif,this._setModeExclusif,this);}(function(){ObjetListeAbsence.prototype._setModeExclusif=function(aModeExclusif){$('#'+this.Nom.escapeJQ()+' input:checkbox[id^="'+(this.Nom+'_input_').escapeJQ()+'"] ').each(function(){if(!$(this).data('disable'))
$(this).inputDisabled(aModeExclusif);});};ObjetListeAbsence.prototype.SetDonnees=function(aListeAbsences,aGenre,aNombreDemiJBulletin,aAutorisations,aRecap){this.listeAbsences=aListeAbsences;this.listeAbsences.setTri([ObjetTri.init('dateDebut',EGenreTriElement.Decroissant),ObjetTri.init('Genre'),ObjetTri.init('genreRepas')]);this.listeAbsences.trier();this.nombreDemiJBulletin=aNombreDemiJBulletin;this.genre=aGenre;this.autorisations=aAutorisations;this.deploye=true;this.donneesRecues=true;this.recap=aRecap||new ObjetListeElements();if(this.combos)
for(var i in this.combos)
this.combos[i].free();this.Afficher(this.ConstruireAffichage());if(MethodesTableau.existe(aGenre,[EGenreRessource.Absence,EGenreRessource.Retard]))
_initCombos.bind(this)();if(this.listeAbsences.GetNbrElements()===0){this.deploye=false;$('#'+this.idListe.escapeJQ()).hide();$('#'+this.idDeploiement.escapeJQ()).removeClass('Image_DeploiementListe_Deploye AvecMain');$('#'+this.idDeploiement.escapeJQ()).addClass('Image_DeploiementListe_NonDeploye');} else{$('#'+this.idDeploiement.escapeJQ()).on('click',null,{aObjet:this},this.actiondeploiement);$('#'+this.idLibelle.escapeJQ()).on('keyup',{aObjet:this},function(event){var lThis=event.data.aObjet;if(event.which===ToucheClavier.RetourChariot||event.which===ToucheClavier.Espace){lThis.deploye=!lThis.deploye;$('#'+lThis.idDeploiement.escapeJQ()).toggleClass('Image_DeploiementListe_Deploye Image_DeploiementListe_NonDeploye');if(lThis.deploye){$('#'+lThis.idListe.escapeJQ()).slideDown(250,function(){if(lThis&&lThis.Pere) lThis.Pere.surResizeInterface();$('#'+lThis.idLibelle.escapeJQ()).focus();});} else{$('#'+lThis.idListe.escapeJQ()).slideUp(250,function(){if(lThis&&lThis.Pere) lThis.Pere.surResizeInterface();$('#'+lThis.idLibelle.escapeJQ()).focus();});}} else if(event.which===ToucheClavier.FlecheBas&&lThis.deploye){$(this).parents('.ListeAbsenceObjet:first').find('.ListeAbsenceLigne:first').focus();}});}
$('#'+this.idLibelle.escapeJQ()).on('focusin',function(){$(this).parents('.ListeAbsenceObjet').css('box-shadow','0 0 5px -1px '+GCouleur.noir);}).on('focusout',function(){$(this).parents('.ListeAbsenceObjet').css('box-shadow','none');});$('.ListeAbsenceLigne').on('keyup',{aObjet:this},function(event){if(event.which===ToucheClavier.FlecheBas&&!$(this).is(':last-child')){$(this).blur().next().focus();} else if(event.which===ToucheClavier.FlecheHaut&&!$(this).is(':nth-child(2)')){$(this).blur().prev().focus();}
event.stopPropagation();});$('#'+this.Nom.escapeJQ()+' input[type="checkbox"]').jIECheckBox({marginRightMin:0});this.resize();};function _getIdCombo(aIndice){return'_I_'+aIndice;}
function _initCombos(){var I,lCombo;for(I=0;I<this.listeAbsences.GetNbrElements();I++){lCombo=this.combos[_getIdCombo(I)];if(lCombo){lCombo.Initialiser();_actualiserCombo.bind(this)(I);}}}
function _actualiserCombo(aIndice){var lCombo=this.combos[_getIdCombo(aIndice)];if(!lCombo) return;var lAbsence=this.listeAbsences.GetElement(aIndice);var lListe=lAbsence.GetGenre()===EGenreRessource.Absence?GEtatUtilisateur.listeMotifsAbsences:GEtatUtilisateur.listeMotifsRetards;lCombo.SetDonnees(lListe);if(lAbsence.motifParent&&lAbsence.motifParent.existeNumero())
lCombo.SetSelectionParNumeroEtGenre(lAbsence.motifParent.GetNumero());else lCombo.SetContenu(GTraductions.getValeur('AbsenceVS.aPreciser'));}
function _creationCombos(){var I,lId,lAbsence;this.combos={};for(I=0;I<this.listeAbsences.GetNbrElements();I++){lAbsence=this.listeAbsences.GetElement(I);var lListe=lAbsence.GetGenre()===EGenreRessource.Absence?GEtatUtilisateur.listeMotifsAbsences:GEtatUtilisateur.listeMotifsRetards;var lSaisieMotif=false;switch(lAbsence.GetGenre()){case EGenreRessource.Absence:lSaisieMotif=this.autorisations?this.autorisations.saisieMotifAbsence:false;break;case EGenreRessource.Retard:lSaisieMotif=this.autorisations?this.autorisations.saisieMotifRetard:false;break;default:break;}
if(lSaisieMotif&&MethodesTableau.existe(lAbsence.GetGenre(),[EGenreRessource.Absence,EGenreRessource.Retard])&&lListe.GetNbrElements()>0&&lAbsence.listeMotifs.GetNbrElements()===0){lId=_getIdCombo(I);this.combos[lId]=new ObjetSaisie(this.Nom+'.saisies'+lId,null,this,_surEvenementSaisie.bind(this,I));var lWidth=(lAbsence.GetGenre()===EGenreRessource.Absence?this.taillesColonnes[4]:this.taillesColonnes[3])-21;this.combos[lId].SetParametres(EGenreSaisie.Combo,lWidth,true);}}}
function _surEvenementSaisie(aIndice,aGenreSelection,aElement,aSelection){var lAbsence=this.listeAbsences.GetElement(aIndice);if((aGenreSelection===EGenreEvenementObjetSaisie.selection&&aElement)&&(!lAbsence.motifParent||lAbsence.motifParent.GetNumero()!==aElement.GetNumero())){lAbsence.motifParent=aElement;lAbsence.SetEtat(EGenreEtat.Modification);this.SetEtatSaisie(true);}}
ObjetListeAbsence.prototype.ConstruireAffichage=function(){if(this.donneesRecues)
return this.composePage();else return'';};ObjetListeAbsence.prototype.composePage=function(aPourImpression){var lHTML=[];lHTML.push('<div style="padding:5px 5px 0px 5px;"><div class="ListeAbsenceObjet">','<div id="'+this.idTitre+'" class="Titre listeAbsenceTitre">','<table style="width: 100%">','<tr>','<td class="AlignementHaut" style="width: 20px;"><div><div id="'+this.idDeploiement+'" class="Image_DeploiementListe_Deploye AvecMain" style="margin: 5px; height:9px; width:8px"></div></div></td>','<td style="width: 100%"><div id="'+this.idLibelle+'" tabIndex="0" ',GObjetWAI.composeRole(EGenreRole.Listitem),' class="Gras" style="line-height:20px;">',this.getTitre(),'</div></td>','</tr>','</table>','</div>','<div id="'+this.idListe+'" class="listeAbsenceListe">',this.composeListe(),'</div>','<div class="listeAbsenceListeBas"></div>','</div></div>');return lHTML.join('');};ObjetListeAbsence.prototype.composeListe=function(aPourImpression){var lResult='';switch(this.genre){case EGenreRessource.ObservationProfesseurEleve:this.taillesColonnes=[20,240,200,200,20];lResult=this.composeListeObservations(aPourImpression);break;case EGenreRessource.Absence:this.taillesColonnes=[20,240,50,50,280,20];lResult=this.composeListeAbsences(aPourImpression);break;case EGenreRessource.Retard:this.taillesColonnes=[20,240,50,280,20];lResult=this.composeListeRetards(aPourImpression);break;case EGenreRessource.Infirmerie:this.taillesColonnes=[20,240];lResult=this.composeListeInfirmeries();break;case EGenreRessource.Incident:this.taillesColonnes=[20,130,50,300,200];lResult=this.composeListeIncidents();break;case EGenreRessource.Punition:case EGenreRessource.Sanction:this.taillesColonnes=[20,130,300,200];lResult=this.composeListePunitions();break;default:;break;}
return lResult;};ObjetListeAbsence.prototype.composeListeObservations=function(aPourImpression){var lHTML=[];var lTitle='title="'+GTraductions.getValeur('AbsenceVS.AccuserReception')+'" ';lHTML.push('<table class="Tableau Texte10 listeAbsenceTable" style="',GTableau.styleTableau(aPourImpression,false),GStyle.composeWidth(100,'%'),'" border="0" cellpadding="0" cellspacing="0">');lHTML.push('<tr>','<th class="Titre listeAbsenceTableEntete"><div style="',GStyle.composeWidth(this.taillesColonnes[0]),'"></div></th>','<th class="Titre listeAbsenceTableEntete"><div class="listeAbsenceTableTitre" style="',GStyle.composeWidth(this.taillesColonnes[1]),'">',GTraductions.getValeur('AbsenceVS.titres.date').ucfirst(),'</div></th>','<th class="Titre listeAbsenceTableEntete"><div class="listeAbsenceTableTitre" style="',GStyle.composeWidth(this.taillesColonnes[2]),'">',GTraductions.getValeur('AbsenceVS.titres.saisiepar').ucfirst(),'</div></th>','<th class="Titre listeAbsenceTableEntete"><div class="listeAbsenceTableTitre" style="',GStyle.composeWidth(this.taillesColonnes[3]),'">',GTraductions.getValeur('AbsenceVS.titres.matiere').ucfirst(),'</div></th>','<th class="Titre listeAbsenceTableEntete" style="width:100%;"><div class="listeAbsenceTableTitre">',GTraductions.getValeur('AbsenceVS.titres.observation').ucfirst(),'</div></th>','</tr>');for(var i=0;i<this.listeAbsences.GetNbrElements();i++){lHTML.push(this.composeObservation(this.listeAbsences.GetElement(i),i));}
lHTML.push('</table>');return lHTML.join('');};ObjetListeAbsence.prototype.composeObservation=function(aElement,aIndice){var lHTML=[];var lImage=EGenreRessource.getNomImageAbsence({genre:aElement.GetGenre(),justifie:aElement.justifie,genreNature:(aElement.nature?aElement.nature.GetGenre():-1),estLue:aElement.estLue});var lStyle=aIndice===(this.listeAbsences.GetNbrElements()-1)?'border-bottom: 0px;':'';var lTitle=aElement.estLue||GEtatUtilisateur.GenreEspace!==EGenreEspace.Parent?'':'title="'+GTraductions.getValeur('AbsenceVS.observationLu')+'" ';var lWai='title="'+(aElement.estLue?GTraductions.getValeur('AbsenceVS.observationLu'):GTraductions.getValeur('AbsenceVS.observationNonLue'))+'"';lHTML.push('<tr class="ListeAbsenceLigne" tabIndex="-1" ',GObjetWAI.composeRole(EGenreRole.Listitem),'>','<td style="',lStyle,'" class="listeAbsenceTableCellule listeAbsenceTableImage"><div style="',GStyle.composeWidth(17),'" class="',lImage,'" ',lWai,'></div></td>','<td style="',lStyle,'" class="listeAbsenceTableCellule"><div class="PetitEspace" style="',GStyle.composeWidth(this.taillesColonnes[1]),'">',this.utilitaireAbsence.getDate(aElement).ucfirst(),'</div></td>','<td style="',lStyle,'" class="listeAbsenceTableCellule"><div class="PetitEspace" style="',GStyle.composeWidth(this.taillesColonnes[2]),'">','<div class="InlineBlock AlignementHaut">',aElement.demandeur.GetLibelle(),'&nbsp;</div>',(aElement.demandeur.mail&&GEtatUtilisateur.GenreEspace===EGenreEspace.Parent?'<a href="mailto:'+aElement.demandeur.mail+'?Subject='+GTraductions.getValeur('AbsenceVS.SujetMailtoObservation',[GEtatUtilisateur.getMembre().GetLibelle(),GDate.FormatDate(aElement.dateDebut,'%J %MMMM'+(aElement.dateDebut.getHours()===0?'':' '+GTraductions.getValeur('A')+' %xhh%mm'))])+'" class="AlignementHaut InlineBlock"><div class="Image_EnvoiEmail"></div></a>':''),'</div></td>','<td style="',lStyle,'" class="listeAbsenceTableCellule"><div class="PetitEspace" style="',GStyle.composeWidth(this.taillesColonnes[3]),'">',aElement.matiere.GetLibelle(),'</div></td>','<td style="width:100%;',lStyle,'" class="listeAbsenceTableCellule">','<div class="PetitEspace">',aElement.commentaire,'</div>','<div class="PetitEspace">'+this.utilitaireAbsence.getSaisieObservation(aElement,this.Nom+'.surObservation ('+aIndice+')',this.getIDCellulle(aIndice))+'</div>','</td>','</tr>');return lHTML.join('');};ObjetListeAbsence.prototype.composeListeAbsences=function(aPourImpression){var lHTML=[];_creationCombos.bind(this)();var lTitle='title="'+GTraductions.getValeur('AbsenceVS.RegleeAdmin')+'" ';var lInfo='title="'+GTraductions.getValeur('AbsenceVS.limiteCommentaire',[this.utilitaireAbsence.maxLengthCommentaire])+'" ';lHTML.push('<table class="Tableau Texte10 listeAbsenceTable" style="',GTableau.styleTableau(aPourImpression,false),GStyle.composeWidth(100,'%'),'" border="0" cellpadding="0" cellspacing="0">');lHTML.push('<tr>','<th class="Titre listeAbsenceTableEntete"><div style="',GStyle.composeWidth(this.taillesColonnes[0]),'"></div></th>','<th class="Titre listeAbsenceTableEntete"><div class="listeAbsenceTableTitre" style="',GStyle.composeWidth(this.taillesColonnes[1]),'">',GTraductions.getValeur('AbsenceVS.titres.date').ucfirst(),'</div></th>','<th class="Titre listeAbsenceTableEntete"><div class="listeAbsenceTableTitre" style="',GStyle.composeWidth(this.taillesColonnes[2]),'">',GTraductions.getValeur('AbsenceVS.titres.HCours').ucfirst(),'</div></th>','<th class="Titre listeAbsenceTableEntete"><div class="listeAbsenceTableTitre" style="',GStyle.composeWidth(this.taillesColonnes[3]),'">',GTraductions.getValeur('AbsenceVS.titres.DemiJBul').ucfirst(),'</div></th>','<th class="Titre listeAbsenceTableEntete" ',this.autorisations&&this.autorisations.saisieMotifAbsence?'':'style="width:100%;"','><div class="listeAbsenceTableTitre" style="',this.autorisations&&this.autorisations.saisieMotifAbsence?GStyle.composeWidth(this.taillesColonnes[4]):'','">',(GEtatUtilisateur.GenreEspace===EGenreEspace.Parent&&this.autorisations&&this.autorisations.saisieMotifAbsence?GTraductions.getValeur('AbsenceVS.titres.motifParent').ucfirst():GTraductions.getValeur('AbsenceVS.titres.motif').ucfirst()),'</div></th>',this.autorisations&&this.autorisations.saisieMotifAbsence?'<th '+lInfo+' class="Titre listeAbsenceTableEntete" style="width:100%;"><div class="listeAbsenceTableTitre">'+GTraductions.getValeur('AbsenceVS.titres.commentaire').ucfirst()+'</div></th>':'','<th ',lTitle,' class="Titre listeAbsenceTableEntete"><div style="',GStyle.composeWidth(this.taillesColonnes[5]),'">',GTraductions.getValeur('AbsenceVS.titres.RA').ucfirst(),'</div></th>','</tr>');for(var i=0;i<this.listeAbsences.GetNbrElements();i++){lHTML.push(this.composeAbsence(this.listeAbsences.GetElement(i),i));}
lHTML.push('</table>');return lHTML.join('');};ObjetListeAbsence.prototype.composeAbsence=function(aElement,aIndice){var lHTML=[];var lHtmlMotif='';var lImage=EGenreRessource.getNomImageAbsence({genre:aElement.GetGenre(),justifie:aElement.justifie,genreNature:(aElement.nature?aElement.nature.GetGenre():-1),estLue:aElement.estLue});var lStyle=aIndice===(this.listeAbsences.GetNbrElements()-1)?'border-bottom: 0px;':'';var lTitle=aElement.reglee?'title="'+GTraductions.getValeur('AbsenceVS.RegleeAdmin')+'" ':'';var lWai=this.utilitaireAbsence.getChaineTraductionGenreAbsence({genre:aElement.GetGenre(),justifie:aElement.justifie,singulier:true});var lTitleImage='title="'+lWai+'"';if(aElement.avecSaisie){var lCombo=this.combos[_getIdCombo(aIndice)];if(lCombo){var lInfo=aElement.message&&aElement.message.replace?' ie-hint="'+aElement.message.replace(/\n/g,'<br />')+'"':'';lHtmlMotif='<div id="'+lCombo.Nom+'" class="motif"'+lInfo+'></div>';}} else{lHtmlMotif=this.getMotifAbsence(aElement,aIndice);}
lHTML.push('<tr class="ListeAbsenceLigne" tabIndex="-1" ',GObjetWAI.composeRole(EGenreRole.Listitem),'>','<td style="',lStyle,'" class="listeAbsenceTableCellule listeAbsenceTableImage"><div style="',GStyle.composeWidth(17),'" class="',lImage,'" ',lTitleImage,'>',GObjetWAI.composeSpan(lWai),'</div></td>','<td style="',lStyle,'" class="listeAbsenceTableCellule"><div class="PetitEspace" style="',GStyle.composeWidth(this.taillesColonnes[1]),'">',this.utilitaireAbsence.getDate(aElement).ucfirst(),'</div></td>','<td style="',lStyle,'" class="listeAbsenceTableCellule"><div class="PetitEspace AlignementDroit" style="',GStyle.composeWidth(this.taillesColonnes[2]-5),'">',aElement.NbrHeures?aElement.NbrHeures:'','</div></td>','<td style="',lStyle,'" class="listeAbsenceTableCellule"><div class="PetitEspace AlignementDroit" style="',GStyle.composeWidth(this.taillesColonnes[3]-5),'">',aElement.NbrJours?aElement.NbrJours:'','</div></td>','<td style="',lStyle,this.autorisations&&this.autorisations.saisieMotifAbsence?GStyle.composeWidth(this.taillesColonnes[4]):'width:100%;','" class="listeAbsenceTableCellule">',lHtmlMotif,'</td>',this.autorisations&&this.autorisations.saisieMotifAbsence?'<td style="width:100%;'+lStyle+'" class="listeAbsenceTableCellule">'+this.getCommentaireMotifAbsence(aElement,aIndice)+'</td>':'','<td ',lTitle,' style="padding-top: 2px; ',lStyle,'" class="listeAbsenceTableCellule"><div style="',GStyle.composeWidth(this.taillesColonnes[5]),'" class="',aElement.reglee?'Image_CocheVerte':'','">&nbsp;</div></td>','</tr>');return lHTML.join('');};ObjetListeAbsence.prototype.getMotifAbsence=function(aElement,aIndice){return this.utilitaireAbsence.getMotifAbsence({callback:this.Nom+'.surChangementMotif('+aIndice+')',donnee:aElement,id:this.getIDCellulle(aIndice,true),enListe:true});};ObjetListeAbsence.prototype.getCommentaireMotifAbsence=function(aElement,aIndice){return this.utilitaireAbsence.getCommentaireMotifAbsence({callback:this.Nom+'.surChangement('+aIndice+')',donnee:aElement,id:this.getIDCellulle(aIndice),enListe:true});};ObjetListeAbsence.prototype.composeListeRetards=function(aPourImpression){var lHTML=[];_creationCombos.bind(this)();var lTitle='title="'+GTraductions.getValeur('AbsenceVS.RegleAdmin')+'" ';var lInfo='title="'+GTraductions.getValeur('AbsenceVS.limiteCommentaire',[this.utilitaireAbsence.maxLengthCommentaire])+'" ';lHTML.push('<table class="Tableau Texte10 listeAbsenceTable" style="',GTableau.styleTableau(aPourImpression,false),GStyle.composeWidth(100,'%'),'" border="0" cellpadding="0" cellspacing="0">');lHTML.push('<tr>','<th class="Titre listeAbsenceTableEntete"><div style="',GStyle.composeWidth(this.taillesColonnes[0]),'"></div></th>','<th class="Titre listeAbsenceTableEntete"><div class="listeAbsenceTableTitre" style="',GStyle.composeWidth(this.taillesColonnes[1]),'">',GTraductions.getValeur('AbsenceVS.titres.date').ucfirst(),'</div></th>','<th class="Titre listeAbsenceTableEntete"><div class="listeAbsenceTableTitre" style="',GStyle.composeWidth(this.taillesColonnes[2]),'">',GTraductions.getValeur('AbsenceVS.titres.duree').ucfirst(),'</div></th>','<th class="Titre listeAbsenceTableEntete" ',this.autorisations&&this.autorisations.saisieMotifRetard?'':'style="width:100%;"','><div class="listeAbsenceTableTitre" style="',this.autorisations&&this.autorisations.saisieMotifRetard?GStyle.composeWidth(this.taillesColonnes[3]):'','">',(GEtatUtilisateur.GenreEspace===EGenreEspace.Parent&&this.autorisations.saisieMotifRetard?GTraductions.getValeur('AbsenceVS.titres.motifParent').ucfirst():GTraductions.getValeur('AbsenceVS.titres.motif').ucfirst()),'</div></th>',this.autorisations&&this.autorisations.saisieMotifRetard?'<th '+lInfo+' class="Titre listeAbsenceTableEntete" style="width:100%;"><div class="listeAbsenceTableTitre">'+GTraductions.getValeur('AbsenceVS.titres.commentaire').ucfirst()+'</div></th>':'','<th ',lTitle,' class="Titre listeAbsenceTableEntete"><div style="',GStyle.composeWidth(this.taillesColonnes[4]),'">',GTraductions.getValeur('AbsenceVS.titres.RA').ucfirst(),'</div></th>','</tr>');for(var i=0;i<this.listeAbsences.GetNbrElements();i++){lHTML.push(this.composeRetard(this.listeAbsences.GetElement(i),i));}
lHTML.push('</table>');return lHTML.join('');};ObjetListeAbsence.prototype.composeRetard=function(aElement,aIndice){var lHTML=[];var lHtmlMotif='';var lImage=EGenreRessource.getNomImageAbsence({genre:aElement.GetGenre(),justifie:aElement.justifie,genreNature:(aElement.nature?aElement.nature.GetGenre():-1),estLue:aElement.estLue});var lStyle=aIndice===(this.listeAbsences.GetNbrElements()-1)?'border-bottom: 0px;':'';var lTitle=aElement.reglee?'title="'+GTraductions.getValeur('AbsenceVS.RegleAdmin')+'" ':'';var lWai=this.utilitaireAbsence.getChaineTraductionGenreAbsence({genre:aElement.GetGenre(),justifie:aElement.justifie,singulier:true});var lTitleImage='title="'+lWai+'"';if(GEtatUtilisateur.GenreEspace===EGenreEspace.Parent&&MethodesTableau.existe(aElement.GetGenre(),[EGenreRessource.Absence,EGenreRessource.Retard])&&!aElement.reglee&&this.combos[_getIdCombo(aIndice)]){var lCombo=this.combos[_getIdCombo(aIndice)];if(lCombo){var lInfo=aElement.message&&aElement.message.replace?' ie-hint="'+aElement.message.replace(/\n/g,'<br />')+'"':'';lHtmlMotif='<div id="'+lCombo.Nom+'" class="motif"'+lInfo+'></div>';}} else{lHtmlMotif=this.getMotifAbsence(aElement,aIndice);}
lHTML.push('<tr class="ListeAbsenceLigne" tabIndex="-1" ',GObjetWAI.composeRole(EGenreRole.Listitem),'>','<td style="',lStyle,'" class="listeAbsenceTableCellule listeAbsenceTableImage"><div style="',GStyle.composeWidth(17),'" class="',lImage,'" ',lTitleImage,'>',GObjetWAI.composeSpan(lWai),'</div></td>','<td style="',lStyle,'" class="listeAbsenceTableCellule"><div class="PetitEspace" style="',GStyle.composeWidth(this.taillesColonnes[1]),'">',this.utilitaireAbsence.getDate(aElement).ucfirst(),'</div></td>','<td style="',lStyle,'" class="listeAbsenceTableCellule"><div class="PetitEspace AlignementDroit" style="',GStyle.composeWidth(this.taillesColonnes[2]-5),'">',(aElement.duree?aElement.duree+' '+GTraductions.getValeur('AbsenceVS.minutes'):''),'</div></td>','<td style="',lStyle,this.autorisations&&this.autorisations.saisieMotifRetard?GStyle.composeWidth(this.taillesColonnes[3]):'width:100%;','" class="listeAbsenceTableCellule">',lHtmlMotif,'</td>',this.autorisations&&this.autorisations.saisieMotifRetard?'<td style="width:100%;'+lStyle+'" class="listeAbsenceTableCellule">'+this.getCommentaireMotifAbsence(aElement,aIndice)+'</td>':'','<td ',lTitle,' style="padding-top: 2px; ',lStyle,'" class="listeAbsenceTableCellule"><div style="',GStyle.composeWidth(this.taillesColonnes[4]),'" class="',aElement.reglee?'Image_CocheVerte':'','">&nbsp;</div></td>','</tr>');return lHTML.join('');};ObjetListeAbsence.prototype.composeListeInfirmeries=function(aPourImpression){var lHTML=[];lHTML.push('<table class="Tableau Texte10 listeAbsenceTable" style="',GTableau.styleTableau(aPourImpression,false),GStyle.composeWidth(100,'%'),'" border="0" cellpadding="0" cellspacing="0">');lHTML.push('<tr>','<th class="Titre listeAbsenceTableEntete"><div style="',GStyle.composeWidth(this.taillesColonnes[0]),'"></div></th>','<th class="Titre listeAbsenceTableEntete"><div class="listeAbsenceTableTitre" style="',GStyle.composeWidth(this.taillesColonnes[1]),'">',GTraductions.getValeur('AbsenceVS.titres.date').ucfirst(),'</div></th>','<th class="Titre listeAbsenceTableEntete" style="width:50%;"><div class="listeAbsenceTableTitre">',GTraductions.getValeur('AbsenceVS.titres.symptMedicaux').ucfirst(),'</div></th>','<th class="Titre listeAbsenceTableEntete" style="width:50%;"><div class="listeAbsenceTableTitre">',GTraductions.getValeur('AbsenceVS.titres.actesMedicaux').ucfirst(),'</div></th>','</tr>');for(var i=0;i<this.listeAbsences.GetNbrElements();i++){lHTML.push(this.composeInfirmerie(this.listeAbsences.GetElement(i),i));}
lHTML.push('</table>');return lHTML.join('');};ObjetListeAbsence.prototype.composeInfirmerie=function(aElement,aIndice){var lHTML=[];var lImage=EGenreRessource.getNomImageAbsence({genre:aElement.GetGenre(),justifie:aElement.justifie,genreNature:aElement.nature?aElement.nature.GetGenre():undefined,estLue:aElement.estLue});var lStyle=aIndice===(this.listeAbsences.GetNbrElements()-1)?'border-bottom: 0px;':'';var lWai=this.utilitaireAbsence.getChaineTraductionGenreAbsence({genre:aElement.GetGenre(),justifie:aElement.justifie,singulier:true});var lTitleImage='title="'+lWai+'"';lHTML.push('<tr class="ListeAbsenceLigne" tabIndex="-1" ',GObjetWAI.composeRole(EGenreRole.Listitem),'>','<td style="',lStyle,'" class="listeAbsenceTableCellule listeAbsenceTableImage"><div style="',GStyle.composeWidth(17),'" class="',lImage,'" ',lTitleImage,'>',GObjetWAI.composeSpan(lWai),'</div></td>','<td style="',lStyle,'" class="listeAbsenceTableCellule"><div class="PetitEspace" style="',GStyle.composeWidth(this.taillesColonnes[1]),'">',this.utilitaireAbsence.getDate(aElement).ucfirst(),'</div></td>','<td style="width:50%;',lStyle,'" class="listeAbsenceTableCellule"><div class="PetitEspace">',this.utilitaireAbsence.getSymptomesMedicaux(aElement,false,true),'</div></td>','<td style="width:50%;',lStyle,'" class="listeAbsenceTableCellule"><div class="PetitEspace">',this.utilitaireAbsence.getActesMedicaux(aElement,false,true),'</div></td>','</tr>');return lHTML.join('');};ObjetListeAbsence.prototype.composeListeIncidents=function(aPourImpression){var lHTML=[];lHTML.push('<table class="Tableau Texte10 listeAbsenceTable" style="',GTableau.styleTableau(aPourImpression,false),GStyle.composeWidth(100,'%'),'" border="0" cellpadding="0" cellspacing="0">');lHTML.push('<tr>','<th class="Titre listeAbsenceTableEntete"><div style="',GStyle.composeWidth(this.taillesColonnes[0]),'"></div></th>','<th class="Titre listeAbsenceTableEntete"><div class="listeAbsenceTableTitre" style="',GStyle.composeWidth(this.taillesColonnes[1]),'">',GTraductions.getValeur('AbsenceVS.titres.date').ucfirst(),'</div></th>','<th class="Titre listeAbsenceTableEntete"><div class="listeAbsenceTableTitre" style="',GStyle.composeWidth(this.taillesColonnes[2]),'">',GTraductions.getValeur('AbsenceVS.titres.gravite').ucfirst(),'</div></th>','<th class="Titre listeAbsenceTableEntete" style="width:50%;"><div class="listeAbsenceTableTitre">',GTraductions.getValeur('AbsenceVS.titres.mesureDisciplinaire').ucfirst(),'</div></th>','<th class="Titre listeAbsenceTableEntete"><div class="listeAbsenceTableTitre" style="',GStyle.composeWidth(this.taillesColonnes[3]),'">',GTraductions.getValeur('AbsenceVS.titres.motif').ucfirst(),'</div></th>','<th class="Titre listeAbsenceTableEntete" style="width:50%;"><div class="listeAbsenceTableTitre">',GTraductions.getValeur('AbsenceVS.titres.details').ucfirst(),'</div></th>','<th class="Titre listeAbsenceTableEntete"><div class="listeAbsenceTableTitre" style="',GStyle.composeWidth(this.taillesColonnes[4]),'">',GTraductions.getValeur('AbsenceVS.titres.auteurSignalement').ucfirst(),'</div></th>','</tr>');for(var i=0;i<this.listeAbsences.GetNbrElements();i++){lHTML.push(this.composeIncident(this.listeAbsences.GetElement(i),i===(this.listeAbsences.GetNbrElements()-1),i));}
lHTML.push('</table>');return lHTML.join('');};ObjetListeAbsence.prototype.composeIncident=function(aElement,aDernier,aIndice){var lHTML=[];var lImage=EGenreRessource.getNomImageAbsence({genre:aElement.GetGenre()});var lStyle=aDernier?'border-bottom: 0px;':'';var lWai=this.utilitaireAbsence.getChaineTraductionGenreAbsence({genre:aElement.GetGenre(),justifie:aElement.justifie,singulier:true});var lTitleImage='title="'+lWai+'"';lHTML.push('<tr class="ListeAbsenceLigne" tabIndex="-1" ',GObjetWAI.composeRole(EGenreRole.Listitem),'>','<td style="',lStyle,'" class="listeAbsenceTableCellule listeAbsenceTableImage"><div style="',GStyle.composeWidth(17),'" class="',lImage,'" ',lTitleImage,'>',GObjetWAI.composeSpan(lWai),'</div></td>','<td style="',lStyle,'" class="listeAbsenceTableCellule"><div class="PetitEspace" style="',GStyle.composeWidth(this.taillesColonnes[1]),'">',this.utilitaireAbsence.getDate(aElement,true).ucfirst(),'</div></td>','<td style="',lStyle,'" class="listeAbsenceTableCellule"><div class="PetitEspace" style="',GStyle.composeWidth(this.taillesColonnes[2]),'">',aElement.gravite||'','</div></td>','<td style="width:50%;',lStyle,'" class="listeAbsenceTableCellule"><div class="PetitEspace ',this.classColonneVariable,'">',this.utilitaireAbsence.getModalitesPunitionSanction(aElement),'</div></td>','<td style="',lStyle,'" class="listeAbsenceTableCellule"><div class="PetitEspace" style="',GStyle.composeWidth(this.taillesColonnes[3]),'">',aElement.listeMotifs.getTableauLibelles().join('<br>'),'</div></td>','<td style="width:50%;',lStyle,'" class="listeAbsenceTableCellule"><div class="PetitEspace ',this.classColonneVariable,'">',aElement.GetLibelle(),'</div></td>','<td style="',lStyle,'" class="listeAbsenceTableCellule"><div class="PetitEspace" style="',GStyle.composeWidth(this.taillesColonnes[4]),'">',this.utilitaireAbsence.getDemandeurDecideur(aElement),'</div></td>','</tr>');return lHTML.join('');};ObjetListeAbsence.prototype.composeListePunitions=function(aPourImpression){var lHTML=[];lHTML.push('<table class="Tableau Texte10 listeAbsenceTable" style="',GTableau.styleTableau(aPourImpression,false),GStyle.composeWidth(100,'%'),'" border="0" cellpadding="0" cellspacing="0">');lHTML.push('<tr>','<th class="Titre listeAbsenceTableEntete"><div style="',GStyle.composeWidth(this.taillesColonnes[0]),'"></div></th>','<th class="Titre listeAbsenceTableEntete"><div class="listeAbsenceTableTitre" style="',GStyle.composeWidth(this.taillesColonnes[1]),'">',GTraductions.getValeur('AbsenceVS.titres.date').ucfirst(),'</div></th>','<th class="Titre listeAbsenceTableEntete" style="width:50%;"><div class="listeAbsenceTableTitre">',GTraductions.getValeur('AbsenceVS.titres.modalites').ucfirst(),'</div></th>','<th class="Titre listeAbsenceTableEntete"><div class="listeAbsenceTableTitre" style="',GStyle.composeWidth(this.taillesColonnes[2]),'">',GTraductions.getValeur('AbsenceVS.titres.motif').ucfirst(),'</div></th>','<th class="Titre listeAbsenceTableEntete" style="width:50%;"><div class="listeAbsenceTableTitre">',GTraductions.getValeur('AbsenceVS.titres.circonstances').ucfirst(),'</div></th>','<th class="Titre listeAbsenceTableEntete"><div class="listeAbsenceTableTitre" style="',GStyle.composeWidth(this.taillesColonnes[3]),'">',(this.genre===EGenreRessource.Punition?GTraductions.getValeur('AbsenceVS.titres.demandeur').ucfirst():GTraductions.getValeur('AbsenceVS.titres.decideur').ucfirst()),'</div></th>','</tr>');for(var i=0;i<this.listeAbsences.GetNbrElements();i++){lHTML.push(this.composePunition(this.listeAbsences.GetElement(i),i===(this.listeAbsences.GetNbrElements()-1),i));}
lHTML.push('</table>');return lHTML.join('');};ObjetListeAbsence.prototype.composePunition=function(aElement,aDernier,aIndice){var lHTML=[];var lImage=EGenreRessource.getNomImageAbsence({genre:aElement.GetGenre(),justifie:aElement.justifie,genreNature:aElement.nature.GetGenre(),estLue:aElement.estLue,avecSursis:aElement.avecSursis});var lStyle=aDernier?'border-bottom: 0px;':'';var lWai=this.utilitaireAbsence.getChaineTraductionGenreAbsence({genre:aElement.GetGenre(),justifie:aElement.justifie,singulier:true});var lTitleImage='title="'+lWai+'"';lHTML.push('<tr class="ListeAbsenceLigne" tabIndex="-1" ',GObjetWAI.composeRole(EGenreRole.Listitem),'>','<td style="',lStyle,'" class="listeAbsenceTableCellule listeAbsenceTableImage"><div style="',GStyle.composeWidth(17),'" class="',lImage,'" ',lTitleImage,'>',GObjetWAI.composeSpan(lWai),'</div></td>','<td style="',lStyle,'" class="listeAbsenceTableCellule"><div class="PetitEspace" style="',GStyle.composeWidth(this.taillesColonnes[1]),'">',this.utilitaireAbsence.getDate(aElement).ucfirst(),'</div></td>','<td style="width:50%;',lStyle,'" class="listeAbsenceTableCellule">','<div class="PetitEspace '+this.classColonneVariable+'">',this.utilitaireAbsence.getModalitesPunitionSanction(aElement),'</div>',(aElement.GetGenre()===EGenreRessource.Punition&&aElement.nature&&aElement.nature.estAvecARParent&&GEtatUtilisateur.GenreEspace===EGenreEspace.Parent?'<div class="PetitEspace '+this.classColonneVariable+'">'+this.utilitaireAbsence.getARdePunition(aElement,this.Nom+'.surAR ('+aIndice+')',this.getIDCellulle(aIndice,null,true),false)+'</div>':''),'</td>','<td style="',lStyle,'" class="listeAbsenceTableCellule"><div class="PetitEspace" style="',GStyle.composeWidth(this.taillesColonnes[2]),'">',aElement.listeMotifs.getTableauLibelles().join('<br>'),'</div></td>','<td style="width:50%;',lStyle,'" class="listeAbsenceTableCellule"><div class="PetitEspace ',this.classColonneVariable,'">',aElement.circonstances,'</div></td>','<td style="',lStyle,'" class="listeAbsenceTableCellule"><div class="PetitEspace" style="',GStyle.composeWidth(this.taillesColonnes[3]),'">',this.utilitaireAbsence.getDemandeurDecideur(aElement),'</div></td>','</tr>');return lHTML.join('');};ObjetListeAbsence.prototype.getIDCellulle=function(aIndice,aMotif,aEstInput){return this.Nom+(aEstInput?'_input_':'')+'_nr_'+(aMotif?'motif_':'commentaire_')+aIndice;};ObjetListeAbsence.prototype.getTitre=function(){var lResult='';var lNbr=this.listeAbsences.GetNbrElements();if(lNbr>0){var lListe,lListe2;var lNbrList=0;var lNbrList2=0;switch(this.genre){case EGenreRessource.ObservationProfesseurEleve:lResult+=lNbr+' '+(lNbr===1?GTraductions.getValeur('AbsenceVS.observation').toLowerCase():GTraductions.getValeur('AbsenceVS.observations').toLowerCase());lListe=this.listeAbsences.getListeElements(function(aElement,aIndice){return!aElement.estLue;});lNbrList=lListe.GetNbrElements();if(lNbrList>0){lResult+=' ('+GTraductions.getValeur('AbsenceVS.dont')+' '+lNbrList+' '+(lNbrList===1?GTraductions.getValeur('AbsenceVS.nonLue').toLowerCase():GTraductions.getValeur('AbsenceVS.nonLues').toLowerCase())+')';}
break;case EGenreRessource.Absence:lListe=this.listeAbsences.getListeElements(function(aElement,aIndice){return aElement.GetGenre()===EGenreRessource.Absence;});lNbrList=lListe.GetNbrElements();if(lNbrList>0){lResult+=lNbrList+' '+(lNbrList===1?GTraductions.getValeur('AbsenceVS.absenceEnCours').toLowerCase():GTraductions.getValeur('AbsenceVS.absencesEnCours').toLowerCase());lListe2=lListe.getListeElements(function(aElement,aIndice){return!aElement.justifie;});lNbrList2=lListe2.GetNbrElements();if(lNbrList2>0){lResult+=' ('+GTraductions.getValeur('AbsenceVS.dont')+' '+lNbrList2+' '+(lNbrList2===1?GTraductions.getValeur('AbsenceVS.nonJustifieAbsence').toLowerCase():GTraductions.getValeur('AbsenceVS.nonJustifieAbsences').toLowerCase())+')';}
var lTraduction=this.nombreDemiJBulletin>1?'demiJournees':'demiJournee';lResult+=' '+GTraductions.getValeur('AbsenceVS.soit')+' '+GTraductions.getValeur('AbsenceVS.'+lTraduction,[this.nombreDemiJBulletin]);}
lListe=this.listeAbsences.getListeElements(function(aElement,aIndice){return aElement.GetGenre()===EGenreRessource.AbsenceRepas;});lNbrList=lListe.GetNbrElements();if(lNbrList>0){if(lResult) lResult+=' - ';lResult+=lNbrList+' '+(lNbrList===1?GTraductions.getValeur('AbsenceVS.absenceRepas').toLowerCase():GTraductions.getValeur('AbsenceVS.absencesRepas').toLowerCase());}
lListe=this.listeAbsences.getListeElements(function(aElement,aIndice){return aElement.GetGenre()===EGenreRessource.AbsenceInternat;});lNbrList=lListe.GetNbrElements();if(lNbrList>0){if(lResult) lResult+=' - ';lResult+=lNbrList+' '+(lNbrList===1?GTraductions.getValeur('AbsenceVS.absenceInternat').toLowerCase():GTraductions.getValeur('AbsenceVS.absencesInternat').toLowerCase());}
break;case EGenreRessource.Retard:lResult+=lNbr+' '+(lNbr===1?GTraductions.getValeur('AbsenceVS.retard'):GTraductions.getValeur('AbsenceVS.retards'));lListe=this.listeAbsences.getListeElements(function(aElement,aIndice){return!aElement.justifie;});lNbrList=lListe.GetNbrElements();if(lNbrList>0){lResult+=' ('+GTraductions.getValeur('AbsenceVS.dont')+' '+lNbrList+' '+(lNbrList===1?GTraductions.getValeur('AbsenceVS.nonJustifieRetard').toLowerCase():GTraductions.getValeur('AbsenceVS.nonJustifieRetards').toLowerCase())+')';}
break;case EGenreRessource.Infirmerie:lResult+=lNbr+' '+(lNbr===1?GTraductions.getValeur('AbsenceVS.infirmerie'):GTraductions.getValeur('AbsenceVS.infirmeries'));break;case EGenreRessource.Incident:lResult+=lNbr+' '+(lNbr===1?GTraductions.getValeur('AbsenceVS.incident'):GTraductions.getValeur('AbsenceVS.incidents'));break;case EGenreRessource.Punition:lResult+=this.utilitaireAbsence.getChaineRecapitulatifPunition({nombre:lNbr,donnees:this.listeAbsences,recap:this.recap});break;case EGenreRessource.Sanction:lResult+=this.utilitaireAbsence.getChaineRecapitulatifSanction({nombre:lNbr,donnees:this.listeAbsences,recap:this.recap});break;default:;break;}} else{switch(this.genre){case EGenreRessource.ObservationProfesseurEleve:lResult+=GTraductions.getValeur('AbsenceVS.aucuneObservation').ucfirst();break;case EGenreRessource.Absence:lResult+=GTraductions.getValeur('AbsenceVS.aucuneAbsence').ucfirst();break;case EGenreRessource.Retard:lResult+=GTraductions.getValeur('AbsenceVS.aucunRetard').ucfirst();break;case EGenreRessource.Infirmerie:lResult+=GTraductions.getValeur('AbsenceVS.aucunInfirmerie').ucfirst();break;case EGenreRessource.Incident:lResult+=GTraductions.getValeur('AbsenceVS.aucunIncident').ucfirst();break;case EGenreRessource.Punition:lResult+=GTraductions.getValeur('AbsenceVS.aucunePunition').ucfirst();break;case EGenreRessource.Sanction:lResult+=GTraductions.getValeur('AbsenceVS.aucuneSanction').ucfirst();break;default:;break;}}
return lResult;};ObjetListeAbsence.prototype.surObservation=function(aIndice){var lElement=this.listeAbsences.GetElement(aIndice);if(lElement.estLue||GEtatUtilisateur.GenreEspace!==EGenreEspace.Parent) return;lElement.estLue=true;lElement.SetEtat(EGenreEtat.Modification);$('#'+this.getIDCellulle(aIndice).escapeJQ()).inputDisabled(true).data('disable',true);this.callback.appel(this.genre,lElement);};ObjetListeAbsence.prototype.surAR=function(aIndice){var lElement=this.listeAbsences.GetElement(aIndice);lElement.parentAAccuseDeReception=true;lElement.SetEtat(EGenreEtat.Modification);$('#'+this.getIDCellulle(aIndice,null,true).escapeJQ()).inputDisabled(true).data('disable',true);this.callback.appel(this.genre,lElement);};ObjetListeAbsence.prototype.surChangement=function(aIndice){var lElement=this.listeAbsences.GetElement(aIndice);var lInput=$('#'+this.getIDCellulle(aIndice).escapeJQ()).val();if(lInput===GTraductions.getValeur('AbsenceVS.saisissezCommentaire').ucfirst()||lInput===lElement.justification) return;lElement.justification=lInput;lElement.SetEtat(EGenreEtat.Modification);this.callback.appel(this.genre,lElement);};ObjetListeAbsence.prototype.surChangementMotif=function(aIndice){var lElement=this.listeAbsences.GetElement(aIndice);var lInput=$('#'+this.getIDCellulle(aIndice,true).escapeJQ()).val();if(lInput===GTraductions.getValeur('AbsenceVS.saisissezCommentaire').ucfirst()||lInput===lElement.justification) return;lElement.justification=lInput;lElement.SetEtat(EGenreEtat.Modification);this.callback.appel(this.genre,lElement);};ObjetListeAbsence.prototype.actiondeploiement=function(event){var lThis=event.data.aObjet;lThis.deploye=!lThis.deploye;$(this).toggleClass('Image_DeploiementListe_Deploye Image_DeploiementListe_NonDeploye');if(lThis.deploye){$('#'+lThis.idListe.escapeJQ()).slideDown(250,function(){if(lThis&&lThis.Pere) lThis.Pere.surResizeInterface();});} else{$('#'+lThis.idListe.escapeJQ()).slideUp(250,function(){if(lThis&&lThis.Pere) lThis.Pere.surResizeInterface();});}};ObjetListeAbsence.prototype.replier=function(){if(this.deploye){this.deploye=false;$('#'+this.idDeploiement.escapeJQ()).toggleClass('Image_DeploiementListe_Deploye Image_DeploiementListe_NonDeploye');$('#'+this.idListe.escapeJQ()).slideUp(0);}};ObjetListeAbsence.prototype.deplier=function(){if(!this.deploye){$('#'+this.idDeploiement.escapeJQ()).click();}};ObjetListeAbsence.prototype.resize=function(aAvecScroll){if(MethodesTableau.existe(this.genre,[EGenreRessource.Punition,EGenreRessource.Sanction,EGenreRessource.Incident])){var lWidthLibre=$('#'+this.Nom.escapeJQ()).width()-10-1-(aAvecScroll?IE.Support.calculerScrollBar():0);for(var i in this.taillesColonnes)
lWidthLibre=lWidthLibre-this.taillesColonnes[i];lWidthLibre=lWidthLibre-(7*(this.taillesColonnes.length-1))-1;lWidthLibre=Math.floor((lWidthLibre-14)/2);var lWidth=Math.max(175,lWidthLibre);$('.'+this.classColonneVariable.escapeJQ()).width(lWidth);}};})();;
MethodesObjet.heritagePrototype(ObjetAffichagePagePresence_enListe,_ObjetAffichagePagePresence);function ObjetAffichagePagePresence_enListe(ANom,AIdent,APere,AEvenement){this.inheritedCreate(ANom,AIdent,APere,AEvenement);this.avecScrollV=true;}
ObjetAffichagePagePresence_enListe.prototype.ConstruireInstances=function(){this.identObservations=this.Add(window.ObjetListeAbsence,this.evenement,this.initialiser);this.identAbsences=this.Add(window.ObjetListeAbsence,this.evenement ,this.initialiser);this.identRetards=this.Add(window.ObjetListeAbsence,this.evenement ,this.initialiser);this.identInfirmerie=this.Add(window.ObjetListeAbsence,null ,this.initialiser);this.identIncidents=this.Add(window.ObjetListeAbsence,null ,this.initialiser);this.identPunitions=this.Add(window.ObjetListeAbsence,this.evenement ,this.initialiser);this.identSanctions=this.Add(window.ObjetListeAbsence,null ,this.initialiser);};ObjetAffichagePagePresence_enListe.prototype.SetParametresGeneraux=function(){this.GenreStructure=EStructureAffichage.Autre;};ObjetAffichagePagePresence_enListe.prototype.ConstruireStructureAffichageAutre=function(){var lHtml=[];lHtml.push('<div class="PresenceEnListe">','<div id="',(this.GetInstance(this.identObservations).GetNom()),'" style="width:100%;"></div>','<div id="',(this.GetInstance(this.identAbsences).GetNom()),'" style="width:100%;"></div>','<div id="',(this.GetInstance(this.identRetards).GetNom()),'" style="width:100%;"></div>','<div id="',(this.GetInstance(this.identInfirmerie).GetNom()),'" style="width:100%;"></div>','<div id="',(this.GetInstance(this.identIncidents).GetNom()),'" style="width:100%;"></div>','<div id="',(this.GetInstance(this.identPunitions).GetNom()),'" style="width:100%;"></div>','<div id="',(this.GetInstance(this.identSanctions).GetNom()),'" style="width:100%;"></div>','<div style="height:5px;"></div>','</div>');return lHtml.join('');};ObjetAffichagePagePresence_enListe.prototype.initialiser=function(aInstance){aInstance.setTraductions(this.traductions);};ObjetAffichagePagePresence_enListe.prototype.setDonnees=function(aDonnees,aSeulementActualiser){$.extend(this.donnees,aDonnees);if(GEtatUtilisateur.estModeAccessible()){this.AfficherListe();} else{if(this.donnees.message){GHtml.setHtml(this.Nom,this.composeMessage(this.donnees.message));} else{this.actualiserDonnees(aDonnees,aSeulementActualiser);}}};ObjetAffichagePagePresence_enListe.prototype.actualiserDonnees=function(){var lDonnees,lRecap;if(this.donnees.autorisations&&this.donnees.autorisations.observation){lDonnees=this.donnees.listeAbsences.getListeElements(function(aElement,aIndice){return MethodesTableau.existe(aElement.GetGenre(),[EGenreRessource.ObservationProfesseurEleve]);});this.GetInstance(this.identObservations).SetVisible(true);this.GetInstance(this.identObservations).SetDonnees(lDonnees,EGenreRessource.ObservationProfesseurEleve);} else this.GetInstance(this.identObservations).SetVisible(false);var lNombre=0;if(this.donnees.autorisations&&this.donnees.autorisations.absence){var lListeAbsences=this.donnees.listeRecapitulatifs.getListeElements(function(aElement,aIndice){return aElement.GetGenre()===EGenreRessource.Absence;});for(var i=0;i<lListeAbsences.GetNbrElements();i++){lNombre+=lListeAbsences.GetElement(i).Nombre;}}
if(this.donnees.autorisations&&(this.donnees.autorisations.absence||this.donnees.autorisations.absenceRepas||this.donnees.autorisations.absenceInternat)){lDonnees=this.donnees.listeAbsences.getListeElements(function(aElement,aIndice){return MethodesTableau.existe(aElement.GetGenre(),[EGenreRessource.Absence,EGenreRessource.AbsenceInternat,EGenreRessource.AbsenceRepas]);});this.GetInstance(this.identAbsences).SetVisible(true);this.GetInstance(this.identAbsences).SetDonnees(lDonnees,EGenreRessource.Absence,lNombre,this.donnees.autorisations);} else this.GetInstance(this.identAbsences).SetVisible(false);if(this.donnees.autorisations&&this.donnees.autorisations.retard){lDonnees=this.donnees.listeAbsences.getListeElements(function(aElement,aIndice){return MethodesTableau.existe(aElement.GetGenre(),[EGenreRessource.Retard]);});this.GetInstance(this.identRetards).SetVisible(true);this.GetInstance(this.identRetards).SetDonnees(lDonnees,EGenreRessource.Retard,null,this.donnees.autorisations);} else this.GetInstance(this.identRetards).SetVisible(false);if(this.donnees.autorisations&&this.donnees.autorisations.infirmerie){lDonnees=this.donnees.listeAbsences.getListeElements(function(aElement,aIndice){return MethodesTableau.existe(aElement.GetGenre(),[EGenreRessource.Infirmerie]);});this.GetInstance(this.identInfirmerie).SetVisible(true);this.GetInstance(this.identInfirmerie).SetDonnees(lDonnees,EGenreRessource.Infirmerie);} else this.GetInstance(this.identInfirmerie).SetVisible(false);if(this.donnees.autorisations&&this.donnees.autorisations.incident){lDonnees=this.donnees.listeAbsences.getListeElements(function(aElement,aIndice){return MethodesTableau.existe(aElement.GetGenre(),[EGenreRessource.Incident]);});this.GetInstance(this.identIncidents).SetVisible(true);this.GetInstance(this.identIncidents).SetDonnees(lDonnees,EGenreRessource.Incident);} else this.GetInstance(this.identIncidents).SetVisible(false);if(this.donnees.autorisations&&(this.donnees.autorisations.exclusion||this.donnees.autorisations.punition)){lDonnees=this.donnees.listeAbsences.getListeElements(function(aElement,aIndice){return MethodesTableau.existe(aElement.GetGenre(),[EGenreRessource.Punition])&&(!aElement.estProgrammation);});lRecap=this.donnees.listeRecapitulatifs.getListeElements(function(aElement,aIndice){return aElement.GetGenre()===EGenreRessource.Punition&&aElement.Nombre>0;});this.GetInstance(this.identPunitions).SetVisible(true);this.GetInstance(this.identPunitions).SetDonnees(lDonnees,EGenreRessource.Punition,null,null,lRecap);} else this.GetInstance(this.identPunitions).SetVisible(false);if(this.donnees.autorisations&&this.donnees.autorisations.sanction){lDonnees=this.donnees.listeAbsences.getListeElements(function(aElement,aIndice){return MethodesTableau.existe(aElement.GetGenre(),[EGenreRessource.Sanction,EGenreRessource.MesureConservatoire]);});lRecap=this.donnees.listeRecapitulatifs.getListeElements(function(aElement,aIndice){return(aElement.GetGenre()===EGenreRessource.Sanction||aElement.GetGenre()===EGenreRessource.MesureConservatoire)&&aElement.Nombre>0;});this.GetInstance(this.identSanctions).SetVisible(true);this.GetInstance(this.identSanctions).SetDonnees(lDonnees,EGenreRessource.Sanction,null,null,lRecap);} else this.GetInstance(this.identSanctions).SetVisible(false);};ObjetAffichagePagePresence_enListe.prototype.evenement=function(aGenreListeAbsence,aAbsence){this.callback.appel(aGenreListeAbsence,aAbsence);};ObjetAffichagePagePresence_enListe.prototype.replierTous=function(){if(this.GetInstance(this.identObservations)) this.GetInstance(this.identObservations).replier();if(this.GetInstance(this.identAbsences)) this.GetInstance(this.identAbsences).replier();if(this.GetInstance(this.identRetards)) this.GetInstance(this.identRetards).replier();if(this.GetInstance(this.identInfirmerie)) this.GetInstance(this.identInfirmerie).replier();if(this.GetInstance(this.identPunitions)) this.GetInstance(this.identPunitions).replier();if(this.GetInstance(this.identSanctions)) this.GetInstance(this.identSanctions).replier();};ObjetAffichagePagePresence_enListe.prototype.selectionSelonGenreAbsence=function(aGenreRessource){this.replierTous();switch(aGenreRessource){case EGenreRessource.ObservationProfesseurEleve:if(this.GetInstance(this.identObservations)) this.GetInstance(this.identObservations).deplier();break;case EGenreRessource.Absence:if(this.GetInstance(this.identAbsences)) this.GetInstance(this.identAbsences).deplier();break;case EGenreRessource.Retard:if(this.GetInstance(this.identRetards)) this.GetInstance(this.identRetards).deplier();break;case EGenreRessource.Infirmerie:if(this.GetInstance(this.identInfirmerie)) this.GetInstance(this.identInfirmerie).deplier();break;case EGenreRessource.Punition:if(this.GetInstance(this.identPunitions)) this.GetInstance(this.identPunitions).deplier();break;case EGenreRessource.Sanction:if(this.GetInstance(this.identSanctions)) this.GetInstance(this.identSanctions).deplier();break;default:;break;}};ObjetAffichagePagePresence_enListe.prototype.surResizeInterface=function(){var lAvecScroll=($('#'+this.Nom.escapeJQ()).find('.PresenceEnListe').height()>$('#'+this.Nom.escapeJQ()).height());this.inherited('surResizeInterface');GHtml.modifierRegleCss(".listeAbsenceTableCell",'width','175px');if(this.GetInstance(this.identPunitions)) this.GetInstance(this.identPunitions).resize(lAvecScroll);else if(this.GetInstance(this.identSanctions)) this.GetInstance(this.identSanctions).resize(lAvecScroll);};;
ObjetAffichagePagePresence_enListe.prototype.AfficherListe=function(){this.utilitaireAbsence=new ObjetUtilitaireAbsence();var lIdListe=this.Nom+'_Liste';this._objetListeArborescente=new ObjetListeArborescente(lIdListe,0,this,null);var lRacine=this._objetListeArborescente.construireRacine();this._objetListeArborescente.setParametres(false);var lDonnees;var i=0,lGenre,lRecap;if(this.donnees.message){this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lRacine,'',this.donnees.message);} else{if(this.donnees.autorisations&&this.donnees.autorisations.observation){lGenre=EGenreRessource.ObservationProfesseurEleve;lDonnees=this.donnees.listeAbsences.getListeElements(function(aElement,aIndice){return MethodesTableau.existe(aElement.GetGenre(),[lGenre]);});this.construireVSaccessible(lDonnees,lGenre,lRacine);}
var lNombre=0;if(this.donnees.autorisations&&this.donnees.autorisations.absence){var lListeAbsences=this.donnees.listeRecapitulatifs.getListeElements(function(aElement,aIndice){return aElement.GetGenre()===EGenreRessource.Absence;});for(i=0;i<lListeAbsences.GetNbrElements();i++){lNombre+=lListeAbsences.GetElement(i).Nombre;}}
if(this.donnees.autorisations&&(this.donnees.autorisations.absence||this.donnees.autorisations.absenceRepas||this.donnees.autorisations.absenceInternat)){lGenre=EGenreRessource.Absence;lDonnees=this.donnees.listeAbsences.getListeElements(function(aElement,aIndice){return MethodesTableau.existe(aElement.GetGenre(),[EGenreRessource.Absence,EGenreRessource.AbsenceInternat,EGenreRessource.AbsenceRepas]);});this.construireVSaccessible(lDonnees,lGenre,lRacine,lNombre);}
if(this.donnees.autorisations&&this.donnees.autorisations.retard){lGenre=EGenreRessource.Retard;lDonnees=this.donnees.listeAbsences.getListeElements(function(aElement,aIndice){return MethodesTableau.existe(aElement.GetGenre(),[EGenreRessource.Retard]);});this.construireVSaccessible(lDonnees,lGenre,lRacine);}
if(this.donnees.autorisations&&this.donnees.autorisations.infirmerie){lGenre=EGenreRessource.Infirmerie;lDonnees=this.donnees.listeAbsences.getListeElements(function(aElement,aIndice){return MethodesTableau.existe(aElement.GetGenre(),[EGenreRessource.Infirmerie]);});this.construireVSaccessible(lDonnees,lGenre,lRacine);}
if(this.donnees.autorisations&&(this.donnees.autorisations.exclusion||this.donnees.autorisations.punition)){lGenre=EGenreRessource.Punition;lDonnees=this.donnees.listeAbsences.getListeElements(function(aElement,aIndice){return MethodesTableau.existe(aElement.GetGenre(),[EGenreRessource.Punition])&&(!aElement.estProgrammation);});lRecap=this.donnees.listeRecapitulatifs.getListeElements(function(aElement,aIndice){return aElement.GetGenre()===EGenreRessource.Punition&&aElement.Nombre>0;});this.construireVSaccessible(lDonnees,lGenre,lRacine,null,lRecap);}
if(this.donnees.autorisations&&this.donnees.autorisations.sanction){lGenre=EGenreRessource.Sanction;lDonnees=this.donnees.listeAbsences.getListeElements(function(aElement,aIndice){return MethodesTableau.existe(aElement.GetGenre(),[EGenreRessource.Sanction]);});lRecap=this.donnees.listeRecapitulatifs.getListeElements(function(aElement,aIndice){return aElement.GetGenre()===EGenreRessource.Sanction&&aElement.Nombre>0;});this.construireVSaccessible(lDonnees,lGenre,lRacine,null,lRecap);}}
GHtml.setHtml(this.Nom,this._objetListeArborescente.ConstruireAffichage());this._objetListeArborescente.SetDonnees(lRacine);};ObjetAffichagePagePresence_enListe.prototype.construireVSaccessible=function(aDonnees,aGenre,aNoeud,aNombre,aRecap){var lIdListe=this.Nom+'_Liste';var i=0;var lElement,lNoeudElement,lNoeudListe;var lId=lIdListe+'_VS_'+aGenre;var lTitre=this.getTitre(aDonnees,aGenre,aNombre,aRecap);if(aDonnees.GetNbrElements()>0)
lNoeudListe=this._objetListeArborescente.ajouterUnNoeudAuNoeud(aNoeud,lId,lTitre,'Gras',false);else this._objetListeArborescente.ajouterUneFeuilleAuNoeud(aNoeud,lId,lTitre,'Gras');for(i=0;i<aDonnees.GetNbrElements();i++){lElement=aDonnees.GetElement(i);lTitre=this.utilitaireAbsence.getChaineTraductionGenreAbsence({genre:lElement.GetGenre(),justifie:lElement.justifie,singulier:true,estLue:lElement.estLue});lTitre+=' '+this.utilitaireAbsence.getDate(lElement,true);lNoeudElement=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lNoeudListe,lId+'_'+i,lTitre,'Gras',true);lTitre=this.getLigne2AbsenceAccessible(lElement);if(lTitre) this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudElement,'',lTitre);lTitre=this.utilitaireAbsence.getInfoAbsenceAccessible(lElement);if(lTitre) this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudElement,'',lTitre);}};ObjetAffichagePagePresence_enListe.prototype.getTitre=function(aDonnees,aGenre,aNombreDemiJBulletin,aRecap){var lResult='';var lNbr=aDonnees.GetNbrElements();if(lNbr>0){var lListe,lListe2;var lNbrList=0;var lNbrList2=0;switch(aGenre){case EGenreRessource.ObservationProfesseurEleve:lResult+=lNbr+' '+(lNbr===1?GTraductions.getValeur('AbsenceVS.observation').toLowerCase():GTraductions.getValeur('AbsenceVS.observations').toLowerCase());lListe=aDonnees.getListeElements(function(aElement,aIndice){return!aElement.estLue;});lNbrList=lListe.GetNbrElements();if(lNbrList>0){lResult+=' ('+GTraductions.getValeur('AbsenceVS.dont')+' '+lNbrList+' '+(lNbrList===1?GTraductions.getValeur('AbsenceVS.nonLue').toLowerCase():GTraductions.getValeur('AbsenceVS.nonLues').toLowerCase())+')';}
break;case EGenreRessource.Absence:lListe=aDonnees.getListeElements(function(aElement,aIndice){return aElement.GetGenre()===EGenreRessource.Absence;});lNbrList=lListe.GetNbrElements();if(lNbrList>0){lResult+=lNbrList+' '+(lNbrList===1?GTraductions.getValeur('AbsenceVS.absenceEnCours').toLowerCase():GTraductions.getValeur('AbsenceVS.absencesEnCours').toLowerCase());lListe2=lListe.getListeElements(function(aElement,aIndice){return!aElement.justifie;});lNbrList2=lListe2.GetNbrElements();if(lNbrList2>0){lResult+=' ('+GTraductions.getValeur('AbsenceVS.dont')+' '+lNbrList2+' '+(lNbrList2===1?GTraductions.getValeur('AbsenceVS.nonJustifieAbsence').toLowerCase():GTraductions.getValeur('AbsenceVS.nonJustifieAbsences').toLowerCase())+')';}
var lTraduction=aNombreDemiJBulletin>1?'demiJournees':'demiJournee';lResult+=' '+GTraductions.getValeur('AbsenceVS.soit')+' '+GTraductions.getValeur('AbsenceVS.'+lTraduction,[aNombreDemiJBulletin]);}
lListe=aDonnees.getListeElements(function(aElement,aIndice){return aElement.GetGenre()===EGenreRessource.AbsenceRepas;});lNbrList=lListe.GetNbrElements();if(lNbrList>0){if(lResult) lResult+=' - ';lResult+=lNbrList+' '+(lNbrList===1?GTraductions.getValeur('AbsenceVS.absenceRepas').toLowerCase():GTraductions.getValeur('AbsenceVS.absencesRepas').toLowerCase());}
lListe=aDonnees.getListeElements(function(aElement,aIndice){return aElement.GetGenre()===EGenreRessource.AbsenceInternat;});lNbrList=lListe.GetNbrElements();if(lNbrList>0){if(lResult) lResult+=' - ';lResult+=lNbrList+' '+(lNbrList===1?GTraductions.getValeur('AbsenceVS.absenceInternat').toLowerCase():GTraductions.getValeur('AbsenceVS.absencesInternat').toLowerCase());}
break;case EGenreRessource.Retard:lResult+=lNbr+' '+(lNbr===1?GTraductions.getValeur('AbsenceVS.retard'):GTraductions.getValeur('AbsenceVS.retards'));lListe=aDonnees.getListeElements(function(aElement,aIndice){return!aElement.justifie;});lNbrList=lListe.GetNbrElements();if(lNbrList>0){lResult+=' ('+GTraductions.getValeur('AbsenceVS.dont')+' '+lNbrList+' '+(lNbrList===1?GTraductions.getValeur('AbsenceVS.nonJustifieRetard').toLowerCase():GTraductions.getValeur('AbsenceVS.nonJustifieRetards').toLowerCase())+')';}
break;case EGenreRessource.Infirmerie:lResult+=lNbr+' '+(lNbr===1?GTraductions.getValeur('AbsenceVS.infirmerie'):GTraductions.getValeur('AbsenceVS.infirmeries'));break;case EGenreRessource.Punition:lResult+=this.utilitaireAbsence.getChaineRecapitulatifPunition({nombre:lNbr,donnees:aDonnees,recap:aRecap});break;case EGenreRessource.Sanction:lResult+=this.utilitaireAbsence.getChaineRecapitulatifSanction({nombre:lNbr,donnees:aDonnees,recap:aRecap});break;default:;break;}} else{switch(aGenre){case EGenreRessource.ObservationProfesseurEleve:lResult+=GTraductions.getValeur('AbsenceVS.aucuneObservation').ucfirst();break;case EGenreRessource.Absence:lResult+=GTraductions.getValeur('AbsenceVS.aucuneAbsence').ucfirst();break;case EGenreRessource.Retard:lResult+=GTraductions.getValeur('AbsenceVS.aucunRetard').ucfirst();break;case EGenreRessource.Infirmerie:lResult+=GTraductions.getValeur('AbsenceVS.aucunInfirmerie').ucfirst();break;case EGenreRessource.Punition:lResult+=GTraductions.getValeur('AbsenceVS.aucunePunition').ucfirst();break;case EGenreRessource.Sanction:lResult+=GTraductions.getValeur('AbsenceVS.aucuneSanction').ucfirst();break;default:;break;}}
return lResult;};;
MethodesObjet.heritagePrototype(ObjetInterfacePageRecapitulatifAbsenceEleve,ObjetAbstraitInterface);function ObjetInterfacePageRecapitulatifAbsenceEleve(ANom,AIdent,APere,AEvenement){this.inheritedCreate(ANom,AIdent,APere,AEvenement);}(function(){ObjetInterfacePageRecapitulatifAbsenceEleve.prototype.ConstruireInstances=function(){this.identListe=this.Add(window.ObjetListe,null,_initialiserListe);this.IdentZoneAlClient=this.identListe;};function _getTraduction(aValeur){return'{'+GTraductions.getValeur(aValeur)+'}';}
function _initialiserListe(aInstance){aInstance.SetParametres([[_getTraduction('Matieres'),_getTraduction('RecapAbsenceEleve.HeuresSuiviParClasse'),_getTraduction('RecapAbsenceEleve.DetailsHeuresManquees'),EFusionTitre.FusionGauche,EFusionTitre.FusionGauche,EFusionTitre.FusionGauche],[EFusionTitre.FusionHaute,EFusionTitre.FusionHaute,_getTraduction('RecapAbsenceEleve.TotalManquees'),_getTraduction('RecapAbsenceEleve.Absences'),_getTraduction('RecapAbsenceEleve.ExclusionCours'),_getTraduction('RecapAbsenceEleve.ExclusionEtablissement')]],['300' ,'85','85','85','85','85']);aInstance.setOptionsListe({nonEditable:true,hauteurAdapteContenu:true,ligneBidonFixeTaille:false,avecLigneTotal:true});}
ObjetInterfacePageRecapitulatifAbsenceEleve.prototype.setDonnees=function(aDonnees){aDonnees.listeMatieres.trier();if(GEtatUtilisateur.estModeAccessible()){this.donnees=aDonnees;this.AfficherListe();} else{if(aDonnees.message){GHtml.setHtml(this.Nom,this.composeMessage(aDonnees.message));} else{this.GetInstance(this.identListe).SetDonnees(new ObjetDonneesRecapitulatifAbsenceEleve(aDonnees));}}};})();MethodesObjet.heritagePrototype(ObjetDonneesRecapitulatifAbsenceEleve,ObjetDonneesListe);function ObjetDonneesRecapitulatifAbsenceEleve(aDonnees){this.inheritedCreate(aDonnees.listeMatieres);this.totaux=aDonnees.totaux;}
ObjetDonneesRecapitulatifAbsenceEleve.prototype.AvecEdition=function(I,D){return false;};ObjetDonneesRecapitulatifAbsenceEleve.prototype.AvecSelection=function(I,D){return false;};ObjetDonneesRecapitulatifAbsenceEleve.prototype.AvecSuppression=function(I,D){return false;};ObjetDonneesRecapitulatifAbsenceEleve.prototype._getPlacesEnDuree=function(aPlaces){return aPlaces>0?GDate.FormatDureeEnMillisecondes(aPlaces*1000,'%hhh%mm'):'';};ObjetDonneesRecapitulatifAbsenceEleve.prototype._getValeurDeColonne=function(I,D){switch(I){case 0:return D.GetLibelle();case 1:return D.suivi;case 2:return D.total;case 3:return D.absence;case 4:return D.excluCours;case 5:return D.excluEtab;default:;}
return 0;};ObjetDonneesRecapitulatifAbsenceEleve.prototype.GetValeur=function(I,D,K){switch(I){case 0:return D.GetLibelle();default:return this._getPlacesEnDuree(this._getValeurDeColonne(I,D));}};ObjetDonneesRecapitulatifAbsenceEleve.prototype.getClass=function(I,D){return I>0?'AlignementDroit':'';};ObjetDonneesRecapitulatifAbsenceEleve.prototype.getStyleTotal=function(aColonne){return GStyle.composeCouleurFond(GCouleur.liste.total.fond)+GStyle.composeCouleurTexte(GCouleur.liste.total.texte);};ObjetDonneesRecapitulatifAbsenceEleve.prototype.getClassTotal=function(aColonne){return'Gras '+(aColonne===0?'AlignementGauche':'AlignementDroit');};ObjetDonneesRecapitulatifAbsenceEleve.prototype.getContenuTotal=function(aColonne){if(this.totaux)
switch(aColonne){case 0:return GChaine.Format(GTraductions.getValeur('RecapAbsenceEleve.NbMatieres'),[this.Donnees.GetNbrElements()]);case 1:return this._getPlacesEnDuree(this.totaux.suivi);case 2:return this._getPlacesEnDuree(this.totaux.total);case 3:return this._getPlacesEnDuree(this.totaux.absence);case 4:return this._getPlacesEnDuree(this.totaux.excluCours);case 5:return this._getPlacesEnDuree(this.totaux.excluEtab);default:;}
return'';};;
ObjetInterfacePageRecapitulatifAbsenceEleve.prototype.AfficherListe=function(){var lIdListe=this.Nom+'_Liste';this._objetListeArborescente=new ObjetListeArborescente(lIdListe,0,this,null);var lRacine=this._objetListeArborescente.construireRacine();this._objetListeArborescente.setParametres(false);if(this.donnees.message){this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lRacine,'',this.donnees.message);} else{for(var i=0;i<=this.donnees.listeMatieres.GetNbrElements();i++){var lIsTotal=i===this.donnees.listeMatieres.GetNbrElements()?true:false;var lMatiere=lIsTotal?this.donnees.totaux:this.donnees.listeMatieres.GetElement(i);var lNoeudMatiere=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lRacine,'',lIsTotal?GChaine.Format(GTraductions.getValeur('RecapAbsenceEleve.NbMatieres'),[this.donnees.listeMatieres.GetNbrElements()]):lMatiere.Libelle,null,false);this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudMatiere,'',GTraductions.getValeur('RecapAbsenceEleve.HeuresSuiviParClasse')+' : '+GDate.FormatDureeEnMillisecondes(lMatiere.suivi*1000,'%hhh%mm'));if(lMatiere.total>0||lIsTotal){var lNoeudHeureManquee=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lNoeudMatiere,'',GTraductions.getValeur('RecapAbsenceEleve.DetailsHeuresManquees'),null,false);if(!lIsTotal) this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudHeureManquee,'',GTraductions.getValeur('RecapAbsenceEleve.TotalManquees')+' : '+GDate.FormatDureeEnMillisecondes(lMatiere.total*1000,'%hhh%mm'));if(lMatiere.absence>0){this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudHeureManquee,'',GTraductions.getValeur('RecapAbsenceEleve.Absences')+' : '+GDate.FormatDureeEnMillisecondes(lMatiere.absence*1000,'%hhh%mm'));}
if(lMatiere.excluCours>0){this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudHeureManquee,'',GTraductions.getValeur('RecapAbsenceEleve.ExclusionCours')+' : '+GDate.FormatDureeEnMillisecondes(lMatiere.excluCours*1000,'%hhh%mm'));}
if(lMatiere.excluEtab>0){this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudHeureManquee,'',GTraductions.getValeur('RecapAbsenceEleve.ExclusionEtablissement')+' : '+GDate.FormatDureeEnMillisecondes(lMatiere.excluEtab*1000,'%hhh%mm'));}
if(lMatiere.infirmerie>0){this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudHeureManquee,'',GTraductions.getValeur('RecapAbsenceEleve.Infirmerie')+' : '+GDate.FormatDureeEnMillisecondes(lMatiere.infirmerie*1000,'%hhh%mm'));}}}}
GHtml.setHtml(this.Nom,this._objetListeArborescente.ConstruireAffichage());this._objetListeArborescente.SetDonnees(lRacine);};;
function ObjetRequetePageVieScolaire(aPere,aEvenementSurReussite,aEvenementSurEchec){this.inheritedCreate(aPere,aEvenementSurReussite,aEvenementSurEchec);}
IE.Requetes.inscrire('PagePresence',ObjetRequetePageVieScolaire,_ObjetRequeteXmlConsultationPN);(function(){ObjetRequetePageVieScolaire.prototype.lancerRequete=function(aDateDebut,aDateFin){this.JSON={DateDebut:aDateDebut,DateFin:aDateFin};this.appelAsynchroneConsultation();};ObjetRequetePageVieScolaire.prototype.actionApresRequete=function(aXml){this.recap=new ObjetListeElements();this.listeAbsences=new ObjetListeElements();var lMessage=this.JSONReponse.message;if(!lMessage){this.listeAbsences=new ObjetDeserialiser().listeEvenementsVS(this.JSONReponse.listeAbsences,false);this.recap=this.initialiserRecapitulatif(this.JSONReponse.listeRecapitulatifs,this.JSONReponse.listeSanctionUtilisateur);this.listeAbsences.parcourir(_enrichirAbsence.bind(this));this.recap.setTri([ObjetTri.init('Position'),ObjetTri.init('Libelle')]);this.recap.trier();}
this.callbackReussite.appel({listeRecapitulatifs:this.recap,listeAbsences:this.listeAbsences,autorisations:this.JSONReponse.autorisations,message:lMessage});};ObjetRequetePageVieScolaire.prototype.creerElementRecapitulatifAbsences=function(aObjet){var lElement=new ObjetElement('',aObjet.numero,aObjet.genre,aObjet.position,true);lElement.justifie=(aObjet.justifie!==null&&aObjet.justifie!==undefined)?aObjet.justifie:false;lElement.estLue=(aObjet.estLue!==null&&aObjet.estLue!==undefined)?aObjet.estLue:false;lElement.Nombre=(aObjet.nombre!==null&&aObjet.nombre!==undefined)?aObjet.nombre:0;lElement.NbrHeures=(aObjet.nbrHeures!==null&&aObjet.nbrHeures!==undefined)?aObjet.nbrHeures:'';if((aObjet.genreNature!==null&&aObjet.genreNature!==undefined)){lElement.genreNature=aObjet.genreNature;lElement.estUneExclusion=aObjet.genre===EGenreRessource.Sanction?EGenreSanction.estUneExclusion(aObjet.genreNature):false;}
return lElement ;};ObjetRequetePageVieScolaire.prototype.initialiserRecapitulatif=function(aListeRecapitulatifs,aListeSanctionUtilisateur){var lObjet,i;var lListeRecapitulatifs=new ObjetListeElements();lObjet={genre:EGenreRessource.ObservationProfesseurEleve,estLue:false};lObjet.position=EGenreRessource.getPositionAbsence(lObjet);lListeRecapitulatifs.AddElement(this.creerElementRecapitulatifAbsences(lObjet));lObjet.estLue=true;lObjet.position=EGenreRessource.getPositionAbsence(lObjet);lListeRecapitulatifs.AddElement(this.creerElementRecapitulatifAbsences(lObjet));for(i=0;i<aListeRecapitulatifs.GetNbrElements();i++){var lElement=aListeRecapitulatifs.GetElement(i);lListeRecapitulatifs.AddElement(this.creerElementRecapitulatifAbsences({genre:lElement.GetGenre(),justifie:lElement.justifie,position:EGenreRessource.getPositionAbsence({genre:lElement.GetGenre(),justifie:lElement.justifie}),nombre:lElement.Nombre||0,nbrHeures:lElement.NbrHeures||''}));}
lObjet={genre:EGenreRessource.AbsenceRepas};lObjet.position=EGenreRessource.getPositionAbsence(lObjet);lListeRecapitulatifs.AddElement(this.creerElementRecapitulatifAbsences(lObjet));lObjet={genre:EGenreRessource.AbsenceInternat};lObjet.position=EGenreRessource.getPositionAbsence(lObjet);lListeRecapitulatifs.AddElement(this.creerElementRecapitulatifAbsences(lObjet));lObjet={genre:EGenreRessource.Infirmerie};lObjet.position=EGenreRessource.getPositionAbsence(lObjet);lListeRecapitulatifs.AddElement(this.creerElementRecapitulatifAbsences(lObjet));lObjet={genre:EGenreRessource.Retard};lObjet.position=EGenreRessource.getPositionAbsence(lObjet);lListeRecapitulatifs.AddElement(this.creerElementRecapitulatifAbsences(lObjet));lObjet={genre:EGenreRessource.Incident};lObjet.genreNature=EGenreRessource.Aucune;lObjet.position=EGenreRessource.getPositionAbsence(lObjet);lListeRecapitulatifs.AddElement(this.creerElementRecapitulatifAbsences(lObjet));lObjet.genreNature=EGenreRessource.Punition;lObjet.position=EGenreRessource.getPositionAbsence(lObjet);lListeRecapitulatifs.AddElement(this.creerElementRecapitulatifAbsences(lObjet));lObjet.genreNature=EGenreRessource.Sanction;lObjet.position=EGenreRessource.getPositionAbsence(lObjet);lListeRecapitulatifs.AddElement(this.creerElementRecapitulatifAbsences(lObjet));lObjet.genreNature=EGenreRessource.MesureConservatoire;lObjet.position=EGenreRessource.getPositionAbsence(lObjet);lListeRecapitulatifs.AddElement(this.creerElementRecapitulatifAbsences(lObjet));lObjet={genre:EGenreRessource.Punition,genreNature:EGenrePunition.Exclusion};lObjet.position=EGenreRessource.getPositionAbsence(lObjet);lListeRecapitulatifs.AddElement(this.creerElementRecapitulatifAbsences(lObjet));lObjet={genre:EGenreRessource.Punition,genreNature:EGenrePunition.Autre};lObjet.position=EGenreRessource.getPositionAbsence(lObjet);lListeRecapitulatifs.AddElement(this.creerElementRecapitulatifAbsences(lObjet));lObjet={genre:EGenreRessource.Punition,genreNature:EGenrePunition.Retenues};lObjet.position=EGenreRessource.getPositionAbsence(lObjet);lListeRecapitulatifs.AddElement(this.creerElementRecapitulatifAbsences(lObjet));lObjet={genre:EGenreRessource.Punition,genreNature:EGenrePunition.Devoir};lObjet.position=EGenreRessource.getPositionAbsence(lObjet);lListeRecapitulatifs.AddElement(this.creerElementRecapitulatifAbsences(lObjet));lObjet={genre:EGenreRessource.Punition,genreNature:EGenrePunition.TIG};lObjet.position=EGenreRessource.getPositionAbsence(lObjet);lListeRecapitulatifs.AddElement(this.creerElementRecapitulatifAbsences(lObjet));lObjet={genre:EGenreRessource.Punition,genreNature:EGenrePunition.Autre};lObjet.position=EGenreRessource.getPositionAbsence(lObjet);lListeRecapitulatifs.AddElement(this.creerElementRecapitulatifAbsences(lObjet));lObjet={genre:EGenreRessource.MesureConservatoire,genreNature:EGenreSanction.MesureConservatoire};lObjet.position=EGenreRessource.getPositionAbsence(lObjet);lListeRecapitulatifs.AddElement(this.creerElementRecapitulatifAbsences(lObjet));lObjet={genre:EGenreRessource.Sanction,genreNature:EGenreSanction.ExclusionDefinitive};lObjet.position=EGenreRessource.getPositionAbsence(lObjet);lListeRecapitulatifs.AddElement(this.creerElementRecapitulatifAbsences(lObjet));lObjet={genre:EGenreRessource.Sanction,genreNature:EGenreSanction.ExclusionTemporaireClasse};lObjet.position=EGenreRessource.getPositionAbsence(lObjet);lListeRecapitulatifs.AddElement(this.creerElementRecapitulatifAbsences(lObjet));lObjet={genre:EGenreRessource.Sanction,genreNature:EGenreSanction.ExclusionTemporaireEtablissement};lObjet.position=EGenreRessource.getPositionAbsence(lObjet);lListeRecapitulatifs.AddElement(this.creerElementRecapitulatifAbsences(lObjet));lObjet={genre:EGenreRessource.Sanction,genreNature:EGenreSanction.ExclusionDP};lObjet.position=EGenreRessource.getPositionAbsence(lObjet);lListeRecapitulatifs.AddElement(this.creerElementRecapitulatifAbsences(lObjet));lObjet={genre:EGenreRessource.Sanction,genreNature:EGenreSanction.ExclusionInternat};lObjet.position=EGenreRessource.getPositionAbsence(lObjet);lListeRecapitulatifs.AddElement(this.creerElementRecapitulatifAbsences(lObjet));lObjet={};lObjet={genre:EGenreRessource.Sanction,genreNature:EGenreSanction.Avertissement};lObjet.position=EGenreRessource.getPositionAbsence(lObjet);lListeRecapitulatifs.AddElement(this.creerElementRecapitulatifAbsences(lObjet));lObjet={genre:EGenreRessource.Sanction,genreNature:EGenreSanction.Blame};lObjet.position=EGenreRessource.getPositionAbsence(lObjet);lListeRecapitulatifs.AddElement(this.creerElementRecapitulatifAbsences(lObjet));lObjet={genre:EGenreRessource.Sanction,genreNature:EGenreSanction.Responsabilisation};lObjet.position=EGenreRessource.getPositionAbsence(lObjet);lListeRecapitulatifs.AddElement(this.creerElementRecapitulatifAbsences(lObjet));lObjet={genre:EGenreRessource.Sanction,genreNature:EGenreSanction.MesureConservatoire};lObjet.position=EGenreRessource.getPositionAbsence(lObjet);lListeRecapitulatifs.AddElement(this.creerElementRecapitulatifAbsences(lObjet));for(i=0;i<aListeSanctionUtilisateur.GetNbrElements();i++){var lSanction=aListeSanctionUtilisateur.GetElement(i);lObjet={genre:EGenreRessource.Sanction,genreNature:lSanction.GetGenre(),numero:lSanction.GetNumero()};lObjet.position=EGenreRessource.getPositionAbsence(lObjet);lListeRecapitulatifs.AddElement(this.creerElementRecapitulatifAbsences(lObjet));}
return lListeRecapitulatifs;};function _filtreRecapitulatif(aAbsence,aElement){var lTest=(aElement.GetGenre()===aAbsence.GetGenre())&&(aAbsence.GetGenre()!==EGenreRessource.Absence||aElement.justifie===aAbsence.justifie)&&(aAbsence.GetGenre()!==EGenreRessource.ObservationProfesseurEleve||aElement.estLue===aAbsence.estLue);if(lTest){switch(aElement.GetGenre()){case EGenreRessource.Incident:if(aAbsence.mesure){return(aAbsence.mesure.GetGenre()===EGenreRessource.Punition&&aElement.genreNature===EGenreRessource.Punition)||(aAbsence.mesure.GetGenre()===EGenreRessource.Sanction&&aElement.genreNature===EGenreRessource.Sanction);}
return aElement.genreNature===EGenreRessource.Aucune;case EGenreRessource.Exclusion:case EGenreRessource.Punition:return aAbsence.nature.GetGenre()===aElement.genreNature;case EGenreRessource.Sanction:if(aAbsence.nature.GetGenre()!==EGenreSanction.Autre_Sanction&&aAbsence.nature.GetGenre()!==EGenreSanction.Autre_Exclusion)
return aAbsence.nature.GetGenre()===aElement.genreNature;else return aAbsence.nature.GetNumero()===aElement.GetNumero();}}
return lTest;}
ObjetRequetePageVieScolaire.prototype.ajoutSurRecapitulatifSelonAbsence=function(aListeRecapitulatifs,aAbsence){var lIndice=aListeRecapitulatifs.getIndiceElementParFiltre(_filtreRecapitulatif.bind(this,aAbsence));var lElement=aListeRecapitulatifs.GetElement(lIndice);if(lElement&&(aAbsence.GetGenre()!==EGenreRessource.Absence)){if(!aAbsence.estProgrammation)
lElement.Nombre++;if(lElement.GetLibelle()===''&&MethodesTableau.existe(lElement.GetGenre(),[EGenreRessource.MesureConservatoire,EGenreRessource.Sanction])){lElement.SetLibelle(aAbsence.nature.GetLibelle());} else if(lElement.GetLibelle()===''&&MethodesTableau.existe(lElement.GetGenre(),[EGenreRessource.Punition])){lElement.SetLibelle(this._getLibelleNature(aAbsence.nature));}}};ObjetRequetePageVieScolaire.prototype._getLibelleNature=function(aNature){switch(aNature.GetGenre()){case EGenrePunition.Exclusion:return GTraductions.getValeur('AbsenceVS.exclusion');case EGenrePunition.Retenues:return GTraductions.getValeur('AbsenceVS.retenue');case EGenrePunition.TIG:return GTraductions.getValeur('AbsenceVS.TIG');case EGenrePunition.Devoir:return GTraductions.getValeur('AbsenceVS.devoirSuppl');case EGenrePunition.Autre:return GTraductions.getValeur('AbsenceVS.punitionAutre');default:;return'';}}
function _enrichirAbsence(aElement){this.ajoutSurRecapitulatifSelonAbsence(this.recap,aElement);}}());;
function ObjetRequeteRecapitulatifAbsenceEleve(aPere,aEvenementSurReussite,aEvenementSurEchec){this.inheritedCreate(aPere,aEvenementSurReussite,aEvenementSurEchec);}
IE.Requetes.inscrire('RecapitulatifAbsenceEleve',ObjetRequeteRecapitulatifAbsenceEleve,_ObjetRequeteXmlConsultationPN);ObjetRequeteRecapitulatifAbsenceEleve.prototype.lancerRequete=function(aNumeroEleve,aDateDebut,aDateFin){var lXml=this.XML;lXml.CreerCategorie(null,'Eleve' ,null,aNumeroEleve);lXml.CreerVariable(null,'DateDebut',EGenreType.Date,aDateDebut);lXml.CreerVariable(null,'DateFin' ,EGenreType.Date,aDateFin);this.appelAsynchroneConsultation();};ObjetRequeteRecapitulatifAbsenceEleve.prototype.actionApresRequete=function(aXml){var lDonnees={message:this.JSONReponse.Message};if(!lDonnees.message){lDonnees.totaux={suivi:0,absence:0,excluCours:0,excluEtab:0,infirmerie:0,total:0};lDonnees.listeMatieres=new ObjetListeElements().fromJSON(this.JSONReponse.Matieres,this._deserialiserDuree.bind(this,lDonnees.totaux));}
this.callbackReussite.appel(lDonnees);};ObjetRequeteRecapitulatifAbsenceEleve.prototype._deserialiserDuree=function(aTotaux,aJSON,aElement){aElement.suivi=aJSON.suivi;aElement.absence=aJSON.absence;aElement.excluCours=aJSON.excluCours;aElement.excluEtab=aJSON.excluEtab;aElement.infirmerie=aJSON.infirmerie;aElement.total=aElement.absence+aElement.excluCours+aElement.excluEtab;aTotaux.suivi+=aElement.suivi;aTotaux.absence+=aElement.absence;aTotaux.excluCours+=aElement.excluCours;aTotaux.excluEtab+=aElement.excluEtab;aTotaux.infirmerie+=aElement.infirmerie;aTotaux.total+=aElement.total;};;
function ObjetRequeteSaisieVieScolaire(aPere,aEvenementSurReussite,aEvenementSurEchec){this.inheritedCreate(aPere,aEvenementSurReussite,aEvenementSurEchec);}
IE.Requetes.inscrire('SaisieVieScolaire',ObjetRequeteSaisieVieScolaire,_ObjetRequeteXmlSaisiePN);ObjetRequeteSaisieVieScolaire.prototype.lancerRequete=function(aListeAbsences){var P=this.XML;P.CreerListeElements(null,'ListeAbsences','Absence',aListeAbsences,this,this._serialiserAbsences);this.appelAsynchroneSaisie();};ObjetRequeteSaisieVieScolaire.prototype.actionApresRequete=function(aXml){this.callbackReussite.appel(aXml);};ObjetRequeteSaisieVieScolaire.prototype._serialiserAbsences=function(aXml,aNoeud,aAbsence){aXml.CreerVariable(aNoeud,'EstLue' ,EGenreType.Boolean,aAbsence.estLue);aXml.CreerVariable(aNoeud,'Justification',EGenreType.String ,aAbsence.justification);aXml.CreerElement(aNoeud,'MotifParent' ,aAbsence.motifParent);aXml.CreerVariable(aNoeud,'ParentAAccuseDeReception',EGenreType.Boolean,aAbsence.parentAAccuseDeReception);};;
MethodesObjet.heritagePrototype(ObjetAffichagePagePresence,ObjetInterfacePage);function ObjetAffichagePagePresence(ANom,AIdent,APere,AEvenement){this.inheritedCreate(ANom,AIdent,APere,AEvenement);this.donnees={listeRecapitulatifs:new ObjetListeElements(),listeAbsences:new ObjetListeElements(),apresValidation:false,elementSelection:null};}
ObjetAffichagePagePresence.prototype.ConstruireInstances=function(){switch(GEtatUtilisateur.getGenreOnglet()){case EGenreOnglet.Absences_Recapitulatif:this.identCmbGenreAbsence=this.Add(window.ObjetSaisiePN,this.evenementSurCmbGenreAbsence,this.initialiserCmbGenreAbsence);this.IdPremierElement=this.GetInstance(this.identCmbGenreAbsence).getPremierElement();this.identPresence=this.Add(window.ObjetAffichagePagePresence_enGrille,this.evenementAffichageEnGrille,this.initialiserAffichage);break;case EGenreOnglet.Absences_Liste:this.identCmbPeriode=this.Add(window.ObjetSaisiePN,this.evenementSurCmbPeriode,this.initialiserCmbPeriode);this.IdPremierElement=this.GetInstance(this.identCmbPeriode).getPremierElement();this.identPresence=this.Add(window.ObjetAffichagePagePresence_enListe,this.evenementAffichageEnListe,this.initialiserAffichage);break;case EGenreOnglet.Absences_HeuresManquees:this.identCmbPeriode=this.Add(window.ObjetSaisiePN,this.evenementSurCmbPeriode,this.initialiserCmbPeriode);this.IdPremierElement=this.GetInstance(this.identCmbPeriode).getPremierElement();this.identPresence=this.Add(window.ObjetInterfacePageRecapitulatifAbsenceEleve,null,null);break;default:;}};ObjetAffichagePagePresence.prototype.SetParametresGeneraux=function(){this.AvecCadre=false;this.avecBandeau=true;if(GEtatUtilisateur.getGenreOnglet()===EGenreOnglet.Absences_Recapitulatif) this.AddSurZone=[this.identCmbGenreAbsence];else this.AddSurZone=[this.identCmbPeriode];this.IdentZoneAlClient=this.identPresence;this.GenreStructure=EStructureAffichage.Autre;};ObjetAffichagePagePresence.prototype.ConstruireStructureAffichageAutre=function(){var lHtml=[];lHtml.push('<div id="',(this.GetInstance(this.identPresence).GetNom()),'" class="Table"></div>');return lHtml.join('');};ObjetAffichagePagePresence.prototype.initialiserCmbGenreAbsence=function(AInstance){AInstance.setOptions_ObjetSaisie({labelWAIZone:GTraductions.getValeur('AbsenceVS.comboGenreAbsence'),roleWAIEdit:EGenreRole.Option,longueur:160});};ObjetAffichagePagePresence.prototype.initialiserCmbPeriode=function(AInstance){AInstance.setOptions_ObjetSaisie({labelWAIZone:GTraductions.getValeur('AbsenceVS.comboPeriode'),roleWAIEdit:EGenreRole.Option,longueur:160});};ObjetAffichagePagePresence.prototype.initialiserAffichage=function(aInstance){};ObjetAffichagePagePresence.prototype.RecupererDonnees=function(){if(!this.Pere.EnConstruction){if(GEtatUtilisateur.getGenreOnglet()===EGenreOnglet.Absences_Recapitulatif){this.DateDebut=GParametres.PremiereDate;this.DateFin=GParametres.DerniereDate;new ObjetRequetePageVieScolaire(this,this.actionSurRecupererDonnees).lancerRequete(this.DateDebut,this.DateFin);} else{this.listePeriodes=GEtatUtilisateur.getOngletListePeriodes();this.GetInstance(this.identCmbPeriode).SetDonnees(this.listePeriodes);this.GetInstance(this.identCmbPeriode).setSelectionParElement(GEtatUtilisateur.getOngletPeriodeParDefaut(),0);}}};ObjetAffichagePagePresence.prototype.actionSurRecupererDonnees=function(aObjet){$.extend(this.donnees,aObjet);if(GEtatUtilisateur.getGenreOnglet()===EGenreOnglet.Absences_Recapitulatif){this.construireListeGenreAbsencesPourCombo(this.donnees.listeRecapitulatifs);if(!aObjet.apresValidation){this.GetInstance(this.identCmbGenreAbsence).SetDonnees(this.listeCmbGenreAbsence,0);this.surResizeInterface();}} else{this.GetInstance(this.identPresence).setDonnees(this.donnees);this.GetInstance(this.identPresence).surResizeInterface();}};(function(){function _filtreRecapitulatif(aAbsence,aElement){var lTest=(aElement.GetGenre()===aAbsence.GetGenre())&&(aAbsence.GetGenre()!==EGenreRessource.Absence||aElement.justifie===aAbsence.justifie)&&(aAbsence.GetGenre()!==EGenreRessource.ObservationProfesseurEleve||aElement.estLue===aAbsence.estLue);if(lTest){switch(aElement.GetGenre()){case EGenreRessource.Incident:if(aAbsence.mesure){return(aAbsence.mesure.GetGenre()===EGenreRessource.Punition&&aElement.genreNature===EGenreRessource.Punition)||(aAbsence.mesure.GetGenre()===EGenreRessource.Sanction&&aElement.genreNature===EGenreRessource.Sanction);}
return aElement.genreNature===EGenreRessource.Aucune;case EGenreRessource.Exclusion:case EGenreRessource.Punition:return aAbsence.nature.GetGenre()===aElement.genreNature;default:break;}}
return lTest;}
ObjetAffichagePagePresence.prototype.actionSurRecupererDonneesApresValidation=function(aObjet){aObjet.apresValidation=true;this.actionSurRecupererDonnees(aObjet);if(GEtatUtilisateur.getGenreOnglet()===EGenreOnglet.Absences_Recapitulatif){var lIndice=this.donnees.elementSelection?this.listeCmbGenreAbsence.getIndiceElementParFiltre(_filtreRecapitulatif.bind(this,this.donnees.elementSelection)):0;if(lIndice=== -1) lIndice=0;this.GetInstance(this.identCmbGenreAbsence).SetDonnees(this.listeCmbGenreAbsence,lIndice);}};}());ObjetAffichagePagePresence.prototype.evenementSurCmbGenreAbsence=function(aGenreEvenement,aElementSelection){if(aGenreEvenement===EGenreEvenementObjetSaisie.selection){this.donnees.elementSelection=aElementSelection;this.GetInstance(this.identPresence).setDonnees(this.donnees);this.GetInstance(this.identPresence).surResizeInterface();}};ObjetAffichagePagePresence.prototype.evenementSurCmbPeriode=function(aGenreEvenement,aElementSelection){if(aGenreEvenement===EGenreEvenementObjetSaisie.selection){this.donnees.elementSelection=aElementSelection;this.DateDebut=GParametres.PremiereDate;this.DateFin=GParametres.DerniereDate;if(aElementSelection.existeNumero()){var lElement=GParametres.listePeriodes.GetElementParNumero(aElementSelection.GetNumero());this.DateDebut=lElement.dates.debut;this.DateFin=lElement.dates.fin;}
if(GEtatUtilisateur.getGenreOnglet()===EGenreOnglet.Absences_Liste)
new ObjetRequetePageVieScolaire(this,this.actionSurRecupererDonnees).lancerRequete(this.DateDebut,this.DateFin);else new ObjetRequeteRecapitulatifAbsenceEleve(this,this.actionSurRecupererDonnees).lancerRequete(GEtatUtilisateur.GetNumeroEleve(),this.DateDebut,this.DateFin);}};ObjetAffichagePagePresence.prototype.evenementAffichageEnGrille=function(aAvecSaisie,aAbsence){if(aAvecSaisie){var lElement=this.donnees.listeAbsences.GetElementParElement(aAbsence);lElement.estLue=aAbsence.estLue;lElement.parentAAccuseDeReception=aAbsence.parentAAccuseDeReception;lElement.SetEtat(EGenreEtat.Modification);this.avecActualisation=true;this.Valider();} else{if(this.avecActualisation&&this.GetInstance(this.identPresence)){this.GetInstance(this.identPresence).setDonnees(this.donnees,true);}
this.avecActualisation=false;}};ObjetAffichagePagePresence.prototype.evenementAffichageEnListe=function(aGenreListeAbsence,aAbsence){var lElement;switch(aGenreListeAbsence){case EGenreRessource.ObservationProfesseurEleve:lElement=this.donnees.listeAbsences.GetElementParElement(aAbsence);if(lElement){lElement.estLue=aAbsence.estLue;lElement.SetEtat(EGenreEtat.Modification);this.SetEtatSaisie(true);this.Valider();}
break;case EGenreRessource.Absence:case EGenreRessource.Retard:lElement=this.donnees.listeAbsences.GetElementParElement(aAbsence);if(lElement){lElement.justification=aAbsence.justification;lElement.SetEtat(EGenreEtat.Modification);this.SetEtatSaisie(true);}
break;case EGenreRessource.Punition:lElement=this.donnees.listeAbsences.GetElementParElement(aAbsence);if(lElement){lElement.parentAAccuseDeReception=aAbsence.parentAAccuseDeReception;lElement.SetEtat(EGenreEtat.Modification);this.SetEtatSaisie(true);this.Valider();}
break;default:break;}};ObjetAffichagePagePresence.prototype.construireListeGenreAbsencesPourCombo=function(aListeRecapitulatifs){this.listeCmbGenreAbsence=new ObjetListeElements();this.addGenreSurCmbGenreAbsences({genre:-1,libelle:GTraductions.getValeur('AbsenceVS.toutesLesAbsences')});for(var I=0;I<aListeRecapitulatifs.GetNbrElements();I++){var lRecapitulatif=aListeRecapitulatifs.GetElement(I);if(lRecapitulatif.Nombre){var lGenre=lRecapitulatif.GetGenre();if(((lGenre===EGenreRessource.Punition&&lRecapitulatif.genreNature!==EGenrePunition.Exclusion)||lGenre===EGenreRessource.Sanction||lGenre===EGenreRessource.Incident)&&(lGenre!==this.ancienGenreRecapitulatif)){this.addGenreSurCmbGenreAbsences({genre:lGenre,libelle:this.GetInstance(this.identPresence).getChaineTraductionGenreAbsenceTitre({genre:lRecapitulatif.Genre,justifie:lRecapitulatif.justifie,genreNature:lRecapitulatif.genreNature,estLue:lRecapitulatif.estLue,singulier:false}).ucfirst(),estLue:lRecapitulatif.estLue});this.ancienGenreRecapitulatif=lGenre;} else{if((lGenre!==EGenreRessource.Sanction&&lGenre!==EGenreRessource.Punition&&lGenre!==EGenreRessource.Incident)||(lGenre===EGenreRessource.Punition&&lRecapitulatif.genreNature===EGenrePunition.Exclusion))
this.addGenreSurCmbGenreAbsences({genre:lGenre,libelle:this.GetInstance(this.identPresence).getChaineTraductionGenreAbsenceTitre({genre:lRecapitulatif.Genre,justifie:lRecapitulatif.justifie,genreNature:lRecapitulatif.genreNature,estLue:lRecapitulatif.estLue,singulier:false}).ucfirst(),estLue:lRecapitulatif.estLue,justifie:lRecapitulatif.justifie,estPunitionExclusion:lRecapitulatif.genreNature===EGenrePunition.Exclusion});}
this.ancienGenreRecapitulatif=lGenre;if(lGenre===EGenreRessource.Punition&&(lRecapitulatif.genreNature===EGenrePunition.Exclusion))
this.ancienGenreRecapitulatif=null;}}};ObjetAffichagePagePresence.prototype.addGenreSurCmbGenreAbsences=function(aObjet){var lElement=new ObjetElement(aObjet.libelle,null,aObjet.genre);lElement.justifie=aObjet.justifie;lElement.estPunitionExclusion=aObjet.estPunitionExclusion;lElement.estLue=aObjet.estLue;this.listeCmbGenreAbsence.AddElement(lElement);};ObjetAffichagePagePresence.prototype.surResizeInterface=function(){this.inherited('surResizeInterface');};ObjetAffichagePagePresence.prototype.Valider=function(){new ObjetRequeteSaisieVieScolaire(this,this.ActionSurValidation).lancerRequete(this.donnees.listeAbsences);};ObjetAffichagePagePresence.prototype.ActionSurValidation=function(){if(this._callbackNavigation){this._callbackNavigation();delete this._callbackNavigation;} else{this.SetEtatSaisie(false);new ObjetRequetePageVieScolaire(this,this.actionSurRecupererDonneesApresValidation).lancerRequete(this.DateDebut,this.DateFin);}};;
function ObjetRequeteSaisieMotDePasse(aPere,aEvenementSurReussite,aEvenementSurEchec){this.inheritedCreate(aPere,aEvenementSurReussite,aEvenementSurEchec);}
IE.Requetes.inscrire('SaisieMotDePasse',ObjetRequeteSaisieMotDePasse,_ObjetRequeteXmlSaisiePN);ObjetRequeteSaisieMotDePasse.prototype.lancerRequete=function(aAncienMotDePasse,aNouveauMotDePasse){this.JSON={ancienMDP:GApplication.getCommunication().getChaineChiffreeAES(aAncienMotDePasse),nouveauMDP:GApplication.getCommunication().getChaineChiffreeAES(aNouveauMotDePasse)} ;this.appelAsynchroneSaisie();};ObjetRequeteSaisieMotDePasse.prototype.traiterReponseSaisieMessage=function(aMessage){this.inherited('traiterReponseSaisieMessage',aMessage);this.messageDejaAffiche=true;};ObjetRequeteSaisieMotDePasse.prototype.actionApresRequete=function(){var lAvecErreur=this.reponseEnErreur();this.callbackReussite.appel(lAvecErreur,this.JSONReponse,this.messageDejaAffiche);};;
function ObjetFenetre_ModificationIdentifiantMDP(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.avecTailleSelonContenu=true;this.setOptionsFenetre({avecMessageValidationAuto:true});this.ids={input1:this.Nom+'_mdp',input2:this.Nom+'_login',inputConfirm:this.Nom+'_loginConfirm',validateur:this.Nom+'_validateur'};this._setBoutons([GTraductions.getValeur('Annuler'),GTraductions.getValeur('Valider')]);this.changementMDP=true;this.changementMDPEleve=false;}
IE.MethodesObjet.heritagePrototype(ObjetFenetre_ModificationIdentifiantMDP,ObjetFenetre);(function(){var c_tailleIdentifiant={min:5,max:32};function _surKeyUpInput(event){if(event.which===ToucheClavier.RetourChariot){GHtml.setFocus(event.data.idFocus);}}
ObjetFenetre_ModificationIdentifiantMDP.prototype.Afficher=function(){this.SetTitre(this.changementMDPEleve?GTraductions.getValeur('PageCompte.titreEcranMotDePasseEnfant'):this.changementMDP?GTraductions.getValeur('PageCompte.titreEcranMotDePasse'):GTraductions.getValeur('PageCompte.titreEcranIdentifiant'));this.inherited('Afficher');GHtml.setFocus(this.ids.input1);$('#'+this.ids.input1.escapeJQ()).on('keyup',{idFocus:this.ids.login},_surKeyUpInput);$('#'+this.ids.input2.escapeJQ()).on('keyup',{idFocus:this.ids.loginConfirm},_surKeyUpInput);$('#'+this.ids.inputConfirm.escapeJQ()).on('keyup',{instance:this},function(event){if(event.which===ToucheClavier.RetourChariot){event.data.instance.SurValidation(1);}});};ObjetFenetre_ModificationIdentifiantMDP.prototype.ComposeContenu=function(){var H=[],lStyleInput=GStyle.composeCouleurBordure(GCouleur.fenetre.bordure)+GStyle.composeWidth(150);H.push('<div class="Texte10 Espace">');if(!this.changementMDPEleve){H.push('<div class="PetitEspaceBas">',this.changementMDP?GTraductions.getValeur('PageCompte.libelle1EcranMotDePasse'):GTraductions.getValeur('PageCompte.libelle1EcranIdentifiant'),'</div>','<input class="CelluleTexte" type="password" id="',this.ids.input1,'" style="',lStyleInput,'"/>');}
if(this.changementMDP){H.push('<div class="EspaceHaut PetitEspaceBas">'+(this.changementMDPEleve?GTraductions.getValeur('PageCompte.libelle1EcranMotDePasseEleve'):GTraductions.getValeur('PageCompte.libelle2EcranMotDePasse'))+'</div>');}
else{H.push('<div class="EspaceHaut">'+GTraductions.getValeur('PageCompte.libelle2EcranIdentifiant')+'</div>','<div class="PetitEspaceBas">'+GChaine.Format(GTraductions.getValeur('PageCompte.conseil2EcranIdentifiant'),[c_tailleIdentifiant.min]),'</div>');}
H.push('<input class="CelluleTexte" type="password" id="',this.ids.input2,'" style="',lStyleInput,'"/>');H.push('<div class="EspaceHaut PetitEspaceBas">',this.changementMDPEleve?GTraductions.getValeur('PageCompte.libelle2EcranMotDePasseEleve'):this.changementMDP?GTraductions.getValeur('PageCompte.libelle3EcranMotDePasse'):GTraductions.getValeur('PageCompte.libelle3EcranIdentifiant'),'</div>','<input class="CelluleTexte" type="password" id="',this.ids.inputConfirm,'" style="',lStyleInput,'"/>');if(this.changementMDP){H.push('<div class="EspaceHaut" id="',this.ids.validateur,'">',TValidationMotDePasse.construire(null),'</div>');}
H.push('</div>');return H.join('');};function _getValeurChampSansEntites(aId){var E=GHtml.getElement(aId),lValeur='';if(E){lValeur=E.value||'';}
return lValeur.trim();}
function _surReponseRequeteSaisieIdentifiant(aSurErreur,aJSONReponse,aMessageDejaAffiche){if(aJSONReponse&&aJSONReponse.messageErreur){var lInstance=this;GApplication.getMessage().afficher({titre:GTraductions.getValeur('SaisieMotDePasse.EchecModification'),message:aJSONReponse.messageErreur,callback:function(){GHtml.setValue(lInstance.ids.input1,'');GHtml.setValue(lInstance.ids.input2,'');GHtml.setValue(lInstance.ids.inputConfirm,'');GHtml.setFocus(lInstance.ids.input1);}});}
else{if(!aMessageDejaAffiche){GApplication.getMessage().afficher({message:aSurErreur?GTraductions.getValeur('SaisieMotDePasse.EchecModification'):GTraductions.getValeur('SaisieMotDePasse.ReussiteModification')});}
this.SurValidation(1,undefined,'reussiteRequete');}}
function _surReponseRequeteSaisieMotDePasseEleve(aSurErreur,aJSONReponse){if(aJSONReponse&&aJSONReponse.erreurMDP){new ObjetDeserialiser().reglesSaisieMotDePasse(aJSONReponse);var lMessage=TValidationMotDePasse.construire(aJSONReponse.erreurMDP);var lInstance=this;GApplication.getMessage().afficher({titre:GTraductions.getValeur('SaisieMotDePasse.EchecModification'),message:lMessage,callback:function(){GHtml.setValue(lInstance.ids.input2,'');GHtml.setValue(lInstance.ids.inputConfirm,'');GHtml.setFocus(lInstance.ids.input2);}});$('#'+this.ids.validateur.escapeJQ()).html(TValidationMotDePasse.construire(aJSONReponse.erreurMDP));}
else{GApplication.getMessage().afficher({message:aSurErreur?GTraductions.getValeur('SaisieMotDePasse.EchecModification'):GTraductions.getValeur('SaisieMotDePasse.ReussiteModification')});this.SurValidation(1,undefined,'reussiteRequete');}}
function _surReponseRequeteSaisieMotDePasse(aSurErreur,aJSONReponse,aMessageDejaAffiche){if(aJSONReponse&&aJSONReponse.erreurMDP){new ObjetDeserialiser().reglesSaisieMotDePasse(aJSONReponse);var lMessage='';if(aJSONReponse.erreurMDP.erreurAncienMDP){lMessage+=GTraductions.getValeur('SaisieMotDePasse.validation.ErreurMotDePasseActuel')+'<br><br>';}
lMessage+=TValidationMotDePasse.construire(aJSONReponse.erreurMDP);var lInstance=this;GApplication.getMessage().afficher({titre:GTraductions.getValeur('SaisieMotDePasse.EchecModification'),message:lMessage,callback:function(){if(aJSONReponse.erreurMDP.erreurAncienMDP){GHtml.setValue(lInstance.ids.input1,'');GHtml.setFocus(lInstance.ids.input1);}
else{GHtml.setValue(lInstance.ids.input2,'');GHtml.setValue(lInstance.ids.inputConfirm,'');GHtml.setFocus(lInstance.ids.input2);}}});$('#'+this.ids.validateur.escapeJQ()).html(TValidationMotDePasse.construire(aJSONReponse.erreurMDP));}
else{if(!aMessageDejaAffiche){GApplication.getMessage().afficher({message:aSurErreur?GTraductions.getValeur('SaisieMotDePasse.EchecModification'):GTraductions.getValeur('SaisieMotDePasse.ReussiteModification')});}
this.SurValidation(1,undefined,'reussiteRequete');}}
function _controleChampsSaisie(){var lInput1=_getValeurChampSansEntites(this.ids.input1),lInput2=_getValeurChampSansEntites(this.ids.input2),lInputConfirm=_getValeurChampSansEntites(this.ids.inputConfirm),lInstance=this;if(!this.changementMDPEleve&&lInput1.length===0){GApplication.getMessage().afficher({titre:GTraductions.getValeur('SaisieMotDePasse.EchecModification'),message:this.changementMDP?GTraductions.getValeur('PageCompte.message1MotDePasse'):GTraductions.getValeur('PageCompte.message1Identifiant'),callback:function(){GHtml.setValue(lInstance.ids.input1,'');GHtml.setFocus(lInstance.ids.input1);}});return;}
if(lInput2.length===0){GApplication.getMessage().afficher({titre:GTraductions.getValeur('SaisieMotDePasse.EchecModification'),message:this.changementMDP?GTraductions.getValeur('PageCompte.message2MotDePasse'):GTraductions.getValeur('PageCompte.message2Identifiant'),callback:function(){GHtml.setValue(lInstance.ids.input2,'');GHtml.setFocus(lInstance.ids.input2);}});return;}
if(lInput2!==lInputConfirm){GApplication.getMessage().afficher({titre:GTraductions.getValeur('SaisieMotDePasse.EchecModification'),message:this.changementMDP?GTraductions.getValeur('PageCompte.ErreurConfirmationMotDePasse'):GTraductions.getValeur('PageCompte.message3Identifiant'),callback:function(){GHtml.setValue(lInstance.ids.input2,'');GHtml.setValue(lInstance.ids.inputConfirm,'');GHtml.setFocus(lInstance.ids.input2);}});return;}
if(this.changementMDPEleve){new window.ObjetRequeteSaisieMotDePasseEleve(this,_surReponseRequeteSaisieMotDePasseEleve.bind(this)).lancerRequete(lInput2);}
else if(this.changementMDP){new ObjetRequeteSaisieMotDePasse(this,_surReponseRequeteSaisieMotDePasse.bind(this)).lancerRequete(lInput1,lInput2);}
else{new window.ObjetRequeteSaisieIdentifiant(this,_surReponseRequeteSaisieIdentifiant.bind(this)).lancerRequete(lInput1,lInput2);}}
ObjetFenetre_ModificationIdentifiantMDP.prototype.SurValidation=function(ANumeroBouton,aFermer,aFin){if(ANumeroBouton===1&&aFin!=='reussiteRequete'){_controleChampsSaisie.bind(this)();return;}
if(aFermer!==false)
this.Fermer();this.callback.appel(ANumeroBouton===1&&aFin==='reussiteRequete');};}());;
function ObjetPageCompte(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.parametres={largeurGauche:150,largeurLibelleInput:30,hauteurInput:20,largeurEmail:220,largeurIndicatif:36,largeurTel:100,largeurEspaceCompteEnfant:120,largeurMessageCompteEnfant:400,maskMDP:'*********',avecInfosEntreprise:GEtatUtilisateur.GenreEspace===EGenreEspace.Entreprise,avecTelFixe:GEtatUtilisateur.GenreEspace===EGenreEspace.Entreprise,avecTelFax:GEtatUtilisateur.GenreEspace===EGenreEspace.Entreprise};this.IDRef=IE.GUID.getId();this.ids={identifiant:this.IDRef+'_ident',mdp:this.IDRef+'_mdp',mdpEleve:this.IDRef+'_mdpEleve',email:this.IDRef+'_email',cbSMS:this.IDRef+'cbSMS',cbMail:this.IDRef+'cbMail',cbMailEtab:this.IDRef+'cbMailEtab',cbParent:this.IDRef+'cbParent',cbCourrier:this.IDRef+'cbCourrier',cbMsgParent:this.IDRef+'_cbMsgParent',cbMsgEleve:this.IDRef+'_cbMsgEleve',cbMsgProfsPerso:this.IDRef+'_cbMsgProfsPerso',cbMsgContactVS:this.IDRef+'_cbMsgContactVS'};this.donnees={AvecSMS:false,Informations:{nom:'',prenoms:'',civilite:'',adresse1:'',adresse2:'',adresse3:'',adresse4:'',codePostal:'',ville:'',pays:'',eMail:null,telephonePortable:null,indicatifTel:null,telephoneFixe:null,fax:null,entreprise:null,fonction:null},Autorisations:{SMSAutorise:null,emailAutorise:null,eMailEtablissementAutorise:null,eMailParentAutorise:null,courrierPapierAutorise:null,estDestinataireInfosGenerales:false,listeEleves:new ObjetListeElements(),msgParent:null,msgEleve:null,estContactVS:null}};}
IE.MethodesObjet.heritagePrototype(ObjetPageCompte,Identite);(function(){ObjetPageCompte.saisieInfos={mail:1,telFixe:2,telPort:3,fax:4};ObjetPageCompte.prototype.getControleur=function(){return{tel:{getValue:function(aChamp){return this.instance.donnees.Informations[aChamp];},setValue:function(aChamp,aValue){this.instance.donnees.Informations[aChamp]=aValue;if(aChamp==='telephonePortable')
_setDisableCB.call(this.instance,this.instance.ids.cbSMS,aValue==='');},getDisabled:function(){return!GApplication.droits.get(IEEnum.droits.compte.avecSaisieInfosPersoCoordonnees);}}};};function _construireDerniereConnexion(){var H=[];H.push(GDate.FormatDate(GEtatUtilisateur.derniereConnexion,'%JJ/%MM/%AA %hh:%mm'));return H.join('');}
function _construireIdentifiant(){var H=[];H.push('<div class="WhiteSpaceNormal InlineBlock GrandEspaceDroit">',GChaine.ajouterEntites(forge.util.decodeUtf8(GCryptage.decrypter({genreCryptage:EGenreCryptage.AES,chaine:this.donnees.authentifiant,cle:GApplication.getCommunication().cleAES,iv:GApplication.getCommunication().ivAES}))),'</div>');H.push('<div id="',this.ids.identifiant,'" tabindex="0" class="WhiteSpaceNormal InlineBlock Souligne AvecMain OmbreFocus GrasSurvol"',' style="',GStyle.composeCouleurTexte(GCouleur.texte),'">',GTraductions.getValeur('PageCompte.Modifier'),'</div>');return H.join('');}
function _construireMotDePasse(){var H=[];H.push('<div class="WhiteSpaceNormal InlineBlock GrandEspaceDroit">',this.parametres.maskMDP,'</div>');H.push('<div id="',this.ids.mdp,'" tabindex="0" class="WhiteSpaceNormal InlineBlock Souligne AvecMain OmbreFocus GrasSurvol"',' style="',GStyle.composeCouleurTexte(GCouleur.texte),'">',GTraductions.getValeur('PageCompte.Modifier'),'</div>');return H.join('');}
function _construireMotDePasseEleve(){var H=[];H.push('<div class="InlineBlock">');H.push('<div class="WhiteSpaceNormal GrandEspaceBas" style="',GStyle.composeWidth(this.parametres.largeurMessageCompteEnfant),'">','<span>',GTraductions.getValeur('PageCompte.MsgEnfant1'),'</span>','<br />','<br />','<span>',GTraductions.getValeur('PageCompte.MsgEnfant2'),'</span>','</div>');H.push('<div class="NoWrap GrandEspaceBas">');H.push('<div class="InlineBlock Gras" style="',GStyle.composeWidth(this.parametres.largeurEspaceCompteEnfant),'">',GTraductions.getValeur('PageCompte.Identifiant')+' :','</div>');H.push('<div class="InlineBlock Gras ">',this.donnees.compteEleve.identifiant,'</div>');H.push('</div>');H.push('<div class="NoWrap">');H.push('<div class="InlineBlock Gras" style="',GStyle.composeWidth(this.parametres.largeurEspaceCompteEnfant),'">',GTraductions.getValeur('PageCompte.MotDePasse')+' :','</div>');H.push('<div class="WhiteSpaceNormal InlineBlock Gras GrandEspaceDroit">',this.donnees.compteEleve.motDePasseEnClair?this.donnees.compteEleve.motDePasse:this.parametres.maskMDP,'</div>');H.push('<div id="',this.ids.mdpEleve,'" tabindex="0" class="WhiteSpaceNormal InlineBlock Souligne AvecMain OmbreFocus"',' style="',GStyle.composeCouleurTexte(GCouleur.texte),'">',GTraductions.getValeur('PageCompte.Modifier'),'</div>');H.push('</div>');H.push('</div>');return H.join('');}
function _composeTelephone(aGenre){var H=[],lImageTitre='',lIndicatif='',lTel='',lTitleImage,lTitle;switch(aGenre){case ObjetPageCompte.saisieInfos.telFixe:lTel='telephoneFixe';lIndicatif='indicatifFixe';lTitle='';lImageTitre='Image_Dll_TelMaison';lTitleImage=GTraductions.getValeur('infosperso.telephoneFixe');break;case ObjetPageCompte.saisieInfos.telPort:if(!this.donnees.AvecSMS){return'';}
lTel='telephonePortable';lIndicatif='indicatifTel';lImageTitre='Image_DestinatairesSMS_Actif';lTitleImage=GTraductions.getValeur('infosperso.SMS');break;case ObjetPageCompte.saisieInfos.fax:lTel='fax';lIndicatif='indicatifFax';lTitle='';lImageTitre='Image_Dll_TelTravail';lTitleImage=GTraductions.getValeur('infosperso.fax');break;}
if(!GApplication.droits.get(IEEnum.droits.compte.avecSaisieInfosPersoCoordonnees)&&!lIndicatif&&!lTel){return;}
H.push('<div class="NoWrap PetitEspaceBas">');H.push('<div class="InlineBlock AlignementMilieuVertical" style="',GStyle.composeWidth(this.parametres.largeurLibelleInput),'">');H.push('<div class="',lImageTitre,'" title="',lTitleImage,'"></div>');H.push('</div>');H.push('<div class="InlineBlock AlignementMilieuVertical">','<input ie-model="tel (\'',lIndicatif,'\')" class="CelluleTexte Texte10"',' ie-indicatiftel ie-etatsaisie ',' style="',GStyle.composeWidth(this.parametres.largeurIndicatif),GStyle.composeHeight(this.parametres.hauteurInput),GStyle.composeCouleurBordure(GCouleur.bordure),'"',' type="text"',' title="',lTitle,'"',' tabIndex="0"','/>','</div>');H.push('<div class="InlineBlock AlignementMilieuVertical PetitEspaceGauche">','<input ie-model="tel (\'',lTel,'\')" class="CelluleTexte Texte10"',' ie-telephone ie-etatsaisie ',' style="',GStyle.composeWidth(this.parametres.largeurTel),GStyle.composeHeight(this.parametres.hauteurInput),GStyle.composeCouleurBordure(GCouleur.bordure),'"',' type="text"',lTitle?' placeholder="'+lTitle+'"':'',lTitle?' title="'+lTitle+'"':'',' tabIndex="0"','/>','</div>');H.push('</div>');return H.join('');}
function _composeEmail(){var H=[];if(!GApplication.droits.get(IEEnum.droits.compte.avecSaisieInfosPersoCoordonnees)&&!this.donnees.Informations.eMail){return;}
H.push('<div class="NoWrap PetitEspaceBas">');H.push('<div class="InlineBlock AlignementMilieuVertical" style="',GStyle.composeWidth(this.parametres.largeurLibelleInput),'">');H.push('<div class="Image_Destinataire_Email_Actif"></div>');H.push('</div>');if(GApplication.droits.get(IEEnum.droits.compte.avecSaisieInfosPersoCoordonnees)){H.push('<div class="InlineBlock AlignementMilieuVertical">','<input class="EspaceInput Texte10"  style="',GStyle.composeWidth(this.parametres.largeurEmail),GStyle.composeHeight(this.parametres.hauteurInput),GStyle.composeCouleurBordure(GCouleur.bordure),'"',' type="text"',' maxlength="255"',' id="',this.ids.email,'"',' placeholder="',GTraductions.getValeur('infosperso.infoEmail'),'"',' value="',this.donnees.Informations.eMail||'','"',' title="',GTraductions.getValeur('infosperso.infoEmail'),'"',' tabIndex="0"','/>','</div>');} else{if(this.donnees.Informations.eMail){H.push('<label class="InlineBlock AlignementMilieuVertical">',this.donnees.Informations.eMail||'','</label>');}}
H.push('</div>');return H.join('');}
function _composeZoneTelephone(){var H=[];H.push('<div class="EspaceHaut">');H.push(_composeEmail.bind(this)());if(this.parametres.avecTelFixe){H.push(_composeTelephone.bind(this)(ObjetPageCompte.saisieInfos.telFixe));}
H.push(_composeTelephone.bind(this)(ObjetPageCompte.saisieInfos.telPort));if(this.parametres.avecTelFax){H.push(_composeTelephone.bind(this)(ObjetPageCompte.saisieInfos.fax));}
H.push('</div>');return H.join('');}
function _construireInfosPerso(){var H=[],lTab;H.push('<div class="WhiteSpaceNormal InlineBlock">');lTab=[];if(this.donnees.Informations.civilite){lTab.push(this.donnees.Informations.civilite);}
if(this.donnees.Informations.nom){lTab.push(this.donnees.Informations.nom);}
if(this.donnees.Informations.prenoms){lTab.push(this.donnees.Informations.prenoms);}
H.push('<label class="Gras">',lTab.join(' '),'<br/></label>');if(this.parametres.avecInfosEntreprise){if(this.donnees.Informations.entreprise){H.push('<label class="Gras">',this.donnees.Informations.entreprise.GetLibelle()+'<br/>','</label>');}
if(this.donnees.Informations.fonction){H.push(this.donnees.Informations.fonction.GetLibelle());}}
lTab=[];if(this.donnees.Informations.adresse1){lTab.push(this.donnees.Informations.adresse1);}
if(this.donnees.Informations.adresse2){lTab.push(this.donnees.Informations.adresse2);}
if(this.donnees.Informations.adresse3){lTab.push(this.donnees.Informations.adresse3);}
if(this.donnees.Informations.adresse4){lTab.push(this.donnees.Informations.adresse4);}
if(this.donnees.Informations.codePostal||this.donnees.Informations.ville){lTab.push(this.donnees.Informations.codePostal+' '+this.donnees.Informations.ville);}
if(this.donnees.Informations.province){lTab.push(this.donnees.Informations.province);}
if(this.donnees.Informations.pays){lTab.push(this.donnees.Informations.pays);}
H.push('<label>',lTab.join('<br/>'),'<br/></label>');H.push(_composeZoneTelephone.bind(this)());H.push('</div>');return H.join('');}
ObjetPageCompte.prototype._composerCB=function(aID,aLibelle,aCheck,aDisable,aStyleDIV,aClassDIV,aHint){var lHtml=[];var lCheck=aCheck?'checked ':'';var lDisable=aDisable?'disabled ':'';var lClass=aDisable?'AvecInterdiction':'AvecMain';lHtml.push('<div '+(aStyleDIV?aStyleDIV:'')+(aClassDIV?'class="'+aClassDIV+'"':''),(aHint?' title="'+GChaine.toTitle(aHint)+'"':''),'>');lHtml.push('<input type="checkbox" tabIndex="0" ',lCheck,' id="',aID,'"  ' ,lDisable,' class="',lClass,'"',' style="margin-top:2px;margin-right:2px;">','<label id="',aID+'_label','"  for="',aID,'" class="Texte10 ',lClass,'" style="',GStyle.composeCouleurTexte(aDisable?GCouleur.nonEditable.texte:GCouleur.noir),'">',aLibelle,'</label>');lHtml.push('</div>');return lHtml.join('');};function _construireAutorisations(){var H=[];H.push('<div class="WhiteSpaceNormal InlineBlock">');var lAvecSaisie=GApplication.droits.get(IEEnum.droits.compte.avecSaisieInfosPersoAutorisations);H.push('<div class="Gras Texte10 EspaceBas">',lAvecSaisie?GTraductions.getValeur('infosperso.titreDestinataire'):GTraductions.getValeur('infosperso.titreDestinataireConsultation'),'</div>');H.push('<div class="EspaceGauche">');if(this.donnees.AvecSMS&&this.donnees.Autorisations.SMSAutorise!==null){H.push(this._composerCB(this.ids.cbSMS,GTraductions.getValeur('infosperso.SMS'),this.donnees.Autorisations.SMSAutorise,!lAvecSaisie||!this.donnees.Informations.telephonePortable));}
if(this.donnees.Autorisations.emailAutorise!==null){H.push(this._composerCB(this.ids.cbMail,GTraductions.getValeur('infosperso.Email'),this.donnees.Autorisations.emailAutorise,!lAvecSaisie||!this.donnees.Informations.eMail));if(this.donnees.Autorisations.eMailEtablissementAutorise!==null&&this.donnees.Autorisations.eMailParentAutorise!==null){H.push('<div class="GrandEspaceGauche">');H.push(this._composerCB(this.ids.cbMailEtab,GTraductions.getValeur('infosperso.EmailEtablissement'),this.donnees.Autorisations.eMailEtablissementAutorise,!lAvecSaisie||!this.donnees.Autorisations.emailAutorise),this._composerCB(this.ids.cbParent,GTraductions.getValeur('infosperso.EMailParents'),this.donnees.Autorisations.eMailParentAutorise,!lAvecSaisie||!this.donnees.Autorisations.emailAutorise));H.push('</div>');}}
if(this.donnees.Autorisations.courrierPapierAutorise!==null){H.push(this._composerCB(this.ids.cbCourrier,GTraductions.getValeur('infosperso.Papier'),this.donnees.Autorisations.courrierPapierAutorise,!lAvecSaisie));}
H.push('</div>');if(this.donnees.Autorisations.msgParent!==null&&this.donnees.Autorisations.msgEleve!==null){H.push('<div class="Gras Texte10 EspaceBas GrandEspaceHaut">',GTraductions.getValeur('infosperso.MessageriePRONOTE'),'</div>');H.push('<div class="EspaceGauche">');H.push('<div class="NoWrap PetitEspaceBas">');H.push('<div class="InlineBlock AlignementMilieuVertical WhiteSpaceNormal">',GTraductions.getValeur('infosperso.AccepteDiscussionAvec'),'</div>');H.push('</div>');H.push('<div class="GrandEspaceGauche">');H.push(this._composerCB(this.ids.cbMsgParent,GTraductions.getValeur('infosperso.DiscussionsParents'),this.donnees.Autorisations.msgParent,!lAvecSaisie));H.push(this._composerCB(this.ids.cbMsgEleve,GTraductions.getValeur('infosperso.DiscussionsEleves'),this.donnees.Autorisations.msgEleve,!lAvecSaisie));H.push(this._composerCB(this.ids.cbMsgProfsPerso,GTraductions.getValeur('infosperso.DiscussionsProfsPersos'),true,true,null,null,GTraductions.getValeur('infosperso.HintDiscussionsProfsPersos')));H.push('</div>');if(this.donnees.Autorisations.estContactVS!==null)
H.push(this._composerCB(this.ids.cbMsgContactVS,GTraductions.getValeur('infosperso.EstContactVS'),this.donnees.Autorisations.estContactVS,!lAvecSaisie));H.push('</div>');H.push('</div>');}
if(this.construireAutorisationsSupp){H.push(this.construireAutorisationsSupp());}
H.push('</div>');return H.join('');}
function _construireZone(aTitre,aContenu,aAvecSeparateurHaut){var H=[];if(aAvecSeparateurHaut){H.push('<div class="GrandEspaceHaut" style="',GStyle.composeCouleurBordure(GCouleur.texte,1,EGenreBordure.bas),'"></div>');}
H.push('<div class="NoWrap' ,(aAvecSeparateurHaut?' GrandEspaceHaut':''),'">');if(!!aTitre)
H.push('<div class="WhiteSpaceNormal InlineBlock Gras AlignementHaut"',' style="',GStyle.composeWidth(this.parametres.largeurGauche),GStyle.composeCouleurTexte(GCouleur.texte),'">','<span class="GrandEspaceDroit">',aTitre,'</span>','</div>');H.push(aContenu);H.push('</div>');return H.join('');}
function _construirePage(){var H=[],lAvecSeparateur=false;H.push('<div class="Texte10 Table">');H.push('<div style="padding:20px;">');if(this.donnees.compteEleve){H.push(_construireZone.bind(this)(null,_construireMotDePasseEleve.bind(this)(),lAvecSeparateur));}
else{if(GEtatUtilisateur.derniereConnexion){H.push(_construireZone.bind(this)(GTraductions.getValeur('PageCompte.DerniereConnexion'),_construireDerniereConnexion.bind(this)(),lAvecSeparateur));lAvecSeparateur=true;}
if(GApplication.droits.get(IEEnum.droits.compte.avecSaisieIdentifiant)){H.push(_construireZone.bind(this)(GTraductions.getValeur('PageCompte.Identifiant'),_construireIdentifiant.bind(this)(),lAvecSeparateur));lAvecSeparateur=true;}
if(GApplication.droits.get(IEEnum.droits.compte.avecSaisieMotDePasse)){H.push(_construireZone.bind(this)(GTraductions.getValeur('PageCompte.MotDePasse'),_construireMotDePasse.bind(this)(),lAvecSeparateur));lAvecSeparateur=true;}
if(GApplication.droits.get(IEEnum.droits.compte.avecInformationsPersonnelles)){H.push(_construireZone.bind(this)(GTraductions.getValeur('PageCompte.Coordonnees'),_construireInfosPerso.bind(this)(),lAvecSeparateur));lAvecSeparateur=true;H.push(_construireZone.bind(this)(GTraductions.getValeur('PageCompte.Autorisations'),_construireAutorisations.bind(this)(),lAvecSeparateur));lAvecSeparateur=true;}}
H.push('</div>');H.push('</div>');return H.join('');}
function _setDisableCB(aId,aDisable){var lCB=$('#'+aId.escapeJQ())[0],lLabel=$('#'+(aId+'_label').escapeJQ())[0];if(aDisable){$(lCB).addClass('AvecInterdiction').removeClass('AvecMain');$(lLabel).addClass('AvecInterdiction').removeClass('AvecMain');}
else{$(lCB).addClass('AvecMain').removeClass('AvecInterdiction');$(lLabel).addClass('AvecMain').removeClass('AvecInterdiction');}
if(aDisable&&$(lCB).inputChecked()){$(lCB).inputChecked(false);this._surChangeCBAutorisation(aId,false);}
GStyle.setCouleurTexte(lLabel,aDisable?GCouleur.nonEditable.texte:GCouleur.noir);$(lCB).inputDisabled(!!aDisable);}
function _surChangeCB(event){var lInstance=event.data.instance;lInstance.SetEtatSaisie(true);lInstance._surChangeCBAutorisation(this.id,$(this).inputChecked());}
ObjetPageCompte.prototype._surChangeCBAutorisation=function(aId,aChecked){if(aId===this.ids.cbMail){_setDisableCB.bind(this)(this.ids.cbMailEtab,!aChecked);_setDisableCB.bind(this)(this.ids.cbParent,!aChecked);}};ObjetPageCompte.prototype.setDonnees_PageCompte=function(aParametres){$.extend(true,this.donnees,aParametres.donnees);if(this.donnees.Autorisations&&this.donnees.Autorisations.listeEleves){this.donnees.Autorisations.listeEleves.trier();}
GHtml.setHtml(this.Nom,_construirePage.bind(this)(),{controleur:this.controleur});if(this.donnees.compteEleve){$('#'+this.ids.mdpEleve.escapeJQ()).on({mouseup:function(){aParametres.donnees.compteEleve.callbackMDPEleve();},keyup:function(){if(GNavigateur.IsToucheSelection()){aParametres.donnees.compteEleve.callbackMDPEleve();}},mouseenter:function(){$(this).toggleClass('Gras');},mouseleave:function(){$(this).toggleClass('Gras');}});}
else{$('#'+this.ids.identifiant.escapeJQ()).on({mouseup:function(){aParametres.callbackIdentifiant();},keyup:function(){if(GNavigateur.IsToucheSelection()){aParametres.callbackIdentifiant();}}});$('#'+this.ids.mdp.escapeJQ()).on({mouseup:function(){aParametres.callbackMDP();},keyup:function(){if(GNavigateur.IsToucheSelection()){aParametres.callbackMDP();}}});$('#'+this.ids.email.escapeJQ()).on('change keyup',{instance:this},function(event){var lInstance=event.data.instance;lInstance.SetEtatSaisie(true);var lChampVide=GHtml.getValue(this).trim()==='';_setDisableCB.bind(lInstance)(lInstance.ids.cbMail,lChampVide);var lCBMailChecked=$('#'+lInstance.ids.cbMail.escapeJQ()).inputChecked();_setDisableCB.bind(lInstance)(lInstance.ids.cbMailEtab,lChampVide||!lCBMailChecked);_setDisableCB.bind(lInstance)(lInstance.ids.cbParent,lChampVide||!lCBMailChecked);});$('#'+this.Nom.escapeJQ()+' :checkbox').jIECheckBox().on('change',{instance:this},_surChangeCB);}};ObjetPageCompte.prototype.getStructurePourValidation=function(aStructure){var lValeur;if(GApplication.droits.get(IEEnum.droits.compte.avecSaisieInfosPersoCoordonnees)){aStructure.informations={};if(this.donnees.Informations.eMail!==null){lValeur=GChaine.supprimerEspaces(GHtml.getValue(this.ids.email));aStructure.informations.eMail=lValeur;}
aStructure.informations.telephoneFixe=this.donnees.Informations.telephoneFixe ;aStructure.informations.indicatifFixe=this.donnees.Informations.indicatifFixe ;aStructure.informations.telephonePortable=this.donnees.Informations.telephonePortable ;aStructure.informations.indicatifTel=this.donnees.Informations.indicatifTel ;aStructure.informations.fax=this.donnees.Informations.fax ;aStructure.informations.indicatifFax=this.donnees.Informations.indicatifFax ;}
if(GApplication.droits.get(IEEnum.droits.compte.avecSaisieInfosPersoAutorisations)){aStructure.autorisations={};if(this.donnees.Autorisations.SMSAutorise!==null){aStructure.autorisations.SMSAutorise=$('#'+this.ids.cbSMS.escapeJQ()).inputChecked();}
if(this.donnees.Autorisations.emailAutorise!==null){aStructure.autorisations.emailAutorise=$('#'+this.ids.cbMail.escapeJQ()).inputChecked();}
if(this.donnees.Autorisations.eMailEtablissementAutorise!==null){aStructure.autorisations.eMailEtablissementAutorise=$('#'+this.ids.cbMailEtab.escapeJQ()).inputChecked();}
if(this.donnees.Autorisations.eMailParentAutorise!==null){aStructure.autorisations.eMailParentAutorise=$('#'+this.ids.cbParent.escapeJQ()).inputChecked();}
if(this.donnees.Autorisations.courrierPapierAutorise!==null){aStructure.autorisations.courrierPapierAutorise=$('#'+this.ids.cbCourrier.escapeJQ()).inputChecked();}
if(this.donnees.Autorisations.msgParent!==null){aStructure.autorisations.msgParent=$('#'+this.ids.cbMsgParent.escapeJQ()).inputChecked();}
if(this.donnees.Autorisations.msgEleve!==null){aStructure.autorisations.msgEleve=$('#'+this.ids.cbMsgEleve.escapeJQ()).inputChecked();}
if(this.donnees.Autorisations.estContactVS!==null){aStructure.autorisations.estContactVS=$('#'+this.ids.cbMsgContactVS.escapeJQ()).inputChecked();}}
return true;};}());;
function ObjetRequetePageInfosPerso(aPere,aEvenementSurReussite,aEvenementSurEchec){this.inheritedCreate(aPere,aEvenementSurReussite,aEvenementSurEchec);}
IE.Requetes.inscrire('PageInfosPerso',ObjetRequetePageInfosPerso,_ObjetRequeteXmlConsultationPN);ObjetRequetePageInfosPerso.prototype.lancerRequete=function(){this.appelAsynchroneConsultation();};ObjetRequetePageInfosPerso.prototype.actionApresRequete=function(){this.callbackReussite.appel(this.JSONReponse);};;
function ObjetInterfaceCompte(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);}
MethodesObjet.heritagePrototype(ObjetInterfaceCompte,ObjetInterfacePage);(function(){ObjetInterfaceCompte.prototype.ConstruireInstances=function(){this.identCompte=this.Add(GEtatUtilisateur.GenreEspace===EGenreEspace.Parent?window.ObjetPageCompte_Parent:window.ObjetPageCompte);var lThis=this;if(GApplication.droits.get(IEEnum.droits.compte.avecSaisieIdentifiant)){this.identFenetre_ModificationIdentifiant=this.addFenetre(window.ObjetFenetre_ModificationIdentifiantMDP,function(aReussiteModificationIdentification){if(aReussiteModificationIdentification){lThis.RecupererDonnees();}},function(aInstance){aInstance.changementMDP=false;});}
if(GApplication.droits.get(IEEnum.droits.compte.avecSaisieMotDePasse)){this.identFenetre_ModificationMDP=this.addFenetre(window.ObjetFenetre_ModificationIdentifiantMDP);}};ObjetInterfaceCompte.prototype.SetParametresGeneraux=function(){this.avecBandeau=true;};function _callbackIdentifiant(){this.GetInstance(this.identFenetre_ModificationIdentifiant).Afficher();}
function _callbackMDP(){this.GetInstance(this.identFenetre_ModificationMDP).Afficher();}
function _surReponseRequetePageInfosPerso(aDonnees){this.GetInstance(this.identCompte).setDonnees_PageCompte({donnees:aDonnees,callbackIdentifiant:_callbackIdentifiant.bind(this),callbackMDP:_callbackMDP.bind(this)});}
ObjetInterfaceCompte.prototype.RecupererDonnees=function(){new ObjetRequetePageInfosPerso(this,_surReponseRequetePageInfosPerso.bind(this)).lancerRequete();};ObjetInterfaceCompte.prototype.Valider=function(){var lStructure={};if(this.GetInstance(this.identCompte).getStructurePourValidation(lStructure)){this.SetEtatSaisie(false);new window.ObjetRequeteSaisieInformations(this,this.RecupererDonnees).lancerRequete(lStructure);}};}());;
MethodesObjet.heritagePrototype(_PageFicheBrevet,_PageAppreciations);function _PageFicheBrevet(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);}
_PageFicheBrevet.prototype.initialiserFicheBrevet=function(aInstance){aInstance.setTraductions(GTraductions.getValeur('FicheBrevet'));};_PageFicheBrevet.prototype.ActionSurRecupererDonnees=function(aMessage,aTitre,aSaisie,aListeDisciplines,aInfos,aPalier,aTotalPoints,aBaseTotalPoints){if(aMessage)
this.EvenementAfficherMessage(aMessage);else{this.afficherBandeau(true);this.Titre=aTitre;if(this.GetInstance(this.identBandeau))
this.GetInstance(this.identBandeau).SetLibelle(this.Titre);aPalier.estValide=true;aPalier.estNonValide=false;if(!aPalier.dateAttestationSocle)
for(var I=0;I<aPalier.listePiliers.GetNbrElements();I++){var lPilier=aPalier.listePiliers.GetElement(I);if(lPilier.genreEvaluation!==EGenreNiveauDAcquisition.Acquis){aPalier.estValide=false;if(lPilier.genreEvaluation===EGenreNiveauDAcquisition.NonAcquis)
aPalier.estNonValide=true;}}
this.GetInstance(this.IdentPage).SetDonnees(aSaisie,aListeDisciplines,aTotalPoints,aBaseTotalPoints,aInfos,aPalier);this.GetInstance(this.IdentPage).actualiser();this.surResizeInterface();window.Invocateur.evenement(window.Invocateur.events.activationImpression,GEtatUtilisateur.GenreEspace===EGenreEspace.Parent?EGenreImpression.Format:EGenreImpression.Aucune,this);if(GEtatUtilisateur.estModeAccessible()&&this.GetInstance(this.IdentPage)) this.GetInstance(this.IdentPage).setFocus();}};_PageFicheBrevet.prototype.GetPageImpression=function(aFormat){return{titre2:this.Titre,contenu:this.GetInstance(this.IdentPage).ComposeImpression(aFormat)};};;
MethodesObjet.heritagePrototype(ObjetFicheBrevet,_ObjetBulletinEtReleve);function ObjetFicheBrevet(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this._options={labelWAI:''};}
ObjetFicheBrevet.prototype.SetDonnees=function(aSaisie,aListeElements,aTotalPoints,aBaseTotalPoints,aInfos,aPalier){this.Saisie=aSaisie;this.Liste=aListeElements;this.TotalPoints=aTotalPoints;this.BaseTotalPoints=aBaseTotalPoints;this.Infos=aInfos;this.palier=aPalier;this.donneesRecues=true;this.ConstruireAffichage();};ObjetFicheBrevet.prototype.ComposePage=function(aPourImpression,aNumeroImpression){this.taillePolice=10;this.messages=[];var lPourImpression=(aPourImpression?aPourImpression:false);this.actualiserDimensions(lPourImpression,aNumeroImpression);var lCouleurBordure=GCouleur.liste.titre.getBordure(aPourImpression);var LStyleTable=aPourImpression?'style="width:'+(this.TailleTexte*10)+'%" ':'style="width:100%;"';var H=[];H.push('<table ',GObjetWAI.composeRole(EGenreRole.Grid),' id="'+this.idPage+'" class="'+this.taillePolice+'"'+LStyleTable+' border="0" cellspacing="0" cellpadding="0">');H.push('<tr>');H.push('<td style="'+GStyle.composeCouleurBordure(lCouleurBordure,1,EGenreBordure.haut+EGenreBordure.droite)+'">'+this.ComposeLigneTitre(aPourImpression)+'</td>');H.push('</tr>');H.push('<tr>');if(aPourImpression)
H.push('<td>'+this.ComposeListe(false,null,aPourImpression)+'</td>');else{H.push('<td><div tabIndex="-1" id="'+this.ScrollV.GetIdZone(0)+'" style="width:auto; height:1px; overflow:hidden;">'+this.ComposeListe(false,null,aPourImpression)+'</div></td>');H.push('<td id="'+this.ScrollV.GetIdScroll()+'" style="width:'+this.ScrollV.GetLargeur()+'px"></td>');}
H.push('</tr>');H.push('<tr><td style="'+GStyle.composeCouleurBordure(lCouleurBordure,1,EGenreBordure.droite)+'">'+this.ComposeTotal(aPourImpression)+'</td></tr>');H.push('<tr><td>'+this.ComposeListe(true,GTraductions.getValeur('FicheBrevet.Indicatif'),aPourImpression)+'</td></tr>');H.push('<tr><td class="EspaceHaut">');H.push(this.composePalier(this.palier,aPourImpression));H.push('</td></tr>');H.push('<tr><td class="EspaceHaut">');H.push(this.composePiedDePage(aPourImpression));H.push('</td></tr>');H.push('</table>');return H.join('');};ObjetFicheBrevet.prototype.ComposeLigneTitre=function(aPourImpression){var H=[];var lDefaut={taille:this.LargeurNote,bordGauche:true,bordBas:true,pourImpression:aPourImpression};H.push('<table class="Tableau Gras" style="width:100%; height:'+this.HauteurTitre+'px;" border="0" cellspacing="0" cellpadding="0">');H.push('<tr>');H.push(this.composeTitre($.extend({},lDefaut,{libelle:GTraductions.getValeur('FicheBrevet.Titre_Disciplines') ,taille:this.LargeurDiscipline})));H.push(this.composeTitre($.extend({},lDefaut,{libelle:GTraductions.getValeur('FicheBrevet.Titre_MoyClasse')})));H.push(this.composeTitre($.extend({},lDefaut,{libelle:GTraductions.getValeur('FicheBrevet.Titre_MoyEleve')})));H.push(this.composeTitre($.extend({},lDefaut,{libelle:GTraductions.getValeur('FicheBrevet.Titre_Appreciations') ,taille:this.LargeurAppreciation})));H.push(this.composeTitre($.extend({},lDefaut,{libelle:GTraductions.getValeur('FicheBrevet.Titre_Note') ,taille:this.LargeurNoteGlobale})));H.push('</tr>');H.push('</table>');return H.join('');};ObjetFicheBrevet.prototype.ComposeTitreZone=function(ATitre,aMessage,aAvecBordure,APourImpression){return'<div class="'+this.taillePolice+' Gras Espace" style="'+(aAvecBordure?GStyle.composeCouleurBordure(GCouleur.liste.titre.getBordure(APourImpression),1,EGenreBordure.bas):'')+'">'+ATitre+' : '+(aMessage?'<span style="color: '+GCouleur.noir+';">'+aMessage+'</span>':'')+'</div>';};ObjetFicheBrevet.prototype.ComposeListe=function(ANonCalculee,ATitre,APourImpression){var lStyle='style="width: 100%; '+GStyle.composeCouleurBordure(GCouleur.liste.titre.getBordure(APourImpression),1,EGenreBordure.droite)+'"';var H=[];if(ATitre)
H.push(this.ComposeTitreZone(ATitre,null,true,APourImpression));H.push('<table id="'+this.ScrollV.GetIdContenu(0)+'" class="FondBlanc" '+lStyle+'border="0" cellspacing="0" cellpadding="0">');for(var I=0;I<this.Liste.GetNbrElements();I++){var LDiscipline=this.Liste.GetElement(I);if(LDiscipline.NonCalculee===ANonCalculee)
H.push(this.ComposeLigne(LDiscipline,APourImpression,I));}
H.push('</table>');return H.join('');};ObjetFicheBrevet.prototype.composeMessageAPSA=function(){return'<td style="'+GTableau.styleMoyenne(false,true,EGenreBordure.gauche+EGenreBordure.bas,true)+'">'+'<div class="Image_Attention AvecMain" style="margin: 0 auto;" onclick="'+this.Nom+'.afficherMessageAPSA ()">&nbsp;</div>'+'</td>';};ObjetFicheBrevet.prototype.afficherMessageAPSA=function(){GApplication.getMessage().Afficher(EGenreBoiteMessage.Information,GTraductions.getValeur('FicheBrevet.Brevet2013.Titre'),GTraductions.getValeur('FicheBrevet.Brevet2013.Message'));};ObjetFicheBrevet.prototype.ComposeLigne=function(aDiscipline,aPourImpression,aLigne){var lEstPublie=aDiscipline.message===false;var LNoteGlobale=lEstPublie?aDiscipline.NoteGlobale?aDiscipline.NoteGlobale:'':GTraductions.getValeur('FicheBrevet.NonCommunique');if(aDiscipline.Bonus)
LNoteGlobale+='<br>'+'(+'+aDiscipline.Bonus+')';else if(aDiscipline.BaseNoteGlobale)
LNoteGlobale+='<br>'+'/ '+this.TruncNote(aDiscipline.BaseNoteGlobale.getNote());var lLibelle=aDiscipline.GetLibelle()+(!lEstPublie?'<span style="'+GStyle.composeCouleurTexte(GCouleur.noir)+'" title="'+aDiscipline.message+'"> *</span>':'');if(!lEstPublie)
this.messages.push('* '+aDiscipline.message);var H=[];var lDefault={largeur:this.LargeurNote,pourImpression:aPourImpression};H.push('<tr>');H.push(this.ComposeDiscipline(lLibelle ,!aDiscipline.NonCalculee,aPourImpression));if(aDiscipline.afficherMessageAPSA)
H.push(this.composeMessageAPSA());else H.push(this.composeNote($.extend({},lDefault,{estMoyenneGenerale:true,note:lEstPublie?aDiscipline.MoyenneClasse:GTraductions.getValeur('BulletinEtReleve.NC')})));if(aDiscipline.afficherMessageAPSA)
H.push(this.composeMessageAPSA());else H.push(this.composeNote($.extend({},lDefault,{estMoyenneGenerale:true,note:lEstPublie?aDiscipline.MoyenneEleve:GTraductions.getValeur('BulletinEtReleve.NC')})));if(!aDiscipline.afficherMessageAPSA){this._options.labelWAI=GTraductions.getValeur('FicheBrevet.Titre_Disciplines')+' '+aDiscipline.GetLibelle()+' ';this._options.labelWAI+=GTraductions.getValeur('FicheBrevet.Titre_MoyClasse')+' '+(lEstPublie?aDiscipline.MoyenneClasse:'N.C.')+' ';this._options.labelWAI+=GTraductions.getValeur('FicheBrevet.Titre_MoyEleve')+' '+(lEstPublie?aDiscipline.MoyenneEleve:'N.C.')+' ';this._options.labelWAI+=GTraductions.getValeur('FicheBrevet.Titre_Note')+' '+(lEstPublie?aDiscipline.NoteGlobale?aDiscipline.NoteGlobale:'':'N.C.');}
H.push(this.composeAppreciation({pourImpression:aPourImpression,saisie:this.Saisie,libelle:GChaine.toTexte(aDiscipline.ListeAppreciations.GetLibelle(0)),largeur:this.LargeurAppreciation,ligne:aLigne+1,col:0+1}));if(aDiscipline.afficherMessageAPSA)
H.push(this.composeMessageAPSA());else H.push(this.composeNote($.extend({},lDefault,{estMoyenneGenerale:true,note:LNoteGlobale,largeur:this.LargeurNoteGlobale})));H.push('</tr>');return H.join('');};ObjetFicheBrevet.prototype.ComposeTotal=function(aPourImpression){var LTotalPoints=this.TruncNote(this.TotalPoints.getNote())+' / '+this.TruncNote(this.BaseTotalPoints.getNote());var lDefault={pourImpression:aPourImpression};var H=[];H.push('<table class="'+this.taillePolice+' Gras" style="width: 100%;" border="0" cellspacing="0" cellpadding="0">');H.push('<tr>');H.push('<td class="AlignementGauche">',this.messages.join('<br>'),'</td>');H.push('<td class="Espace AlignementDroit">'+GTraductions.getValeur('FicheBrevet.Total')+' :</td>');H.push(this.composeNote($.extend({},lDefault,{estMoyenneGenerale:true,note:LTotalPoints,largeur:this.LargeurNoteGlobale})));H.push('</tr>');H.push('</table>');return H.join('');};ObjetFicheBrevet.prototype.composePalier=function(aPalier,APourImpression){var H=[];if(aPalier.GetNumero()){H.push('<table class="'+this.taillePolice+'" border="0" cellspacing="0" cellpadding="3">');H.push(this.ComposeTitreZone(aPalier.GetLibelle(),!aPalier.estValide?!aPalier.estNonValide?'':GTraductions.getValeur('SocleNonValide'):GTraductions.getValeur('SocleValide')+(aPalier.dateAttestationSocle?GDate.FormatDate(aPalier.dateAttestationSocle,' '+GTraductions.getValeur('Le')+' %JJ %MMM'):''),false,APourImpression));for(var I=0;I<aPalier.listePiliers.GetNbrElements();I++){var lPilier=aPalier.listePiliers.GetElement(I);var lBordure=EGenreBordure.gauche+EGenreBordure.bas+(I===0?EGenreBordure.haut:0);H.push('<tr>');H.push('<td style="',GTableau.styleTitre(APourImpression,true,lBordure),'">',lPilier.GetLibelle(),'</td>');H.push('<td class="Gras AlignementMilieu" style="width: 80px; ',GTableau.styleCellule(APourImpression,true,lBordure+EGenreBordure.droite),'">',this.getNiveauDAcquisition(lPilier),'</td>');H.push('</tr>');}
H.push('</table>');}
return H.join('');};ObjetFicheBrevet.prototype.getNiveauDAcquisition=function(aPilier){switch(aPilier.niveauDAcquisition.GetGenre()){case EGenreNiveauDAcquisition.Expert:return GTraductions.getValeur('Validee');case EGenreNiveauDAcquisition.Acquis:return GTraductions.getValeur('Validee');case EGenreNiveauDAcquisition.NonAcquis:return GTraductions.getValeur('NonValidee');}
return'&nbsp;';};ObjetFicheBrevet.prototype.composePiedDePage=function(aPourImpression){var H=[];H.push('<table class="'+this.taillePolice+'" border="0" cellspacing="5" cellpadding="0">');if(this.Infos.EvaluationA2Regionale){H.push('<tr>');H.push('<td class="Gras EspaceBas">'+GTraductions.getValeur('FicheBrevet.LangueRegionale')+'&nbsp;:</td>');H.push('<td class="Gras EspaceBas">',this.Infos.EvaluationA2Regionale,'</td>');H.push('</tr>');}
if(this.Infos.Avis||this.Infos.Appreciation.GetLibelle()){H.push('<tr>');H.push('<td class="Gras AlignementHaut">'+GTraductions.getValeur('FicheBrevet.Avis')+'&nbsp;:</td>');H.push('<td>');if(this.Infos.Avis)
H.push('<span class="Gras">',this.Infos.Avis,'</span>','<br>');if(this.Infos.Appreciation.GetLibelle())
H.push(this.Infos.Appreciation.GetLibelle());H.push('</td>');H.push('</tr>');}
H.push('</table>');return H.join('');};ObjetFicheBrevet.prototype.ComposeDiscipline=function(ALibelle,AAvecId,APourImpression){var LId=AAvecId?'id="'+this.GetIdLigne(this.NombreLignes++)+'" ':'';return'<td '+GObjetWAI.composeRole(EGenreRole.Rowheader)+' '+LId+this.ComposeClassEtStyleDiscipline(APourImpression)+' width="'+(this.LargeurDiscipline-6)+'px" height='+this.HauteurDiscipline+'px">'+ALibelle+'</td>';};ObjetFicheBrevet.prototype.ComposeClassEtStyleDiscipline=function(APourImpression){return'class="'+this.taillePolice+' Gras PetitEspace AlignementHaut" style="'+GTableau.styleColonneFixe(APourImpression,true,EGenreBordure.gauche+EGenreBordure.bas)+'" ';};ObjetFicheBrevet.prototype.actualiserDimensions=function(aPourImpression,aNumeroImpression){if(aPourImpression){this.SetDimensions(aNumeroImpression);}
else{this.SetDimensions(1);}
this.taillePolice='Texte'+this.TailleTexte;};ObjetFicheBrevet.prototype.SetDimensions=function(AFormat){var LProportion=[1.1,1.0,0.9,0.8][AFormat];this.TailleTexte=10*LProportion;this.LargeurDiscipline=250*LProportion;this.LargeurNote=45*LProportion;this.LargeurNoteGlobale=90*LProportion;this.LargeurAppreciation=null;this.HauteurTitre=30*LProportion;this.HauteurDiscipline=32*LProportion;};ObjetFicheBrevet.prototype.TruncNote=function(ANote){return ANote&&ANote.split(',')[1]==='00'?ANote.split(',')[0]:ANote;};;

ObjetFicheBrevet.prototype._construireListeDisciplines=function(aNoeud){var lNoeudMatieres=this._objetListeArborescente.ajouterUnNoeudAuNoeud(aNoeud,'',GTraductions.getValeur('FicheBrevet.Titre_Disciplines'),null,true,true);var maxBoucle=this.Liste.GetNbrElements();for(var I=0;I<maxBoucle ;I++){var lDiscipline=this.Liste.GetElement(I);var lLibelle=lDiscipline.GetLibelle();var lLibelleMatiere=lDiscipline.listeMatieres?lDiscipline.listeMatieres.getTableauLibelles().join(', '):'';if(lLibelleMatiere) lLibelle+=' - '+lLibelleMatiere;if(lDiscipline.NonCalculee) lLibelle+=' ('+GTraductions.getValeur('FicheBrevet.Indicatif')+') ';var lNoeudMatiere=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lNoeudMatieres,'',lLibelle);var lNoteGlobale=lDiscipline.NoteGlobale?lDiscipline.NoteGlobale:'';if(lDiscipline.Bonus)
lNoteGlobale+=' (+'+lDiscipline.Bonus+')';else if(lDiscipline.BaseNoteGlobale)
lNoteGlobale+=' / '+this.TruncNote(lDiscipline.BaseNoteGlobale.getNote());this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudMatiere,'' ,GTraductions.getValeur('FicheBrevet.Titre_MoyClasse')+' : '+lDiscipline.MoyenneClasse);this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudMatiere,'' ,GTraductions.getValeur('FicheBrevet.Titre_MoyEleve')+' : '+lDiscipline.MoyenneEleve);this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudMatiere,'' ,GTraductions.getValeur('FicheBrevet.Titre_Appreciations')+' : '+lDiscipline.ListeAppreciations.GetLibelle(0));this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudMatiere,'' ,GTraductions.getValeur('FicheBrevet.Titre_Note')+' : '+lNoteGlobale);}};ObjetFicheBrevet.prototype._construireListeTotalPoints=function(aNoeud){var lTotalPoints=this.TruncNote(this.TotalPoints.getNote())+' / '+this.TruncNote(this.BaseTotalPoints.getNote());this._objetListeArborescente.ajouterUneFeuilleAuNoeud(aNoeud,'' ,GTraductions.getValeur('FicheBrevet.Total')+' : '+lTotalPoints);};ObjetFicheBrevet.prototype._construireListePalierCollege=function(aNoeud){if(this.palier.GetNumero()){var lTitre=this.palier.GetLibelle();var lMsg=!this.palier.estValide?(!this.palier.estNonValide?'':GTraductions.getValeur('SocleNonValide')):GTraductions.getValeur('SocleValide')+(this.palier.dateAttestationSocle?GDate.FormatDate(this.palier.dateAttestationSocle,' '+GTraductions.getValeur('Le')+' %JJ %MMM'):'');var lNoeudPalier=this._objetListeArborescente.ajouterUnNoeudAuNoeud(aNoeud,'',lTitre+(lMsg?' : '+lMsg:''),null,true,true);var maxBoucle=this.palier.listePiliers.GetNbrElements();for(var I=0;I<maxBoucle;I++){var lPilier=this.palier.listePiliers.GetElement(I);this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudPalier,'' ,lPilier.GetLibelle()+' : '+this.getNiveauDAcquisition(lPilier));}}};ObjetFicheBrevet.prototype._construireListeEvaluationRegionale=function(aNoeud){if(this.Infos.EvaluationA2Regionale)
this._objetListeArborescente.ajouterUneFeuilleAuNoeud(aNoeud,'' ,GTraductions.getValeur('FicheBrevet.LangueRegionale')+' : '+this.Infos.EvaluationA2Regionale);};ObjetFicheBrevet.prototype._construireListeAvis=function(aNoeud){if(this.Infos.Avis||this.Infos.Appreciation.GetLibelle()){var lAvis=[];if(this.Infos.Avis) lAvis.push(this.Infos.Avis);var lAppreciation=this.Infos.Appreciation.GetLibelle();if(lAppreciation) lAvis.push(lAppreciation);this._objetListeArborescente.ajouterUneFeuilleAuNoeud(aNoeud,'' ,GTraductions.getValeur('FicheBrevet.Avis')+' : '+lAvis.join(' / '));}};ObjetFicheBrevet.prototype.AfficherListe=function(){this._objetListeArborescente=new ObjetListeArborescente(this.Nom+'_Liste',0,this,null);var lRacine=this._objetListeArborescente.construireRacine();this._objetListeArborescente.setParametres(false);this._construireListeDisciplines(lRacine);this._construireListeTotalPoints(lRacine);this._construireListePalierCollege(lRacine);this._construireListeEvaluationRegionale(lRacine);this._construireListeAvis(lRacine);return lRacine;};;
function ObjetRequetePageFicheBrevet(aPere,aEvenementSurReussite,aEvenementSurEchec){this.inheritedCreate(aPere,aEvenementSurReussite,aEvenementSurEchec);}
IE.Requetes.inscrire('PageFicheBrevet',ObjetRequetePageFicheBrevet,_ObjetRequeteXmlConsultationPN);ObjetRequetePageFicheBrevet.prototype.lancerRequete=function(aNumeroEleve){var P=this.XML;P.CreerCategorie(null,'Eleve',null,aNumeroEleve);this.appelAsynchroneConsultation();};ObjetRequetePageFicheBrevet.prototype.actionApresRequete=function(aXml){var LMessage=aXml.GetVariable(null,'Message');var lTitre=aXml.GetVariable(null,'Titre');var lSaisie=aXml.GetVariable(null,'Editable');var LListeDisciplines=new ObjetListeElements();aXml.Parcourir(aXml.GetCategorie(null,'ListeDisciplines'),'Discipline',this,this._AjouterDiscipline,false,LListeDisciplines);var LInfos={};var LNoeudInfos=aXml.GetCategorie(null,'Infos');LInfos.EvaluationA2Regionale=aXml.GetVariable(LNoeudInfos,'EvaluationA2Regionale');LInfos.Avis=aXml.GetVariable(LNoeudInfos,'Avis');LInfos.Appreciation=aXml.GetElement(LNoeudInfos,'Appreciation');var lNoeudPalier=aXml.GetCategorie(null,'Palier');var lPalier=aXml.GetElement(null,'Palier');lPalier.niveauDAcquisition=aXml.GetElement(lNoeudPalier,'NiveauDAcquisition');lPalier.listePiliers=new ObjetListeElements();aXml.Parcourir(lNoeudPalier,'Pilier',this,this._ajouterPilier,false,lPalier.listePiliers);lPalier.listePiliers.Trier();var lTotalPoints=aXml.GetVariable(null,'TotalPoints');var lBaseTotalPoints=aXml.GetVariable(null,'BaseTotalPoints');this.callbackReussite.appel(LMessage,lTitre,lSaisie,LListeDisciplines,LInfos,lPalier,lTotalPoints,lBaseTotalPoints);};ObjetRequetePageFicheBrevet.prototype._AjouterDiscipline=function(AXml,ANoeud,I,AParametre){var LElement=AXml.GetElement(ANoeud);LElement.message=AXml.GetVariable(ANoeud,'Message');LElement.Editable=AXml.GetVariable(ANoeud,'Editable');LElement.MoyenneEleve=AXml.GetVariable(ANoeud,'MoyenneEleve');LElement.MoyenneClasse=AXml.GetVariable(ANoeud,'MoyenneClasse');LElement.afficherMessageAPSA=AXml.GetVariable(ANoeud,'AfficherMessageAPSA');LElement.NoteGlobale=AXml.GetVariable(ANoeud,'NoteGlobale');LElement.BaseNoteGlobale=AXml.GetVariable(ANoeud,'BaseNoteGlobale');LElement.Bonus=AXml.GetVariable(ANoeud,'Bonus');LElement.ListeAppreciations=AXml.GetListeElements(ANoeud,'Appreciation');LElement.NonCalculee=AXml.GetVariable(ANoeud,'NonCalculee');LElement.Facultatif=AXml.GetVariable(ANoeud,'Facultatif');AParametre.AddElement(LElement);};ObjetRequetePageFicheBrevet.prototype._ajouterPilier=function(AXml,ANoeud,I,AParametre){var LElement=AXml.GetElement(ANoeud);LElement.niveauDAcquisition=AXml.GetElement(ANoeud,'NiveauDAcquisition');AParametre.AddElement(LElement);};;
MethodesObjet.heritagePrototype(PageFicheBrevet,_PageFicheBrevet);function PageFicheBrevet(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);}
PageFicheBrevet.prototype.ConstruireInstances=function(){this.IdentPage=this.Add(window.ObjetFicheBrevet,null,null,GTraductions.getValeur('FicheBrevet'));this.avecBandeau=true;this.identBandeau=this.Add(window.ObjetBandeau ,null,null);};PageFicheBrevet.prototype.SetParametresGeneraux=function(){this.IdentZoneAlClient=this.IdentPage;this.AddSurZone=[this.identBandeau];};PageFicheBrevet.prototype.RecupererDonnees=function(){new ObjetRequetePageFicheBrevet(this,this.ActionSurRecupererDonnees).lancerRequete(GEtatUtilisateur.GetNumeroEleve());};;
function ObjetRequeteGraphique(aPere,aEvenementSurReussite,aEvenementSurEchec){this.inheritedCreate(aPere,aEvenementSurReussite,aEvenementSurEchec);}
IE.Requetes.inscrire('Graphique',ObjetRequeteGraphique,_ObjetRequeteXmlConsultationPN);ObjetRequeteGraphique.prototype.lancerRequete=function(aParametres){var lParametres={eleve:null,periode:null,largeur:0,hauteur:0,accepteBase64:true};$.extend(lParametres,aParametres);$.extend(this.JSON,lParametres);this.appelAsynchroneConsultation();};ObjetRequeteGraphique.prototype.actionApresRequete=function(){this.callbackReussite.appel(this.JSONReponse);};;

MethodesObjet.heritagePrototype(ObjetHistogramme,Identite);function ObjetHistogramme(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.donneesRecues=false;this.ajouterEvenementGlobal(EEvent.SurPreResize ,this.SurPreResize);this.ajouterEvenementGlobal(EEvent.SurPostResize ,this.SurPostResize);}(function(){ObjetHistogramme.prototype.setDonneesImage=function(aEleve,aPeriode){this.donneesRecues=true;this._numeroEleve=aEleve.GetNumero();this._eleve=aEleve;this._periode=aPeriode;_actualiser.bind(this)();};ObjetHistogramme.prototype.vider=function(aMessage){this.donneesRecues=false;this.Afficher(this.composeMessage(aMessage));};function _actualiser(){if(!this.donneesRecues) return;_requeteGraphique.bind(this)();}
function _requeteGraphique(){var lHauteur=GPosition.getHeight(this.Nom);var lLargeur=GPosition.getWidth(this.Nom);lHauteur-=(GEtatUtilisateur.getGenreOnglet()===EGenreOnglet.Graphique_Profil?10:20);lLargeur-=5;if((lHauteur>50)&&(lLargeur>50)){new ObjetRequeteGraphique(this,_reponseRequete.bind(this,lLargeur,lHauteur)).lancerRequete({eleve:this._eleve,periode:this._periode,largeur:lLargeur,hauteur:lHauteur,accepteBase64:!GNavigateur.IsIE8});}}
function _reponseRequete(aLargeur,aHauteur ,aParam){if(aParam.url||aParam.imageBase64){var T=[];T.push('<div style="overflow:auto; '+GStyle.composeWidth(aLargeur)+GStyle.composeHeight(aHauteur)+'">');T.push('<img class="AvecMenuContextuel"></img>');T.push('</div>');$('#'+this.Nom.escapeJQ()).html(T.join(''));$('#'+this.Nom.escapeJQ()).find('>div>img').bind('load',{nom:this.Nom.escapeJQ()},function(event){$('#'+event.data.nom).find('>div').jScrollPane();});var lElementImage=$('#'+this.Nom.escapeJQ()).find('>div>img') .get(0);if(lElementImage){if(aParam.imageBase64){lElementImage.src='data:image/png;base64,'+aParam.imageBase64;}
else{lElementImage.src=GChaine.GetChainePourUrl(aParam.url,true);}}
lElementImage=null;}
else if(aParam.Message){this.vider(aParam.Message);}
else this.vider(GTraductions.getValeur('NonPublie'));}
ObjetHistogramme.prototype.SurPreResize=function(){if(!this.donneesRecues) return;this.Afficher('&nbsp;');};ObjetHistogramme.prototype.SurPostResize=function(){if(!this.donneesRecues) return;clearTimeout(this.timerResize);this.timerResize=setTimeout(_actualiser.bind(this),300);};})();;
function ObjetAffichageGraphique(ANom,AIdent,APere,AEvenement){this.inheritedCreate(ANom,AIdent,APere,AEvenement);this.listeResultats=new ObjetListeElements();}
IE.MethodesObjet.heritagePrototype(ObjetAffichageGraphique,ObjetInterfacePage);ObjetAffichageGraphique.prototype.ConstruireInstances=function(){this.IdentCombo=this.Add(window.ObjetSaisiePN ,this.EvenementSurCombo ,this.InitialiserCombo);this.IdPremierElement=this.GetInstance(this.IdentCombo).getPremierElement();this.IdentPage=this.Add(window.ObjetHistogramme);};ObjetAffichageGraphique.prototype.SetParametresGeneraux=function(){this.AddSurZone=[this.IdentCombo];this.IdentZoneAlClient=this.IdentPage;};ObjetAffichageGraphique.prototype.InitialiserCombo=function(AInstance){AInstance.setOptions_ObjetSaisie({labelWAIZone:GTraductions.getValeur('WAI.ListeSelectionPeriode'),roleWAIEdit:EGenreRole.Option});GStyle.setVisible(AInstance.GetNom(),GEtatUtilisateur.getGenreOnglet()!==EGenreOnglet.Graphique_Evolution);};ObjetAffichageGraphique.prototype.RecupererDonnees=function(){if(GEtatUtilisateur.getGenreOnglet()!==EGenreOnglet.Graphique_Evolution){this.listePeriodes=GEtatUtilisateur.getOngletListePeriodes();if(!this.listePeriodes||this.listePeriodes.GetNbrElements()===0)
this._afficherNonPublie();else{this.Instances[this.IdentCombo].SetDonnees(this.listePeriodes);this.Instances[this.IdentCombo].setSelectionParElement(GEtatUtilisateur.getOngletPeriodeParDefaut(),0);}}
else{this._actualiser();}};ObjetAffichageGraphique.prototype.EvenementSurCombo=function(aGenreEvenement,aElement){this.periodeSelectionne=aElement;if(aGenreEvenement===EGenreEvenementObjetSaisie.selection){GEtatUtilisateur.Navigation.SetRessource(EGenreRessource.Periode,aElement);this._actualiser();}};ObjetAffichageGraphique.prototype._actualiser=function(){var lGrapheHisto=GEtatUtilisateur.getGenreOnglet()===EGenreOnglet.Graphique_Evolution,lPeriode;if(!lGrapheHisto&&(!this.listePeriodes||this.listePeriodes.GetNbrElements()===0))
this._afficherNonPublie();else{GStyle.setVisible(this.Instances[this.IdentCombo].GetNom(),!lGrapheHisto);if(lGrapheHisto){lPeriode=null;} else{lPeriode=GEtatUtilisateur.Navigation.GetRessource(EGenreRessource.Periode);if(!lPeriode){this._afficherNonPublie();return;}}
GHtml.setHtml(this.Instances[this.IdentPage].GetNom(),'&nbsp;');this.Instances[this.IdentPage].setDonneesImage(GEtatUtilisateur.getMembre(),lPeriode);}};ObjetAffichageGraphique.prototype._afficherNonPublie=function(){GStyle.setVisible(this.Instances[this.IdentCombo].GetNom(),false);this.GetInstance(this.IdentPage).vider(GTraductions.getValeur('NonPublie'));};;
MethodesObjet.heritagePrototype(ObjetAppreciationDeFinDeStage,Identite);function ObjetAppreciationDeFinDeStage(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.id={appreciation:IE.GUID.getId(),suivi:IE.GUID.getId(),sujetDetaille:IE.GUID.getId(),zoneInfos:IE.GUID.getId(),zoneDetail:IE.GUID.getId(),zoneSuivi:IE.GUID.getId(),zoneAppreciation:IE.GUID.getId(),adresse:this.Nom+'_Adresse',maitresDeStage:this.Nom+'_ZoneMdS',horaires:this.Nom+'_ZoneHoraires'};this.stage=new ObjetElement();this.donneesRecues=false;this.hauteur={page:0,sujet:48,appreciation:90,suivi:0,infoEntreprise:93,tabOnglets:19};this.avecEdition=true;this.ajouterEvenementGlobal(EEvent.SurPreResize,this.surPreResize);this.ajouterEvenementGlobal(EEvent.SurPostResize,this.surPostResize);this.genreEvenement={selection:0,menuContextuel:1,tri:2,annexePedagogique:3};this.fichePJ=null;if(window.ObjetFicheDocumentsJoints){this.fichePJ=ObjetFenetre.creerInstance(window.ObjetFicheDocumentsJoints,{pere:this});}}
ObjetAppreciationDeFinDeStage.prototype.DetruireInstances=function(){if(this.fichePJ){IE.ZoneFenetre.enleverFenetre(this.fichePJ.GetNom(),this.fichePJ.getZIndex());}};ObjetAppreciationDeFinDeStage.prototype.SetDonnees=function(aStage,aEvenements,aLieux,aAvecEdition,aAvecPublier){this.stage=aStage;this.evenements=aEvenements;this.lieux=aLieux;this.avecEdition=aAvecEdition;this.avecPublier=aAvecPublier;this.avecPJ=aAvecPublier;this.nbrColonnes=3;if(this.avecPublier) this.nbrColonnes++;if(this.avecPJ) this.nbrColonnes++;this.donneesRecues=true;if(GEtatUtilisateur.estModeAccessible()){this.AfficherListe();}
else{this.tabOnglets=new ObjetTabOnglets(this.Nom+'.tabOnglets',null,this,this.evenementSurTab);this.stage.appreciations.setTri([ObjetTri.init('Genre',GEtatUtilisateur.GenreEspace===EGenreEspace.Entreprise?EGenreTriElement.Decroissant:EGenreTriElement.Croissant)]);this.stage.appreciations.trier();this.tabOnglets.SetParametres(this.stage.appreciations,true,GPosition.getWidth(this.Nom)-10,this.hauteur.tabOnglets);this.elmAppreciationCourant=this.stage.appreciations.GetElement(0);this.surPostResize();}
$('#'+this.id.adresse.escapeJQ()).jScrollPane();$('#'+this.id.maitresDeStage.escapeJQ()).jScrollPane();$('#'+this.id.horaires.escapeJQ()).jScrollPane();};ObjetAppreciationDeFinDeStage.prototype.ConstruireAffichage=function(){if(this.donneesRecues){return this.composePage();} else return'';};ObjetAppreciationDeFinDeStage.prototype.composePage=function(aPourImpression){this.hauteur.page=GPosition.getHeight(this.Nom);this.hauteur.suivi=this.hauteur.page-(this.avecPJ?29:0)-(this.hauteur.sujet+33)-(this.hauteur.appreciation+22+18)-50-12-(GNavigateur.bordureExterneDIV?2:0)-(MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Professeur,EGenreEspace.Parent,EGenreEspace.Eleve])?this.hauteur.infoEntreprise+12:0)-(this.stage.avecEdition?2:-17);var H=[];var lTitre=(this.stage.Libelle&&this.stage.GetLibelle()!=='')?'<div class="Gras">'+this.stage.GetLibelle()+'</div>':'';H.push('<table class="Tableau AlignementHaut" style="width:100%;',aPourImpression?'':'height:100%;','" border="0" cellspacing="0" cellpadding="0">');if(MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Professeur,EGenreEspace.Parent,EGenreEspace.Eleve]))
H.push(this.construireInfos(aPourImpression));H.push('<tr><td id="',this.id.zoneDetail,'">','<div class="PetitEspaceHaut PetitEspaceBas">','<table class="Tableau" style="width:100%;" border="0" cellspacing="0" cellpadding="0">','<tr>','<td class="Gras AlignementHaut PetitEspaceBas" style="width:100%;">',lTitre,'</td>',(!aPourImpression&&MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Entreprise,EGenreEspace.Professeur])?'<td class="AvecMain Souligne AlignementDroit" onclick="'+this.Nom+'.evenementAnnexe();">'+GChaine.Insecable(GTraductions.getValeur('stage.page.annexePedagogique'))+'</td>':''),MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Professeur])?'<br/><br/>':'','</tr>','<tr>');if(!aPourImpression)
H.push('<td ',(MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Entreprise,EGenreEspace.Professeur])?'colspan="2" ':''),' class="PetitEspace" style="width:100%;',GStyle.composeCouleurFond(GCouleur.liste.fond),GStyle.composeCouleurBordure(GCouleur.liste.titre.bordure),'">','<div id="',this.id.sujetDetaille,'" style="height:',(this.hauteur.sujet),'px; width: 100%;"><div>',this.stage.sujetDetaille?GChaine.ToHTML(GChaine.toTexte(this.stage.sujetDetaille)):GChaine.toTexte(GTraductions.getValeur('stage.page.pasDeSujetDetaille')),'</div></div>','</td>');else if(this.stage.sujetDetaille)
H.push('<td colspan="2" class="AlignementHaut" style="width:100%;">','<div style="width: 100%;">',GChaine.ToHTML(GChaine.toTexte(this.stage.sujetDetaille)),'</div>','</td>');else H.push('<td  colspan="2"></td>');H.push('</tr>','</table>','</div>','</td></tr>');if(aPourImpression&&MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Entreprise,EGenreEspace.Professeur])){H.push('<tr><td><table class="Tableau Table AlignementHaut" border="0" cellspacing="0" cellpadding="0">');if(this.stage.objectifs)
H.push('<tr>','<td class="AlignementHaut Gras NoWrap">',GTraductions.getValeur('stage.fiche.objectifs'),'&nbsp;:&nbsp;</td>','<td style="',GStyle.composeWidth(100,'%'),'">',GChaine.ToHTML(this.stage.objectifs),'</td>','</tr>');if(this.stage.activitesPrevues)
H.push('<tr>','<td class="AlignementHaut Gras NoWrap">',GTraductions.getValeur('stage.fiche.activitesPrevues'),'&nbsp;:&nbsp;</td>','<td style="',GStyle.composeWidth(100,'%'),'">',GChaine.ToHTML(this.stage.activitesPrevues),'</td>','</tr>');if(this.stage.competencesVisees)
H.push('<tr>','<td class="AlignementHaut Gras NoWrap">',GTraductions.getValeur('stage.fiche.competencesVisees'),'&nbsp;:&nbsp;</td>','<td style="',GStyle.composeWidth(100,'%'),'">',GChaine.ToHTML(this.stage.competencesVisees),'</td>','</tr>');if(this.stage.modalitesConcertation)
H.push('<tr>','<td class="AlignementHaut Gras NoWrap">',GTraductions.getValeur('stage.fiche.modalitesConcertation'),'&nbsp;:&nbsp;</td>','<td style="',GStyle.composeWidth(100,'%'),'">',GChaine.ToHTML(this.stage.modalitesConcertation),'</td>','</tr>');if(this.stage.modalitesEvaluation)
H.push('<tr>','<td class="AlignementHaut Gras NoWrap">',GTraductions.getValeur('stage.fiche.modalitesEvaluation'),'&nbsp;:&nbsp;</td>','<td style="',GStyle.composeWidth(100,'%'),'">',GChaine.ToHTML(this.stage.modalitesEvaluation),'</td>','</tr>');if(this.stage.commentaire)
H.push('<tr>','<td class="AlignementHaut Gras NoWrap">',GTraductions.getValeur('stage.fiche.commentaire'),'&nbsp;:&nbsp;</td>','<td style="',GStyle.composeWidth(100,'%'),'">',GChaine.ToHTML(this.stage.commentaire),'</td>','</tr>');H.push('</table></td></tr>');}
H.push('<tr><td id="',this.id.zoneSuivi,'">','<table class="Tableau Table" border="0" cellspacing="0" cellpadding="0">','<tr><td>','<div class="PetitEspaceHaut PetitEspaceBas Gras" style="float: left;">',this._getTitreStageSuivi(this.stage),'</div>','<div class="PetitEspaceHaut PetitEspaceBas " style="float: right;">',(this.stage.conventionSignee?GTraductions.getValeur('stage.page.conventionSignee'):''),'</div>','</td></tr>');if(this.stage.avecSuivi)
H.push('<tr><td>',this.construireTitresSuivi(aPourImpression),'<div id="',this.id.suivi,'" ',window.GObjetWAI.composeRole(EGenreRole.List),' class="FondBlanc" style="',(aPourImpression?'':'height:'+this.hauteur.suivi+'px;'+GStyle.composeCouleurBordure(GCouleur.liste.titre.bordure,1,EGenreBordure.gauche+EGenreBordure.droite+EGenreBordure.bas)),'">',this.construireSuivi(this.stage.suiviStage,aPourImpression),'</div>','</td></tr>');H.push('</table>','</td></tr>');H.push('<tr><td id="',this.id.zoneAppreciation,'">','<div class="Texte10 EspaceHaut PetitEspaceBas Gras">',GTraductions.getValeur('stage.page.appreciation'),' :</div>',this.construireAppreciation(aPourImpression),'</td></tr>');H.push('<tr><td style="height: 100%">','</td></tr>');H.push('</table>');return H.join('');};ObjetAppreciationDeFinDeStage.prototype._getTitreStageSuivi=function(aStage){var lProfRef=(aStage.professeur.GetNbrElements()>0)?aStage.professeur.getTableauLibelles().join(', '):'';if(GEtatUtilisateur.GenreEspace!==EGenreEspace.Professeur&&GEtatUtilisateur.GenreEspace!==EGenreEspace.Entreprise)
lProfRef+=(aStage.maitreDeStage.GetNbrElements()>0)?(lProfRef?(' ('+(aStage.professeur.GetNbrElements()>1?GTraductions.getValeur('Professeurs'):GTraductions.getValeur('Professeur'))+')')+', ':'')+aStage.maitreDeStage.getTableauLibelles().join(', ')+' ('+(aStage.maitreDeStage.GetNbrElements()>1?GTraductions.getValeur('MaitresDeStage'):GTraductions.getValeur('MaitreDeStage'))+')':'';return GTraductions.getValeur('stage.page.suivi')+'&nbsp;'+lProfRef;};ObjetAppreciationDeFinDeStage.prototype.construireInfos=function(aPourImpression){var lHtml=[];lHtml.push('<tr><td id="',this.id.zoneInfos,'">','<div class="" style="height: ',(this.hauteur.infoEntreprise+12),'px;">','<table class="Tableau" style="width: 100%; height: 100%;" border="0" cellspacing="0" cellpadding="0">','<tr>','<td style="width : 34%; height: 100%;">','<fieldset class="PetitEspace AlignementGauche" style="height: ',(this.hauteur.infoEntreprise),'px; ',GStyle.composeCouleurBordure(GCouleur.liste.cellule.getBordure(aPourImpression)),'">','<legend class="Texte10 Gras" style="',GStyle.composeCouleurTexte(GCouleur.liste.cellule.getTexte(aPourImpression)),'">',GTraductions.getValeur('stage.page.stageChez'),' ',this.stage.entreprise.GetLibelle(),'</legend>','<div id="',this.id.adresse,'" style="width: 100%; height: ',this.hauteur.infoEntreprise-15,'px;">',this.construireEntreprise(this.stage.entreprise),'</div>','</fieldset>','</td>','<td><div style="width: 5px"></div></td>','<td style="width : 34%; height: 100%;">','<fieldset class="PetitEspace AlignementGauche" style="padding-right : 0px; height: ',(this.hauteur.infoEntreprise),'px; ',GStyle.composeCouleurBordure(GCouleur.liste.cellule.getBordure(aPourImpression)),'">','<legend class="Texte10 Gras" style="',GStyle.composeCouleurTexte(GCouleur.liste.cellule.getTexte(aPourImpression)),'">',GTraductions.getValeur('MaitresDeStage'),'</legend>','<div id="',this.id.maitresDeStage,'" class="','" style="width: 100%; height: ',this.hauteur.infoEntreprise-15,'px;">',this.construireMaitresDeStage(this.stage.maitreDeStage),'</div>','</fieldset>','</td>','<td style="width : 32%; height: 100%;">','<fieldset class="PetitEspace AlignementGauche" style="padding-right : 0px; height: ',(this.hauteur.infoEntreprise),'px; ',GStyle.composeCouleurBordure(GCouleur.liste.cellule.getBordure(aPourImpression)),'">','<legend class="Texte10 Gras" style="',GStyle.composeCouleurTexte(GCouleur.liste.cellule.getTexte(aPourImpression)),'">',GTraductions.getValeur('stage.Horaires'),'</legend>','<div id="',this.id.horaires,'" class="','" style="width: 100%; height: ',this.hauteur.infoEntreprise-15,'px;">',this.construireHoraires(this.stage.horairesJours),'</div>','</fieldset>','</td>','</tr>','</table>','</div>','</td></tr>');return lHtml.join('');};ObjetAppreciationDeFinDeStage.prototype.construireEntreprise=function(aInfo){var lHtml=[];lHtml.push('<table class="Tableau Texte10" style="width: 100%; height: 100%;" border="0" cellspacing="0" cellpadding="0"><tr>');lHtml.push('<td class="AlignementHaut" style="width: 100%; height: 100%;">',aInfo.adresse1?'<div>'+aInfo.adresse1+'</div>':'',aInfo.adresse2?'<div>'+aInfo.adresse2+'</div>':'',aInfo.adresse3?'<div>'+aInfo.adresse3+'</div>':'',aInfo.adresse4?'<div>'+aInfo.adresse4+'</div>':'','<div>',aInfo.codePostal?aInfo.codePostal+' ':'',aInfo.ville?aInfo.ville+' ':'',aInfo.pays?'- '+aInfo.pays:'','</div>','<div class="EspaceHaut">',aInfo.email?'<div>'+GChaine.composerEmail(aInfo.email,false,false,true)+'</div>':'',aInfo.site?'<div>'+GChaine.composerURL(aInfo.site,GChaine.ToHTML(aInfo.site))+'</div>':'','</div>','</td>');lHtml.push('<td class="AlignementHaut" style="height: 100%;">');if(aInfo.telFixe)
lHtml.push('<div style="min-width: 100px;"><table class="Tableau Texte10" style="width: 100%;" border="0" cellspacing="0" cellpadding="0"><tr><td><div class="Image_Dll_TelMaison" title="',GTraductions.getValeur('stage.TelFixe'),'"></div></td><td class="EspaceGauche" style="width: 100%;"><label ie-telephone>',aInfo.telFixe,'</label></td></tr></table></div>');if(aInfo.fax)
lHtml.push('<div style="min-width: 100px;"><table class="Tableau Texte10" style="width: 100%;" border="0" cellspacing="0" cellpadding="0"><tr><td><div class="Image_Dll_TelFax" title="',GTraductions.getValeur('stage.Fax'),'"></div></td><td class="EspaceGauche" style="width: 100%;"><label ie-telephone>',aInfo.fax,'</label></td></tr></table></div>');lHtml.push('</td>');lHtml.push('</tr></table>');return lHtml.join('');};ObjetAppreciationDeFinDeStage.prototype.construireMaitresDeStage=function(aMaitresDeStage){var lHtml=[];lHtml.push('<table class="Tableau Texte10" style="width:100%" border="0" cellspacing="0" cellpadding="0">');for(var i=0;i<aMaitresDeStage.GetNbrElements();i++){var maitreDeStage=aMaitresDeStage.GetElement(i);lHtml.push('<tr>','<td style="width:100%">','<div class="Gras">'+maitreDeStage.Libelle+'</div>',maitreDeStage.fonction?'<div>'+maitreDeStage.fonction+'</div>':'',maitreDeStage.email?'<div class="PetitEspaceHaut">'+GChaine.composerEmail(maitreDeStage.email)+'</div>':'','</td>','<td style="width:120px;">',maitreDeStage.telFixe||maitreDeStage.telPortable||maitreDeStage.fax?'<table class="Tableau Texte10" border="0" style="width:120px" cellspacing="0" cellpadding="0">':'',maitreDeStage.telFixe?'<tr><td><div class="Image_Dll_TelMaison" title="'+GTraductions.getValeur('stage.TelFixe')+'"></div></td><td>'+maitreDeStage.telFixe+'</td></tr>':'',maitreDeStage.telPortable?'<tr><td><div class="Image_Dll_TelPortable" title="'+GTraductions.getValeur('stage.TelPortable')+'"></div></td><td>'+maitreDeStage.telPortable+'</td></tr>':'',maitreDeStage.fax?'<tr><td><div class="Image_Dll_TelFax" title="'+GTraductions.getValeur('stage.Fax')+'"></div></td><td>'+maitreDeStage.fax+'</td></tr>':'',maitreDeStage.telFixe||maitreDeStage.telPortable||maitreDeStage.fax?'</table>':'','</td>','</tr>',i<aMaitresDeStage.GetNbrElements()-1?'<tr><td colspan="2"><div style="width : 10px; height: 10px;"></div></td></tr>':'');}
lHtml.push('</table>');return lHtml.join('');};ObjetAppreciationDeFinDeStage.prototype.construireHoraires=function(aListeJours){var lHtml=[];if(aListeJours)
for(var i=0;i<aListeJours.GetNbrElements();i++){var lJour=aListeJours.GetElement(i);if(lJour&&lJour.horaires&&(lJour.horaires.GetNbrElements()>0)){var lLibelleMatin=lJour.horaires.GetElementParGenre(0)?lJour.horaires.GetElementParGenre(0).GetLibelle():'';var lLibelleMidi=lJour.horaires.GetElementParGenre(1)?lJour.horaires.GetElementParGenre(1).GetLibelle():'';lHtml.push('<div class="NoWrap" style="height:13px;">','<div class="InlineBlock Texte10 AlignementHaut" style="width:75px;line-height:13px;">',lJour.GetLibelle(),'</div>','<div class="InlineBlock Texte10 AlignementHaut AlignementDroit" style="width:75px;line-height:13px;">',lLibelleMatin,'</div>','<div class="InlineBlock Texte10 AlignementHaut AlignementMilieu" style="width:35px;line-height:13px;">',lLibelleMidi&&lLibelleMatin?GTraductions.getValeur('Et').toLowerCase():'','</div>','<div class="InlineBlock Texte10 AlignementHaut AlignementGauche" style="width:75px;line-height:13px;">',lLibelleMidi,'</div>','</div>');}}
return lHtml.join('');};ObjetAppreciationDeFinDeStage.prototype.construireAppreciation=function(aPourImpression){var lHtml=[];if(aPourImpression){for(var i=0;i<this.stage.appreciations.GetNbrElements();i++)
lHtml.push('<div type="text" ','class="Texte10" style="width:100%;">',GChaine.ToHTML(GChaine.toTexte(this.stage.appreciations.GetElement(i).appreciation)),'</div>');} else{lHtml.push('<table class="Texte10" style="width:100%;" border="0" cellpadding="0" cellspacing="0">');lHtml.push('<tr class="Gras"><td style="width: 100%;" id="',this.Nom+'.tabOnglets"></td></tr>');if(this.stage.appreciations.GetNbrElements())
lHtml.push('<tr><td id="',this.id.appreciation,'_div" class="Texte10" style="width:100%;',GStyle.composeCouleurBordure(GCouleur.bordure,1),'"></td></tr>');else lHtml.push('<tr><td class="Texte10 EspaceHaut AlignementMilieu">',GTraductions.getValeur('stage.page.aucunMDS'),'</td></tr>');lHtml.push('</table>');}
return lHtml.join('');};ObjetAppreciationDeFinDeStage.prototype.construireTitresSuivi=function(aPourImpression){var H=[];H.push('<table class="Tableau" style="width:100%;',GTableau.styleTableau(aPourImpression,aPourImpression),'" border="0" cellspacing="0" cellpadding="0">');H.push('<tr>');H.push('<td class="Tableau_Titre" style="width:100%;',GTableau.styleTitre(aPourImpression),'">',GTraductions.getValeur('stage.page.titresListeSuivi.evenement'),'</td>','<td class="Tableau_Titre" style="',GTableau.styleTitre(aPourImpression),'" onclick="',this.Nom,'.evenementSuivi(',this.genreEvenement.tri,', ',-1,')"><div style="width:80px;">',GTraductions.getValeur('stage.page.titresListeSuivi.date'),'</div></td>','<td class="Tableau_Titre" style="',GTableau.styleTitre(aPourImpression),'"><div style="width:140px;">',GTraductions.getValeur('stage.page.titresListeSuivi.lieu'),'</div></td>');if(this.avecPJ)
H.push('<td class="Tableau_Titre" style="',GTableau.styleTitre(aPourImpression),'"><div style="width:40px;" class="Image_Trombone"></div></td>');if(this.avecPublier)
H.push('<td class="Tableau_Titre" style="',GTableau.styleTitre(aPourImpression),'"><div style="width:40px;" title="',GTraductions.getValeur('stage.fiche.publier'),'">',GTraductions.getValeur('stage.page.titresListeSuivi.publier'),'</div></td>');H.push(aPourImpression?'':'<td style="'+(this.stage.avecEdition?'':GStyle.composeCouleurBordure(GCouleur.liste.titre.bordure,1,EGenreBordure.bas))+'"><div style="width:'+(GNavigateur.GetLargeurBarreDeScroll()-1)+'px;"></div></td>');H.push('</tr>');if(!aPourImpression&&this.stage.avecEdition)
H.push('<tr>','<td id="',this.getIdSuivi('New'),'" tabIndex="0" ',window.GObjetWAI.composeRole(EGenreRole.Listitem),' ','onkeyup="if (GNavigateur.IsToucheSelection ()) ',this.Nom,'.evenementSuivi(',this.genreEvenement.selection,', ',-1,')" ','else if (GNavigateur.IsToucheMenuContextuel()) ',this.Nom,'.evenementSuivi(',this.genreEvenement.menuContextuel,', ',-1,')" ','onmouseup="if (GNavigateur.estSourisBoutonGauche ()) ',this.Nom,'.evenementSuivi(',this.genreEvenement.selection,', ',-1,')" ','else if (GNavigateur.estSourisBoutonDroite ()) ',this.Nom,'.evenementSuivi(',this.genreEvenement.menuContextuel,', ',-1,')" ','style="',GStyle.composeCouleurFond(GCouleur.blanc),GStyle.composeCouleurBordure(GCouleur.liste.titre.bordure,1,EGenreBordure.gauche+EGenreBordure.bas),'" class="PetitEspace AvecMain" colspan="',this.nbrColonnes,'"><div class="AlignementGauche">',ObjetListe.getTitreCreation(GTraductions.getValeur('stage.page.ligneCreation')),'</div></td>','<td style="',GStyle.composeCouleurBordure(GCouleur.liste.titre.bordure,1,EGenreBordure.gauche+EGenreBordure.bas),'"><div style="width:',GNavigateur.GetLargeurBarreDeScroll()-1,'px;"></div></td>','</tr>');H.push('</table>');return H.join('');};ObjetAppreciationDeFinDeStage.prototype.getIdSuivi=function(aIndex){return this.id.suivi+'_'+aIndex;};ObjetAppreciationDeFinDeStage.prototype.construireSuivi=function(aListeSuivis,aPourImpression){var H=[];var avecMain=this.stage.avecEdition?' AvecMain':'';for(var i=0;i<aListeSuivis.GetNbrElements();i++){var lSuivi=aListeSuivis.GetElement(i);if(lSuivi.Etat!==EGenreEtat.Suppression){var lElmEvenement=this.evenements.GetElementParNumero(lSuivi.evenement.GetNumero());if(lElmEvenement){var lElmLieu=this.lieux.GetElementParNumero(lSuivi.lieu.GetNumero());var lEvenement=[];var lTitre=lElmEvenement.couleurHtml+'&nbsp;'+lSuivi.GetLibelle();if(!aPourImpression)
lEvenement.push('onkeyup="if (GNavigateur.IsToucheMenuContextuel ()) ',this.Nom,'.evenementSuivi(',this.genreEvenement.menuContextuel,', ',i,', id); ','else if (GNavigateur.IsToucheSelection()) ',this.Nom,'.evenementSuivi(',this.genreEvenement.selection,', ',i,');" ','onmouseup="if (GNavigateur.estSourisBoutonGauche ()) ',this.Nom,'.evenementSuivi(',this.genreEvenement.selection,', ',i,'); ','else if (GNavigateur.estSourisBoutonDroit ()) ',this.Nom,'.evenementSuivi(',this.genreEvenement.menuContextuel,', ',i,', id);" ');var lPair=(i%2===0);var lFamilleCouleur=lPair?GCouleur.liste.moyenne:GCouleur.liste.cumul[1];H.push('<table tabIndex="0" id="',this.getIdSuivi(i),'" ',window.GObjetWAI.composeRole(EGenreRole.Listitem),' ',lEvenement.join(''),' class="Tableau SansOutline" style="width:100%;',GTableau.styleTableau(aPourImpression,aPourImpression,EGenreBordure.gauche),'" border="0" cellspacing="0" cellpadding="0">');H.push('<tr style="',GStyle.composeCouleur(lFamilleCouleur.getFond(aPourImpression),lFamilleCouleur.getTexte(aPourImpression)),'">');H.push('<td id="',this.getIdSuivi(i),'_td" class="PetitEspace Gras',avecMain,'" style="width:100%;',GStyle.composeCouleurBordure(lFamilleCouleur.getBordure(aPourImpression),1,EGenreBordure.droite),'">',lTitre,'</td>','<td class="PetitEspace',avecMain,'" style="',GStyle.composeCouleurBordure(lFamilleCouleur.getBordure(aPourImpression),1,EGenreBordure.droite),'"><div style="width:80px;">',GDate.FormatDate(lSuivi.date,'%JJ %MMM %AA'),'</div></td>','<td class="PetitEspace',avecMain,'" style="',GStyle.composeCouleurBordure(lFamilleCouleur.getBordure(aPourImpression),1,EGenreBordure.droite),'"><div style="width:140px;">',lElmLieu.GetLibelle(),'</div></td>');if(this.avecPJ)
H.push('<td class="PetitEspace',avecMain,'" style="',GStyle.composeCouleurBordure(lFamilleCouleur.getBordure(aPourImpression),1,EGenreBordure.droite),'">',this.composePJ(i,aPourImpression),'</td>');if(this.avecPublier)
H.push('<td class="PetitEspace',avecMain,'" style="',GStyle.composeCouleurBordure(lFamilleCouleur.getBordure(aPourImpression),1,EGenreBordure.droite),'"><div style="width:40px;"',lSuivi.publier?' class="Image_CocheVerte"':'','>&nbsp;</div></td>');H.push('</tr>');if(lSuivi.commentaire&&lSuivi.commentaire!=='')
H.push('<tr style="',GStyle.composeCouleurFond(lFamilleCouleur.getFond(aPourImpression)),'">','<td class="PetitEspaceGauche PetitEspaceDroit',avecMain,'" style="',GStyle.composeCouleurBordure(lFamilleCouleur.getBordure(aPourImpression),1,EGenreBordure.droite),'" colspan="',this.nbrColonnes,'"><div class="PetitEspace" style="',GStyle.composeCouleurFond(GCouleur.blanc),GStyle.composeCouleurTexte(GCouleur.noir),'">',GChaine.ToHTML(GChaine.toTexte(lSuivi.commentaire)),'</div></td>','</tr>');H.push('<tr style="',GStyle.composeCouleurFond(lFamilleCouleur.getFond(aPourImpression)),'">','<td colspan="',this.nbrColonnes,'" class="',avecMain,'" style="width:100%;',GStyle.composeTaillePolice(1),GStyle.composeCouleurBordure(lFamilleCouleur.getBordure(aPourImpression),1,EGenreBordure.droite+EGenreBordure.bas),'"><div style="width:80px;height:3px;"></div></td>','</tr>');H.push('</table>');}}}
return H.join('');};ObjetAppreciationDeFinDeStage.prototype._getIdSuivi=function(aIndiceSuivi){return this.Nom+'_PJ_'+aIndiceSuivi;};ObjetAppreciationDeFinDeStage.prototype.composePJ=function(aIndiceSuivi,aPourImpression){var H=[];var lEltSuivi=this.stage.suiviStage.GetElement(aIndiceSuivi);var lNbrPJ=lEltSuivi.listePJ?lEltSuivi.listePJ.GetNbrElements():0;var lStrHint='';var lAuMoinsUnePJEnBase=false;for(var i=0;i<lNbrPJ;i++){var lEltPJ=lEltSuivi.listePJ.GetElement(i);if(lEltPJ.Etat===EGenreEtat.Aucun) lAuMoinsUnePJEnBase=true;if(lEltPJ.Existe()) lStrHint+=lEltPJ.GetLibelle()+' ';}
var lAvecPJEnBase=(lNbrPJ>0)&&lAuMoinsUnePJEnBase;var lHint='title="'+lStrHint+'"';var lClass=(lAvecPJEnBase?'class="Image_Trombone"':'');var lEvnt=(lAvecPJEnBase&&!aPourImpression?'onmouseup="'+this.Nom+'.afficherFichePJ('+aIndiceSuivi+'); GNavigateur.StopperEvenement (event);"':'');H.push('<div style="width:40px;" id="',this._getIdSuivi(aIndiceSuivi),'" ',lClass,' ',lEvnt,' ',lHint,'></div>');return H.join('');};ObjetAppreciationDeFinDeStage.prototype.afficherFichePJ=function(aIndiceSuivi){if(GNavigateur.estSourisBoutonGauche()){var lElement=this.stage.suiviStage.GetElement(aIndiceSuivi);this.fichePJ.setDonnees({docsJoints:lElement.listePJ,genreDJ:EGenreRessource.DocJointEleve,id:GHtml.getElement(this._getIdSuivi(aIndiceSuivi))});}};ObjetAppreciationDeFinDeStage.prototype.evenementSuivi=function(aGenreEvenement,aIndex,aID){if(this.stage.avecEdition){var lSuivi=this.stage.suiviStage.GetElement(aIndex);if(aIndex=== -1||lSuivi.editable)
this.callback.appel(this,aGenreEvenement,aIndex,aID);}};ObjetAppreciationDeFinDeStage.prototype.evenementAnnexe=function(){this.callback.appel(this,this.genreEvenement.annexePedagogique);};ObjetAppreciationDeFinDeStage.prototype.evenementSurTab=function(aElement){this.elmAppreciationCourant=aElement;if(!this.elmAppreciationCourant)
return;var lHtml=[];var lDisabled=true;if(GEtatUtilisateur.GenreEspace===EGenreEspace.Professeur)
lDisabled=!(aElement.Genre===EGenreRessource.Enseignant&&aElement.Numero===GEtatUtilisateur.getUtilisateur().Numero);else if(GEtatUtilisateur.GenreEspace===EGenreEspace.Entreprise)
lDisabled=!(aElement.Genre===EGenreRessource.MaitreDeStage&&aElement.Numero===GEtatUtilisateur.getUtilisateur().Numero);if(!lDisabled){lHtml.push('<div class="Espace"><textarea type="text" tabIndex="0" id="',this.id.appreciation,'" name="',this.id.appreciation,'" title="',GTraductions.getValeur('stage.page.appreciation'),'" ',' onkeyup="',this.Nom,'.setValidation (id)" onchange="',this.Nom,'.setValidation (id)" class="Texte10 PetitEspace" style="',GStyle.composeHeight(this.hauteur.appreciation-6-5),' width:100%; margin : 0px; border: 0px;','">',aElement.appreciation,'</textarea><div>');} else{lHtml.push('<div class="Espace"><div id="',this.id.appreciation,'" title="',GTraductions.getValeur('stage.page.appreciation'),'" class="Texte10 PetitEspaceGauche PetitEspaceDroit" style="',GStyle.composeHeight(this.hauteur.appreciation-6-5),GStyle.composeWidth(GPosition.getWidth(this.Nom)-6-2-10),GStyle.composeCouleur(GCouleur.fond,GCouleur.texte),'"><div>',GChaine.ToStringHtml(GChaine.toTexte(aElement.appreciation)),'</div></div></div>');}
GHtml.setHtml(this.id.appreciation+'_div',lHtml.join(''));if(!lDisabled) $('#'+this.id.appreciation.escapeJQ()).jIEScrollTextarea({showArrows:true,enableKeyboardNavigation:false}).css('line-height','14px');else $('#'+this.id.appreciation.escapeJQ()).jScrollPane({showArrows:true,enableKeyboardNavigation:false}).css('line-height','14px');};ObjetAppreciationDeFinDeStage.prototype.setValidation=function(aID){switch(aID){case this.id.appreciation:var lAppreciation=GHtml.getValue(this.id.appreciation);if(lAppreciation!==this.elmAppreciationCourant.appreciation)
this.elmAppreciationCourant.appreciation=lAppreciation;this.elmAppreciationCourant.SetEtat(EGenreEtat.Modification);break;default:break;}
this.SetEtatSaisie(true);};ObjetAppreciationDeFinDeStage.prototype.rechargePage=function(){this.surPreResize();this.surPostResize();};ObjetAppreciationDeFinDeStage.prototype.surPreResize=function(){if(!this.donneesRecues) return;this.Afficher('&nbsp;');};ObjetAppreciationDeFinDeStage.prototype.surPostResize=function(){if(!this.donneesRecues) return;this.Afficher(this.ConstruireAffichage());this.tabOnglets.SetDonnees(this.stage.appreciations);this.tabOnglets.selectOnglet(0,true);this.evenementSurTab(this.elmAppreciationCourant);$('#'+this.id.suivi.escapeJQ()).parent().parent().prev().height(function(){return $(this).children('td').height();});$('#'+this.id.suivi.escapeJQ()).jScrollPane({showArrows:true,contentWidth:($('#'+this.id.suivi.escapeJQ()).width()-GNavigateur.GetLargeurBarreDeScroll()+2)}).not(function(){$(this).has('.jspVerticalBar');}).find('.jspPane').css('width',function(){return($(this).parent().width()-GNavigateur.GetLargeurBarreDeScroll()+2);});$('#'+this.id.sujetDetaille.escapeJQ()).css('line-height','14px').jScrollPane({showArrows:true,enableKeyboardNavigation:false});};ObjetAppreciationDeFinDeStage.prototype.effacer=function(aMessage){this.inherited('effacer',aMessage);this.donneesRecues=false;};;
ObjetAppreciationDeFinDeStage.prototype.AfficherListe=function(){var i,lSuivi,lElmEvenement,lElmLieu,lTitre,lNoeud,lNoeudEvenement;this._objetListeArborescente=new ObjetListeArborescente(this.Nom+'_Liste',0,this,null);var lRacine=this._objetListeArborescente.construireRacine();this._objetListeArborescente.setParametres(false);lTitre=this.stage.GetLibelle();lNoeud=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lRacine,'',lTitre,'Gras',true,true);var lLibelle=this.stage.sujetDetaille?GChaine.ToHTML(this.stage.sujetDetaille):GTraductions.getValeur('stage.page.pasDeSujetDetaille');this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeud,'',lLibelle);if(MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Entreprise,EGenreEspace.Professeur])){lNoeud=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lRacine,'',GTraductions.getValeur('stage.page.annexePedagogique'),'Gras',false);lNoeudEvenement=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lNoeud,'',GTraductions.getValeur('stage.fiche.objectifs'),'Gras',true);if(this.stage.objectifs) this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudEvenement,'',GChaine.ToHTML(this.stage.objectifs));lNoeudEvenement=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lNoeud,'',GTraductions.getValeur('stage.fiche.activitesPrevues'),'Gras',true);if(this.stage.activitesPrevues) this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudEvenement,'',GChaine.ToHTML(this.stage.activitesPrevues));lNoeudEvenement=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lNoeud,'',GTraductions.getValeur('stage.fiche.competencesVisees'),'Gras',true);if(this.stage.competencesVisees) this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudEvenement,'',GChaine.ToHTML(this.stage.competencesVisees));lNoeudEvenement=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lNoeud,'',GTraductions.getValeur('stage.fiche.modalitesConcertation'),'Gras',true);if(this.stage.modalitesConcertation) this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudEvenement,'',GChaine.ToHTML(this.stage.modalitesConcertation));lNoeudEvenement=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lNoeud,'',GTraductions.getValeur('stage.fiche.modalitesEvaluation'),'Gras',true);if(this.stage.modalitesEvaluation) this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudEvenement,'',GChaine.ToHTML(this.stage.modalitesEvaluation));lNoeudEvenement=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lNoeud,'',GTraductions.getValeur('stage.fiche.commentaire'),'Gras',true);if(this.stage.commentaire) this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudEvenement,'',GChaine.ToHTML(this.stage.commentaire));}
lNoeud=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lRacine,'',this._getTitreStageSuivi(this.stage),'Gras',true,true);if(this.stage.conventionSignee)
this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeud,'',GTraductions.getValeur('stage.page.conventionSignee'));if(this.stage.avecSuivi){for(i=0;i<this.stage.suiviStage.GetNbrElements();i++){lSuivi=this.stage.suiviStage.GetElement(i);if(lSuivi.Etat!==EGenreEtat.Suppression){lElmEvenement=this.evenements.GetElementParNumero(lSuivi.evenement.GetNumero());if(lElmEvenement){lElmLieu=this.lieux.GetElementParNumero(lSuivi.lieu.GetNumero());lTitre=lSuivi.GetLibelle()+' - '+GDate.FormatDate(lSuivi.date,'%JJ %MMMM %AA');if(lElmLieu.GetLibelle()&&lElmLieu.GetLibelle().trim().length>0)
lTitre+=' - '+lElmLieu.GetLibelle();lNoeudEvenement=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lNoeud,'',lTitre,'Gras');if(lSuivi.commentaire)
this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudEvenement,'',lSuivi.commentaire);}}}}
lNoeud=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lRacine,'',GTraductions.getValeur('stage.page.appreciation'),'Gras',true,true);for(i=0;i<this.stage.appreciations.GetNbrElements();i++)
this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeud,'',this.stage.appreciations.GetElement(i).GetLibelle()+' - '+this.stage.appreciations.GetElement(i).appreciation);GHtml.setHtml(this.Nom ,this._objetListeArborescente.ConstruireAffichage());this._objetListeArborescente.SetDonnees(lRacine);};;
function ObjetRequetePageStageGeneral(aPere,aEvenementSurReussite,aEvenementSurEchec){this.inheritedCreate(aPere,aEvenementSurReussite,aEvenementSurEchec);}
IE.Requetes.inscrire('PageStage.General',ObjetRequetePageStageGeneral,_ObjetRequeteXmlConsultationPN);ObjetRequetePageStageGeneral.prototype.lancerRequete=function(aNumeroEleve){this.JSON.Eleve=new ObjetElement('',aNumeroEleve);this.appelAsynchroneConsultation();};ObjetRequetePageStageGeneral.prototype.actionApresRequete=function(){var lListeStages=this.JSONReponse.Stages;var lListeEvenements=this.JSONReponse.Evenements;lListeEvenements.parcourir(function(D){D.couleurHtml='<span class="Texte8 Maigre" style="height:8px; width:10px; '+GStyle.composeCouleurFond(D.couleur)+GStyle.composeCouleurTexte(D.couleur)+GStyle.composeCouleurBordure(GCouleur.noir)+'">__</span>';D.libelleHtml=D.couleurHtml+'&nbsp;'+D.GetLibelle();});var lListeLieux=this.JSONReponse.Lieux;lListeLieux.AddElement(new ObjetElement(' ',0));lListeLieux.trier();var lAvecEditionAnnexePedagogique=this.JSONReponse.AvecEditionAnnexePedagogique;this.callbackReussite.appel(lListeStages,lListeEvenements,lListeLieux,lAvecEditionAnnexePedagogique);};;
function ObjetRequetePageAppreciationFinDeStage(aPere,aEvenementSurReussite,aEvenementSurEchec){this.inheritedCreate(aPere,aEvenementSurReussite,aEvenementSurEchec);}
IE.Requetes.inscrire('PageAppreciationFinDeStage',ObjetRequetePageAppreciationFinDeStage,_ObjetRequeteXmlConsultationPN);ObjetRequetePageAppreciationFinDeStage.prototype.lancerRequete=function(aNumeroEleve,aStage){var P=this.XML;P.CreerCategorie(null,'Eleve' ,null,aNumeroEleve);P.CreerElement(null,'Stage',aStage);this.appelAsynchroneConsultation();};ObjetRequetePageAppreciationFinDeStage.prototype.actionApresRequete=function(aXml){var lStage=null;if(aXml.Existe(null,'Stage')){lStage=aXml.GetElement(null,'Stage');var lNoeud=aXml.GetCategorie(null,'Stage');lStage.dateDebut=aXml.GetVariable(lNoeud,'DateDebut');lStage.dateFin=aXml.GetVariable(lNoeud,'DateFin');lStage.sujetDetaille=aXml.GetVariable(lNoeud,'SujetDetaille');lStage.objectifs=aXml.GetVariable(lNoeud,'Objectifs');lStage.activitesPrevues=aXml.GetVariable(lNoeud,'ActivitesPrevues');lStage.competencesVisees=aXml.GetVariable(lNoeud,'CompetencesVisees');lStage.modalitesConcertation=aXml.GetVariable(lNoeud,'ModalitesConcertation');lStage.modalitesEvaluation=aXml.GetVariable(lNoeud,'ModalitesEvaluation');lStage.commentaire=aXml.GetVariable(lNoeud,'Commentaire');lStage.conventionSignee=aXml.GetVariable(lNoeud,'ConventionSignee');lStage.avecEdition=aXml.GetVariable(lNoeud,'AvecEdition');lStage.avecEditionAnnexe=aXml.GetVariable(lNoeud,'AvecEditionAnnexe');lStage.avecSuivi=aXml.GetVariable(lNoeud,'AvecSuivi');lStage.listePJ=new ObjetDeserialiser().getListePJEleve(aXml,lNoeud);var lNoeudEntreprise=aXml.GetCategorie(lNoeud,'Entreprise');lStage.entreprise=aXml.GetElement(lNoeud,'Entreprise');lStage.entreprise.adresse1=aXml.GetVariable(lNoeudEntreprise,'Adresse1');lStage.entreprise.adresse2=aXml.GetVariable(lNoeudEntreprise,'Adresse2');lStage.entreprise.adresse3=aXml.GetVariable(lNoeudEntreprise,'Adresse3');lStage.entreprise.adresse4=aXml.GetVariable(lNoeudEntreprise,'Adresse4');lStage.entreprise.codePostal=aXml.GetVariable(lNoeudEntreprise,'CodePostal');lStage.entreprise.ville=aXml.GetVariable(lNoeudEntreprise,'Ville');lStage.entreprise.pays=aXml.GetVariable(lNoeudEntreprise,'Pays');lStage.entreprise.telFixe=aXml.GetVariable(lNoeudEntreprise,'TelFixe');lStage.entreprise.fax=aXml.GetVariable(lNoeudEntreprise,'Fax');lStage.entreprise.email=aXml.GetVariable(lNoeudEntreprise,'Email');lStage.entreprise.site=aXml.GetVariable(lNoeudEntreprise,'Site');var lNoeudHoraires=aXml.GetCategorie(lNoeud,'Horaires');lStage.horairesJours=aXml.GetListeElements(lNoeudHoraires,'Jour',false,this._ajouterJour.bind(this));lStage.appreciations=new ObjetListeElements();lStage.maitreDeStage=aXml.GetListeElements(lNoeud,'MaitreDeStage',true,this._ajouterDetailsMaitreDeStage.bind(this,lStage.appreciations));lStage.type=aXml.GetElement(lNoeud,'TypeDeStage');lStage.professeur=aXml.GetListeElements(lNoeud,'Professeur',true,this._ajouterDetailsProfesseur.bind(this,lStage.appreciations));lStage.suiviStage=aXml.GetListeElements(lNoeud,'SuiviStage',false,this._ajouterDetailsSuivi.bind(this));lStage.suiviStage.setTri([ObjetTri.init('date'),ObjetTri.init('Libelle'),ObjetTri.init('Numero')]);lStage.suiviStage.trier();}
var lListePJEleve=new ObjetDeserialiser().listePJEleve(aXml,aXml.GetCategorie(null,'ListeDJEleve'));this.callbackReussite.appel({stage:lStage,listePJEleve:lListePJEleve});};ObjetRequetePageAppreciationFinDeStage.prototype._ajouterDetailsMaitreDeStage=function(aListeAppreciations,aXml,aNoeud,aMaitreDeStage){aMaitreDeStage.email=aXml.GetVariable(aNoeud,'Email');aMaitreDeStage.fonction=aXml.GetVariable(aNoeud,'function');aMaitreDeStage.telFixe=aXml.GetVariable(aNoeud,'TelFixe');aMaitreDeStage.telPortable=aXml.GetVariable(aNoeud,'TelPortable');aMaitreDeStage.fax=aXml.GetVariable(aNoeud,'Fax');var lElmAppreciation=new ObjetElement(aMaitreDeStage.Libelle,aMaitreDeStage.Numero,aMaitreDeStage.Genre);lElmAppreciation.appreciation=aXml.GetVariable(aNoeud,'Appreciation');aListeAppreciations.AddElement(lElmAppreciation);};ObjetRequetePageAppreciationFinDeStage.prototype._ajouterDetailsProfesseur=function(aListeAppreciations,aXml,aNoeud,aProfesseur){var lElmAppreciation=new ObjetElement(aProfesseur.Libelle,aProfesseur.Numero,aProfesseur.Genre);lElmAppreciation.appreciation=aXml.GetVariable(aNoeud,'Appreciation');aListeAppreciations.AddElement(lElmAppreciation);};ObjetRequetePageAppreciationFinDeStage.prototype._ajouterDetailsSuivi=function(aXml,aNoeud,aSuivi){aSuivi.editable=aXml.GetVariable(aNoeud,'Editable');aSuivi.date=aXml.GetVariable(aNoeud,'Date');aSuivi.commentaire=aXml.GetVariable(aNoeud,'Commentaire');aSuivi.evenement=aXml.GetElement(aNoeud,'Evenement');aSuivi.lieu=aXml.GetElement(aNoeud,'Lieu');aSuivi.publier=aXml.GetVariable(aNoeud,'Publier');aSuivi.listePJ=new ObjetDeserialiser().getListePJEleve(aXml,aNoeud);};ObjetRequetePageAppreciationFinDeStage.prototype._ajouterJour=function(aXml,aNoeud,aJour){aJour.horaires=aXml.GetListeElements(aNoeud,'Horaire',false);};;
MethodesObjet.heritagePrototype(_ObjetAffichagePageAppreciationDeFinDeStage,ObjetInterfacePage);function _ObjetAffichagePageAppreciationDeFinDeStage(ANom,AIdent,APere,AEvenement){this.inheritedCreate(ANom,AIdent,APere,AEvenement);this.listeStages=new ObjetListeElements();this.stage=new ObjetElement();this.libelleStage='';this.suiviTri=EGenreTriElement.Decroissant;this.parametres={avecEdition:false};this.numeroEleve=0;}
_ObjetAffichagePageAppreciationDeFinDeStage.prototype.ConstruireInstances=function(){this.IdentCombo=this.Add(window.ObjetSaisiePN ,this.evenementCombo ,this.initialiserCombo);this.IdPremierElement=this.GetInstance(this.IdentCombo).getPremierElement();this.IdentPage=this.Add(window.ObjetAppreciationDeFinDeStage ,this.evenementFinDeStage ,null);this.identBandeau=this.Add(window.ObjetBandeau ,null,null);};_ObjetAffichagePageAppreciationDeFinDeStage.prototype.DetruireInstances=function(){};_ObjetAffichagePageAppreciationDeFinDeStage.prototype.SetParametresGeneraux=function(){this.GenreStructure=EStructureAffichage.Autre;this.IdentZoneAlClient=this.IdentPage;this.avecBandeau=true;this.AddSurZone=[this.IdentCombo,this.identBandeau];};_ObjetAffichagePageAppreciationDeFinDeStage.prototype.ConstruireStructureAffichageAutre=function(){var lHTML=[];lHTML.push('<table style="width: 100%; height: 100%" border="0" cellpadding="0" cellspacing="5">','<tr id="',this.Nom,'_Page"><td class="AlignementHaut" id="',this.GetInstance(this.IdentPage).GetNom(),'">','</td></tr>','</table>');return lHTML.join('');};_ObjetAffichagePageAppreciationDeFinDeStage.prototype.afficherFenetreCouleur=function(){this.GetInstance(this.identFenetreCouleur).SetDonnees();};_ObjetAffichagePageAppreciationDeFinDeStage.prototype.afficherFenetreCalendrier=function(){this.GetInstance(this.identFenetreCalendrier).SetDonnees(GDate.GetJourSuivant(GDate.getDateCourante(),-3));};_ObjetAffichagePageAppreciationDeFinDeStage.prototype.AfficherPage=function(){this.SetEtatSaisie(false);this.RecupererDonnees();};_ObjetAffichagePageAppreciationDeFinDeStage.prototype.RecupererDonnees=function(){window.Invocateur.evenement(window.Invocateur.events.activationImpression,EGenreImpression.Aucune);new ObjetRequetePageStageGeneral(this,this.actionSurRecupererDonnees).lancerRequete(GEtatUtilisateur.getMembre()?GEtatUtilisateur.getMembre().GetNumero():0);};_ObjetAffichagePageAppreciationDeFinDeStage.prototype.RecupererStage=function(){window.Invocateur.evenement(window.Invocateur.events.activationImpression,EGenreImpression.Aucune);new ObjetRequetePageAppreciationFinDeStage(this,this.actionSurRecupererStage).lancerRequete(GEtatUtilisateur.getMembre()?GEtatUtilisateur.getMembre().GetNumero():0,this.stageCourant);};_ObjetAffichagePageAppreciationDeFinDeStage.prototype.initialiserCombo=function(aObjet){aObjet.SetParametres(true,false,160,true);aObjet.setOptions_ObjetSaisie({labelWAIZone:GTraductions.getValeur('stage.comboStage'),roleWAIEdit:EGenreRole.Option,avecGestionUnElement:false});aObjet.SetVisible(false);};_ObjetAffichagePageAppreciationDeFinDeStage.prototype.initialiserFenetreSuiviStage=function(aInstance){aInstance.SetParametres_Fenetre(GTraductions.getValeur('stage.fenetresuivi.modifier'),400,320,new Array(GTraductions.getValeur('Annuler'),GTraductions.getValeur('Valider')));};_ObjetAffichagePageAppreciationDeFinDeStage.prototype.initialiserFenetreAnnexePedagogique=function(aInstance){var lBoutons=this.parametres.avecEdition?[GTraductions.getValeur('Annuler'),GTraductions.getValeur('Valider')]:[GTraductions.getValeur('Fermer')];var lTitre=GTraductions.getValeur('stage.page.annexePedagogique');aInstance.SetParametres_Fenetre(lTitre,500,615,lBoutons);aInstance.setParametres_AnnexePedagogique(this.parametres);};_ObjetAffichagePageAppreciationDeFinDeStage.prototype.InitialiserMenuContextuel=function(aInstance){aInstance.AddCommande(0,GTraductions.getValeur('stage.menu.creer'));aInstance.AddCommande(1,GTraductions.getValeur('stage.menu.modifier'));aInstance.AddCommande(2,GTraductions.getValeur('stage.menu.supprimer'));};_ObjetAffichagePageAppreciationDeFinDeStage.prototype.evenementCombo=function(aGenreEvenement,aElement){if(aGenreEvenement===EGenreEvenementObjetSaisie.selection){this.libelleStage=aElement.GetLibelle();this.stageCourant=aElement;GEtatUtilisateur.Navigation.SetRessource(EGenreRessource.Stage,aElement);var lInfobulle='';if(this.GetInstance(this.identBandeau)){var lLibelle=aElement.periode;var lArray=lLibelle.split('; ');if(lArray.length>5){lInfobulle=lLibelle;lLibelle='&nbsp;';for(var i=0;i<5;i++){lLibelle+=lArray[i]+'; ';}
lLibelle+='...';} else{lLibelle='&nbsp;'+lLibelle;}
this.GetInstance(this.identBandeau).SetLibelle(lLibelle);if(lInfobulle) this.GetInstance(this.identBandeau).setInfoBulle(lInfobulle);}
this.RecupererStage();}};_ObjetAffichagePageAppreciationDeFinDeStage.prototype.evenementFinDeStage=function(aPere,aGenreEvenement,aIndex){this.indexSuiviCourant=aIndex;switch(aGenreEvenement){case aPere.genreEvenement.selection:this.actionSurEvenementFinDeStage(aIndex);break;case aPere.genreEvenement.menuContextuel:if(aIndex!== -1){this._objGestionFocus_apresMenuContextuel={index:aIndex};this.GetInstance(this.IdentMenuContextuel).Afficher();}
break;case aPere.genreEvenement.tri:break;case aPere.genreEvenement.annexePedagogique:this.parametres.avecEdition=this.stage.avecEditionAnnexe;this.GetInstance(this.identFenetreAnnexe).SetDonnees({sujetDetaille:this.stage.sujetDetaille,objectifs:this.stage.objectifs,activitesPrevues:this.stage.activitesPrevues,competencesVisees:this.stage.competencesVisees,modalitesConcertation:this.stage.modalitesConcertation,modalitesEvaluation:this.stage.modalitesEvaluation,commentaire:this.stage.commentaire},this.parametres);break;default:break;}};_ObjetAffichagePageAppreciationDeFinDeStage.prototype.evenementFenetreSuiviStage=function(aGenreBouton,aSuivi,aListePJEleve){if(aGenreBouton===1){var lSuivi=this.stage.suiviStage.GetElementParNumero(aSuivi.GetNumero());if(aSuivi.Etat===EGenreEtat.Creation&&!lSuivi){this.stage.suiviStage.AddElement(aSuivi);lSuivi=aSuivi;} else if(lSuivi){this.stage.suiviStage.AddElement(aSuivi,this.stage.suiviStage.GetIndiceParNumeroEtGenre(aSuivi.GetNumero()));} else{;}
this.listePJEleve=aListePJEleve;if(lSuivi){this.stage.suiviStage.setTri([ObjetTri.init('date'),ObjetTri.init('Libelle'),ObjetTri.init('Numero')]);this.stage.suiviStage.trier();this.SetEtatSaisie(true);}}
this.GetInstance(this.IdentPage).rechargePage();this._gestionFocus_apresFenetreSuivi(aGenreBouton,aSuivi);this.suiviCourant=null;};_ObjetAffichagePageAppreciationDeFinDeStage.prototype.evenementFenetreAnnexePedagogique=function(aGenreBouton,aDonnees){if(aGenreBouton===1){if(this.stage.sujetDetaille!==aDonnees.sujetDetaille){this.stage.sujetDetaille=aDonnees.sujetDetaille;this.GetInstance(this.IdentPage).rechargePage();}
this.stage.objectifs=aDonnees.objectifs;this.stage.activitesPrevues=aDonnees.activitesPrevues;this.stage.competencesVisees=aDonnees.competencesVisees;this.stage.modalitesConcertation=aDonnees.modalitesConcertation;this.stage.modalitesEvaluation=aDonnees.modalitesEvaluation;this.stage.commentaire=aDonnees.commentaire;this.stage.SetEtat(EGenreEtat.Modification);this.SetEtatSaisie(true);}};_ObjetAffichagePageAppreciationDeFinDeStage.prototype.EvenementSurMenuContextuel=function(aLigne){if(!aLigne)
this._gestionFocus_apresMenuContextuel();else switch(aLigne.Numero){case 0:this.actionSurEvenementFinDeStage(-1);break;case 1:this.actionSurEvenementFinDeStage(this.indexSuiviCourant);break;case 2:GApplication.getMessage().Afficher(EGenreBoiteMessage.Confirmation,'',GTraductions.getValeur('stage.message.supprimer'),null,this,this.evenementApresConfirmation);break;default:this._gestionFocus_apresMenuContextuel();break;}};_ObjetAffichagePageAppreciationDeFinDeStage.prototype.evenementApresConfirmation=function(aBouton){if(aBouton===0){var lSuivi=this.stage.suiviStage.GetElement(this.indexSuiviCourant);lSuivi.SetEtat(EGenreEtat.Suppression);this.SetEtatSaisie(true);this.GetInstance(this.IdentPage).rechargePage();}
this._gestionFocus_apresMenuContextuel(aBouton);};_ObjetAffichagePageAppreciationDeFinDeStage.prototype.GetPageImpression=function(){var lSousTitre=this.libelleStage;lSousTitre+=this.stageCourant?'&nbsp;'+this.stageCourant.periode:'';return{titre1:this.Pere.getLibelleSousOnglet(null,true,false,false),titre2:lSousTitre,contenu:this.GetInstance(this.IdentPage).composePage(true)};};_ObjetAffichagePageAppreciationDeFinDeStage.prototype.actionSurRecupererDonnees=function(aListeStages,aListeEvenements,aListeLieux,aAvecEditionAnnexePedagogique){this.listeStages=aListeStages;this.listeEvenements=aListeEvenements;this.listeLieux=aListeLieux;this.parametres.avecEdition=aAvecEditionAnnexePedagogique;if(this.listeStages.GetNbrElements()>0){this.afficherBandeau(true);this.GetInstance(this.IdentCombo).SetDonnees(this.listeStages);this.GetInstance(this.IdentCombo).SetSelectionParNumeroEtGenre(GEtatUtilisateur.Navigation.GetNumeroRessource(EGenreRessource.Stage),GEtatUtilisateur.Navigation.GetGenreRessource(EGenreRessource.Stage),0);this.GetInstance(this.IdentCombo).SetVisible(true);} else{this.afficherMessageAucunStage();}};_ObjetAffichagePageAppreciationDeFinDeStage.prototype.afficherMessageAucunStage=function(){this.EvenementAfficherMessage(GTraductions.getValeur('stage.page.aucunStage'));};_ObjetAffichagePageAppreciationDeFinDeStage.prototype.actionSurRecupererStage=function(aParam){if(aParam.stage){this.stage=aParam.stage;this.GetInstance(this.IdentPage).setTraductions(GTraductions.getValeur('stage'));this.GetInstance(this.IdentPage).SetDonnees(this.stage,this.listeEvenements,this.listeLieux,this.avecEdition,this.avecPublier);if(this.identSelecteurPJ){this.listePJEleve=aParam.listePJEleve;$('#'+this.GetNomInstance(this.identSelecteurPJ).escapeJQ()).parent().css('display',this.stage.listePJ&&this.stage.listePJ.GetNbrElements()>0?'':'none');this.GetInstance(this.identSelecteurPJ).setDonnees({listePJ:this.stage.listePJ,genrePJ:EGenreDocumentJoint.Fichier,genreRessourcePJ:EGenreRessource.DocJointEleve,styleSite:false});}
window.Invocateur.evenement(window.Invocateur.events.activationImpression,EGenreImpression.Normale,this);}};_ObjetAffichagePageAppreciationDeFinDeStage.prototype.actionSurEvenementFinDeStage=function(aIndex){if(aIndex=== -1){this.GetInstance(this.identFenetreSuivi).SetTitre(GTraductions.getValeur('stage.fenetresuivi.creer'));this.suiviCourant=new ObjetElement();this.suiviCourant.editable=true;this.suiviCourant.SetLibelle(GTraductions.getValeur('Nouveau'));this.suiviCourant.evenement=new ObjetElement();this.suiviCourant.lieu=new ObjetElement();this.suiviCourant.date=GDate.getDateCourante();this.suiviCourant.commentaire='';this.suiviCourant.publier=true;this.suiviCourant.listePJ=new ObjetListeElements();this.suiviCourant.listePJ.getUrls=ObjetDeserialiser.getUrls;this.suiviCourant.SetEtat(EGenreEtat.Creation);} else{this.GetInstance(this.identFenetreSuivi).SetTitre(GTraductions.getValeur('stage.fenetresuivi.modifier'));this.suiviCourant=this.stage.suiviStage.GetElement(aIndex);}
this._objGestionFocus_apresFenetreSuivi={element:this.suiviCourant};this.GetInstance(this.identFenetreSuivi).SetDonnees({suivi:this.suiviCourant,evenements:this.listeEvenements,lieux:this.listeLieux,listePJEleve:this.listePJEleve});};_ObjetAffichagePageAppreciationDeFinDeStage.prototype._gestionFocus_apresFenetreSuivi=function(aGenreEvenement,aSuivi){if(aGenreEvenement===null||aGenreEvenement===undefined)
return;switch(aGenreEvenement){case(-1):case(0):if(aSuivi.Etat===EGenreEtat.Creation)
this._objGestionFocus_apresFenetreSuivi={id:this.GetInstance(this.IdentPage).getIdSuivi('New')};break;case(1):break;default:;break;}
var lID=this.GetInstance(this.IdentPage).getPremierElement();if(this._objGestionFocus_apresFenetreSuivi.id){lID=this._objGestionFocus_apresFenetreSuivi.id;} else if(this._objGestionFocus_apresFenetreSuivi.element){var lIndex=this.stage.suiviStage.GetIndiceParElement(this._objGestionFocus_apresFenetreSuivi.element,true);if(lIndex>=0)
lID=this.GetInstance(this.IdentPage).getIdSuivi(lIndex);}
if(lID) GHtml.setFocus(lID);};_ObjetAffichagePageAppreciationDeFinDeStage.prototype._gestionFocus_apresMenuContextuel=function(aGenreEvenement){if(aGenreEvenement===0)
GHtml.setFocus(this.GetInstance(this.IdentPage).getIdSuivi('New'));else GHtml.setFocus(this.GetInstance(this.IdentPage).getIdSuivi(this._objGestionFocus_apresMenuContextuel.index));};_ObjetAffichagePageAppreciationDeFinDeStage.prototype.Valider=function(){new ObjetRequeteSaisieAppreciationFinDeStage(this,this.ActionSurValidation).addUpload({listeFichiers:this.listePJEleve}).lancerRequete({numEleve:this.numeroEleve?this.numeroEleve:GEtatUtilisateur.getMembre().GetNumero(),stage:this.stage,appreciations:this.stage.appreciations,listePJ:this.listePJEleve});};_ObjetAffichagePageAppreciationDeFinDeStage.prototype.evntSelectionPJStage=function(){this.SetEtatSaisie(true);};_ObjetAffichagePageAppreciationDeFinDeStage.prototype.EvenementAfficherMessage=function(aGenreMessage){this.inherited('EvenementAfficherMessage',aGenreMessage);if(this.identSelecteurPJ!==undefined)
$('#'+this.GetNomInstance(this.identSelecteurPJ).escapeJQ()).parent().css('display','none');};;
MethodesObjet.heritagePrototype(ObjetAffichagePageAppreciationDeFinDeStage,_ObjetAffichagePageAppreciationDeFinDeStage);function ObjetAffichagePageAppreciationDeFinDeStage(ANom,AIdent,APere,AEvenement){this.inheritedCreate(ANom,AIdent,APere,AEvenement);this.avecEdition=false;this.avecPublier=false;}
ObjetAffichagePageAppreciationDeFinDeStage.prototype.ConstruireInstances=function(){this.IdentCombo=this.Add(window.ObjetSaisiePN ,this.evenementCombo ,this.initialiserCombo);this.IdPremierElement=this.GetInstance(this.IdentCombo).getPremierElement();this.IdentPage=this.Add(window.ObjetAppreciationDeFinDeStage ,this.evenementFinDeStage ,null);this.identBandeau=this.Add(window.ObjetBandeau ,null,null);};ObjetAffichagePageAppreciationDeFinDeStage.prototype.evenementFinDeStage=function(aPere,aGenreEvenement,aIndex,aID){this.indexSuiviCourant=aIndex;};ObjetAffichagePageAppreciationDeFinDeStage.prototype.Valider=function(){};ObjetAffichagePageAppreciationDeFinDeStage.prototype.surValidation_SuiviStage=function(aXml,aNoeud,aElement){};;
MethodesObjet.heritagePrototype(_PageResultatConseilDeClasse,_PageResultat);function _PageResultatConseilDeClasse(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.genreImpression=EGenreImpression.GenerationPDF;}
_PageResultatConseilDeClasse.prototype.ActionSurRecupererBulletin=function(aParam){this.inherited('ActionSurRecupererBulletin',aParam);if(!aParam.Message){var lDate=aParam.date;if(this.GetInstance(this.identBandeau)){var lChaine=lDate?GDate.FormatDate(lDate,GTraductions.getValeur('Le')+' %JJ/%MM/%AAAA'):'';this.GetInstance(this.identBandeau).SetLibelle(lChaine);}}
this.surResizeInterface();if(!aParam.Message&&GEtatUtilisateur.estModeAccessible()&&this.GetInstance(this.IdentPage)) this.GetInstance(this.IdentPage).setFocus();};_PageResultatConseilDeClasse.prototype.AfficherInterfaceGraphique=function(AXml){var lArbrePied;if(AXml){this.SetDonnees_Affichage();this.SetDonnees_Services();this.SetDonnees_Absences();this.setDonnees_General(this.MoyenneGenerale);lArbrePied=this.GetInstance(this.identPied).setDonnees_PiedDePage(this.PiedDePage);}
this.GetInstance(this.IdentPage).actualiser(lArbrePied);};_PageResultatConseilDeClasse.prototype.getParametresPDF=function(){var lResult={genreGenerationPDF:TypeHttpGenerationPDF.Bulletin,classe:GEtatUtilisateur.Navigation.GetRessource(EGenreRessource.Classe),periode:GEtatUtilisateur.Navigation.GetRessource(EGenreRessource.Periode)};return lResult;};;
MethodesObjet.heritagePrototype(ObjetConseilDeClasse,_ObjetBulletinEtReleve);function ObjetConseilDeClasse(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);}
ObjetConseilDeClasse.prototype.getLargeurService=function(){return this.LargeurService+this.nbrColonnes*(this.LargeurNote+1);};ObjetConseilDeClasse.prototype.getLargeurGeneral=function(){return this.LargeurService+this.nbrGeneral*(this.LargeurNote+1)+1;};ObjetConseilDeClasse.prototype.SetDonnees_Affichage=function(aAffichage){this.Affichage=aAffichage;this.NbrMoyennes=Number(this.Affichage.AvecMoyenneClasse)+
2*Number(this.Affichage.AvecMoyenneInfSup)+
3*Number(this.Affichage.AvecNombrePointsEntre);this.nbrGeneral=Number(this.Affichage.AvecVolumeHoraire)+
Number(this.Affichage.AvecCoefficient)+
Number(this.Affichage.AvecNombreDevoirs);this.nbrColonnes=this.NbrMoyennes+this.nbrGeneral;};ObjetConseilDeClasse.prototype.SetDonnees=function(aSaisie,aListeElements,aNbrMaxServices,aNbrMaxDevoirs,aTableauSurMatieres){this.Saisie=aSaisie;this.Liste=this._getListeDonneesLineaire(aListeElements);this.NbrMaxServices=aNbrMaxServices;this.NbrMaxDevoirs=aNbrMaxDevoirs;this.tableauSurMatieres=aTableauSurMatieres;this.donneesRecues=true;};ObjetConseilDeClasse.prototype.actualiserDimensions=function(aPourImpression,aNumeroImpression){this.inherited('actualiserDimensions',aPourImpression,aNumeroImpression);if(aPourImpression){this.LargeurAppreciation=this.Affichage.NombreAppreciations?[450,420,390][aNumeroImpression]/this.Affichage.NombreAppreciations:0;}
else{if(this.Affichage.NombreAppreciations){var lLongueurPourAppreciations=GPosition.getWidth(this.Nom)-this.ScrollV.GetLargeur()-this.getLargeurService();this.LargeurAppreciation=Math.floor(lLongueurPourAppreciations/this.Affichage.NombreAppreciations);this.LargeurService+=lLongueurPourAppreciations-this.Affichage.NombreAppreciations*(this.LargeurAppreciation+1)-2;}}
this.NombreColonnes=this.Affichage.NombreAppreciations;};ObjetConseilDeClasse.prototype.composePageBulletin=function(){var H=[];H.push('<table ',GObjetWAI.composeRole(EGenreRole.Grid),' id="'+this.idPage+'" border="0" cellspacing="0" cellpadding="0">');H.push('<tr>');H.push('<td style="'+GStyle.composeCouleurBordure(GCouleur.liste.getBordure(),1,EGenreBordure.haut+EGenreBordure.droite)+'">'+this.ComposeLigneTitre()+'</td>');H.push('<td width="'+this.ScrollV.GetLargeur()+'"></td>');H.push('</tr>');H.push('<tr>');H.push('<td style="'+GStyle.composeCouleurBordure(GCouleur.liste.getBordure(),1,EGenreBordure.droite)+'"><div tabIndex="-1" id="'+this.ScrollV.GetIdZone()+'" style="height:1px; overflow:hidden;" onscroll="',this.Nom,'.ScrollV.Actualiser()">'+this.ComposeBulletin(0)+'</div></td>');H.push('<td id="'+this.ScrollV.GetIdScroll()+'"></td>');H.push('</tr>');H.push('<tr><td>'+this.ComposeGeneral()+'</td></tr>');H.push('</table>');return H.join('');};ObjetConseilDeClasse.prototype.ComposeLigneTitre=function(aPourImpression){var H=[];var lDefaut={taille:this.LargeurNote,bordGauche:true,bordBas:true,nbrLignes:2,pourImpression:aPourImpression,role:EGenreRole.Columnheader};H.push('<table ',GObjetWAI.composeRole(EGenreRole.Row),' id="'+this.GetIdTitre()+'" class="Tableau '+this.taillePolice+'"  border="0" cellpadding="0" cellspacing="0">');H.push('<tr height="'+this.HauteurTitre+'px">');H.push(this.composeTitre($.extend({},lDefaut,{libelle:GTraductions.getValeur('ConseilClasse.matieres'),taille:this.LargeurService,bordGauche:false})));H.push(this.composeTitre($.extend({},lDefaut,{libelle:GTraductions.getValeur('ConseilClasse.volHoraire'),visible:this.Affichage.AvecVolumeHoraire})));H.push(this.composeTitre($.extend({},lDefaut,{libelle:GTraductions.getValeur('ConseilClasse.coeff'),visible:this.Affichage.AvecCoefficient})));H.push(this.composeTitre($.extend({},lDefaut,{libelle:GTraductions.getValeur('ConseilClasse.nbrNotes'),visible:this.Affichage.AvecNombreDevoirs})));H.push(this.composeTitre($.extend({},lDefaut,{libelle:this.NbrMoyennes>1?GTraductions.getValeur('ConseilClasse.moyennes'):GTraductions.getValeur('ConseilClasse.moy'),taille:this.LargeurNote*this.NbrMoyennes,bordBas:false,nbrCol:this.NbrMoyennes,nbrLignes:1,visible:this.NbrMoyennes})));for(var I=0;I<this.Affichage.NombreAppreciations;I++)
H.push(this.composeTitre($.extend({},lDefaut,{libelle:this.Affichage.ListeIntitulesAppreciations.GetLibelle(I),taille:this.LargeurAppreciation})));H.push('</tr>');H.push('<tr height="'+this.HauteurTitre+'px">');H.push(this.composeTitre($.extend({},lDefaut,{libelle:GTraductions.getValeur('ConseilClasse.classe'),nbrLignes:1,visible:this.Affichage.AvecMoyenneClasse})));H.push(this.composeTitre($.extend({},lDefaut,{libelle:'-' ,nbrLignes:1,visible:this.Affichage.AvecMoyenneInfSup})));H.push(this.composeTitre($.extend({},lDefaut,{libelle:'+' ,nbrLignes:1,visible:this.Affichage.AvecMoyenneInfSup})));H.push(this.composeTitre($.extend({},lDefaut,{libelle:'< 8' ,nbrLignes:1,visible:this.Affichage.AvecNombrePointsEntre})));H.push(this.composeTitre($.extend({},lDefaut,{libelle:'8 - 12',nbrLignes:1,visible:this.Affichage.AvecNombrePointsEntre})));H.push(this.composeTitre($.extend({},lDefaut,{libelle:'> 12' ,nbrLignes:1,visible:this.Affichage.AvecNombrePointsEntre})));H.push('</tr>');if(!aPourImpression)
H.push('</table>');return H.join('');};ObjetConseilDeClasse.prototype.ComposeBulletin=function(aNumeroZone,aPourImpression){var H=[];if(!aPourImpression)
H.push('<table ',GObjetWAI.composeRole(EGenreRole.Row),' id="'+this.ScrollV.GetIdContenu()+'" class="'+this.taillePolice+' FondBlanc" border="0" cellpadding="0" cellspacing="0">');var lService;for(var I=0;I<this.Liste.GetNbrElements();I++){lService=this.Liste.GetElement(I);H.push(this.composeLigneService(aPourImpression,lService,I,aNumeroZone));}
H.push('</table>');return H.join('');};ObjetConseilDeClasse.prototype.ComposeGeneral=function(aPourImpression){var H=[];var lDefault={largeur:this.LargeurNote,pourImpression:aPourImpression,estMoyenneGenerale:true};if(this.Affichage.AvecMoyenneGenerale){H.push('<table id="'+this.GetIdGeneral()+'" style="'+GStyle.composeCouleurBordure(GCouleur.liste.getBordure(aPourImpression),1,EGenreBordure.droite)+'" class="'+this.taillePolice+'" border="0" cellpadding="0" cellspacing="0">');H.push('<tr>');H.push('<td class="Gras AlignementDroit" width="'+this.getLargeurGeneral()+'px"><div class="Gras Espace">',GTraductions.getValeur('ConseilClasse.moyGenerale'),'</div></td>');H.push(this.composeNote($.extend({},lDefault,{note:this.General.MoyenneClasse,visible:this.Affichage.AvecMoyenneClasse})));H.push('</tr>');H.push('</table>');}
return H.join('');};ObjetConseilDeClasse.prototype.getNombreSousServices=function(aService,aPourImpression){return aService.estService?(aPourImpression?aService.nbSousServicesActifs:aService.nbSousServicesTotal):0;};ObjetConseilDeClasse.prototype.estDernierAffiche=function(aService,aPourImpression){if(aService.estService){return aPourImpression?(aService.nbSousServicesActifs===0):(aService.nbSousServicesTotal===0);}
else return aPourImpression?aService.estDernierActif:aService.estDernier;};ObjetConseilDeClasse.prototype.composeLigneService=function(aPourImpression,aService,aLigne,aNumeroZone){var H=[];var lDefault={largeur:this.LargeurNote,avecGras:aService.estService,pourImpression:aPourImpression,estMoyenneGenerale:false};if(!aPourImpression||aService.Actif){if(aService.estService)
H.push(this.composeRegroupement({surMatiere:this.tableauSurMatieres[aService.regroupement],service:aService,numeroZone:aNumeroZone,pourImpression:aPourImpression}));H.push('<tr>');if(aNumeroZone===0){var lDansRegroupement=aService.regroupement;var lId=this.GetIdLigne(this.NombreLignes++);var lNbrLignes=!aService.avecAppreciationParSousService?aService.estService?this.getNombreSousServices(aService,aPourImpression)+1:0:1;var lBordBas=this.estDernierAffiche(aService,aPourImpression);H.push(this.composeService({service:aService,avecAlignementGauche:aService.estService,largeur:this.LargeurService,bordBas:lBordBas,bordRegroupement:lDansRegroupement,id:lId,actif:aService.Actif,pourImpression:aPourImpression,role:EGenreRole.Rowheader}));H.push(this.composeNote($.extend({},lDefault,{note:aService.VolumeHoraire ,visible:this.Affichage.AvecVolumeHoraire})));H.push(this.composeNote($.extend({},lDefault,{note:aService.Coefficient ,visible:this.Affichage.AvecCoefficient})));H.push(this.composeNote($.extend({},lDefault,{note:aService.NombreDevoirs ,visible:this.Affichage.AvecNombreDevoirs})));H.push(this.composeNote($.extend({},lDefault,{note:aService.MoyenneClasse,estMoyenneGenerale:true,visible:this.Affichage.AvecMoyenneClasse})));H.push(this.composeNote($.extend({},lDefault,{note:aService.MoyenneInf,visible:this.Affichage.AvecMoyenneInfSup})));H.push(this.composeNote($.extend({},lDefault,{note:aService.MoyenneSup,visible:this.Affichage.AvecMoyenneInfSup})));H.push(this.composeNote($.extend({},lDefault,{note:aService.NombreNotesEntre[0],visible:this.Affichage.AvecNombrePointsEntre})));H.push(this.composeNote($.extend({},lDefault,{note:aService.NombreNotesEntre[1],visible:this.Affichage.AvecNombrePointsEntre})));H.push(this.composeNote($.extend({},lDefault,{note:aService.NombreNotesEntre[2],visible:this.Affichage.AvecNombrePointsEntre})));var lLabelWAI=GTraductions.getValeur('ConseilClasse.matieres')+' '+aService.GetLibelle()+' ';lLabelWAI+=aService.Coefficient?GTraductions.getValeur('ConseilClasse.coeff')+' '+aService.Coefficient+' ':'';lLabelWAI+=aService.MoyenneClasse?GTraductions.getValeur('ConseilClasse.moyennes')+' '+aService.MoyenneClasse:'';for(var I=0;I<this.Affichage.NombreAppreciations;I++){var lLabelWAI_I=lLabelWAI+' '+this.Affichage.ListeIntitulesAppreciations.GetLibelle(I)+' '+aService.ListeAppreciations.GetLibelle(I)+' ';this.setOptions_ObjetBulletinEtReleve({labelWAI:lLabelWAI_I});H.push(this.composeAppreciation({pourImpression:aPourImpression,saisie:this.Saisie,libelle:GChaine.toTexte(aService.ListeAppreciations.GetLibelle(I)),largeur:this.LargeurAppreciation,rowspan:lNbrLignes,ligne:aLigne+1,col:I+1}));}}
H.push('</tr>');}
return H.join('');};ObjetConseilDeClasse.prototype.actualiser=function(){if(GEtatUtilisateur.estModeAccessible()){var lArbrePrincipal=this.AfficherListe();GHtml.setHtml(this.Nom,this._objetListeArborescente.ConstruireAffichage(this.heightPage-20));this._objetListeArborescente.SetDonnees(lArbrePrincipal,arguments);} else this.Afficher();};;

MethodesObjet.heritagePrototype(_PiedDeConseilDeClasse,_PiedBulletinReleve);function _PiedDeConseilDeClasse(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.donneesRecues=false;this.idOrientations=this.Nom+'_orientations';this.idMentions=this.Nom+'_mentions';this.idAbsences=this.Nom+'_absences';}
_PiedDeConseilDeClasse.prototype.SetParametresGeneraux=function(){this.GenreStructure=EStructureAffichage.Autre;};_PiedDeConseilDeClasse.prototype.ConstruireStructureAffichageAutre=function(){var H=[];H.push('<div id="'+this.idAbsences+'"></div>');H.push('<div id="'+this.GetInstance(this.identAppConseilDeClasse).GetNom()+'" class="EspaceBas"></div>');H.push('<div id="'+this.idMentions+'"></div>');H.push('<div id="'+this.idOrientations+'"></div>');return H.join('');};_PiedDeConseilDeClasse.prototype.ConstruireAffichage=function(){if(this.donneesRecues){this.actualiserDimensions();var lDebDiv='<div class="EspaceBas '+this.taillePolice+'">';var lFinDiv='</div>';var lHTML_Absences=this.composeAbsences();if(lHTML_Absences.length) GHtml.setHtml(this.idAbsences,lDebDiv+lHTML_Absences+lFinDiv);var LHTML_Mentions=this.composeMentions();if(LHTML_Mentions.length) GHtml.setHtml(this.idMentions,lDebDiv+LHTML_Mentions+lFinDiv);var LHTML_Orientations=this.composeOrientations();if(LHTML_Orientations.length) GHtml.setHtml(this.idOrientations,lDebDiv+LHTML_Orientations+lFinDiv);this.inherited('ConstruireAffichage');}};_PiedDeConseilDeClasse.prototype.composeOrientations=function(aPourImpression){var lTableauTitres=new Array(GTraductions.getValeur('PiedDeConseilDeClasse.1ereDemande'),GTraductions.getValeur('PiedDeConseilDeClasse.Favorable_Abbr'),GTraductions.getValeur('PiedDeConseilDeClasse.Reserve_Abbr'),GTraductions.getValeur('PiedDeConseilDeClasse.Defavorable_Abbr'),GTraductions.getValeur('PiedDeConseilDeClasse.TresFavorable_Abbr'));var lTableauHints=new Array('',GTraductions.getValeur('PiedDeConseilDeClasse.Favorable'),GTraductions.getValeur('PiedDeConseilDeClasse.Reserve'),GTraductions.getValeur('PiedDeConseilDeClasse.Defavorable'),GTraductions.getValeur('PiedDeConseilDeClasse.TresFavorable'));var lClassEtStyleTitre='class="Texte'+this.TailleTexte+' PetitEspace" style="'+GTableau.styleTitre(aPourImpression,true,EGenreBordure.bas+EGenreBordure.gauche)+'" ';var lClassEtStyleCellule='class="Gras Texte'+this.TailleTexte+' PetitEspace AlignementDroit" style="'+GTableau.styleCellule(aPourImpression,true,EGenreBordure.bas+EGenreBordure.gauche)+'" ';var H=[],J;if(this.PiedDePage.ListeOrientationsClasse&&this.PiedDePage.ListeOrientationsClasse.GetNbrElements()){H.push('<table class="Texte10" style="'+GTableau.styleTableau(aPourImpression,true,EGenreBordure.droite+EGenreBordure.haut)+'" border="0" cellspacing="0" cellpadding="0">');H.push('<tr>');for(J=0;J<=4;J++)
H.push('<td '+lClassEtStyleTitre+' title="'+lTableauHints[J]+'"><div style="width:'+(J===0?100:45)+'px;">'+lTableauTitres[J]+'</div></td>');H.push('</tr>');for(var I=0;I<this.PiedDePage.ListeOrientationsClasse.GetNbrElements();I++){var LElement=this.PiedDePage.ListeOrientationsClasse.GetElement(I);H.push('<tr>');H.push('<td '+lClassEtStyleTitre+'>'+LElement.GetLibelle()+'</td>');for(J=0;J<LElement.Nombre.length;J++)
H.push('<td '+lClassEtStyleCellule+'>'+LElement.Nombre[J]+'</td>');H.push('</tr>');}
H.push('</table>');}
return H.join('');};_PiedDeConseilDeClasse.prototype.composeMentions=function(aPourImpression){var H=[];if(this.PiedDePage.ListeMentionsClasse&&this.PiedDePage.ListeMentionsClasse.GetNbrElements()){H.push('<div style="display: inline;">'+GTraductions.getValeur('PiedDeConseilDeClasse.Mentions')+'&nbsp;:&nbsp;'+'</div>');var T=[];for(var I=0;I<this.PiedDePage.ListeMentionsClasse.GetNbrElements();I++){var LElement=this.PiedDePage.ListeMentionsClasse.GetElement(I);T.push(LElement.Nombre+'&nbsp;'+LElement.GetLibelle());}
H.push('<div style="display: inline;" class="Gras">',T.join(' - '),'</div>');}
return H.join('');};;
_PiedDeConseilDeClasse.prototype.AfficherListe=function(){this._objetListeArborescente=new ObjetListeArborescente(this.Nom+'_Liste',0,this,null);var lRacine=this._objetListeArborescente.construireRacine();this._objetListeArborescente.setParametres(false);var I,lLibelle,lElement;for(I=0;I<this.absences.length;I++)
this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lRacine,'',this.absences[I]);var lListe=this.PiedDePage.ListeAppreciations.general;lListe.setTri([ObjetTri.init('Genre')]);lListe.trier();for(I=0;I<lListe.GetNbrElements();I++){lElement=lListe.GetElement(I);if(lElement&&(lElement.ListeAppreciations.GetElement(0).GetLibelle()!=='')){lLibelle=GChaine.AvecEspaceSiVide(lElement.Intitule)+' : '+lElement.ListeAppreciations.GetElement(0).GetLibelle();this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lRacine,'',lLibelle);}}
lListe=this.PiedDePage.ListeMentionsClasse;if(lListe.GetNbrElements()){var lNoeudMentions=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lRacine,'',GTraductions.getValeur('PiedDeConseilDeClasse.Mentions'),null,false);lListe.setTri([ObjetTri.init('Genre')]);lListe.trier();for(I=0;I<lListe.GetNbrElements();I++){lElement=lListe.GetElement(I);if(lElement){lLibelle=lElement.GetLibelle()+' : '+lElement.Nombre[0];this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudMentions,'',lLibelle);}}}
return lRacine;};;

MethodesObjet.heritagePrototype(PiedDeConseilDeClasse,_PiedDeConseilDeClasse);function PiedDeConseilDeClasse(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);}
PiedDeConseilDeClasse.prototype.ConstruireInstances=function(){this.identAppConseilDeClasse=this.Add(window.ObjetApprPiedDeBulletin);};;
function ObjetRequetePageConseilDeClasse(aPere,aEvenementSurReussite,aEvenementSurEchec){this.inheritedCreate(aPere,aEvenementSurReussite,aEvenementSurEchec);}
IE.Requetes.inscrire('PageConseilDeClasse',ObjetRequetePageConseilDeClasse,_ObjetRequeteResultat);ObjetRequetePageConseilDeClasse.prototype.lancerRequete=function(aParam){var lParam={numeroEleve:new ObjetElement(),classe:new ObjetElement(),periode:new ObjetElement()};$.extend(lParam,aParam);var P=this.XML;P.CreerElement(null,'Eleve' ,lParam.eleve);P.CreerElement(null,'Periode',lParam.periode);P.CreerElement(null,'Classe' ,lParam.classe);this.appelAsynchroneConsultation();};ObjetRequetePageConseilDeClasse.prototype.actionApresRequete=function(aXml){var lParam={Message:null,date:null,aCopier:{},absences:{}};lParam.Message=aXml.GetVariable(null,'Message');if(!lParam.Message){lParam.aCopier.classe=aXml.GetElement(null,'Classe');lParam.date=aXml.GetVariable(null,'Date');this.CreerParametresAffichage(aXml);lParam.aCopier.Affichage=this.Affichage;this.CreerListeServices(aXml);lParam.aCopier.ServiceEditable=this.ServiceEditable;lParam.aCopier.ExisteDevoir=this.ExisteDevoir;lParam.aCopier.ExisteService=this.ExisteService;lParam.aCopier.NbrMaxServices=this.NbrMaxServices;lParam.aCopier.NbrMaxDevoirs=this.NbrMaxDevoirs;lParam.aCopier.tableauSurMatieres=this.tableauSurMatieres;lParam.aCopier.tableauDebutRegroupement=this.tableauDebutRegroupement;lParam.aCopier.ListeElements=this.ListeElements;this.CreerMoyenneGenerale(aXml);lParam.aCopier.MoyenneGenerale=this.MoyenneGenerale;lParam.aCopier.PiedDePage=new UtilitaireDeserialiserPiedBulletin().creerPiedDePage(aXml);$.extend(lParam.absences,new UtilitaireDeserialiserPiedBulletin().creerAbsences(aXml));}
this.callbackReussite.appel(lParam);};;
MethodesObjet.heritagePrototype(PageResultatConseilDeClasse,_PageResultatConseilDeClasse);function PageResultatConseilDeClasse(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.genreMessage=EGenreMessage.AucunConseilPourEleve;}
PageResultatConseilDeClasse.prototype.ConstruireInstances=function(){this.IdentCombo=this.Add(window.ObjetSaisiePN ,this.EvenementSurCombo,this.InitialiserCombo);this.IdentPage=this.Add(window.ObjetConseilDeClasse);this.identPied=this.Add(window.PiedDeConseilDeClasse);this.identBandeau=this.Add(window.ObjetBandeau ,null,this.InitialiserBandeau);};PageResultatConseilDeClasse.prototype.SetParametresGeneraux=function(){this.GenreStructure=EStructureAffichage.Autre;this.avecBandeau=true;this.AddSurZone=new Array('',this.IdentCombo,this.identBandeau);this.IdentZoneAlClient=this.IdentPage;};PageResultatConseilDeClasse.prototype.InitialiserCombo=function(aInstance){aInstance.setOptions_ObjetSaisie({labelWAIZone:GTraductions.getValeur('WAI.ListeSelectionPeriode'),roleWAIEdit:EGenreRole.Option});};PageResultatConseilDeClasse.prototype.InitialiserBandeau=function(AInstance){AInstance.SetParametres('');};PageResultatConseilDeClasse.prototype.EvenementSurCombo=function(aGenreEvenement,aElement){if(aGenreEvenement===EGenreEvenementObjetSaisie.selection){GEtatUtilisateur.Navigation.SetRessource(EGenreRessource.Periode,aElement);var lParam={eleve:GEtatUtilisateur.getMembre(),periode:aElement};new ObjetRequetePageConseilDeClasse(this,this.ActionSurRecupererBulletin).lancerRequete(lParam);}};;
MethodesObjet.heritagePrototype(ObjetSuiviPluriannuel,Identite);function ObjetSuiviPluriannuel(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.listeAnnees=new ObjetListeElements();this.listeMatieres=new ObjetListeElements();this.donneesRecues=false;this.couleursAnnees=new Array('#3399FF','#CCFFFF','#CC99FF','#CC6699','#660099','#99CC33','#CCFF99','#808000','#006633','#990033');this.couleurSeperateur='#666666';this.idTitre=this.Nom+'_Titre';this.idMoyGenerale=this.Nom+'_MoyGennerale';this.idGraphique=this.Nom+'_Graphique_';this.ScrollV=new ObjetScroll(this.Nom+'.ScrollV',null,this,this.GetScrollTop,EGenreScroll.Vertical);this.ajouterEvenementGlobal(EEvent.SurPreResize ,this.SurPreResize);this.ajouterEvenementGlobal(EEvent.SurPostResize,this.SurPostResize);}
ObjetSuiviPluriannuel.prototype.SetDonnees=function(aAvecMoyenneGenerale,aListeAnnees,aListeMatieres){this.avecMoyenneGenerale=aAvecMoyenneGenerale;this.listeAnnees=aListeAnnees;this.listeMatieres=aListeMatieres;this.donneesRecues=true;this.Afficher();this.ScrollV.SetDonnees(0);};ObjetSuiviPluriannuel.prototype.ConstruireAffichage=function(){if(this.donneesRecues)
return this.composePage();else return'';};ObjetSuiviPluriannuel.prototype.getCouleurAnnee=function(aAnnee){var indexeCouleur=(GDate.premiereDate.getFullYear()-aAnnee.Genre)%10;return(this.couleursAnnees[indexeCouleur]);};ObjetSuiviPluriannuel.prototype.composePage=function(){var lHtml=[];var J=0,lAnnee;if(this.listeAnnees){var nbrAnnees=this.listeAnnees.GetNbrElements();var lLargeurGraphique=50+(nbrAnnees*25);lHtml.push('<table id="',this.idTitre,'" class="Texte12 Titre Collapse" style="',GTableau.styleTableau(false,true,EGenreBordure.gauche+EGenreBordure.haut),'" border="0" cellpadding="0" cellspacing="0">');lHtml.push('<tr>');lHtml.push('<td rowspan="2" style="width: 200px;',GStyle.composeCouleurBordure(GCouleur.liste.titre.bordure,1,EGenreBordure.bas),'" class="AlignementDroit Gras">','<table class="Gras Collapse" style="width: 200px;height="100%;" border="0" cellpadding="0" cellspacing="0"><tr>','<td style="width: 100%;',GTableau.styleTitre(false,false),'">&nbsp;</td><td class="AlignementDroit AlignementMilieuVertical Gras" style="',GTableau.styleTitre(false,true,EGenreBordure.bas+EGenreBordure.droite),'">','<div class="PetitEspace">',GTraductions.getValeur('Annee'),'</div>','</td>','</tr><tr>','<td style="width: 100%; '+GTableau.styleTitre(false,false)+'">&nbsp;</td>','<td class="AlignementDroit AlignementMilieuVertical Gras" style="',GTableau.styleTitre(false,true,EGenreBordure.droite),'">','<div class="PetitEspace">',GTraductions.getValeur('Classe'),'</div>','</td>','</tr></table>','</td>');for(J=0;J<nbrAnnees;J++){lAnnee=this.listeAnnees.GetElement(J);var lCouleur=this.getCouleurAnnee(lAnnee);lHtml.push('<td width="100px" class="AlignementMilieu Gras" style="',GStyle.composeCouleur(lCouleur,GCouleur.getCouleurCorrespondance(lCouleur),GCouleur.liste.titre.bordure,1,EGenreBordure.bas+EGenreBordure.droite),'"><div class="PetitEspace">',lAnnee.GetGenre(),' - ',(lAnnee.GetGenre()+1),'</div></td>');}
lHtml.push('<td class="AlignementMilieu Gras" rowspan="2" style="width:',lLargeurGraphique,'px; ',GTableau.styleTitre(),'"><div style="width:',lLargeurGraphique,'px;">',GTraductions.getValeur('SuiviPluriannuel.Graphique'),'</div></td>');lHtml.push('</tr>');lHtml.push('<tr>');for(J=0;J<nbrAnnees;J++){lAnnee=this.listeAnnees.GetElement(J);lHtml.push('<td class="AlignementMilieu Gras" style="',GTableau.styleTitre(false,true,EGenreBordure.bas+EGenreBordure.droite),';"><div class="PetitEspace">',lAnnee.classe.GetLibelle(),'</div></td>');}
lHtml.push('</tr>');lHtml.push('</table>');lHtml.push('<table class="Collapse" border="0" cellspacing="0" cellpadding="0">','<tr><td>','<div id="',this.ScrollV.GetIdZone(),'" tabIndex="-1" style="height:1px;overflow:hidden;">','<table id="',this.ScrollV.GetIdContenu(),'" class="Texte10 Tableau Collapse" border="0" cellpadding="0" cellspacing="0">');for(var I=0;I<this.listeMatieres.GetNbrElements();I++){var lMatiere=this.listeMatieres.GetElement(I);if(lMatiere.listeAnnees.GetNbrElements()>0){lHtml.push('<tr>');lHtml.push(this.composeCelluleDonnees(this.Nom+'_LibelleMatiere_'+I,lMatiere.GetLibelle(),GTraductions.getValeur('SuiviPluriannuel.MoyClasse'),true));for(J=0;J<nbrAnnees;J++){lAnnee=lMatiere.listeAnnees.GetElementParGenre(this.listeAnnees.GetGenre(J));if(lAnnee){lHtml.push(this.composeCelluleDonnees(this.Nom+'_Donnees_'+I+'_Annee_'+J,lAnnee.moyenneEleve.getNote(),lAnnee.moyenneClasse.getNote()));} else{lHtml.push(this.composeCelluleDonnees(this.Nom+'_Donnees_'+I+'_Annee_'+J,'&nbsp;','&nbsp;'));}}
lHtml.push('<td style="width:',lLargeurGraphique,'px; height:100%;',GTableau.styleCellule(false,true,EGenreBordure.bas+EGenreBordure.droite),';">','<div id="',this.idGraphique,I,'" style="width:',lLargeurGraphique,'px;">','<table class="Table" border="0" cellspacing="0" cellpadding="0"><tr>','<td width="25px">','<table class="Table" border="0" cellspacing="0" cellpadding="0">','<tr>','<td width="50%">&nbsp;</td><td width="50%" height="25px" style="border-bottom:1px solid ',this.couleurSeperateur,'">&nbsp;</td>','</tr>','<tr>','<td>&nbsp;</td><td height="25px">&nbsp;</td>','</tr>','</table>','</td>');for(J=0;J<nbrAnnees;J++){lAnnee=lMatiere.listeAnnees.GetElementParGenre(this.listeAnnees.GetGenre(J));lHtml.push(this.composeAnnee(lAnnee));}
lHtml.push('<td width="25px">','<table class="Table" border="0" cellspacing="0" cellpadding="0">','<tr>','<td width="50%" height="25px" style="border-bottom:1px solid ',this.couleurSeperateur,'">&nbsp;</td><td width="50%">&nbsp;</td>','</tr>','<tr>','<td height="25px">&nbsp;</td><td>&nbsp;</td>','</tr>','</table>','</td>','</tr></table>','</div>','</td>');lHtml.push('</tr>');}}
lHtml.push('</table>','</div>','</td><td id="',this.ScrollV.GetIdScroll(),'" class="AlignementGauche">','</td></tr>','</table>');if(this.avecMoyenneGenerale){lHtml.push('<table id="',this.idMoyGenerale,'" class="Texte10" border="0" cellpadding="0" cellspacing="0">');lHtml.push('<tr>');lHtml.push(this.composeCelluleDonnees(this.idMoyGenerale+'_Libelle',GTraductions.getValeur('SuiviPluriannuel.MoyenneGenerale'),GTraductions.getValeur('SuiviPluriannuel.MoyClasse'),true,false,true));for(J=0;J<nbrAnnees;J++){lAnnee=this.listeAnnees.GetElement(J);lHtml.push(this.composeCelluleDonnees(this.idMoyGenerale+'_Annee_'+J,lAnnee.moyenneEleve.getNote(),lAnnee.moyenneClasse.getNote(),false,true,true));}
lHtml.push('<td style="width:',lLargeurGraphique,'px;',GTableau.styleTotal(false,true,EGenreBordure.bas+EGenreBordure.droite),'">','<div style="width:',lLargeurGraphique,'px;">','<table class="Table" border="0" cellspacing="0" cellpadding="0"><tr>','<td width="25px">','<table class="Table" border="0" cellspacing="0" cellpadding="0">','<tr>','<td width="50%">&nbsp;</td><td width="50%" height="25px" style="border-bottom:1px solid ',this.couleurSeperateur,'">&nbsp;</td>','</tr>','<tr>','<td>&nbsp;</td><td height="25px">&nbsp;</td>','</tr>','</table>','</td>');for(J=0;J<nbrAnnees;J++){lAnnee=this.listeAnnees.GetElement(J);lHtml.push(this.composeAnnee(lAnnee));}
lHtml.push('<td width="25px">','<table class="Table" border="0" cellspacing="0" cellpadding="0">','<tr>','<td width="50%" height="25px" style="border-bottom:1px solid ',this.couleurSeperateur,'">&nbsp;</td><td width="50%">&nbsp;</td>','</tr>','<tr>','<td height="25px">&nbsp;</td><td>&nbsp;</td>','</tr>','</table>','</td>','</tr></table>','</div>','</td>');lHtml.push('</tr>');lHtml.push('</table>');}}
return lHtml.join('');};ObjetSuiviPluriannuel.prototype.composeAnnee=function(aAnnee){var lHtml=[];var lHtGraph=26;var lDiff=IE.Support.bordureExterneDiv?0:1;if(aAnnee&&aAnnee.moyenneEleve.estUneValeur()){var lPourcentage=((aAnnee.moyenneEleve.getValeur()>10?20:10)-aAnnee.moyenneEleve.getValeur())/10;var lHauteurDiv1=Math.min(Math.max(Math.round(lHtGraph*lPourcentage),3),lHtGraph-2);var lHauteurDiv2=lHtGraph-lHauteurDiv1;var lContenuSup='&nbsp;';if(aAnnee.moyenneEleve.getValeur()>10){lContenuSup='';if(lHauteurDiv1>0)
lContenuSup+='<div style="height:'+(lHauteurDiv1-1)+'px;border-bottom:1px solid black;"></div>';if(lHauteurDiv2>0)
lContenuSup+='<div style="height:'+(lHauteurDiv2-lDiff)+'px;border-left:1px solid black;border-right:1px solid black;background-color:'+this.getCouleurAnnee(aAnnee)+';"></div>';}
var lContenuInf='';if(aAnnee.moyenneEleve.getValeur()>=10){lContenuInf+='<div style="height:'+(lHtGraph-lDiff)+'px;border-left:1px solid black;border-right:1px solid black;border-bottom:1px solid black;background-color:'+this.getCouleurAnnee(aAnnee)+';"></div>';} else{if(lHauteurDiv1>0)
lContenuInf+='<div style="height:'+(lHauteurDiv1-lDiff)+'px;border-bottom:1px solid black;"></div>';if(lHauteurDiv2>0)
lContenuInf+='<div style="height:'+(lHauteurDiv2-lDiff)+'px;border-left:1px solid black;border-right:1px solid black;border-bottom:1px solid black;background-color:'+this.getCouleurAnnee(aAnnee)+';"></div>';}
lHtml.push('<td width="25px">','<table class="Table" border="0" cellspacing="0" cellpadding="0">','<tr>','<td width="100%" height="25px" style="font-size:1px;border-bottom:1px solid ',this.couleurSeperateur,';">',lContenuSup,'</td>','</tr>','<tr>','<td height="25px" style="font-size:1px;">',lContenuInf,'</td>','</tr>','</table>','</td>');} else{lHtml.push('<td width="25px">','<table class="Table" border="0" cellspacing="0" cellpadding="0">','<tr>','<td width="100%" height="25px" style="border-bottom:1px solid ',this.couleurSeperateur,';">&nbsp;</td>','</tr>','<tr>','<td height="25px">&nbsp;</td>','</tr>','</table>','</td>');}
return lHtml.join('');};ObjetSuiviPluriannuel.prototype.composeCelluleDonnees=function(aId,aLibelle1,aLibelle2,aTitre,aMoyenne,aTotal){var lHtml=[];var lStyleCellule;if(aTotal)
lStyleCellule=GTableau.styleTotal(false,true,aMoyenne?EGenreBordure.bas+EGenreBordure.droite:EGenreBordure.bas+EGenreBordure.droite+EGenreBordure.gauche);else if(aTitre)
lStyleCellule=GTableau.styleColonneFixe(false,true,EGenreBordure.bas+EGenreBordure.droite+EGenreBordure.gauche);else if(aMoyenne)
lStyleCellule=GTableau.styleMoyenne(false,true,EGenreBordure.bas+EGenreBordure.droite);else lStyleCellule=GTableau.styleCellule(false,true,EGenreBordure.bas+EGenreBordure.droite);lHtml.push('<td id="',aId,'" style="height:50px; width:',aTitre?200-1:100,'px; '+lStyleCellule+'">','<div class="',aTitre?'AlignementGauche':'AlignementMilieu',' AlignementHaut Gras PetitEspace" style="height: 30px; margin-top: 3px;">',aLibelle1,'</div>','<div class="',aTitre?'AlignementDroit':'AlignementMilieu',' AlignementBas PetitEspace" style="height: 15px;">',aLibelle2,'</div>','</td>');return lHtml.join('');};ObjetSuiviPluriannuel.prototype.GetScrollTop=function(aGenre,aScrollTop){var lHauteur=0;for(var I=0;(I<this.listeMatieres.GetNbrElements())&&(lHauteur===0);I++){lHauteur=GPosition.getHeight(this.Nom+'_LibelleMatiere_'+I);}
if(aGenre===EGenreScrollEvenement.TailleZone)
aScrollTop=Math.min(GPosition.getHeight(this.Nom)-GPosition.getHeight(this.idTitre)-GPosition.getHeight(this.idMoyGenerale),GPosition.getHeight(this.ScrollV.GetIdContenu()));if(lHauteur!==0&&GNavigateur.IsWebKit)
lHauteur=lHauteur+1;switch(aGenre){case EGenreScrollEvenement.Deplacement:return(lHauteur===0)?aScrollTop:lHauteur*Math.round(aScrollTop/lHauteur);case EGenreScrollEvenement.TailleZone:return(lHauteur===0)?aScrollTop:lHauteur*Math.floor(aScrollTop/lHauteur);case EGenreScrollEvenement.TailleContenu:return null;}};ObjetSuiviPluriannuel.prototype.SurPreResize=function(){if(this.ScrollV) this.ScrollV.Vider();this.Afficher('&nbsp;');};ObjetSuiviPluriannuel.prototype.SurPostResize=function(){this.Afficher();this.ScrollV.SetDonnees(0);};;
MethodesObjet.heritagePrototype(_ObjetAffichagePageSuiviPluriannuel,ObjetInterfacePage);function _ObjetAffichagePageSuiviPluriannuel(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);}
_ObjetAffichagePageSuiviPluriannuel.prototype.ConstruireInstances=function(){this.identPage=this.Add(window.ObjetSuiviPluriannuel);};_ObjetAffichagePageSuiviPluriannuel.prototype.SetParametresGeneraux=function(){this.IdentZoneAlClient=this.identPage;this.avecBandeau=true;};_ObjetAffichagePageSuiviPluriannuel.prototype.actionSurRecupererDonnees=function(aParam){if(aParam.message)
this.EvenementAfficherMessage(aParam.message);else{if(GEtatUtilisateur.estModeAccessible()){this.AfficherListe(aParam);} else{this.GetInstance(this.identPage).SetDonnees(aParam.avecMoyenneGenerale,aParam.listeAnnees,aParam.listeMatieres);}}};;
_ObjetAffichagePageSuiviPluriannuel.prototype.AfficherListe=function(aParam){var lNom=this.Nom+'_SuiviPluriannuel';this._objetListeArborescente=new ObjetListeArborescente(lNom,0,this,null);var lRacine=this._objetListeArborescente.construireRacine();this._objetListeArborescente.setParametres(false);var LLibelle='';var lID,lNoeudMatiere,lNoeudAnnee,lElement,lAnnee;if(!$.isEmptyObject(aParam.listeAnnees)){var lDonnees=aParam.listeMatieres;var lNoeudSuivi=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lRacine,lNom+'_Liste',GTraductions.getValeur('Onglet.Libelle')[EGenreOnglet.SuiviPluriannuel],'Gras',true);for(var i=0;i<lDonnees.GetNbrElements();i++){lElement=lDonnees.GetElement(i);if(lElement.listeAnnees.GetNbrElements()>0){LLibelle=lElement.GetLibelle();lID=lNom+'_mat_'+i;lNoeudMatiere=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lNoeudSuivi,lID,LLibelle,'Gras',false);for(var j=0;j<lElement.listeAnnees.GetNbrElements();j++){var lDonnee=lElement.listeAnnees.GetElement(j);lAnnee=aParam.listeAnnees.GetElementParGenre(lDonnee.GetGenre());LLibelle=lAnnee.GetGenre()+' - '+(lAnnee.GetGenre()+1)+' ('+lAnnee.classe.GetLibelle()+')';lNoeudAnnee=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lNoeudMatiere,lID+'_annee_'+j,LLibelle,'',true);this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudAnnee,'',GTraductions.getValeur('Moyenne')+' : '+lDonnee.moyenneEleve.getNote());this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudAnnee,'',GTraductions.getValeur('accueil.moyenneClasse')+' : '+lDonnee.moyenneClasse.getNote());}}}
if(aParam.avecMoyenneGenerale){LLibelle=GTraductions.getValeur('MoyenneGenerale');lID=lNom+'_moyGenerale';lNoeudMatiere=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lNoeudSuivi,lID,LLibelle,'Gras',false);for(var k=0;k<aParam.listeAnnees.GetNbrElements();k++){lAnnee=aParam.listeAnnees.GetElement(k);LLibelle=lAnnee.GetGenre()+' - '+(lAnnee.GetGenre()+1)+' ('+lAnnee.classe.GetLibelle()+')';lNoeudAnnee=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lNoeudMatiere,lID+'_annee_'+k,LLibelle,'',true);this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudAnnee,'',GTraductions.getValeur('Moyenne')+' : '+lAnnee.moyenneEleve.getNote());this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudAnnee,'',GTraductions.getValeur('accueil.moyenneClasse')+' : '+lAnnee.moyenneClasse.getNote());}}} else this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lRacine,this.Nom+'_Message',GTraductions.getValeur('AucuneDonneeSuiviPluriAnnuel'),"Gras MargeHaut AlignementMilieu");GHtml.setHtml(this.GetNomInstance(this.identPage),this._objetListeArborescente.ConstruireAffichage());this._objetListeArborescente.SetDonnees(lRacine);};;
function ObjetRequetePageSuiviPluriannuel(aPere,aEvenementSurReussite,aEvenementSurEchec){this.inheritedCreate(aPere,aEvenementSurReussite,aEvenementSurEchec);}
IE.Requetes.inscrire('PageSuiviPluriannuel',ObjetRequetePageSuiviPluriannuel,_ObjetRequeteXmlConsultationPN);ObjetRequetePageSuiviPluriannuel.prototype.lancerRequete=function(aNumeroEleve){this.JSON.eleve=new ObjetElement(null,aNumeroEleve);this.appelAsynchroneConsultation();};ObjetRequetePageSuiviPluriannuel.prototype.actionApresRequete=function(aXml){var lParam={message:this.JSONReponse.Message};if(!lParam.message){lParam.avecMoyenneGenerale=this.JSONReponse.AvecMoyenneGenerale;lParam.listeAnnees=this.JSONReponse.listeAnnees;lParam.listeAnnees.parcourir(function(D){D.moyenneEleve=0;D.moyenneClasse=0;D.nbrMoyennes=0;D.nbrMoyennesClasse=0;});lParam.listeAnnees.setTri([ObjetTri.init('Genre')]);lParam.listeAnnees.trier();this.listeAnnees=lParam.listeAnnees;lParam.listeMatieres=this.JSONReponse.listeMatieres;var self=this;lParam.listeMatieres.parcourir(function(aMatiere){var lTableauAnnees=aMatiere.tableauAnnees,i;aMatiere.listeAnnees=new ObjetListeElements();for(i=0;i<lTableauAnnees.length;i++){self.ajouterMatiere_Annee(lTableauAnnees[i],aMatiere.listeAnnees);}
aMatiere.listeAnnees.setTri([ObjetTri.init('Genre')]);aMatiere.listeAnnees.trier();});lParam.listeMatieres.trier();for(var I=0;I<this.listeAnnees.GetNbrElements();I++){var lAnnee=this.listeAnnees.GetElement(I);lAnnee.moyenneEleve=lAnnee.nbrMoyennes?new TypeNote(new TypeArrondi(0).arrondir(lAnnee.moyenneEleve/lAnnee.nbrMoyennes)):new TypeNote('');lAnnee.moyenneClasse=lAnnee.nbrMoyennesClasse?new TypeNote(new TypeArrondi(0).arrondir(lAnnee.moyenneClasse/lAnnee.nbrMoyennesClasse)):new TypeNote('');}}
this.callbackReussite.appel(lParam);};ObjetRequetePageSuiviPluriannuel.prototype.ajouterMatiere_Annee=function(aJSON,aListe){var lElement=new ObjetElement().fromJSON(aJSON);lElement.moyenneEleve=aJSON.moyenneEleve;lElement.moyenneClasse=aJSON.moyenneClasse;if((lElement.moyenneEleve&&lElement.moyenneEleve.estUneValeur())||(lElement.moyenneClasse&&lElement.moyenneClasse.estUneValeur()))
aListe.AddElement(lElement);var lAnnee=this.listeAnnees.GetElementParGenre(lElement.GetGenre());if(lElement.moyenneEleve&&lElement.moyenneEleve.estUneValeur()){lAnnee.moyenneEleve+=lElement.moyenneEleve.getValeur();lAnnee.nbrMoyennes++;}
if(lElement.moyenneClasse&&lElement.moyenneClasse.estUneValeur()){lAnnee.moyenneClasse+=lElement.moyenneClasse.getValeur();lAnnee.nbrMoyennesClasse++;}};;
MethodesObjet.heritagePrototype(ObjetAffichagePageSuiviPluriannuel,_ObjetAffichagePageSuiviPluriannuel);function ObjetAffichagePageSuiviPluriannuel(ANom,AIdent,APere,AEvenement){this.inheritedCreate(ANom,AIdent,APere,AEvenement);}
ObjetAffichagePageSuiviPluriannuel.prototype.RecupererDonnees=function(){new ObjetRequetePageSuiviPluriannuel(this,this.actionSurRecupererDonnees).lancerRequete(GEtatUtilisateur.GetNumeroEleve());};;
MethodesObjet.heritagePrototype(_ObjetAffichagePageCompetences,ObjetInterfacePage);function _ObjetAffichagePageCompetences(ANom,AIdent,APere,AEvenement){this.inheritedCreate(ANom,AIdent,APere,AEvenement);}
_ObjetAffichagePageCompetences.prototype.actionSurAfficherPage=function(aParametres){this.SetEtatSaisie(false);var lParametres={message:null,autorisations:null,pilier:null,listeEleves:null,listeNiveauxDAcquisitions:null,multiSelection:null,genreNotation:null};$.extend(lParametres,aParametres);if(lParametres.message)
this.EvenementAfficherMessage(lParametres.message);else{this.pilier=lParametres.pilier;this.listeEleves=lParametres.listeEleves;this.listeNiveauxDAcquisitions=lParametres.listeNiveauxDAcquisitions;this.eleve=this.listeEleves.GetElement(0);this.parametres=this.getParametres();var lInstancePage=this.GetInstance(this.identPage);if(!this.eleve.existeNumero()){var lEleveMulti=GEtatUtilisateur.getOngletListeEleves(false)&&GEtatUtilisateur.getOngletListeEleves(false).GetElementParElement(this.eleve);if(lEleveMulti){this.eleve.multiSelection=true;this.eleve.listeSelection=lEleveMulti.listeSelection;}}
if(this.GetInstance(this.identLanguePourBrevet)){this.GetInstance(this.identLanguePourBrevet).SetActif(lParametres.autorisations.avecSaisieCompetences||(MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Parent])&&!this.eleve.languePourBrevet));this.GetInstance(this.identLanguePourBrevet).setVisible(this.pilier.avecChoixLangueBrevet&&lParametres.autorisations.avecChoixLVE);this.GetInstance(this.identLanguePourBrevet).SetSelection(this.eleve.languePourBrevet);}
if(lInstancePage){if(GEtatUtilisateur.estModeAccessible())
this.AfficherListe(lInstancePage.GetNom());else{lInstancePage.setTraductions(GTraductions.getValeur('competences'));lInstancePage.setParametres(this.parametres);lInstancePage.SetDonnees(lParametres.autorisations,lParametres.pilier,this.listeEleves,this.listeNiveauxDAcquisitions,GEtatUtilisateur.GenreEspace===EGenreEspace.Professeur?GEtatUtilisateur.GetNumeroRessource():null,lParametres.genreNotation);}}
window.Invocateur.evenement(window.Invocateur.events.activationImpression,lParametres.multiSelection?EGenreImpression.Aucune:EGenreImpression.Normale,this);}};_ObjetAffichagePageCompetences.prototype.getParametres=function(){var lParametres=GEtatUtilisateur.getParametres();if(!lParametres){lParametres={afficherDates:false,afficherEvaluationsHistoriques:true,ordreEvaluations:EGenreTriElement.Decroissant,afficherPourcentageAcquis:true};GEtatUtilisateur.setParametres(lParametres);}
return lParametres;};_ObjetAffichagePageCompetences.prototype.initialiserLanguePourBrevet=function(aInstance){var lListeElements=new ObjetListeElements();lListeElements.AddElement(new ObjetElement(GTraductions.getValeur('competences.choixValidationLVEPalier')));aInstance.setOptions_ObjetCheckBox({liste:lListeElements,Selection:new TypeDomaine(false,2)});aInstance.setParametres_Affichage('Gras',GStyle.composeCouleurTexte(GCouleur.blanc));};_ObjetAffichagePageCompetences.prototype.surEditionLanguePourBrevet=function(aSelection){var lLanguePourBrevet=aSelection.GetValeur(1);if(this.eleve.languePourBrevet!==lLanguePourBrevet){if(this.eleve.languePourBrevet&&!MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Parent])){GApplication.getMessage().Afficher(EGenreBoiteMessage.Confirmation,null,this.getMessageEditionLanguePourBrevet()+'\n'+GTraductions.getValeur('competences.message.confirmation'),null,this,this.surMessageEditionLanguePourBrevet);}
else this.surMessageEditionLanguePourBrevet(EGenreAction.Valider);}};_ObjetAffichagePageCompetences.prototype.getMessageEditionLanguePourBrevet=function(){if(this.pilier.palier.estDeNiveauEcole)
return GTraductions.getValeur('competences.message.choixLVEAnnulePalier2');if(this.pilier.palier.estDeNiveauCollege)
return GTraductions.getValeur('competences.message.choixLVEAnnulePalier3');return GTraductions.getValeur('competences.message.choixLVEAnnuleAutresPaliers');};_ObjetAffichagePageCompetences.prototype.surMessageEditionLanguePourBrevet=function(aGenreAction){if(aGenreAction===EGenreAction.Valider){this.SetEtatSaisie(true);this.eleve.SetEtat(EGenreEtat.Modification);this.eleve.languePourBrevet=!this.eleve.languePourBrevet;} else{this.GetInstance(this.identLanguePourBrevet).SetSelection(this.eleve.languePourBrevet);}};_ObjetAffichagePageCompetences.prototype.Valider=function(){new ObjetRequeteSaisieCompetences(this,this.ActionSurValidation).lancerRequete(this.pilier,GEtatUtilisateur.getServiceDePilier(),this.listeEleves);};_ObjetAffichagePageCompetences.prototype.GetPageImpression=function(aFormat){return{titre1:this.Pere.getLibelleSousOnglet(this.pilier.GetLibelle()+' ('+this.pilier.palier.GetLibelle()+')',true,false,false,true),contenu:GEtatUtilisateur.estModeAccessible()?this._objetListeArborescente.GetListeArborescente().outerHTML:this.GetInstance(this.identPage).composeImpression(aFormat)};};;
_ObjetAffichagePageCompetences.prototype.AfficherListe=function(aNom){this._objetListeArborescente=new ObjetListeArborescente(aNom+'_Liste',0,this,null);var lRacine=this._objetListeArborescente.construireRacine();this._objetListeArborescente.setParametres(false);var lNoeudCourant,lNoeudPrevPilier,lNoeudPrevCompetence;var lEleve=this.listeEleves.GetElement(0);if(lEleve){var lTitre=this.pilier.libelleComplet;if(lEleve.niveauDAcquisition)
lTitre+=' : '+lEleve.niveauDAcquisition.GetLibelle()+(lEleve.date?" "+GTraductions.getValeur('Le')+" "+GDate.FormatDate(lEleve.date,'%JJ/%MM/%AAAA'):'');var lNoeudTitre=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lRacine,'',lTitre,'Gras',true,true);for(var I=0;I<lEleve.listeCompetences.GetNbrElements();I++){var lCompetence=lEleve.listeCompetences.GetElement(I);switch(lCompetence.GetGenre()){case EGenreRessource.ElementPilier:lNoeudCourant=lNoeudTitre;break;case EGenreRessource.Competence:lNoeudCourant=lNoeudPrevPilier;break;case EGenreRessource.SousItem:lNoeudCourant=lNoeudPrevCompetence;break;default:break;}
var lNoeudCompetence=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lNoeudCourant,'',lCompetence.GetLibelle(),'Gras');switch(lCompetence.GetGenre()){case EGenreRessource.ElementPilier:lNoeudPrevPilier=lNoeudCompetence;break;case EGenreRessource.Competence:lNoeudPrevCompetence=lNoeudCompetence;break;default:break;}
if(lCompetence.nombreFils>0&&MethodesTableau.existe(lCompetence.GetGenre(),[EGenreRessource.ElementPilier,EGenreRessource.Competence,EGenreRessource.SousItem]))
lNoeudCourant=lNoeudCompetence;var lEvaluation=lCompetence.niveauDAcquisition?lCompetence.niveauDAcquisition.GetLibelle()+(lCompetence.date?" "+GTraductions.getValeur('Le')+" "+GDate.FormatDate(lCompetence.date,'%JJ/%MM/%AAAA'):''):'';if(lEvaluation)
this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudCompetence,'',lEvaluation);}}
GHtml.setHtml(aNom,this._objetListeArborescente.ConstruireAffichage());this._objetListeArborescente.SetDonnees(lRacine);};;
MethodesObjet.heritagePrototype(_ObjetCompetences,Identite);function _ObjetCompetences(ANom,AIdent,APere,AEvenement){this.inheritedCreate(ANom,AIdent,APere,AEvenement);this.actif=true;this.tableauLignes=[];this.boutonValidationAuto=new ObjetBoutonBandeau(this._getNomBoutonValidationAuto(),null,this,this.surBoutonValidationAuto);}
_ObjetCompetences.prototype.setActif=function(aActif){this.actif=aActif;};_ObjetCompetences.prototype._getNomBoutonValidationAuto=function(){return this.Nom+'.boutonValidationAuto';};_ObjetCompetences.prototype._initialiserBoutonValidationAuto=function(){this.boutonValidationAuto.SetParametres('Image_CompetencesValidationAuto',true,false,true,['',GTraductions.getValeur('competences.title.validationAuto'),''],18,false);};_ObjetCompetences.prototype.surBoutonValidationAuto=function(){var lPourB2I=this.pilier.pourB2I&&this.pilier.avecSousItems&&this.pilier.pourB2IBO;if(lPourB2I)
GApplication.getMessage().Afficher(EGenreBoiteMessage.Confirmation,GTraductions.getValeur('competences.titre.validationB2IAuto'),GTraductions.getValeur('competences.message.validationB2IAuto'),null,this,this.surConfirmationValidationAuto);else GApplication.getMessage().Afficher(EGenreBoiteMessage.Confirmation,GTraductions.getValeur('competences.titre.validationAuto') ,GTraductions.getValeur('competences.message.validationAuto') ,null,this,this.surConfirmationValidationAuto);};_ObjetCompetences.prototype.getMessage=function(aEleve,aCompetence,aCompetenceColonne){if(MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Professeur,EGenreEspace.Etablissement])){if(aCompetenceColonne&&(aCompetenceColonne.GetGenre()===EGenreRessource.EvaluationHistorique))
return GTraductions.getValeur('competences.ImpossibleModifierEvaluationHistorique');if(aCompetence&&(aCompetence.GetGenre()===EGenreRessource.EvaluationHistorique))
return GTraductions.getValeur('competences.ImpossibleModifierEvaluationHistorique');if(aEleve.estSortiDeLEtablissement)
return GTraductions.getValeur('competences.EleveHorsEtablissement');if(aEleve.estSortiDeLaClasse||!aCompetence)
return GEtatUtilisateur.Navigation.GetGenreRessource(EGenreRessource.Classe)===EGenreRessource.Classe?GTraductions.getValeur('competences.EleveHorsClasse'):GTraductions.getValeur('competences.EleveHorsGroupe');if(aEleve.estSansLangueSocleCommun)
return GTraductions.getValeur('competences.AucuneLangue');if(aCompetence.estAnneePrecedente)
return GTraductions.getValeur('competences.CompetenceAcquiseAnneePrecedente');return GTraductions.getValeur('SaisieImpossible');}};_ObjetCompetences.prototype._getNiveauDAcquisition=function(aNiveauDAcquisition,aPourImpression){var lNiveauDAcquisition=this.listeNiveauxDAcquisitions.GetElementParNumero(aNiveauDAcquisition.GetNumero());return lNiveauDAcquisition?EGenreNiveauDAcquisition.getImage(lNiveauDAcquisition,true,aPourImpression):'';};_ObjetCompetences.prototype.getNiveauDAcquisition=function(aElement,aPourImpression){if(aElement&&aElement.niveauDAcquisition&&(aElement.niveauDAcquisition.GetGenre()===EGenreNiveauDAcquisition.Multiple))
return GTraductions.getValeur('Multiple');if(this.parametres&&this.parametres.afficherDates)
return aElement&&aElement.niveauDAcquisition&&EGenreNiveauDAcquisition.estAcquis(aElement.niveauDAcquisition.GetGenre())?GDate.FormatDate(aElement.date,'%JJ/%MM/%AAAA'):'';else return aElement?this._getNiveauDAcquisition(aElement.niveauDAcquisition,aPourImpression):'';};_ObjetCompetences.prototype.getTitleNiveauDAcquisition=function(aElement,aAvecObservation){if(!aElement)
return;var lTitle=aElement.niveauDAcquisition?aElement.niveauDAcquisition.GetLibelle()+(this.avecDate(aElement)&&!aElement.dateMultiple?' '+GTraductions.getValeur('Le').toLowerCase()+' '+GDate.FormatDate(aElement.date,'%JJ/%MM/%AAAA'):''):'';if(aAvecObservation&&aElement.observation&&(GEtatUtilisateur.GenreEspace===EGenreEspace.Professeur))
lTitle+=(GNavigateur.accepteRetourChariotHint()?'\n':' - ')+aElement.observation;return GChaine.toTitle(lTitle);};_ObjetCompetences.prototype.avecDate=function(aCompetence){return aCompetence.niveauDAcquisition&&EGenreNiveauDAcquisition.estAcquis(aCompetence.niveauDAcquisition.GetGenre())&&(aCompetence.GetGenre()!==EGenreRessource.Evaluation)&&(aCompetence.GetGenre()!==EGenreRessource.EvaluationHistorique);};_ObjetCompetences.prototype.actualiserSelection=function(aSelectionner){if(this.selection.modeCellule){this.actualiserCellules(aSelectionner);this.actualiserLignes(aSelectionner);} else{this.actualiserLignes(aSelectionner);this.actualiserColonnes(aSelectionner);}};_ObjetCompetences.prototype.viderCellules=function(aNbrLignes,aNbrColonnes){if(aNbrLignes&&aNbrColonnes){this.selection.nbrLignes=aNbrLignes;this.selection.nbrColonnes=aNbrColonnes;}
this.selection.multiSelectionLigne=[];this.selection.multiSelectionColonne=[];this.selection.cellules=new Array(this.selection.nbrLignes);for(var I=0;I<this.selection.nbrLignes;I++)
this.selection.cellules[I]=new Array(this.selection.nbrColonnes);};_ObjetCompetences.prototype.actualiserCellules=function(aSelectionner){if(this.selection.cellules)
for(var lNumLigne=0;lNumLigne<this.nbrLignes;lNumLigne++)
for(var lNumColonne=1;lNumColonne<=this.nbrCompetences+(this.modeAffichage===this.EModeAffichage.ElementPilier||this.modeAffichage===this.EModeAffichage.EvaluationEtCompetence?1:0);lNumColonne++)
this._selectionnerCellule(lNumLigne,lNumColonne,this.selection.cellules[lNumLigne][lNumColonne]||false);};_ObjetCompetences.prototype.actualiserLignes=function(aSelectionner){for(var lPosition in this.selection.multiSelectionLigne)
this._selectionnerLigne(lPosition,aSelectionner);};_ObjetCompetences.prototype.actualiserColonnes=function(aSelectionner){for(var lNumColonne in this.selection.multiSelectionColonne)
this._selectionnerColonne(lNumColonne,aSelectionner);};_ObjetCompetences.prototype.estCelluleSelectionne=function(aNumLigne,aNumColonne){if(((aNumLigne!==null&&aNumLigne!==undefined))&&((aNumColonne!==null&&aNumColonne!==undefined))&&this.selection.cellules[aNumLigne][aNumColonne])
return true;if(((aNumLigne!==null&&aNumLigne!==undefined))&&this.selection.multiSelectionLigne[aNumLigne])
return true;if(((aNumColonne!==null&&aNumColonne!==undefined))&&this.selection.multiSelectionColonne[aNumColonne])
return true;};_ObjetCompetences.prototype.surSelectionCellule=function(e,aNumLigne,aNumColonne){this.actualiserSelection(false);if(!(GNavigateur.isCtrlTouche(e)||(GNavigateur.estSourisBoutonDroit()&&this.estCelluleSelectionne(aNumLigne,aNumColonne))))
this.viderCellules();if(GNavigateur.isCtrlTouche(e))
this.selection.cellules[aNumLigne][aNumColonne]=!this.selection.cellules[aNumLigne][aNumColonne];else this.selection.cellules[aNumLigne][aNumColonne]=true;this.actualiserSelection(true);};_ObjetCompetences.prototype.surSelectionLigne=function(e,aNumLigne){this.actualiserSelection(false);if(!(GNavigateur.isCtrlTouche(e)||(GNavigateur.estSourisBoutonDroit()&&this.estCelluleSelectionne(aNumLigne,null))))
this.viderCellules();this.selection.debSelectionLigne=aNumLigne;this.selection.finSelectionLigne=aNumLigne;var lPosition;if(GNavigateur.estSourisBoutonGauche()){if(GNavigateur.isShiftTouche(e)){for(lPosition=this.selection.debSelectionLigne;lPosition<=this.selection.finSelectionLigne;lPosition++)
this.selection.multiSelectionLigne[lPosition]=false;if(this.selection.numLigne===null||this.selection.numLigne===undefined)
this.selection.numLigne=aNumLigne;this.selection.debSelectionLigne=Math.min(aNumLigne,this.selection.numLigne);this.selection.finSelectionLigne=Math.max(aNumLigne,this.selection.numLigne);for(lPosition=this.selection.debSelectionLigne;lPosition<=this.selection.finSelectionLigne;lPosition++)
this.selection.multiSelectionLigne[lPosition]=true;} else if(GNavigateur.isCtrlTouche(e)){this.selection.multiSelectionLigne[aNumLigne]=!this.selection.multiSelectionLigne[aNumLigne];} else{for(lPosition in this.selection.multiSelectionLigne)
this.selection.multiSelectionLigne[lPosition]=false;this.selection.multiSelectionLigne[aNumLigne]=!this.selection.multiSelectionLigne[aNumLigne];}} else{if(!this.selection.multiSelectionLigne[aNumLigne])
for(lPosition in this.selection.multiSelectionLigne)
this.selection.multiSelectionLigne[lPosition]=false;this.selection.multiSelectionLigne[aNumLigne]=true;}
if(!GNavigateur.isShiftTouche(e)||(this.selection.numLigne===null||this.selection.numLigne===undefined)){this.selection.numLigne=aNumLigne;this.selection.competence=this.tableauLignes[aNumLigne];}
var lMultiSelectionLigne=[];for(lPosition in this.selection.multiSelectionLigne)
if(this.selection.multiSelectionLigne[lPosition])
lMultiSelectionLigne[lPosition]=true;this.selection.multiSelectionLigne=lMultiSelectionLigne;for(var lNumLigne=this.selection.debSelectionLigne;lNumLigne<=this.selection.finSelectionLigne;lNumLigne++)
for(var lNumColonne=0;lNumColonne<this.selection.nbrColonnes;lNumColonne++){this.selection.cellules[lNumLigne][lNumColonne]=lMultiSelectionLigne[lNumLigne];}
this.actualiserSelection(true);};_ObjetCompetences.prototype.getNbrLignes=function(){var N=0;for(var lNumLigne in this.selection.multiSelectionLigne)
N++;return N;};_ObjetCompetences.prototype.surSelectionColonne=function(e,aNumColonne){this.actualiserSelection(false);if(!(GNavigateur.isCtrlTouche(e)||(GNavigateur.estSourisBoutonDroit()&&this.estCelluleSelectionne(null,aNumColonne))))
this.viderCellules();this.selection.debSelectionColonne=aNumColonne;this.selection.finSelectionColonne=aNumColonne;var lNumColonne;if(GNavigateur.estSourisBoutonGauche()){if(GNavigateur.isShiftTouche(e)){for(lNumColonne=this.selection.debSelectionColonne;lNumColonne<=this.selection.finSelectionColonne;lNumColonne++)
this.selection.multiSelectionColonne[lNumColonne]=false;if(this.selection.numColonne===null||this.selection.numColonne===undefined)
this.selection.numColonne=aNumColonne;this.selection.debSelectionColonne=Math.min(aNumColonne,this.selection.numColonne);this.selection.finSelectionColonne=Math.max(aNumColonne,this.selection.numColonne);for(lNumColonne=this.selection.debSelectionColonne;lNumColonne<=this.selection.finSelectionColonne;lNumColonne++)
this.selection.multiSelectionColonne[lNumColonne]=true;} else if(GNavigateur.isCtrlTouche(e)){this.selection.multiSelectionColonne[aNumColonne]=!this.selection.multiSelectionColonne[aNumColonne];} else{for(lNumColonne in this.selection.multiSelectionColonne)
this.selection.multiSelectionColonne[lNumColonne]=false;this.selection.multiSelectionColonne[aNumColonne]=!this.selection.multiSelectionColonne[aNumColonne];}} else{if(!this.selection.multiSelectionColonne[aNumColonne])
for(lNumColonne in this.selection.multiSelectionColonne)
this.selection.multiSelectionColonne[lNumColonne]=false;this.selection.multiSelectionColonne[aNumColonne]=true;}
if(!GNavigateur.isShiftTouche(e)||(this.selection.numColonne===null||this.selection.numColonne===undefined)){this.selection.numColonne=aNumColonne;}
var lMultiSelectionColonne=[];for(var lPosition in this.selection.multiSelectionColonne)
if(this.selection.multiSelectionColonne[lPosition])
lMultiSelectionColonne[lPosition]=true;this.selection.multiSelectionColonne=lMultiSelectionColonne;for(var lNumLigne=0;lNumLigne<this.selection.nbrLignes;lNumLigne++)
for(lNumColonne=this.selection.debSelectionColonne;lNumColonne<=this.selection.finSelectionColonne;lNumColonne++)
this.selection.cellules[lNumLigne][lNumColonne]=lMultiSelectionColonne[lNumColonne];this.actualiserSelection(true);};_ObjetCompetences.prototype.getNbrColonnes=function(){var N=0;for(var lNumColonne in this.selection.multiSelectionColonne)
N++;return N;};;
var EGenreChoixValidationCompetence={Evaluation:0,Item:1,Competence:2};EGenreChoixValidationCompetence.getGenreDeCompetence=function(aCompetence){if(!aCompetence)
return this.Item;switch(aCompetence.GetGenre()){case EGenreRessource.Pilier:return this.Competence;case EGenreRessource.ElementPilier:return this.Item;case EGenreRessource.Competence:return this.Item;case EGenreRessource.SousItem:return this.Item;case EGenreRessource.Evaluation:return this.Evaluation;}
return this.Item;};;
MethodesObjet.heritagePrototype(ObjetCompetences_Releve,_ObjetCompetences);function ObjetCompetences_Releve(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.largeurs={le:75,acquis:100};this.hauteur=21;this.idTitreEtat=this.Nom+'_TitreEtat';this.ScrollV=new ObjetScroll(this.Nom+'.ScrollV',null,this,this.getScrollTop,EGenreScroll.Vertical);this.celluleDate=new ObjetCelluleDate(this._getNomCelluleDate(),null,this,this.surCelluleDate);this.ajouterEvenementGlobal(EEvent.SurPreResize ,this.surPreResize);this.ajouterEvenementGlobal(EEvent.SurPostResize,this.surPostResize);}(function(){var EGenreSelectionEvaluation={toutes:0,anneeCourante:1,aucune:2,periode:3};ObjetCompetences_Releve.prototype._getNomCelluleDate=function(){return this.Nom+'.celluleDate';};ObjetCompetences_Releve.prototype.effacer=function(aMessage){this.inherited('effacer',aMessage);this.surAffichage=false;};ObjetCompetences_Releve.prototype.setParametres=function(aParametres){this.parametres=aParametres;};ObjetCompetences_Releve.prototype.SetDonnees=function(aAutorisations,aPilier,aListeEleves,aListeNiveauxDAcquisitions,aNumeroProfesseur,aGenreNotation){this.surAffichage=true;this._initialiserBoutonValidationAuto();this.autorisations=aAutorisations;this.pilier=aPilier;this.eleve=aListeEleves.GetElement(0);this.listeNiveauxDAcquisitions=aListeNiveauxDAcquisitions;this.numeroProfesseur=aNumeroProfesseur;this.genreNotation=aGenreNotation;this.selection={modeCellule:false,multiSelectionLigne:[]};this.viderCellules(this.eleve.listeCompetences.GetNbrElements(),1);this.donneesRecues=true;this._indiceComboEvaluation=0;this.actualiser();this.actualiserLignes(true);};ObjetCompetences_Releve.prototype.setDonnees_GenreEvenement=function(aGenreEvenement,aValeur){switch(aGenreEvenement){case 0:return this.setDonnees_NiveauDAcquisition(aValeur);case 2:return this.setDonnees_Date(aValeur);}};ObjetCompetences_Releve.prototype.setDonnees_NiveauDAcquisition=function(aNiveauDAcquisition){this.surAffichage=true;for(var lPosition in this.selection.multiSelectionLigne){var lCompetence=this.tableauLignes[lPosition];if(this.estActif(lCompetence)){lCompetence.niveauDAcquisition=aNiveauDAcquisition;lCompetence.SetEtat(EGenreEtat.Modification);this.eleve.SetEtat(EGenreEtat.Modification);lCompetence.date=lCompetence.niveauDAcquisition.GetNumero()?GDate.getDateCourante():null;}
this.actualiserCompetence(lCompetence);}};ObjetCompetences_Releve.prototype.setDonnees_Date=function(aDate){this.surAffichage=true;if(aDate===null||aDate===undefined)
return;for(var lPosition in this.selection.multiSelectionLigne){var lCompetence=this.tableauLignes[lPosition];if(this.estActif(lCompetence,true)){lCompetence.date=aDate;lCompetence.dateMultiple=false;lCompetence.SetEtat(EGenreEtat.Modification);this.eleve.SetEtat(EGenreEtat.Modification);}
this.actualiserCompetence(lCompetence);}};ObjetCompetences_Releve.prototype.ConstruireAffichage=function(){if(this.donneesRecues){this.Afficher(this.composePage());if(this.autorisations.avecValidationAutomatique&&this.eleve.GetActif()){this.boutonValidationAuto.Initialiser();GPosition.setPosition(this.boutonValidationAuto.GetNom(),GPosition.getLeft(this.idTitreEtat)+0,GPosition.getTop(this.idTitreEtat)+10);}} else return'';};ObjetCompetences_Releve.prototype.composeImpression=function(aFormat){this.nbrCompetences=0;this.nbrCompetencesNonOptionnel=0;var lHtml=[];lHtml.push('<table class="Texte10 SansMain" border="0" cellpadding="0" cellspacing="0">','<tr><td>',this.composeEntete(true) ,'</td></tr>','<tr><td>',this.composeTitre(true) ,'</td></tr>','<tr><td>',this.composeContenu(true),'</td></tr>','<tr><td>',this.composePied(true) ,'</td></tr>','<tr><td>',this.composeLegende() ,'</td></tr>','</table>');return lHtml.join('');};ObjetCompetences_Releve.prototype.composePage=function(){this.largeurs.competences=GPosition.getWidth(this.Nom)-this.largeurs.le-this.largeurs.acquis-this.ScrollV.GetLargeur()-10;this.largeurs.contenu=GPosition.getWidth(this.Nom)-this.ScrollV.GetLargeur()-10;this.nbrCompetences=0;this.nbrCompetencesNonOptionnel=0;var lHtml=[];if(this.eleve.listeCompetences){lHtml.push('<table class="Tableau Texte10 SansMain" border="0" cellpadding="0" cellspacing="0">');lHtml.push('<tr><td colspan="2">'+this.composeEntete()+'</td></tr>');lHtml.push('<tr><td>',this.composeTitre(),'</td><td>&nbsp;</td></tr>');lHtml.push('<tr>','<td><div id="',this.ScrollV.GetIdZone(),'" tabIndex="-1" style="height:1px;overflow:hidden;">',this.composeContenu() ,'</div></td>','<td id="',this.ScrollV.GetIdScroll(),'" class="AlignementGauche"></td>','</tr>');lHtml.push('<tr><td colspan="2">'+this.composePied()+'</td></tr>');lHtml.push('</table>');}
return lHtml.join('');};ObjetCompetences_Releve.prototype.composeTitre=function(aPourImpression){var lStyle=GTableau.styleTitre(aPourImpression);var lHtml=[];lHtml.push('<table class="Tableau Texte10 Titre AlignementMilieu SansMain" style="'+GTableau.styleTableau(aPourImpression,true)+'" border="1" cellpadding="0" cellspacing="0">');lHtml.push('<tr>');var lStyleHeight='';if(this.comboEvaluations&&!aPourImpression)
lStyleHeight=' style="line-height:20px"';lHtml.push('<td class="Tableau_Titre" style="',lStyle,'width:',this.largeurs.competences-6,'px">','<div><div class="InlineBlock AlignementMilieuVertical" ',lStyleHeight,'>',GTraductions.getValeur('competences.items'),'</div>');if(this.comboEvaluations)
if(aPourImpression){var lItem=this.comboEvaluations.ListeElements.GetElement(this._indiceComboEvaluation);if(lItem)
lHtml.push('<div class="Italique" style="float:right;">',lItem.GetLibelle(),'</div>');}
else lHtml.push('<div class="AlignementGauche" style="float:right; padding-top:1px; padding-bottom:1px; text-shadow:none;" id="',this.comboEvaluations.GetNom(),'"></div>');lHtml.push('</div>');lHtml.push('</td>');lHtml.push('<td class="Tableau_Titre" style="',lStyle,'" id="',this.idTitreEtat ,'"><div style="width: ',this.largeurs.acquis-6,'px">');if(this.autorisations.avecValidationAutomatique&&this.eleve.GetActif()){lHtml.push('<span id="',this.boutonValidationAuto.GetNom(),'" style="position: absolute;"></span>');lHtml.push(GTraductions.getValeur('competences.etat'));} else lHtml.push(GTraductions.getValeur('competences.etat'));lHtml.push('</div></td>');lHtml.push('<td class="Tableau_Titre" style="',lStyle,'"><div style="width: ',this.largeurs.le-6,'px">',GTraductions.getValeur('competences.valideLe').ucfirst() ,'</div></td>');lHtml.push('</tr>');lHtml.push('</table>');return lHtml.join('');};ObjetCompetences_Releve.prototype.composeContenu=function(aPourImpression){var lHtml=[];lHtml.push('<table id="',this.ScrollV.GetIdContenu(),'" class="Texte10" border="0" cellpadding="0" cellspacing="0">');for(var lPosition=0;lPosition<this.eleve.listeCompetences.GetNbrElements();lPosition++){var lCompetence=this.eleve.listeCompetences.GetElement(lPosition);lHtml.push(this.composeCompetence(lPosition,lCompetence,aPourImpression));}
lHtml.push('</table>');return lHtml.join('');};ObjetCompetences_Releve.prototype.getMargeCompetence=function(aCompetence){switch(aCompetence.GetGenre()){case EGenreRessource.ElementPilier:return 5;case EGenreRessource.Competence:return 10;case EGenreRessource.SousItem:return 15;case EGenreRessource.Evaluation:case EGenreRessource.EvaluationHistorique:return 20;}};ObjetCompetences_Releve.prototype.pereEstDeploye=function(aCompetence){return aCompetence.competencePere?(aCompetence.competencePere.estDeploye!==false)&&this.pereEstDeploye(aCompetence.competencePere):true;};ObjetCompetences_Releve.prototype.estUnDeploiement=function(aCompetence,aPosition){if(aCompetence.nombreFils===0) return false;for(var lPosition=aPosition+1;lPosition<=aPosition+aCompetence.nombreFils;lPosition++){var lCompetence=this.eleve.listeCompetences.GetElement(lPosition);if(lCompetence&&!lCompetence.evaluationCachee)
return true;}
return false;};ObjetCompetences_Releve.prototype.deployer=function(aPosition){var lCompetence=this.eleve.listeCompetences.GetElement(aPosition);lCompetence.estDeploye=lCompetence.estDeploye===null||lCompetence.estDeploye===undefined?false:!lCompetence.estDeploye;GHtml.setClass(this.getIdDeploiement(lCompetence),lCompetence.estDeploye?'Image_DeploiementListe_Deploye':'Image_DeploiementListe_NonDeploye');for(var I=aPosition+1;I<this.eleve.listeCompetences.GetNbrElements();I++){lCompetence=this.eleve.listeCompetences.GetElement(I);GStyle.setDisplay(this.getIdLigne(lCompetence),this.pereEstDeploye(lCompetence));}
this.ScrollV.Actualiser();};ObjetCompetences_Releve.prototype.composeCompetence=function(aPosition,aCompetence,aPourImpression){if(!this.parametres.afficherEvaluationsHistoriques&&(aCompetence.GetGenre()===EGenreRessource.EvaluationHistorique))
return'';if(aCompetence.evaluationCachee) return'';var lAvecEvaluation=true;var lId=aPourImpression?'':this.getIdCellule(aCompetence);var lIdLigne=aPourImpression?'':this.getIdLigne(aCompetence);var lCouleur=this.getCouleurCellule(aCompetence,false,false,false,aPourImpression);var lStyleCellule=GTableau.styleCouleur(false,true,EGenreBordure.droite+EGenreBordure.bas+EGenreBordure.gauche,lCouleur);var lLibelle=aCompetence.GetLibelle();var lObservation=aCompetence.observation&&((GEtatUtilisateur.GenreEspace!==EGenreEspace.Professeur)||aPourImpression)?'<br>'+GChaine.ToHTML(aCompetence.observation):'';var lTitle='';var lColspan=lAvecEvaluation?'':' colspan="10"';var lEvenement=aPourImpression?'':' onmouseup="'+this.Nom+'.surSelectionLigne (event, '+this.nbrCompetences+', 0)"';var lEstGras=aCompetence.GetGenre()===EGenreRessource.ElementPilier;this.tableauLignes[this.nbrCompetences]=aCompetence;aCompetence.ligne=this.nbrCompetences;var lHtml=[];lHtml.push('<tr id="'+lIdLigne+'">');var lStyleFont=aCompetence.GetGenre()===EGenreRessource.EvaluationHistorique?'font-style:italic;':'';lHtml.push('<td id="'+lId+'"'+lColspan+' class="AlignementGauche',(lEstGras?' Gras':''),'" style="width: ',(lAvecEvaluation?this.largeurs.competences:this.largeurs.contenu)-this.getMargeCompetence(aCompetence),'px; height: ',(this.hauteur+(IE.Support.bordureExterneTD?0:-1)),'px; padding-left: '+this.getMargeCompetence(aCompetence)+'px; ',lStyleCellule,lStyleFont,'" title="',lTitle ,'"',lEvenement,'>');if(this.estUnDeploiement(aCompetence,aPosition)&&!aPourImpression)
lHtml.push('<div id="',this.getIdDeploiement(aCompetence),'" style="float: left; margin-top: 2px; " class="Image_DeploiementListe_Deploye" onclick="'+this.Nom+'.deployer ('+aPosition+')">&nbsp;</div>');lHtml.push('<div style="float: left;" class="EspaceGauche">',lLibelle,(aCompetence.libelleCorrige?'<a class="EspaceGauche" title="'+GTraductions.getValeur('AfficherCorrige')+'" href="'+GChaine.GetChainePourUrl(GApplication.getCommunication().composeUrlFichierExterne(aCompetence.libelleCorrige,{"N":aCompetence.GetNumero(),"G":aCompetence.GetGenre()}),true)+'" target="_blank">'+aCompetence.libelleCorrige+'</a>':''),lObservation,'</div>');lHtml.push('</td>');if(lAvecEvaluation){lHtml.push(this.composeValidation(this.largeurs.acquis,aCompetence,aPourImpression));lHtml.push(this.composeDate(this.largeurs.le,aCompetence,aPourImpression));}
lHtml.push('</tr>');this.nbrCompetences++;if((!aCompetence.optionnel)&&(aCompetence.GetGenre()===EGenreRessource.SousItem))
this.nbrCompetencesNonOptionnel++;return lHtml.join('');};ObjetCompetences_Releve.prototype.composeValidation=function(aLargeur,aCompetence,aPourImpression){var lId=aPourImpression?'':this.getIdCellule(aCompetence,true,false);var lActif=aPourImpression?false:this.estActif(aCompetence);var lCouleur=this.getCouleurCellule(aCompetence,true,false,false,aPourImpression);var lStyleCellule=GStyle.composeCouleur(lCouleur.fond,lCouleur.texte)+' '+GStyle.composeCouleurBordure(aPourImpression?GCouleur.noir:GCouleur.liste.bordure,1,EGenreBordure.droite+EGenreBordure.bas);var lClassTexte=aCompetence.estAnneePrecedente?' Italique':'';var lEvaluation=this.getNiveauDAcquisition(aCompetence,aPourImpression);var lEvenement=aPourImpression?'':' onmouseup="'+this.Nom+'.surSelectionLigne (event, '+this.nbrCompetences+'); if (GNavigateur.estSourisBoutonDroit () || GNavigateur.isTactile) '+this.Nom+'.surEdition (1);" ondblclick="'+this.Nom+'.surEdition (0)"';var H=[];H.push('<td id="'+lId+'" title="'+this.getTitleNiveauDAcquisition(aCompetence)+'" class="AlignementMilieu'+lClassTexte+(lActif?' AvecMain':'')+'" style="'+lStyleCellule+'" '+lEvenement+'>','<div style="width: '+aLargeur+'px; position:relative;">',lEvaluation);if(aCompetence.avecVerrou&&!aPourImpression){H.push('<div class="Image_VerrouNoirPetit" style="position:absolute; right:0; bottom:0"></div>');}
H.push('</div>','</td>');return H.join('');};ObjetCompetences_Releve.prototype.composeDate=function(aLargeur,aCompetence,aPourImpression){var lId=aPourImpression?'':this.getIdCellule(aCompetence,false,true);var lActif=aPourImpression?false:this.estActif(aCompetence,true);var lCouleur=this.getCouleurCellule(aCompetence,false,true,false,aPourImpression);var lStyleCellule=GStyle.composeCouleur(lCouleur.fond,lCouleur.texte)+' '+GStyle.composeCouleurBordure(aPourImpression?GCouleur.noir:GCouleur.liste.bordure,1,EGenreBordure.droite+EGenreBordure.bas);var lClassTexte=aCompetence.estAnneePrecedente?' Italique':'';var lDate=this.getDate(aCompetence);var lEvenement=aPourImpression?'':' onmouseup="'+this.Nom+'.surSelectionLigne (event, '+this.nbrCompetences+', 0)" ondblclick="'+this.Nom+'.surEdition (2)"';var lTitle=aPourImpression?'':this.getTitleAcquisLe(aCompetence);return'<td id="'+lId+'" '+(lTitle?'title="'+lTitle+'"':'')+' class="'+lClassTexte+' AlignementMilieu'+(lActif?' AvecMain':'')+'" style="'+lStyleCellule+'"'+lEvenement+'><div style="width: '+aLargeur+'px">'+lDate+'</div></td>';};ObjetCompetences_Releve.prototype.getTitleAcquisLe=function(aElement){if(!aElement)
return'';var lTitle=aElement.niveauDAcquisition&&this.avecDate(aElement)&&aElement.individuValidation?GTraductions.getValeur('competences.ValidePar')+' '+aElement.individuValidation.GetLibelle()+' '+
GTraductions.getValeur('Le')+' '+GDate.FormatDate(aElement.date,'%JJ/%MM/%AAAA'):'';return GChaine.toTitle(lTitle);};ObjetCompetences_Releve.prototype.actualiserComboValidation=function(){var lIdConteneur=this.Nom+'.comboValidation';if(!GHtml.elementExiste(lIdConteneur)) return;this.comboValidation=new ObjetSaisiePN(lIdConteneur,null,this,this.surEditionNiveauDAcquisitionCompetence);this.comboValidation.SetParametres(false,false,130,true,true,null,18,true);this.comboValidation.Initialiser();this.comboValidation.SetDonnees(this.getListeNiveauxDAcquisitionPourCombo());if(this.eleve.niveauDAcquisition.GetGenre()===EGenreNiveauDAcquisition.Multiple){this.comboValidation.SetContenu(GTraductions.getValeur('Multiple'));}
else this.comboValidation.SetSelectionParNumeroEtGenre(this.eleve.niveauDAcquisition.GetNumero());};ObjetCompetences_Releve.prototype.getListeNiveauxDAcquisitionPourCombo=function(){var lEvaluation,lListeEvaluations=new ObjetListeElements();for(var I=0;I<this.listeNiveauxDAcquisitions.GetNbrElements();I++)
if(this.listeNiveauxDAcquisitions.GetElement(I).actifPour.contains(EGenreChoixValidationCompetence.Competence)){lEvaluation=MethodesObjet.dupliquer(this.listeNiveauxDAcquisitions.GetElement(I));if(lEvaluation.GetNumero())
lEvaluation.libelleHtml='<table border="0" cellpadding="0" cellspacing="0"><tr>'+'<td style="width: '+(GParametres.afficherAbbreviationNiveauDAcquisition?25:20)+'px;">'+EGenreNiveauDAcquisition.getImage(lEvaluation,true)+'</td>'+'<td>'+lEvaluation.Libelle+'</td>'+'</tr></table>';else lEvaluation.libelleHtml='&nbsp;';lListeEvaluations.AddElement(lEvaluation);}
return lListeEvaluations;};ObjetCompetences_Releve.prototype.composeEntete=function(aPourImpression){var lHtml=[];if(this.eleve.GetActif()&&this.autorisations.avecSaisieCompetences&&this.autorisations.avecConsultationObservationSaisieCompetences&&!aPourImpression){lHtml.push('<div class="EspaceBas">');lHtml.push('<table class="Texte10" border="0" cellpadding="0" cellspacing="0">');lHtml.push('<tr>');lHtml.push('<td class="Gras PetitEspaceDroit">',this.getLibellePilier(),' :</td>');lHtml.push('<td id="',this.Nom+'.comboValidation"></td>');lHtml.push('<td class="EspaceGauche">','<div id="',this.celluleDate.GetNom(),'">','</td>');lHtml.push('</tr>');lHtml.push('</table>');lHtml.push('</div>');} else{var lAvecResultat=this.eleve.niveauDAcquisition.existeNumero();var lAvecLanguePourBrevet=this.pilier.avecChoixLangueBrevet&&this.eleve.languePourBrevet;if(lAvecResultat)
lHtml.push('<div class="EspaceBas"><span class="Gras">',GChaine.Insecable(this.getLibellePilier()+' : ') ,'</span><span>',this.getValidation(),'</span></div>');if(lAvecLanguePourBrevet&&!MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Professeur,EGenreEspace.Etablissement])){lHtml.push('<div class="EspaceBas">',GTraductions.getValeur('competences.languePourBrevet'),'</div>');}}
return lHtml.join('');};ObjetCompetences_Releve.prototype.composePied=function(aPourImpression){var lHtml=[];if(this.eleve.GetActif()&&this.autorisations.avecConsultationObservationSaisieCompetences&&!aPourImpression){var lAvecSaisie=this.autorisations.avecSaisieCompetences;var lDisabled=lAvecSaisie?'':'disabled';lHtml.push('<div class="EspaceHaut">','<table id="'+this.Nom+'_Pied" class="Texte10" width="100%" border="0" cellpadding="0" cellspacing="0">','<tr><td class="Gras PetitEspaceGauche AlignementGauche">',GTraductions.getValeur('competences.observations'),' :</td></tr>','<tr><td><textarea id ="',this.getIdObservation(),'" class="Texte10 CelluleTexte" style="width:100%; height:40px" onblur="',this.Nom ,'.surEditionObservation ()" onkeyup="',this.Nom ,'.surEditionObservation ()" ',lDisabled,'>',this.eleve.observation ,'</textarea></td></tr>','</table>','</div>');} else{var lAvecObservation=this.eleve.observation!=='';if(lAvecObservation){lHtml.push('<div class="EspaceHaut">','<table id="'+this.Nom+'_Pied" class="Texte10" width="100%" border="0" cellpadding="3" cellspacing="0">','<tr><td><span class="Gras">',GChaine.Insecable(GTraductions.getValeur('competences.observations')+' : ') ,'</span><span>',this.eleve.observation,'</span></td></tr>','</table>','</div>');}}
return lHtml.join('');};ObjetCompetences_Releve.prototype.composeLegende=function(){var lHtml=[];for(var I=0;I<this.listeNiveauxDAcquisitions.GetNbrElements();I++){var lNiveauDAcquisition=this.listeNiveauxDAcquisitions.GetElement(I);if((lNiveauDAcquisition.actifPour.contains(EGenreChoixValidationCompetence.Item)||lNiveauDAcquisition.actifPour.contains(EGenreChoixValidationCompetence.Evaluation))&&(lNiveauDAcquisition.existeNumero())&&(EGenreNiveauDAcquisition.getImage(lNiveauDAcquisition))){lHtml.push('<div style="float: left;">','&nbsp;-&nbsp;','</div>');lHtml.push('<div style="float: left;">',EGenreNiveauDAcquisition.getImage(lNiveauDAcquisition),'</div>');lHtml.push('<div style="float: left;" class="PetitEspaceGauche">',lNiveauDAcquisition.GetLibelle(),'</div>');}}
return('<br/><div style="float: left;" class="Gras PetitEspaceGauche">'+GTraductions.getValeur('competences.acquisition')+'&nbsp;:&nbsp;</div>')+lHtml.join('');};ObjetCompetences_Releve.prototype.getValidation=function(){var lValidation='';if(this.eleve.niveauDAcquisition.existeNumero()){lValidation=this.eleve.niveauDAcquisition.GetLibelle();if(this.eleve.niveauDAcquisition.GetGenre()===EGenreNiveauDAcquisition.Acquis)
lValidation+=' '+GTraductions.getValeur('Le')+' '+GDate.FormatDate(this.eleve.date,'%JJ/%MM/%AAAA');}
return lValidation;};ObjetCompetences_Releve.prototype.getScrollTop=function(aGenre,aScrollTop){if(aGenre===EGenreScrollEvenement.TailleZone)
aScrollTop=Math.max(GPosition.getHeight(this.Nom)-2*this.hauteur-1-GPosition.getHeight(this.Nom+'_Pied'),3*this.hauteur);switch(aGenre){case EGenreScrollEvenement.Deplacement:return this.hauteur*(Math.ceil(aScrollTop/this.hauteur));case EGenreScrollEvenement.TailleZone:return this.hauteur*(Math.ceil(aScrollTop/this.hauteur)-2);case EGenreScrollEvenement.TailleContenu:return null;}};ObjetCompetences_Releve.prototype.actualiser=function(){if(this.comboEvaluations)
this.comboEvaluations.free();delete this.comboEvaluations;if(MethodesObjet.isNumber(this.genreNotation)){this.comboEvaluations=new ObjetSaisie(this.Nom+'.comboEvaluations',null,this,_surEvenementComboEvaluation);this.comboEvaluations.SetParametres(EGenreSaisie.Combo,180,true);}
this.Afficher();this.celluleDate.Initialiser();this.ScrollV.SetDonnees(0);this.actualiserDateValidation();this.actualiserComboValidation();this.actualiserLanguePourBrevet();_initComboEvaluations.bind(this)();};function _getElementPeriodeDeGenre(aGenrePeriodeNoation){var lPeriode=GParametres.getPeriodeDeNotationParGenre(aGenrePeriodeNoation);var lElement=new ObjetElement(GChaine.Format(GTraductions.getValeur('competences.EvalsPeriode'),[lPeriode.GetLibelle()]),null,EGenreSelectionEvaluation.periode);lElement.periode=lPeriode;return lElement;}
function _initComboEvaluations(){if(!this.comboEvaluations) return;this.comboEvaluations.Initialiser();var lListe=new ObjetListeElements();lListe.AddElement(new ObjetElement(GTraductions.getValeur('competences.ToutesEvals'),null,EGenreSelectionEvaluation.toutes));lListe.AddElement(new ObjetElement(GTraductions.getValeur('competences.EvalsAnneeEnCours'),null,EGenreSelectionEvaluation.anneeCourante));if(this.genreNotation===TypeGenreNotation.Trimestrielle){lListe.AddElement(_getElementPeriodeDeGenre(EGenrePeriodeDeNotation.Trimestre1));lListe.AddElement(_getElementPeriodeDeGenre(EGenrePeriodeDeNotation.Trimestre2));lListe.AddElement(_getElementPeriodeDeGenre(EGenrePeriodeDeNotation.Trimestre3));}
else if(this.genreNotation===TypeGenreNotation.Semestrielle){lListe.AddElement(_getElementPeriodeDeGenre(EGenrePeriodeDeNotation.Semestre1));lListe.AddElement(_getElementPeriodeDeGenre(EGenrePeriodeDeNotation.Semestre2));}
lListe.AddElement(new ObjetElement(GTraductions.getValeur('competences.AucuneEval'),null,EGenreSelectionEvaluation.aucune));this._sansActualisationCombo=true;this.comboEvaluations.SetDonnees(lListe,this._indiceComboEvaluation);delete this._sansActualisationCombo;}
ObjetCompetences_Releve.prototype.surPreResize=function(){if(!this.surAffichage) return;if(this.ScrollV)
this.ScrollV.Vider();if(this.celluleDate&&this.celluleDate.fenetreDate)
this.celluleDate.fenetreDate.Fermer();this.Afficher('&nbsp;');};ObjetCompetences_Releve.prototype.surPostResize=function(){if(!this.surAffichage) return;this.actualiser();};ObjetCompetences_Releve.prototype.surCelluleDate=function(aDate){this.eleve.date=aDate;this.eleve.SetEtat(EGenreEtat.Modification);this.SetEtatSaisie(true);};ObjetCompetences_Releve.prototype.surConfirmationValidationAuto=function(aGenreBouton){if(aGenreBouton===1)
return;var lGenreNiveauDAcquisition,lCompetence,lPosition;for(lPosition=0;lPosition<this.eleve.listeCompetences.GetNbrElements();lPosition++){lCompetence=this.eleve.listeCompetences.GetElement(lPosition);lCompetence.nombreFilsAcquis=lCompetence.nombreFils===0?(EGenreNiveauDAcquisition.estAcquis(lCompetence.niveauDAcquisition.GetGenre())?1:0):0;lCompetence.nombreSousItemsAcquis=0;}
var lGenres=[EGenreRessource.Evaluation,EGenreRessource.EvaluationHistorique,EGenreRessource.SousItem,EGenreRessource.Competence];for(var I in lGenres){var lGenre=lGenres[I];for(lPosition=0;lPosition<this.eleve.listeCompetences.GetNbrElements();lPosition++){lCompetence=this.eleve.listeCompetences.GetElement(lPosition);if((lGenre===lCompetence.GetGenre())&&lCompetence.nombreFilsAcquis&&lCompetence.competencePere){lCompetence.competencePere.nombreFilsAcquis++;if((lCompetence.GetGenre()===EGenreRessource.SousItem)&&!lCompetence.optionnel)
lCompetence.competencePere.nombreSousItemsAcquis++;}}}
for(lPosition=0;lPosition<this.eleve.listeCompetences.GetNbrElements();lPosition++){lCompetence=this.eleve.listeCompetences.GetElement(lPosition);if(lCompetence.nombreFils){lGenreNiveauDAcquisition=lCompetence.nombreFilsAcquis===lCompetence.nombreFils?EGenreNiveauDAcquisition.Acquis:EGenreNiveauDAcquisition.NonRempli;if((lGenreNiveauDAcquisition!==lCompetence.niveauDAcquisition.GetGenre())&&(EGenreNiveauDAcquisition.estAcquis(lGenreNiveauDAcquisition))){lCompetence.niveauDAcquisition=MethodesObjet.dupliquer(this.listeNiveauxDAcquisitions.GetElementParGenre(lGenreNiveauDAcquisition));lCompetence.date=lCompetence.niveauDAcquisition===EGenreNiveauDAcquisition.NonRempli?null:GDate.getDateCourante();this.eleve.SetEtat(EGenreEtat.Modification);lCompetence.SetEtat(EGenreEtat.Modification);lCompetence.niveauDAcquisition.SetEtat(EGenreEtat.Modification);this.SetEtatSaisie(true);}}}
lGenreNiveauDAcquisition=this.getValidationCompetence(this.eleve);if(this.eleve.niveauDAcquisition.GetGenre()!==lGenreNiveauDAcquisition){this.eleve.niveauDAcquisition=MethodesObjet.dupliquer(this.listeNiveauxDAcquisitions.GetElementParGenre(lGenreNiveauDAcquisition));if(EGenreNiveauDAcquisition.estAcquis(this.eleve.niveauDAcquisition.GetGenre()))
this.eleve.date=GDate.getDateCourante();this.eleve.SetEtat(EGenreEtat.Modification);this.eleve.niveauDAcquisition.SetEtat(EGenreEtat.Modification);this.SetEtatSaisie(true);}
this.actualiser();};ObjetCompetences_Releve.prototype.getValidationCompetence=function(aEleve){var lNombre=0,lNombreAcquis=0;var lPourB2I=this.pilier.pourB2I&&this.pilier.avecSousItems&&this.pilier.pourB2IBO;var lGenreCompetence,lSeuil,lGenreNiveauDAcquisition,lCompetence,lPosition;if(lPourB2I){lGenreCompetence=EGenreRessource.SousItem;lSeuil=80;lGenreNiveauDAcquisition=EGenreNiveauDAcquisition.NonAcquis;} else{lGenreCompetence=EGenreRessource.Competence;lSeuil=100;lGenreNiveauDAcquisition=aEleve.niveauDAcquisition.GetGenre();}
for(lPosition=0;lPosition<this.eleve.listeCompetences.GetNbrElements();lPosition++){lCompetence=this.eleve.listeCompetences.GetElement(lPosition);if((lCompetence.GetGenre()===lGenreCompetence)&&!lCompetence.optionnel){lNombre++;if(EGenreNiveauDAcquisition.estAcquis(lCompetence.niveauDAcquisition.GetGenre()))
lNombreAcquis++;}}
if(lPourB2I){for(lPosition=0;lPosition<this.eleve.listeCompetences.GetNbrElements();lPosition++){lCompetence=this.eleve.listeCompetences.GetElement(lPosition);if(lCompetence.GetGenre()===EGenreRessource.Competence){if(Math.round(100*lCompetence.nombreSousItemsAcquis/lCompetence.nombreSousItems)<50)
return lGenreNiveauDAcquisition;}}}
return Math.round(100*lNombreAcquis/lNombre)>=lSeuil?EGenreNiveauDAcquisition.Acquis:lGenreNiveauDAcquisition;};ObjetCompetences_Releve.prototype.getTableauElements=function(){var lTableau=[];for(var lPosition in this.selection.multiSelectionLigne)
lTableau.push(this.tableauLignes[lPosition]);return lTableau;};ObjetCompetences_Releve.prototype.surEdition_ElementPilier=function(aGenreEvenement){if(GApplication.droits.get(IEEnum.droits.competence.avecSaisieItems)){this.SetEtatSaisie(true);this.selection.tableauElements=this.getTableauElements();this.callback.appel(aGenreEvenement,this.selection);}};ObjetCompetences_Releve.prototype.surEdition=function(aGenreEvenement){var lCompetence=this.selection.competence;if(this.estActif(lCompetence)){this.SetEtatSaisie(true);if((aGenreEvenement===2)||(aGenreEvenement===1)||((aGenreEvenement===0))){if(this.estActif(lCompetence,aGenreEvenement===2)){this.selection.tableauElements=this.getTableauElements();var lGenreChoixValidationCompetence=this.selection&&this.selection.competence?this.selection.competence.GetGenre()===EGenreRessource.Evaluation?EGenreChoixValidationCompetence.Evaluation:EGenreChoixValidationCompetence.Item:null;this.callback.appel(aGenreEvenement,this.selection,null,null,lGenreChoixValidationCompetence);}} else this.surEditionB2I();} else if(MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Professeur,EGenreEspace.Etablissement])){GApplication.getMessage().Afficher(EGenreBoiteMessage.Information,null,this.getMessage(this.eleve,lCompetence));}};ObjetCompetences_Releve.prototype.surEditionB2I=function(){if(this.estActif(this.selection.competence))
this.setDonnees_NiveauDAcquisition(this.selection.competence.genreEvaluation===EGenreNiveauDAcquisition.NonRempli?EGenreNiveauDAcquisition.Acquis:EGenreNiveauDAcquisition.NonRempli);};ObjetCompetences_Releve.prototype.surEditionObservation=function(){this.SetEtatSaisie(true);this.eleve.SetEtat(EGenreEtat.Modification);this.eleve.observation=GHtml.getValue(this.getIdObservation());};ObjetCompetences_Releve.prototype.surEditionNiveauDAcquisitionCompetence=function(aGenreEvenement,aNiveauDAcquisition){if(aGenreEvenement===EGenreEvenementObjetSaisie.selection)
if((aNiveauDAcquisition.GetGenre()!==EGenreNiveauDAcquisition.Multiple)&&(this.eleve.niveauDAcquisition.GetNumero()!==aNiveauDAcquisition.GetNumero())){this.eleve.niveauDAcquisition=MethodesObjet.dupliquer(aNiveauDAcquisition);if(EGenreNiveauDAcquisition.estAcquis(this.eleve.niveauDAcquisition.GetGenre()))
this.eleve.date=GDate.getDateCourante();this.SetEtatSaisie(true);this.eleve.SetEtat(EGenreEtat.Modification);this.eleve.niveauDAcquisition.SetEtat(EGenreEtat.Modification);this.actualiserDateValidation();}};ObjetCompetences_Releve.prototype.actualiserDateValidation=function(){var lEstAcquis=EGenreNiveauDAcquisition.estAcquis(this.eleve.niveauDAcquisition.GetGenre());this.celluleDate.SetVisible(lEstAcquis);this.celluleDate.SetDonnees(lEstAcquis?this.eleve.date:'');};ObjetCompetences_Releve.prototype.actualiserLanguePourBrevet=function(){GHtml.setCheckBox(this.getIdLanguePourBrevet(),this.eleve.languePourBrevet);};ObjetCompetences_Releve.prototype.actualiserCompetence=function(aCompetence){GHtml.setHtml(this.getIdCellule(aCompetence,true,false),'<div style="width: '+this.largeurs.acquis+'px">'+this.getNiveauDAcquisition(aCompetence)+'</div>');GHtml.setTitle(this.getIdCellule(aCompetence,true,false),this.getTitleNiveauDAcquisition(aCompetence));GHtml.setHtml(this.getIdCellule(aCompetence,false,true),'<div style="width: '+this.largeurs.le+'px">'+this.getDate(aCompetence)+'</div>');};ObjetCompetences_Releve.prototype.estActif=function(aCompetence,aPourDate){var lActif=(this.eleve.GetActif())&&
this.autorisations.avecSaisie&&((this.autorisations.avecSaisieDomaine&&(aCompetence.GetGenre()===EGenreRessource.ElementPilier))||(this.autorisations.avecSaisieItems&&(aCompetence.GetGenre()===EGenreRessource.Competence))||(this.autorisations.avecSaisieItems&&(aCompetence.GetGenre()===EGenreRessource.SousItem))||(aCompetence.GetGenre()===EGenreRessource.Evaluation))&&
aCompetence.GetActif()&&
!aCompetence.estAnneePrecedente&&
!aCompetence.avecVerrou;return aPourDate?lActif&&this.avecDate(aCompetence):lActif;};ObjetCompetences_Releve.prototype.getCouleurFond=function(aCompetence,aPourDate){return this.estActif(aCompetence,aPourDate)?GCouleur.blanc:GCouleur.liste.nonEditable.fond;};ObjetCompetences_Releve.prototype.getDate=function(aCompetence){return aCompetence.dateMultiple?GTraductions.getValeur('Multiple'):this.avecDate(aCompetence)?GDate.FormatDate(aCompetence.date,'%JJ/%MM/%AAAA'):'&nbsp;';};ObjetCompetences_Releve.prototype.getLibellePilier=function(){return this.pilier.libelleComplet;};ObjetCompetences_Releve.prototype.getIdCellule=function(aCompetence,aEstEvaluation,aEstDate){return this.Nom+'_'+(aCompetence.competencePere?aCompetence.competencePere.GetGenre()+'_'+aCompetence.competencePere.GetNumero():'0_0')+'_'+aCompetence.GetGenre()+'_'+aCompetence.GetNumero()+'_'+(aEstEvaluation?'_evaluation':'')+(aEstDate?'_date':'');};ObjetCompetences_Releve.prototype.getIdLigne=function(aCompetence){return this.getIdCellule(aCompetence)+'_Ligne';};ObjetCompetences_Releve.prototype.getIdDeploiement=function(aCompetence){return this.getIdCellule(aCompetence)+'_Deploiement';};ObjetCompetences_Releve.prototype.getIdObservation=function(){return this.Nom+'_Observation';};ObjetCompetences_Releve.prototype.getIdLanguePourBrevet=function(){return this.Nom+'_LanguePourBrevet';};ObjetCompetences_Releve.prototype._selectionnerLigne=function(aPosition,aSelectionner){if(this.autorisations.avecSaisie){var lCompetence=this.tableauLignes[aPosition];var lCouleur=this.getCouleurCellule(lCompetence,false,false,aSelectionner);GStyle.setCouleur(this.getIdCellule(lCompetence),lCouleur.fond,lCouleur.texte);lCouleur=this.getCouleurCellule(lCompetence,true,false,aSelectionner);GStyle.setCouleur(this.getIdCellule(lCompetence,true,false),lCouleur.fond,lCouleur.texte);lCouleur=this.getCouleurCellule(lCompetence,false,true,aSelectionner);GStyle.setCouleur(this.getIdCellule(lCompetence,false,true),lCouleur.fond,lCouleur.texte);}};ObjetCompetences_Releve.prototype.getCouleurCellule=function(aCompetence,aEstEvaluation,aEstDate,aSelectionner,aPourImpression){if(aSelectionner)
return GCouleur.selection;if(aPourImpression)
return aCompetence.GetGenre()===EGenreRessource.ElementPilier?GCouleur.liste.cumul[2]:GCouleur.liste.cellule;if(MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Professeur,EGenreEspace.Etablissement])&&(aEstEvaluation||aEstDate)&&this.estActif(aCompetence,aEstDate))
return GCouleur.standard;if(!MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Professeur,EGenreEspace.Etablissement])&&(aEstEvaluation||aEstDate))
return GCouleur.standard;return aCompetence.GetGenre()===EGenreRessource.ElementPilier?GCouleur.liste.cumul:GCouleur.liste.nonEditable;};function _actualiserVisibiliteEvaluations(aElementSelection){var i,lEvaluation;for(i=0;i<this.eleve.listeCompetences.GetNbrElements();i++){lEvaluation=this.eleve.listeCompetences.GetElement(i);if(lEvaluation.GetGenre()===EGenreRessource.Evaluation||lEvaluation.GetGenre()===EGenreRessource.EvaluationHistorique){switch(aElementSelection.GetGenre()){case EGenreSelectionEvaluation.toutes:delete lEvaluation.evaluationCachee;break;case EGenreSelectionEvaluation.aucune:lEvaluation.evaluationCachee=true;break;case EGenreSelectionEvaluation.anneeCourante:lEvaluation.evaluationCachee=lEvaluation.dateValidation&&!GDate.dateEstDansLaPeriode(lEvaluation.dateValidation,GDate.premiereDate,GDate.derniereDate);break;case EGenreSelectionEvaluation.periode:lEvaluation.evaluationCachee=lEvaluation.periode&&
lEvaluation.periode.GetNumero()!==aElementSelection.periode.GetNumero();break;default:;}}}}
function _surEvenementComboEvaluation(aGenreSelection,aElement,aSelection,aGenre,aValeur){if(this._sansActualisationCombo) return;if(aGenreSelection===EGenreEvenementObjetSaisie.selection&&aElement){if(aSelection===this._indiceComboEvaluation)
return;this._indiceComboEvaluation=aSelection;_actualiserVisibiliteEvaluations.bind(this)(aElement);this.actualiser(this);}}})();;
function _ObjetRequetePageCompetences(aPere,aEvenementSurReussite,aEvenementSurEchec){this.inheritedCreate(aPere,aEvenementSurReussite,aEvenementSurEchec);}
IE.Requetes.inscrire('PageCompetences',_ObjetRequetePageCompetences,_ObjetRequeteXmlConsultationPN);_ObjetRequetePageCompetences.prototype.lancerRequete=function(aParametres){var lParametres={eleve:null,palier:null,pilier:null,service:null,ressource:null};$.extend(lParametres,aParametres);this.eleve=lParametres.eleve;var P=this.XML;if(lParametres.ressource)
P.CreerElement(null,'Ressource' ,lParametres.ressource);P.CreerElement(null,'Palier' ,lParametres.palier);P.CreerElement(null,'Pilier' ,lParametres.pilier);P.CreerElement(null,'Service' ,lParametres.service);var lNoeud=P.CreerElement(null,'Eleve',lParametres.eleve);if(lParametres.eleve.multiSelection)
for(var i=0;i<lParametres.eleve.listeSelection.GetNbrElements();i++)
P.CreerElement(lNoeud,'Eleve',lParametres.eleve.listeSelection.GetElement(i));this.appelAsynchroneConsultation();};_ObjetRequetePageCompetences.prototype.actionApresRequete=function(aXml){var lMessage=aXml.GetVariable(null,'Message');var lGenreNotation=null,lMultiSelection,lListeEleves,lListeNiveauxDAcquisitions,lAutorisations;if(!lMessage){lListeNiveauxDAcquisitions=this.JSONReponse.ListeNiveauxDAcquisitions;if(aXml.Existe(null,'NotationClasse'))
lGenreNotation=aXml.GetVariable(null,'NotationClasse');lListeEleves=new ObjetListeElements();aXml.Parcourir(null,'Eleve',this,this._ajouterEleve,false,lListeEleves);lMultiSelection=GEtatUtilisateur.GenreEspace===EGenreEspace.Professeur?this.eleve.multiSelection:false;lAutorisations={avecSaisie:aXml.GetVariable(null,'AvecSaisie'),avecSaisieItems:aXml.GetVariable(null,'AvecSaisieItems'),avecSaisieDomaine:aXml.GetVariable(null,'AvecSaisieDomaine'),avecSaisieCompetences:aXml.GetVariable(null,'AvecSaisieCompetences'),avecConsultationObservationSaisieCompetences:aXml.GetVariable(null,'AvecConsultationObservationSaisieCompetences')};lAutorisations.avecChoixLVE=lAutorisations.avecSaisie?true:(aXml.Existe(null,'AvecChoixLVE')?aXml.GetVariable(null,'AvecChoixLVE'):false);lAutorisations.avecValidationAutomatique=lAutorisations.avecSaisie&&lAutorisations.avecSaisieItems&&lAutorisations.avecSaisieCompetences&&!lMultiSelection;}
this.callbackReussite.appel({message:lMessage,autorisations:lAutorisations,pilier:this.getPilier(),listeEleves:lListeEleves,listeNiveauxDAcquisitions:lListeNiveauxDAcquisitions,multiSelection:lMultiSelection,genreNotation:lGenreNotation});};_ObjetRequetePageCompetences.prototype.getPilier=function(){var lPilier=this.JSONReponse.pilier;lPilier.niveauDeploiement=3;return lPilier;};_ObjetRequetePageCompetences.prototype._ajouterEleve=function(aXml,aNoeud,I,aParametre){var lElement=aXml.GetElement(aNoeud);lElement.estSortiDeLEtablissement=aXml.GetVariable(aNoeud,'EstSortiDeLEtablissement');lElement.classe=aXml.GetElement(aNoeud,'Classe');lElement.niveauDAcquisition=aXml.GetElement(aNoeud,'NiveauDAcquisition');lElement.observation=aXml.GetVariable(aNoeud,'Observation');lElement.date=aXml.GetVariable(aNoeud,'Date');lElement.languePourBrevet=aXml.GetVariable(aNoeud,'LanguePourBrevet');this.rang= -1;lElement.listeCompetences=new ObjetListeElements();aXml.Parcourir(aNoeud,'Competence',this,this._ajouterCompetence,false,lElement.listeCompetences);lElement.listeCompetences.setTri([ObjetTri.init('_rang'),ObjetTri.init(function(aElement){return(aElement.GetGenre()===EGenreRessource.Evaluation)||(aElement.GetGenre()===EGenreRessource.EvaluationHistorique);}),ObjetTri.init('dateValidation',EGenreTriElement.Decroissant)]);lElement.listeCompetences.trier();aParametre.AddElement(lElement);};_ObjetRequetePageCompetences.prototype._ajouterCompetence=function(aXml,aNoeud,I,aParametre){var lElement=aXml.GetElement(aNoeud);lElement.optionnel=aXml.GetVariable(aNoeud,'Optionnel');lElement.nombreFils=0;lElement.nombreSousItems=0;var lEstEvaluation=(lElement.GetGenre()===EGenreRessource.Evaluation)||(lElement.GetGenre()===EGenreRessource.EvaluationHistorique);if(this.pilier){if(lElement.GetGenre()===EGenreRessource.SousItem)
this.pilier.avecSousItem=true;if(lElement.GetGenre()===EGenreRessource.Evaluation)
this.pilier.avecEvaluation=true;}
if(this.tableauPeres===undefined||this.tableauPeres===null)
this.tableauPeres=[];this.tableauPeres[lElement.GetGenre()]=lElement;if(!lEstEvaluation)
this.evaluationPere=lElement;lElement.competencePere=this.tableauPeres[this._getGenrePere(lElement.GetGenre(),this.evaluationPere.GetGenre())];if(lElement.competencePere){lElement.competencePere.nombreFils++;if((lElement.GetGenre()===EGenreRessource.SousItem)&&(!lElement.optionnel))
lElement.competencePere.nombreSousItems++;}
lElement.periode=lEstEvaluation?aXml.GetElement(aNoeud,'Periode'):null;lElement.dateValidation=lEstEvaluation?aXml.GetVariable(aNoeud,'DateValidation'):0;lElement.niveauDAcquisition=aXml.GetElement(aNoeud,'NiveauDAcquisition');lElement.optionnel=aXml.GetVariable(aNoeud,'Optionnel');lElement.date=aXml.GetVariable(aNoeud,'Date');lElement.dateMultiple=aXml.GetVariable(aNoeud,'DateMultiple');lElement.observation=aXml.GetVariable(aNoeud,'Observation');if(aXml.Existe(aNoeud,'Ind'))
lElement.individuValidation=aXml.GetElement(aNoeud,'Ind');if(aXml.Existe(aNoeud,'Verrou'))
lElement.avecVerrou=aXml.GetVariable(aNoeud,'Verrou');if(aXml.Existe(aNoeud,'LibelleCorrige'))
lElement.libelleCorrige=aXml.GetVariable(aNoeud,'LibelleCorrige');lElement.estAnneePrecedente=(lElement.GetGenre()!==EGenreRessource.EvaluationHistorique)&&EGenreNiveauDAcquisition.estAcquis(lElement.niveauDAcquisition.GetGenre())&&lElement.date&&(lElement.date<GParametres.PremiereDate);if(!lEstEvaluation)
this.rang++;lElement._rang=this.rang;if(this.competence&&(this.competence.GetGenre()===lElement.GetGenre())&&(this.competence.GetNumero()===lElement.GetNumero()))
aParametre.competence=lElement;else aParametre.AddElement(lElement);};_ObjetRequetePageCompetences.prototype._getGenrePere=function(aGenre,aGenrePourEvaluation){switch(aGenre){case EGenreRessource.ElementPilier:return null;case EGenreRessource.Competence:return EGenreRessource.ElementPilier;case EGenreRessource.SousItem:return EGenreRessource.Competence;case EGenreRessource.Evaluation:case EGenreRessource.EvaluationHistorique:return aGenrePourEvaluation;}};;
MethodesObjet.heritagePrototype(InterfacePageCompetences_Releve,_ObjetAffichagePageCompetences);function InterfacePageCompetences_Releve(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);}
InterfacePageCompetences_Releve.prototype.ConstruireInstances=function(){this.identComboPilier=this.Add(window.ObjetSaisiePN ,this.evenementSurComboPilier ,this.initialiserComboPilier);this.IdPremierElement=this.GetInstance(this.identComboPilier).getPremierElement();this.identComboPalier=this.Add(window.ObjetSaisiePN ,this.evenementSurComboPalier ,this.initialiserComboPalier);this.identLanguePourBrevet=this.Add(window.ObjetCheckBox ,this.surEditionLanguePourBrevet ,this.initialiserLanguePourBrevet);this.identPage=this.Add(window.ObjetCompetences_Releve ,null ,null);};InterfacePageCompetences_Releve.prototype.SetParametresGeneraux=function(){this.AddSurZone=[this.identComboPilier,this.identComboPalier,this.identLanguePourBrevet];this.IdentZoneAlClient=this.identPage;};InterfacePageCompetences_Releve.prototype.RecupererDonnees=function(){var lListePiliers=GEtatUtilisateur.getOngletListePiliers();var lNbrPiliers=lListePiliers?lListePiliers.GetNbrElements():0;if(lNbrPiliers===0){GHtml.setDisplay(this.GetInstance(this.identComboPilier).GetNom(),false);this.EvenementAfficherMessage(EGenreMessage.AucunPilierPourEleve);} else{this.GetInstance(this.identComboPilier).SetDonnees(lListePiliers,0);this.GetInstance(this.identComboPilier).setSelectionParIndice(GEtatUtilisateur.getIndiceCompetence());}};InterfacePageCompetences_Releve.prototype.AfficherPage=function(){new _ObjetRequetePageCompetences(this,this.actionSurAfficherPage).lancerRequete({eleve:GEtatUtilisateur.getMembre(),palier:this.selection.palier,pilier:this.selection.pilier,service:this.selection.pilier.service});};InterfacePageCompetences_Releve.prototype.initialiserComboPilier=function(aInstance){aInstance.SetParametres(true,false,425);};InterfacePageCompetences_Releve.prototype.initialiserComboPalier=function(aInstance){aInstance.SetParametres(true,false,100);};InterfacePageCompetences_Releve.prototype.evenementSurComboPilier=function(aGenreEvenement,aElement){if(aGenreEvenement===EGenreEvenementObjetSaisie.selection){this.selection={pilier:aElement};this.GetInstance(this.identComboPalier).SetDonnees(aElement.listePaliers,0);}};InterfacePageCompetences_Releve.prototype.evenementSurComboPalier=function(aGenreEvenement,aElement){if(aGenreEvenement===EGenreEvenementObjetSaisie.selection){this.selection.palier=aElement;this.AfficherPage();}};InterfacePageCompetences_Releve.prototype.Valider=function(){if(this.eleve.languePourBrevet){var lParam={numeroEleve:GEtatUtilisateur.GetNumeroEleve(),langueSelectionnee:this.selection.pilier.service};new ObjetRequeteSaisieCompetences_LVE(this,this.ActionSurValidation).lancerRequete(lParam);}
else this.AfficherPage();};;

MethodesObjet.heritagePrototype(_ObjetListeAppreciations,_ObjetGrilleAffichage);function _ObjetListeAppreciations(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.IdCoche=this.Nom+'_Coche';this.IdTableauTitre=this.Nom+'_TableauTitre';this.IdTableauAutre=this.Nom+'_TableauAutre';this.ScrollV=new ObjetScroll(this.Nom+'.ScrollV',null,this,this.GetScrollTop,EGenreScroll.Vertical);this.tailleMaxSaisie=255;if(this.Nom){this.ajouterEvenementGlobal(EEvent.SurPreResize ,this.SurPreResize);this.ajouterEvenementGlobal(EEvent.SurPostResize,this.SurPostResize);}}
_ObjetListeAppreciations.prototype.DetruireInstances=function(){clearInterval(this.Timer);};_ObjetListeAppreciations.prototype.effacer=function(aMessage){this.inherited('effacer',aMessage);this.DonneesRecues=false;};_ObjetListeAppreciations.prototype.actualiserDimensions=function(){};_ObjetListeAppreciations.prototype.ComposeTableauTitre=function(){return'';};_ObjetListeAppreciations.prototype.ComposeTableau=function(){return'';};_ObjetListeAppreciations.prototype.ComposeAutre=null;_ObjetListeAppreciations.prototype.GetScrollTop=function(aGenre,aScrollTop){var lHauteur=this.getHauteurScrollTop();if(aGenre===EGenreScrollEvenement.TailleZone)
aScrollTop=GPosition.getHeight(this.Nom)-GPosition.getHeight(this.IdTableauTitre)-(this.ComposeAutre?GPosition.getHeight(this.IdTableauAutre):0);switch(aGenre){case EGenreScrollEvenement.Deplacement:return lHauteur*Math.round(aScrollTop/lHauteur);case EGenreScrollEvenement.TailleZone:return lHauteur*Math.floor(aScrollTop/lHauteur);case EGenreScrollEvenement.TailleContenu:return null;}};_ObjetListeAppreciations.prototype.surPostAfficher=function(){};_ObjetListeAppreciations.prototype.ConstruireAffichage=function(){if(!this.DonneesRecues)
return'';var LLongueurPourAppreciations=GPosition.getWidth(this.Nom)-GNavigateur.GetLargeurBarreDeScroll()-this.GetLargeurEleve()-10;this.LargeurAppreciation=Math.floor(LLongueurPourAppreciations/this.NombreColonnes);this.Pere.surResizeInterface();this.Afficher(this.ComposePage());this.surPostAfficher();this.ScrollV.SetDonnees(0);};_ObjetListeAppreciations.prototype.ComposePage=function(aPourImpression,aNumeroImpression){var lPourImpression=(aPourImpression?aPourImpression:false);this.actualiserDimensions(aPourImpression,aNumeroImpression);var T=[];if(lPourImpression){T.push('<div ',GObjetWAI.composeRole(EGenreRole.Grid),' >');T.push(this.ComposeTableauTitre(true,aNumeroImpression));T.push(this.ComposeTableau(true,aNumeroImpression));if(this.ComposeAutre)
T.push(this.ComposeAutre(true,aNumeroImpression));T.push('</div>');} else{T.push('<table ',GObjetWAI.composeRole(EGenreRole.Grid),' border="0" cellspacing="0" cellpadding="0">');T.push('<tr>');T.push('<td id="'+this.IdTableauTitre+'" height="10px">'+this.ComposeTableauTitre()+'</td>');T.push('</tr>');T.push('<tr>');T.push('<td valign="top">');T.push('<div id="'+this.ScrollV.GetIdZone()+'" tabIndex="-1" style="height:1px; overflow:hidden;" onscroll="'+this.Nom+'.ScrollV.Actualiser (0)">');T.push(this.ComposeTableau());T.push('</div>');T.push('</td>');T.push('<td id="'+this.ScrollV.GetIdScroll()+'"></td>');T.push('</tr>');T.push('</table>');if(this.ComposeAutre)
T.push('<div id="'+this.IdTableauAutre+'">'+this.ComposeAutre(lPourImpression,aNumeroImpression)+'</div>');}
return T.join('');};_ObjetListeAppreciations.prototype.Reset=function(){this.setCellule(0,0);this.Modifie=false;for(var I=0;I<this.Liste.GetNbrElements();I++){var LElement=this.Liste.GetElement(I);LElement.Modifie=false;LElement.Modifies=[];for(var J=0;J<this.NombreColonnes;J++)
LElement.Modifies[J]=false;}};_ObjetListeAppreciations.prototype.Deployer=function(ADeployer){if(ADeployer!==null)
this.Deployer=ADeployer;};_ObjetListeAppreciations.prototype.SurPreResize=function(){if(!this.DonneesRecues) return;this.Afficher('&nbsp;');};_ObjetListeAppreciations.prototype.SurPostResize=function(){if(!this.DonneesRecues) return;this.Afficher();};_ObjetListeAppreciations.prototype.selectionnerEleveCourant=function(){var lTrouve=false;var lEleve=GEtatUtilisateur.Navigation.GetRessource(EGenreRessource.Eleve);if(lEleve&&!lEleve.multiSelection){var lNbLigneParEleve=this.nbLignesParEleve?this.nbLignesParEleve:1 ;for(var I=0;I<this.Liste.GetNbrElements();I+=lNbLigneParEleve){var lElement=this.Liste.GetElement(I);if(lElement.GetNumero()===lEleve.GetNumero()){lTrouve=true;this.NumLigne=I+(lNbLigneParEleve===1?1:2);this.selectionnerLigne();break;}}}
return lTrouve;};;
MethodesObjet.heritagePrototype(ObjetLivretScolaire,_ObjetListeAppreciations);function ObjetLivretScolaire(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.largeursColonnes=this._getLargeursColonnes();this.genreColonnes={discipline:0,periode:1,rang:2,moyEleve:3,moyClasse:4,inf8:5,de8a12:6,sup12:7,itemCompetence:8,evaluation:9,appreciation:10,appr_Ann:11};this.id=[];this.id[this.genreColonnes.discipline]="colDiscipline";this.id[this.genreColonnes.periode]="colPeriode";this.id[this.genreColonnes.rang]="colRang";this.id[this.genreColonnes.moyEleve]="colMoyEleve";this.id[this.genreColonnes.moyClasse]="colMoyClasse";this.id[this.genreColonnes.inf8]="colInf8";this.id[this.genreColonnes.de8a12]="colDe8A12";this.id[this.genreColonnes.sup12]="colSup12";this.id[this.genreColonnes.itemCompetence]="colCompetence";this.id[this.genreColonnes.evaluation]="colEvaluation";this.id[this.genreColonnes.appreciation]="colAppreciation";this.id[this.genreColonnes.appr_Ann]="colAppr_Ann";}
ObjetLivretScolaire.prototype.SetDonnees=function(aDonnees){this.donnees=aDonnees;if(this.donnees){this.affichage={};this.affichage.avecRangEleve=!this.donnees.options||this.donnees.options.contains(TypeOptionMaquetteLivretScolaireStandard.OMLST_AvecRangEleve)||this.donnees.estFilierePro;this.affichage.avecMoyenneEleve=!this.donnees.options||this.donnees.options.contains(TypeOptionMaquetteLivretScolaireStandard.OMLST_AvecMoyenneEleve)||this.donnees.estFilierePro;this.affichage.avecMoyenneClasse=(this.donnees.genre===EGenreOnglet.LivretScolaire_Fiche)&&(!this.donnees.options||this.donnees.options.contains(TypeOptionMaquetteLivretScolaireStandard.OMLST_AvecMoyenneClasse)||this.donnees.estFilierePro);this.affichage.avecRepartition=(this.donnees.genre===EGenreOnglet.LivretScolaire_Fiche)&&(!this.donnees.options||this.donnees.options.contains(TypeOptionMaquetteLivretScolaireStandard.OMLST_AvecRepartitionMoyenne)||this.donnees.estFilierePro);this.affichage.avecCompetences=(this.donnees.genre===EGenreOnglet.LivretScolaire_Fiche)&&this.donnees.avecFiliere;this.affichage.avecAppreciationsPeriode=!this.donnees.options||this.donnees.options.contains(TypeOptionMaquetteLivretScolaireStandard.OMLST_AvecAppreciationsParPeriode);this.affichage.avecAppreciations=this.affichage.avecAppreciationsPeriode||(this.donnees.options.contains(TypeOptionMaquetteLivretScolaireStandard.OMLST_AvecAppreciation)&&this.donnees.options.contains(TypeOptionMaquetteLivretScolaireStandard.OMLST_AvecMoyenneAnnuelle));this.affichage.avecColonneAppreciationsAnnuelles=this.donnees.options&&(this.donnees.options.contains(TypeOptionMaquetteLivretScolaireStandard.OMLST_AvecAppreciation)&&!this.donnees.options.contains(TypeOptionMaquetteLivretScolaireStandard.OMLST_AvecMoyenneAnnuelle));this.nombreComptences=0;this.largeurColCompetence=0;this.tabTitresCompetences=[];switch(this.donnees.genre){case EGenreOnglet.LivretScolaire_Fiche:if(this.donnees.eleve.listeLivret.GetNbrElements()>0){this.NombreColonnes=1;this.Titres=new ObjetListeElements();this.Titres.AddElement(new ObjetElement(''));this.Liste=this._getListeDonneesLineaire(this.donnees.eleve.listeLivret,this.donnees.classe.listeLivret,'Livret');this.listeMoyGenerale=this._getListeDonneesLineaire(this.donnees.eleve.listeMoyenne,this.donnees.classe.listeMoyenne,'Moyenne');this.NombreLignes=this.Liste.GetNbrElements();this.DonneesRecues=true;this.ConstruireAffichage();}
else this.Afficher(this.composeMessage(GTraductions.getValeur('ficheScolaire.messageAucunServicePourEleve')));break;case EGenreOnglet.LivretScolaire_Appreciations:case EGenreOnglet.LivretScolaire_Competences:if(this.donnees.service.listeLivret.GetNbrElements()>0){if(this.donnees.genre===EGenreOnglet.LivretScolaire_Competences){var lElement=this.donnees.service.listeLivret.GetElement(0);if(lElement&&lElement.listeCompetences){this.nombreComptences=lElement.listeCompetences.GetNbrElements();if(this.nombreComptences>0){this.largeurColCompetence=60;}
for(var i=0;i<this.nombreComptences;i++)
this.tabTitresCompetences.push(lElement.listeCompetences.GetLibelle(i));}}
this.NombreColonnes=1;this.Titres=new ObjetListeElements();this.Titres.AddElement(new ObjetElement(''));this.Liste=this._getListeDonneesLineaire(this.donnees.service.listeLivret,null,'Livret');this.listeMoyGenerale=this._getListeDonneesLineaire(this.donnees.service.listeMoyenne,null,'Moyenne');this.NombreLignes=this.Liste.GetNbrElements();this.DonneesRecues=true;this.ConstruireAffichage();}
else this.Afficher(this.composeMessage(GTraductions.getValeur('ficheScolaire.messageAucuneDonneeDiscipline')));break;default:;}} else{this.Afficher(this.composeMessage(GTraductions.getValeur('ficheScolaire.messageAucuneDonnee')));}};ObjetLivretScolaire.prototype._getListeDonneesLineaire=function(aListeElements,aListeClasse,aPrefixe){var lListe=new ObjetListeElements();this.elmPere=null;for(var i=0;i<aListeElements.GetNbrElements();i++){var lElement=aListeElements.GetElement(i);var lElmClasse;if(aListeClasse)
lElmClasse=aListeClasse.GetElement(i);lListe.AddElement(this._getElementListe(lElement,lElmClasse,aPrefixe));}
return lListe;};ObjetLivretScolaire.prototype._getElementListe=function(aElement,aElmClasse,aPrefixe){var lElement=new ObjetElement(aElement.GetLibelle(),aElement.GetNumero(),aElement.GetGenre());lElement.titreEnseignement=aElement.titreEnseignement;lElement.derniereligne=aElement.derniereligne;lElement.dernierDuService=aElement.dernierDuService;lElement.deploye=true;lElement.estVisible=true;lElement.livretEditable=aElement.livretEditable;lElement.avecRegroupement=aElement.avecRegroupement;if(lElement.titreEnseignement){lElement.idPere='';lElement.pere=null;this.elmPere=lElement;return lElement;}
if(this.donnees&&!this.donnees.avecFiliere&&!lElement.avecRegroupement)
this.elmPere=null;if(this.elmPere)
lElement.idPourPere=aPrefixe+'_'+this.elmPere.GetGenre()+'_'+lElement.GetGenre();lElement.pere=this.elmPere;lElement.titreDiscipline=aElement.titreDiscipline;lElement.estSansObligationDeNotation=aElement.estSansObligationDeNotation;lElement.titreService=aElement.titreService;lElement.avecServices=aElement.avecServices;lElement.titreEnseignant=aElement.titreEnseignant;lElement.metaMatiere=aElement.metaMatiere;lElement.service=aElement.service;lElement.eleve=aElement.eleve;lElement.nombreLignes=aElement.nombreLignes;if(!this.donnees.avecFiliere&&this.donnees.genre!==EGenreOnglet.LivretScolaire_Competences) lElement.nombreLignes=1;lElement.periode=aElement.periode;lElement.moyEleve=aElement.moyEleve;if(aElmClasse){lElement.moyClasse=aElmClasse?aElmClasse.moyClasse:null;lElement.rang=aElement?aElement.rangEleve:null;lElement.rangSur=aElmClasse?aElmClasse.rangTotal:null;lElement.inf8=aElmClasse?aElmClasse.inf8:null;lElement.de8a12=aElmClasse?aElmClasse.de8a12:null;lElement.sup12=aElmClasse?aElmClasse.sup12:null;} else{var lNumeroPeriode=lElement.periode.GetNumero();var lIndice=this.donnees.service.listeMoyenne.getIndiceElementParFiltre(function(aElement){return aElement.periode&&aElement.periode.GetNumero()===lNumeroPeriode;});var lElmClassePeriode=this.donnees.service.listeMoyenne.GetElement(lIndice);if(lElmClassePeriode){lElement.rang=aElement.moyEleve?(lElmClassePeriode?this._getClassementEleve(aElement.moyEleve,lElmClassePeriode.tabMoyennes):0):0;lElement.rangSur=lElmClassePeriode.tabMoyennes.length;} else{lElement.rang=aElement.rang;lElement.rangSur=aElement.rangSur;}
lElement.moyClasse=aElement.moyClasse;lElement.inf8=aElement.inf8;lElement.de8a12=aElement.de8a12;lElement.sup12=aElement.sup12;}
lElement.itemLivretScolaire=aElement.itemLivretScolaire;lElement.listeCompetences=aElement.listeCompetences;lElement.ListeAppreciations=new ObjetListeElements();var lAppreciation;if(this.affichage.avecAppreciations&&this.affichage.avecColonneAppreciationsAnnuelles){if(aElement.appreciation){lAppreciation=new ObjetElement(aElement.appreciation);lAppreciation.editable=false;lElement.ListeAppreciations.AddElement(lAppreciation);}
if(aElement.appreciationAnnuelle){lElement.ListeAppreciations.AddElement(aElement.appreciationAnnuelle);}
lElement.Editable=false;} else{if((!this.affichage.avecColonneAppreciationsAnnuelles&&aElement.appreciationAnnuelle)||this.donnees.avecFiliere)
lElement.ListeAppreciations.AddElement(aElement.appreciationAnnuelle);else if(aElement.appreciation){lAppreciation=new ObjetElement(aElement.appreciation);lAppreciation.editable=false;lElement.ListeAppreciations.AddElement(lAppreciation);} else{lElement.ListeAppreciations.AddElement(new ObjetElement(''));}
if(this.affichage.avecColonneAppreciationsAnnuelles){if(aElement.appreciationAnnuelle)
lElement.ListeAppreciations.AddElement(aElement.appreciationAnnuelle);else lElement.ListeAppreciations.AddElement(new ObjetElement(''));}
lElement.Editable=aElement.appreciationAnnuelle?aElement.appreciationAnnuelle.editable:false;}
lElement.rowspan=aElement.rowspan;return lElement;};ObjetLivretScolaire.prototype._getClassementEleve=function(aMoyEleve,aTabMoyenne){if(!aMoyEleve.estUneValeur()) return 0;var lRang=1;for(var i=0;i<aTabMoyenne.length;i++){if((aTabMoyenne[i].estUneValeur())&&(aTabMoyenne[i].getValeur()>aMoyEleve.getValeur()))
lRang+=1;}
return lRang;};ObjetLivretScolaire.prototype.ComposeTableauTitre=function(aPourImpression,aNumeroImpression){var lClassTable=aPourImpression?this.TaillePolice[aNumeroImpression]:'Texte10';var lStyleTable=GTableau.styleTableau(aPourImpression,true,EGenreBordure.gauche+EGenreBordure.haut);var T=[],lCell;var lCorrection=0;T.push('<table ',GObjetWAI.composeRole(EGenreRole.Row),' class="'+lClassTable+'" style="'+lStyleTable+'" border="0" cellspacing="0" cellpadding="0">');T.push('<tr>');if(!aPourImpression){var lLargeurColService=this.largeursColonnes.discipline+this.largeursColonnes.periode+4+(this.donnees.avecFiliere?1:0);var lLibelle=GTraductions.getValeur('ficheScolaire.titreColDiscipline');if(this.donnees&&this.donnees.genre!==EGenreOnglet.LivretScolaire_Fiche&&this.donnees.service.titre)
lLibelle=this.donnees.service.titre;T.push(this.composeCelluleTitre(aPourImpression,lLargeurColService,this.composeLibellePourTableau(lLibelle,lLargeurColService-lCorrection),null,EGenreRole.Columnheader));}
else{lCell=new EltCell();lCell.creerCelluleTitre(aPourImpression,this.largeursColonnes.discipline,GTraductions.getValeur('ficheScolaire.titreColDiscipline'));lCell.colspan=2;T.push(this.composeCellule(lCell));T.push(this.composeCelluleTitre(aPourImpression,this.largeursColonnes.periode,GTraductions.getValeur('ficheScolaire.titreColAbbrPeriode'),null,EGenreRole.Columnheader));}
if(this.affichage.avecRangEleve)
T.push(this.composeCelluleTitre(aPourImpression,this.largeursColonnes.rang,this.composeLibellePourTableau(GTraductions.getValeur('ficheScolaire.titreColRang'),this.largeursColonnes.rang-lCorrection),null,EGenreRole.Columnheader));if(this.affichage.avecMoyenneEleve)
T.push(this.composeCelluleTitre(aPourImpression,this.largeursColonnes.moyEleve,this.composeLibellePourTableau(GTraductions.getValeur('ficheScolaire.titreColAbbrMoyEleve'),this.largeursColonnes.moyEleve-lCorrection),GTraductions.getValeur('ficheScolaire.titreColMoyEleve'),EGenreRole.Columnheader));if(this.affichage.avecMoyenneClasse)
T.push(this.composeCelluleTitre(aPourImpression,this.largeursColonnes.moyClasse,this.composeLibellePourTableau(GTraductions.getValeur('ficheScolaire.titreColAbbrMoyClasse'),this.largeursColonnes.moyClasse-lCorrection),GTraductions.getValeur('ficheScolaire.titreColMoyClasse'),EGenreRole.Columnheader));if(this.affichage.avecRepartition){T.push(this.composeCelluleTitre(aPourImpression,this.largeursColonnes.inf8,this.composeLibellePourTableau(GTraductions.getValeur('ficheScolaire.titreColInf8'),this.largeursColonnes.inf8-lCorrection),GTraductions.getValeur('ficheScolaire.Accessible.inf8'),EGenreRole.Columnheader));T.push(this.composeCelluleTitre(aPourImpression,this.largeursColonnes.de8a12,this.composeLibellePourTableau(GTraductions.getValeur('ficheScolaire.titreCol8A12'),this.largeursColonnes.de8a12-lCorrection),GTraductions.getValeur('ficheScolaire.Accessible.de8a12'),EGenreRole.Columnheader));T.push(this.composeCelluleTitre(aPourImpression,this.largeursColonnes.sup12,this.composeLibellePourTableau(GTraductions.getValeur('ficheScolaire.titreColSup12'),this.largeursColonnes.sup12-lCorrection),GTraductions.getValeur('ficheScolaire.Accessible.sup12'),EGenreRole.Columnheader));}
if(this.affichage.avecCompetences){var lLargeurColEval=this.largeursColonnes.itemCompetence+this.largeursColonnes.evaluation+4+1;lCell=new EltCell();lCell.creerCelluleTitre(aPourImpression,lLargeurColEval,this.composeLibellePourTableau(GTraductions.getValeur('ficheScolaire.titreColCompetences'),lLargeurColEval-lCorrection));if(aPourImpression) lCell.colspan=2;T.push(this.composeCellule(lCell));}
if(this.donnees.genre===EGenreOnglet.LivretScolaire_Competences){for(var i=0;i<this.nombreComptences;i++){T.push(this.composeCelluleTitre(aPourImpression,this.largeurColCompetence ,this.composeLibellePourTableau(this.tabTitresCompetences[i],this.largeurColCompetence-lCorrection),this.tabTitresCompetences[i],EGenreRole.Columnheader));}} else if(this.affichage.avecAppreciations){var lTradCol=this.donnees.options&&!this.donnees.options.contains(TypeOptionMaquetteLivretScolaireStandard.OMLST_AvecAppreciationsParPeriode)?GTraductions.getValeur('ficheScolaire.titreColAppreciationsAnn'):GTraductions.getValeur('ficheScolaire.titreColAppreciations');T.push(this.composeCelluleTitre(aPourImpression,this.largeursColonnes.appreciation ,this.composeLibellePourTableau(lTradCol,this.largeursColonnes.appreciation-lCorrection),null,EGenreRole.Columnheader));}
if(this.affichage.avecColonneAppreciationsAnnuelles)
T.push(this.composeCelluleTitre(aPourImpression,this.largeursColonnes.appr_Ann ,this.composeLibellePourTableau(GTraductions.getValeur('ficheScolaire.titreColAppreciationsAnn'),this.largeursColonnes.appreciation-lCorrection),null,EGenreRole.Columnheader));T.push('</tr>');if(!aPourImpression)
T.push('</table>');return T.join('');};ObjetLivretScolaire.prototype.composeLibellePourTableau=function(aLibelle,aLargeur,aHeight,aArrayClass){var lResult=aLibelle;var lClasse=aArrayClass?'class="'+aArrayClass.join(' ')+'" ':'';var lHeight=aHeight?GStyle.composeHeight(aHeight)+' overflow: hidden; white-space: nowrap;':'overflow-x:hidden;';if(aLargeur)
lResult='<div '+lClasse+'style="'+GStyle.composeWidth(aLargeur)+' '+lHeight+'">'+aLibelle+'</div>';return lResult;};ObjetLivretScolaire.prototype.ComposeTableau=function(aPourImpression,aNumeroImpression){var lClassTable='Tableau '+(aPourImpression?this.TaillePolice[aNumeroImpression]:'Texte10');var lStyleTable=GTableau.styleTableau(aPourImpression,true,EGenreBordure.gauche)+'border-collapse:separate;';var lStyleTitreAvec=GTableau.styleCumul(aPourImpression,true,EGenreBordure.bas+EGenreBordure.droite,2);var lStyleTitreSans=GTableau.styleTitre(aPourImpression,false);var lStyleTitreFin=GTableau.styleTitre(aPourImpression,true,EGenreBordure.bas);var lStyleTitreLigneAvec=GTableau.styleMoyenne(aPourImpression,true,EGenreBordure.droite+EGenreBordure.bas,false);var lStyleTitreLigneSans=GTableau.styleMoyenne(aPourImpression,false,null,false);var lStyleTitreLigneFin=GTableau.styleMoyenne(aPourImpression,true,EGenreBordure.bas,false);var lStylePeriodeAvec=GTableau.styleMoyenne(aPourImpression,true,EGenreBordure.droite+EGenreBordure.bas,false);var lStylePeriodeSans=GTableau.styleMoyenne(aPourImpression,true,EGenreBordure.droite,false);var lStyleMoyenneAvec=GTableau.styleMoyenne(aPourImpression,true,EGenreBordure.droite+EGenreBordure.bas,true);var lStyleMoyenneSans=GTableau.styleMoyenne(aPourImpression,true,EGenreBordure.droite,true);var lStyleEdtitableAvec=GTableau.styleCellule(aPourImpression,true,EGenreBordure.droite+EGenreBordure.bas,true);var lStyleEdtitableSans=GTableau.styleCellule(aPourImpression,true,EGenreBordure.droite,true);var lStyleNonEdtitableAvec=GTableau.styleCellule(aPourImpression,true,EGenreBordure.droite+EGenreBordure.bas,false);var lStyleNonEdtitableSans=GTableau.styleCellule(aPourImpression,true,EGenreBordure.droite,false);var lAlignementHaut=' vertical-align : top;';var lHauteur=19;var T=[],j;if(!aPourImpression||this.donnees.genre!==EGenreOnglet.LivretScolaire_Fiche||this.donnees.avecFiliere)
T.push('<table id="'+this.ScrollV.GetIdContenu()+'" class="'+lClassTable+'" style="'+lStyleTable+'" border="0" cellspacing="0" cellpadding="0">');for(var I=0;I<this.Liste.GetNbrElements();I++){var lElement=this.Liste.GetElement(I);var lStyleTitre=lElement.titreEnseignement?lStyleTitreAvec:(lElement.derniereligne||lElement.dernierDuService?lStyleTitreFin:lStyleTitreSans);if(lElement.derniereligne) lStyleTitre=lStyleTitreSans+GStyle.composeCouleurBordure(aPourImpression?GCouleur.noir:GCouleur.cumul,1,EGenreBordure.bas);var lStyleTitreLigne=lElement.titreEnseignement?lStyleTitreLigneAvec:(lElement.derniereligne||lElement.dernierDuService?lStyleTitreLigneFin:lStyleTitreLigneSans);if(lElement.derniereligne) lStyleTitreLigne=lStyleTitreLigneSans+GStyle.composeCouleurBordure(aPourImpression?GCouleur.noir:GCouleur.liste.moyenne.bordure,1,EGenreBordure.bas);var lStylePeriode=lElement.derniereligne||lElement.dernierDuService||(lElement.periode&&lElement.periode.GetGenre()!==EGenrePeriodeDeNotation.Annuelle)?lStylePeriodeAvec:lStylePeriodeSans;if(lElement.derniereligne) lStylePeriode=lStylePeriodeSans+GStyle.composeCouleurBordure(aPourImpression?GCouleur.noir:GCouleur.liste.moyenne.bordure,1,EGenreBordure.bas);var lStyleMoyenne=lElement.derniereligne||lElement.dernierDuService||(lElement.periode&&lElement.periode.GetGenre()!==EGenrePeriodeDeNotation.Annuelle)?lStyleMoyenneAvec:lStyleMoyenneSans;if(lElement.derniereligne) lStyleMoyenne=lStyleMoyenneSans+GStyle.composeCouleurBordure(aPourImpression?GCouleur.noir:GCouleur.liste.total.bordure,1,EGenreBordure.bas);var lStyleEdtitable=lElement.derniereligne||lElement.periode?lStyleEdtitableAvec:lStyleEdtitableSans;if(lElement.derniereligne) lStyleEdtitable=lStyleEdtitableSans+GStyle.composeCouleurBordure(aPourImpression?GCouleur.noir:GCouleur.cumul,1,EGenreBordure.bas);var lStyleNonEdtitable=lElement.derniereligne||lElement.dernierDuService||(lElement.periode&&lElement.periode.GetGenre()!==EGenrePeriodeDeNotation.Annuelle)?lStyleNonEdtitableAvec:lStyleNonEdtitableSans;if(lElement.derniereligne) lStyleNonEdtitable=lStyleNonEdtitableSans+GStyle.composeCouleurBordure(aPourImpression?GCouleur.noir:GCouleur.cumul,1,EGenreBordure.bas);var lStyleNonEdtitable2=lElement.derniereligne||lElement.itemLivretScolaire?lStyleNonEdtitableAvec:lStyleNonEdtitableSans;if(lElement.derniereligne) lStyleNonEdtitable2=lStyleNonEdtitableSans+GStyle.composeCouleurBordure(aPourImpression?GCouleur.noir:GCouleur.cumul,1,EGenreBordure.bas);T.push('<tr ',GObjetWAI.composeRole(EGenreRole.Row),' id="',lElement.idPourPere,'" style="display:table-row">');if(lElement.titreEnseignement){T.push(this.composeTitreLigne(aPourImpression,I+1,lElement,lStyleTitre+lAlignementHaut,lHauteur));} else{T.push(this.composeDiscipline(aPourImpression,I+1,lElement,lStyleTitreLigne+lAlignementHaut,lHauteur));T.push(this.composePeriode(aPourImpression,I+1,lElement,lStylePeriode+lAlignementHaut,lHauteur));if(this.affichage.avecRangEleve)
T.push(this.composeRang(aPourImpression,I+1,lElement,lStyleNonEdtitable+lAlignementHaut,lHauteur));if(this.affichage.avecMoyenneEleve)
T.push(this.composeMoyEleve(aPourImpression,I+1,lElement,lStyleMoyenne+lAlignementHaut,lHauteur));if(this.affichage.avecMoyenneClasse)
T.push(this.composeMoyClasse(aPourImpression,I+1,lElement,lStyleMoyenne+lAlignementHaut,lHauteur));if(this.affichage.avecRepartition){T.push(this.composeInf8(aPourImpression,I+1,lElement,lStyleNonEdtitable+lAlignementHaut,lHauteur));T.push(this.composeDe8A12(aPourImpression,I+1,lElement,lStyleNonEdtitable+lAlignementHaut,lHauteur));T.push(this.composeSup12(aPourImpression,I+1,lElement,lStyleNonEdtitable+lAlignementHaut,lHauteur));}
if(this.affichage.avecCompetences){T.push(this.composeItemLivretScolaire(aPourImpression,I+1,lElement,lStyleNonEdtitable2+lAlignementHaut,lHauteur));}
if(this.donnees.genre===EGenreOnglet.LivretScolaire_Competences){if(lElement.listeCompetences)
for(j=0;j<this.nombreComptences;j++){var lElmCompetence=lElement.listeCompetences.GetElement(j);var lLibelle=(lElmCompetence&&lElmCompetence.evaluation?lElmCompetence.evaluation.abbreviation:'');var lHint=(lElmCompetence&&lElmCompetence.evaluation?lElmCompetence.evaluation.GetLibelle():'');T.push(this.composeCelluleCompetenceLivretScolaire(aPourImpression,this.largeurColCompetence,lLibelle,I+1,j+1,this.id[this.genreColonnes.evaluation],'AlignementMilieu Gras',lStyleEdtitable,EGenreModeSaisie.edition,lHint,lElement.nombreLignes,(lElement.nombreLignes*lHauteur),true));}} else if(this.affichage.avecAppreciations){if(this.affichage.avecAppreciationsPeriode)
T.push(this.composeAppreciations({pourImpression:aPourImpression,numLigne:I+1,element:lElement,style:(!lElement.Editable||lElement.titreDiscipline?lStyleNonEdtitable:lStyleEdtitable)+lAlignementHaut,hauteur:lHauteur}));else if(lElement.rowspan>0&&!this.affichage.avecColonneAppreciationsAnnuelles)
T.push(this.composeAppreciations({pourImpression:aPourImpression,numLigne:I+1,element:lElement,style:(!lElement.Editable||lElement.titreDiscipline?lStyleNonEdtitable:lStyleEdtitable)+lAlignementHaut,hauteur:lHauteur,rowspan:lElement.rowspan}));}
if(this.affichage.avecColonneAppreciationsAnnuelles&&(lElement.rowspan>0)){var lEditable=lElement.ListeAppreciations&&lElement.ListeAppreciations.GetElement(1)&&lElement.ListeAppreciations.GetElement(1).editable;T.push(this.composeAppreciations({pourImpression:aPourImpression,numLigne:I+1,element:lElement,style:(!lEditable||lElement.titreDiscipline?lStyleNonEdtitable:lStyleEdtitable)+lAlignementHaut,hauteur:lHauteur,estColonneAppreciationAnnuelle:true}));}}
T.push('</tr>');}
T.push('<tr>');T.push('<td><div style="',GStyle.composeWidth(12),GStyle.composeHeight(0),'"></div></td>','<td><div style="',GStyle.composeWidth(this.largeursColonnes.discipline-12),GStyle.composeHeight(0),'"></div></td>','<td><div style="',GStyle.composeWidth(this.largeursColonnes.periode),GStyle.composeHeight(0),'"></div></td>',this.affichage.avecRangEleve?'<td><div style="'+GStyle.composeWidth(this.largeursColonnes.rang)+GStyle.composeHeight(0)+'"></div></td>':'',this.affichage.avecMoyenneEleve?'<td><div style="'+GStyle.composeWidth(this.largeursColonnes.moyEleve)+GStyle.composeHeight(0)+'"></div></td>':'',this.affichage.avecMoyenneClasse?'<td><div style="'+GStyle.composeWidth(this.largeursColonnes.moyClasse)+GStyle.composeHeight(0)+'"></div></td>':'',this.affichage.avecRepartition?'<td><div style="'+GStyle.composeWidth(this.largeursColonnes.inf8)+GStyle.composeHeight(0)+'"></div></td>'+'<td><div style="'+GStyle.composeWidth(this.largeursColonnes.de8a12)+GStyle.composeHeight(0)+'"></div></td>'+'<td><div style="'+GStyle.composeWidth(this.largeursColonnes.sup12)+GStyle.composeHeight(0)+'"></div></td>':'',(this.affichage.avecCompetences?'<td><div style="'+GStyle.composeWidth(this.largeursColonnes.itemCompetence)+GStyle.composeHeight(0)+'"></div></td>':''),(this.affichage.avecCompetences?'<td><div style="'+GStyle.composeWidth(this.largeursColonnes.evaluation)+GStyle.composeHeight(0)+'"></div></td>':''));if(this.donnees.genre===EGenreOnglet.LivretScolaire_Competences){for(j=0;j<this.nombreComptences;j++)
T.push('<td><div style="',GStyle.composeWidth(this.largeurColCompetence),GStyle.composeHeight(0),'"></div></td>');} else{if(this.affichage.avecAppreciations) T.push('<td><div style="',GStyle.composeWidth(this.largeursColonnes.appreciation),GStyle.composeHeight(0),'"></div></td>');}
T.push('</tr>');if(!aPourImpression||this.donnees.genre!==EGenreOnglet.LivretScolaire_Fiche||this.donnees.avecFiliere)
T.push('</table>');return T.join('');};ObjetLivretScolaire.prototype.composeTitreLigne=function(aPourImpression,aNumLigne,aElement,aStyle,aHauteur){var T=[];var lLibelle=GChaine.toTexte(aElement.GetLibelle());if(!aPourImpression)
lLibelle=this.composeLibellePourTableau(lLibelle,this.largeurTotal-15,aHauteur-5);var lCell=new EltCell();lCell.creerCelluleStd(aPourImpression,this.largeurTotal-15,lLibelle,aNumLigne,this.id[this.genreColonnes.discipline],null,aStyle);var lColSpan=(this.donnees.avecFiliere?11:9);if(aPourImpression) lColSpan++;lCell.colspan=lColSpan;lCell.hauteurLigne=aHauteur;if(!aPourImpression){var lID=this.idCell(this.id[this.genreColonnes.discipline]+'Deploiement',aNumLigne,0);T.push(this.composeCelluleStd(aPourImpression,8,'<div tabindex="0" id="'+lID+'" class="Image_DeploiementListe_Deploye" onkeyup="if (GNavigateur.IsToucheSelection()) '+this.Nom+'.deploiementEnseignement(id, '+aNumLigne+')" onclick="'+this.Nom+'.deploiementEnseignement(id, '+aNumLigne+')"></div>',aNumLigne,'Regroupement','',GTableau.styleCumul(aPourImpression,false,null,2),null,null,null,EGenreRole.Rowheader));}
T.push(this.composeCellule(lCell));return T.join('');};ObjetLivretScolaire.prototype.deploiementEnseignement=function(aID,aNumLigne){var lElement=this.Liste.GetElement(aNumLigne-1);lElement.deploye=!lElement.deploye;$('#'+aID.escapeJQ()).toggleClass("Image_DeploiementListe_Deploye Image_DeploiementListe_NonDeploye");if(lElement.deploye)
$('[id^="Livret_'+lElement.GetGenre()+'_"]').show();else $('[id^="Livret_'+lElement.GetGenre()+'_"]').hide();this.ScrollV.SetDonnees();this.ScrollV.Actualiser(0);};ObjetLivretScolaire.prototype.composeDiscipline=function(aPourImpression,aNumLigne,aElement,aStyle,aHauteur){var T=[];var lCell=new EltCell();var lClass=[];var lLibelle=GChaine.toTexte(aElement.GetLibelle());var lHint=GChaine.GetLongueurChaine(lLibelle,10,aElement.titreDiscipline)>this.largeursColonnes.discipline-4?lLibelle:'';if(aElement.titreDiscipline) lClass.push('Gras');if(aElement.titreDiscipline&&!aElement.avecServices&&!aElement.estSansObligationDeNotation&&this.donnees.genre===EGenreOnglet.LivretScolaire_Fiche&&this.donnees.avecFiliere&&GEtatUtilisateur.GenreEspace===EGenreEspace.Professeur) lClass.push('TexteRouge');if(aElement.titreEnseignant||aElement.titreService) lClass.push('Italique');if(!aElement.avecRegroupement||aPourImpression){if(!aPourImpression)
lLibelle=this.composeLibellePourTableau(lLibelle,this.largeursColonnes.discipline,aHauteur-5,lClass);lCell.creerCelluleStd(aPourImpression,this.largeursColonnes.discipline,lLibelle,aNumLigne,this.id[this.genreColonnes.discipline],'AlignementGauche',aStyle,lHint,null,EGenreRole.Gridcell);lCell.hauteurLigne=aHauteur;lCell.colspan=2;} else{if(!aPourImpression)
lLibelle=this.composeLibellePourTableau(lLibelle,this.largeursColonnes.discipline-15,aHauteur-5,lClass);lCell.creerCelluleStd(aPourImpression,this.largeursColonnes.discipline-15,lLibelle,aNumLigne,this.id[this.genreColonnes.discipline],'AlignementGauche',aStyle,lHint,null,EGenreRole.Gridcell);lCell.hauteurLigne=aHauteur;T.push(this.composeCelluleStd(aPourImpression,8,'<div style="'+GStyle.composeWidth(8)+'"></div>',aNumLigne,'Regroupement','',GTableau.styleCumul(aPourImpression,false,null,2)));}
T.push(this.composeCellule(lCell));return T.join('');};ObjetLivretScolaire.prototype.composePeriode=function(aPourImpression,aNumLigne,aElement,aStyle,aHauteur){var T=[];var lLibelle=aElement.periode?aElement.periode.GetLibelle():'';if(!aPourImpression)
lLibelle=this.composeLibellePourTableau(lLibelle,this.largeursColonnes.periode,aHauteur-5,['Texte9','AlignementDroit']);T.push(this.composeCelluleStd(aPourImpression,this.largeursColonnes.periode,lLibelle,aNumLigne,this.id[this.genreColonnes.periode],'AlignementDroit',aStyle,null,null,null,EGenreRole.Gridcell));return T.join('');};ObjetLivretScolaire.prototype.composeRang=function(aPourImpression,aNumLigne,aElement,aStyle,aHauteur){var T=[];var lLibelle=aElement.rang?aElement.rang+'<span class="Texte9">'+'  /'+aElement.rangSur+'</span>':'&nbsp;';if(!aPourImpression)
lLibelle=this.composeLibellePourTableau(lLibelle,this.largeursColonnes.rang,aHauteur-5);T.push(this.composeCelluleStd(aPourImpression,this.largeursColonnes.rang,lLibelle,aNumLigne,this.id[this.genreColonnes.rang],'AlignementDroit',aStyle,null,null,null,EGenreRole.Gridcell));return T.join('');};ObjetLivretScolaire.prototype.composeMoyEleve=function(aPourImpression,aNumLigne,aElement,aStyle,aHauteur){var T=[];var lLibelle=GChaine.AvecEspaceSiVide(aElement.moyEleve?aElement.moyEleve.toString():'');if(!aPourImpression)
lLibelle=this.composeLibellePourTableau(lLibelle,this.largeursColonnes.moyEleve,aHauteur-5);T.push(this.composeCelluleStd(aPourImpression,this.largeursColonnes.moyEleve,lLibelle,aNumLigne,this.id[this.genreColonnes.moyEleve],'Gras AlignementDroit',aStyle,null,null,null,EGenreRole.Gridcell));return T.join('');};ObjetLivretScolaire.prototype.composeMoyClasse=function(aPourImpression,aNumLigne,aElement,aStyle,aHauteur){var T=[];var lLibelle=GChaine.AvecEspaceSiVide(aElement.moyClasse?aElement.moyClasse.toString():'');if(!aPourImpression)
lLibelle=this.composeLibellePourTableau(lLibelle,this.largeursColonnes.moyClasse,aHauteur-5);T.push(this.composeCelluleStd(aPourImpression,this.largeursColonnes.moyClasse,lLibelle,aNumLigne,this.id[this.genreColonnes.moyClasse],'AlignementDroit',aStyle,null,null,null,EGenreRole.Gridcell));return T.join('');};ObjetLivretScolaire.prototype.composeInf8=function(aPourImpression,aNumLigne,aElement,aStyle,aHauteur){var T=[];var lTxtPourcent='<span class="Texte9"> %</span>';var lLibelle=aElement.inf8?aElement.inf8+lTxtPourcent:'';if(!aPourImpression)
lLibelle=this.composeLibellePourTableau(lLibelle,this.largeursColonnes.inf8,aHauteur-5);T.push(this.composeCelluleStd(aPourImpression,this.largeursColonnes.inf8,lLibelle,aNumLigne,this.id[this.genreColonnes.inf8],'AlignementDroit',aStyle,null,null,null,EGenreRole.Gridcell));return T.join('');};ObjetLivretScolaire.prototype.composeDe8A12=function(aPourImpression,aNumLigne,aElement,aStyle,aHauteur){var T=[];var lTxtPourcent='<span class="Texte9"> %</span>';var lLibelle=aElement.de8a12?aElement.de8a12+lTxtPourcent:'';if(!aPourImpression)
lLibelle=this.composeLibellePourTableau(lLibelle,this.largeursColonnes.inf8,aHauteur-5);T.push(this.composeCelluleStd(aPourImpression,this.largeursColonnes.de8a12,lLibelle,aNumLigne,this.id[this.genreColonnes.de8a12],'AlignementDroit',aStyle,null,null,null,EGenreRole.Gridcell));return T.join('');};ObjetLivretScolaire.prototype.composeSup12=function(aPourImpression,aNumLigne,aElement,aStyle,aHauteur){var T=[];var lTxtPourcent='<span class="Texte9"> %</span>';var lLibelle=aElement.sup12?aElement.sup12+lTxtPourcent:'';if(!aPourImpression)
lLibelle=this.composeLibellePourTableau(lLibelle,this.largeursColonnes.inf8,aHauteur-5);T.push(this.composeCelluleStd(aPourImpression,this.largeursColonnes.sup12,lLibelle,aNumLigne,this.id[this.genreColonnes.sup12],'AlignementDroit',aStyle,null,null,null,EGenreRole.Gridcell));return T.join('');};ObjetLivretScolaire.prototype.composeItemLivretScolaire=function(aPourImpression,aNumLigne,aElement,aStyle,aHauteur){var T=[];var lLibelle=(aElement.itemLivretScolaire?aElement.itemLivretScolaire.GetLibelle():'');if(!aPourImpression)
lLibelle=this.composeLibellePourTableau(lLibelle,this.largeursColonnes.itemCompetence,aHauteur-5);T.push(this.composeCelluleStd(aPourImpression,this.largeursColonnes.itemCompetence,lLibelle,aNumLigne,this.id[this.genreColonnes.itemCompetence],'AlignementGauche',aStyle,(aElement.itemLivretScolaire?aElement.itemLivretScolaire.GetLibelle():'')));lLibelle=(aElement.itemLivretScolaire&&aElement.itemLivretScolaire.evaluation?aElement.itemLivretScolaire.evaluation.abbreviation:'');var lHint=(aElement.itemLivretScolaire&&aElement.itemLivretScolaire.evaluation?aElement.itemLivretScolaire.evaluation.GetLibelle():'');T.push(this.composeCelluleCompetenceLivretScolaire(aPourImpression,this.largeursColonnes.evaluation,lLibelle,aNumLigne,0,this.id[this.genreColonnes.evaluation],'AlignementMilieu',aStyle,EGenreModeSaisie.edition,lHint,null,aHauteur));return T.join('');};ObjetLivretScolaire.prototype.composeAppreciations=function(aParam){var T=[];var lEleve=aParam.element.eleve;var lService=aParam.element.service;var lMoyEleve=aParam.element.moyEleve;var lPeriode=aParam.estColonneAppreciationAnnuelle?null:aParam.element.periode;var lLabelWAI=(lEleve?lEleve.GetLibelle():(lService?lService.GetLibelle():aParam.element.GetLibelle()))+(lPeriode?'.'+lPeriode.GetLibelle():'')+(lMoyEleve?'.'+lMoyEleve.getNote():'');var lIndex=aParam.estColonneAppreciationAnnuelle?1:0;var lLargeur=aParam.estColonneAppreciationAnnuelle?this.largeursColonnes.appr_Ann:this.largeursColonnes.appreciation;var lGenreColonne=aParam.estColonneAppreciationAnnuelle?this.genreColonnes.appr_Ann:this.genreColonnes.appreciation;var lRowSpan=!aParam.rowspan?aParam.estColonneAppreciationAnnuelle&&(aParam.element.rowspan>0)?aParam.element.rowspan:aParam.element.nombreLignes:aParam.rowspan;var lAppreciation=aParam.element.ListeAppreciations.GetElement(lIndex);if(lAppreciation){var lLibelle=GChaine.toTexte(lAppreciation.GetLibelle());var lHint='';lLabelWAI+=' '+lLibelle;var lEditable=aParam.estColonneAppreciationAnnuelle?lAppreciation.editable:aParam.element.Editable;if(lEditable){var lElementEditable=aParam.element.Editable;aParam.element.Editable=true;if(!aParam.pourImpression)
lHint=GChaine.GetLongueurChaine(lLibelle,10,false)>(lLargeur-4)*2?lLibelle:'';var lModeSaisie=this.determinerModeSaisiePourCellule(lAppreciation);var lCurseur=this.determinerCurseurPourCellule(lAppreciation,aParam.pourImpression);T.push(this.composeCelluleAppreciation(aParam.pourImpression,lLargeur,lLibelle,aParam.numLigne,lIndex+1,this.id[lGenreColonne],''+lCurseur+'',aParam.style,lModeSaisie,lHint,lRowSpan,(((lRowSpan)*aParam.hauteur)+(this.donnees.avecFiliere?0:aParam.hauteur)),false,{genre:EGenreAttribut.label,valeur:lLabelWAI}));aParam.element.Editable=lElementEditable;} else{if(!aParam.pourImpression){lHint=GChaine.GetLongueurChaine(lLibelle,10,false)>lLargeur-4?lLibelle:'';lLibelle=this.composeLibellePourTableau(lLibelle,lLargeur,null);}
T.push(this.composeCelluleStd(aParam.pourImpression,lLargeur,lLibelle,aParam.numLigne,this.id[lGenreColonne],'GrasSurFocus AlignementGauche',aParam.style,lHint,lRowSpan,null,EGenreRole.GridCell,0,{genre:EGenreAttribut.label,valeur:lLabelWAI}));}} else{if(aParam.element.titreDiscipline){lRowSpan=Math.max(aParam.element.nombreLignes,this.donnees.classe.nombrePeriodes);T.push(this.composeCelluleStd(aParam.pourImpression,lLargeur,'',aParam.numLigne,this.id[lGenreColonne],'GrasSurFocus AlignementGauche',aParam.style,null,lRowSpan,null,EGenreRole.GridCell,0,{genre:EGenreAttribut.label,valeur:lLabelWAI}));}}
return T.join('');};ObjetLivretScolaire.prototype.ComposeAutre=function(aPourImpression,aNumeroImpression){switch(this.donnees.genre){case EGenreOnglet.LivretScolaire_Fiche:if(!this.donnees.avecFiliere)
return this.composeMoyenneLivretScolaire(aPourImpression,aNumeroImpression);else return'';break;case EGenreOnglet.LivretScolaire_Appreciations:case EGenreOnglet.LivretScolaire_Competences:if(this.donnees.service&&this.donnees.service.listeMoyenne&&this.donnees.service.listeMoyenne.GetNbrElements()>0)
return this.composeResultatDeLaClasse(aPourImpression,aNumeroImpression);else return'';break;default:return'';}};ObjetLivretScolaire.prototype.composeResultatDeLaClasse=function(aPourImpression,aNumeroImpression){var lClassTable=aPourImpression?this.TaillePolice[aNumeroImpression]:'Texte10';var lStyleTable=GTableau.styleTableau(aPourImpression,true,EGenreBordure.gauche+EGenreBordure.haut);var lStyleTitreAvec=GTableau.styleMoyenne(aPourImpression,true,EGenreBordure.droite+EGenreBordure.bas,false);var lStyleTitreSans=GTableau.styleMoyenne(aPourImpression,false,null,false);var lStyleTitreFin=GTableau.styleMoyenne(aPourImpression,true,EGenreBordure.bas,false);var lStylePeriodeAvec=GTableau.styleMoyenne(aPourImpression,true,EGenreBordure.droite+EGenreBordure.bas,false);var lStylePeriodeSans=GTableau.styleMoyenne(aPourImpression,true,EGenreBordure.droite,false);var lStyleMoyenneAvec=GTableau.styleMoyenne(aPourImpression,true,EGenreBordure.droite+EGenreBordure.bas,true);var lStyleMoyenneSans=GTableau.styleMoyenne(aPourImpression,true,EGenreBordure.droite,true);var lStyleNonEdtitableAvec=GTableau.styleCellule(aPourImpression,true,EGenreBordure.droite+EGenreBordure.bas,false);var lStyleNonEdtitableSans=GTableau.styleCellule(aPourImpression,true,EGenreBordure.droite,false);var lAlignementHaut=' vertical-align : top;';var lHauteur=19;var T=[];T.push('<div style="height: 5px;"></div>');T.push('<table class="'+lClassTable+'" style="'+lStyleTable+'" border="0" cellspacing="0" cellpadding="0">');T.push('<tr>');var lLargeurColService=this.largeursColonnes.discipline+this.largeursColonnes.periode+4+(this.donnees.avecFiliere?1:0);var lCell=new EltCell();lCell.creerCelluleTitre(aPourImpression,lLargeurColService,this.composeLibellePourTableau('',lLargeurColService));lCell.colspan=3;T.push(this.composeCellule(lCell));T.push(this.composeCelluleTitre(aPourImpression,this.largeursColonnes.moyClasse,this.composeLibellePourTableau(GTraductions.getValeur('ficheScolaire.titreColAbbrMoyClasse'),this.largeursColonnes.moyClasse),GTraductions.getValeur('ficheScolaire.titreColMoyClasse'),EGenreRole.Columnheader));T.push(this.composeCelluleTitre(aPourImpression,this.largeursColonnes.inf8,this.composeLibellePourTableau(GTraductions.getValeur('ficheScolaire.titreColInf8'),this.largeursColonnes.inf8),GTraductions.getValeur('ficheScolaire.Accessible.inf8'),EGenreRole.Columnheader));T.push(this.composeCelluleTitre(aPourImpression,this.largeursColonnes.de8a12,this.composeLibellePourTableau(GTraductions.getValeur('ficheScolaire.titreCol8A12'),this.largeursColonnes.de8a12),GTraductions.getValeur('ficheScolaire.Accessible.de8a12'),EGenreRole.Columnheader));T.push(this.composeCelluleTitre(aPourImpression,this.largeursColonnes.sup12,this.composeLibellePourTableau(GTraductions.getValeur('ficheScolaire.titreColSup12'),this.largeursColonnes.sup12),GTraductions.getValeur('ficheScolaire.Accessible.sup12'),EGenreRole.Columnheader));T.push('</tr>');for(var I=0;I<this.listeMoyGenerale.GetNbrElements();I++){var lElement=this.listeMoyGenerale.GetElement(I);lElement.dernierDuService=lElement.derniereligne||(I===this.listeMoyGenerale.GetNbrElements()-1);var lStyleTitre=lElement.titreEnseignement?lStyleTitreAvec:(lElement.derniereligne||lElement.dernierDuService?lStyleTitreFin:lStyleTitreSans);if(lElement.derniereligne) lStyleTitre=lStyleTitreSans+GStyle.composeCouleurBordure(aPourImpression?GCouleur.noir:GCouleur.cumul,1,EGenreBordure.bas);var lStylePeriode=lElement.derniereligne||lElement.dernierDuService||lElement.periode?lStylePeriodeAvec:lStylePeriodeSans;if(lElement.derniereligne) lStylePeriode=lStylePeriodeSans+GStyle.composeCouleurBordure(aPourImpression?GCouleur.noir:GCouleur.liste.moyenne.bordure,1,EGenreBordure.bas);var lStyleMoyenne=lElement.derniereligne||lElement.dernierDuService||lElement.periode?lStyleMoyenneAvec:lStyleMoyenneSans;if(lElement.derniereligne) lStyleMoyenne=lStyleMoyenneSans+GStyle.composeCouleurBordure(aPourImpression?GCouleur.noir:GCouleur.liste.total.bordure,1,EGenreBordure.bas);var lStyleNonEdtitable=lElement.derniereligne||lElement.dernierDuService||lElement.periode?lStyleNonEdtitableAvec:lStyleNonEdtitableSans;if(lElement.derniereligne) lStyleNonEdtitable=lStyleNonEdtitableSans+GStyle.composeCouleurBordure(aPourImpression?GCouleur.noir:GCouleur.cumul,1,EGenreBordure.bas);T.push('<tr>');T.push(this.composeDiscipline(aPourImpression,I+1,lElement,lStyleTitre+lAlignementHaut,lHauteur));T.push(this.composePeriode(aPourImpression,I+1,lElement,lStylePeriode+lAlignementHaut,lHauteur));T.push(this.composeMoyClasse(aPourImpression,I+1,lElement,lStyleMoyenne+lAlignementHaut,lHauteur));T.push(this.composeInf8(aPourImpression,I+1,lElement,lStyleNonEdtitable+lAlignementHaut,lHauteur));T.push(this.composeDe8A12(aPourImpression,I+1,lElement,lStyleNonEdtitable+lAlignementHaut,lHauteur));T.push(this.composeSup12(aPourImpression,I+1,lElement,lStyleNonEdtitable+lAlignementHaut,lHauteur));T.push('</tr>');}
T.push('</table>');return T.join('');};ObjetLivretScolaire.prototype.composeMoyenneLivretScolaire=function(aPourImpression,aNumeroImpression){var lClassTable='Tableau '+(aPourImpression?this.TaillePolice[aNumeroImpression]:'Texte10');var lStyleTable=GTableau.styleTableau(aPourImpression,true,EGenreBordure.gauche);var lStyleTitreAvec=GTableau.styleMoyenne(aPourImpression,true,EGenreBordure.droite+EGenreBordure.bas,false);var lStyleTitreSans=GTableau.styleMoyenne(aPourImpression,false,null,false);var lStyleTitreFin=GTableau.styleMoyenne(aPourImpression,true,EGenreBordure.bas,false);var lStylePeriodeAvec=GTableau.styleMoyenne(aPourImpression,true,EGenreBordure.droite+EGenreBordure.bas,false);var lStylePeriodeSans=GTableau.styleMoyenne(aPourImpression,true,EGenreBordure.droite,false);var lStyleMoyenneAvec=GTableau.styleMoyenne(aPourImpression,true,EGenreBordure.droite+EGenreBordure.bas,true);var lStyleMoyenneSans=GTableau.styleMoyenne(aPourImpression,true,EGenreBordure.droite,true);var lStyleEdtitableAvec=GTableau.styleCellule(aPourImpression,true,EGenreBordure.droite+EGenreBordure.bas,true);var lStyleEdtitableSans=GTableau.styleCellule(aPourImpression,true,EGenreBordure.droite,true);var lStyleNonEdtitableAvec=GTableau.styleCellule(aPourImpression,true,EGenreBordure.droite+EGenreBordure.bas,false);var lStyleNonEdtitableSans=GTableau.styleCellule(aPourImpression,true,EGenreBordure.droite,false);var lAlignementHaut=' vertical-align : top;';var lHauteur=19;var T=[];if(!aPourImpression)
T.push('<table class="'+lClassTable+'" style="'+lStyleTable+'" border="0" cellspacing="0" cellpadding="0">');if(!aPourImpression)
T.push('<tr><td colspan="10" style="',GStyle.composeCouleurBordure(aPourImpression?GCouleur.noir:GCouleur.cumul,1,EGenreBordure.bas),'"><div style="height : 0px;"></div></td></tr>');for(var I=0;I<this.listeMoyGenerale.GetNbrElements();I++){var lElement=this.listeMoyGenerale.GetElement(I);lElement.dernierDuService=lElement.derniereligne||(I===this.listeMoyGenerale.GetNbrElements()-1);var lStyleTitre=lElement.titreEnseignement?lStyleTitreAvec:(lElement.derniereligne||lElement.dernierDuService?lStyleTitreFin:lStyleTitreSans);if(lElement.derniereligne) lStyleTitre=lStyleTitreSans+GStyle.composeCouleurBordure(aPourImpression?GCouleur.noir:GCouleur.cumul,1,EGenreBordure.bas);var lStylePeriode=lElement.derniereligne||lElement.dernierDuService||lElement.periode?lStylePeriodeAvec:lStylePeriodeSans;if(lElement.derniereligne) lStylePeriode=lStylePeriodeSans+GStyle.composeCouleurBordure(aPourImpression?GCouleur.noir:GCouleur.liste.moyenne.bordure,1,EGenreBordure.bas);var lStyleMoyenne=lElement.derniereligne||lElement.dernierDuService||lElement.periode?lStyleMoyenneAvec:lStyleMoyenneSans;if(lElement.derniereligne) lStyleMoyenne=lStyleMoyenneSans+GStyle.composeCouleurBordure(aPourImpression?GCouleur.noir:GCouleur.liste.total.bordure,1,EGenreBordure.bas);var lStyleEdtitable=lElement.derniereligne||lElement.periode?lStyleEdtitableAvec:lStyleEdtitableSans;if(lElement.derniereligne) lStyleEdtitable=lStyleEdtitableSans+GStyle.composeCouleurBordure(aPourImpression?GCouleur.noir:GCouleur.cumul,1,EGenreBordure.bas);var lStyleNonEdtitable=lElement.derniereligne||lElement.dernierDuService||lElement.periode?lStyleNonEdtitableAvec:lStyleNonEdtitableSans;if(lElement.derniereligne) lStyleNonEdtitable=lStyleNonEdtitableSans+GStyle.composeCouleurBordure(aPourImpression?GCouleur.noir:GCouleur.cumul,1,EGenreBordure.bas);var lStyleNonEdtitable2=lElement.derniereligne||lElement.itemLivretScolaire?lStyleNonEdtitableAvec:lStyleNonEdtitableSans;if(lElement.derniereligne) lStyleNonEdtitable2=lStyleNonEdtitableSans+GStyle.composeCouleurBordure(aPourImpression?GCouleur.noir:GCouleur.cumul,1,EGenreBordure.bas);T.push('<tr>');if(lElement.titreEnseignement){T.push(this.composeTitreLigne(aPourImpression,I+1,lElement,lStyleTitre+lAlignementHaut,lHauteur));} else{T.push(this.composeDiscipline(aPourImpression,I+1,lElement,lStyleTitre+lAlignementHaut,lHauteur));T.push(this.composePeriode(aPourImpression,I+1,lElement,lStylePeriode+lAlignementHaut,lHauteur));if(this.affichage.avecRangEleve)
T.push(this.composeRang(aPourImpression,I+1,lElement,lStyleNonEdtitable+lAlignementHaut,lHauteur));if(this.affichage.avecMoyenneEleve)
T.push(this.composeMoyEleve(aPourImpression,I+1,lElement,lStyleMoyenne+lAlignementHaut,lHauteur));if(this.affichage.avecMoyenneClasse)
T.push(this.composeMoyClasse(aPourImpression,I+1,lElement,lStyleMoyenne+lAlignementHaut,lHauteur));if(this.affichage.avecRepartition){T.push(this.composeInf8(aPourImpression,I+1,lElement,lStyleNonEdtitable+lAlignementHaut,lHauteur));T.push(this.composeDe8A12(aPourImpression,I+1,lElement,lStyleNonEdtitable+lAlignementHaut,lHauteur));T.push(this.composeSup12(aPourImpression,I+1,lElement,lStyleNonEdtitable+lAlignementHaut,lHauteur));}
if(this.affichage.avecCompetences){T.push(this.composeItemLivretScolaire(aPourImpression,I+1,lElement,lStyleNonEdtitable2+lAlignementHaut,lHauteur));}
if(this.affichage.avecAppreciations)
T.push(this.composeAppreciations({pourImpression:aPourImpression,numLigne:I+1,element:lElement,style:(!lElement.Editable||lElement.titreDiscipline?lStyleNonEdtitable:lStyleEdtitable)+lAlignementHaut,hauteur:lHauteur}));if(this.affichage.avecColonneAppreciationsAnnuelles&&(lElement.rowspan>0))
T.push(this.composeAppreciations({pourImpression:aPourImpression,numLigne:I+1,element:lElement,style:(!lElement.appreciationAnnuelle.editable||lElement.titreDiscipline?lStyleNonEdtitable:lStyleEdtitable?lStyleNonEdtitable:lStyleEdtitable)+lAlignementHaut,hauteur:lHauteur,estColonneAppreciationAnnuelle:true}));}
T.push('</tr>');}
T.push('</table>');return T.join('');};ObjetLivretScolaire.prototype._getLargeursColonnes=function(){if(!this.donnees)
return{discipline:200,periode:35,rang:40,moyEleve:40,moyClasse:40,inf8:40,de8a12:40,sup12:40,itemCompetence:170,evaluation:20,appreciation:230,appr_Ann:0};var lRest;var lWidthVariable;this.largeurTotal=$('#'+this.Nom.escapeJQ()).width()-13;var lNrColonnesCaches=0;if(this.affichage&&!this.affichage.avecRangEleve) lNrColonnesCaches++;if(this.affichage&&!this.affichage.avecMoyenneEleve) lNrColonnesCaches++;if(this.affichage&&!this.affichage.avecMoyenneClasse) lNrColonnesCaches++;if(this.affichage&&!this.affichage.avecRepartition) lNrColonnesCaches=lNrColonnesCaches+3;if(this.affichage&&this.affichage.avecCompetences){lRest=this.largeurTotal-(35+5)-((6-lNrColonnesCaches)*(40+5))-(20+5);this.largeurTotal=this.largeurTotal-6;lWidthVariable=Math.max(200,(Math.floor(lRest/3)-6));return{discipline:(lWidthVariable),periode:35,rang:40,moyEleve:40,moyClasse:40,inf8:40,de8a12:40,sup12:40,itemCompetence:(lWidthVariable-30),evaluation:20,appreciation:(lWidthVariable+30),appr_Ann:0};} else{lRest=this.largeurTotal-(300+5)-(35+5)-((6-lNrColonnesCaches)*(40+5));this.largeurTotal=this.largeurTotal-6-1;lWidthVariable=Math.max(220,(lRest-6));var lWidthAppr_Ann=this.affichage.avecColonneAppreciationsAnnuelles?(this.affichage.avecAppreciations?Math.floor(lWidthVariable/2):lWidthVariable-2):0;var lWidthAppr_Per=this.affichage.avecAppreciations?(lWidthVariable-lWidthAppr_Ann-2):0;return{discipline:300,periode:35,rang:40,moyEleve:40,moyClasse:40,inf8:40,de8a12:40,sup12:40,itemCompetence:0,evaluation:0,appreciation:lWidthAppr_Per,appr_Ann:lWidthAppr_Ann};}};ObjetLivretScolaire.prototype.actualiserEvaluation=function(aElement,aNumeroEvaluation){var lElement=this.Liste.GetElementParGenre(aElement.GetGenre());var lNumeroEvaluation=0;var lLibelle='';var lElmCompetence;if(this.donnees.genre===EGenreOnglet.LivretScolaire_Competences){if(lElement.listeCompetences){lElmCompetence=lElement.listeCompetences.GetElement(aNumeroEvaluation);lNumeroEvaluation=(aNumeroEvaluation!==null&&aNumeroEvaluation!==undefined)||aNumeroEvaluation!==undefined?aNumeroEvaluation+1:0;if(lElmCompetence)
lLibelle='<div class="InlineBlock" style="height: 100%; vertical-align: middle;"></div><div class="InlineBlock" style="vertical-align: middle;">'+lElmCompetence.evaluation.abbreviation+'<div>';}} else{lElmCompetence=lElement.itemLivretScolaire;lLibelle=(lElmCompetence&&lElmCompetence.evaluation?lElmCompetence.evaluation.abbreviation:'');}
var lID=this.idCell(this.id[this.genreColonnes.evaluation]+'Saisie',aElement.GetGenre(),lNumeroEvaluation);$('#'+lID.escapeJQ()).html(lLibelle).attr('title',lElmCompetence.evaluation.GetLibelle());};ObjetLivretScolaire.prototype.actualiserDimensions=function(aPourImpression,aNumeroImpression){this.TaillePolice=new Array('Texte13','Texte11','Texte9','Texte8');if(aPourImpression){this.largeursColonnes={discipline:new Array(260,230,200,180)[aNumeroImpression],periode:new Array(35,32,29,25)[aNumeroImpression],rang:new Array(40,36,32,28)[aNumeroImpression],moyEleve:new Array(40,36,32,28)[aNumeroImpression],moyClasse:new Array(40,36,32,28)[aNumeroImpression],inf8:new Array(40,36,32,28)[aNumeroImpression],de8a12:new Array(40,36,32,28)[aNumeroImpression],sup12:new Array(40,36,32,28)[aNumeroImpression],itemCompetence:new Array(220,180,170,170)[aNumeroImpression],evaluation:new Array(20,19,17,15)[aNumeroImpression],appreciation:new Array(250,220,190,160)[aNumeroImpression],appr_Ann:new Array(250,220,190,160)[aNumeroImpression]};} else{this.largeursColonnes=this._getLargeursColonnes();}
if(this.nombreComptences>0)
this.largeurColCompetence=Math.max(Math.floor(this.largeursColonnes.appreciation/this.nombreComptences)-6,60);};ObjetLivretScolaire.prototype.GetLargeurEleve=function(){return(this.largeursColonnes.service+6+1)+(this.largeursColonnes.periode+6+1)+(this.largeursColonnes.rang+6+1)+(this.largeursColonnes.moyEleve+6+1)+(this.largeursColonnes.moyClasse+6+1)+(this.largeursColonnes.inf8+6+1)+(this.largeursColonnes.entre8et12+6+1)+(this.largeursColonnes.sup12+6+1);};ObjetLivretScolaire.prototype.selectionnerLigne=function(aId){if((GEtatUtilisateur.GenreEspace!==EGenreEspace.Professeur)||(this.Ligne.titreEnseignement)||(this.donnees&&this.donnees.genre===EGenreOnglet.LivretScolaire_Competences)) return;for(var J=1;J<=this.NombreColonnes;J++){var lIdSaisie=this.idCell(this.id_saisie,this.NumLigne,J);if((J===this.NumColonne)&&this.Ligne.Editable)
GHtml.setFocus(lIdSaisie);}};ObjetLivretScolaire.prototype.getModeSaisie=function(ANumLigne,ANumColonne){var lElement=this.Liste.GetElement(ANumLigne-1);var lAppreciation=lElement.ListeAppreciations.GetElement(ANumColonne-1);return this.determinerModeSaisiePourCellule(lAppreciation);};ObjetLivretScolaire.prototype.deselectionnerLigne=function(aNumLigne){};ObjetLivretScolaire.prototype.getHauteurScrollTop=function(){var lHauteur=GPosition.getHeight(this.idCell(this.id[this.genreColonnes.discipline],1));return lHauteur;};ObjetLivretScolaire.prototype.GetScrollTop=function(aGenre,aScrollTop){var lHauteur=this.getHauteurScrollTop();if(aGenre===EGenreScrollEvenement.TailleZone)
aScrollTop=GPosition.getHeight(this.Nom)-GPosition.getHeight(this.IdTableauTitre)-(this.ComposeAutre?GPosition.getHeight(this.IdTableauAutre):0);switch(aGenre){case EGenreScrollEvenement.Deplacement:return lHauteur*Math.round(aScrollTop/lHauteur);case EGenreScrollEvenement.TailleZone:return aScrollTop;case EGenreScrollEvenement.TailleContenu:return null;}};;

MethodesObjet.heritagePrototype(ObjetFenetre_Liste,ObjetFenetre);function ObjetFenetre_Liste(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.modeActivationBtnValider={surModification:1,auMoinsUnEltSelectionne:2,toujoursActifs:3};$.extend(this.optionsFenetre,{modeActivationBtnValider:this.modeActivationBtnValider.surModification});}
ObjetFenetre_Liste.prototype.ConstruireInstances=function(){this.identListe=this.Add(window.ObjetListe,this.evenementSurListe,this.initialiserListe);};ObjetFenetre_Liste.prototype.getControleur=function(){return{fenetreBtn:{getDisabled:function(aIndiceBouton,aNode,aData){var lThis=this.instance;if(lThis.optionsFenetre.modeActivationBtnValider===lThis.modeActivationBtnValider.toujoursActifs)
return false;if((lThis.optionsFenetre.modeActivationBtnValider===lThis.modeActivationBtnValider.auMoinsUnEltSelectionne)&&(aIndiceBouton===1)){return(lThis.GetInstance(lThis.identListe).getListeElementsCoches().GetNbrElements()===0);}
else return lThis.optionsFenetre.listeBoutonsInactifs[aIndiceBouton]===true;}}};};ObjetFenetre_Liste.prototype.SetParametres_Fenetre=function(aTitre,aLongueur,aHauteur,aParamsListe){this.paramsListe=aParamsListe;this.inherited('SetParametres_Fenetre',aTitre,aLongueur,aHauteur,this.paramsListe.listeBoutons?this.paramsListe.listeBoutons:[GTraductions.getValeur('Annuler'),GTraductions.getValeur('Valider')]);};ObjetFenetre_Liste.prototype.initialiserListe=function(aInstance){aInstance.SetParametres(this.paramsListe.titres,this.paramsListe.tailles,this.paramsListe.creations,this.paramsListe.creationLigne,this.paramsListe.titreCreation,this.paramsListe.hintTitres);if(this.paramsListe.colonnesCachees)
aInstance.setOptionsListe({colonnesCachees:this.paramsListe.colonnesCachees});if(this.paramsListe.editable!==undefined)
aInstance.setEditable(this.paramsListe.editable);if(this.paramsListe.optionsListe)
aInstance.setOptionsListe(this.paramsListe.optionsListe);};ObjetFenetre_Liste.prototype.SetDonnees=function(aObjetDonneesListe,aAvecValidation){this.Afficher();this.avecValidation=aAvecValidation;this.SetBoutonActif(1,false);this.GetInstance(this.identListe).SetDonnees(this.objetListe=aObjetDonneesListe);};ObjetFenetre_Liste.prototype.actualiserListe=function(aConserverSelection,aActivationBouton){this.GetInstance(this.identListe).Actualiser(aConserverSelection);if(aActivationBouton) this.SetBoutonActif(1,aActivationBouton);};ObjetFenetre_Liste.prototype.ComposeContenu=function(){var T=[];T.push('<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">');T.push('<tr>');T.push('<tr><td id="'+this.GetNomInstance(this.identListe)+'" height="100%">&nbsp;</td></tr>');T.push('</tr>');T.push('</table>');return T.join('');};ObjetFenetre_Liste.prototype.evenementSurListe=function(aGenreEvenementListe,aCol,aLigne){switch(aGenreEvenementListe){case EGenreEvenementListe.Selection:this.SetBoutonActif(1,true);if(this.avecValidation)
this.SurValidation(1);break;case EGenreEvenementListe.Suppression:this.SetBoutonActif(1,false);break;case EGenreEvenementListe.Creation:if(this.paramsListe.creationLigne=== -1){if(this.paramsListe.callbckCreation){this.changementListe=true;return this.paramsListe.callbckCreation(aCol,aLigne);}}
break;case EGenreEvenementListe.ApresCreation:this.SetBoutonActif(1,true);break;}
if(MethodesTableau.existe(aGenreEvenementListe,[EGenreEvenementListe.Creation,EGenreEvenementListe.Edition,EGenreEvenementListe.ApresEdition,EGenreEvenementListe.Suppression,EGenreEvenementListe.ApresSuppression]))
this.changementListe=true;};ObjetFenetre_Liste.prototype.SurValidation=function(aNumeroBouton){var lMaSelection=this.GetInstance(this.identListe).GetSelection();this.Fermer();if(this.optionsFenetre.callback){this.optionsFenetre.callback(aNumeroBouton,lMaSelection,this.changementListe);}
this.callback.appel(aNumeroBouton,lMaSelection,this.changementListe);};;
MethodesObjet.heritagePrototype(ObjetCelluleMultiSelection,Identite);function ObjetCelluleMultiSelection(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.initOptions();}(function(){ObjetCelluleMultiSelection.prototype.initOptions=function(){this._options={genreBouton:EGenreBoutonCellule.Points,classTexte:'',largeurBouton:150,hauteurBouton:18,titreFenetre:'',titresColonnes:null,taillesColonnes:null,listeBoutons:null,donneesListe:null,paramListe:null,creationLigne:null,creations:null,callbckCreation:null,colonnesCachees:null,largeurFenetre:300,hauteurFenetre:250};};ObjetCelluleMultiSelection.prototype.setOptions=function(aOptions){$.extend(this._options,aOptions);};ObjetCelluleMultiSelection.prototype.DetruireInstances=function(){this._fermerFenetre();};ObjetCelluleMultiSelection.prototype.Initialiser=function(){this.cellule=new ObjetCelluleBouton(this.Nom+'.cellule',null,this,this.surCellule);this.SetPremierElement(this.cellule.NomEdit);this.cellule.setOptions_ObjetCelluleBouton({}) ;this.cellule.setParametres(false,this._options.genreBouton,null,this._options.largeurBouton,this._options.hauteurBouton,null,null,this._options.classTexte);this.cellule.setParametresSaisie(false,false);this.Afficher();this.cellule.Initialiser();this.cellule.SetActif(this.Actif);};ObjetCelluleMultiSelection.prototype._initDonnees=function(aListeSelectionnee,aListeOrigin){var lResult=IE.MethodesObjet.dupliquer(aListeOrigin);for(var i=0;i<aListeSelectionnee.GetNbrElements();i++){var lElm=lResult.GetElementParNumero(aListeSelectionnee.GetNumero(i));lElm.cmsActif=true;}
return lResult;};ObjetCelluleMultiSelection.prototype.setDonnees=function(aListeComplet,aListeSelectionne){if(aListeComplet){if(aListeSelectionne){this.donnees=this._initDonnees(aListeSelectionne,aListeComplet);} else{this.donnees=IE.MethodesObjet.dupliquer(aListeComplet);}
if(this.donnees)
this._actualiserCellule();}};ObjetCelluleMultiSelection.prototype.ConstruireAffichage=function(){return _compose.bind(this)();};ObjetCelluleMultiSelection.prototype.surCellule=function(aGenreEvent){if(!this.Actif) return;switch(aGenreEvent){case EEvent.SurClick:{this._ouvrirFenetre();break;}
case EEvent.SurKeyUp:{if(GNavigateur.IsToucheRetourChariot()||GNavigateur.IsToucheFlecheBas())
this._ouvrirFenetre();}}};ObjetCelluleMultiSelection.prototype._actualiserCellule=function(){var lListeSelectionne=this.donnees.getListeElements(function(aElement,aIndice){return aElement.cmsActif;});this.cellule.setLibelle(lListeSelectionne.getTableauLibelles().join(', '));};ObjetCelluleMultiSelection.prototype._ouvrirFenetre=function(){if(this.fenetre)
this._fermerFenetre();this.fenetre=ObjetFenetre.creerInstance(window.ObjetFenetre_Liste,{pere:this,evenement:this.surFenetre,initialiser:false});var lSelf=this;this.fenetre.ajouterCallbackSurDestruction(function(){lSelf.fenetre=null;});var lParam={titres:this._options.titresColonnes?this._options.titresColonnes:[{estCoche:true},GTraductions.getValeur('Libelle')],tailles:this._options.taillesColonnes?this._options.taillesColonnes:[20,'100%'],listeBoutons:this._options.listeBoutons?this._options.listeBoutons:[GTraductions.getValeur('Fermer')],creationLigne:this._options.creationLigne,creations:this._options.creations,callbckCreation:this._options.callbckCreation,colonnesCachees:this._options.colonnesCachees,editable:true};this.fenetre.SetParametres_Fenetre(this._options.titreFenetre,this._options.largeurFenetre,this._options.hauteurFenetre,lParam);this.fenetre.Initialiser();this.donneesListe=this._options.donneesListe?new this._options.donneesListe(this.donnees,this._options.paramListe):new DonneesListe_CelluleMultiSelection(this.donnees);this.fenetre.SetDonnees(this.donneesListe,false);this.fenetre.positionnerSousId(this.Nom);};ObjetCelluleMultiSelection.prototype._nbrCochees=function(){var lNombre=0;for(var i=0,lNb=this.donnees.GetNbrElements();i<lNb;i++)
if(this.donnees.GetElement(i).cmsActif)
lNombre++;return lNombre;};ObjetCelluleMultiSelection.prototype._fermerFenetre=function(){if(!this.fenetre) return;this.fenetre.Fermer();};ObjetCelluleMultiSelection.prototype.surFenetre=function(aGenreBouton,aSelection,aAvecChangementListe){this.genreBouton=aGenreBouton;this._actualiserCellule();this._fermerFenetre();if(this.ControleNavigation&&this.Pere&&this.Pere.EvenementSurNavigation)
this.Pere.EvenementSurNavigation(this,aAvecChangementListe);else this.RetourSurNavigation(aAvecChangementListe);};ObjetCelluleMultiSelection.prototype.RetourSurNavigation=function(aAvecChangementListe){var lListeActif=this.donnees.getListeElements(function(aElement,aIndice){return aElement.cmsActif;});this.callback.appel(this.genreBouton,lListeActif,aAvecChangementListe?this.donnees:null);};ObjetCelluleMultiSelection.prototype.SetActif=function(AActif){this.inherited('SetActif',AActif);if(this.cellule)
this.cellule.SetActif(AActif);this.$refreshSelf();};function _compose(){var H=[];H.push('<div id="',this.cellule.GetNom(),'"></div>');return H.join('');}})();MethodesObjet.heritagePrototype(DonneesListe_CelluleMultiSelection,ObjetDonneesListe);function DonneesListe_CelluleMultiSelection(aDonnees){this.inheritedCreate(aDonnees);}
DonneesListe_CelluleMultiSelection.prototype.AvecEdition=function(I,D){return I===0;};DonneesListe_CelluleMultiSelection.prototype.AvecSuppression=function(D){return false;};DonneesListe_CelluleMultiSelection.prototype.AvecEvenement_Selection=function(I,D){return I===0;};DonneesListe_CelluleMultiSelection.prototype.AvecEtatSaisie=function(D){return false;};DonneesListe_CelluleMultiSelection.prototype.GetTypeValeur=function(I,D){return I===0?this.ETypeCellule.Coche:this.ETypeCellule.Texte;};DonneesListe_CelluleMultiSelection.prototype.GetValeur=function(I,D,K,aSurEdition){switch(I){case 0:return D.cmsActif!==undefined?D.cmsActif:false;case 1:return D.GetLibelle();}
return'';};DonneesListe_CelluleMultiSelection.prototype.SurEdition=function(I,D,V){if(I===0) D.cmsActif=V;};;

MethodesObjet.heritagePrototype(ObjetSelectionEngagements,DonneesListe_CelluleMultiSelection);function ObjetSelectionEngagements(aDonnees,aParam){this.param=aParam;this.inheritedCreate(aDonnees);}
ObjetSelectionEngagements.genreColonne={coche:0,code:1,libelle:2};ObjetSelectionEngagements.prototype.AvecEdition=function(I,D){return I===0;};ObjetSelectionEngagements.prototype.AvecSuppression=function(D){return false;};ObjetSelectionEngagements.prototype.AvecEvenement_Selection=function(I,D){return I===0;};ObjetSelectionEngagements.prototype.AvecEtatSaisie=function(D){return false;};ObjetSelectionEngagements.prototype.GetTypeValeur=function(I,D){return I===0?this.ETypeCellule.Coche:this.ETypeCellule.Texte;};ObjetSelectionEngagements.prototype.GetValeur=function(I,D,K,aSurEdition){switch(I){case ObjetSelectionEngagements.genreColonne.coche:return D.cmsActif!==undefined?D.cmsActif:false;case ObjetSelectionEngagements.genreColonne.code:return D.code?D.code:'';case ObjetSelectionEngagements.genreColonne.libelle:return D.GetLibelle();}
return'';};ObjetSelectionEngagements.prototype.SurEdition=function(I,D,V){if(I===0) D.cmsActif=V;};;
function ObjetRequeteListeAuteurCommentaireLivret(aPere,aEvenementSurReussite,aEvenementSurEchec){this.inheritedCreate(aPere,aEvenementSurReussite,aEvenementSurEchec);}
IE.Requetes.inscrire('ListeAuteurCommentaireLivret',ObjetRequeteListeAuteurCommentaireLivret,_ObjetRequeteXmlConsultationPN);(function(){ObjetRequeteListeAuteurCommentaireLivret.prototype.lancerRequete=function(aParam){this.genreCommentaire=aParam.genre;this.classe=aParam.classe;this.JSON={genre:this.genreCommentaire,classe:this.classe};if(window.GCache&&GCache.general.existeDonnee('listeAuteurCommentaireLivret'+'_'+this.genreCommentaire))
this.callbackReussite.appel({listeAuteurs:GCache.general.getDonnee('listeAuteurCommentaireLivret'+'_'+this.genreCommentaire),genre:this.genreCommentaire});else this.appelAsynchroneConsultation();};ObjetRequeteListeAuteurCommentaireLivret.prototype.actionApresRequete=function(){var lObjet={genre:this.genreCommentaire};if(window.GCache)
GCache.general.setDonnee('listeAuteurCommentaireLivret'+'_'+this.genreCommentaire,this.JSONReponse.listeAuteurs);lObjet.listeAuteurs=this.JSONReponse.listeAuteurs;this.callbackReussite.appel(lObjet);};})();;

MethodesObjet.heritagePrototype(ObjetPiedFicheScolaire,Identite);function ObjetPiedFicheScolaire(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.idRepartition=IE.GUID.getId();this.idAvisCE=IE.GUID.getId();this.idEngagements=IE.GUID.getId();this.idAvisInvestissement=IE.GUID.getId();this.idNomSignature=IE.GUID.getId();this.combo=new ObjetSaisie(this.Nom+'.combo',null,this,this._evenementSurCombo);this.celluleDate=[];this.tabOnglets=new ObjetTabOnglets(this.Nom+'.tabOnglets',null,this,this._evenementSurTab);this.selectEngagements=new ObjetCelluleMultiSelection(this.Nom+'.selectEngagements',null,this,this._evnSelectEngagements);this.TaillePolice=new Array('Texte13','Texte11','Texte9','Texte8');this.widthPolice=new Array('65px','55px','45px','40px');this.fenetreSelectPublic=new ObjetFenetre_Liste(this.Nom+'.fenetreSelectPublic',null,this,this._evenementFenetreIndividu);IE.ZoneFenetre.ajouterFenetre(this.fenetreSelectPublic.GetNom(),this.fenetreSelectPublic.getZIndex());var lParamsListe={};lParamsListe.tailles=new Array('100%');this.fenetreSelectPublic.SetParametres_Fenetre(GTraductions.getValeur('ficheScolaire.Signataire.Engagement'),300,200,lParamsListe);this.fenetreSelectPublic.Initialiser();}(function(){ObjetPiedFicheScolaire.prototype.SetDonnees=function(aDonnees,aEstFilierePro){if(!aDonnees){this._donnees=null;GHtml.setHtml(this.Nom,'<div style="height:175px"></div>');return;}
var lEventMapTextArea,lJTextArea;this._donnees=aDonnees;this.estNonEditable=!GApplication.droits.get(IEEnum.droits.avecSaisieAppreciationsGenerales)||!this._donnees.editable;this._donnees.estFilierePro=aEstFilierePro;GHtml.setHtml(this.Nom,this.ConstruireAffichage());var lListeOnglets=new ObjetListeElements();if(this._donnees.avecAvisCE)
lListeOnglets.AddElement(new ObjetElement(this._donnees.estIssueDUnBOLycee?GTraductions.getValeur('ficheScolaire.AvisEnVueDuBac'):GTraductions.getValeur('ficheScolaire.AvisDuChefDetablissement'),null,TypeAvisCommentaire.tac_ChefEtablissement));if(this._donnees.avecEngagements) lListeOnglets.AddElement(new ObjetElement(GTraductions.getValeur('ficheScolaire.Engagements'),null,TypeAvisCommentaire.tac_Engagement));if(this._donnees.avecInvestissement) lListeOnglets.AddElement(new ObjetElement(GTraductions.getValeur('ficheScolaire.Investissement'),null,TypeAvisCommentaire.tac_Investissement));this.tabOnglets.SetParametres(lListeOnglets,true,GPosition.getWidth(this.Nom)-10,19);this.tabOnglets.Afficher();this.tabOnglets.selectOnglet(0);if(this._donnees.avecAvisCE){this.combo.SetParametres(EGenreSaisie.Combo,200);this.combo.Initialiser();if(this._donnees.estIssueDUnBOLycee&&!this.estNonEditable)
this.celluleDate[TypeAvisCommentaire.tac_ChefEtablissement].Initialiser();var lListeAvisCombo=new ObjetListeElements();lListeAvisCombo.FusionnerListe(this._donnees.avisCE.listeAvis);lListeAvisCombo.insererElement(new ObjetElement(''),0);var lIndiceCombo=0;if(this._donnees.avisCE.infosLivret.avis){lIndiceCombo=lListeAvisCombo.GetIndiceParElement(this._donnees.avisCE.infosLivret.avis);this._donnees.avisCE.infosLivret.avis=lListeAvisCombo.GetElement(lIndiceCombo);}
this._initialisationCombo=true;this.combo.SetDonnees(lListeAvisCombo,lIndiceCombo);if(this._donnees.estIssueDUnBOLycee&&!this.estNonEditable){if(this._donnees.avisCE.infosLivret.date)
this.celluleDate[TypeAvisCommentaire.tac_ChefEtablissement].SetDonnees(this._donnees.avisCE.infosLivret.date);else this.celluleDate[TypeAvisCommentaire.tac_ChefEtablissement].SetActif(false);}
delete this._initialisationCombo;lJTextArea=$('#'+this.idAvisCE.escapeJQ()+' textarea');GHtml.setValue(lJTextArea.get(0),this._donnees.avisCE.infosLivret.commentaire);lEventMapTextArea={change:_surChangeTextArea,keyup:_surChangeTextArea};if(this.estNonEditable){lJTextArea.inputDisabled(true);this.combo.SetActif(false);lJTextArea.off(lEventMapTextArea);}
else{lJTextArea.inputDisabled(false);this.combo.SetActif(true);lJTextArea.on(lEventMapTextArea,{instance:this});}
$('#'+this.idRepartition.escapeJQ()).parent().jScrollPane({showArrows:true});}
if(this._donnees.avecEngagements){this.selectEngagements.setOptions({largeurBouton:400,titreFenetre:GTraductions.getValeur('ficheScolaire.Engagements'),titresColonnes:[{estCoche:true},GTraductions.getValeur('ficheScolaire.engagement.code'),GTraductions.getValeur('Libelle')],taillesColonnes:['20','30','100%'],listeBoutons:[GTraductions.getValeur('Annuler'),GTraductions.getValeur('Valider')],donneesListe:ObjetSelectionEngagements,largeurFenetre:450,hauteurFenetre:250});this.selectEngagements.Initialiser();if(!this.estNonEditable)
this.celluleDate[TypeAvisCommentaire.tac_Engagement].Initialiser();this.selectEngagements.setDonnees(this._donnees.listeEngagements,this._donnees.engagements.listeEngagements);if(!this.estNonEditable){if(this._donnees.engagements.infosLivret.date)
this.celluleDate[TypeAvisCommentaire.tac_Engagement].SetDonnees(this._donnees.engagements.infosLivret.date);else this.celluleDate[TypeAvisCommentaire.tac_Engagement].SetActif(false);}
lJTextArea=$('#'+this.idEngagements.escapeJQ()+' textarea');GHtml.setValue(lJTextArea.get(0),this._donnees.engagements.infosLivret.commentaire);lEventMapTextArea={change:_surChangeCommentaireEngagements,keyup:_surChangeCommentaireEngagements};if(this.estNonEditable){lJTextArea.inputDisabled(true);lJTextArea.off(lEventMapTextArea);}
else{lJTextArea.inputDisabled(false);lJTextArea.on(lEventMapTextArea,{instance:this});}}
if(this._donnees.avecInvestissement){if(!this.estNonEditable)
this.celluleDate[TypeAvisCommentaire.tac_Investissement].Initialiser();if(!this.estNonEditable){if(this._donnees.investissement.infosLivret.date)
this.celluleDate[TypeAvisCommentaire.tac_Investissement].SetDonnees(this._donnees.investissement.infosLivret.date);else this.celluleDate[TypeAvisCommentaire.tac_Investissement].SetActif(false);}
lJTextArea=$('#'+this.idAvisInvestissement.escapeJQ()+' textarea');GHtml.setValue(lJTextArea.get(0),this._donnees.investissement.infosLivret.commentaire);lEventMapTextArea={change:_surChangeCommentaireInvestissement,keyup:_surChangeCommentaireInvestissement};if(this.estNonEditable){lJTextArea.inputDisabled(true);lJTextArea.off(lEventMapTextArea);}
else{lJTextArea.inputDisabled(false);lJTextArea.on(lEventMapTextArea,{instance:this});}}};function _surCelluleDate(aGenre,aDate){switch(aGenre){case TypeAvisCommentaire.tac_ChefEtablissement:this._donnees.avisCE.infosLivret.date=aDate;this._donnees.avisCE.infosLivret.SetEtat(EGenreEtat.Modification);this.SetEtatSaisie(true);break;case TypeAvisCommentaire.tac_Engagement:this._donnees.engagements.infosLivret.date=aDate;this._donnees.engagements.infosLivret.SetEtat(EGenreEtat.Modification);this._donnees.engagements.estModifie=true;this.SetEtatSaisie(true);break;case TypeAvisCommentaire.tac_Investissement:this._donnees.investissement.infosLivret.date=aDate;this._donnees.investissement.infosLivret.SetEtat(EGenreEtat.Modification);this._donnees.investissement.estModifie=true;this.SetEtatSaisie(true);break;default:;break;}}
ObjetPiedFicheScolaire.prototype.ConstruireAffichage=function(){if(!this._donnees) return'';var T=[];T.push('<div class="PetitEspaceHaut"><div id="',this.tabOnglets.GetNom(),'" style="width : 100%; height : 20px;"></div></div>');T.push('<div class="Espace" style="',GStyle.composeHeight(140),GStyle.composeCouleurBordure(GCouleur.bordure,1),'">');if(this._donnees.avecAvisCE) T.push(_composeAvisCE.bind(this)());if(this._donnees.avecEngagements) T.push(_composeEngagementsEleve.bind(this)());if(this._donnees.avecInvestissement) T.push(_composeInvestissement.bind(this)());T.push('</div>');return T.join('');};function _composeAvisCE(){var T=[];T.push('<div id="',this.idAvisCE,'" class="NoWrap Texte10">');T.push('<div class="InlineBlock AlignementHaut">',(this.estNonEditable)?_construireAvisNonEditable.bind(this)():_construireAvis.bind(this)(),'</div>');T.push('<div id="',this.idRepartition,'_section" class="InlineBlock AlignementHaut GrandEspaceGauche">','<div class="Gras">',this._donnees.avisCE.libelleRepatition,'</div>','<div class="EspaceHaut">','<div style="',GStyle.composeHeight(120),';padding-right:1px;">','<div id="',this.idRepartition,'" style="min-width : 300px;">',_construireRepartition.bind(this)(),'</div>','</div>','</div>','</div>');T.push('</div>');return T.join('');}
function _composeEngagementsEleve(){var T=[];T.push('<div id="',this.idEngagements,'" class="Texte10">');T.push(this.estNonEditable?_construireEngagementsNonEditable.bind(this)():_construireEngagements.bind(this)());var lNom=this._donnees&&this._donnees.engagements&&this._donnees.engagements.infosLivret&&this._donnees.engagements.infosLivret.auteur&&this._donnees.engagements.infosLivret.auteur.GetLibelle()?this._donnees.engagements.infosLivret.auteur.GetLibelle():null;var lDate=this._donnees&&this._donnees.engagements&&this._donnees.engagements.infosLivret&&this._donnees.engagements.infosLivret.date?this._donnees.engagements.infosLivret.date:null;if(($.inArray(GEtatUtilisateur.GenreEspace,[EGenreEspace.Professeur,EGenreEspace.Etablissement])> -1)&&!this.estNonEditable)
T.push(_construireSignature.bind(this)(lNom,lDate,TypeAvisCommentaire.tac_Engagement));else T.push(_construireSignatureNonEditable.bind(this)(lNom,lDate));T.push('</div>');return T.join('');}
function _construireEngagements(){var T=[];T.push('<div class="WhiteSpaceNormal" style="padding-top:2px;">');T.push('<div class="Gras">',GTraductions.getValeur('ficheScolaire.engagement.titre'),'</div>');T.push('<div id="',this.selectEngagements.GetNom(),'"></div>');T.push('</div>');T.push('<div class="EspaceHaut WhiteSpaceNormal">');T.push('<div class="Gras">',GTraductions.getValeur('ficheScolaire.engagement.commentaire'),'</div>');T.push('<textarea class="Texte10" maxlength="',GParametres.getTailleMaxAppreciationParEnumere(TypeGenreAppreciation.GA_BilanAnnuel_Generale),'" style="width:600px; height:60px;',GStyle.composeCouleurBordure(GCouleur.bordure),GStyle.composeBordureArrondi(3),'"></textarea>');T.push('</div>');return T.join('');}
function _construireEngagementsNonEditable(){var T=[];T.push('<div class="WhiteSpaceNormal" style="padding-top:2px;">');if((this._donnees.engagements.listeEngagements.GetNbrElements()>0)||this._donnees.engagements.infosLivret.commentaire){if(this._donnees.engagements.listeEngagements.GetNbrElements()>0){T.push('<div class="Gras">',GTraductions.getValeur('ficheScolaire.engagement.titre'),' :','</div>');T.push('<div class="Texte10">',(this._donnees.engagements&&this._donnees.engagements.listeEngagements?this._donnees.engagements.listeEngagements.getTableauLibelles().join(', '):'&nbsp;'),'</div>');}
T.push('</div>');T.push('<div class="EspaceHaut WhiteSpaceNormal">');if(this._donnees.engagements.infosLivret.commentaire){T.push('<div class="Gras">',GTraductions.getValeur('ficheScolaire.engagement.commentaire'),' :','</div>');T.push('<div class="Texte10">',GChaine.ToHTML(this._donnees.engagements.infosLivret.commentaire),'</div>');}} else{T.push(this.composeMessage(GTraductions.getValeur('ficheScolaire.engagement.aucun')));}
T.push('</div>');return T.join('');}
function _composeInvestissement(){var T=[];T.push('<div id="',this.idAvisInvestissement,'" class="Texte10">');T.push(this.estNonEditable?_construireAvisInvestissementNonEditable.bind(this)():_construireAvisInvestissement.bind(this)());var lNom=this._donnees&&this._donnees.investissement&&this._donnees.investissement.infosLivret&&this._donnees.investissement.infosLivret.auteur&&this._donnees.investissement.infosLivret.auteur.GetLibelle()?this._donnees.investissement.infosLivret.auteur.GetLibelle():null;var lDate=this._donnees&&this._donnees.investissement&&this._donnees.investissement.infosLivret&&this._donnees.investissement.infosLivret.date?this._donnees.investissement.infosLivret.date:null;if(($.inArray(GEtatUtilisateur.GenreEspace,[EGenreEspace.Professeur,EGenreEspace.Etablissement])> -1)&&!this.estNonEditable)
T.push(_construireSignature.bind(this)(lNom,lDate,TypeAvisCommentaire.tac_Investissement));else T.push(_construireSignatureNonEditable.bind(this)(lNom,lDate));T.push('</div>');return T.join('');}
function _construireAvisInvestissement(){var T=[];T.push('<div class="EspaceHaut WhiteSpaceNormal">');T.push('<div class="Gras">',GTraductions.getValeur('ficheScolaire.investissement.titre'),'</div>');T.push('<textarea class="Texte10" maxlength="',GParametres.getTailleMaxAppreciationParEnumere(TypeGenreAppreciation.GA_BilanAnnuel_Generale),'" style="width:600px; height:96px;',GStyle.composeCouleurBordure(GCouleur.bordure),GStyle.composeBordureArrondi(3),'"></textarea>');T.push('</div>');return T.join('');}
function _construireAvisInvestissementNonEditable(){var T=[];T.push('<div class="EspaceHaut WhiteSpaceNormal">');if(this._donnees.investissement.infosLivret.commentaire){T.push('<div class="Gras">',GTraductions.getValeur('ficheScolaire.investissement.titre'),' :','</div>');T.push('<div class="Texte10">',GChaine.ToHTML(this._donnees.investissement.infosLivret.commentaire),'</div>');} else{T.push(this.composeMessage(GTraductions.getValeur('ficheScolaire.investissement.aucun')));}
T.push('</div>');return T.join('');}
ObjetPiedFicheScolaire.prototype.composeImpression=function(aFormat){var T=[];var lClass=(aFormat!==null&&aFormat!==undefined)?this.TaillePolice[aFormat]:'Texte10';var lWidth=(aFormat!==null&&aFormat!==undefined)?this.widthPolice[aFormat]:'50px';T.push('<div class="',lClass,'">');T.push(_construireAvisImpression.bind(this)());T.push($('#'+(this.idRepartition+'_section').escapeJQ()).clone().find('*').css({'height':'auto','width':'','overflow':''}).attr('class',function(index,attr){return attr?attr.replace(/jsp[^\s]*?/g,''):'';}).end().find('.LigneRepartition').css({'width':lWidth}).end().html());T.push('</div>');return T.join('');};function _construireSignature(aNom,aDate,aGenre){var T=[];this.celluleDate[aGenre]=new ObjetCelluleDate(this.Nom+'.celluleDate['+aGenre+']',null,this,_surCelluleDate.bind(this,aGenre));T.push('<div  class="NoWrap">');T.push('<div class="InlineBlock AlignementMilieuVertical EspaceHaut EspaceBas EspaceDroit">',GTraductions.getValeur('Nom'),'</div>');T.push('<div class="InlineBlock AlignementMilieuVertical Espace"><div id="',this.idNomSignature,'_',aGenre,'" onclick="',this.Nom,'._evnNomSignature(',aGenre,')" style="padding : 2px; ',GStyle.composeWidth(180),GStyle.composeCouleur(GCouleur.blanc,GCouleur.noir,GCouleur.bordure,1),'">',aNom?aNom:'&nbsp;','</div></div>');T.push('<div class="InlineBlock AlignementMilieuVertical Espace GrandEspaceGauche">',GTraductions.getValeur('Date'),'</div>');T.push('<div class="InlineBlock AlignementMilieuVertical Espace"><div id="',this.celluleDate[aGenre].GetNom(),'" xtyle="padding : 2px; ',GStyle.composeWidth(75),GStyle.composeCouleur(GCouleur.nonEditable.fond,GCouleur.noir,GCouleur.bordure,1),'">','</div></div>');T.push('</div>');return T.join('');}
function _construireSignatureNonEditable(aNom,aDate){var T=[];if(aNom&&aDate&&$.inArray(GEtatUtilisateur.GenreEspace,[EGenreEspace.Professeur,EGenreEspace.Etablissement])> -1){T.push('<div  class="NoWrap">');T.push('<div class="InlineBlock AlignementMilieuVertical GrandEspaceHaut EspaceBas">',aNom?aNom:'',aDate?GDate.FormatDate(aDate,(aNom?', ':'')+GTraductions.getValeur('Le')+' %JJ/%MM/%AAAA'):'','</div>');T.push('</div>');}
return T.join('');}
function _construireAvis(){var T=[];T.push('<div style="position:relative; height:25px;">');T.push('<div class="Gras" style="position:relative; top:2px;">',GTraductions.getValeur('ficheScolaire.AvisDuChefDetablissement'),'</div>');T.push('<div id="',this.combo.GetNom(),'" style="position:absolute; right:0; top:0"></div>');T.push('</div>');T.push('<textarea class="Texte10" maxlength="',GParametres.getTailleMaxAppreciationParEnumere(TypeGenreAppreciation.GA_BilanAnnuel_Generale),'" style="width:410px; height:90px;',GStyle.composeCouleurBordure(GCouleur.bordure),GStyle.composeBordureArrondi(3),'"></textarea>');var lNom=this._donnees&&this._donnees.avisCE&&this._donnees.avisCE.infosLivret&&this._donnees.avisCE.infosLivret.auteur&&this._donnees.avisCE.infosLivret.auteur.GetLibelle()?this._donnees.avisCE.infosLivret.auteur.GetLibelle():null;var lDate=this._donnees&&this._donnees.avisCE&&this._donnees.avisCE.infosLivret&&this._donnees.avisCE.infosLivret.date?this._donnees.avisCE.infosLivret.date:null;if(this._donnees.estIssueDUnBOLycee){if($.inArray(GEtatUtilisateur.GenreEspace,[EGenreEspace.Professeur,EGenreEspace.Etablissement])> -1)
T.push(_construireSignature.bind(this)(lNom,lDate,TypeAvisCommentaire.tac_ChefEtablissement));else T.push(_construireSignatureNonEditable.bind(this)(lNom,lDate));}
return T.join('');}
function _construireAvisNonEditable(){var T=[];T.push('<div style="position:relative; height:25px;">');T.push('<div style="position:relative; top:2px;"><span class="Gras">',GTraductions.getValeur('ficheScolaire.AvisDuChefDetablissement'),'&nbsp;:&nbsp;</span>',(this._donnees.avisCE.infosLivret.avis?this._donnees.avisCE.infosLivret.avis.GetLibelle():''),'</div>');T.push('</div>');T.push('<div class="Texte10 EspaceBas WhiteSpaceNormal" style="width:410px;">',GChaine.ToHTML(this._donnees.avisCE.infosLivret.commentaire),'</div>');var lNom=this._donnees&&this._donnees.avisCE&&this._donnees.avisCE.infosLivret&&this._donnees.avisCE.infosLivret.auteur&&this._donnees.avisCE.infosLivret.auteur.GetLibelle()?this._donnees.avisCE.infosLivret.auteur.GetLibelle():null;var lDate=this._donnees&&this._donnees.avisCE&&this._donnees.avisCE.infosLivret&&this._donnees.avisCE.infosLivret.date?this._donnees.avisCE.infosLivret.date:null;T.push(_construireSignatureNonEditable.bind(this)(lNom,lDate));return T.join('');}
function _construireAvisImpression(){var T=[];T.push('<div class="EspaceHaut EspaceBas"><span class="Gras">',GTraductions.getValeur('ficheScolaire.AvisDuChefDetablissement'),'&nbsp;:&nbsp;</span>',(this._donnees.avisCE.infosLivret.avis?this._donnees.avisCE.infosLivret.avis.GetLibelle():''),'</div>');T.push('<div class="EspaceBas">',GChaine.ToHTML(this._donnees.avisCE.infosLivret.commentaire),'</div>');return T.join('');}
function _construireLigneRepartition(aNombre,aLibelle){var T=[];var lValeur=Math.round(aNombre*10000/this._donnees.avisCE.nbElevesTotal)/100;T.push('<div class="GrandEspaceDroit">');if(this._donnees&&this._donnees.estFilierePro)
T.push('<div style="width:50px;" class="InlineBlock LigneRepartition">',aNombre,'</div>');else T.push('<div style="width:50px;" class="InlineBlock LigneRepartition">',(lValeur<10?'0':'')+lValeur.toFixed(2),' %','</div>');T.push('<div  class="InlineBlock">',aLibelle,'</div>');T.push('</div>');return T.join('');}
function _construireRepartition(){var T=[];var i,lAvis,lNbAvisNonRemplis=this._donnees.avisCE.nbElevesTotal;for(i=0;i<this._donnees.avisCE.listeAvis.GetNbrElements();i++){lAvis=this._donnees.avisCE.listeAvis.GetElement(i);lNbAvisNonRemplis-=lAvis.nbEleves;T.push(_construireLigneRepartition.bind(this)(lAvis.nbEleves,lAvis.GetLibelle()));}
T.push(_construireLigneRepartition.bind(this)(lNbAvisNonRemplis,GTraductions.getValeur('ficheScolaire.AvisNonRempli')));return T.join('');}
ObjetPiedFicheScolaire.prototype._evenementSurTab=function(aElement){switch(aElement.GetGenre()){case 0:$('#'+this.idAvisInvestissement.escapeJQ()).hide();$('#'+this.idEngagements.escapeJQ()).hide();$('#'+this.idAvisCE.escapeJQ()).show();break;case 1:$('#'+this.idAvisInvestissement.escapeJQ()).hide();$('#'+this.idAvisCE.escapeJQ()).hide();$('#'+this.idEngagements.escapeJQ()).show();break;case 2:$('#'+this.idAvisCE.escapeJQ()).hide();$('#'+this.idEngagements.escapeJQ()).hide();$('#'+this.idAvisInvestissement.escapeJQ()).show();break;default:;break;}};ObjetPiedFicheScolaire.prototype._evenementFenetreIndividu=function(aGenreBouton,aSelection,aAvecChangementListe){var lDonnees=null,lIndividu;if(aGenreBouton===1){lIndividu=this.listeSignataires.GetElement(aSelection);switch(this.genreAvisCommentaire){case TypeAvisCommentaire.tac_ChefEtablissement:lDonnees=this._donnees.avisCE;break;case TypeAvisCommentaire.tac_Engagement:lDonnees=this._donnees.engagements;break;case TypeAvisCommentaire.tac_Investissement:lDonnees=this._donnees.investissement;break;default:;break;}}
if(lDonnees){if(lIndividu.GetGenre()!==-1){lDonnees.infosLivret.auteur=lIndividu;GHtml.setHtml(this.idNomSignature+'_'+this.genreAvisCommentaire,lDonnees.infosLivret.auteur.GetLibelle());} else{lDonnees.infosLivret.auteur=null;GHtml.setHtml(this.idNomSignature+'_'+this.genreAvisCommentaire,'&nbsp;');}
lDonnees.infosLivret.SetEtat(EGenreEtat.Modification);lDonnees.estModifie=true;this.SetEtatSaisie(true);}
this.genreAvisCommentaire=undefined;};ObjetPiedFicheScolaire.prototype._evnNomSignature=function(aGenre){this.genreAvisCommentaire=aGenre;var lClasse=GEtatUtilisateur.Navigation.GetRessource(EGenreRessource.Classe);new ObjetRequeteListeAuteurCommentaireLivret(this,_evntDeclencherFenetreRessource.bind(this)).lancerRequete({genre:this.genreAvisCommentaire,classe:lClasse});};function _evntDeclencherFenetreRessource(aDonnees){this.listeSignataires=new ObjetListeElements();this.listeSignataires.AddElement(new ObjetElement(GTraductions.getValeur('Aucun'),null,-1));this.listeSignataires.FusionnerListe(aDonnees.listeAuteurs);switch(this.genreAvisCommentaire){case TypeAvisCommentaire.tac_ChefEtablissement:this.fenetreSelectPublic.setTitre(GTraductions.getValeur('ficheScolaire.Signataire.AvisCE'));break;case TypeAvisCommentaire.tac_Engagement:this.fenetreSelectPublic.setTitre(GTraductions.getValeur('ficheScolaire.Signataire.Engagement'));break;case TypeAvisCommentaire.tac_Investissement:this.fenetreSelectPublic.setTitre(GTraductions.getValeur('ficheScolaire.Signataire.Investissement'));break;default:;break;}
this.fenetreSelectPublic.SetDonnees(new DonneesListe_SelectionSignataireAvis(this.listeSignataires));}
ObjetPiedFicheScolaire.prototype._evenementSurCombo=function(aGenreSelection,aElement,aSelection,aGenre,aValeur){if(aGenreSelection===EGenreEvenementObjetSaisie.selection){if(!this._initialisationCombo&&(aElement!==this._donnees.avisCE.infosLivret.avis)){var lAncienAvis=this._donnees.avisCE.infosLivret.avis;if(lAncienAvis)
lAncienAvis.nbEleves--;if(aElement.existeNumero()){this._donnees.avisCE.infosLivret.avis=aElement;this._donnees.avisCE.infosLivret.avis.nbEleves++;}
else this._donnees.avisCE.infosLivret.avis=null;GHtml.setHtml(this.idRepartition,_construireRepartition.bind(this)());this._donnees.avisCE.infosLivret.SetEtat(EGenreEtat.Modification);this.SetEtatSaisie(true);}}};ObjetPiedFicheScolaire.prototype._evnSelectEngagements=function(aGenreBouton,aListeDonnees){if(aGenreBouton===1){this._donnees.engagements.listeEngagements=aListeDonnees;this._donnees.engagements.estModifie=true;this.SetEtatSaisie(true);}};function _getGenreIndividu(aGenreRessource){switch(aGenreRessource){case EGenreRessource.Enseignant:return TypeGenreIndividuAuteur.GIA_Professeur;case EGenreRessource.Personnel:return TypeGenreIndividuAuteur.GIA_Personnel;case EGenreRessource.Responsable:return TypeGenreIndividuAuteur.GIA_Responsable;case EGenreRessource.Eleve:return TypeGenreIndividuAuteur.GIA_Eleve;case EGenreRessource.MaitreDeStage:return TypeGenreIndividuAuteur.GIA_MaitreDeStage;case EGenreRessource.InspecteurPedagogique:return TypeGenreIndividuAuteur.GIA_Inspecteur;default:;break;}}
function _surChangeTextArea(event){var lInstance=event.data.instance;lInstance.SetEtatSaisie(true);lInstance._donnees.avisCE.infosLivret.SetEtat(EGenreEtat.Modification);lInstance._donnees.avisCE.infosLivret.commentaire=GHtml.getValue(this);if(!lInstance.estNonEditable){if(lInstance._donnees.avisCE.infosLivret.commentaire){if(!lInstance._donnees.avisCE.infosLivret.date&&lInstance._donnees.estIssueDUnBOLycee){lInstance._donnees.avisCE.infosLivret.date=GDate.getDateCourante();lInstance.celluleDate[TypeAvisCommentaire.tac_ChefEtablissement].SetActif(true);lInstance.celluleDate[TypeAvisCommentaire.tac_ChefEtablissement].SetDonnees(lInstance._donnees.avisCE.infosLivret.date);}} else{lInstance._donnees.avisCE.infosLivret.date=null;lInstance._donnees.avisCE.infosLivret.auteur=null;lInstance.celluleDate[TypeAvisCommentaire.tac_ChefEtablissement].SetDonnees(lInstance._donnees.avisCE.infosLivret.date);lInstance.celluleDate[TypeAvisCommentaire.tac_ChefEtablissement].SetActif(false);GHtml.setHtml(lInstance.idNomSignature+'_'+TypeAvisCommentaire.tac_ChefEtablissement,'&nbsp;');}}}
function _surChangeCommentaireEngagements(event){var lInstance=event.data.instance;lInstance.SetEtatSaisie(true);lInstance._donnees.engagements.infosLivret.SetEtat(EGenreEtat.Modification);lInstance._donnees.engagements.estModifie=true;lInstance._donnees.engagements.infosLivret.commentaire=GHtml.getValue(this);if(!lInstance.estNonEditable){if(lInstance._donnees.engagements.infosLivret.commentaire){if(!lInstance._donnees.engagements.infosLivret.date){lInstance._donnees.engagements.infosLivret.date=GDate.getDateCourante();lInstance.celluleDate[TypeAvisCommentaire.tac_Engagement].SetActif(true);lInstance.celluleDate[TypeAvisCommentaire.tac_Engagement].SetDonnees(lInstance._donnees.engagements.infosLivret.date);}} else{lInstance._donnees.engagements.infosLivret.date=null;lInstance._donnees.engagements.infosLivret.auteur=null;lInstance.celluleDate[TypeAvisCommentaire.tac_Engagement].SetDonnees(lInstance._donnees.engagements.infosLivret.date);lInstance.celluleDate[TypeAvisCommentaire.tac_Engagement].SetActif(false);GHtml.setHtml(lInstance.idNomSignature+'_'+TypeAvisCommentaire.tac_Engagement,'&nbsp;');}}}
function _surChangeCommentaireInvestissement(event){var lInstance=event.data.instance;lInstance.SetEtatSaisie(true);lInstance._donnees.investissement.infosLivret.SetEtat(EGenreEtat.Modification);lInstance._donnees.investissement.estModifie=true;lInstance._donnees.investissement.infosLivret.commentaire=GHtml.getValue(this);if(!lInstance.estNonEditable){if(lInstance._donnees.investissement.infosLivret.commentaire){if(!lInstance._donnees.investissement.infosLivret.date){lInstance._donnees.investissement.infosLivret.date=GDate.getDateCourante();lInstance.celluleDate[TypeAvisCommentaire.tac_Investissement].SetActif(true);lInstance.celluleDate[TypeAvisCommentaire.tac_Investissement].SetDonnees(lInstance._donnees.investissement.infosLivret.date);}
if(!lInstance._donnees.investissement.infosLivret.auteur){lInstance._donnees.investissement.infosLivret.auteur=new ObjetElement(GEtatUtilisateur.getUtilisateur().GetLibelle(),GEtatUtilisateur.getUtilisateur().GetNumero(),_getGenreIndividu.bind(lInstance)(GEtatUtilisateur.getUtilisateur().GetGenre()));GHtml.setHtml(lInstance.idNomSignature+'_'+TypeAvisCommentaire.tac_Investissement,lInstance._donnees.investissement.infosLivret.auteur.GetLibelle());}} else{lInstance._donnees.investissement.infosLivret.date=null;lInstance._donnees.investissement.infosLivret.auteur=null;lInstance.celluleDate[TypeAvisCommentaire.tac_Investissement].SetDonnees(lInstance._donnees.investissement.infosLivret.date);lInstance.celluleDate[TypeAvisCommentaire.tac_Investissement].SetActif(false);GHtml.setHtml(lInstance.idNomSignature+'_'+TypeAvisCommentaire.tac_Investissement,'&nbsp;');}}}
ObjetPiedFicheScolaire.prototype.getInfosLivret=function(){return this._donnees.avisCE.infosLivret;};})();MethodesObjet.heritagePrototype(DonneesListe_SelectionSignataireAvis,ObjetDonneesListe);function DonneesListe_SelectionSignataireAvis(aDonnees){this.inheritedCreate(aDonnees);}
DonneesListe_SelectionSignataireAvis.prototype.AvecEdition=function(I,D){return false;};DonneesListe_SelectionSignataireAvis.prototype.AvecSuppression=function(D){return false;};DonneesListe_SelectionSignataireAvis.prototype.AvecEvenement_Selection=function(I,D){return true;};DonneesListe_SelectionSignataireAvis.prototype.GetValeur=function(I,D,K,aSurEdition){return D.GetLibelle();};DonneesListe_SelectionSignataireAvis.prototype.getTri=function(I,D){return[ObjetTri.init(function(D){return D.GetNumero()?true:false;}),ObjetTri.init('Libelle')];};;
var EGenreInfo_LivretScolaire={Classe:0,Eleve:1};function ObjetRequeteLivretScolaire(aPere,aEvenementSurReussite,aEvenementSurEchec){this.inheritedCreate(aPere,aEvenementSurReussite,aEvenementSurEchec);if(GEtatUtilisateur.GenreEspace===EGenreEspace.Professeur)
this.cache=GCache.livretScolaire;}
IE.Requetes.inscrire('LivretScolaire',ObjetRequeteLivretScolaire,_ObjetRequeteXmlConsultationPN);ObjetRequeteLivretScolaire.prototype.lancerRequete=function(aObjet){this.donnees=aObjet;var lAvecDonneesClasse=true;var lXml=this.XML;lXml.CreerElement(null,'Classe',aObjet.classe);if(aObjet.eleve)
lXml.CreerElement(null,'Eleve',aObjet.eleve);if(aObjet.discipline)
lXml.CreerElement(null,'Discipline',aObjet.discipline,this,this._ajouterDiscipline);lXml.CreerVariable(null,'AvecDonneesClasse',EGenreType.Boolean,lAvecDonneesClasse);this.appelAsynchroneConsultation();};ObjetRequeteLivretScolaire.prototype._ajouterDiscipline=function(aXml,aNoeud,aDiscipline){if(aDiscipline.service)
aXml.CreerElement(aNoeud,'Service',aDiscipline.service);if(aDiscipline.typeEnseignement!==null||aDiscipline.typeEnseignement!==undefined)
aXml.CreerVariable(aNoeud,'TypeEnseignement',EGenreType.Integer,aDiscipline.typeEnseignement);};ObjetRequeteLivretScolaire.prototype.actionApresRequete=function(aXml){var lResult={};var lJSON=this.JSONReponse;lResult.options=lJSON.options;lResult.graphe=lJSON.graphe;lResult.avecFiliere=lJSON.avecFiliere;lResult.estFilierePro=lJSON.estFilierePro;if(lJSON.tailleMaxSaisie)
lResult.tailleMaxSaisie=lJSON.tailleMaxSaisie;lResult.genre=this.donnees.genre;if(lJSON.message){lResult.message=lJSON.message;} else{if(lJSON.classe){lResult.classe=new ObjetElement().fromJSON(lJSON.classe);lResult.classe.nombrePeriodes=lJSON.classe.nombrePeriodes;lResult.classe.listeLivret=new ObjetListeElements();this.recupererDonnees(lJSON.classe.listeLivret,lResult.classe.listeLivret);lResult.classe.listeMoyenne=new ObjetListeElements();this.recupererDonnees(lJSON.classe.listeMoyenne,lResult.classe.listeMoyenne);if(this.cache){this.cache.setDonnee(this.donnees.genre+this.donnees.classe.getCle()+this.donnees.eleve.getCle(),lResult.classe);this.cache.setDonnee(this.donnees.genre+this.donnees.classe.getCle()+this.donnees.eleve.getCle()+'_graphe',lResult.graphe);}} else{if(this.cache&&(this.donnees.genre===EGenreOnglet.LivretScolaire_Fiche)){lResult.classe=this.cache.getDonnee(this.donnees.genre+this.donnees.classe.getCle()+this.donnees.eleve.getCle());lResult.graphe=this.cache.getDonnee(this.donnees.genre+this.donnees.classe.getCle()+this.donnees.eleve.getCle()+'_graphe');}}
if(lJSON.eleve){lResult.eleve=new ObjetElement().fromJSON(lJSON.eleve);lResult.eleve.libelleEnseignement=lJSON.eleve.libelleEnseignement;lResult.eleve.listeLivret=new ObjetListeElements();if(lJSON.eleve.listeLivret)
this.recupererDonnees(lJSON.eleve.listeLivret,lResult.eleve.listeLivret);lResult.eleve.listeMoyenne=new ObjetListeElements();if(lJSON.eleve.listeMoyenne)
this.recupererDonnees(lJSON.eleve.listeMoyenne,lResult.eleve.listeMoyenne);}
if(lJSON.service){lResult.service=new ObjetElement().fromJSON(lJSON.service);lResult.service.titre=lJSON.service.titre;lResult.service.libelleEnseignement=lJSON.service.libelleEnseignement;lResult.service.listeLivret=new ObjetListeElements();if(lJSON.service.listeLivret)
this.recupererDonnees(lJSON.service.listeLivret,lResult.service.listeLivret);lResult.service.listeMoyenne=new ObjetListeElements();var lIDCache=this.donnees.genre+this.donnees.classe.getCle()+this.donnees.discipline.getCle()+this.donnees.discipline.service.getCle();if(lJSON.service.listeMoyenne){this.recupererDonnees(lJSON.service.listeMoyenne,lResult.service.listeMoyenne);if(this.cache)
this.cache.setDonnee(lIDCache,lResult.service.listeMoyenne);} else{if(this.cache&&(this.donnees.genre!==EGenreOnglet.LivretScolaire_Fiche)&&this.cache.existeDonnee(lIDCache))
lResult.service.listeMoyenne=this.cache.getDonnee(lIDCache);}}
this.recupererPiedDePage(lJSON,lResult);}
this.callbackReussite.appel(lResult);};ObjetRequeteLivretScolaire.prototype.recupererDonnees=function(aTabJSON,aDonnees){this.elmPere=null;if(aTabJSON){for(var i in aTabJSON){this._ajouterItemLivret(aTabJSON[i],aDonnees);}} else aDonnees=null;};ObjetRequeteLivretScolaire.prototype.recupererPiedDePage=function(aJSON,aDonnees){if(aJSON.piedDePage){var lJSON=aJSON.piedDePage;aDonnees.piedDePage={avecAvisCE:lJSON.avecAvisCE,estIssueDUnBOLycee:lJSON.estIssueDUnBOLycee,avecEngagements:lJSON.avecEngagements,avecInvestissement:lJSON.avecInvestissement,editable:lJSON.editable,listeEngagements:aJSON.listeEngagements};if(lJSON.avecAvisCE&&lJSON.avisCE){aDonnees.piedDePage.avisCE=lJSON.avisCE;if(!lJSON.avisCE.infosLivret){aDonnees.piedDePage.avisCE.infosLivret=new ObjetElement();aDonnees.piedDePage.avisCE.infosLivret.avis=null;aDonnees.piedDePage.avisCE.infosLivret.commentaire='';aDonnees.piedDePage.avisCE.infosLivret.auteur=new ObjetElement();aDonnees.piedDePage.avisCE.infosLivret.date=null;}}
if(lJSON.avecEngagements&&lJSON.engagements){aDonnees.piedDePage.engagements=lJSON.engagements;if(!lJSON.engagements.infosLivret){aDonnees.piedDePage.engagements.infosLivret=new ObjetElement();aDonnees.piedDePage.engagements.infosLivret.commentaire='';aDonnees.piedDePage.engagements.infosLivret.auteur=new ObjetElement();aDonnees.piedDePage.engagements.infosLivret.date=null;}}
if(lJSON.avecInvestissement&&lJSON.investissement){aDonnees.piedDePage.investissement=lJSON.investissement;if(!lJSON.investissement.infosLivret){aDonnees.piedDePage.investissement.infosLivret=new ObjetElement();aDonnees.piedDePage.investissement.infosLivret.commentaire='';aDonnees.piedDePage.investissement.infosLivret.auteur=new ObjetElement();aDonnees.piedDePage.investissement.infosLivret.date=null;}}} else aDonnees.piedDePage=null;};ObjetRequeteLivretScolaire.prototype._ajouterItemLivret=function(aJSON,aParametre){var lElement=new ObjetElement().fromJSON(aJSON);lElement.titreEnseignement=aJSON.titreEnseignement?aJSON.titreEnseignement:false;if(lElement.titreEnseignement)
this.elmPere=lElement;else lElement.pere=this.elmPere;lElement.titreDiscipline=aJSON.titreDiscipline?aJSON.titreDiscipline:false;lElement.estSansObligationDeNotation=aJSON.estSansObligationDeNotation?aJSON.estSansObligationDeNotation:false;lElement.titreService=aJSON.titreService?aJSON.titreService:false;lElement.avecServices=aJSON.avecServices?aJSON.avecServices:false;lElement.titreEnseignant=aJSON.titreEnseignant?aJSON.titreEnseignant:false;lElement.avecRegroupement=aJSON.avecRegroupement?aJSON.avecRegroupement:false;lElement.derniereligne=aJSON.derniereligne?aJSON.derniereligne:false;lElement.dernierDuService=aJSON.dernierDuService?aJSON.dernierDuService:false;lElement.livretEditable=aJSON.livretEditable?aJSON.livretEditable:false;if(aJSON.metaMatiere)
lElement.metaMatiere=new ObjetElement().fromJSON(aJSON.metaMatiere);if(aJSON.service)
lElement.service=new ObjetElement().fromJSON(aJSON.service);if(aJSON.nombreLignes)
lElement.nombreLignes=aJSON.nombreLignes;if(aJSON.eleve)
lElement.eleve=new ObjetElement().fromJSON(aJSON.eleve);if(aJSON.periode)
lElement.periode=new ObjetElement().fromJSON(aJSON.periode);if(aJSON.rangEleve)
lElement.rangEleve=aJSON.rangEleve;if(aJSON.rangTotal)
lElement.rangTotal=aJSON.rangTotal;if(aJSON.moyEleve)
lElement.moyEleve=aJSON.moyEleve;if(aJSON.moyClasse)
lElement.moyClasse=aJSON.moyClasse;if(aJSON.tabMoyennes)
lElement.tabMoyennes=aJSON.tabMoyennes;if(aJSON.inf8)
lElement.inf8=aJSON.inf8;if(aJSON.de8a12)
lElement.de8a12=aJSON.de8a12;if(aJSON.sup12)
lElement.sup12=aJSON.sup12;if(aJSON.itemLS){lElement.itemLivretScolaire=new ObjetElement().fromJSON(aJSON.itemLS);this._ajouterCompetence(aJSON.itemLS,lElement.itemLivretScolaire);}
if(aJSON.listeCompetences){lElement.listeCompetences=new ObjetListeElements().fromJSON(aJSON.listeCompetences,this._ajouterCompetence);}
if(aJSON.appr)
lElement.appreciation=aJSON.appr;if(aJSON.apprAnnuelle){lElement.appreciationAnnuelle=new ObjetElement().fromJSON(aJSON.apprAnnuelle);if(aJSON.apprAnnuelle.editable)
lElement.appreciationAnnuelle.editable=aJSON.apprAnnuelle.editable;if(aJSON.apprAnnuelle.tailleMaxSaisie)
lElement.appreciationAnnuelle.tailleMaxSaisie=aJSON.apprAnnuelle.tailleMaxSaisie;}
lElement.rowspan=aJSON.rowspan?aJSON.rowspan:0;aParametre.AddElement(lElement);};ObjetRequeteLivretScolaire.prototype._ajouterCompetence=function(aJSON,aElement){if(aJSON.evaluation){aElement.evaluation=new ObjetElement().fromJSON(aJSON.evaluation);aElement.evaluation.abbreviation=aJSON.evaluation.abbreviation;} else{aElement.evaluation=new ObjetElement('',null,0);aElement.evaluation.abbreviation='';}};;
MethodesObjet.heritagePrototype(InterfaceLivretScolaire,_PageAppreciations);function InterfaceLivretScolaire(aNom,aIdent,aPere,aEvenement){this.genreImpression=GEtatUtilisateur.getGenreOnglet()===EGenreOnglet.LivretScolaire_Fiche?EGenreImpression.GenerationPDF:EGenreImpression.Format;this.inheritedCreate(aNom,aIdent,aPere,aEvenement);}
InterfaceLivretScolaire.prototype.ConstruireInstances=function(){this.listeClasseHistorique=null;if(window.ObjetAffichagePageAvecMenusDeroulants){this.identTripleCombo=this.Add(window.ObjetAffichagePageAvecMenusDeroulants ,this.evenementSurDernierMenuDeroulant ,this.initialiserTripleCombo);}
if((this.identTripleCombo!==null&&this.identTripleCombo!==undefined)&&this.GetInstance(this.identTripleCombo)!==null) this.IdPremierElement=this.GetInstance(this.identTripleCombo).getPremierElement();if(!GEtatUtilisateur.estModeAccessible()||GEtatUtilisateur.getGenreOnglet()!==EGenreOnglet.LivretScolaire_Fiche){this.IdentPage=this.Add(window.ObjetLivretScolaire ,this.evenementSaisieSurCellule,this.initialiserFicheScolaire);} else{this.IdentPage=this.Add(window.ObjetListeArborescente,null,null);}
if(GEtatUtilisateur.getGenreOnglet()===EGenreOnglet.LivretScolaire_Fiche)
this.IdentPied=this.Add(window.ObjetPiedFicheScolaire ,null,null);if($.inArray(GEtatUtilisateur.GenreEspace,[EGenreEspace.Eleve,EGenreEspace.Parent])> -1){var lEleve=GEtatUtilisateur.getMembre();var lNrDernierClasse=lEleve.Classe.GetNumero();if(lEleve&&lEleve.listeClasseHistorique)
this.listeClasseHistorique=lEleve.listeClasseHistorique.getListeElements(function(aElement,aIndice){return(aElement.avecNote&&!aElement.avecFiliere)||(aElement.GetNumero()===lNrDernierClasse);});if(this.listeClasseHistorique&&this.listeClasseHistorique.GetNbrElements()>1)
this.identCmbClasseHistorique=this.Add(window.ObjetSaisie ,this.evenementClasseHistorique,this.initialiserClasseHistorique);}
if(GEtatUtilisateur.GenreEspace===EGenreEspace.Professeur||(this.listeClasseHistorique&&this.listeClasseHistorique.GetNbrElements()>1))
this.identBandeau=this.Add(window.ObjetBandeau ,null,null);if(GEtatUtilisateur.GenreEspace===EGenreEspace.Professeur)
this.identFenetreSaisieEvaluation=this.addFenetre(window.ObjetFenetre_Liste,this.evenementFenetre_Liste.bind(this),this.initialiserSaisieEvaluation);if(this.avecAssistantSaisie()){this.identBoutonAssistant=this.Add(window.ObjetBoutonBandeau,this.evenementSurAssistant ,this.initialiserBoutonAssistant);this.identFenetreAssistantSaisie=this.Add(window.ObjetFenetre_AssistantSaisie ,this.evenementAssistantSaisie ,this.initialiserAssistantSaisie);}
if((GEtatUtilisateur.GenreEspace===EGenreEspace.Professeur)&&(GEtatUtilisateur.getGenreOnglet()===EGenreOnglet.LivretScolaire_Fiche)){this.construireFicheEleveEtFichePhoto();}
if(GEtatUtilisateur.getGenreOnglet()===EGenreOnglet.LivretScolaire_Fiche){this.identBtnFicheGraphe=this.Add(window.ObjetBoutonBandeau,this.evtSurBtnFicheGraphe,this.initialiserBtnGraphe);this.identFicheGraphe=this.Add(window.ObjetFicheGraphe);}};InterfaceLivretScolaire.prototype.avecAssistantSaisie=function(){return GApplication.droits.get(IEEnum.droits.assistantSaisieAppreciations)&&GEtatUtilisateur.getGenreOnglet()!==EGenreOnglet.LivretScolaire_Competences&&(GEtatUtilisateur.GenreEspace===EGenreEspace.Professeur);};InterfaceLivretScolaire.prototype.RecupererDonnees=function(){if(!this.Pere.EnConstruction){if(GEtatUtilisateur.GenreEspace===EGenreEspace.Professeur){if(GEtatUtilisateur.getGenreOnglet()!==EGenreOnglet.LivretScolaire_Appreciations)
new ObjetRequeteListeCompetencesLivretScolaire(this,this.actionSurListeCompetencesLivretScolaire).lancerRequete();} else{this.classeSelectionne=GEtatUtilisateur.getMembre().Classe;if(this.listeClasseHistorique&&this.listeClasseHistorique.GetNbrElements()>1){var lNumero=this.classeSelectionne.GetNumero();var lIndice=this.listeClasseHistorique.getIndiceElementParFiltre(function(aElement){return aElement.GetNumero()===lNumero;});if(lIndice===-1) lIndice=0;this.GetInstance(this.identCmbClasseHistorique).SetDonnees(this.listeClasseHistorique,lIndice);} else{this.AfficherPage();}}}};InterfaceLivretScolaire.prototype.initialiserFicheScolaire=function(aInstance){aInstance.setTraductions(GTraductions.getValeur('ficheScolaire'));if(GEtatUtilisateur.GenreEspace===EGenreEspace.Professeur)
aInstance.setParametres(GParametres.getTailleMaxAppreciationParEnumere(TypeGenreAppreciation.GA_BilanAnnuel_Professeur));};InterfaceLivretScolaire.prototype.initialiserClasseHistorique=function(aInstance){aInstance.SetParametres(EGenreSaisie.Liste,200,null,true);};InterfaceLivretScolaire.prototype.initialiserSaisieEvaluation=function(aInstance){var lParam={tailles:new Array('100%')};aInstance.SetParametres_Fenetre(GTraductions.getValeur('ficheScolaire.titreSaisieEvaluations'),280,this.evaluationLV?233:193,lParam);};InterfaceLivretScolaire.prototype.SetParametresGeneraux=function(){this.IdentZoneAlClient=this.IdentPage;this.AddSurZone=[];if(IE.MethodesObjet.isNumber(this.identTripleCombo)) this.AddSurZone.push(this.identTripleCombo);if(IE.MethodesObjet.isNumber(this.identBandeau)) this.AddSurZone.push(this.identBandeau);if(this.avecAssistantSaisie()) this.AddSurZone.push(this.identBoutonAssistant);if(this.listeClasseHistorique&&this.listeClasseHistorique.GetNbrElements()>1) this.AddSurZone.push(this.identCmbClasseHistorique);if(this.identBtnFicheEleve) this.AddSurZone.push(this.identBtnFicheEleve);if(this.identBtnFichePhoto) this.AddSurZone.push(this.identBtnFichePhoto);if(this.identBtnFicheGraphe) this.AddSurZone.push({ident:this.identBtnFicheGraphe,alignementDroite:true});};InterfaceLivretScolaire.prototype.initialiserTripleCombo=function(aInstance){switch(GEtatUtilisateur.getGenreOnglet()){case EGenreOnglet.LivretScolaire_Appreciations:aInstance.SetParametres(new Array(EGenreRessource.Classe,EGenreRessource.DisciplineLivretScolaire));break;case EGenreOnglet.LivretScolaire_Competences:aInstance.SetParametres(new Array(EGenreRessource.Classe,EGenreRessource.DisciplineLivretScolaire));break;default:aInstance.SetParametres(new Array(EGenreRessource.Classe,EGenreRessource.Eleve));break;}
aInstance.setEvenementMenusDeroulants(this.surEvntMenusDeroulants);};InterfaceLivretScolaire.prototype.evenementSaisieSurCellule=function(aParamEvnt){if(aParamEvnt.saisieCompetenceLivretScolaire){this._evenementSaisieCompetenceLivretScolaire(aParamEvnt);return;} else{this.inherited('evenementSaisieSurCellule',aParamEvnt);}};InterfaceLivretScolaire.prototype._evenementSaisieCompetenceLivretScolaire=function(aParamEvnt){if(GEtatUtilisateur.GenreEspace!==EGenreEspace.Professeur)
return;var aCoordonneesCellule=aParamEvnt.coordonneesCellule;if(GEtatUtilisateur.getGenreOnglet()===EGenreOnglet.LivretScolaire_Competences){this.numeroEvaluation=aCoordonneesCellule.numAppreciation;this.elementCourant=this.donnees.service.listeLivret.GetElementParGenre(aCoordonneesCellule.numLigne+1);this.elmComptence=this.elementCourant.listeCompetences.GetElement(this.numeroEvaluation);} else{this.numeroEvaluation=0;this.elementCourant=this.donnees.eleve.listeLivret.GetElementParGenre(aCoordonneesCellule.numLigne+1);this.elmComptence=this.elementCourant.itemLivretScolaire;}
if(this.elmComptence){this.evaluationLV=(this.elmComptence.GetGenre()>4);this.listeEvaluations=this.evaluationLV?this.listeSaisie.listeEvaluationsLSLV:this.listeSaisie.listeEvaluationsLS;this.GetInstance(this.identFenetreSaisieEvaluation).SetDonnees(new DonneesListe_EvaluationsLivretScolaire(this.listeEvaluations),true);}};InterfaceLivretScolaire.prototype.evenementSurDernierMenuDeroulant=function(aClasse,aPeriode,aEleve){if(GEtatUtilisateur.getGenreOnglet()===EGenreOnglet.LivretScolaire_Fiche)
this.surSelectionEleve();this.AfficherPage();};InterfaceLivretScolaire.prototype.evenementClasseHistorique=function(aGenreEvenement,aElement){switch(aGenreEvenement){case EGenreEvenementObjetSaisie.selection:this.classeSelectionne=aElement;this.AfficherPage();break;case EGenreEvenementObjetSaisie.deploiement:break;default:;break;}};InterfaceLivretScolaire.prototype.surEvntMenusDeroulants=function(aParam){this.inherited('surEvntMenusDeroulants',aParam);var lClasse=GEtatUtilisateur.Navigation.GetRessource(EGenreRessource.Classe);if((aParam.genreCombo===EGenreRessource.DisciplineLivretScolaire)&&(aParam.genreEvenement===EGenreEvntMenusDeroulants.surOuvertureCombo)&&(GEtatUtilisateur.getGenreOnglet()===EGenreOnglet.LivretScolaire_Competences)){if(lClasse&&lClasse.GetGenre()===EGenreRessource.Classe&&!lClasse.avecFiliere){this.bloquerDonneesAffichage=true;} else this.bloquerDonneesAffichage=false;}
if((aParam.genreEvenement===EGenreEvntMenusDeroulants.ressourceNonTrouve)&&this.GetInstance(this.IdentPied))
this.GetInstance(this.IdentPied).SetDonnees(null);if((aParam.genreCombo===EGenreRessource.DisciplineLivretScolaire)&&aParam.aucunElement&&(aParam.genreEvenement===EGenreEvntMenusDeroulants.ressourceNonTrouve)){if(GEtatUtilisateur.getGenreOnglet()===EGenreOnglet.LivretScolaire_Competences){if(lClasse&&lClasse.GetGenre()===EGenreRessource.Classe)
this.EvenementAfficherMessage(GTraductions.getValeur('ficheScolaire.messageClasseSansFiliere'));else this.EvenementAfficherMessage(GTraductions.getValeur('ficheScolaire.messageGroupeSansFiliere'));}}};InterfaceLivretScolaire.prototype.evenementFenetre_Liste=function(aGenreBouton,aSelection,aAvecChangementListe){if(aGenreBouton===1){var lEval=MethodesObjet.dupliquer(this.listeEvaluations.GetElement(aSelection));if(!aSelection){lEval.SetLibelle('');lEval.SetEtat(EGenreEtat.Suppression);} else lEval.SetEtat(EGenreEtat.Modification);this.elmComptence.evaluation=lEval;this.elmComptence.SetEtat(EGenreEtat.FilsModification);this.elementCourant.SetEtat(EGenreEtat.FilsModification);this.GetInstance(this.IdentPage).actualiserEvaluation(this.elementCourant,this.numeroEvaluation);this.SetEtatSaisie(true);}};InterfaceLivretScolaire.prototype.actionSurListeCompetencesLivretScolaire=function(aDonnees){this.listeSaisie=aDonnees;};InterfaceLivretScolaire.prototype.actionSurRecupererDonnees=function(aDonnees){if(this.GetInstance(this.identBtnFicheGraphe))
this.GetInstance(this.identBtnFicheGraphe).setLibelles([GTraductions.getValeur('competences.titreGraphe'),GTraductions.getValeur('ficheScolaire.boutonGraphe'),GTraductions.getValeur('competences.titreGraphe')]);this.afficherBandeau(true);this.donnees=aDonnees;this.donnees.listeSaisie=this.listeSaisie;this.donnees.classeSelectionne=GEtatUtilisateur.Navigation.GetRessource(EGenreRessource.Classe);if(GEtatUtilisateur.estModeAccessible()&&(GEtatUtilisateur.getGenreOnglet()===EGenreOnglet.LivretScolaire_Fiche)){this.AfficherListe();} else{if(this.donnees.message){this.EvenementAfficherMessage(this.donnees.message);} else{if(GEtatUtilisateur.getGenreOnglet()===EGenreOnglet.LivretScolaire_Fiche){if(this.donnees.eleve.listeLivret.GetNbrElements()>0)
this.GetInstance(this.IdentPied).SetDonnees(this.donnees.piedDePage,this.donnees.estFilierePro);else this.GetInstance(this.IdentPied).SetDonnees(null);}
if(this.donnees.tailleMaxSaisie)
this.GetInstance(this.IdentPage).setParametres(this.donnees.tailleMaxSaisie);this.GetInstance(this.IdentPage).SetDonnees(this.donnees);if(GEtatUtilisateur.getGenreOnglet()===EGenreOnglet.LivretScolaire_Fiche){var lEleve=GEtatUtilisateur.GenreEspace===EGenreEspace.Professeur?GEtatUtilisateur.Navigation.GetRessource(EGenreRessource.Eleve):GEtatUtilisateur.getMembre();var lClasse=GEtatUtilisateur.GenreEspace===EGenreEspace.Professeur?GEtatUtilisateur.Navigation.GetRessource(EGenreRessource.Classe):lEleve.Classe;var lTitreGraphe=GChaine.Format(GTraductions.getValeur('ficheScolaire.titreGraphe'),[lEleve.GetLibelle()]);GEtatUtilisateur.setGraphe({image:[this.donnees.graphe],titre:lTitreGraphe,message:GTraductions.getValeur('competences.pasDAffichageGraphe')});}
this.actualiserFicheGraphe();if(this.GetInstance(this.identBandeau)){if((this.donnees.service&&this.donnees.service.libelleEnseignement)||(this.donnees.eleve&&this.donnees.eleve.libelleEnseignement)){this.GetInstance(this.identBandeau).SetLibelle('&nbsp;');var lLargeur=Math.max($('#'+this.GetNomInstance(this.identBandeau).escapeJQ()+'_Libelle').width(),230);var lLibelleEnseignement=GEtatUtilisateur.getGenreOnglet()===EGenreOnglet.LivretScolaire_Fiche?this.donnees.eleve.libelleEnseignement:this.donnees.service.libelleEnseignement;var lLibelle=GChaine.GetLongueurChaine(lLibelleEnseignement,10,true,lLargeur);this.GetInstance(this.identBandeau).SetLibelle(lLibelle);if(lLibelle!==lLibelleEnseignement)
this.GetInstance(this.identBandeau).setInfoBulle(lLibelleEnseignement);else this.GetInstance(this.identBandeau).setInfoBulle('');} else{this.GetInstance(this.identBandeau).SetLibelle('');this.GetInstance(this.identBandeau).setInfoBulle('');}}
this.surResizeInterface();if(GEtatUtilisateur.GenreEspace!==EGenreEspace.Eleve)
Invocateur.evenement(Invocateur.events.activationImpression,this.genreImpression,this,this.getParametresPDF.bind(this));}}};InterfaceLivretScolaire.prototype.Valider=function(){this.donnees.genre=GEtatUtilisateur.getGenreOnglet();this.donnees.listeTypesAppreciations=this.listeTypesAppreciations;new ObjetRequeteSaisieLivretScolaire(this,this.ActionSurValidation).lancerRequete(this.donnees);};InterfaceLivretScolaire.prototype.AfficherPage=function(){this.getListeTypesAppreciations();if(GEtatUtilisateur.GenreEspace===EGenreEspace.Professeur)
this.classeSelectionne=GEtatUtilisateur.Navigation.GetRessource(EGenreRessource.Classe);this.SetEtatSaisie(false);if(this.bloquerDonneesAffichage){this.GetInstance(this.IdentPage).SetDonnees(null);if(this.GetInstance(this.identTripleCombo))
this.GetInstance(this.identTripleCombo).afficherCombo(EGenreRessource.DisciplineLivretScolaire,false);return;} else if(GEtatUtilisateur.getGenreOnglet()===EGenreOnglet.LivretScolaire_Competences&&this.GetInstance(this.identTripleCombo)){this.GetInstance(this.identTripleCombo).afficherCombo(EGenreRessource.DisciplineLivretScolaire,true);}
var lObjet={genre:GEtatUtilisateur.getGenreOnglet(),classe:this.classeSelectionne};if(GEtatUtilisateur.getGenreOnglet()===EGenreOnglet.LivretScolaire_Fiche){lObjet.eleve=GEtatUtilisateur.GenreEspace===EGenreEspace.Professeur?GEtatUtilisateur.Navigation.GetRessource(EGenreRessource.Eleve):GEtatUtilisateur.getMembre();} else{lObjet.discipline=GEtatUtilisateur.Navigation.GetRessource(EGenreRessource.DisciplineLivretScolaire);}
new ObjetRequeteLivretScolaire(this,this.actionSurRecupererDonnees).lancerRequete(lObjet);};InterfaceLivretScolaire.prototype.GetPageImpression=function(AFormat){var H=[];if(this.GetInstance(this.IdentPage))
H.push(this.GetInstance(this.IdentPage).ComposePage(true,AFormat));if(this.GetInstance(this.IdentPied))
H.push(this.GetInstance(this.IdentPied).composeImpression(AFormat));return{titre1:GEtatUtilisateur.getLibelleImpression(GTraductions.getValeur('ficheScolaire.livretScolaire'),false,true,true,false,false,false),contenu:H.join('')};};InterfaceLivretScolaire.prototype.getParametresPDF=function(){var lEleve=GEtatUtilisateur.GenreEspace===EGenreEspace.Professeur?GEtatUtilisateur.Navigation.GetRessource(EGenreRessource.Eleve):GEtatUtilisateur.getMembre();var lResult={genreGenerationPDF:TypeHttpGenerationPDF.LivretScolaire,eleve:lEleve};return lResult;};InterfaceLivretScolaire.prototype.surResizeInterface=function(){this.inherited('surResizeInterface');};;
InterfaceLivretScolaire.prototype.AfficherListe=function(){var lObjArborescent=this.Instances[this.IdentPage];var lRacine=lObjArborescent.construireRacine();var lNoeudGenreEnseignement,lNoeudMetaMatiere,lNoeudService,lNoeudPeriode,lNoeudCompetence,lNoeudAppreciation,lNoeudOnglet,lNoeudRepartition;var lNoeudRegroupement;var lObjetNoeudCompetences;var lMetaMatiere,lService,lCompetence,lAppreciation,lEvaluation;var lElmEleve,lElmClasse;var lID;var i,lHeight,lIDAppr;var lClasseNoeud="Gras EspaceGauche MargeHaut MargeBas",lClasseFeuille="MargeHaut MargeBas";if(this.donnees.message){lObjArborescent.ajouterUneFeuilleAuNoeud(lRacine,this.Nom+'_GenreEnseignement_0',this.donnees.message,lClasseFeuille);} else{lHeight=$('#'+this.Nom.escapeJQ()).height();if(this.donnees.avecFiliere)
for(i=0;i<this.donnees.eleve.listeLivret.GetNbrElements();i++){lElmEleve=this.donnees.eleve.listeLivret.GetElement(i);lElmClasse=this.donnees.classe.listeLivret.GetElement(i);if(!lElmEleve.pere){lMetaMatiere=null;lService=null;lID=this.Nom+'_GenreEnseignement_'+lElmEleve.GetGenre();lNoeudGenreEnseignement=lObjArborescent.ajouterUnNoeudAuNoeud(lRacine,lID,lElmEleve.GetLibelle(),lClasseNoeud,true,true);}
else{if(!lMetaMatiere||lMetaMatiere.GetNumero()!==lElmEleve.metaMatiere.GetNumero()){lMetaMatiere=lElmEleve.metaMatiere;lService=null;lID=this.Nom+'_Meta_'+lElmEleve.pere.GetGenre()+'_'+lMetaMatiere.GetNumero();lNoeudMetaMatiere=lObjArborescent.ajouterUnNoeudAuNoeud(lNoeudGenreEnseignement,lID,lMetaMatiere.GetLibelle(),lClasseNoeud,true);lObjetNoeudCompetences=lObjArborescent.construireUnNoeudPourNoeud(lNoeudMetaMatiere,this.Nom+'_Competences_'+lElmEleve.pere.GetGenre()+'_'+lMetaMatiere.GetNumero(),GTraductions.getValeur('ficheScolaire.Accessible.Competences'),lClasseNoeud);}
if(lElmEleve.service){if(!lService||lService.GetNumero()!==lElmEleve.service.GetNumero()){lService=lElmEleve.service;lAppreciation=null;lID=this.Nom+'_Service_'+lElmEleve.pere.GetGenre()+'_'+lMetaMatiere.GetNumero()+'_'+lService.GetNumero();lNoeudService=lObjArborescent.ajouterUnNoeudAuNoeud(lNoeudMetaMatiere,lID,lService.GetLibelle(),lClasseNoeud,true);}
if(lElmEleve.periode){lID=this.Nom+'_Periode_'+lElmEleve.pere.GetGenre()+'_'+lMetaMatiere.GetNumero()+'_'+lService.GetNumero()+'_'+lElmEleve.periode.GetNumero();lNoeudPeriode=lObjArborescent.ajouterUnNoeudAuNoeud(lNoeudService,lID,lElmEleve.periode.GetLibelle(),lClasseNoeud);this._construireFeuillesPeriode(lElmEleve,lElmClasse,lObjArborescent,lNoeudPeriode,lID,lClasseNoeud,lClasseFeuille);}
if(lElmEleve.appreciationAnnuelle){lAppreciation=lElmEleve.appreciationAnnuelle;lIDAppr=this.Nom+'_Periode_'+lElmEleve.pere.GetGenre()+'_'+lMetaMatiere.GetNumero()+'_'+lService.GetNumero()+'_'+lAppreciation.GetNumero();}}
if(lAppreciation&&lElmEleve.avecServices&&(lElmEleve.dernierDuService||lElmEleve.derniereligne)){var lLibelleAppreciation=lAppreciation?lAppreciation.GetLibelle():GTraductions.getValeur('ficheScolaire.Accessible.pasevalue');if(lLibelleAppreciation==="") lLibelleAppreciation=GTraductions.getValeur('ficheScolaire.Accessible.pasevalue');lNoeudAppreciation=lObjArborescent.ajouterUnNoeudAuNoeud(lNoeudService,lIDAppr,GTraductions.getValeur('ficheScolaire.titreColAppreciations'),lClasseNoeud);lObjArborescent.ajouterUneFeuilleAuNoeud(lNoeudAppreciation,'',lLibelleAppreciation,lClasseFeuille);}
if(lElmEleve.itemLivretScolaire){lCompetence=lElmEleve.itemLivretScolaire;lID=this.Nom+'_Competence_'+lElmEleve.pere.GetGenre()+'_'+lMetaMatiere.GetNumero()+'_'+lCompetence.GetNumero();lNoeudCompetence=lObjArborescent.ajouterUnNoeudAuNoeud(lObjetNoeudCompetences.container,lID,lCompetence.GetLibelle(),lClasseNoeud);lEvaluation=lCompetence.evaluation&&lCompetence.evaluation.GetLibelle()?lCompetence.evaluation.GetLibelle():GTraductions.getValeur('ficheScolaire.Accessible.pasevalue');lObjArborescent.ajouterUneFeuilleAuNoeud(lNoeudCompetence,lID+'_eval',GTraductions.getValeur('ficheScolaire.Accessible.evaluation')+' : '+lEvaluation,lClasseFeuille);}
if(lElmEleve.derniereligne) lObjArborescent.ajouterArbreNoeudAuNoeud(lNoeudMetaMatiere,lObjetNoeudCompetences.noeud);}}
else for(i=0;i<this.donnees.eleve.listeLivret.GetNbrElements();i++){lElmEleve=this.donnees.eleve.listeLivret.GetElement(i);lElmClasse=this.donnees.classe.listeLivret.GetElement(i);if(!lElmEleve.avecRegroupement)
lNoeudRegroupement=null;if(lElmEleve.titreEnseignement){lID=this.Nom+'_Regroupement_'+lElmEleve.GetGenre();lNoeudRegroupement=lObjArborescent.ajouterUnNoeudAuNoeud(lRacine,lID,lElmEleve.GetLibelle(),lClasseNoeud,true,true);lService=null;}
else{if(lElmEleve.avecRegroupement&&!lNoeudRegroupement)
;if(!lService||lService.GetNumero()!==lElmEleve.service.GetNumero()){lService=lElmEleve.service;var lNoeud=lNoeudRegroupement?lNoeudRegroupement:lRacine;lID=this.Nom+'_Service_'+lService.GetNumero();lNoeudService=lObjArborescent.ajouterUnNoeudAuNoeud(lNoeud,lID,lService.GetLibelle(),lClasseNoeud,true);}}
if(lService&&lElmEleve.periode){lID=this.Nom+'_Periode_'+lService.GetNumero()+'_'+lElmEleve.periode.GetNumero();lNoeudPeriode=lObjArborescent.ajouterUnNoeudAuNoeud(lNoeudService,lID,lElmEleve.periode.GetLibelle(),lClasseNoeud);this._construireFeuillesPeriode(lElmEleve,lElmClasse,lObjArborescent,lNoeudPeriode,lID,lClasseNoeud,lClasseFeuille);if(lElmEleve.appreciation){lAppreciation=GTraductions.getValeur('ficheScolaire.titreColAppreciations')+' : '+lElmEleve.appreciation;lID=this.Nom+'_AppreciationPeriode_'+lService.GetNumero()+'_'+lElmEleve.periode.GetNumero();lObjArborescent.ajouterUneFeuilleAuNoeud(lNoeudPeriode,lID,lAppreciation,lClasseFeuille);}}}
if(GEtatUtilisateur.getGenreOnglet()===EGenreOnglet.LivretScolaire_Fiche){var lLibelleCommentaire,lLibelleAvis;if(this.donnees.piedDePage.avecAvisCE){lID=this.Nom+'_Avis_';var lLibelle=this.donnees.piedDePage.estIssueDUnBOLycee?GTraductions.getValeur('ficheScolaire.AvisEnVueDuBac'):GTraductions.getValeur('ficheScolaire.AvisDuChefDetablissement');lNoeudOnglet=lObjArborescent.ajouterUnNoeudAuNoeud(lRacine,lID,lLibelle,lClasseNoeud,false);if(this.donnees.piedDePage.avisCE.infosLivret.avis){lLibelleAvis=this.donnees.piedDePage.avisCE.infosLivret.avis.GetLibelle();lObjArborescent.ajouterUneFeuilleAuNoeud(lNoeudOnglet,lID,lLibelleAvis,lClasseFeuille) ;}
if(this.donnees.piedDePage.avisCE.infosLivret.commentaire){lLibelleCommentaire=this.donnees.piedDePage.avisCE.infosLivret.commentaire;lObjArborescent.ajouterUneFeuilleAuNoeud(lNoeudOnglet,lID,lLibelleCommentaire,lClasseFeuille) ;}
lID=this.Nom+'_Repartition_';lNoeudRepartition=lObjArborescent.ajouterUnNoeudAuNoeud(lRacine,lID,this.donnees.piedDePage.avisCE.libelleRepatition,lClasseNoeud,false);this._construireRepartition(lObjArborescent,lNoeudRepartition,lClasseFeuille);}
if(this.donnees.piedDePage.avecEngagements){lID=this.Nom+'_Engagements_';lNoeudOnglet=lObjArborescent.ajouterUnNoeudAuNoeud(lRacine,lID,GTraductions.getValeur('ficheScolaire.Engagements'),lClasseNoeud,false);if(this.donnees.piedDePage.engagements.listeEngagements){lLibelleAvis=this.donnees.piedDePage.engagements.listeEngagements.getTableauLibelles().join(', ');lObjArborescent.ajouterUneFeuilleAuNoeud(lNoeudOnglet,lID,lLibelleAvis,lClasseFeuille) ;}
if(this.donnees.piedDePage.engagements.infosLivret.commentaire){lLibelleCommentaire=this.donnees.piedDePage.engagements.infosLivret.commentaire;lObjArborescent.ajouterUneFeuilleAuNoeud(lNoeudOnglet,lID,lLibelleCommentaire,lClasseFeuille) ;}}
if(this.donnees.piedDePage.avecInvestissement){lID=this.Nom+'_Investissement_';lNoeudOnglet=lObjArborescent.ajouterUnNoeudAuNoeud(lRacine,lID,GTraductions.getValeur('ficheScolaire.Investissement'),lClasseNoeud,false);if(this.donnees.piedDePage.investissement.infosLivret.commentaire){lLibelleCommentaire=this.donnees.piedDePage.investissement.infosLivret.commentaire;lObjArborescent.ajouterUneFeuilleAuNoeud(lNoeudOnglet,lID,lLibelleCommentaire,lClasseFeuille) ;}}}}
$('#'+lObjArborescent.Nom.escapeJQ()).replaceWith(lObjArborescent.ConstruireAffichage(lHeight));lObjArborescent.SetDonnees(lRacine);};InterfaceLivretScolaire.prototype._construireFeuillesPeriode=function(aElmEleve,aElmClasse,aObjArborescent,aNoeudPeriode,aID,aClasseNoeud,aClasseFeuille){var lRang=this._getClassementEleve(aElmEleve,aElmClasse);var lLibelleMoyenneEleve,lLibelleMoyenneClasse,lLibelleInf8,lLibelleDe8a12,lLibelleSup12;var lNoeudRepartition;if(lRang>0)
aObjArborescent.ajouterUneFeuilleAuNoeud(aNoeudPeriode,aID+'_rang',GTraductions.getValeur('ficheScolaire.titreColRang')+' : '+lRang+'/'+aElmClasse.rangTotal,aClasseFeuille);lLibelleMoyenneEleve=aElmEleve.moyEleve.getNote();if(lLibelleMoyenneEleve==="")
lLibelleMoyenneEleve=GTraductions.getValeur('ficheScolaire.Accessible.pasevalue');lLibelleMoyenneEleve=GTraductions.getValeur('ficheScolaire.titreColMoyEleve')+' : '+lLibelleMoyenneEleve;lLibelleMoyenneClasse=aElmClasse.moyClasse.getNote();if(lLibelleMoyenneClasse==="")
lLibelleMoyenneClasse=GTraductions.getValeur('ficheScolaire.Accessible.pasevalue');lLibelleMoyenneClasse=GTraductions.getValeur('ficheScolaire.titreColMoyClasse')+' : '+lLibelleMoyenneClasse;aObjArborescent.ajouterUneFeuilleAuNoeud(aNoeudPeriode,aID+'_MoyEleve',lLibelleMoyenneEleve,aClasseFeuille);aObjArborescent.ajouterUneFeuilleAuNoeud(aNoeudPeriode,aID+'_MoyClasse',lLibelleMoyenneClasse,aClasseFeuille);lNoeudRepartition=aObjArborescent.ajouterUnNoeudAuNoeud(aNoeudPeriode,aID+'_Repartition',GTraductions.getValeur('ficheScolaire.Accessible.RepartitionDesNotesDansLaClasse'),aClasseNoeud,false);if(aElmClasse.inf8){lLibelleInf8=GTraductions.getValeur('ficheScolaire.Accessible.inf8')+' : '+aElmClasse.inf8+' %';aObjArborescent.ajouterUneFeuilleAuNoeud(lNoeudRepartition,aID+'_Inf8',lLibelleInf8,aClasseFeuille);}
if(aElmClasse.de8a12){lLibelleDe8a12=GTraductions.getValeur('ficheScolaire.Accessible.de8a12')+' : '+aElmClasse.de8a12+' %';aObjArborescent.ajouterUneFeuilleAuNoeud(lNoeudRepartition,aID+'_de8a12',lLibelleDe8a12,aClasseFeuille);}
if(aElmClasse.sup12){lLibelleSup12=GTraductions.getValeur('ficheScolaire.Accessible.sup12')+' : '+aElmClasse.sup12+' %';aObjArborescent.ajouterUneFeuilleAuNoeud(lNoeudRepartition,aID+'_sup12',lLibelleSup12,aClasseFeuille);}};InterfaceLivretScolaire.prototype._getClassementEleve=function(aElmEleve,aElmClasse){var lMoyEleve=aElmEleve.moyEleve?aElmEleve.moyEleve:0;if(!aElmClasse||!aElmClasse.tabMoyennes) return 0;var lTabMoyenne=aElmClasse.tabMoyennes;if(!lMoyEleve||!lMoyEleve.estUneValeur()) return 0;var lRang=1;for(var i=0;i<lTabMoyenne.length;i++){if((lTabMoyenne[i].estUneValeur())&&(lTabMoyenne[i].getValeur()>lMoyEleve.getValeur()))
lRang+=1;}
return lRang;};InterfaceLivretScolaire.prototype._construireRepartition=function(aObjArborescent,aNoeudRepartition,aClasseFeuille){var lObjPied=this.donnees.piedDePage.avisCE;var i,lAvis,lValeur,lLibelleRepartition,lID,lNbAvisNonRemplis=lObjPied.nbElevesTotal;for(i=0;i<lObjPied.listeAvis.GetNbrElements();i++){lAvis=lObjPied.listeAvis.GetElement(i);lNbAvisNonRemplis-=lAvis.nbEleves;lValeur=Math.round(lAvis.nbEleves*10000/lObjPied.nbElevesTotal)/100;lLibelleRepartition=lValeur.toFixed(2)+' %'+' : '+lAvis.GetLibelle();lID=this.Nom+'_Repartition_'+i;aObjArborescent.ajouterUneFeuilleAuNoeud(aNoeudRepartition,lID,lLibelleRepartition,aClasseFeuille) ;}
lValeur=Math.round(lNbAvisNonRemplis*10000/lObjPied.nbElevesTotal)/100;lLibelleRepartition=lValeur.toFixed(2)+' %'+' : '+GTraductions.getValeur('ficheScolaire.AvisNonRempli');lID=this.Nom+'_Repartition_'+'AvisNonRempli';aObjArborescent.ajouterUneFeuilleAuNoeud(aNoeudRepartition,lID,lLibelleRepartition,aClasseFeuille) ;};;
function ObjetRequetePageCahierDeTexte(aPere,aEvenementSurReussite,aEvenementSurEchec){this.inheritedCreate(aPere,aEvenementSurReussite,aEvenementSurEchec);}
IE.Requetes.inscrire('PageCahierDeTexte',ObjetRequetePageCahierDeTexte,_ObjetRequeteXmlConsultationPN);ObjetRequetePageCahierDeTexte.prototype.lancerRequete=function(aDomaine,aRessource,aAvecCouleurs){this.avecCouleurs=aAvecCouleurs;var lXml=this.XML;if(aRessource) lXml.CreerElement(null,'Ressource' ,aRessource);if(aDomaine) lXml.CreerVariable(null,'Domaine' ,EGenreType.Domaine,aDomaine);this.appelAsynchroneConsultation();};ObjetRequetePageCahierDeTexte.prototype.actionApresRequete=function(aXml){var lListeTravailAFaire=new ObjetDeserialiser().listeTravailAFaire(aXml,this.avecCouleurs);var lListeCahierDeTextes=new ObjetDeserialiser().listeCahierDeTextes(aXml,this.avecCouleurs);var lSemaine=aXml.GetVariable(null,'Semaine');this.callbackReussite.appel(lListeTravailAFaire,lListeCahierDeTextes,lSemaine,this.JSONReponse.listeDS,this.JSONReponse.listeMatieres);};;
var EGenreTri={ParDatePourLe:0,ParMatiere:1};MethodesObjet.heritagePrototype(_ObjetAffichagePageCahierDeTexte,ObjetInterfacePage);function _ObjetAffichagePageCahierDeTexte(ANom,AIdent,APere,AEvenement){this.inheritedCreate(ANom,AIdent,APere,AEvenement);this.ModeAffichage=EGenreAffichageCahierDeTextes.TravailAFaire;this.TypeTri=EGenreTri.ParDatePourLe;this.avecInfoDevoirPersonalise=MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Parent,EGenreEspace.Eleve]);this.utilitaireCDT=new ObjetUtilitaireCahierDeTexte(GTraductions.getValeur('CahierDeTexte'));}
_ObjetAffichagePageCahierDeTexte.prototype.ConstruireInstances=function(){};_ObjetAffichagePageCahierDeTexte.prototype.initialiserCDTpourImpression=function(aObjet){aObjet.SetParametres(true,true);aObjet.SetVisible(false);};_ObjetAffichagePageCahierDeTexte.prototype.initialiserGrilleCalendrier=function(aInstance){TUtilitaireCDT.initGrilleCalendrier(aInstance);};_ObjetAffichagePageCahierDeTexte.prototype.InitialiserCalendrier=function(aObjet){aObjet.SetParametres(GParametres.PremierLundi,GParametres.DerniereDate,this.avecMultiSelectionSemaine,GParametres.conserverNumerosCalendaires);};_ObjetAffichagePageCahierDeTexte.prototype.InitialiserComboMatieres=function(aObjet){aObjet.SetParametres(true);aObjet.setOptions_ObjetSaisie({labelWAIZone:GTraductions.getValeur('Message')[EGenreMessage.SelectionMatiere],roleWAIEdit:EGenreRole.Option});};_ObjetAffichagePageCahierDeTexte.prototype.initialiserFicheCdt=function(aObjet){aObjet.setTraductions(GTraductions.getValeur('CahierDeTexte'));};_ObjetAffichagePageCahierDeTexte.prototype.initialiserBoutonDeployer=function(aInstance){aInstance.SetParametres('Image_Bandeau_Deployer',true,false,true,[GTraductions.getValeur('CahierDeTexte.pasdeployer'),GTraductions.getValeur('CahierDeTexte.deployer'),'']);};_ObjetAffichagePageCahierDeTexte.prototype.evenementSurDernierMenuDeroulant=function(aLigneClasse,aLigneMatiere){this._donneesMenusDeroulantsRecues=true;this.afficherBandeau(true);GHtml.setDisplay(this.GetInstance(this.IdentCalendrier).GetNom(),true);if(GApplication.droits.get(IEEnum.droits.cours.domaineConsultationEDT).GetIntersection(GEtatUtilisateur.GetDomaineSelectionne()).EstVide()){var lDomaine=new TypeDomaine();lDomaine.SetValeur(true,GApplication.droits.get(IEEnum.droits.cours.domaineConsultationEDT).GetPremierePosition());GEtatUtilisateur.SetDomaineSelectionne(lDomaine);}
if(this.avecMultiSelectionSemaine)
this.GetInstance(this.IdentCalendrier).SetDomaine(GEtatUtilisateur.GetDomaineSelectionne());else this.GetInstance(this.IdentCalendrier).SetSelection(GEtatUtilisateur.GetSemaineSelectionnee());this.surResizeInterface();};_ObjetAffichagePageCahierDeTexte.prototype.evenementSurCalendrier=function(aSelection,aDomaine,aBidon,aEstDansPeriodeConsultation,aIsToucheSelection){if(aIsToucheSelection){this.Instances[this.IdentCahierDeTexte].FocusSurPremierElement();} else{GEtatUtilisateur.SetDomaineSelectionne(aDomaine);this.actualiserPage();}};_ObjetAffichagePageCahierDeTexte.prototype.actualiserPage=function(){new ObjetRequetePageCahierDeTexte(this,this.ActionSurEvenementSurCalendrier).lancerRequete(GEtatUtilisateur.GetDomaineSelectionne(),GEtatUtilisateur.Navigation.GetRessource(EGenreRessource.Classe),true);};_ObjetAffichagePageCahierDeTexte.prototype.evenementSurGrille=function(aID,aMatiere,aEvenementClavier){if(this.GetInstance(this.IdentFicheCdt))
this.GetInstance(this.IdentFicheCdt).Fermer(false);var lListeDonnees,lCahierDeTextes;if(GEtatUtilisateur.getGenreOnglet()===EGenreOnglet.CDT_TAF){lListeDonnees=this.ListeTravailAFaire;lCahierDeTextes=null;} else{lListeDonnees=this.ListeCahierDeTextes;lCahierDeTextes=lListeDonnees.GetElementParNumero(aMatiere.ressources.GetNumero(0));}
this._objGestionFocus_apresFiche={id:aID,evenementClavier:aEvenementClavier};this.GetInstance(this.IdentFicheCdt).SetDonnees(aID,aMatiere,lListeDonnees,null,lCahierDeTextes);};_ObjetAffichagePageCahierDeTexte.prototype.evenementFiche=function(){this._gestionFocus_apresFicheCDT();};_ObjetAffichagePageCahierDeTexte.prototype.Actualiser=function(aTypeTri){this._actualiser(aTypeTri);};_ObjetAffichagePageCahierDeTexte.prototype._actualiser=function(aTypeTri){this.ModeAffichage=GEtatUtilisateur.getGenreOnglet()===EGenreOnglet.CDT_TAF?EGenreAffichageCahierDeTextes.TravailAFaire:EGenreAffichageCahierDeTextes.ContenuDeCours;if(this.GetInstance(this.IdentFicheCdt))
this.GetInstance(this.IdentFicheCdt).Fermer();if((aTypeTri!==null&&aTypeTri!==undefined))
this.TypeTri=aTypeTri;};_ObjetAffichagePageCahierDeTexte.prototype.ExistePourMatiere=function(aNumeroMatiere){var lNumeroMatiere=aNumeroMatiere===null||aNumeroMatiere===undefined?GEtatUtilisateur.Navigation.GetNumeroRessource(EGenreRessource.Matiere):aNumeroMatiere;var lListe=this.ModeAffichage===EGenreAffichageCahierDeTextes.TravailAFaire?this.ListeTravailAFaire:this.ListeCahierDeTextes;for(var I=0;lListe&&(I<lListe.GetNbrElements());I++)
if(!lNumeroMatiere||(lNumeroMatiere===lListe.GetElement(I).Matiere.Numero))
return true;return false;};_ObjetAffichagePageCahierDeTexte.prototype.ActionSurEvenementSurCalendrier=function(aListeTravailAFaire,aListeCahierDeTextes,aSemaine,aListeDS){this.ListeTravailAFaire=aListeTravailAFaire;this.ListeCahierDeTextes=aListeCahierDeTextes;this.listeDS=aListeDS;this.GetInstance(this.IdentCalendrier).setFrequences(GParametres.frequences,true);this.GetInstance(this.IdentCalendrier).SetDomaineInformation(aSemaine,EGenreDomaineInformation.AvecContenu);this.GetInstance(this.IdentCalendrier).SetPeriodeDeConsultation(GApplication.droits.get(IEEnum.droits.cours.domaineConsultationEDT));this.GetInstance(this.IdentCahierDeTexte).SetDonnees(this.ListeTravailAFaire,this.ListeCahierDeTextes);var lTypeTri=!GEtatUtilisateur.Navigation.GetNumeroRessource(EGenreRessource.Matiere)?EGenreTri.ParDatePourLe:EGenreTri.ParMatiere;this.Actualiser(lTypeTri);};_ObjetAffichagePageCahierDeTexte.prototype.GetPageImpression=function(){var lTitre=this.GetInstance(this.IdentBandeau)?this.GetInstance(this.IdentBandeau).Libelle:'';return{titre1:lTitre,contenu:this.GetInstance(this.IdentCahierDeTexte).ComposePage(true)};};_ObjetAffichagePageCahierDeTexte.prototype.formatDonnees=function(){return this.utilitaireCDT.formatDonnees({modeAffichage:this.ModeAffichage,listeCDT:this.ListeCahierDeTextes,listeTAF:this.ListeTravailAFaire,listeDS:this.listeDS,avecDS:false,avecTAF:true,avecInfoDevoirPersonalise:this.avecInfoDevoirPersonalise,nom:this.Nom});};_ObjetAffichagePageCahierDeTexte.prototype.surExecutionQCM=function(aEvent,aNumeroElement){aEvent.stopImmediatePropagation();var lElement=this.ListeTravailAFaire.GetElementParNumero(aNumeroElement);this.evenementFiche({executionQCM:lElement.executionQCM});};_ObjetAffichagePageCahierDeTexte.prototype._gestionFocus_apresFicheCDT=function(aGenreEvenement){if(!this._objGestionFocus_apresFiche||!this._objGestionFocus_apresFiche.evenementClavier)
this.GetInstance(this.IdentCahierDeTexte).resetElement();if(this._objGestionFocus_apresFiche&&this._objGestionFocus_apresFiche.id)
GHtml.setFocus(this._objGestionFocus_apresFiche.id);this._objGestionFocus_apresFiche=null;};;

MethodesObjet.heritagePrototype(ObjetCahierDeTexte,Identite);function ObjetCahierDeTexte(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.afficheTitre=true;this.afficheTitresContenuEtTAF=false;this.ajouterEvenementGlobal(EEvent.SurPreResize ,this.SurPreResize);this.ajouterEvenementGlobal(EEvent.SurPostResize,this.SurPostResize);this.utilitaireCDT=new ObjetUtilitaireCahierDeTexte(GTraductions.getValeur('CahierDeTexte'));this.options={callbackContextMenuCDT:null};}
ObjetCahierDeTexte.prototype.SurPreResize=function(){this.Afficher('&nbsp;');};ObjetCahierDeTexte.prototype.SurPostResize=function(){this.Afficher();this.RecupererDonnees();$('#'+this.IdPremierElement.escapeJQ()).jScrollPane({showArrows:true});};ObjetCahierDeTexte.prototype.SetDonnees=function(aListeTravailAFaire,aListeCahierDeTextes){this.ListeTravailAFaire=aListeTravailAFaire;this.ListeCahierDeTextes=aListeCahierDeTextes;this.DonneesRecues=true;};ObjetCahierDeTexte.prototype.SetParametres=function(aAfficheTitre,aAfficheTitreContenuEtTAF){this.afficheTitre=(aAfficheTitre===null||aAfficheTitre===undefined)?true:aAfficheTitre;this.afficheTitresContenuEtTAF=(aAfficheTitreContenuEtTAF===null||aAfficheTitreContenuEtTAF===undefined)?false:aAfficheTitreContenuEtTAF;};ObjetCahierDeTexte.prototype.setOptions_CDT=function(aOptions){$.extend(this.options,aOptions);};ObjetCahierDeTexte.prototype.Actualiser=function(aModeAffichage,aGenreTri,aNumeroMatiere){this.DonneesActualisees=true;this.ModeAffichage=aModeAffichage;this.TypeTri=aGenreTri;this.NumeroMatiereSelectionne=aNumeroMatiere;if((this.TypeTri!==null&&this.TypeTri!==undefined)){var LListe=(this.ModeAffichage===EGenreAffichageCahierDeTextes.TravailAFaire?this.ListeTravailAFaire:this.ListeCahierDeTextes);var N=LListe===null||LListe===undefined?0:LListe.GetNbrElements();for(var I=0;I<N;I++){var LEltTravailAFaire=LListe.GetElement(I);LEltTravailAFaire.ResetTri();if(this.ModeAffichage===EGenreAffichageCahierDeTextes.TravailAFaire){if(this.TypeTri===EGenreTri.ParDatePourLe){LEltTravailAFaire.AddTri(LEltTravailAFaire.PourLe,EGenreType.Date);LEltTravailAFaire.AddTri(LEltTravailAFaire.Matiere.Libelle);}
else{LEltTravailAFaire.AddTri(LEltTravailAFaire.Matiere.Numero===this.NumeroMatiereSelectionne);LEltTravailAFaire.AddTri(LEltTravailAFaire.Matiere.Libelle);LEltTravailAFaire.AddTri(LEltTravailAFaire.PourLe,EGenreType.Date);}
LEltTravailAFaire.AddTri(LEltTravailAFaire.DonneLe,EGenreType.Date);LEltTravailAFaire.AddTri(LEltTravailAFaire.Genre);}
else{if(this.TypeTri===EGenreTri.ParMatiere)
LEltTravailAFaire.AddTri(LEltTravailAFaire.Matiere.Numero===this.NumeroMatiereSelectionne);LEltTravailAFaire.AddTri(LEltTravailAFaire.Date,EGenreType.Date);var lNrTAF=LEltTravailAFaire.ListeTravailAFaire===null||LEltTravailAFaire.ListeTravailAFaire===undefined?0:LEltTravailAFaire.ListeTravailAFaire.GetNbrElements();if(lNrTAF>0){for(var j=0;j<lNrTAF;j++){var lEltTAF=LEltTravailAFaire.ListeTravailAFaire.GetElement(j);lEltTAF.AddTri(lEltTAF.PourLe,EGenreType.Date);lEltTAF.AddTri(lEltTAF.Genre);lEltTAF.AddTri(lEltTAF.Numero);}
LEltTravailAFaire.ListeTravailAFaire.Trier();}}
LEltTravailAFaire.AddTri(LEltTravailAFaire.Numero);}
if(N>0) LListe.Trier();}
this.Afficher();this.RecupererDonnees();$('#'+this.IdPremierElement.escapeJQ()).jScrollPane({showArrows:true});};ObjetCahierDeTexte.prototype.ConstruireAffichage=function(){if(this.DonneesRecues&&this.DonneesActualisees){return this.ComposePage();}
else return'';};ObjetCahierDeTexte.prototype.RecupererDonnees=function(){if(this.options.callbackContextMenuCDT){$('[id^="'+(this.Nom+'_ind_').escapeJQ()+'"]').on('contextmenu',{instance:this},function(event){var lIndice=GHtml.extraireNombreDId(this.id),lInstance=event.data.instance,lElement=lInstance.ListeCahierDeTextes.GetElement(lIndice);lInstance.options.callbackContextMenuCDT(event,lElement);});}};ObjetCahierDeTexte.prototype.ComposePage=function(aPourImpression){var lHtml=[];this.DonneePrincipaleCourante='';this.DonneeSecondaireCourante='';this.DonneLeCourant='';this.PourImpression=(aPourImpression?aPourImpression:false);this.PremierID=[];this.PremierPrincipaleElement='';this.IDSecondairPrecedent='';this.IDPrincipalPrecedent='';this.NumeroPrincipal=0;var lTabIndex=aPourImpression?'tabIndex="-1"':'tabIndex="0"';var lStyle=aPourImpression?'':' style="border:0px solid black; width:100%;height:'+(GPosition.getHeight(this.Nom)-10)+'px;"';this.IdPremierElement=this.Nom+'_Contenu_cdt';lHtml.push('<div id="',this.IdPremierElement,'"',lTabIndex,' onkeyup="',this.Nom,'.SurPremierPrincipaleElement ()" ',lStyle,'>');if(this.afficheTitre)
lHtml.push(GObjetWAI.composeSpan(this.TypeTri===EGenreTri.ParDatePourLe?GTraductions.getValeur('CahierDeTexte.wai.SelectJour')+', ':GTraductions.getValeur('CahierDeTexte.wai.SelectMatiere')+', '),GObjetWAI.composeSpan(EGenreObjet.NavigationVertical),GObjetWAI.composeSpan(this.TypeTri===EGenreTri.ParDatePourLe?GTraductions.getValeur('CahierDeTexte.wai.DetailsMatiereDuJour')+' ':GTraductions.getValeur('CahierDeTexte.wai.DetailsJourDeLaMatiere')+' '));lHtml.push(GObjetWAI.composeSpan(this.TypeTri===EGenreTri.ParDatePourLe?GTraductions.getValeur('CahierDeTexte.wai.NavigationMatiere')+', ':GTraductions.getValeur('CahierDeTexte.wai.NavigationJour')+', '),GObjetWAI.composeSpan(EGenreObjet.NavigationVertical));if(this.afficheTitre)
lHtml.push(GObjetWAI.composeSpan(this.TypeTri===EGenreTri.ParDatePourLe?GTraductions.getValeur('CahierDeTexte.wai.NavigationMatiereRetour')+' ':GTraductions.getValeur('CahierDeTexte.wai.NavigationJourRetour')+' '));lHtml.push('<table bgcolor="white" class="Texte10" width="100%" border="0" cellpadding="0" cellspacing="0">');var lListe=(this.ModeAffichage===EGenreAffichageCahierDeTextes.TravailAFaire?this.ListeTravailAFaire:this.ListeCahierDeTextes);var lNbrElements=lListe.GetNbrElements();for(var I=0;I<lNbrElements;I++){var lTravailAFaire=lListe.GetElement(I);if(this.VerifieConditionAffichageElement(lTravailAFaire)){this.ValeurPrincipaleElementCourant=(this.TypeTri===EGenreTri.ParDatePourLe?(this.ModeAffichage===EGenreAffichageCahierDeTextes.TravailAFaire?lTravailAFaire.PourLe:new Date(lTravailAFaire.Date.getFullYear(),lTravailAFaire.Date.getMonth(),lTravailAFaire.Date.getDate())):lTravailAFaire.Matiere.Libelle);this.TitrePrincipaleElementCourant=(this.TypeTri===EGenreTri.ParDatePourLe?' ':GTraductions.getValeur('Matiere')+' : ');this.ValeurSecondaireElementCourant=(this.TypeTri===EGenreTri.ParDatePourLe?(this.ModeAffichage===EGenreAffichageCahierDeTextes.TravailAFaire?lTravailAFaire.Matiere.Libelle:lTravailAFaire.Date):(this.ModeAffichage===EGenreAffichageCahierDeTextes.TravailAFaire?lTravailAFaire.PourLe:lTravailAFaire.Date));this.TitreSecondaireElementCourant=(this.TypeTri===EGenreTri.ParDatePourLe?GTraductions.getValeur('Matiere')+' : ':' ');if(this.VerifieConditionNouvelleDonneePrincipale(this.DonneePrincipaleCourante,this.ValeurPrincipaleElementCourant))
lHtml.push(this.ComposeNouvelleDonneePrincipale(lTravailAFaire,lListe,aPourImpression));if(this.VerifieConditionNouvelleDonneeSecondaire(this.DonneeSecondaireCourante,this.ValeurSecondaireElementCourant)){if((this.ModeAffichage===EGenreAffichageCahierDeTextes.TravailAFaire)&&(this.DonneLeCourant!==''))
lHtml.push(this.ComposeFermetureGenre());lHtml.push(this.ComposeNouvelleDonneeSecondaire(lTravailAFaire,I,aPourImpression));lHtml.push(this.ModeAffichage===EGenreAffichageCahierDeTextes.TravailAFaire?this.ComposeDevoirsDonneLe(lTravailAFaire):this.ComposeContenu(lTravailAFaire));}
else lHtml.push(this.ModeAffichage===EGenreAffichageCahierDeTextes.TravailAFaire?this.ComposeDevoirSelonDonneLe(lTravailAFaire):this.ComposeContenu(lTravailAFaire));}}
lHtml.push(this.ComposeFermeture());lHtml.push('</table>');lHtml.push('</div>');return lHtml.join('');};ObjetCahierDeTexte.prototype.VerifieConditionNouvelleDonneePrincipale=function(aDonneePrincipaleCourante,aValeurPrincipaleElementCourant){if(this.TypeTri===EGenreTri.ParDatePourLe){if(!GDate.estDateEgale(aDonneePrincipaleCourante,aValeurPrincipaleElementCourant))
return true;else return false;}
else{if(aDonneePrincipaleCourante!==aValeurPrincipaleElementCourant)
return true;else return false;}};ObjetCahierDeTexte.prototype.VerifieConditionNouvelleDonneeSecondaire=function(aDonneeSecondaireCourante,aValeurSecondaireElementCourant){if(this.TypeTri===EGenreTri.ParDatePourLe){if(aDonneeSecondaireCourante!==aValeurSecondaireElementCourant)
return true;else return false;}
else{if(!GDate.estDateEgale(aDonneeSecondaireCourante,aValeurSecondaireElementCourant))
return true;else return false;}};ObjetCahierDeTexte.prototype.VerifieConditionAffichageElement=function(aObjetTravailAFaire){if(this.TypeTri===EGenreTri.ParDatePourLe)
return true;else{if(aObjetTravailAFaire.Matiere.Numero===this.NumeroMatiereSelectionne)
return true;else return false;}};ObjetCahierDeTexte.prototype.ComposeNouvelleDonneePrincipale=function(aObjetTravailAFaire,aListeDonnees,aPourImpression){var lHtml=[];if(this.ModeAffichage===EGenreAffichageCahierDeTextes.TravailAFaire){if(this.DonneLeCourant!==''){lHtml.push(this.ComposeFermetureGenre());lHtml.push(this.ComposeFermetureTitreSecondaire());}}
else if(this.DonneePrincipaleCourante!=='')
lHtml.push(this.ComposeFermetureTitreSecondaire());lHtml.push(this.ComposeTitrePrincipal(aObjetTravailAFaire,aListeDonnees,aPourImpression));this.DonneeSecondaireCourante='';this.DonneLeCourant='';return lHtml.join('');};ObjetCahierDeTexte.prototype.ComposeNouvelleDonneeSecondaire=function(aObjetTravailAFaire,aIndice,aPourImpression){var lHtml=[];if(this.DonneeSecondaireCourante!=='')
lHtml.push(this.ComposeFermetureTitreSecondaire());lHtml.push(this.ComposeTitreSecondaire(aObjetTravailAFaire,aIndice,aPourImpression));return lHtml.join('');};ObjetCahierDeTexte.prototype.ComposeTitrePrincipal=function(aObjetTravailAFaire,aListeDonnees,aPourImpression){var lHtml=[];var lStyle=GStyle.composeCouleur(GCouleur.bandeau.fond,GCouleur.bandeau.texte);this.DonneePrincipaleCourante=(this.TypeTri===EGenreTri.ParDatePourLe?(this.ValeurPrincipaleElementCourant):(aObjetTravailAFaire.Matiere.Libelle));var lLibelle=(this.TypeTri===EGenreTri.ParDatePourLe?GDate.FormatDate((this.DonneePrincipaleCourante),(this.ModeAffichage===EGenreAffichageCahierDeTextes.TravailAFaire?GTraductions.getValeur('CahierDeTexte.pourLe')+' ':'')+'%JJJJ %JJ %MMMM %AAAA'):(GChaine.Insecable(this.DonneePrincipaleCourante)));this.IdPrincipaleElement=this.Nom+'_Nav_'+this.NumeroPrincipal;if(this.PremierPrincipaleElement==='')
this.PremierPrincipaleElement=this.IdPrincipaleElement;if(this.IDSecondairPrecedent!=='')
this.AjouterAuTableaux(this.IDSecondairPrecedent,this.IdPrincipaleElement,null,EGenreDirection.SensNormal);if(this.IDPrincipalPrecedent!=='')
this.AjouterAuTableaux(this.IDPrincipalPrecedent,this.IdPrincipaleElement,null,EGenreDirection.DeuxSenses);this.IDPrincipalPrecedent=this.IdPrincipaleElement;this.NumeroPrincipal++;this.NumeroSecondair=0;this.IDSecondairPrecedent='';if(this.afficheTitre){lHtml.push('<tr><td><table width="100%" border="0" cellpadding="0" cellspacing="5"><tr><td class="Bandeau" style="',lStyle,'">','<div id="',this.IdPrincipaleElement,'" tabIndex="0" class="BordureNavigationInactive" onkeyup="',this.Nom,'.SurPremierSecondaire (id); if (GNavigateur.IsToucheFleche () || GNavigateur.IsToucheSelection ()) GNavigateur.StopperEvenement (event);" onblur="',this.Nom,'.ActiverBordureNavigation (id, false);" onfocus="',this.Nom,'.ActiverBordureNavigation (id, true);">',GObjetWAI.composeSpan(this.TitrePrincipaleElementCourant),this.composeLibelleTitrePrincipal(aListeDonnees,lLibelle,aPourImpression),'</div>','</td></tr></table></td></tr>');}
return lHtml.join('');};ObjetCahierDeTexte.prototype.composeLibelleTitrePrincipal=function(aListeDonnees,aLibelle,aPourImpression){return aLibelle;};ObjetCahierDeTexte.prototype.ComposeTitreSecondaire=function(aObjetTravailAFaire,aIndice,aPourImpression){var lHtml=[];this.DonneeSecondaireCourante=(this.TypeTri===EGenreTri.ParDatePourLe?(this.ModeAffichage===EGenreAffichageCahierDeTextes.TravailAFaire?aObjetTravailAFaire.Matiere.Libelle:GDate.FormatDate(aObjetTravailAFaire.Date,'%hhh%mm - ')+aObjetTravailAFaire.Matiere.Libelle):(this.ModeAffichage===EGenreAffichageCahierDeTextes.TravailAFaire?aObjetTravailAFaire.PourLe:GDate.FormatDate(aObjetTravailAFaire.Date,'%JJJJ %JJ %MMMM - %hhh%mm ')));var lID=this.IdPrincipaleElement+'_'+this.NumeroSecondair;if(this.NumeroSecondair===0){this.PremierID[this.IdPrincipaleElement]=lID;this.AjouterAuTableaux(this.IdPrincipaleElement,lID,EGenreDirection.SensNormal);this.AjouterAuTableaux(this.IdPrincipaleElement,lID,null,EGenreDirection.SensInverse);}
if(this.IDSecondairPrecedent!=='')
this.AjouterAuTableaux(this.IDSecondairPrecedent,lID,null,EGenreDirection.DeuxSenses);this.AjouterAuTableaux(this.IdPrincipaleElement,lID,EGenreDirection.SensInverse);this.IDSecondairPrecedent=lID;this.NumeroSecondair++;var lLibelle=GChaine.Insecable((this.TypeTri===EGenreTri.ParDatePourLe?this.DonneeSecondaireCourante:(this.ModeAffichage===EGenreAffichageCahierDeTextes.TravailAFaire?GDate.FormatDate(this.DonneeSecondaireCourante,GTraductions.getValeur('CahierDeTexte.pourLe')+' %JJJJ %JJ %MMMM %AAAA'):this.DonneeSecondaireCourante)));var lClasseSelectionnee=GEtatUtilisateur.Navigation.GetRessource(EGenreRessource.Classe);if(!lClasseSelectionnee&&GEtatUtilisateur.getMembre())
lClasseSelectionnee=GEtatUtilisateur.getMembre().Classe;if(aObjetTravailAFaire.groupe&&aObjetTravailAFaire.groupe.existeNumero()&&(lClasseSelectionnee.GetNumero()!==aObjetTravailAFaire.groupe.GetNumero()))
lLibelle+=' ('+aObjetTravailAFaire.groupe.GetLibelle()+')';lHtml.push('<tr><td>','<div id="',lID,'" tabIndex="-1" class="BordureNavigationInactive" onkeyup="',this.Nom,'.NavigationClavier (id); if (GNavigateur.IsToucheFleche () || GNavigateur.IsToucheSelection ()) GNavigateur.StopperEvenement (event);" onblur="',this.Nom,'.ActiverBordureNavigation (id, false);" onfocus="',this.Nom,'.ActiverBordureNavigation (id, true);">',GObjetWAI.composeSpan(this.TitreSecondaireElementCourant),'<table  id="'+(this.Nom+'_ind_'+aIndice)+'" class="Texte10" width="100%" border="0" cellpadding="0" cellspacing="5">','<tr class="Gras" ><td colspan="2">','<div style="width:100%;border-bottom:1px solid black; position:relative;">',lLibelle,this.composeVisas(aObjetTravailAFaire,aIndice,aPourImpression),'<div style="clear: both" />','</div>','</td></tr>');lHtml.push(GObjetWAI.composeSpan('. '));return lHtml.join('');};ObjetCahierDeTexte.prototype.composeVisas=function(aObjetTravailAFaire,aIndice,aPourImpression){var lHtml=[];if(aObjetTravailAFaire.dateVisaI){lHtml.push('<div style="float:right" class="Image_VisaInspecteur EspaceDroit PetitEspaceBas" ie-hint="',aObjetTravailAFaire.individuVisaI?GChaine.Format(GTraductions.getValeur('CahierDeTexte.HintVisa'),[GDate.FormatDate(aObjetTravailAFaire.dateVisaI,'%JJ/%MM/%AAAA'),aObjetTravailAFaire.individuVisaI]):GChaine.Format(GTraductions.getValeur('CahierDeTexte.HintVisaSansI'),[GDate.FormatDate(aObjetTravailAFaire.dateVisaI,'%JJ/%MM/%AAAA')]),'"></div>');}
if(aObjetTravailAFaire.dateVisa){lHtml.push('<div style="float:right" class="Image_VisaEtablissement EspaceDroit PetitEspaceBas" ie-hint="',aObjetTravailAFaire.individuVisa?GChaine.Format(GTraductions.getValeur('CahierDeTexte.HintVisa'),[GDate.FormatDate(aObjetTravailAFaire.dateVisa,'%JJ/%MM/%AAAA'),aObjetTravailAFaire.individuVisa]):GChaine.Format(GTraductions.getValeur('CahierDeTexte.HintVisaSansI'),[GDate.FormatDate(aObjetTravailAFaire.dateVisa,'%JJ/%MM/%AAAA')]),'"></div>');}
return lHtml.join('');};ObjetCahierDeTexte.prototype.ComposeDevoir=function(aObjetTravailAFaire){var lHtml=[];lHtml.push('<tr><td class="AlignementHaut">',aObjetTravailAFaire.descriptif,'</td>');if(aObjetTravailAFaire.ListePieceJointe.GetNbrElements()>0){lHtml.push('<td width="10px"></td>','<td align="right">',this.ComposePiecesJointes(aObjetTravailAFaire),'</td>');}
lHtml.push('</tr>');return lHtml.join('');};ObjetCahierDeTexte.prototype.ComposeDevoirSelonDonneLe=function(aObjetTravailAFaire){var lDate=aObjetTravailAFaire.DonneLe?aObjetTravailAFaire.DonneLe:aObjetTravailAFaire.PourLe;if(!GDate.estDateEgale(this.DonneLeCourant,lDate)){var lHtml=[];if(this.DonneLeCourant!=='')
lHtml.push(this.ComposeFermetureGenre());this.DonneLeCourant=lDate;lHtml.push(this.ComposeDevoirsDonneLe(aObjetTravailAFaire));return lHtml.join('');}
else{return this.ComposeDevoir(aObjetTravailAFaire);}};ObjetCahierDeTexte.prototype.ComposeDevoirsDonneLe=function(aObjetTravailAFaire){this.DonneLeCourant=aObjetTravailAFaire.DonneLe?aObjetTravailAFaire.DonneLe:aObjetTravailAFaire.PourLe;var lNbJours=aObjetTravailAFaire.DonneLe?GDate.GetDifferenceJours(aObjetTravailAFaire.PourLe,aObjetTravailAFaire.DonneLe):0;var lStrJours=(lNbJours>1?GTraductions.getValeur('CahierDeTexte.jours'):GTraductions.getValeur('CahierDeTexte.jour'));var lLibelleDonneLe=aObjetTravailAFaire.DonneLe?GDate.FormatDate(aObjetTravailAFaire.DonneLe,GTraductions.getValeur('CahierDeTexte.donneLe')+' %JJ/%MM')+' ['+lNbJours+' '+lStrJours+'] : ':GDate.FormatDate(aObjetTravailAFaire.PourLe,GTraductions.getValeur('CahierDeTexte.pourLe')+' %JJ/%MM')+' : ';var lHtml=[];lHtml.push('<tr><td><table class="Texte10" width="100%" border="0" cellpadding="0" cellspacing="0">','<tr><td width="100px" class="AlignementHaut Gras">',GChaine.Insecable(lLibelleDonneLe),'</td>','<td><table class="Texte10" width="100%" border="0" cellpadding="0" cellspacing="0">',this.ComposeDevoir(aObjetTravailAFaire));return lHtml.join('');};ObjetCahierDeTexte.prototype.ComposeContenu=function(aObjetTravailAFaire){var lHtml=[];var lColSpan='';lHtml.push('<tr>','<td><table class="Texte10" width="100%" border="0" cellpadding="0" cellspacing="0">');for(var i=0;i<aObjetTravailAFaire.listeContenus.GetNbrElements();i++){var lContenu=aObjetTravailAFaire.listeContenus.GetElement(i);if(i>0)
lHtml.push('<tr><td class="EspaceGauche EspaceDroit"><hr></td></tr>');lHtml.push('<tr><td class="EspaceGauche EspaceDroit AlignementHaut Gras">',lContenu.categorie.Libelle,(lContenu.categorie.Libelle&&lContenu.Libelle?' - ':''),lContenu.Libelle,'</td></tr>','<tr><td class="EspaceGauche EspaceDroit AlignementHaut">',lContenu.descriptif,'</td></tr>');if(lContenu.ListePieceJointe.GetNbrElements()>0)
lHtml.push('<tr><td class="EspaceGauche EspaceDroit AlignementHaut">',this.ComposePiecesJointes(lContenu),'</td></tr>');if(lContenu.listeExecutionQCM.GetNbrElements()>0)
lHtml.push('<tr><td class="EspaceGauche EspaceDroit AlignementHaut">',this.composeExecutionQCMContenu(aObjetTravailAFaire,lContenu),'</td></tr>');}
if(aObjetTravailAFaire.ListeTravailAFaire.GetNbrElements()>0){aObjetTravailAFaire.ListeTravailAFaire.setTri([ObjetTri.init('Genre'),ObjetTri.init('PourLe')]);aObjetTravailAFaire.ListeTravailAFaire.trier();if(aObjetTravailAFaire.listeContenus.GetNbrElements())
lHtml.push('<tr><td class="EspaceGauche EspaceDroit"><hr></td></tr>');lHtml.push('<tr><td class="EspaceGauche EspaceDroit AlignementHaut"><table class="Texte10" width="100%" border="0" cellpadding="0" cellspacing="0">');for(var j=0;j<aObjetTravailAFaire.ListeTravailAFaire.GetNbrElements();j++){var lEltTAF=aObjetTravailAFaire.ListeTravailAFaire.GetElement(j);var lEstQCM=lEltTAF.executionQCM&&lEltTAF.executionQCM.existeNumero();if(lEstQCM)
lHtml.push(this.utilitaireCDT.getTitreExecutionQCM(aObjetTravailAFaire.GetNumero()+'_'+j,lEltTAF.executionQCM,this.Nom));else lHtml.push(this.ComposeDevoirPourLe(lEltTAF));}
this.DonneLeCourant='';lHtml.push('</table></td></tr>');}
lHtml.push('</table></td>','</tr>');return lHtml.join('');};ObjetCahierDeTexte.prototype.surExecutionQCM=function(aEvent,I){var lPos=I.match(/^([a-z0-9]+)_([0-9]+)$/i);var lExecutionQCM=this.ListeCahierDeTextes.GetElementParNumero(lPos[1]).ListeTravailAFaire.GetElement(lPos[2]).executionQCM;this.callback.appel({executionQCM:lExecutionQCM});};ObjetCahierDeTexte.prototype.ComposeDevoirPourLe=function(aObjetTravailAFaire){var lHtml=[];var lLibelle=GChaine.Insecable((aObjetTravailAFaire.Genre===1?GTraductions.getValeur('CahierDeTexte.TAF_Lecon'):GTraductions.getValeur('CahierDeTexte.TAF_Devoir'))+' '+GTraductions.getValeur('CahierDeTexte.PourLe')+' '+GDate.FormatDate(aObjetTravailAFaire.PourLe,'%JJ/%MM')+' : ');lHtml.push('<tr>','<td class="Texte10 Gras AlignementHaut">',lLibelle,'</td>','<td class="Texte10 AlignementHaut" style="width: 100%">',aObjetTravailAFaire.descriptif,'</td>','</tr>');if(aObjetTravailAFaire.ListePieceJointe.GetNbrElements()>0)
lHtml.push('<tr><td>&nbsp;</td><td class="AlignementHaut">',this.ComposePiecesJointes(aObjetTravailAFaire),'</td></tr>');return lHtml.join('');};ObjetCahierDeTexte.prototype.ComposePiecesJointes=function(aObjetTravailAFaire){var lHtml=[];var lStyle=this.PourImpression?'Gras':'';lHtml.push('<table class="Texte10" border="0" cellpadding="0" cellspacing="0">');var nbPiecesJointes=aObjetTravailAFaire.ListePieceJointe.GetNbrElements();lStyle=this.PourImpression?'style="color : black;"':'';for(var I=0;I<nbPiecesJointes;I++){var lPieceJointe=aObjetTravailAFaire.ListePieceJointe.GetElement(I);lHtml.push('<tr><td>');lHtml.push(this.PourImpression?lPieceJointe.GetLibelle():GChaine.composerURL(lPieceJointe.Url,lPieceJointe.GetLibelle(),lPieceJointe.GetGenre()===EGenreDocumentJoint.Fichier));lHtml.push('</td></tr>');}
lHtml.push('</table>');return lHtml.join('');};ObjetCahierDeTexte.prototype.composeExecutionQCMContenu=function(aObjetTravailAFaire,aObjetContenu){var lHtml=[];var nbExecutionQCM=aObjetContenu.listeExecutionQCM.GetNbrElements();for(var I=0;I<nbExecutionQCM;I++){var lExecutionQCM=aObjetContenu.listeExecutionQCM.GetElement(I);lHtml.push(this.utilitaireCDT.getTitreExecutionQCMContenu(aObjetTravailAFaire.GetNumero()+'_'+aObjetContenu.GetNumero()+'_'+I,lExecutionQCM,this.Nom));}
return lHtml.join('');};ObjetCahierDeTexte.prototype.surExecutionQCMContenu=function(aEvent,I){var lPos=I.match(/^([a-z0-9]+)_([a-z0-9]+)_([0-9]+)$/i);var lExecutionQCM=this.ListeCahierDeTextes.GetElementParNumero(lPos[1]).listeContenus.GetElementParNumero(lPos[2]).listeExecutionQCM.GetElement(lPos[3]);this.callback.appel({executionQCM:lExecutionQCM});};ObjetCahierDeTexte.prototype.ComposeFermetureTitreSecondaire=function(){var lHtml=[];lHtml.push('<tr><td>&nbsp;</td></tr>','</table>','</div>','</td></tr>');return lHtml.join('');};ObjetCahierDeTexte.prototype.ComposeFermetureGenre=function(){var lHtml=[];lHtml.push('</table></td>','</tr>','</table></td></tr>');return lHtml.join('');};ObjetCahierDeTexte.prototype.ComposeFermeture=function(){var lHtml=[];if(this.ModeAffichage===EGenreAffichageCahierDeTextes.TravailAFaire)
lHtml.push(this.ComposeFermetureGenre());lHtml.push(this.ComposeFermetureTitreSecondaire());return lHtml.join('');};ObjetCahierDeTexte.prototype.SurPremierPrincipaleElement=function(){if(GNavigateur.IsToucheFleche()||GNavigateur.IsToucheSelection())
GHtml.setFocus(this.PremierPrincipaleElement);};ObjetCahierDeTexte.prototype.SurPremierSecondaire=function(aID){if(GNavigateur.IsToucheSelection())
GHtml.setFocus(this.PremierID[aID]);if(GNavigateur.IsToucheFleche())
this.NavigationClavier(aID);};;
MethodesObjet.heritagePrototype(ObjetCelluleSemaine,Identite);function ObjetCelluleSemaine(ANom,AIdent,APere,AEvenement){this.inheritedCreate(ANom,AIdent,APere,AEvenement);this.hauteur=15;this.largeur=145;this.largeurBouton=17;this.nombreSemainesSelection=1;this.cycles=IE.Cycles;this.cellule=new ObjetCelluleBouton(this.Nom+'.cellule',null,this,this.surCellule);this.btnPrecedent=new ObjetBoutonBandeau(this.Nom+'.btnPrecedent',null,this,this.surBtnPrecedent);this.btnSuivant=new ObjetBoutonBandeau(this.Nom+'.btnSuivant',null,this,this.surBtnSuivant);this.SetParametres();this.IdPremierElement=this.cellule.getPremierElement();}
ObjetCelluleSemaine.prototype.SetParametres=function(aAvecStyleSite,aNombreSemainesSelection,aInstanceCycle){if(aNombreSemainesSelection)
this.nombreSemainesSelection=aNombreSemainesSelection;if(aInstanceCycle){this.cycles=aInstanceCycle;}
this.cellule.setParametres_PN(true,null,160);this.btnPrecedent.SetParametres('Image_PassageAuPrecedentPourBandeau',true,false,true,new Array('',GTraductions.getValeur('Precedent'),''),20,false,false);this.btnSuivant.SetParametres('Image_PassageAuSuivantPourBandeau',true,false,true,new Array('',GTraductions.getValeur('Suivant'),''),20,false,false);};ObjetCelluleSemaine.prototype.Initialiser=function(){this.inherited('Initialiser');this.cellule.Initialiser();this.btnPrecedent.Initialiser();this.btnSuivant.Initialiser();};ObjetCelluleSemaine.prototype.SetDonnees=function(aDate){this.dateDebut=aDate;this.actualiserDonnees(this.dateDebut);};ObjetCelluleSemaine.prototype.ConstruireAffichage=function(){var H=[];H.push('<div>','<table tabindex="-1" border="0" cellspacing="0" cellpadding="0"><tr>','<td id="'+this.btnPrecedent.GetNom()+'"></td>','<td id="'+this.cellule.GetNom()+'"></td>','<td id="'+this.btnSuivant.GetNom()+'"></td>','</tr></table></div>');return H.join('');};ObjetCelluleSemaine.prototype._getChaineDate=function(){return GTraductions.getValeur('Du')+GDate.FormatDate(this.dateDebut,' %JJ %MMM ')+GTraductions.getValeur('Au')+GDate.FormatDate(this.dateFin,' %JJ %MMM');};ObjetCelluleSemaine.prototype.surCellule=function(aGenreEvent,aEvent){if(!this.Actif) return;switch(aGenreEvent){case EEvent.SurClick:{this._ouvrirFenetreDate();break;}
case EEvent.SurKeyUp:{if(GNavigateur.IsToucheRetourChariot()||GNavigateur.IsToucheFlecheBas())
this._ouvrirFenetreDate();}}};ObjetCelluleSemaine.prototype.surFenetreDate=function(aGenreBouton,aDate){if(aGenreBouton===1&&this.cycles.cycleDeLaDate(this.dateDebut)!==this.cycles.cycleDeLaDate(aDate))
this.actualiserDonnees(aDate);};ObjetCelluleSemaine.prototype.surBtnPrecedent=function(){this.actualiserDonnees(this.dateDebut,-1);};ObjetCelluleSemaine.prototype.surBtnSuivant=function(){this.actualiserDonnees(this.dateDebut,1);};ObjetCelluleSemaine.prototype._getNomFenetreDate=function(){return this.Nom+'.fenetreDate';};ObjetCelluleSemaine.prototype._ouvrirFenetreDate=function(){if(this.fenetreDate)
this._fermerFenetreDate();this.fenetreDate=new ObjetFenetre_Date(this._getNomFenetreDate(),null,this,this.surFenetreDate);this.fenetreDate.setParametres(GParametres.PremierLundi,GParametres.PremiereDate,GParametres.DerniereDate);IE.ZoneFenetre.ajouterFenetre(this.fenetreDate.GetNom(),this.fenetreDate.getZIndex());this.fenetreDate.Initialiser();var lDate=(GDate.dateEstDansLaPeriode(this.dateDebut,GParametres.PremiereDate,GParametres.DerniereDate))?this.dateDebut:GParametres.PremiereDate;this.fenetreDate.SetDonnees(lDate);this.fenetreDate.positionnerSousId(this.Nom);this.callback.appel();};ObjetCelluleSemaine.prototype.DetruireInstances=function(){this._fermerFenetreDate();};ObjetCelluleSemaine.prototype._fermerFenetreDate=function(){if(!this.fenetreDate) return;this.fenetreDate.free();this.fenetreDate=null;};ObjetCelluleSemaine.prototype.actualiserDonnees=function(aDate,aDecalage){var lDomaine=GEtatUtilisateur.GetDomaineSelectionne();if(this.nombreSemainesSelection){var lCycle=this.cycles.cycleDeLaDate(aDate),lCycleDebut=Math.borner(lCycle+(aDecalage||0) ,1,this.cycles.nombreCyclesAnneeScolaire()-this.nombreSemainesSelection+1),lCycleFin=lCycleDebut+this.nombreSemainesSelection-1;this.dateDebut=this.cycles.dateDebutCycle(lCycleDebut);this.dateFin=this.cycles.dateDernierJourOuvreCycle(lCycleFin);this.cellule.setLibelle(this._getChaineDate());lDomaine.Vider();lDomaine.SetValeur(true,lCycleDebut,lCycleFin);this.callback.appel(lDomaine);}
else{;}};;
MethodesObjet.heritagePrototype(ObjetAffichagePageCahierDeTexte,_ObjetAffichagePageCahierDeTexte);function ObjetAffichagePageCahierDeTexte(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.ListeCahierDeTextes=new ObjetListeElements();this.ListeTravailAFaire=new ObjetListeElements();this.typeAffichageGrilleCalendrier=0;}
ObjetAffichagePageCahierDeTexte.prototype.ConstruireInstances=function(){this.inherited('ConstruireInstances');this.IdentCahierDeTexte=this.Add(window.ObjetGrilleCalendrier ,this.evenementSurGrille ,this.initialiserGrilleCalendrier);this.IdentFicheCdt=this.Add(window.ObjetFicheCDT ,this.evenementFiche ,this.initialiserFicheCdt);this.identImpression=this.Add(window.ObjetCahierDeTexte ,null ,this.initialiserCDTpourImpression);this.identCelluleSemaine=this.Add(window.ObjetCelluleSemaine ,this.evenementCelluleSemaine ,this.initialiserCelluleSemaine);this.IdPremierElement=this.GetInstance(this.identCelluleSemaine).getPremierElement();this.identBoutonDeployer=this.Add(window.ObjetBoutonBandeau ,this.evenementSurBoutonDeployer ,this.initialiserBoutonDeployer);this.interfaceFicheVisu=this.Add(window.InterfaceFicheVisuEleveQCM,this.evenementSurVisuEleve,null);};ObjetAffichagePageCahierDeTexte.prototype.SetParametresGeneraux=function(){this.AddSurZone=[this.identCelluleSemaine,this.identBoutonDeployer];this.IdentZoneAlClient=this.IdentCahierDeTexte;};ObjetAffichagePageCahierDeTexte.prototype.RecupererDonnees=function(){this.GetInstance(this.identCelluleSemaine).SetDonnees(GEtatUtilisateur.getDate());if(GEtatUtilisateur.estModeAccessible())
this.GetInstance(this.identBoutonDeployer).SetVisible(false);};ObjetAffichagePageCahierDeTexte.prototype.surExecutionQCM=function(aEvent,aNumeroElement){aEvent.stopImmediatePropagation();var lElement=this.ListeTravailAFaire.GetElementParNumero(aNumeroElement);this.evenementFiche({executionQCM:lElement.executionQCM});};ObjetAffichagePageCahierDeTexte.prototype.surExecutionQCMContenu=function(aEvent,aNumeroElement){aEvent.stopImmediatePropagation();var lPos=aNumeroElement.match(/^([a-z0-9]+)_([a-z0-9]+)_([0-9]+)$/i);var lElement=this.ListeCahierDeTextes.GetElementParNumero(lPos[1]).listeContenus.GetElementParNumero(lPos[2]).listeExecutionQCM.GetElement(lPos[3]);this.evenementFiche({executionQCM:lElement});};ObjetAffichagePageCahierDeTexte.prototype.evenementSurVisuEleve=function(aParam){if(aParam.action==='close'){this.evenementSurCalendrier(null,this.domaine);}};ObjetAffichagePageCahierDeTexte.prototype.initialiserCelluleSemaine=function(aInstance){aInstance.SetParametres(true,2);};ObjetAffichagePageCahierDeTexte.prototype.initialiserFicheCdt=function(aObjet){this.inherited('initialiserFicheCdt',aObjet);aObjet.setAvecInfoDevoirPersonalise(MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Parent,EGenreEspace.Eleve])?true:false);};ObjetAffichagePageCahierDeTexte.prototype.evenementSurCalendrier=function(aSelection,aDomaine,aBidon,aEstDansPeriodeConsultation,aIsToucheSelection){if(aIsToucheSelection){this.Instances[this.IdentCahierDeTexte].FocusSurPremierElement();} else{GEtatUtilisateur.SetDomaineSelectionne(aDomaine);new ObjetRequetePageCahierDeTexte(this,this.ActionSurEvenementSurCalendrier).lancerRequete(aDomaine,null,true);}};ObjetAffichagePageCahierDeTexte.prototype.evenementFiche=function(aParam){if(aParam&&aParam.executionQCM){this.GetInstance(this.interfaceFicheVisu).setParametres(aParam.executionQCM.GetNumero(),GApplication.getDemo()||((GEtatUtilisateur.GenreEspace===EGenreEspace.Parent||GEtatUtilisateur.GenreEspace===EGenreEspace.Entreprise)&&(aParam.executionQCM.etatCloture===undefined||aParam.executionQCM.etatCloture===TypeEtatExecutionQCMPourRepondant.EQR_EnCours)));this.GetInstance(this.interfaceFicheVisu).setDonnees(aParam.executionQCM);}
this._gestionFocus_apresFicheCDT();};ObjetAffichagePageCahierDeTexte.prototype.evenementCelluleSemaine=function(aDomaine,aDateDebut,aDateFin){if(aDomaine){this.domaine=aDomaine;this.evenementSurCalendrier(null,this.domaine);}};ObjetAffichagePageCahierDeTexte.prototype.evenementSurBoutonDeployer=function(){this.GetInstance(this.IdentCahierDeTexte).changeModeAffichage();this.Actualiser();};ObjetAffichagePageCahierDeTexte.prototype.ActionSurEvenementSurCalendrier=function(aListeTravailAFaire,aListeCahierDeTextes,aSemaine,aListeDS){this.ListeTravailAFaire=aListeTravailAFaire;this.ListeCahierDeTextes=aListeCahierDeTextes;this.listeDS=aListeDS;this.Actualiser();};ObjetAffichagePageCahierDeTexte.prototype.Actualiser=function(aTypeTri){this._actualiser(aTypeTri);window.Invocateur.evenement(window.Invocateur.events.activationImpression,EGenreImpression.Aucune);var lDonnees=this.formatDonnees();if(lDonnees&&lDonnees.GetNbrElements())
window.Invocateur.evenement(window.Invocateur.events.activationImpression,EGenreImpression.Normale,this);if(GEtatUtilisateur.estModeAccessible()){this.AfficherListe(lDonnees,this.ModeAffichage);}
else this.GetInstance(this.IdentCahierDeTexte).SetDonnees(IE.Cycles.dateDebutCycle(this.domaine.GetPremierePosition(true)),IE.Cycles.dateFinCycle(this.domaine.GetDernierePosition(true)),lDonnees,true);};ObjetAffichagePageCahierDeTexte.prototype.GetPageImpression=function(){this.GetInstance(this.identImpression).SetDonnees(this.ListeTravailAFaire,this.ListeCahierDeTextes);this.GetInstance(this.identImpression).Actualiser(this.ModeAffichage,EGenreTri.ParDatePourLe);return{contenu:this.GetInstance(this.identImpression).ComposePage(true)};};;
;(function(){ObjetAffichagePageCahierDeTexte.prototype.AfficherListe=function(aDonnees,aModeAffichage){var lIdListe=this.Nom+'_Liste';this._objetListeArborescente=new ObjetListeArborescente(lIdListe,0,this,null);var lRacine=this._objetListeArborescente.construireRacine();this._objetListeArborescente.setParametres(false);var I,lTitre,lNoeudListeElements,lNoeudElement,lDonnee,lHashDate={},lJourDeLaSemaine,lPremierElement=true;var lDateDebSemaine=GDate.FormatDate(IE.Cycles.dateDebutCycle(this.domaine.GetPremierePosition(true)),'%JJJJ %JJ %MMMM');var lDateFinSemaine=GDate.FormatDate(IE.Cycles.dateDernierJourOuvreCycle(this.domaine.GetDernierePosition(true)),'%JJJJ %JJ %MMMM');lTitre=GTraductions.getValeur('Du')+' '+lDateDebSemaine+' '+GTraductions.getValeur('Au')+' '+lDateFinSemaine ;lNoeudListeElements=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lRacine,null,lTitre,'Gras',true,lPremierElement);lPremierElement=false;if(aDonnees.GetNbrElements()>0){for(I=0;I<aDonnees.GetNbrElements();I++){lDonnee=aDonnees.GetElement(I);lJourDeLaSemaine=GDate.GetJourDeSemaine(lDonnee.Date);if(!lHashDate[lJourDeLaSemaine.toString()]){lTitre=GDate.FormatDate(lDonnee.Date,'%JJJJ %JJ %MMMM');lNoeudElement=lHashDate[lJourDeLaSemaine.toString()]=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lNoeudListeElements,null,lTitre,'Gras',true);}
else lNoeudElement=lHashDate[lJourDeLaSemaine.toString()];if(GEtatUtilisateur.getGenreOnglet()===EGenreOnglet.CDT_TAF)
_accessibiliteTAF.bind(this)(lNoeudElement,lDonnee);else _accessibiliteContenu.bind(this)(lNoeudElement,lDonnee);}}
GHtml.setHtml(this.GetNomInstance(this.IdentCahierDeTexte),this._objetListeArborescente.ConstruireAffichage());this._objetListeArborescente.SetDonnees(lRacine);};function _accessibiliteTAF(aNoeudElement,aDonnee){var J,lIPJ,lTitre,lNoeudDonneLe,lNoeudMatiere,lNoeudPJ,lNbrElements,lPieceJointe,lTAF,lHashDateDonneLe;lNoeudMatiere=this._objetListeArborescente.ajouterUnNoeudAuNoeud(aNoeudElement,null,aDonnee.GetLibelle(),'',true);lHashDateDonneLe={};lNbrElements=aDonnee.ressources?aDonnee.ressources.GetNbrElements():this.ListeTravailAFaire.GetNbrElements();for(J=0;J<lNbrElements;J++){lTAF=aDonnee.ressources?this.ListeTravailAFaire.GetElementParNumero(aDonnee.ressources.GetElement(J).GetNumero()):this.ListeTravailAFaire.GetElement(J);if(!lHashDateDonneLe[lTAF.DonneLe.toString()]){var lNbJours=GDate.GetDifferenceJours(lTAF.PourLe,lTAF.DonneLe);var lStrJours=(lNbJours>1?GTraductions.getValeur('CahierDeTexte.jours'):GTraductions.getValeur('CahierDeTexte.jour'));lTitre=GTraductions.getValeur('CahierDeTexte.donneLe')+GDate.FormatDate(lTAF.DonneLe,' %JJ %MMMM %AAAA')+' ['+lNbJours+' '+lStrJours+']';lNoeudDonneLe=lHashDateDonneLe[lTAF.DonneLe.toString()]=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lNoeudMatiere,null,lTitre,'',false);}
else lNoeudDonneLe=lHashDateDonneLe[lTAF.DonneLe.toString()];this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudDonneLe,'',lTAF.descriptif);if(lTAF.ListePieceJointe.GetNbrElements()>0){lNoeudPJ=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lNoeudDonneLe,null,GTraductions.getValeur('CahierDeTexte.documentsAConsulter'),'',false);for(lIPJ=0;lIPJ<lTAF.ListePieceJointe.GetNbrElements();lIPJ++){lPieceJointe=lTAF.ListePieceJointe.GetElement(lIPJ);this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudPJ,'',GChaine.composerURL(lPieceJointe.Url,lPieceJointe.Libelle,lPieceJointe.GetGenre()===EGenreDocumentJoint.Fichier));}}}}
function _accessibiliteContenu(aNoeudElement,aDonnee){var i,lIPJ,lTitre,lNoeudContenu,lNoeudMatiere,lNoeudPJ,lPieceJointe,lElement,lContenu;lTitre=aDonnee.GetLibelle()+' '+GTraductions.getValeur('CahierDeTexte.le')+GDate.FormatDate(aDonnee.Date,' %JJ %MMMM %AAAA '+GTraductions.getValeur('CahierDeTexte.a')+' %hhh%mm');lNoeudMatiere=this._objetListeArborescente.ajouterUnNoeudAuNoeud(aNoeudElement,null,lTitre,'',true);lElement=this.ListeCahierDeTextes.GetElementParNumero(aDonnee.ressources.GetNumero(0));for(i=0;i<lElement.listeContenus.GetNbrElements();i++){lContenu=lElement.listeContenus.GetElement(i);lTitre=(lContenu.categorie.Libelle?lContenu.categorie.Libelle+' - ':'')+lContenu.Libelle;lNoeudContenu=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lNoeudMatiere,null,lTitre,'',false);if(lContenu.descriptif.length>0)
this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudContenu,'',lContenu.descriptif);if(lContenu.ListePieceJointe.GetNbrElements()>0){lNoeudPJ=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lNoeudContenu,null,GTraductions.getValeur('CahierDeTexte.documentsAConsulter'),'',false);for(lIPJ=0;lIPJ<lContenu.ListePieceJointe.GetNbrElements();lIPJ++){lPieceJointe=lContenu.ListePieceJointe.GetElement(lIPJ);this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lNoeudPJ,null,GChaine.composerURL(lPieceJointe.Url,lPieceJointe.Libelle,lPieceJointe.GetGenre()===EGenreDocumentJoint.Fichier));}}}}})();;
MethodesObjet.heritagePrototype(ObjetDetailOffreStage,Identite);function ObjetDetailOffreStage(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.initOptions();var lID=IE.GUID.getId();this.classes={offreDetail:IE.GUID.getClassCss(),table:IE.GUID.getClassCss(),tablefin:IE.GUID.getClassCss()};}(function(){ObjetDetailOffreStage.prototype.initOptions=function(){this._options={avecEdition:false};};ObjetDetailOffreStage.prototype.setOptions=function(aOptions){$.extend(this._options,aOptions);};ObjetDetailOffreStage.prototype.setDonnees=function(aDonnees){this.offreDeStage=aDonnees.offre;_actualiser.bind(this)();};function _actualiser(){var lHeightMax=$('#'+(this.Nom).escapeJQ()).height()-5-13;var lMinHeight=Math.min(250,lHeightMax);this.Afficher();$('.'+this.classes.offreDetail.escapeJQ()).height(lHeightMax+5);var lHeightTable=$('.'+this.classes.table.escapeJQ()).height();var lCorrection=34+(this.offreDeStage&&this.offreDeStage.sujet?30:0);if(lHeightTable<lHeightMax){var lHeight=Math.borner(lHeightTable-lCorrection,lMinHeight-lCorrection,lHeightMax-lCorrection);$('.'+this.classes.tablefin.escapeJQ()).height(lHeight);} else{var lWidth=$('.'+this.classes.tablefin.escapeJQ()).width();$('.'+this.classes.tablefin.escapeJQ()).children().width(lWidth-10);$('.'+this.classes.tablefin.escapeJQ()).height(lHeightMax-lCorrection).jScrollPane({showArrows:true,enableKeyboardNavigation:false});}}
ObjetDetailOffreStage.prototype.actualiserAffichage=function(){_actualiser.bind(this)();};ObjetDetailOffreStage.prototype.ConstruireAffichage=function(){if(!this.offreDeStage) return this.composeMessage(GTraductions.getValeur('OffreStage.selectOffre'));var H=[];H.push('<div style="',GStyle.composeHeight(7),'"></div>');H.push('<div class="WhiteSpaceNormal ',this.classes.offreDetail,'" style="width:100%;"><table class="Tableau Texte10 ',this.classes.table,' OmbreFocus" tabIndex="0" style="width:100%;height:100%;" border="0" cellpadding="0" cellspacing="0">');H.push(_composeTitre.bind(this)());H.push(_composeContenu.bind(this)());H.push('<tr><td colspan="2" style="',GStyle.composeHeight(100,'%'),'"></td></tr>');H.push('</table></div>');return H.join('');};function _composeTitre(){var H=[];var lCouleurFond=GCouleur.liste.titre.getFond();var lCouleurTexte=GCouleur.liste.titre.getTexte();var lHeight=34;var lWidthActivite=110;var lWidthEntreprise=$('#'+(this.Nom).escapeJQ()).width()-10-1-(lWidthActivite+10+1);H.push('<tr style="',GStyle.composeCouleur(lCouleurFond,lCouleurTexte),'">','<td class="EspaceGauche EspaceDroit AlignementMilieuVertical Titre" style="',GStyle.composeHeight(lHeight),'"><div class="_spaceHaut Gras AlignementGauche" style="',GStyle.composeWidth(lWidthEntreprise),'">',this.offreDeStage&&this.offreDeStage.entreprise?this.offreDeStage.entreprise.GetLibelle()+(this.offreDeStage.entreprise.codePostal?' ('+this.offreDeStage.entreprise.codePostal+')':''):'','</div></td>','<td class="EspaceGauche EspaceDroit AlignementMilieuVertical Titre" style="',GStyle.composeHeight(lHeight),'"><div class="_spaceHaut Gras AlignementDroit" style="',GStyle.composeWidth(lWidthActivite),'">',this.offreDeStage&&this.offreDeStage.entreprise.activite?this.offreDeStage.entreprise.activite.GetLibelle():'','</div></td>','</tr>');return H.join('');}
function _composeContenu(){var H=[];var lStyleWidth=GStyle.composeWidth($('#'+(this.Nom).escapeJQ()).width()-10);if(this.offreDeStage&&this.offreDeStage.sujet)
H.push('<tr><td colspan="2" class="AlignementMilieuVertical" style="',GStyle.composeHeight(30),'">','<div class="Gras" style="',lStyleWidth,'">',GChaine.ToHTML(this.offreDeStage.sujet.GetLibelle()),'</div>','</td></tr>');H.push('<tr><td colspan="2" class="EspaceBas AlignementHaut" style="','"><div class="',this.classes.tablefin,'">');if(this.offreDeStage&&this.offreDeStage.sujetDetaille)
H.push('<div class="EspaceHaut10" style="',lStyleWidth,'">',GChaine.ToHTML(this.offreDeStage.sujetDetaille),'</div>');if(this.offreDeStage&&this.offreDeStage.commentaire)
H.push('<div class="EspaceHaut10" style="',lStyleWidth,'">',GChaine.ToHTML(this.offreDeStage.commentaire),'</div>');if(this.offreDeStage&&this.offreDeStage.siteWeb)
H.push('<div class="EspaceHaut10" style="',lStyleWidth,'">',GChaine.composerURL(this.offreDeStage.siteWeb,GChaine.ToHTML(this.offreDeStage.siteWeb)),'</div>');H.push('</div></td></tr>');return H.join('');}})();;
function ObjetRequeteListeOffresStages(aPere,aEvenementSurReussite,aEvenementSurEchec){this.inheritedCreate(aPere,aEvenementSurReussite,aEvenementSurEchec);}
IE.Requetes.inscrire('ListeOffresStages',ObjetRequeteListeOffresStages,_ObjetRequeteXmlConsultationPN);ObjetRequeteListeOffresStages.prototype.lancerRequete=function(){this.appelAsynchroneConsultation();};ObjetRequeteListeOffresStages.prototype.actionApresRequete=function(){var lParam={};lParam.listeEntreprises=this.JSONReponse.listeEntreprises?this.JSONReponse.listeEntreprises:new ObjetListeElements();this.callbackReussite.appel(lParam);};;
MethodesObjet.heritagePrototype(PageOffresStages,ObjetInterfacePage);function PageOffresStages(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.dim={listeOffres:{minL:610,maxL:810,L:685,H:100},detailOffre:{minL:340,maxL:490,L:420,H:100},filtre:{L:1000,H:75}};this.idFiltre=IE.GUID.getId();this.idNbrSemaines=IE.GUID.getId();}(function(){PageOffresStages.prototype.ConstruireInstances=function(){this.identListeOffres=this.Add(window.ObjetListe,_evnSelectListeOffre.bind(this),_initListe.bind(this));this.identDetailOffreDeStage=this.Add(window.ObjetDetailOffreStage);this.identCelFiltreSujet=this.Add(window.ObjetCelluleMultiSelection,_evnFiltreSujet.bind(this),_initFiltreSujet.bind(this));this.identCelFiltreActivite=this.Add(window.ObjetCelluleMultiSelection,_evnFiltreActivite.bind(this),_initFiltreActivite.bind(this));this.identCelFiltreEntreprise=this.Add(window.ObjetCelluleMultiSelection,_evnFiltreEntreprise.bind(this),_initFiltreEntreprise.bind(this));this.identCelFiltreCP=this.Add(window.ObjetCelluleMultiSelection,_evnFiltreCP.bind(this),_initFiltreCP.bind(this));this.identDate=this.Add(window.ObjetCelluleDate,_evnFiltreDate.bind(this),_initialiserDate.bind(this));};PageOffresStages.prototype.getControleur=function(){return{nbSemaines:{getValue:function(){return this.instance.filtreNbrSemaines||'';},setValue:function(aValue){this.instance.filtreNbrSemaines=parseInt(aValue);if(!MethodesObjet.isNumber(this.instance.filtreNbrSemaines)){this.instance.filtreNbrSemaines=0;}
_evnFiltre.call(this.instance);}}};};function _initListe(aInstance){aInstance.SetParametres([GTraductions.getValeur('OffreStage.titre.Sujet'),GTraductions.getValeur('OffreStage.titre.Entreprise'),GTraductions.getValeur('OffreStage.titre.Activite'),{libelleHtml:GTraductions.getValeur('OffreStage.titre.Duree')},{libelleHtml:GTraductions.getValeur('OffreStage.titre.CodePostal')},GTraductions.getValeur('OffreStage.titre.Date')],['60%','40%','100','40','45','60'],null,null,null,[null,null,null,GTraductions.getValeur('OffreStage.info.Duree'),null,null]);aInstance.setOptionsListe({skin:ObjetListe.skin.moderne,hauteurCelluleStandard:28,hauteurCelluleTitreStandard:34,colonnesTriables:true,numeroColonneTriDefaut:DonneesListe_OffresStages.genreColonne.sujet,});}
function _initFiltreSujet(aInstance){aInstance.setOptions({largeurBouton:220,titreFenetre:GTraductions.getValeur('OffreStage.titre.FiltreSujet')});}
function _initFiltreActivite(aInstance){aInstance.setOptions({largeurBouton:220,titreFenetre:GTraductions.getValeur('OffreStage.titre.FiltreActivite')});}
function _initFiltreEntreprise(aInstance){aInstance.setOptions({largeurBouton:220,titreFenetre:GTraductions.getValeur('OffreStage.titre.FiltreEntreprise')});}
function _initFiltreCP(aInstance){aInstance.setOptions({largeurBouton:220,titreFenetre:GTraductions.getValeur('OffreStage.titre.FiltreCodePostal')});}
function _initialiserDate(aInstance){aInstance.SetParametres(true,null,18,null,false);}
function _evnSelectListeOffre(aGenreEvenementListe,aColonne,aLigne,aSurClavier){this.offreSelectionne=this.listeOffresStages.GetElement(aLigne);this.GetInstance(this.identDetailOffreDeStage).setDonnees({offre:this.offreSelectionne});}
function _evnFiltreSujet(aGenreBouton,aListeDonnees){this.filtreSujet=aListeDonnees;_evnFiltre.bind(this)();}
function _evnFiltreActivite(aGenreBouton,aListeDonnees){this.filtreActivite=aListeDonnees;_evnFiltre.bind(this)();}
function _evnFiltreEntreprise(aGenreBouton,aListeDonnees){this.filtreEntreprise=aListeDonnees;_evnFiltre.bind(this)();}
function _evnFiltreCP(aGenreBouton,aListeDonnees){this.filtreCodePostal=aListeDonnees;_evnFiltre.bind(this)();}
function _evnFiltreDate(aDate){this.filtreDate=aDate;_evnFiltre.bind(this)();}
function _evnFiltre(){if(this.filtreSujet.GetNbrElements()||this.filtreActivite.GetNbrElements()||this.filtreEntreprise.GetNbrElements()||this.filtreCodePostal.GetNbrElements()||!GDate.estJourEgal(this.filtreDate,this.dateInit)||this.filtreNbrSemaines>0){var lArrNrSujets=this.filtreSujet.getTableauNumeros();var lArrNrActivites=this.filtreActivite.getTableauNumeros();var lArrNrEntreprises=this.filtreEntreprise.getTableauNumeros();var lArrCodePostaux=this.filtreCodePostal.getTableauLibelles();var lAvecActiviteVide=this.filtreActivite.getIndiceElementParFiltre(function(aElement){return aElement.filtreAucun;})>-1;var lAvecCPVide=this.filtreCodePostal.getIndiceElementParFiltre(function(aElement){return aElement.filtreAucun;})>-1;var lDate=this.filtreDate;var lNbrSemaines=this.filtreNbrSemaines;this.listeOffresStages=this.listeOffresStagesOrigin.getListeElements(function(aElement,aIndice){var lFiltreSujet=lArrNrSujets.length===0||(aElement.sujet&&$.inArray(aElement.sujet.GetNumero(),lArrNrSujets)>-1);var lFiltreActivite=(lArrNrActivites.length===0)||(aElement.entreprise&&aElement.entreprise.activite&&$.inArray(aElement.entreprise.activite.GetNumero(),lArrNrActivites)>-1)||(lAvecActiviteVide&&aElement.entreprise&&(!aElement.entreprise.activite||!aElement.entreprise.activite.existeNumero()));var lFiltreEntreprise=lArrNrEntreprises.length===0||(aElement.entreprise&&$.inArray(aElement.entreprise.GetNumero(),lArrNrEntreprises)>-1);var lFiltreCP=(lArrCodePostaux.length===0)||(aElement.entreprise&&$.inArray(aElement.entreprise.codePostal,lArrCodePostaux)>-1)||(lAvecCPVide&&aElement.entreprise&&!aElement.entreprise.codePostal);var lFiltreDate=GDate.GetJour(aElement.date)>=GDate.GetJour(lDate);var lFiltreNbrSemaines=!lNbrSemaines||aElement.dureeEnJours===0||(aElement.dureeEnJours/7)>=lNbrSemaines;return lFiltreSujet&&lFiltreActivite&&lFiltreEntreprise&&lFiltreCP&&lFiltreDate&&lFiltreNbrSemaines;});} else{this.listeOffresStages=MethodesObjet.dupliquer(this.listeOffresStagesOrigin);}
_trierOffres.bind(this)(this.listeOffresStages);if(this.listeOffresStages){this.GetInstance(this.identListeOffres).SetDonnees(new DonneesListe_OffresStages(this.listeOffresStages));this.GetInstance(this.identDetailOffreDeStage).setDonnees({offre:null});this.offreSelectionne=null;}}
function _calculDimensions(){var lHeight=$('#'+(this.Nom).escapeJQ()).height()-5-this.dim.filtre.H-10-5;this.dim.listeOffres.H=lHeight;this.dim.detailOffre.H=lHeight;var lWidth=$('#'+(this.Nom).escapeJQ()).width()-10;this.dim.listeOffres.L=Math.floor(Math.borner((lWidth*this.dim.listeOffres.maxL)/(this.dim.listeOffres.maxL+this.dim.detailOffre.maxL),this.dim.listeOffres.minL,this.dim.listeOffres.maxL));this.dim.detailOffre.L=Math.floor(Math.borner(lWidth-this.dim.listeOffres.L,this.dim.detailOffre.minL,this.dim.detailOffre.maxL))-5;this.dim.filtre.L=this.dim.listeOffres.L+this.dim.detailOffre.L-5-2;}
PageOffresStages.prototype.SetParametresGeneraux=function(){this.avecBandeau=true;this.GenreStructure=EStructureAffichage.Autre;};PageOffresStages.prototype.ConstruireStructureAffichageAutre=function(){var H=[];_calculDimensions.bind(this)();H.push('<div class="Espace">');H.push('<fieldset id="',this.idFiltre,'" class="Texte10 ',GClass.getZone(),'" style="margin : 0px 0px 5px 0px; ',GStyle.composeWidth(this.dim.filtre.L),GStyle.composeHeight(this.dim.filtre.H-10),'"><legend class="',GClass.getLegende(),'">',GTraductions.getValeur('OffreStage.titre.Filtre'),'</legend>');H.push('<div id="',this.idFiltre,'_div" style="',GStyle.composeWidth(400),'">',_composeFiltre.bind(this)(),'</div>');H.push('</fieldset>');H.push('<div class="NoWrap">');H.push('<div class="InlineBlock AlignementHaut" _tyle="',GStyle.composeCouleurBordure(GCouleur.bordure),'"><div id="',this.GetInstance(this.identListeOffres).GetNom(),'" class="WhiteSpaceNormal" style="',GStyle.composeWidth(this.dim.listeOffres.L),GStyle.composeHeight(this.dim.listeOffres.H),'" tabIndex="-1"></div></div>');H.push('<div class="InlineBlock AlignementHaut EspaceGauche" _tyle="',GStyle.composeCouleurBordure(GCouleur.bordure),'"><div id="',this.GetInstance(this.identDetailOffreDeStage).GetNom(),'" style="',GStyle.composeWidth(this.dim.detailOffre.L),GStyle.composeHeight(this.dim.detailOffre.H),'" tabIndex="-1"></div></div>');H.push('</div>');H.push('</div>');return H.join('');};function _composeFiltre(){var H=[];H.push('<table class="Texte10 Tableau" style="width:100%;" border="0" cellpadding="0" cellspacing="0">','<tr>','<td class="EspaceGauche AlignementDroit AlignementMilieuVertical Insecable">',GTraductions.getValeur('OffreStage.titre.Sujet'),'&nbsp;:&nbsp;</td>','<td class="AlignementMilieuVertical"><div id="',this.GetInstance(this.identCelFiltreSujet).GetNom(),'"></div></td>','<td class="EspaceGauche10 AlignementDroit AlignementMilieuVertical Insecable">',GTraductions.getValeur('OffreStage.titre.Entreprise'),'&nbsp;:&nbsp;</td>','<td class="AlignementMilieuVertical"><div id="',this.GetInstance(this.identCelFiltreEntreprise).GetNom(),'"></div></td>','<td class="EspaceGauche10 AlignementMilieuVertical Insecable"><div class="NoWrap"><div class="InlineBlock AlignementMilieuVertical">',GTraductions.getValeur('OffreStage.DepuisLe'),'&nbsp;:&nbsp; </div><div id="',this.GetInstance(this.identDate).GetNom(),'" class="InlineBlock AlignementMilieuVertical"></div></div></td>','</tr><tr>','<td class="EspaceGauche AlignementDroit EspaceHaut AlignementMilieuVertical Insecable">',GTraductions.getValeur('OffreStage.titre.Activite'),'&nbsp;:&nbsp;</td>','<td class="EspaceHaut AlignementMilieuVertical"><div id="',this.GetInstance(this.identCelFiltreActivite).GetNom(),'"></div></td>','<td class="EspaceGauche10 AlignementDroit EspaceHaut AlignementMilieuVertical Insecable">',GTraductions.getValeur('OffreStage.titre.CodePostal'),'&nbsp;:&nbsp;</td>','<td class="EspaceHaut AlignementMilieuVertical"><div id="',this.GetInstance(this.identCelFiltreCP).GetNom(),'"></div></td>','<td class="EspaceGauche10 EspaceHaut AlignementMilieuVertical Insecable">',GTraductions.getValeur('OffreStage.AuMoins'),'&nbsp;<input ie-model="nbSemaines" ie-mask="/[^0-9]/i" id="',this.idNbrSemaines,'" size="2" maxlength="2" type="text" class="EspaceInput Texte10" style="width : 25px; height : 18px; ',GStyle.composeCouleurBordure(GCouleur.bordure),'"/>&nbsp;',GTraductions.getValeur('OffreStage.Semaines'),'</td>','</tr>','</table>');return H.join('');}
PageOffresStages.prototype.RecupererDonnees=function(){new ObjetRequeteListeOffresStages(this,this.actionSurRecupererListeOffres).lancerRequete();};PageOffresStages.prototype.actionSurRecupererListeOffres=function(aParam){this.listeEntreprises=aParam.listeEntreprises;_formatOffresDeStage.bind(this)(this.listeEntreprises);if(this.listeOffresStages){this.GetInstance(this.identListeOffres).SetDonnees(new DonneesListe_OffresStages(this.listeOffresStages));this.GetInstance(this.identCelFiltreSujet).setDonnees(this.listeSujets);this.GetInstance(this.identCelFiltreActivite).setDonnees(this.listeActivites);this.GetInstance(this.identCelFiltreEntreprise).setDonnees(this.listeEntreprises);this.GetInstance(this.identCelFiltreCP).setDonnees(this.listeCodePostaux);this.GetInstance(this.identDate).setPremiereDateSaisissable(this.dateInit);this.GetInstance(this.identDate).SetDonnees(this.dateInit);}
$('#'+this.idNbrSemaines.escapeJQ()).on('keyup',null,{aObjet:this},function(event){if(event.which===ToucheClavier.RetourChariot){event.data.aObjet._setFocusListeOffres();}
event.stopPropagation();});};PageOffresStages.prototype._setFocusListeOffres=function(aParam){$('#'+this.GetInstance(this.identListeOffres).GetNom().escapeJQ()).focus();};function _formatOffresDeStage(aListeEntreprises){this.dateInit=null;this.filtreSujet=new ObjetListeElements();this.filtreActivite=new ObjetListeElements();this.filtreEntreprise=new ObjetListeElements();this.filtreCodePostal=new ObjetListeElements();this.filtreNbrSemaines=0;this.listeOffresStagesOrigin=new ObjetListeElements();this.listeSujets=new ObjetListeElements();this.listeActivites=new ObjetListeElements();this.listeCodePostaux=new ObjetListeElements();var lEntreprise;var lElm;var lOffre;var lCPAjoute=false;var LActAjoute=false;for(var i=0;i<aListeEntreprises.GetNbrElements();i++){lElm=aListeEntreprises.GetElement(i);lEntreprise=new ObjetElement(lElm.GetLibelle(),lElm.GetNumero(),lElm.GetGenre());if(lElm.codePostal){if(this.listeCodePostaux.GetIndiceParLibelle(lElm.codePostal)===undefined){this.listeCodePostaux.AddElement(new ObjetElement(lElm.codePostal,null,null,2));}} else{if(!lCPAjoute){var lAucuneCP=new ObjetElement(GTraductions.getValeur('OffreStage.CodePostalNonDefini'),null,null,1);lAucuneCP.filtreAucun=true;this.listeCodePostaux.AddElement(lAucuneCP);lCPAjoute=true;}}
lEntreprise.codePostal=lElm.codePostal;lEntreprise.ville=lElm.ville;if(lElm.activite){lEntreprise.activite=lElm.activite;var lActivite=MethodesObjet.dupliquer(lEntreprise.activite);if(this.listeActivites.GetIndiceParNumeroEtGenre(lActivite.GetNumero())===undefined){lActivite.Position=2;this.listeActivites.AddElement(lActivite);}} else{if(!LActAjoute){var lAucuneActivite=new ObjetElement(GTraductions.getValeur('OffreStage.ActiviteNonDefini'),null,null,1);lAucuneActivite.filtreAucun=true;this.listeActivites.AddElement(lAucuneActivite);LActAjoute=true;}}
for(var j=0;j<lElm.listeOffresStages.GetNbrElements();j++){lOffre=MethodesObjet.dupliquer(lElm.listeOffresStages.GetElement(j));if(lOffre.sujet){if(this.listeSujets.GetIndiceParNumeroEtGenre(lOffre.sujet.GetNumero())===undefined){var lSujet=MethodesObjet.dupliquer(lOffre.sujet);if(!lSujet.existeNumero()){lSujet.SetLibelle(GTraductions.getValeur('OffreStage.SujetNonDefini'));lSujet.Position=1;lSujet.filtreAucun=true;} else{lSujet.Position=2;}
this.listeSujets.AddElement(lSujet);}}
if(lOffre.date&&(!this.dateInit||lOffre.date<this.dateInit)) this.dateInit=lOffre.date;lOffre.entreprise=lEntreprise;this.listeOffresStagesOrigin.AddElement(lOffre);}}
this.listeOffresStages=MethodesObjet.dupliquer(this.listeOffresStagesOrigin);_trierOffres.bind(this)(this.listeOffresStages);_trierListe.bind(this)(this.listeSujets);_trierListe.bind(this)(this.listeActivites);_trierListe.bind(this)(this.listeCodePostaux);this.filtreDate=this.dateInit;}
function _trierOffres(aListeOffres){aListeOffres.setTri([
ObjetTri.init(function(D){return D.sujet?D.sujet.GetLibelle():'';}),ObjetTri.init(function(D){return D.entreprise?D.entreprise.GetLibelle():'';}),ObjetTri.init('dureeEnJours')
]);aListeOffres.trier();}
function _trierListe(aListe){aListe.setTri([
ObjetTri.init('Position'),ObjetTri.init('Libelle')
]);aListe.trier();}
PageOffresStages.prototype.surResizeInterface=function(){$('#'+this.GetInstance(this.identListeOffres).GetNom().escapeJQ()).height(0);$('#'+this.GetInstance(this.identDetailOffreDeStage).GetNom().escapeJQ()).height(0);$('#'+this.GetInstance(this.identListeOffres).GetNom().escapeJQ()).width(0);$('#'+this.GetInstance(this.identDetailOffreDeStage).GetNom().escapeJQ()).width(0);$('#'+this.idFiltre.escapeJQ()).width(0);this.inherited('surResizeInterface');_calculDimensions.bind(this)();$('#'+this.GetInstance(this.identListeOffres).GetNom().escapeJQ()).width(this.dim.listeOffres.L);$('#'+this.GetInstance(this.identDetailOffreDeStage).GetNom().escapeJQ()).width(this.dim.detailOffre.L);$('#'+this.idFiltre.escapeJQ()).width(this.dim.filtre.L);$('#'+this.GetInstance(this.identListeOffres).GetNom().escapeJQ()).height(this.dim.listeOffres.H);$('#'+this.GetInstance(this.identDetailOffreDeStage).GetNom().escapeJQ()).height(this.dim.detailOffre.H);this.GetInstance(this.identDetailOffreDeStage).actualiserAffichage();};}());MethodesObjet.heritagePrototype(DonneesListe_OffresStages,ObjetDonneesListe);function DonneesListe_OffresStages(aDonnees){this.inheritedCreate(aDonnees);}
DonneesListe_OffresStages.genreColonne={sujet:0,entreprise:1,activite:2,duree:3,codePostal:4,date:5};DonneesListe_OffresStages.prototype.AvecEdition=function(I,D){return false;};DonneesListe_OffresStages.prototype.AvecSuppression=function(D){return false;};DonneesListe_OffresStages.prototype.AvecEvenement_Selection=function(I,D){return true;};DonneesListe_OffresStages.prototype.AvecEtatSaisie=function(D){return false;};DonneesListe_OffresStages.prototype.GetTypeValeur=function(I,D){return this.ETypeCellule.Texte;};DonneesListe_OffresStages.prototype.GetValeur=function(aColonne,aOffreStage,K,aSurEdition){switch(aColonne){case DonneesListe_OffresStages.genreColonne.sujet:return aOffreStage.sujet.GetLibelle();case DonneesListe_OffresStages.genreColonne.entreprise:return aOffreStage.entreprise.GetLibelle();case DonneesListe_OffresStages.genreColonne.activite:return aOffreStage.entreprise.activite?aOffreStage.entreprise.activite.GetLibelle():'';case DonneesListe_OffresStages.genreColonne.duree:return aOffreStage.dureeEnJours?(aOffreStage.dureeEnJours/7):'';case DonneesListe_OffresStages.genreColonne.codePostal:return aOffreStage.entreprise.codePostal;case DonneesListe_OffresStages.genreColonne.date:return GDate.FormatDate(aOffreStage.date,'%JJ/%MM/%AAAA');}
return'';};DonneesListe_OffresStages.prototype.getClass=function(aColonne,aOffreStage){switch(aColonne){case DonneesListe_OffresStages.genreColonne.duree:case DonneesListe_OffresStages.genreColonne.codePostal:case DonneesListe_OffresStages.genreColonne.date:return'AlignementMilieu';default:return'';}};DonneesListe_OffresStages.prototype.getTri=function(aColonneDeTri,aGenreTri){if(aColonneDeTri===null||aColonneDeTri===undefined) return[];var lTris=[];switch(aColonneDeTri){case DonneesListe_OffresStages.genreColonne.sujet:lTris.push(ObjetTri.init(function(D){return D.sujet?D.sujet.GetLibelle():'';},aGenreTri));break;case DonneesListe_OffresStages.genreColonne.entreprise:lTris.push(ObjetTri.init(function(D){return D.entreprise?D.entreprise.GetLibelle():'';},aGenreTri));break;case DonneesListe_OffresStages.genreColonne.activite:lTris.push(ObjetTri.init(function(D){return D.entreprise&&D.entreprise.activite?D.entreprise.activite.GetLibelle():'';},aGenreTri));break;case DonneesListe_OffresStages.genreColonne.duree:lTris.push(ObjetTri.init('dureeEnJours',aGenreTri));break;case DonneesListe_OffresStages.genreColonne.codePostal:lTris.push(ObjetTri.init(function(D){return D.entreprise?D.entreprise.codePostal:'';},aGenreTri));break;case DonneesListe_OffresStages.genreColonne.date:lTris.push(ObjetTri.init('date',aGenreTri));break;default:break;}
return lTris;};;

MethodesObjet.heritagePrototype(DonneesListe_SelectionRessource,ObjetDonneesListe);function DonneesListe_SelectionRessource(aDonnees){this.inheritedCreate(aDonnees);}
DonneesListe_SelectionRessource.prototype.AvecEdition=function(I,D){return I===0&&!D.nonEditable;};DonneesListe_SelectionRessource.prototype.AvecSuppression=function(D){return false;};DonneesListe_SelectionRessource.prototype.AvecEtatSaisie=function(D){return false;};DonneesListe_SelectionRessource.prototype.AvecEvenement_ApresEdition=function(){return true;};DonneesListe_SelectionRessource.prototype.SurEdition=function(I,D,V){switch(I){case 0:{D.selectionne=V;break;}}};DonneesListe_SelectionRessource.prototype.GetValeur=function(I,D){switch(I){case 0:return D.selectionne;case 1:return D.GetLibelle();}
return'';};DonneesListe_SelectionRessource.prototype.GetTypeValeur=function(I,D){switch(I){case 0:return this.ETypeCellule.Coche;case 1:return this.ETypeCellule.Texte;}
return'';};DonneesListe_SelectionRessource.prototype.getStyle=function(I,D){switch(I){case 1:return D.GetActif()?'':GStyle.composeCouleurTexte(GCouleur.rouge);}
return'';};DonneesListe_SelectionRessource.prototype.getClass=function(I,D){switch(I){case 1:return this._options&&this._options.getClassRessource?this._options.getClassRessource(D):'';}
return'';};DonneesListe_SelectionRessource.prototype.getHintForce=function(I,D){switch(I){case 1:return this._options&&this._options.getHintRessource?this._options.getHintRessource(D):'';}
return'';};DonneesListe_SelectionRessource.prototype.GetVisible=function(D){if(!this._options||!this._options.filtres) return true;var lVisible=true;for(var i in this._options.filtres){var lFiltre=this._options.filtres[i];lVisible=lVisible&&lFiltre.filtre(D,lFiltre.checked);if(!lVisible){D.selectionne=false;return false;}}
return lVisible;};;

MethodesObjet.heritagePrototype(ObjetFenetre_SelectionRessource,ObjetFenetre);function ObjetFenetre_SelectionRessource(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.idCoche=this.Nom+'_coche';this.setOptionsFenetre({largeur:250,hauteur:350});this.setSelectionObligatoire(true);this._setBoutons([GTraductions.getValeur('Valider')]);this.indexBtnValider=0;var lId=window.GUID.getId();this.idConteneurFiltre=lId+'_Cfiltre';this.idFiltre=lId+'_filtre';this.classFiltres=IE.GUID.getClassCss();this._options={selectionObligatoire:false,autoriseEltAucun:false,filtres:null,triListe:null,avecCocheRessources:true,getClassRessource:null,getHintRessource:null};}(function(){ObjetFenetre_SelectionRessource.prototype.setOptions_Fenetre_SelectionRessource=function(aOptions){$.extend(this._options,aOptions);};ObjetFenetre_SelectionRessource.prototype.setSelectionObligatoire=function(aValeur){this.setOptions_Fenetre_SelectionRessource({selectionObligatoire:aValeur});};ObjetFenetre_SelectionRessource.prototype.setAutoriseEltAucun=function(aValeur){this.setOptions_Fenetre_SelectionRessource({autoriseEltAucun:aValeur});};ObjetFenetre_SelectionRessource.prototype.setDonnees=function(aParam){if(aParam.titre) this.SetTitre(aParam.titre);this.SetDonnees(aParam.listeRessources,aParam.listeRessourcesSelectionnees,aParam.genreRessource);};ObjetFenetre_SelectionRessource.prototype.SetDonnees=function(aListeRessources,aListeRessourcesSelectionnees,aGenreRessource){;this.listeRessourcesSelectionnees=aListeRessourcesSelectionnees;this.genreRessource=aGenreRessource;this.construireListeRessource(aListeRessources,aListeRessourcesSelectionnees);this.GetInstance(this.identListe).SetTitres([this._options.avecCocheRessources?{estCoche:true}:'',GTraductions.getValeur('Nom')]);this.Afficher();this._construireFiltres();this.surFixerTaille();this._actualiserListe();};ObjetFenetre_SelectionRessource.prototype._construireFiltres=function(){if(!this._options.filtres||this._options.filtres.length===0)
return;var T=[];if(this._options.filtres)
for(var i in this._options.filtres){var lFiltre=this._options.filtres[i];T.push('<div class="Texte10">');var lId=this.idFiltre+'_'+i;T.push('<input id="',lId,'" type="checkbox" class="AvecMain ',this.classFiltres,'"',lFiltre.checked?' checked':'','></input>','<label for="'+lId+'" class="AvecMain">'+lFiltre.libelle+'</label>');T.push('</div>');}
GHtml.setHtml(this.idConteneurFiltre,T.join(''));GHtml.setDisplay(this.idConteneurFiltre,true);$('.'+this.classFiltres.escapeJQ()).jIECheckBox().click({instance:this},this._surClickFitre);};ObjetFenetre_SelectionRessource.prototype._surClickFitre=function(aEvent){var lInstance=aEvent.data.instance;var lIndice=parseInt(this.id.split('_').pop(),10);lInstance._mettreAJourFiltre(lIndice,$(this).inputChecked());};ObjetFenetre_SelectionRessource.prototype._mettreAJourFiltre=function(aNumeroFiltre,aChecked){var lFiltre=this._options.filtres[aNumeroFiltre];lFiltre.checked=aChecked;if(lFiltre.callbackChecked)
lFiltre.callbackChecked(aChecked);this._actualiserListe();};ObjetFenetre_SelectionRessource.prototype.forcerMajListeSelection=function(){if(!this._forcerMajListeSelection){this._ancienListeSelection=this.listeRessourcesSelectionnees;this._forcerMajListeSelection=true;}
_majListeSelection.bind(this)();};ObjetFenetre_SelectionRessource.prototype.SurValidation=function(ANumeroBouton,aFermer){if(ANumeroBouton===this.indexBtnValider)
_majListeSelection.bind(this)();if(aFermer!==false)
this.Fermer();this.callback.appel(this.genreRessource,this.listeRessourcesSelectionnees,ANumeroBouton);};ObjetFenetre_SelectionRessource.prototype.ConstruireInstances=function(){this.identListe=this.Add(window.ObjetListe ,this._evenementSurListe,this._initialiserListe);};function _majListeSelection(){this.listeRessourcesSelectionnees.vider();for(var i=0,lNb=this.listeRessources.GetNbrElements();i<lNb;i++){var lRessource=this.listeRessources.GetElement(i);if(lRessource.selectionne&&!lRessource.estUnDeploiement)
this.listeRessourcesSelectionnees.AddElement(MethodesObjet.dupliquer(lRessource));}}
ObjetFenetre_SelectionRessource.prototype.ComposeContenu=function(){var T=[];T.push('<div id="',this.idConteneurFiltre,'" style="display:none"></div>');T.push('<div id="'+this.GetNomInstance(this.identListe)+'" class="Table"></div>');return T.join('');};ObjetFenetre_SelectionRessource.prototype.construireListeRessource=function(aListeRessources,aListeRessourcesSelectionnees){this.listeRessources=new ObjetListeElements();var i,lNbr,lElt,lRessource,lEltResSel;for(i=0,lNbr=aListeRessources.GetNbrElements();i<lNbr;i++){lElt=aListeRessources.GetElement(i);if((this._options.autoriseEltAucun||lElt.existeNumero())&&!lElt.nePasAfficher){lRessource=MethodesObjet.dupliquer(lElt);lEltResSel=aListeRessourcesSelectionnees.GetElementParElement(lRessource);if(lEltResSel){lRessource.selectionne=true;lRessource.avecReponse=!!lEltResSel.avecReponse;} else{lRessource.selectionne=false;}
this.listeRessources.AddElement(lRessource);}}
if(this._options.triListe){this.listeRessources.setTri(this._options.triListe);}
this.listeRessources.trier();};ObjetFenetre_SelectionRessource.prototype._initialiserListe=function(aInstance){var LListeTitres=[this._options.avecCocheRessources&&this._options.selectionCumul!==false?{estCoche:true}:'',GTraductions.getValeur('Nom')];var LListeTailles=['20','100%'];aInstance.SetParametres(LListeTitres,LListeTailles);aInstance.setOptionsListe({editionApresSelection:false,avecListeNeutre:true});};ObjetFenetre_SelectionRessource.prototype._evenementSurListe=function(aGenreEvenementListe){switch(aGenreEvenementListe){case EGenreEvenementListe.ApresEdition:{this.SetBoutonActif(this.indexBtnValider,!this._options.selectionObligatoire||this._nbRessourcesCochees()>0);break;}}};ObjetFenetre_SelectionRessource.prototype._actualiserListe=function(){this.SetBoutonActif(this.indexBtnValider,!this._options.selectionObligatoire||this._nbRessourcesCochees()>0);var lDonneesListe=new DonneesListe_SelectionRessource(this.listeRessources);lDonneesListe._options=this._options;this.GetInstance(this.identListe).SetDonnees(lDonneesListe);};ObjetFenetre_SelectionRessource.prototype._nbRessourcesCochees=function(){var lNombre=0;for(var i=0,lNb=this.listeRessources.GetNbrElements();i<lNb;i++)
if(this.listeRessources.GetElement(i).selectionne)
lNombre++;return lNombre;};ObjetFenetre_SelectionRessource.prototype._getNbRessourcesSelectionnables=function(){var lCompteur=0;for(var i=0,lNb=this.listeRessources.GetNbrElements();i<lNb;i++)
if(!this.listeRessources.GetElement(i).estDeploiement)
lCompteur++;return lCompteur;};ObjetFenetre_SelectionRessource.prototype.surFixerTaille=function(){this.inherited('surFixerTaille');GPosition.declencherResize(this.GetInstance(this.identListe).GetNom());};})();;
function DonneesListe_RessourcesPedagogiques(aDonnees,aClasseRef,aNomListe,aGenresAffiches,aCallbackExecutionQCM){this.classeRef=aClasseRef;this.nomListe=aNomListe;this.callbackExecutionQCM=aCallbackExecutionQCM;aDonnees.ensembleDocuments.parcourir(function(D){D.visible=D.genres.dupliquer().intersect(aGenresAffiches).count()>0;});this.inheritedCreate(aDonnees.ensembleDocuments);}
IE.MethodesObjet.heritagePrototype(DonneesListe_RessourcesPedagogiques,ObjetDonneesListe);(function(){DonneesListe_RessourcesPedagogiques.colonnes={types:0,libelle:1,date:2};DonneesListe_RessourcesPedagogiques.prototype.AvecEvenement_Selection=function(I,D){return(I===DonneesListe_RessourcesPedagogiques.colonnes.libelle)&&(D.GetGenre()===EGenreRessourcePedagogique.kiosque);};DonneesListe_RessourcesPedagogiques.prototype.AvecEdition=function(I,D){return false;};DonneesListe_RessourcesPedagogiques.prototype.AvecSelection=function(I,D){return false;};DonneesListe_RessourcesPedagogiques.prototype.getControleurDonneesListe=function(){return{eventLigne:function(aLigne,aEvent){var lElement=this.instance.Donnees.Donnees.GetElement(aLigne);if(lElement&&(lElement.genres.contains(EGenreRessourcePedagogique.QCM)||lElement.genres.contains(EGenreRessourcePedagogique.corrige))){this.instance.Donnees.callbackExecutionQCM(lElement.ressource);}
else ;}};};DonneesListe_RessourcesPedagogiques.prototype.GetTypeValeur=function(I,D,K){switch(I){case DonneesListe_RessourcesPedagogiques.colonnes.types:case DonneesListe_RessourcesPedagogiques.colonnes.libelle:return this.ETypeCellule.Html;}
return this.ETypeCellule.Texte;};DonneesListe_RessourcesPedagogiques.prototype.GetValeur=function(I,D,K,aSurEdition,aProportion,aLigne){var H=[],lItems,i;switch(I){case DonneesListe_RessourcesPedagogiques.colonnes.types:lItems=D.genres.items();for(i=0;i<lItems.length;i++){H.push('<div class="'+EGenreRessourcePedagogique.getImage(lItems[i])+' InlineBlock"></div>');}
return H.join('<div class="InlineBlock PetitEspaceDroit"></div>');case DonneesListe_RessourcesPedagogiques.colonnes.libelle:if(D.GetGenre()===EGenreRessourcePedagogique.QCM){if(window.GUtilitaires.QCM.estCliquable(D.ressource))
H.push('<span class="Texte10 SouligneSurvol AvecMain" ie-event="mouseup->donneesListe.eventLigne(',aLigne,')">',D.ressource.QCM.GetLibelle(),'</span>');else H.push('<span class="Texte10">',D.ressource.QCM.GetLibelle(),'</span>');return H.join('');} if(D.GetGenre()===EGenreRessourcePedagogique.kiosque){H.push('<div class="SouligneSurvol AvecMain">'+D.ressource.GetLibelle()+'</div>');return H.join('');} else{H.push('<a href="',EGenreRessourcePedagogique.getUrl(D.GetGenre(),D.ressource),'" class="Texte10 Maigre SouligneSurvol SouligneSurvol AvecMenuContextuel"',' style="',GStyle.composeCouleurTexte(GCouleur.noir),'">',D.ressource.GetLibelle(),'</a>');return H.join('');}
break;case DonneesListe_RessourcesPedagogiques.colonnes.date:var lDate=D.date;if(D.dates){lDate=D.dates[0];}
return GDate.FormatDate(lDate,'%JJ/%MM/%AA');}
return'';};DonneesListe_RessourcesPedagogiques.prototype.getHintForce=function(I,D){if(I===DonneesListe_RessourcesPedagogiques.colonnes.date&&D.dates){if(!D.dates.trie){D.dates.sort(function(a,b){return a.getTime()-b.getTime();});D.dates.trie=true;}
var lLibelle='';IE.MethodesTableau.parcourir(D.dates,function(aDate){if(lLibelle.length>0) lLibelle+='\n';lLibelle+=GDate.FormatDate(aDate,'%JJ/%MM/%AA');});return lLibelle;}
return'';};DonneesListe_RessourcesPedagogiques.prototype.getTri=function(aColonne,aGenreTri){var lTris=[];switch(aColonne){case DonneesListe_RessourcesPedagogiques.colonnes.types:lTris.push(ObjetTri.init(function(D){return D.genres.count();},aGenreTri));lTris.push(ObjetTri.init('Genre',aGenreTri));break;case DonneesListe_RessourcesPedagogiques.colonnes.libelle:lTris.push(ObjetTri.init('Libelle',aGenreTri));break;case DonneesListe_RessourcesPedagogiques.colonnes.date:lTris.push(ObjetTri.init('date',aGenreTri));break;}
lTris.push(ObjetTri.init('Libelle',aGenreTri));lTris.push(ObjetTri.init('date',aGenreTri));return lTris;};DonneesListe_RessourcesPedagogiques.prototype.GetVisible=function(D){return D.visible;};}());;
function ObjetRequeteRessourcePedagogique(aPere,aEvenementSurReussite,aEvenementSurEchec){this.inheritedCreate(aPere,aEvenementSurReussite,aEvenementSurEchec);}
IE.Requetes.inscrire('RessourcePedagogique',ObjetRequeteRessourcePedagogique,_ObjetRequeteXmlConsultationPN);ObjetRequeteRessourcePedagogique.prototype.lancerRequete=function(aParams){this.JSON.avecRessourcesPronote=aParams.avecRessourcesPronote;this.JSON.avecRessourcesEditeur=aParams.avecRessourcesEditeur;this.appelAsynchroneConsultation();};ObjetRequeteRessourcePedagogique.prototype.actionApresRequete=function(){var lListeMatieres=this.JSONReponse.listeMatieres,lMatiere,lListeRessources=this.JSONReponse.listeRessources;if(lListeMatieres)
lListeMatieres.parcourir(function(D){D.listeRessources=new ObjetListeElements();});if(this.JSONReponse.listeMatieres&&this.JSONReponse.listeRessources)
this.JSONReponse.listeRessources.parcourir(function(D){lMatiere=lListeMatieres.GetElementParNumero(D.matiere.GetNumero());if(lMatiere){lMatiere.listeRessources.AddElement(D);}
if(D.GetGenre()===EGenreRessourcePedagogique.QCM){var lRessource=MethodesObjet.dupliquer(D.ressource);new ObjetDeserialiser()._ajouterQCM(lRessource,D.ressource);}});if(lListeMatieres)
lListeMatieres.trier();for(var I=0;lListeRessources&&(I<lListeRessources.GetNbrElements());I++){var lRessource=lListeRessources.GetElement(I);if(!lRessource.estUnDeploiement)
lRessource.pere=lListeRessources.GetElementParNumero(lRessource.matiere.GetNumero());lRessource.estDeploye=true;}
this.callbackReussite.appel(lListeMatieres,lListeRessources,this.JSONReponse.listeMatieresParRessource,this.JSONReponse.afficherCumul);};;

function _ObjetInterfaceRessourcePedagogique(ANom,AIdent,APere,AEvenement){this.inheritedCreate(ANom,AIdent,APere,AEvenement);this.parametres={avecGenres:new TypeEnsembleNombre().add(EGenreRessourcePedagogique.documentJoint).add(EGenreRessourcePedagogique.site).add(EGenreRessourcePedagogique.QCM).add(EGenreRessourcePedagogique.corrige).add(EGenreRessourcePedagogique.kiosque).add(EGenreRessourcePedagogique.documentCloud)};this.ids={};}
MethodesObjet.heritagePrototype(_ObjetInterfaceRessourcePedagogique,ObjetInterfacePage);(function(){_ObjetInterfaceRessourcePedagogique.prototype.getControleur=function(){return{cb:{getValue:function(aGenre){return this.instance.parametres.avecGenres.contains(aGenre);},setValue:function(aGenre,aValue){if(aValue)
this.instance.parametres.avecGenres.add(aGenre) ;else this.instance.parametres.avecGenres.remove(aGenre) ;this.instance._actualiserAffichage();}}};};_ObjetInterfaceRessourcePedagogique.prototype.composerCBs=function(aAvecKiosque,aAvecDocumentCloud){var lGenre,T=[];T.push('<div class="Espace NoWrap">');for(var i in EGenreRessourcePedagogique){lGenre=EGenreRessourcePedagogique[i];if(!$.isFunction(lGenre)){var lVisible=true;switch(lGenre){case EGenreRessourcePedagogique.kiosque:lVisible=aAvecKiosque;break;case EGenreRessourcePedagogique.documentCloud:lVisible=aAvecDocumentCloud;break;}
if(lVisible)
T.push(_composerCB.bind(this)(lGenre));}}
T.push('</div>');return T.join('');};function _composerCB(aGenre){var lHtml=[],lLibelle='',lImage='';if((aGenre===EGenreRessourcePedagogique.kiosque)&&(!GEtatUtilisateur.autorisationKiosque))
return'';if((aGenre===EGenreRessourcePedagogique.documentCloud)&&(!GEtatUtilisateur.autorisationCloud))
return'';switch(aGenre){case EGenreRessourcePedagogique.documentJoint:lLibelle=GTraductions.getValeur('RessourcePedagogique.DocJoint');lImage='<div class="Image_Casier_DocumentJoint InlineBlock AlignementMilieuVertical"></div>';break;case EGenreRessourcePedagogique.site:lLibelle=GTraductions.getValeur('RessourcePedagogique.SitesWeb');lImage='<div class="Image_Insertion_Site InlineBlock AlignementMilieuVertical" style="width:18px; height:18px;"></div>';break;case EGenreRessourcePedagogique.QCM:lLibelle=GTraductions.getValeur('RessourcePedagogique.IDevoirs');lImage='<div class="Image_Casier_IDevoir InlineBlock AlignementMilieuVertical"></div>';break;case EGenreRessourcePedagogique.corrige:lLibelle=GTraductions.getValeur('RessourcePedagogique.Corriges');lImage='<div class="Image_Casier_Corrige InlineBlock AlignementMilieuVertical"></div>';break;case EGenreRessourcePedagogique.kiosque:lLibelle=GTraductions.getValeur('RessourcePedagogique.Kiosque');lImage='<div class="Image_Casier_Kiosque InlineBlock AlignementMilieuVertical"></div>';break;case EGenreRessourcePedagogique.documentCloud:lLibelle=GTraductions.getValeur('RessourcePedagogique.Cloud');lImage='<div class="Image_Casier_DocumentCloud InlineBlock AlignementMilieuVertical"></div>';break;}
lHtml.push('<div class="InlineBlock GrandEspaceGauche">');lHtml.push('<ie-checkbox ie-model="cb(',aGenre,')" tabIndex="0">',lImage,'<div class="PetitEspaceGauche AlignementMilieuVertical InlineBlock">',lLibelle,'</div>','</ie-checkbox>');lHtml.push('</div>');return lHtml.join('');}}());;
function ObjetInterfaceRessourcePedagogique(ANom,AIdent,APere,AEvenement){this.inheritedCreate(ANom,AIdent,APere,AEvenement);var lParametres={periodes:new ObjetListeElements(),affichageCasier:true,numeroMatiere:null};$.extend(true,this.parametres,lParametres);this.parametres.periodes=IE.MethodesObjet.dupliquer(GEtatUtilisateur.getOngletListePeriodes());var lClassRef=IE.GUID.getClassCss(),lIdRef=IE.GUID.getId();this.classesCss={classRef:lClassRef,casier:lClassRef+'_c',couvertureAvant:lClassRef+'_cav',couvertureArriere:lClassRef+'_car'};var lIds={conteneur:lIdRef+'_conteneur',matiereListe:lIdRef+'_matiereListe',matiereCasier:lIdRef+'_mat'};$.extend(true,this.ids,lIds);}
MethodesObjet.heritagePrototype(ObjetInterfaceRessourcePedagogique,_ObjetInterfaceRessourcePedagogique);(function(){ObjetInterfaceRessourcePedagogique.prototype.ConstruireInstances=function(){this.identZoneTexte=this.Add(window.ObjetZoneTexte);this.identPeriodes=this.Add(window.ObjetCelluleBouton,evenementSurPeriodes.bind(this),_initialiserPeriodes.bind(this));this.identFenetrePeriodes=this.addFenetre(window.ObjetFenetre_SelectionRessource,_evenementFenetrePeriodes.bind(this),_initialiserFenetrePeriodes.bind(this));this.identListe=this.Add(window.ObjetListe,this._evenementSurListe,_initialiserListe.bind(this));this.interfaceFicheVisu=this.Add(window.InterfaceFicheVisuEleveQCM,_evenementSurVisuEleve.bind(this));this.identBtnRetourCasier=this.Add(window.ObjetBoutonBandeau,_evenementBtnRetourCasier.bind(this),_initialiserBtnRetourCasier.bind(this));};function _actualiserBoutonPeriodes(){var lLibelles=[];if(GEtatUtilisateur.getOngletListePeriodes().GetNbrElements()===this.parametres.periodes.GetNbrElements()){lLibelles.push(GTraductions.getValeur('RessourcePedagogique.Toutes'));}
else{this.parametres.periodes.parcourir(function(D){lLibelles.push(D.GetLibelle());});}
this.GetInstance(this.identPeriodes).setLibelle(lLibelles.join(', '));}
function _initialiserPeriodes(aInstance){aInstance.setOptions_ObjetCelluleBouton({estSaisissable:false,avecZoneSaisie:false,genreBouton:EGenreBoutonCellule.Points,largeur:150,hauteur:15,largeurBouton:16});}
function evenementSurPeriodes(aGenreEvent,aEvent,aSurEdit){if((aGenreEvent===EEvent.SurKeyUp&&GNavigateur.IsToucheSelection())||aGenreEvent===EEvent.SurMouseDown){this.GetInstance(this.identFenetrePeriodes).setDonnees({listeRessources:GEtatUtilisateur.getOngletListePeriodes(),listeRessourcesSelectionnees:this.parametres.periodes,genreRessource:EGenreRessource.Periode,titre:EGenreRessource.getTitreFenetreSelectionRessource(EGenreRessource.Periode),estGenreRessourceDUtilisateurConnecte:EGenreRessource.correspondAuGenreUtilisateurEspaceCourant(EGenreRessource.Periode)});}}
function _initialiserListe(aInstance){aInstance.setOptionsListe({listeTailles:[35,400,60],listeTitres:['',GTraductions.getValeur('RessourcePedagogique.colonne.document'),GTraductions.getValeur('RessourcePedagogique.colonne.deposeLe')],skin:ObjetListe.skin.moderne,colonnesTriables:true,numeroColonneTriDefaut:1,hauteurCelluleStandard:30,hauteurCelluleTitreStandard:28});}
ObjetInterfaceRessourcePedagogique.prototype._evenementSurListe=function(aGenreEvenement,I,J){switch(aGenreEvenement){case EGenreEvenementListe.Selection:var lRessource=this.donneesListe.Donnees.GetElement(J);new ObjetRequeteSaisieURLKiosque(this,this._actionaisieURLKiosque).lancerRequete(lRessource.ressource);break;}};ObjetInterfaceRessourcePedagogique.prototype._actionaisieURLKiosque=function(aUrlSSO){window.open(aUrlSSO);};function _initialiserFenetrePeriodes(aInstance){aInstance.setOptions_Fenetre_SelectionRessource({selectionObligatoire:true,triListe:[ObjetTri.init('Genre'),ObjetTri.init('Libelle')]});}
function _evenementFenetrePeriodes(aGenreRessource,alisteRessourcesSelectionnees,aNumeroBouton){if(aNumeroBouton===EGenreAction.Valider){this.parametres.periodes=alisteRessourcesSelectionnees;_actualiserBoutonPeriodes.bind(this)();_mettreAJourListesPJ.bind(this)();this._actualiserAffichage();}}
function _initialiserBtnRetourCasier(aInstance){aInstance.setOptions_ObjetBoutonBandeau({nomClass:'Image_RetourBandeau',avecEspaceGauche:true,actif:true,avecEtat:true,avecSelection:false,tableauLibelles:[GTraductions.getValeur('RessourcePedagogique.Retour'),GTraductions.getValeur('RessourcePedagogique.Retour')],taille:18});aInstance.SetVisible(false);}
function _evenementBtnRetourCasier(){_switchAffichage.bind(this)(true);}
function _evenementSurVisuEleve(aParam){if(aParam.action==='close'){_envoieRequete.bind(this)();}}
function _callbackExecutionQCM(aQCM){this.GetInstance(this.interfaceFicheVisu).setParametres(aQCM.GetNumero(),GApplication.getDemo()||((GEtatUtilisateur.GenreEspace===EGenreEspace.Parent||GEtatUtilisateur.GenreEspace===EGenreEspace.Entreprise)&&(aQCM.etatCloture===undefined||aQCM.etatCloture===TypeEtatExecutionQCMPourRepondant.EQR_EnCours)));this.GetInstance(this.interfaceFicheVisu).setDonnees(aQCM);}
function _switchAffichage(aAffichageCasier,aMatiere){this.parametres.affichageCasier=aAffichageCasier;if(aMatiere){this.parametres.numeroMatiere=aMatiere.GetNumero();}
this.surResizeInterface();this._actualiserAffichage();}
function _surClickMatiere(event){var lInstance=event.data.instance,lIndice=GHtml.extraireNombreDId(this.id),lIndiceMatiere=GHtml.extraireNombreDId(this.id,1);var lMatiere=lInstance.donnees.GetElement(lIndiceMatiere);if(lIndice>=0){lInstance.parametres.avecGenres.clear();lInstance.parametres.avecGenres.add(lIndice);}
else{lInstance.parametres.avecGenres.add(EGenreRessourcePedagogique.documentJoint);lInstance.parametres.avecGenres.add(EGenreRessourcePedagogique.site);lInstance.parametres.avecGenres.add(EGenreRessourcePedagogique.QCM);lInstance.parametres.avecGenres.add(EGenreRessourcePedagogique.corrige);lInstance.parametres.avecGenres.add(EGenreRessourcePedagogique.kiosque);}
_switchAffichage.bind(lInstance)(false,lMatiere);}
function _construireCasiers(){var T=[],i,lNb,lMatiere,lAvecPJ;var lTaille=180,lCouleurMatiere='#444',lProp,lGenre,lChaine;T.push('<div class="Texte10 AlignementHautVertical" style="height:100%;">');T.push('<div style="padding:20px 80px;">');for(i=0,lNb=this.donnees.GetNbrElements();i<lNb;i++){lMatiere=this.donnees.GetElement(i);if(!lMatiere.visible){continue;}
T.push('<div class="InlineBlock" style="Margin:15px;">');T.push('<div class="',this.classesCss.casier,'" tabindex="0" style="position:relative; ',GStyle.composeWidth(lTaille),GStyle.composeHeight(lTaille)+'">');T.push('<div class="Table" style="position:absolute;',GStyle.composeCouleurFond(GCouleur.blanc),GStyle.composeBoxShadow({x:1,y:2,blur:1}),'">');T.push('<div class="PetitEspace">');lAvecPJ=false;if(lMatiere.nombres[EGenreRessourcePedagogique.documentJoint]>0||lMatiere.nombres[EGenreRessourcePedagogique.site]>0||lMatiere.nombres[EGenreRessourcePedagogique.QCM]>0||lMatiere.nombres[EGenreRessourcePedagogique.corrige]>0||lMatiere.nombres[EGenreRessourcePedagogique.kiosque]>0){lAvecPJ=true;}
T.push('<div class="AlignementMilieu GrandEspaceBas">','<div class="AlignementMilieu EspaceBas EspaceHaut" style="',GStyle.composeCouleurFond(lMatiere.couleur),'">','<span ',lAvecPJ?' id="'+(this.ids.matiereCasier+'_'+i+'_'+'-1')+'"':'',' class="Texte12 Gras ',(lAvecPJ?'AvecMain SouligneSurvol':''),'" style="',GStyle.composeCouleurTexte(GCouleur.getCouleurCorrespondance(lMatiere.couleur)),'">',lMatiere.GetLibelle(),'</span>','</div>','</div>');for(lProp in EGenreRessourcePedagogique){lGenre=EGenreRessourcePedagogique[lProp];if(lMatiere.nombres[lGenre]>0){lChaine='';switch(lGenre){case EGenreRessourcePedagogique.documentJoint:lChaine=lMatiere.nombres[lGenre]===1?GTraductions.getValeur('RessourcePedagogique.DocJoint_S'):GTraductions.getValeur('RessourcePedagogique.DocJoint');break;case EGenreRessourcePedagogique.site:lChaine=lMatiere.nombres[lGenre]===1?GTraductions.getValeur('RessourcePedagogique.SitesWeb_S'):GTraductions.getValeur('RessourcePedagogique.SitesWeb');break;case EGenreRessourcePedagogique.QCM:lChaine=lMatiere.nombres[lGenre]===1?GTraductions.getValeur('RessourcePedagogique.IDevoirs_S'):GTraductions.getValeur('RessourcePedagogique.IDevoirs');break;case EGenreRessourcePedagogique.corrige:lChaine=lMatiere.nombres[lGenre]===1?GTraductions.getValeur('RessourcePedagogique.Corriges_S'):GTraductions.getValeur('RessourcePedagogique.Corriges');break;case EGenreRessourcePedagogique.kiosque:lChaine=lMatiere.nombres[lGenre]===1?GTraductions.getValeur('RessourcePedagogique.Kiosque_S'):GTraductions.getValeur('RessourcePedagogique.Kiosque');break;}
T.push('<div class="AlignementMilieu PetitEspaceBas">','<span id="'+(this.ids.matiereCasier+'_'+i+'_'+lGenre)+'"',' class="Gras AvecMain SouligneSurvol">',GChaine.Format('%s %s',[lMatiere.nombres[lGenre],lChaine]),'</span>','</div>');}}
T.push('</div>');T.push('</div>');T.push('<div class="',this.classesCss.couvertureAvant,'"',' style="',GStyle.composeWidth(lTaille),GStyle.composeHeight(lTaille),GStyle.composeTransitions('transform','0.4s','ease','0s'),GStyle.composeCouleurFond(lMatiere.couleur),'z-index: 2;">');T.push('<div class="AlignementMilieu AlignementMilieuVertical Texte12"',' style="',GStyle.composeCouleurFond(lCouleurMatiere),GStyle.composeCouleurTexte(GCouleur.getCouleurCorrespondance(lCouleurMatiere)),GStyle.composeBoxShadow({x:0,y:3,blur:1}),'padding:10px;','">',lMatiere.GetLibelle(),'</div>');if(lAvecPJ){T.push('<div class="Image_CasierRessourcePedagogique"',' style="position:absolute; right:5px; top:',Math.round(lTaille/2),'px;','">','</div>');}
T.push('</div>');T.push('<div class="',this.classesCss.couvertureArriere,'"',' style="',GStyle.composeWidth(lTaille),GStyle.composeHeight(lTaille),GStyle.composeTransitions('transform','0.4s','ease','0s'),GStyle.composeCouleurFond(lMatiere.couleur),'">','</div>');T.push('</div>');T.push('</div>');}
T.push('</div>');T.push('</div>');$('#'+this.Nom.escapeJQ()).IEHtml(T.join(''),{controleur:this.controleur});this.surResizeInterface();$('.'+this.classesCss.casier).on({mouseenter:_surOuvertureCasier,focus:_surOuvertureCasier,mouseleave:GNavigateur.isTactile?undefined:_surFermetureCasier,blur:GNavigateur.isTactile?undefined:_surFermetureCasier,keyup:function(event){if(GNavigateur.IsToucheSelection()){var lInstance=event.data.instance,lIndiceMatiere=GHtml.extraireNombreDId($(this).find('div>div>div>span').get(0).id,1);var lMatiere=lInstance.donnees.GetElement(lIndiceMatiere);_switchAffichage.bind(lInstance)(false,lMatiere);}}},{classesCss:this.classesCss}).data('ouvert',false);$('.'+this.classesCss.casier).css({'transform-style':'preserve-3d','perspective':'800px','perspective-origin':'50% 50%'});$('.'+this.classesCss.couvertureAvant+', .'+this.classesCss.couvertureArriere).css({'transform-origin':'0 0 0','transform-style':'preserve-3d','backface-visibility':'hidden',position:'absolute',top:0,left:0});$('.'+this.classesCss.couvertureArriere).css('transform','rotateY(180deg) translateX(-100%)');$('[id^='+this.ids.matiereCasier.escapeJQ()+']').on('click',{instance:this},_surClickMatiere);}
function _surOuvertureCasier(event){var lElement=this;if(GNavigateur.isTactile)
$('.'+event.data.classesCss.casier).each(function(){if(lElement!==this&&$(this).data('ouvert')===true){_surFermetureCasier.bind(this)(event);}});if(IE.Support.avecSupportTransform&&!GNavigateur.IsIE9){$(this).find('.'+event.data.classesCss.couvertureAvant).css('transform','rotateY(-88deg)');$(this).find('.'+event.data.classesCss.couvertureArriere).css('transform','rotateY(92deg) translateX(-100%)');}
else{$(this).find('.'+event.data.classesCss.couvertureAvant+', .'+event.data.classesCss.couvertureArriere).css('display','none');}
$(this).data('ouvert',true);}
function _surFermetureCasier(event){if(IE.Support.avecSupportTransform&&!GNavigateur.IsIE9){$(this).find('.'+event.data.classesCss.couvertureAvant).css('transform','');$(this).find('.'+event.data.classesCss.couvertureArriere).css('transform','rotateY(180deg) translateX(-100%)');}
else{$(this).find('.'+event.data.classesCss.couvertureAvant+', .'+event.data.classesCss.couvertureArriere).css('display','');}
$(this).data('ouvert',false);}
function _ressourceDansListePeriodes(aRessource){var lResult=false,i,lNb,lPeriode;if(!aRessource.date)
return true;if(aRessource.listePeriodesDevoir){for(i=0,lNb=aRessource.listePeriodesDevoir.GetNbrElements();i<lNb;i++){if(this.parametres.periodes.GetElementParNumeroEtGenre(aRessource.listePeriodesDevoir.GetElement(i).GetNumero())){return true;}}
return false;}
this.parametres.periodes.parcourir(function(aPeriode){if(!aPeriode.dates){lPeriode=GParametres.listePeriodes.GetElementParNumero(aPeriode.GetNumero());if(lPeriode){aPeriode.dates=lPeriode.dates;}
else{;}}
if((aRessource.date>aPeriode.dates.debut&&aRessource.date<aPeriode.dates.fin)||GDate.estJourEgal(aRessource.date,aPeriode.dates.debut)||GDate.estJourEgal(aRessource.date,aPeriode.dates.fin)){lResult=true;return false;}});return lResult;}
function _ajouterElementDansMatiere(aElement,aMatiere){var lElementTrouve=aMatiere.ensembleDocuments.GetElementParElement(aElement.ressource);if(lElementTrouve){if(!lElementTrouve.dates){lElementTrouve.dates=[];lElementTrouve.dates.push(lElementTrouve.date);}
lElementTrouve.dates.push(aElement.ressource.date);}
else{aMatiere.ensembleDocuments.AddElement(aElement);}}
function _ajouterGenreDansMatiere(aGenre,aElement,aMatiere){aElement.genres.add(aGenre);aMatiere.nombres[aGenre]+=1;}
function _mettreAJourListesPJ(){var i,lNb,lMatiere,lSelf=this,lProp;function _parcoursDocuments(D){D.dates=null;if(!D.genres)
D.genres=new TypeEnsembleNombre();if(_ressourceDansListePeriodes.bind(lSelf)(D)&&(D.GetGenre()!==EGenreRessourcePedagogique.kiosque)){if(D.GetGenre()===EGenreRessourcePedagogique.QCM){if(window.GUtilitaires.QCM.estJouable(D.ressource))
_ajouterGenreDansMatiere(EGenreRessourcePedagogique.QCM,D,lMatiere);if(window.GUtilitaires.QCM.estCorrige(D.ressource))
_ajouterGenreDansMatiere(EGenreRessourcePedagogique.corrige,D,lMatiere);} else{_ajouterGenreDansMatiere(D.GetGenre(),D,lMatiere);}
_ajouterElementDansMatiere(D,lMatiere);}}
for(i=0,lNb=this.donnees.GetNbrElements();i<lNb;i++){lMatiere=this.donnees.GetElement(i);lMatiere.ensembleDocuments=new ObjetListeElements();lMatiere.nombres={};for(lProp in EGenreRessourcePedagogique){lMatiere.nombres[EGenreRessourcePedagogique[lProp]]=0;}
lMatiere.listeRessources.parcourir(_parcoursDocuments);lMatiere.visible=false;for(lProp in EGenreRessourcePedagogique){if(lMatiere.existeNumero()&&(lMatiere.nombres[EGenreRessourcePedagogique[lProp]]>0)){lMatiere.visible=true;}}}}
function _getMessageAucuneMatiere(){if(!this.donnees||this.donnees.GetNbrElements()===0){return GTraductions.getValeur('RessourcePedagogique.AucuneRessourcePeda');}
var lAucuneMatiere=true;this.donnees.parcourir(function(aMatiere){if(aMatiere.visible){lAucuneMatiere=false;return false;}});if(lAucuneMatiere){return GTraductions.getValeur('RessourcePedagogique.AucuneRessourcePedaPourPeriode');}}
ObjetInterfaceRessourcePedagogique.prototype._actualiserAffichage=function(){var T=[],lMsgAucuneMatiere=_getMessageAucuneMatiere.bind(this)();this.GetInstance(this.identBtnRetourCasier).SetVisible(!this.parametres.affichageCasier);if(this.parametres.affichageCasier){this.GetInstance(this.identZoneTexte).SetDonnees('&nbsp;');if(lMsgAucuneMatiere){$('#'+this.Nom.escapeJQ()).IEHtml('<div class="Texte10 AlignementMilieu GrandEspaceHaut">'+lMsgAucuneMatiere+'</div>');return;}
_construireCasiers.bind(this)();}
else{if(lMsgAucuneMatiere){$('#'+this.Nom.escapeJQ()).IEHtml('<div class="Texte10 AlignementMilieu GrandEspaceHaut">'+lMsgAucuneMatiere+'</div>');return;}
var lInstanceListe=this.GetInstance(this.identListe),lMatiere=this.donnees.GetElementParNumeroEtGenre(this.parametres.numeroMatiere);T.push('<div id="',this.ids.matiereListe,'" class="Espace">',this.composerCBs(false,false),'<div id="',lInstanceListe.GetNom(),'" class="Espace"></div>','</div>');T.push('</div>');$('#'+this.Nom.escapeJQ()).IEHtml(T.join(''),{controleur:this.controleur});this.surResizeInterface();this.GetInstance(this.identZoneTexte).SetDonnees(lMatiere.GetLibelle());lInstanceListe.Initialiser();lInstanceListe.SetDonnees(this.donneesListe=new DonneesListe_RessourcesPedagogiques(lMatiere,this.classesCss.classeRef,lInstanceListe.GetNom(),this.parametres.avecGenres,_callbackExecutionQCM.bind(this)));}};function _reponseRequeteCasier(aDonnees){this.donnees=aDonnees;_mettreAJourListesPJ.bind(this)();this._actualiserAffichage();}
function _envoieRequete(){new ObjetRequeteRessourcePedagogique(this,_reponseRequeteCasier.bind(this)).lancerRequete({avecRessourcesPronote:true,avecRessourcesEditeur:true});}
ObjetInterfaceRessourcePedagogique.prototype.RecupererDonnees=function(){_actualiserBoutonPeriodes.bind(this)();_envoieRequete.bind(this)();};ObjetInterfaceRessourcePedagogique.prototype.SetParametresGeneraux=function(){this.GenreStructure=EStructureAffichage.Autre;this.avecBandeau=true;this.AddSurZone=[this.identPeriodes,this.identBtnRetourCasier,this.identZoneTexte];};ObjetInterfaceRessourcePedagogique.prototype.surResizeInterface=function(){if(!this.parametres.affichageCasier){GPosition.declencherResize(this.ids.matiereListe);GPosition.declencherResize(this.GetInstance(this.identListe).GetNom());}};}());;
MethodesObjet.heritagePrototype(DonneesListe_DetailEvaluationsCompetences,ObjetDonneesListe);function DonneesListe_DetailEvaluationsCompetences(aDonnees){this.inheritedCreate(aDonnees);}
DonneesListe_DetailEvaluationsCompetences.genreColonne={evaluation:0,niveauAcqu:1};DonneesListe_DetailEvaluationsCompetences.prototype.GetCouleurCellule=function(I,D){return D.estUnDeploiement?this.ECouleurCellule.Deploiement:this.ECouleurCellule.Blanc;};DonneesListe_DetailEvaluationsCompetences.prototype.AvecSelection=function(I,D){return false;};DonneesListe_DetailEvaluationsCompetences.prototype.AvecEdition=function(I,D){return false;};DonneesListe_DetailEvaluationsCompetences.prototype.AvecSuppression=function(D){return false;};DonneesListe_DetailEvaluationsCompetences.prototype.AvecDeploiement=function(I){return true;};DonneesListe_DetailEvaluationsCompetences.prototype.GetValeur=function(I,D){switch(I){case DonneesListe_DetailEvaluationsCompetences.genreColonne.evaluation:return D.GetLibelle();case DonneesListe_DetailEvaluationsCompetences.genreColonne.niveauAcqu:if(D.GetGenre()===1){return EGenreNiveauDAcquisition.getImage(D.niveauAcqu,true);}
break;}
return'';};DonneesListe_DetailEvaluationsCompetences.prototype.getClass=function(I,D){switch(I){case DonneesListe_DetailEvaluationsCompetences.genreColonne.niveauAcqu:return' AlignementMilieu ';}};DonneesListe_DetailEvaluationsCompetences.prototype.GetTypeValeur=function(I,D){switch(I){case DonneesListe_DetailEvaluationsCompetences.genreColonne.evaluation:return this.ETypeCellule.Texte;case DonneesListe_DetailEvaluationsCompetences.genreColonne.niveauAcqu:return this.ETypeCellule.Html;}};function ObjetFenetre_DetailEvaluationsCompetences(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.idStrDomaine=IE.GUID.getId();}
MethodesObjet.heritagePrototype(ObjetFenetre_DetailEvaluationsCompetences,ObjetFenetre);ObjetFenetre_DetailEvaluationsCompetences.prototype.ConstruireInstances=function(){this.identListeEvaluations=this.Add(window.ObjetListe,null,this.initListeEvaluations);};ObjetFenetre_DetailEvaluationsCompetences.prototype.ComposeContenu=function(){var T=[];T.push('<div class="Texte10 Espace" id="',this.idStrDomaine,'"></div>');T.push('<div id="'+this.GetNomInstance(this.identListeEvaluations)+'" style="width: 100%; height: 90%"></div>');return T.join('');};ObjetFenetre_DetailEvaluationsCompetences.prototype.SetDonnees=function(aElt,aEleve,aJSON){this.Afficher();this.SetTitre((aElt.GetGenre()===1)?aElt.GetLibelle():aElt.service.GetLibelle());if(aElt.GetGenre()===2){GHtml.setHtml(this.idStrDomaine.escapeJQ(),aElt.strDomaine);}
else{$('#'+this.idStrDomaine.escapeJQ()).addClass('hide');}
this.listePourAffichage=new ObjetListeElements();var i,lNbr,lElt,lEltPereCourant;for(i=0,lNbr=aJSON.listeLignes.GetNbrElements();i<lNbr;i++){lElt=aJSON.listeLignes.GetElement(i);if(lElt.GetGenre()===0){lElt.estUnDeploiement=true;lElt.estDeploye=true;lElt.estPere=true;lElt.pere=null;lEltPereCourant=lElt;}
else{lElt.estUnDeploiement=false;lElt.estDeploye=false;lElt.estPere=false;lElt.pere=lEltPereCourant;}
this.listePourAffichage.AddElement(lElt);}
this.GetInstance(this.identListeEvaluations).SetDonnees(new DonneesListe_DetailEvaluationsCompetences(this.listePourAffichage));};ObjetFenetre_DetailEvaluationsCompetences.prototype.initListeEvaluations=function(aInstance){aInstance.SetParametres([GTraductions.getValeur('competence.itemsEvalues'),GTraductions.getValeur('competence.niveau')],['100%','50px']);};;
function ObjetBulletinCompetences(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.idPastillesEtatAcqu=IE.GUID.getId();}
MethodesObjet.heritagePrototype(ObjetBulletinCompetences,_ObjetBulletinEtReleve);ObjetBulletinCompetences.genreLigne={pilier:0,service:1,domaine:2};ObjetBulletinCompetences.prototype.composePageBulletin=function(){var H=[];H.push('<table ',GObjetWAI.composeRole(EGenreRole.Grid),' id="'+this.idPage+'" border="0" cellspacing="0" cellpadding="0">');H.push('<tr>');H.push('<td style="'+GStyle.composeCouleurBordure(GCouleur.liste.getBordure(),1,EGenreBordure.haut+EGenreBordure.droite)+'">'+this.composeLigneTitre()+'</td>');H.push('<td width="'+this.ScrollV.GetLargeur()+'"></td>');H.push('</tr>');H.push('<tr>');H.push('<td style="',GStyle.composeCouleurBordure(GCouleur.liste.getBordure(),1,EGenreBordure.droite),'"><div tabIndex="-1" id="' ,this.ScrollV.GetIdZone() ,'" onscroll="' ,this.Nom ,'.ScrollV.Actualiser (); " style="height:1px; overflow:hidden;">' ,this.composeBulletin() ,'</div></td>');H.push('<td id="'+this.ScrollV.GetIdScroll()+'"></td>');H.push('</tr>');H.push('</table>');return H.join('');};ObjetBulletinCompetences.prototype.actualiser=function(aArbreAccess){this.inherited('actualiser',aArbreAccess);$('[id^='+this.idPastillesEtatAcqu+']').on('click',{aObjet:this},function(event){var lThis=event.data.aObjet;var lIndLigne=$(this).attr('id').substring(lThis.idPastillesEtatAcqu.length,$(this).attr('id').length)-1;var lEltLigne=lThis.Liste.GetElement(lIndLigne);if(lEltLigne.avecDetail){var lParamEvnt={genreEvnt:EGenreEvenementNotesEtAppreciations.DetailEvaluationsCompetences,elt:lEltLigne};lThis.callback.appel(lParamEvnt);}});};ObjetBulletinCompetences.prototype.actualiserDimensions=function(aPourImpression,aNumeroImpression){this.inherited('actualiserDimensions',aPourImpression,aNumeroImpression);var lNbrNiveaux=8;if(this.Liste){var lLigne=this.Liste.GetElement(0);if(lLigne&&lLigne.etatAcqu&&lLigne.etatAcqu.listeNiveaux){lNbrNiveaux=lLigne.etatAcqu.listeNiveaux.GetNbrElements();}}
this.hauteurLigne=20;this.largeurNbr=80;this.largeurEtatAcqu=60*lNbrNiveaux;var lLargeurRestante=GPosition.getWidth(this.Nom)-this.ScrollV.GetLargeur()-10;if(this.maquette.avecNbEvals) lLargeurRestante-=(this.largeurNbr+1);if(this.maquette.avecEtatAcquisition) lLargeurRestante-=(this.largeurEtatAcqu+1);var lNbrColVariables=1;if(this.maquette.avecAppreciations) lNbrColVariables++;var lLargeurVariable=Math.floor((lLargeurRestante-lNbrColVariables)/lNbrColVariables);this.largeurMatiere=lLargeurVariable;this.largeurAppreciation=this.maquette.avecAppreciations?lLargeurVariable:0;};ObjetBulletinCompetences.prototype.composeLigneTitre=function(){var H=[];var lDefaut={bordGauche:true,bordBas:true,nbrLignes:1,role:EGenreRole.Columnheader};H.push('<table ',GObjetWAI.composeRole(EGenreRole.Row),' id="'+this.GetIdTitre()+'" class="Tableau '+this.taillePolice+'" border="0" cellpadding="0" cellspacing="0">');H.push('<tr height="'+this.HauteurTitre+'px">');H.push(this.composeTitre($.extend({},lDefaut,{libelle:GTraductions.getValeur('BulletinEtReleve.Matieres') ,taille:this.largeurMatiere ,bordGauche:false})));H.push(this.composeTitre($.extend({},lDefaut,{libelle:GTraductions.getValeur('competences.nbr') ,taille:this.largeurNbr ,visible:this.maquette.avecNbEvals ,title:GTraductions.getValeur('competences.nbrHint')})));H.push(this.composeTitre($.extend({},lDefaut,{libelle:GTraductions.getValeur('competences.etatAcquisition') ,taille:this.largeurEtatAcqu ,visible:this.maquette.avecEtatAcquisition})));H.push(this.composeTitre($.extend({},lDefaut,{libelle:GTraductions.getValeur('BulletinEtReleve.Appreciations'),taille:this.largeurAppreciation,visible:this.maquette.avecAppreciations})));H.push('</tr>');H.push('</table>');return H.join('');};ObjetBulletinCompetences.prototype.composeBulletin=function(){var H=[];H.push('<table id="'+this.ScrollV.GetIdContenu()+'" class="'+this.taillePolice+' FondBlanc" border="0" cellpadding="0" cellspacing="0">');var lLigne;var I,lNbr;if(this.Liste)
for(I=0,lNbr=this.Liste.GetNbrElements();I<lNbr;I++){lLigne=this.Liste.GetElement(I);H.push(this.composeLigne(lLigne,I));}
H.push('</table>');return H.join('');};ObjetBulletinCompetences.prototype.composeLookLigne=function(aParam){var lLook;switch(aParam.genreLigne){case ObjetBulletinCompetences.genreLigne.pilier:lLook={couleur:GCouleur.liste.cumul[0],avecGras:true};break;case ObjetBulletinCompetences.genreLigne.service:if(aParam.serviceSansEvaluation){lLook={couleur:GCouleur.liste.colonneFixe,avecGras:false};}
else lLook={couleur:GCouleur.liste.cumul[1],avecGras:true};break;case ObjetBulletinCompetences.genreLigne.domaine:lLook={couleur:GCouleur.liste.colonneFixe,avecGras:false};break;}
var H=[];H.push(' style="'+GStyle.composeCouleur(lLook.couleur.getFond(),lLook.couleur.getTexte())+GStyle.composeCouleurBordure(lLook.couleur.getBordure(),1,EGenreBordure.gauche+EGenreBordure.bas)+'" ');if(lLook.avecGras) H.push(' class="Gras" ');return H.join('');};ObjetBulletinCompetences.prototype.composeBarreEtatAcquisition=function(aEtatAcqu){var H=[];var lInfos=[];var i,lNbr,lElt;var n=aEtatAcqu.listeNiveaux.GetNbrElements();for(i=0;i<n;i++){var lNiveau=aEtatAcqu.listeNiveaux.GetElement(i);var lGenre=lNiveau.GetGenre();if((lGenre!==EGenreNiveauDAcquisition.Absent)&&(lGenre!==EGenreNiveauDAcquisition.NonEvalue))
lInfos.push({nb:lNiveau.nb*100/aEtatAcqu.listeNiveaux.total,color:lNiveau.couleur});}
H.push('<table class="Espace" height="100%" width="100%" border="0" cellspacing="0" cellpadding="0" ><tr>');for(i=0,lNbr=lInfos.length;i<lNbr;i++){lElt=lInfos[i];if(lElt.nb>0) H.push('<td style="border:1px solid black; background-color:',lElt.color,'" width="',lElt.nb,'%"></td>');}
H.push('</tr></table>');return H.join('');};ObjetBulletinCompetences.prototype.composePastillesOuAbbreviationEtatAcquisition=function(aEtatAcqu,aLigne,aGenreLigne){var H=[];var n=aEtatAcqu.listeNiveaux.GetNbrElements();var lInfos=[];var i,lNbr,lElt;for(i=0;i<n;i++){var lNiveau=aEtatAcqu.listeNiveaux.GetElement(i);lInfos.push({nb:lNiveau.nb,img:EGenreNiveauDAcquisition.getImage(lNiveau)});}
lElt=this.Liste.GetElement(aLigne-1);lElt.avecDetail=this.avecDetail&&aEtatAcqu.listeNiveaux.avecDetail&&(aGenreLigne!==ObjetBulletinCompetences.genreLigne.pilier);var lMain=lElt.avecDetail?'AvecMain':'';H.push('<table class="',lMain,'" id="',this.idPastillesEtatAcqu,aLigne,'" height="100%" width="100%" border="0" cellspacing="0" cellpadding="0"><tr>');for(i=0,lNbr=lInfos.length;i<lNbr;i++){lElt=lInfos[i];H.push('<td class="AlignementDroit AlignementMilieuVertical EspaceDroit" width="',100/lNbr,'%">');if(lElt.nb>0) H.push('<div class="InlineBlock" style="margin-right: 5px;">',lElt.nb,'</div><div class="InlineBlock AlignementMilieuVertical">',lElt.img,'</div></div>');H.push('</td>');}
H.push('</tr></table>');return H.join('');};ObjetBulletinCompetences.prototype.composeEtatAcquisitionBullCompetence=function(aParam){var lParam=this._getDefaultParam();$.extend(lParam,aParam);var H=[];if(lParam.visible){var lHtml=this._getHtmlCellule(lParam);H.push('<td class="AlignementMilieu'+(lParam.genreLigne===ObjetBulletinCompetences.genreLigne.pilier?' Gras':'')+'" ',lHtml.style,lHtml.largeur,lHtml.hauteur,lHtml.title,'>');if(lParam.donnees){lParam.donnees.listeNiveaux.total=0;lParam.donnees.listeNiveaux.avecDetail=false;var n=lParam.donnees.listeNiveaux.GetNbrElements();for(var i=0;i<n;i++){var lNiveau=lParam.donnees.listeNiveaux.GetElement(i);var lGenre=lNiveau.GetGenre();if((lGenre!==EGenreNiveauDAcquisition.Absent)&&(lGenre!==EGenreNiveauDAcquisition.NonEvalue))
lParam.donnees.listeNiveaux.total+=lNiveau.nb;if(lGenre!==EGenreNiveauDAcquisition.NonEvalue)
lParam.donnees.listeNiveaux.avecDetail=true;}
if((lParam.genreLigne===ObjetBulletinCompetences.genreLigne.pilier)&&!GParametres.afficherAbbreviationNiveauDAcquisition){H.push(this.composeBarreEtatAcquisition(lParam.donnees));}
else{H.push(this.composePastillesOuAbbreviationEtatAcquisition(lParam.donnees,lParam.ligne,lParam.genreLigne));}}
H.push('</td>');}
return H.join('');};ObjetBulletinCompetences.prototype.composeNbEvalBullCompetence=function(aParam){var lParam=this._getDefaultParam();$.extend(lParam,aParam);var H=[];if(lParam.visible){var lHtml=this._getHtmlCellule(lParam);H.push('<td class="AlignementMilieu" ',lHtml.style,lHtml.largeur,'>',lParam.libelle,'</td>');}
return H.join('');};ObjetBulletinCompetences.prototype._getHtmlCellule=function(aParam){return{style:this.composeLookLigne(aParam),largeur:' width="'+(aParam.taille?aParam.taille+'px':'auto')+'" ',hauteur:' height="'+(aParam.hauteur+'px')+'" ',colspan:(aParam.nbrCol>1)?' colspan="'+aParam.nbrCol+'" ':'',title:' title="'+aParam.title+'" '};};ObjetBulletinCompetences.prototype.composeAppreciationBullCompetence=function(aParam){var lParam=this._getDefaultParam();$.extend(lParam,aParam);var H=[];if(lParam.visible){switch(lParam.genreLigne){case ObjetBulletinCompetences.genreLigne.pilier:var lHtml=this._getHtmlCellule(lParam);H.push('<td class="AlignementMilieu" ',lHtml.style,lHtml.largeur,'></td>');break;case ObjetBulletinCompetences.genreLigne.service:if(!lParam.serviceSansEvaluation){var lElt=this.Liste.GetElement(lParam.ligne-1);lElt.ListeAppreciations=new ObjetListeElements();lElt.ListeAppreciations.AddElement(lParam.donnees);H.push(this.composeAppreciation({libelle:lParam.donnees.GetLibelle(),largeur:this.largeurAppreciation,saisie:true,rowspan:lParam.donnees.nbDomaines+1,ligne:lParam.ligne,col:1,hauteurLigne:(lParam.hauteur+1)*(lParam.donnees.nbDomaines+1)}));}
break;default:break;}}
return H.join('');};ObjetBulletinCompetences.prototype.composeMatiereBullCompetence=function(aParam){function _getPadding(aGenreLigne){switch(aGenreLigne){case ObjetBulletinCompetences.genreLigne.service:return 10;case ObjetBulletinCompetences.genreLigne.domaine:return 15;default:return 5;}}
var lParam=this._getDefaultParam();$.extend(lParam,aParam);var H=[];var lHtml=this._getHtmlCellule(lParam);var lChaineTronquee=GChaine.GetChaine(lParam.libelle,10,true,this.largeurMatiere-_getPadding(lParam.genreLigne));H.push('<td id="'+lParam.id+'" ',lHtml.style,lHtml.largeur,lHtml.hauteur,lHtml.colspan,'>');H.push('<div tabIndex="-1" style="padding-left: ',_getPadding(lParam.genreLigne),'px; overflow:hidden; height: ',lParam.hauteur,'px; line-height: ',lParam.hauteur,'px;" ',lHtml.title,'>',lChaineTronquee,'</div>');H.push('</td>');return H.join('');};ObjetBulletinCompetences.prototype._getNbrColonnes=function(){var lNbrCol=1;if(this.maquette.avecNbEvals) lNbrCol++;if(this.maquette.avecEtatAcquisition) lNbrCol++;if(this.maquette.avecAppreciations) lNbrCol++;return lNbrCol;};ObjetBulletinCompetences.prototype.composeLigne=function(aLigne,I){var H=[];var lDefault={genreLigne:aLigne.GetGenre()};if(!aLigne.sansEvaluation||(MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Professeur,EGenreEspace.Etablissement]))){if(aLigne.GetGenre()===ObjetBulletinCompetences.genreLigne.service) $.extend(lDefault,{serviceSansEvaluation:(aLigne.sansEvaluation)});H.push('<tr>');H.push(this.composeMatiereBullCompetence($.extend({},lDefault,{libelle:aLigne.GetLibelle(),id:this.GetIdLigne(this.NombreLignes++),title:aLigne.GetLibelle(),taille:this.largeurMatiere,nbrCol:lDefault.serviceSansEvaluation?this._getNbrColonnes():1})));if(!lDefault.serviceSansEvaluation){H.push(this.composeNbEvalBullCompetence($.extend({},lDefault,{libelle:(aLigne.nbEval?aLigne.nbEval:''),taille:this.largeurNbr,visible:this.maquette.avecNbEvals})));H.push(this.composeEtatAcquisitionBullCompetence($.extend({},lDefault,{title:(aLigne.etatAcqu?aLigne.etatAcqu.L:''),taille:this.largeurEtatAcqu,visible:this.maquette.avecEtatAcquisition,donnees:aLigne.etatAcqu,ligne:I+1})));H.push(this.composeAppreciationBullCompetence($.extend({},lDefault,{taille:this.largeurAppreciation,visible:this.maquette.avecAppreciations,donnees:aLigne.appreciation,ligne:I+1})));}
H.push('</tr>');}
return H.join('');};ObjetBulletinCompetences.prototype._getDefaultParam=function(){return{libelle:'',title:'',taille:null,nbrCol:1,genreLigne:0,hauteur:this.hauteurLigne,visible:false,donnees:null,id:''};};ObjetBulletinCompetences.prototype.SetDonnees=function(aParam){this.donneesRecues=true;this.Liste=aParam.listeLignes;this.maquette=aParam.maquette;this.avecDetail=aParam.avecDetail;this.Saisie=true;};;

ObjetBulletinCompetences.prototype.AfficherListe=function(){this._objetListeArborescente=new ObjetListeArborescente(this.Nom+'_Liste',0,this,null);var lRacine=this._objetListeArborescente.construireRacine();this._objetListeArborescente.setParametres(false);var lLigne;var I,lNbr;var lNoeudPilier,lNoeudService,lCourant;for(I=0,lNbr=this.Liste.GetNbrElements();I<lNbr;I++){lLigne=this.Liste.GetElement(I);switch(lLigne.GetGenre()){case 0:lNoeudPilier=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lRacine,'',lLigne.GetLibelle());lCourant=lNoeudPilier;break;case 1:lNoeudService=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lNoeudPilier,'',lLigne.GetLibelle());lCourant=lNoeudService;break;case 2:lCourant=this._objetListeArborescente.ajouterUnNoeudAuNoeud(lNoeudService,'',lLigne.GetLibelle());break;}
if(this.maquette.avecNbEvals&&lLigne.nbEval){this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lCourant,'',GTraductions.getValeur('competences.nbr')+' : '+lLigne.nbEval);}
if(this.maquette.avecEtatAcquisition&&lLigne.etatAcqu){this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lCourant,'',GTraductions.getValeur('competences.etatAcquisition')+' : '+lLigne.etatAcqu.L);}
if(this.maquette.avecAppreciations&&lLigne.appreciation&&lLigne.appreciation.GetLibelle()!==''){this._objetListeArborescente.ajouterUneFeuilleAuNoeud(lCourant,'',GTraductions.getValeur('BulletinEtReleve.Appreciations')+' : '+lLigne.appreciation.GetLibelle());}}
return lRacine;};;
function ObjetRequeteDetailEvaluationsCompetences(aPere,aEvenementSurReussite,aEvenementSurEchec){this.inheritedCreate(aPere,aEvenementSurReussite,aEvenementSurEchec);}
IE.Requetes.inscrire('DetailEvaluationsCompetences',ObjetRequeteDetailEvaluationsCompetences,_ObjetRequeteXmlConsultationPN);ObjetRequeteDetailEvaluationsCompetences.prototype.lancerRequete=function(aParam){this.JSON={eleve:aParam.eleve,relationsESI:aParam.numRelESI};this.appelAsynchroneConsultation();};ObjetRequeteDetailEvaluationsCompetences.prototype.actionApresRequete=function(){this.callbackReussite.appel(this.JSONReponse);};;
function ObjetRequeteBulletinCompetences(aPere,aEvenementSurReussite,aEvenementSurEchec){this.inheritedCreate(aPere,aEvenementSurReussite,aEvenementSurEchec);}
IE.Requetes.inscrire('BulletinCompetences',ObjetRequeteBulletinCompetences,_ObjetRequeteXmlConsultationPN);ObjetRequeteBulletinCompetences.prototype.lancerRequete=function(aParam){this.JSON={classe:aParam.classe,periode:aParam.periode,eleve:aParam.eleve};this.appelAsynchroneConsultation();};ObjetRequeteBulletinCompetences.prototype.actionApresRequete=function(aXml){this.callbackReussite.appel(this.JSONReponse,aXml);};;
function InterfaceBulletinCompetences_Parent(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.genreImpression=EGenreImpression.GenerationPDF;}
MethodesObjet.heritagePrototype(InterfaceBulletinCompetences_Parent,_PageResultat);(function(){InterfaceBulletinCompetences_Parent.prototype.ConstruireInstances=function(){this.identCombo=this.Add(window.ObjetSaisiePN,this._evenementSurCombo,this._initialiserCombo);this.identFenetreDetailEvaluations=this.addFenetre(window.ObjetFenetre_DetailEvaluationsCompetences,null,this.initFenetreDetailEvaluations);this.identBtnFicheGraphe=this.Add(window.ObjetBoutonBandeau,this.evtSurBtnFicheGraphe,this.initialiserBtnGraphe);this.identFicheGraphe=this.Add(window.ObjetFicheGraphe);this.IdentPage=this.Add(window.ObjetBulletinCompetences,this.evntBulletinCompetences);this.identPied=this.Add(window.PiedDeBulletin);};InterfaceBulletinCompetences_Parent.prototype.evntBulletinCompetences=function(aParam){switch(aParam.genreEvnt){case EGenreEvenementNotesEtAppreciations.DetailEvaluationsCompetences:new ObjetRequeteDetailEvaluationsCompetences(this,_reponseRequeteDetailEvaluations.bind(this,aParam)).lancerRequete({eleve:null,numRelESI:aParam.elt.NumerosRelationsESI});break;default:;break;}};InterfaceBulletinCompetences_Parent.prototype.initFenetreDetailEvaluations=function(aInstance){aInstance.SetParametres_Fenetre('',700,300,[GTraductions.getValeur('Fermer')]);};InterfaceBulletinCompetences_Parent.prototype.SetParametresGeneraux=function(){this.IdentZoneAlClient=this.IdentPage;this.AddSurZone=[this.identCombo,this.identBtnFicheGraphe];};InterfaceBulletinCompetences_Parent.prototype.RecupererDonnees=function(){this.listePeriodes=GEtatUtilisateur.getOngletListePeriodes();if(this.listePeriodes&&this.listePeriodes.GetNbrElements()){this.Instances[this.identBtnFicheGraphe].SetVisible(true);this.Instances[this.identCombo].SetVisible(true);this.Instances[this.identCombo].SetDonnees(this.listePeriodes);this.Instances[this.identCombo].setSelectionParElement(GEtatUtilisateur.getPeriode(),0);} else{this.Instances[this.identBtnFicheGraphe].SetVisible(false);this.Instances[this.identCombo].SetVisible(false);this.EvenementAfficherMessage(EGenreMessage.AucunBulletinDeCompetencesPourEleve);}};InterfaceBulletinCompetences_Parent.prototype._initialiserCombo=function(AInstance){AInstance.setOptions_ObjetSaisie({labelWAIZone:GTraductions.getValeur('WAI.ListeSelectionPeriode'),roleWAIEdit:EGenreRole.Option});};InterfaceBulletinCompetences_Parent.prototype._evenementSurCombo=function(aGenreEvenement,aElement){if(aGenreEvenement===EGenreEvenementObjetSaisie.selection){GEtatUtilisateur.Navigation.SetRessource(EGenreRessource.Periode,aElement);IE.Invocateur.evenement(IE.Invocateur.events.activationImpression,EGenreImpression.Aucune);this.afficherBandeau(false);new ObjetRequeteBulletinCompetences(this,_reponseRequeteBulletinCompetences.bind(this)).lancerRequete({classe:null,periode:aElement,eleve:null});}};function _getParametresPDF(){return{genreGenerationPDF:TypeHttpGenerationPDF.BulletinDeCompetences,periode:GEtatUtilisateur.Navigation.GetRessource(EGenreRessource.Periode),avecChoixGraphe:GEtatUtilisateur.getGenreOnglet()===EGenreOnglet.BulletinCompetences};}
function _reponseRequeteBulletinCompetences(aParam,aXml){if(aParam.Message)
this.EvenementAfficherMessage(aParam.Message);else{this.afficherBandeau(true);this.avecDetail=GEtatUtilisateur.getGenreOnglet()===EGenreOnglet.BulletinCompetences;aParam.avecDetail=this.avecDetail;this.GetInstance(this.IdentPage).SetDonnees(aParam);this.GetInstance(this.identBtnFicheGraphe).setLibelles([GTraductions.getValeur('competences.titreGraphe'),GTraductions.getValeur('competences.titreGraphe'),GTraductions.getValeur('competences.titreGraphe')]);this.GetInstance(this.identBtnFicheGraphe).setActif(this.avecDetail);GEtatUtilisateur.setGraphe({image:[aParam.grapheClasse,aParam.grapheNiveau],titre:GTraductions.getValeur('competences.titreGraphe'),message:GTraductions.getValeur('competences.pasDAffichageGraphe'),titreChoixGraphe:GTraductions.getValeur('competences.titreChoixGraphe'),libelleChoixGraphe:[GTraductions.getValeur('competences.choixGrapheClasse'),GTraductions.getValeur('competences.choixGrapheNiveau')]});GHtml.setDisplay(this.GetInstance(this.identPied).GetNom(),true);this.GetInstance(this.identPied).setDonnees_Absences(new UtilitaireDeserialiserPiedBulletin().creerAbsences(aXml));var lArbrePied=this.GetInstance(this.identPied).setDonnees_PiedDePage(new UtilitaireDeserialiserPiedBulletin().creerPiedDePage(aXml));this.GetInstance(this.IdentPage).actualiser(lArbrePied);this.surResizeInterface();if(GEtatUtilisateur.GenreEspace===EGenreEspace.Parent){IE.Invocateur.evenement(IE.Invocateur.events.activationImpression,this.genreImpression,this,_getParametresPDF.bind(this));}}}
InterfaceBulletinCompetences_Parent.prototype.EvenementAfficherMessage=function(aGenreMessage){GHtml.setDisplay(this.GetInstance(this.identPied).GetNom(),false);this.inherited('EvenementAfficherMessage',aGenreMessage);this.surResizeInterface();};function _reponseRequeteDetailEvaluations(aParam,aJSON){this.GetInstance(this.identFenetreDetailEvaluations).SetDonnees(aParam.elt,GEtatUtilisateur.getMembre(),aJSON);}}());;
MethodesObjet.heritagePrototype(ObjetFenetre_SelecteurTeinte,ObjetFenetre);function ObjetFenetre_SelecteurTeinte(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.teinte=0;this.dragging=false;}
ObjetFenetre_SelecteurTeinte.prototype.SurValidation=function(aNumeroBouton){this.Fermer();this.callback.appel(aNumeroBouton,aNumeroBouton===1?this.teinte:null);};ObjetFenetre_SelecteurTeinte.prototype.SetDonnees=function(aTeinte){if($.isNumeric(aTeinte)) this.calculTeinte(aTeinte);};ObjetFenetre_SelecteurTeinte.prototype.ComposeContenu=function(){var lWidth=80;var T=[];T.push('<div  style="position:relative;">');T.push('<div id="'+this.Nom+'_colors" style="position:absolute;top:10px;left:10px;">');T.push('<div id="'+this.Nom+'_color_0" style="position:absolute;left:0px;width:',lWidth,'px;height:46px;background-color:#000;border:#000 1px solid;">&nbsp;</div>');T.push('<div id="'+this.Nom+'_color_1" style="position:absolute;left:',(lWidth+12)*1,'px;width:',lWidth,'px;height:46px;background-color:#000;border:#000 1px solid;">&nbsp;</div>');T.push('<div id="'+this.Nom+'_color_2" style="position:absolute;left:',(lWidth+12)*2,'px;width:',lWidth,'px;height:46px;background-color:#000;border:#000 1px solid;">&nbsp;</div>');T.push('<div id="'+this.Nom+'_color_3" style="position:absolute;left:',(lWidth+12)*3,'px;width:',lWidth,'px;height:46px;background-color:#000;border:#000 1px solid;">&nbsp;</div>');T.push('</div>');T.push('<div id="'+this.Nom+'_color_picker" style="position:absolute;top:70px;left:10px;height:50px;width:360px;">');T.push('<div id="'+this.Nom+'_rule" style="position:absolute;top:10px;left:0;right:0;height:30px;cursor:pointer;"></div>');T.push('<div id="'+this.Nom+'_hand" class="Image_TeinteIndicateur" style="position:absolute;top:4px;left:'+(this.teinte-4)+'px;cursor:pointer;">&nbsp;</div>');T.push('</div>');T.push('</div>');return T.join('');};ObjetFenetre_SelecteurTeinte.prototype.RecupererDonnees=function(){this.inherited('RecupererDonnees');var lJqRule=$('#'+this.Nom.escapeJQ()+'_rule');for(var i=0;i<360;i++){var lHsl={h:i,s:50,l:80};lJqRule.append('<span style="height:30px;width:1px;background-color:'+GCouleur.HSLToCouleur(lHsl)+';display:inline-block;"></span>');}
$('#'+this.Nom.escapeJQ()+'_hand').mousedown({aObjet:this},function(event){event.data.aObjet.dragging=true;}).mouseup({aObjet:this},function(event){event.data.aObjet.dragging=false;});$('#'+this.Nom.escapeJQ()+'_color_picker').mousemove({aObjet:this},function(event){if(event.data.aObjet.dragging){var lLeft=Math.round(event.pageX-$(this).offset().left);if(lLeft<0)lLeft=0;else if(lLeft>360)lLeft=359;$(this).children('[id$=_hand]').css('left',lLeft-4);event.data.aObjet.calculTeinte(lLeft);}});$('#'+this.Nom.escapeJQ()+'_rule').click({aObjet:this},function(event){var lLeft=Math.round(event.pageX-$(this).parent().offset().left);$(this).parent().children('[id$=_hand]').css('left',lLeft-4);event.data.aObjet.calculTeinte(lLeft);}).mousedown({aObjet:this},function(event){event.data.aObjet.dragging=true;}).mouseup({aObjet:this},function(event){event.data.aObjet.dragging=false;});this.calculTeinte();$('#'+this.Nom.escapeJQ()+'_rule').parentsUntil('[id="zone_fenetre"]');};ObjetFenetre_SelecteurTeinte.prototype.calculTeinte=function(aTeinte){if(aTeinte!==undefined&&(aTeinte!==null&&aTeinte!==undefined)) this.teinte=aTeinte;var lCouleurs=GThemesCouleurs.getCouleursDeTeinte(this.teinte);$('#'+this.Nom.escapeJQ()+'_colors').children().each(function(index){$(this).css('background-color',lCouleurs[ index===0?ECouleurDeTheme.Claire:index===1?ECouleurDeTheme.Moyen1:index===2?ECouleurDeTheme.Foncee:ECouleurDeTheme.Sombre]);});};;
function InterfaceParametresUtilisateur(aNom,aIdent,aPere,aEvenement){this.inheritedCreate(aNom,aIdent,aPere,aEvenement);this.parametres={largeurGauche:150,nombreZones:0};}
IE.MethodesObjet.heritagePrototype(InterfaceParametresUtilisateur,ObjetInterfacePage);(function(){InterfaceParametresUtilisateur.prototype.SetParametresGeneraux=function(){this.GenreStructure=EStructureAffichage.Autre;this.avecBandeau=true;};function _getLibelleHtmlTheme(aLibelle,aCouleur){var H=[];H.push('<div class="AlignementGauche" style="width: 100%; height: 14px; padding:1px 0;">','<div class="InlineBlock AlignementMilieuVertical" style="width: 12px; height: 12px; '+GStyle.composeCouleurBordure('black')+' '+GStyle.composeCouleurFond(aCouleur)+'">','&nbsp;','</div>','<div class="PetitEspaceGauche InlineBlock AlignementMilieuVertical" style="line-height: 14px;">',aLibelle,'</div>','</div>');return H.join('');}
InterfaceParametresUtilisateur.prototype.getControleur=function(){return{theme:{comboTheme:{init:function(aInstance){aInstance.setOptions_ObjetSaisie({labelWAIZone:GTraductions.getValeur('WAI.ListeSelectionTheme'),roleWAIZone:EGenreRole.Menuitem,roleWAIEdit:EGenreRole.Option,labelWAIEdit:GObjetWAI.getInfo(EGenreObjet.NavigationHorizontalAvecValidation),celluleAvecTexteHtml:true});},getDonnees:function(aDonnees){if(!aDonnees){var lListe=IE.MethodesObjet.dupliquer(GThemesCouleurs.listeThemes),i,lTheme,lGenreCouleurAffichee=ECouleurDeTheme.Foncee;for(i=0;i<lListe.GetNbrElements();i++){lTheme=lListe.GetElement(i);lTheme.libelleHtml=_getLibelleHtmlTheme(lTheme.GetLibelle(),GThemesCouleurs.getCouleurDuTheme(lGenreCouleurAffichee,true,lTheme.GetGenre()));}
lTheme=new ObjetElement('',-1,EThemeCouleur.Personnalise);lTheme.libelleHtml=_getLibelleHtmlTheme(GTraductions.getValeur('theme.Personnalise'),GThemesCouleurs.getCouleursDeTeinte(GApplication.parametresUtilisateur.get('theme.teinte'))[lGenreCouleurAffichee]);lListe.AddElement(lTheme);lListe.setTri([ObjetTri.init(function(D){return D.GetGenre()!==EThemeCouleur.Personnalise;}),ObjetTri.init('Libelle')]);lListe.trier();return lListe;}},getIndiceSelection:function(aInstance){var lTheme=GApplication.parametresUtilisateur.get('theme.theme');var lIndice=0;aInstance.ListeElements.parcourir(function(D,aIndice){if(D.GetGenre()===lTheme){lIndice=aIndice;return false;}});return lIndice;},event:function(aParametres,aCombo){if(aParametres.genreEvenement===EGenreEvenementObjetSaisie.selection&&aCombo.InteractionUtilisateur){if(aParametres.element.GetGenre()===EThemeCouleur.Personnalise){_ouvrirFenetreTeinte.call(this.instance);}
else{GApplication.parametresUtilisateur.set('theme.theme',aParametres.element.GetGenre());IE.Invocateur.evenement('appelManuel_modificationTheme');}}},getDisabled:function(){return GEtatUtilisateur.estModeAccessible();}}},accueil:{cbAfficherPageAccueil:{getValue:function(){return GApplication.parametresUtilisateur.get('demarrerSurPageAccueil');},setValue:function(aValue){GApplication.parametresUtilisateur.set('demarrerSurPageAccueil',aValue);}}},notification:{cbNotification:{getValue:function(){return GApplication.parametresUtilisateur.get('utiliserNotification');},setValue:function(aValue){GApplication.parametresUtilisateur.set('utiliserNotification',aValue);}}},EDT:{comboCouleur:{init:function(aInstance){aInstance.setOptions_ObjetSaisie({});},getDonnees:function(aDonnees){if(!aDonnees){var lListeLignes=new ObjetListeElements(),lElement;lElement=new ObjetElement(GTraductions.getValeur('ParametresUtilisateur.CouleurMatieres'));lElement.couleurClasse=false;lListeLignes.AddElement(lElement);lElement=new ObjetElement(GTraductions.getValeur('ParametresUtilisateur.CouleurClasses'));lElement.couleurClasse=true;lListeLignes.AddElement(lElement);this.instance.listeChoixCDTCouleur=lListeLignes;return lListeLignes;}},getIndiceSelection:function(){var lCouleurClasse=GApplication.parametresUtilisateur.get('EDT.couleurClasse');var lIndice=0;this.instance.listeChoixCDTCouleur.parcourir(function(D,index){if(D.couleurClasse===lCouleurClasse){lIndice=index;return false;}});return lIndice;},event:function(aParametres){if(aParametres.genreEvenement===EGenreEvenementObjetSaisie.selection){GApplication.parametresUtilisateur.set('EDT.couleurClasse',aParametres.element.couleurClasse);}},getDisabled:function(){return GApplication.getModeExclusif();}}},CDT:{cbMatiereIdentique:{getValue:function(){return GApplication.parametresUtilisateur.get('CDT.Navigation.MatiereIdentique');},setValue:function(aValue){GApplication.parametresUtilisateur.set('CDT.Navigation.MatiereIdentique',aValue);},getDisabled:function(){return GApplication.getModeExclusif();}},rbType:{getValue:function(aGenre){return aGenre===GApplication.parametresUtilisateur.get('CDT.Navigation.TypeCours');},setValue:function(aGenre){GApplication.parametresUtilisateur.set('CDT.Navigation.TypeCours',aGenre);},getDisabled:function(){return GApplication.getModeExclusif();}}}};};function _evenementSurFenetreTeinte(aBouton,aTeinte){if(aBouton===1){GApplication.parametresUtilisateur.set('theme',{theme:EThemeCouleur.Personnalise,teinte:Math.round(aTeinte)});IE.Invocateur.evenement('appelManuel_modificationTheme');}}
function _ouvrirFenetreTeinte(){var lFenetre=ObjetFenetre.creerInstance(window.ObjetFenetre_SelecteurTeinte,{pere:this,evenement:_evenementSurFenetreTeinte,initialiser:false});lFenetre.SetParametres_Fenetre(GTraductions.getValeur('Commande.FenetreTeinte.Titre'),392,175,[GTraductions.getValeur('Annuler'),GTraductions.getValeur('Valider')],true);var lTheme=GApplication.parametresUtilisateur.get('theme');lFenetre.SetDonnees(lTheme&&lTheme.teinte&&lTheme.teinte>=0&&lTheme.teinte<360?lTheme.teinte:0);lFenetre.Initialiser();lFenetre.Afficher();}
function _construireZone(aTitre,aContenu,aDecalageLibelle){var H=[];if(this.parametres.nombreZones>0){H.push('<div class="GrandEspaceHaut" style="',GStyle.composeCouleurBordure(GCouleur.texte,1,EGenreBordure.bas),'"></div>');}
H.push('<div class="NoWrap' ,(this.parametres.nombreZones>0?' GrandEspaceHaut':''),'">');H.push('<div class="WhiteSpaceNormal InlineBlock Gras AlignementHaut"',' style="',GStyle.composeWidth(this.parametres.largeurGauche),GStyle.composeCouleurTexte(GCouleur.texte),'">','<span class="GrandEspaceDroit"',(aDecalageLibelle?' style="position:relative; top:'+aDecalageLibelle+'px;"':''),'>',aTitre,'</span>','</div>');H.push(aContenu);H.push('</div>');this.parametres.nombreZones+=1;return H.join('');}
function _construireTheme(){var H=[];H.push('<div class="InlineBlock">');H.push('<div class="NoWrap">');H.push('<div class="InlineBlock AlignementMilieuVertical">',GTraductions.getValeur('ParametresUtilisateur.Theme'),'</div>');H.push('<ie-combo ie-model="theme.comboTheme" class="InlineBlock AlignementMilieuVertical PetitEspaceGauche"></ie-combo>');if(GEtatUtilisateur.estModeAccessible())
H.push('<div class="InlineBlock AlignementMilieuVertical EspaceGauche Gras" style="color:red">',GTraductions.getValeur('ParametresUtilisateur.ModeAccessible'),'</div>');H.push('</div>');H.push('</div>');return H.join('');}
function _construirePageAccueil(){var H=[];H.push('<div class="InlineBlock">');H.push('<ie-checkbox ie-model="accueil.cbAfficherPageAccueil">',GTraductions.getValeur('ParametresUtilisateur.AfficherAccueilDemarrage'),'</ie-checkbox>');H.push('</div>');return H.join('');}
function _construireNotification(){var H=[];H.push('<div class="InlineBlock">');H.push('<ie-checkbox ie-model="notification.cbNotification">',GTraductions.getValeur('ParametresUtilisateur.UtiliserNotification'),'</ie-checkbox>');H.push('</div>');return H.join('');}
function _construireEDT(){var H=[];H.push('<div class="InlineBlock">');H.push('<div class="NoWrap">');H.push('<div class="InlineBlock AlignementMilieuVertical">',GTraductions.getValeur('ParametresUtilisateur.LabelCouleur'),'</div>');H.push('<ie-combo ie-model="EDT.comboCouleur" class="InlineBlock AlignementMilieuVertical PetitEspaceGauche"></ie-combo>');H.push('</div>');H.push('<div class="Italique EspaceHaut">',GTraductions.getValeur('ParametresUtilisateur.TipCouleursDesCours'),'</div>');H.push('</div>');return H.join('');}
function _construireCDT(){var H=[];H.push('<div class="InlineBlock">');H.push('<div>',GTraductions.getValeur('ParametresUtilisateur.NavigationCoursCDT')+' :','</div>','<div class="GrandEspaceGauche">');H.push('<div class="EspaceHaut">','<ie-checkbox ie-model="CDT.cbMatiereIdentique">',GTraductions.getValeur('ParametresUtilisateur.CoursMatiereIdentique'),'</ie-checkbox>','</div>','<div class="EspaceHaut">','<div>','<ie-radio ie-model="CDT.rbType(0)">',GTraductions.getValeur('ParametresUtilisateur.CoursRessourceIdentique'),'</ie-radio>','</div>','<div class="PetitEspaceHaut">','<ie-radio ie-model="CDT.rbType(1)">',GTraductions.getValeur('ParametresUtilisateur.CoursRessourceCommune'),'</ie-radio>','</div>','<div class="PetitEspaceHaut">','<ie-radio ie-model="CDT.rbType(2)">',GTraductions.getValeur('ParametresUtilisateur.CoursEleveCommun'),'</ie-radio>','</div>','</div>');H.push('</div>');H.push('</div>');return H.join('');}
InterfaceParametresUtilisateur.prototype.ConstruireStructureAffichageAutre=function(){var H=[];H.push('<div class="Texte10 Table">');H.push('<div style="padding:20px;">');H.push(_construireZone.call(this,GTraductions.getValeur('PersonnaliserTheme'),_construireTheme.call(this),3));if(GEtatUtilisateur.GenreEspace===EGenreEspace.Professeur||GEtatUtilisateur.GenreEspace===EGenreEspace.Etablissement)
H.push(_construireZone.call(this,GTraductions.getValeur('ParametresUtilisateur.PageAccueil'),_construirePageAccueil.call(this)));if(GApplication.notificationActive&&(GEtatUtilisateur.GenreEspace===EGenreEspace.Professeur||GEtatUtilisateur.GenreEspace===EGenreEspace.Etablissement)){H.push(_construireZone.call(this,GTraductions.getValeur('ParametresUtilisateur.Notification'),_construireNotification.call(this)));}
if(GEtatUtilisateur.GenreEspace===EGenreEspace.Professeur||GEtatUtilisateur.GenreEspace===EGenreEspace.Etablissement)
H.push(_construireZone.call(this,GTraductions.getValeur('ParametresUtilisateur.CouleursDesCours'),_construireEDT.call(this),3));if(GEtatUtilisateur.GenreEspace===EGenreEspace.Professeur)
H.push(_construireZone.call(this,GTraductions.getValeur('ParametresUtilisateur.cahierDeTextes'),_construireCDT.call(this)));H.push('</div>');H.push('</div>');return H.join('');};}());;

MethodesObjet.heritagePrototype(ObjetInterfaceEspace,_ObjetInterfaceEspaceCP);function ObjetInterfaceEspace(ANom,AIdent,APere,AEvenement){this.inheritedCreate(ANom,AIdent,APere,AEvenement);if(IE.optionsEspaceLocal&&IE.optionsEspaceLocal.getModeAccessible(GEtatUtilisateur.GenreEspace)){GEtatUtilisateur.setModeAccessible(true);GClass.setModeAccessible(GEtatUtilisateur.estModeAccessible());}
this._modifierTheme();if(IE.Support.supportEventOnPopState)
$(window).bind('popstate',{instance:this},this._surPopState);this.idBaliseFichierExport=IE.GUID.getId();this.interfaces={};IE.Invocateur.abonner('appelManuel_modificationTheme',this._rechargerSurModificationTheme,this);}(function(){var uInterfaces={};ObjetInterfaceEspace.prototype.ConstruireInstances=function(){this.IdentBandeauEntete=this.Add(window.ObjetAffichageBandeauEntete,this.evenementCommande);this.IdentPage=this.Add(window.ObjetInterfaceVide);this.construireInstancesPDFEtImpression();if(MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Professeur,EGenreEspace.Parent,EGenreEspace.Etablissement])||GEtatUtilisateur.avecCommunication())
this.identFenetreCommunication=this.addFenetre(window.ObjetFenetre_Communication);if(MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Parent,EGenreEspace.Eleve]))
this.identFenetreKiosque=this.addFenetre(window.ObjetFenetre_Kiosque,null,this._initialiserFenetreKiosque);if(MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Parent]))
this.identFenetreMembre=this.addFenetre(window.ObjetFenetre_Membre,null,this._initialiserFenetreCompteEnfant);if(GEtatUtilisateur.urlInstallClient)
this.IdentFenetreInstallationPronote=this.addFenetre(window.ObjetFenetre_InstallPronote,null,this.InitialiserFenetreInstallPronote);if(GEtatUtilisateur.GenreEspace===EGenreEspace.Professeur)
this.identFenetreImportFichierProf=this.addFenetre(window.ObjetFenetre_ImportFichierProf);};ObjetInterfaceEspace.prototype.construireInstancesPDFEtImpression=function(){this.inherited('construireInstancesPDFEtImpression');var lSelf=this;this.identFenetreGenerationPdf=this.addFenetre(window.ObjetFenetre_GenerationPdfSco,function(aNumeroBouton,aParametresAffichage,aOptionsPDF){if(aNumeroBouton===1){IE.GenerationPDF.genererPDF({paramPDF:aParametresAffichage,optionsPDF:aOptionsPDF});}
lSelf.GetInstance(lSelf.IdentBandeauEntete)._gestionFocus_apresFenetreGenerationPdf();});};ObjetInterfaceEspace.prototype.DetruireInstances=function(){this.inherited('DetruireInstances');$(window).unbind('popstate');};ObjetInterfaceEspace.prototype.focusAuDebut=function(){this.GetInstance(this.IdentBandeauEntete).focusAuDebut();};ObjetInterfaceEspace.prototype._initialiserFenetreKiosque=function(aInstance){aInstance.SetParametres_Fenetre(GTraductions.getValeur('Commande.FenetreKiosque.Titre'),null,null,[GTraductions.getValeur('Fermer')],false);aInstance.setOptionsFenetre({avecAbonnementFermetureFenetreGenerale:false});};ObjetInterfaceEspace.prototype._initialiserFenetreCompteEnfant=function(aInstance){aInstance.SetParametres_Fenetre('',750,550,[GTraductions.getValeur('Annuler'),GTraductions.getValeur('Valider')]);aInstance.setOptionsFenetre({avecMessageValidationAuto:true});};ObjetInterfaceEspace.prototype.InitialiserFenetreInstallPronote=function(AInstance){AInstance.SetParametres_Fenetre(GTraductions.getValeur('InstallPronote.titre'),400,120,new Array(GTraductions.getValeur('principal.fermer')));AInstance.SetParametres(GEtatUtilisateur.urlInstallClient,GEtatUtilisateur.urlParamClient,GEtatUtilisateur.designationClient);};ObjetInterfaceEspace.prototype.SetParametresGeneraux=function(){this.AvecCadre=false;};ObjetInterfaceEspace.prototype.ConstruireStructureAffichage=function(){var H=[];H.push(GApplication.getCommunication().composeIFrameFichier());H.push(GMessageInformatif.Compose());H.push(this.IdentBarreProgression>=0?'<div id="'+this.GetInstance(this.IdentBarreProgression).GetNom()+'"></div>':'');H.push('<table id="',this.Nom,'_T" style="width:100%; ',GStyle.composeCouleurFond(GCouleur.fond),'" border="0" cellpadding="0" cellspacing="0">',this.IdentBandeauEntete>=0?'<tr class="AvecMenuContextuel" style="height: 10px" id="'+this.getIdLigne(this.IdentBandeauEntete)+'"><td id="'+this.GetInstance(this.IdentBandeauEntete).GetNom()+'"></td></tr>':'',this.IdentPage>=0?'<tr id="'+this.getIdLigne(this.IdentPage)+'" '+GObjetWAI.composeRole(EGenreRole.Main)+'><td class="AlignementHaut" id="'+this.GetInstance(this.IdentPage).GetNom()+'"><div style="height:100%"></div></td></tr>':'',this.IdentBasDePage>=0?'<tr style="height: 10px" id="'+this.getIdLigne(this.IdentBasDePage)+'"><td id="'+this.GetInstance(this.IdentBasDePage).GetNom()+'"></td></tr>':'',this.IdentMessageAvertissementCAS>=0?'<tr style="height: 10px" id="'+this.getIdLigne(this.IdentMessageAvertissementCAS)+'"><td id="'+this.GetInstance(this.IdentMessageAvertissementCAS).GetNom()+'"></td></tr>':'','</table>');return H.join('');};ObjetInterfaceEspace.prototype.surResizeInterface=function(){if(this.IdentPage&&this.GetInstance(this.IdentPage)){var lPage=GHtml.getElement(this.GetInstance(this.IdentPage).GetNom());if(GNavigateur.isTactile){GPosition.setHeight(lPage,100,false,'%');GPosition.setHeight(this.Nom+'_T',100,false,'%');}
else{GPosition.setHeight(lPage,1);var lHeight=Math.max(10,document.body.clientHeight-GPosition.getHeight(this.Nom+'_T')+GPosition.getHeight(lPage));GPosition.setHeight(lPage,lHeight+(GNavigateur.IsIE?-1:0));}}};ObjetInterfaceEspace.prototype.getIdLigne=function(aIdent){return this.GetInstance(aIdent).GetNom()+'_';};ObjetInterfaceEspace.prototype.actualiser=function(){this.Initialiser(true);this.GetInstance(this.IdentBandeauEntete).SetDonnees(this.connexion.libelle,this.connexion.listeEleves,this.connexion.messageConnexion);window.Invocateur.evenement(window.Invocateur.events.choixImpression,EGenreImpression.Aucune);this.surResizeInterface();};ObjetInterfaceEspace.prototype.SetDonnees=function(aLibelle,aListeEleves,aMessageConnexion){this.connexion={};this.connexion.libelle=aLibelle;this.connexion.listeEleves=aListeEleves;this.connexion.messageConnexion=aMessageConnexion;_initialisationOnglets();this.actualiser();if(GNavigateur.IEModeCompatible){GApplication.getMessage().Afficher(EGenreBoiteMessage.Information,'',GTraductions.getValeur('ModeCompatible'));}};ObjetInterfaceEspace.prototype.evenementCommande=function(aParam){switch(aParam.genreCmd){case EGenreCommande.Accueil:{_evenementSurClickOnglet.bind(this)(EGenreOnglet.Accueil);break;}
case EGenreCommande.ChangerOnglet:{var lOnglet=aParam.onglet;_evenementSurClickOnglet.bind(this)(lOnglet.GetGenre(),aParam.ignorerHistorique);break;}
case EGenreCommande.Impression:{this.surEvenementSurImpression();break;}
case EGenreCommande.Validation:{this.EvenementSurValidation();break;}
case EGenreCommande.Accessibilite:{this.EvenementSurAccessibilite();break;}
case EGenreCommande.Communication:{this.EvenementSurCommunication(false);break;}
case EGenreCommande.Kiosque:{this.EvenementSurKiosque();break;}
case EGenreCommande.BoutonMembre:{this.EvenementSurBoutonMembre();break;}
case EGenreCommande.IManuel:{this.evenementSurIManuel();break;}
case EGenreCommande.OngletIManuel:this.changementManuelOnglet(EGenreOnglet.IManuels);break;case EGenreCommande.ExportFichierProf:new window.ObjetRequeteSaisieExportFichierProf({},function(aEchec,aUrl){if(aEchec||!aUrl){return;}
window.location.assign(GChaine.GetChainePourUrl(aUrl,true));}).lancerRequete();break;case EGenreCommande.ImportFichierProf:if(GApplication.getModeExclusif()){GApplication.getMessage().afficher({type:EGenreBoiteMessage.Information,titre:GTraductions.getValeur('ModeExclusif.UsageExclusif'),message:GTraductions.getValeur('ModeExclusif.SaisieImpossibleConsultation')});}
else this.GetInstance(this.identFenetreImportFichierProf).SetDonnees();break;case EGenreCommande.Tutoriel:{this.evenementSurTutoriel();break;}
case EGenreCommande.Aide:{this.EvenementSurAide();break;}
case EGenreCommande.TelechargerClient:{this.evenementSurTelechargerClient();break;}
case EGenreCommande.AccesMobile:{this.evenementSurAccesMobile();break;}
case EGenreCommande.Twitter:{this.ouvrirTwitter();break;}
default:;break;}};ObjetInterfaceEspace.prototype._surPopState=function(event){if(GNavigateur.getBloquerClavier()){this._surForward=true;window.history.forward();return;}
var lEtat=event.originalEvent.state,lInstance=event.data.instance;if(!lEtat||lEtat.onglet===undefined||lEtat.numeroSession!==GApplication.getCommunication().NumeroDeSession){GApplication.getMessage().Afficher(EGenreBoiteMessage.Confirmation,null,GTraductions.getValeur('connexion.ConfirmezDeconnexion'),null,lInstance,_evenementPrecedentDeconnexion);}
else{if(lInstance._surForward){delete lInstance._surForward;return;}
lInstance.EvenementSurNavigation(lInstance,{ignorerHistorique:true,onglet:lEtat.onglet});}};function _evenementPrecedentDeconnexion(aAccepte){if(aAccepte===EGenreAction.Valider){window.location.reload();}
else{this._surForward=true;window.history.forward();}}
function _evenementSurClickOnglet(aGenreOnglet,aIgnorerHistorique){if(aGenreOnglet===null||aGenreOnglet===undefined)
return;if(!aIgnorerHistorique&&(aGenreOnglet!==null&&aGenreOnglet!==undefined)&&IE.Support.supportEventOnPopState){try{window.history.pushState({onglet:aGenreOnglet,numeroSession:GApplication.getCommunication().NumeroDeSession},'');} catch(e){}}
GEtatUtilisateur.setGenreOnglet(aGenreOnglet);var lIFCBandeau=this.GetInstance(this.IdentBandeauEntete);if(lIFCBandeau){lIFCBandeau.actualiserLibelleOnglet();lIFCBandeau.GetInstance(lIFCBandeau.identMenuOnglets)._fermer();}
IE.Invocateur.evenement(IE.Invocateur.events.fermerFenetres);window.Invocateur.evenement(window.Invocateur.events.activationImpression,EGenreImpression.Aucune);if(this.Instances[this.IdentPage]&&this.Instances[this.IdentPage].free){this.Instances[this.IdentPage].free();}
this.Instances[this.IdentPage]=null;new ObjetRequeteNavigation(this,_actionSurEvenementSurClickOnglet).lancerRequete(aGenreOnglet);}
ObjetInterfaceEspace.prototype.getPage=function(){return this.GetInstance(this.IdentPage);};function _actionSurEvenementSurClickOnglet(){GHtml.setHtml('bandeau','');GHtml.setDisplay(GApplication.idLigneBandeau,false);this.Instances[this.IdentPage]=this.CreerPage(GEtatUtilisateur.getGenreOnglet());if(this.Instances[this.IdentPage])
GHtml.setHtml(this.Instances[this.IdentPage].GetNom(),'');else ;this.SetEtatSaisie(false);GEtatUtilisateur.SetPageCourante(this.Instances[this.IdentPage]);if(this.Instances[this.IdentPage])
IE.Invocateur.evenement(IE.Invocateur.events.choixImpression,this.Instances[this.IdentPage].genreImpression);this.surResizeInterface();if(this.Instances[this.IdentPage])
this.Instances[this.IdentPage].Initialiser();if(this.GetInstance(this.IdentBandeauEntete)){this.GetInstance(this.IdentBandeauEntete).actualiserBreadcrumb(GEtatUtilisateur.getGenreOnglet());var lInstanceMenuOnglet=this.GetInstance(this.IdentBandeauEntete).getInstanceMenuOnglet();if(lInstanceMenuOnglet) lInstanceMenuOnglet.setOngletPN(GEtatUtilisateur.getGenreOnglet());var lInstanceMenuPlus=this.GetInstance(this.IdentBandeauEntete).getInstanceMenuPlus();if(lInstanceMenuPlus) lInstanceMenuPlus.setOngletPN(GEtatUtilisateur.getGenreOnglet());var lInstanceMenuRessources=this.GetInstance(this.IdentBandeauEntete).getInstanceMenuRessources();if(lInstanceMenuRessources) lInstanceMenuRessources.setOngletPN(GEtatUtilisateur.getGenreOnglet());var lInstanceOngletUtilisateur=this.GetInstance(this.IdentBandeauEntete).getInstanceOngletUtilisateur();if(lInstanceOngletUtilisateur) lInstanceOngletUtilisateur.setOngletPN(GEtatUtilisateur.getGenreOnglet());var lInstanceOngletAccueil=this.GetInstance(this.IdentBandeauEntete).getInstanceMenuAccueil();if(lInstanceOngletAccueil) lInstanceOngletAccueil.setOngletPN(GEtatUtilisateur.getGenreOnglet());if(GEtatUtilisateur.premierChargement&&GEtatUtilisateur.getGenreOnglet()===EGenreOnglet.Accueil) this.GetInstance(this.IdentBandeauEntete).focusAuDebut();else if($('#'+GApplication.idBreadcrumb.escapeJQ()+':visible').length===1) $('#'+GApplication.idBreadcrumb.escapeJQ()).focus();else if($('#'+GApplication.idBreadcrumbPerso.escapeJQ()).length===1) $('#'+GApplication.idBreadcrumbPerso.escapeJQ()).focus();else if($('#'+this.GetInstance(this.IdentPage).idPremierObjet.escapeJQ()).length===1) $('#'+this.GetInstance(this.IdentPage).idPremierObjet.escapeJQ()).focus();else ;}
GEtatUtilisateur.resetPage();}
ObjetInterfaceEspace.prototype.changementManuelOnglet=function(aGenreOnglet){var lInterfaceBandeau=this.GetInstance(this.IdentBandeauEntete);if(lInterfaceBandeau&&lInterfaceBandeau.GetInstance(lInterfaceBandeau.identMenuOnglets))
lInterfaceBandeau.GetInstance(lInterfaceBandeau.identMenuOnglets).selectionnerSousOnglet(aGenreOnglet);else{;_evenementSurClickOnglet.bind(this)(aGenreOnglet);}};ObjetInterfaceEspace.prototype.SetFocus=function(){GHtml.setFocus('DebutdelaPage');};ObjetInterfaceEspace.prototype.RecupererDonnees=function(){this.surResizeInterface();};ObjetInterfaceEspace.prototype.CreerPage=function(AGenreOnglet){if(GLog.getActif()) GLog.addLog('Interface Construire Onglet n° '+AGenreOnglet+' - '+MethodesObjet.nomProprieteDeValeur(EGenreOnglet,AGenreOnglet),'OBJETINTERFACE_LOGNOM');var LObjetPage=this.ConstruireObjetGraphique(uInterfaces[AGenreOnglet],this.IdentPage,null);return LObjetPage;};ObjetInterfaceEspace.prototype.InitialiserMessageAttente=function(){};ObjetInterfaceEspace.prototype.initialiserEntete=function(){this.Instances[this.NombreGenreAffichage].SetParametres(20,GParametres.NomEspace,true,GParametres.NomEtablissement,'right');};ObjetInterfaceEspace.prototype.getEtatSaisie=function(){return GEtatUtilisateur.EtatSaisie;};ObjetInterfaceEspace.prototype.setVisibleKiosque=function(aVisibleKiosque){this.GetInstance(this.IdentBandeauEntete).setVisibleKiosque(aVisibleKiosque);};ObjetInterfaceEspace.prototype.EvenementSurValidation=function(){var lInstance=this.GetInstance(this.IdentPage);if(GApplication.getDemo())
alert(GTraductions.getValeur('Demo.Message'));if(lInstance.Valider)
lInstance.Valider();};ObjetInterfaceEspace.prototype._rechargerSurModificationTheme=function(aTheme){this.EvenementSurNavigation(this,{surModificationTheme:true,theme:aTheme});};ObjetInterfaceEspace.prototype.EvenementSurAccessibilite=function(){var lInstance=this.GetInstance(this.IdentPage);if(((lInstance!==null&&lInstance!==undefined))&&lInstance.activerFichesEleve)
lInstance.activerFichesEleve(false);GEtatUtilisateur.setModeAccessible(!GEtatUtilisateur.estModeAccessible());GClass.setModeAccessible(GEtatUtilisateur.estModeAccessible());this._rechargerSurModificationTheme();};ObjetInterfaceEspace.prototype._modifierTheme=function(aTheme){document.body.className=GClass.getScroll();GParametres.initialiserCouleur(aTheme);};ObjetInterfaceEspace.prototype.EvenementSurCommunication=function(aModeDiscussion){var lThis=this;this.setCallbackInitFenetre(this.identFenetreCommunication,function(aInstance){aInstance.SetParametres_Fenetre(GTraductions.getValeur('fenetreCommunication.titre'),aModeDiscussion?650:750,450,[GTraductions.getValeur('Fermer')]);aInstance.modeDiscussion=aModeDiscussion;if(!aModeDiscussion){aInstance.setOptionsFenetre({callback:function(){lThis.GetInstance(lThis.IdentBandeauEntete)._gestionFocus_apresFenetreCommunication();}});}});this.GetInstance(this.identFenetreCommunication).Afficher();};ObjetInterfaceEspace.prototype.EvenementSurBoutonMembre=function(){this.GetInstance(this.identFenetreMembre).Afficher();};ObjetInterfaceEspace.prototype.EvenementSurKiosque=function(){this.GetInstance(this.identFenetreKiosque).SetDonnees();};ObjetInterfaceEspace.prototype.evenementSurIManuel=function(aEANManuel){if(!this.requeteSSONathanEnCous&&window.ObjetRequeteSSONathan){this.requeteSSONathanEnCous=true;this.pageNathan=window.open(IE.UtilitaireMessageHtml.construireUrl(IE.Enum.EGenreMessageHtml.patienceNathan));new window.ObjetRequeteSSONathan(this,this.actionSurRequeteSSONathan_Succes,this.actionSurRequeteSSONathan_Echec).lancerRequete(aEANManuel);}};ObjetInterfaceEspace.prototype.actionSurRequeteSSONathan_Succes=function(aUrlSSO){this.requeteSSONathanEnCous=false;if(aUrlSSO)
this.pageNathan.location.href=aUrlSSO;};ObjetInterfaceEspace.prototype.actionSurRequeteSSONathan_Echec=function(aMessage){if(this.pageNathan)
this.pageNathan.close();this.requeteSSONathanEnCous=false;GApplication.getMessage().Afficher(EGenreBoiteMessage.Information,null,aMessage);};ObjetInterfaceEspace.prototype.evenementSurFermenutreFenetreNathan=function(aIdNathan){this.RetourSurNavigation();};ObjetInterfaceEspace.prototype.actionSurFermenutreFenetreNathan=function(){this.RetourSurNavigation();};ObjetInterfaceEspace.prototype.evenementSurAccesMobile=function(){var lUrl=window.location.href.split('/');var lNomEspace=lUrl.pop();lUrl=lUrl.join('/')+'/mobile'+'.'+lNomEspace;var lFenetreMobile=window.open(lUrl,"mobile","toolbar=no, location=no, directories=no, status=no, scrollbars=yes, resizable=no, copyhistory=no, width=370px, height=610px");setTimeout(function(){lFenetreMobile.window.hookAccesDepuisEspace=function(){lFenetreMobile.window.$('#GInterface_message').html('<div style="width:175px;margin:0 auto;background-color:#fff;">'+$('<div />').qrcode({render:'div',size:175,text:lUrl}).html()+'</div>');};},100);};ObjetInterfaceEspace.prototype.ouvrirTwitter=function(){window.open('https://twitter.com/pronote');};ObjetInterfaceEspace.prototype.evenementSurTutoriel=function(){window.open(GEtatUtilisateur.getUrlTutoriel());};ObjetInterfaceEspace.prototype.EvenementSurAide=function(){window.open(GParametres.urlManuel);};ObjetInterfaceEspace.prototype.evenementSurTelechargerClient=function(){this.GetInstance(this.IdentFenetreInstallationPronote).Afficher();};ObjetInterfaceEspace.prototype.RaccourcisClavier=function(){var lNumeroClavier=GNavigateur.GetToucheAltNum(0,9);if(!GNavigateur.estInterfaceBloque()&&(lNumeroClavier!==null&&lNumeroClavier!==undefined))
this.GetInstance(this.IdentBandeauEntete).evenementRaccourcisClavier(lNumeroClavier);};ObjetInterfaceEspace.prototype.controleTouche=function(aEvent){var lInstance=aEvent.data.instance;if(lInstance.inherited('controleTouche',aEvent))
return;if(aEvent.which===ToucheClavier.Shift||aEvent.which===ToucheClavier.Ctrl||aEvent.which===ToucheClavier.Alt)
return;if(!GNavigateur.estInterfaceBloque()&&aEvent.originalEvent.ctrlKey){switch(aEvent.which){case 77:if(!aEvent.originalEvent.shiftKey)
lInstance.GetInstance(lInstance.IdentBandeauEntete).evenementRaccourcisClavier(0);break;default:}
if(aEvent.originalEvent.altKey&&aEvent.originalEvent.shiftKey){var lNumeroClavier= -1;if(aEvent.which>47&&aEvent.which<58) lNumeroClavier=aEvent.which-ToucheClavier._0;switch(lNumeroClavier){case 0:case 9:case 1:lInstance.GetInstance(lInstance.IdentBandeauEntete).evenementRaccourcisClavier(lNumeroClavier);break;case 2:lInstance.GetInstance(lInstance.IdentPage).FocusSurPremierElement();break;default:}}}};ObjetInterfaceEspace.prototype.actualisationF5=function(){this.EvenementSurNavigation(this,{ignorerHistorique:true,onglet:GEtatUtilisateur.getGenreOnglet()});};ObjetInterfaceEspace.prototype.RetourSurNavigation=function(aParametres){if(aParametres&&aParametres.surModificationTheme){this.SetEtatSaisie(false);this._modifierTheme(aParametres.theme);this.actualiser();this.GetInstance(this.IdentBandeauEntete).selectionnerSousOnglet(GEtatUtilisateur.getGenreOnglet());}
else if(aParametres&&aParametres.ignorerHistorique){this.GetInstance(this.IdentBandeauEntete).evenementSurMenuOnglets(new ObjetElement('',0,aParametres.onglet),true);}
else if(!MethodesObjet.isUndefined(GEtatUtilisateur.getGenreOnglet()))
this.GetInstance(this.IdentBandeauEntete).evenementSurMenuOnglets(new ObjetElement('',0,GEtatUtilisateur.getGenreOnglet()));};ObjetInterfaceEspace.prototype.getLibelleSousOnglet=function(aLibelle,aAvecNom,aAvecClasse,aAvecGroupe,aSansLibelleOnglet){return this.GetInstance(this.IdentBandeauEntete).getLibelleSousOnglet(aLibelle,aAvecNom,aAvecClasse,aAvecGroupe,aSansLibelleOnglet);};ObjetInterfaceEspace.prototype.surEvenementFenetreImpression=function(){this.GetInstance(this.IdentBandeauEntete)._gestionFocus_apresFenetreImpression();};ObjetInterfaceEspace.prototype.getConstructeurs=function(){return uInterfaces;};function _initialisationOnglets(){uInterfaces[EGenreOnglet.Accueil]=window.ObjetAffichagePageAccueil;uInterfaces[EGenreOnglet.Informations]=window.ObjetAffichagePageActualites;uInterfaces[EGenreOnglet.Vacances]=window.ObjetAffichagePageVacances;uInterfaces[EGenreOnglet.Releve]=window.PageResultatReleve;uInterfaces[EGenreOnglet.Dossiers]=window.ObjetAffichagePageDossiers;uInterfaces[EGenreOnglet.Remplacements_Grille]=window.ObjetAffichagePageRemplacements;uInterfaces[EGenreOnglet.Remplacements_Tableau]=window.ObjetAffichagePageRemplacements;uInterfaces[EGenreOnglet.Agenda]=window.ObjetAffichagePageAgenda;uInterfaces[EGenreOnglet.Menus]=window.ObjetAffichagePageMenus;uInterfaces[EGenreOnglet.Bulletins]=window.PageResultatBulletins;uInterfaces[EGenreOnglet.Orientation]=window.ObjetAffichagePageListeOrientations;uInterfaces[EGenreOnglet.SaisieOrientation]=window.ObjetAffichagePageOrientations;uInterfaces[EGenreOnglet.EmploiDuTemps]=window.ObjetAffichagePageEmploiDuTemps;uInterfaces[EGenreOnglet.EmploiDuTempsEleve]=window.ObjetAffichagePageEmploiDuTemps;uInterfaces[EGenreOnglet.EmploiDuTempsClasse]=window.ObjetAffichagePageEmploiDuTemps;uInterfaces[EGenreOnglet.EmploiDuTempsSalle]=window.ObjetAffichagePageEmploiDuTemps;uInterfaces[EGenreOnglet.EmploiDuTempsProfesseur]=window.ObjetAffichagePageEmploiDuTemps;uInterfaces[EGenreOnglet.EmploiDuTempsPersonnelEtablissement]=window.ObjetAffichagePageEmploiDuTemps;uInterfaces[EGenreOnglet.Absences_Recapitulatif]=window.ObjetAffichagePagePresence;uInterfaces[EGenreOnglet.Absences_Liste]=window.ObjetAffichagePagePresence;uInterfaces[EGenreOnglet.Absences_HeuresManquees]=window.ObjetAffichagePagePresence;uInterfaces[EGenreOnglet.InfosPerso]=window.ObjetInterfaceCompte;uInterfaces[EGenreOnglet.CompteEleve]=window.ObjetInterfaceCompteEnfant;uInterfaces[EGenreOnglet.InfoMedicale]=window.ObjetAffichagePageInformationsMedicales;uInterfaces[EGenreOnglet.AutorisationSortie]=window.InterfaceAutorisationSortie;uInterfaces[EGenreOnglet.SaisieNotes]=window.ObjetAffichagePageNotes;uInterfaces[EGenreOnglet.SaisieCahierDeTextes]=window.ObjetAffichagePageSaisieCahierDeTextes;uInterfaces[EGenreOnglet.CahierDeTexte_Progression]=window.ObjetAffichagePageCahierDeTexteProgression;uInterfaces[EGenreOnglet.Affectation_Progression]=window.InterfacePageAffectationProgression;uInterfaces[EGenreOnglet.ProgrammesBO]=window.InterfacePageProgrammesBO;uInterfaces[EGenreOnglet.SaisieAbsences_AppelEtSuivi]=window.ObjetAffichagePageSaisieAbsences;uInterfaces[EGenreOnglet.SaisieAbsences_Appel]=window.ObjetAffichagePageSaisieAbsences;uInterfaces[EGenreOnglet.SaisieAbsences_Appel_Professeur]=window.ObjetAffichagePageSaisieAbsences;uInterfaces[EGenreOnglet.FicheBrevet]=window.PageFicheBrevet;uInterfaces[EGenreOnglet.EquipePedagogique]=window.ObjetAffichageEquipePedagogique;uInterfaces[EGenreOnglet.RecapAbsences]=window.InterfaceRecapAbsences;uInterfaces[EGenreOnglet.RecapFeuilleAppel]=window.InterfaceRecapFeuilleAppel;uInterfaces[EGenreOnglet.RecapPunitions]=window.InterfaceRecapPunitions;if(GEtatUtilisateur.GenreEspace===EGenreEspace.Professeur){uInterfaces[EGenreOnglet.Graphique_Profil]=window.ObjetAffichageGraphique_ParClasse;uInterfaces[EGenreOnglet.Graphique_Evolution]=window.ObjetAffichageGraphique_ParClasse;}
else{uInterfaces[EGenreOnglet.Graphique_Profil]=window.ObjetAffichageGraphique;uInterfaces[EGenreOnglet.Graphique_Evolution]=window.ObjetAffichageGraphique;}
uInterfaces[EGenreOnglet.SaisieAppreciationDeFinDeStage]=window.ObjetAffichagePageAppreciationDeFinDeStage;uInterfaces[EGenreOnglet.ConseilDeClasse]=window.PageResultatConseilDeClasse;uInterfaces[EGenreOnglet.SuiviPluriannuel]=window.ObjetAffichagePageSuiviPluriannuel;uInterfaces[EGenreOnglet.Competences_Releve]=window.InterfacePageCompetences_Releve;uInterfaces[EGenreOnglet.B2I_ParEleve]=window.InterfacePageCompetences_ReleveB2I;uInterfaces[EGenreOnglet.B2I_ParCompetence]=window.InterfacePageCompetences_Grille;uInterfaces[EGenreOnglet.Competences_Grille]=window.InterfacePageCompetences_Grille;uInterfaces[EGenreOnglet.Evaluation]=window.InterfacePageCompetences_Evaluation;uInterfaces[EGenreOnglet.ListeEvaluation]=window.ObjetAffichagePageListeEvaluations;uInterfaces[EGenreOnglet.ListeEvaluationHistorique]=window.ObjetAffichagePageListeEvaluations;uInterfaces[EGenreOnglet.SaisieAppreciationsBulletin]=window.PageAppreciationsBulletin;uInterfaces[EGenreOnglet.SaisieAppreciationsFicheBrevet]=window.PageAppreciationsFicheBrevet;uInterfaces[EGenreOnglet.SaisieAppreciationsGenerales]=window.PageAppreciationsGenerales;uInterfaces[EGenreOnglet.SaisieAppreciationsReleve]=window.PageAppreciationsReleve;uInterfaces[EGenreOnglet.LivretScolaire_Fiche]=window.InterfaceLivretScolaire;uInterfaces[EGenreOnglet.LivretScolaire_Appreciations]=window.InterfaceLivretScolaire;uInterfaces[EGenreOnglet.LivretScolaire_Competences]=window.InterfaceLivretScolaire;uInterfaces[EGenreOnglet.ResultatsClasses]=window.ObjetAffichagePageResultatsClasses;uInterfaces[EGenreOnglet.ListePersonnelEtablissement]=window.ObjetAffichagePagePersonnelAdministrative;uInterfaces[EGenreOnglet.Punitions]=window.ObjetAffichagePagePunitions;uInterfaces[EGenreOnglet.Dispenses]=window.ObjetAffichagePageDispenses;uInterfaces[EGenreOnglet.AbsencesEtRetards]=window.ObjetAffichagePageAbsencesEtRetards;uInterfaces[EGenreOnglet.SuivisAbsenceRetard]=window.ObjetAffichagePageSuivisAbsenceRetard;uInterfaces[EGenreOnglet.Entreprise]=window.ObjetAffichagePageEntreprise;uInterfaces[EGenreOnglet.TrombinoscopeClasse]=window.PageTrombinoscopeClasse;uInterfaces[EGenreOnglet.Trombinoscope_Professeur]=window.PageTrombinoscopeClasse;uInterfaces[EGenreOnglet.Trombinoscope_Personnel]=window.PageTrombinoscopeClasse;uInterfaces[EGenreOnglet.Saisie_CarnetCorrespondance]=window.ObjetAffichagePageSaisieCarnetCorrespondance;uInterfaces[EGenreOnglet.IManuels]=window.ObjetInterfacePageManuelsEleves;uInterfaces[EGenreOnglet.QCM_Saisie]=window.InterfaceSaisieQCM_PN;uInterfaces[EGenreOnglet.QCM_Bibliotheque]=window.InterfacePageBibliothequeQCM;uInterfaces[EGenreOnglet.QCM_BibliothequeNathan]=window.InterfacePageBibliothequeQCM;if((GEtatUtilisateur.GenreEspace===EGenreEspace.Professeur)||(GEtatUtilisateur.GenreEspace===EGenreEspace.Etablissement)){uInterfaces[EGenreOnglet.CDT_TAF]=window.ObjetAffichagePageCahierDeTextesParClasse;uInterfaces[EGenreOnglet.CDT_Contenu]=window.ObjetAffichagePageCahierDeTextesParClasse;} else{uInterfaces[EGenreOnglet.CDT_TAF]=window.ObjetAffichagePageCahierDeTexte;uInterfaces[EGenreOnglet.CDT_Contenu]=window.ObjetAffichagePageCahierDeTexte;}
uInterfaces[EGenreOnglet.CahierDeTexte]=window.ObjetAffichagePageCahierDeTexte;uInterfaces[EGenreOnglet.Rencontre_Indisponibilites]=window.InterfaceRencontreIndisponibilites;uInterfaces[EGenreOnglet.CreneauxLibres]=window.InterfaceCreneauxLibres;uInterfaces[EGenreOnglet.Rencontre_Planning_Liste]=window.InterfaceRencontrePlanning;uInterfaces[EGenreOnglet.Rencontre_Planning_Grille]=window.InterfaceRencontrePlanning;uInterfaces[EGenreOnglet.Rencontre_Desideratas]=window.InterfaceRencontreDesiderata;uInterfaces[EGenreOnglet.SaisieOffresStage]=window.PageSaisieOffresStages;uInterfaces[EGenreOnglet.OffresStage]=window.PageOffresStages;uInterfaces[EGenreOnglet.RessourcePedagogique]=window.ObjetInterfaceRessourcePedagogique;if(IE.MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Parent,EGenreEspace.Eleve])){uInterfaces[EGenreOnglet.BulletinCompetences]=window.InterfaceBulletinCompetences_Parent;uInterfaces[EGenreOnglet.BulletinCompetencesClasse]=window.InterfaceBulletinCompetences_Parent;}
else{uInterfaces[EGenreOnglet.BulletinCompetences]=window.InterfaceBulletinCompetences;}
uInterfaces[EGenreOnglet.Casier_Documents]=window.InterfaceCasier;uInterfaces[EGenreOnglet.Casier_MonCasier]=window.InterfaceCasier;uInterfaces[EGenreOnglet.ListeEleves]=window.InterfaceListeRessources;uInterfaces[EGenreOnglet.ListeClasses]=window.InterfaceListeRessources;uInterfaces[EGenreOnglet.ListeGroupes]=window.InterfaceListeRessources;uInterfaces[EGenreOnglet.ListeProfesseurs]=window.InterfaceListeRessources;uInterfaces[EGenreOnglet.ListeResponsables]=window.InterfaceListeRessources;uInterfaces[EGenreOnglet.ListePersonnels]=window.InterfaceListeRessources;uInterfaces[EGenreOnglet.Messagerie]=window.InterfaceListeMessagerie;uInterfaces[EGenreOnglet.Incidents]=window.InterfaceIncidents;uInterfaces[EGenreOnglet.ParametresUtilisateur]=window.InterfaceParametresUtilisateur;uInterfaces[EGenreOnglet.ListeStagiaires]=window.InterfaceListeStagiaires;uInterfaces[EGenreOnglet.CoursNonAssures]=window.InterfaceCoursNonAssures;uInterfaces[EGenreOnglet.BibliothequeProgression]=window.InterfaceBibliothequeProgression;uInterfaces[EGenreOnglet.ListeDevoirSurTable]=window.InterfaceListeDevoirSurTable;}})();;
var EGenreOrientationAffichage={Vertical:0,Horizontal:1};var EGenreConnexion={Normale:0,Allegee:1};var GNavigateur;var GInterface;var GParametres;var GEtatUtilisateur;var GMessageInformatif;function Start(aParam){GApplication=new ObjetApplicationPNEspace();GApplication.lancer(aParam);}
MethodesObjet.heritagePrototype(ObjetApplicationPNEspace,ObjetApplicationProduits);function ObjetApplicationPNEspace(){this.inheritedCreate();}(function(){ObjetApplicationPNEspace.prototype.initialisation=function(aParametres){if(!window.GOptionsMsgChargement)
window.GOptionsMsgChargement={etat:1};$('#'+this.getIdConteneur().escapeJQ()).jIEInterdireSelectionTexte();$(document).jIEDesactiverMenuContextuel();GHtml.demarrerOmbreFocus();try{this.setCommunication(new _ObjetCommunication(aParametres.genreEspace,aParametres.numeroSession));GEtatUtilisateur=new ObjetEtatUtilisateur(aParametres.genreEspace);GEtatUtilisateur.premierChargement=true;this.notificationActive=false;GTableau.editable=aParametres.genreEspace===EGenreEspace.Professeur;} catch(e){window.messageErreur('Erreur sur initialisation de "GCommunication"');}
GThemesCouleurs.initialiser();};ObjetApplicationPNEspace.prototype.initialisationApresParametres=function(aParametres){this.inherited('initialisationApresParametres',aParametres);if(GParametres.NomEspace)
document.title=document.title+' - '+GParametres.NomEspace;GMessageInformatif=new ObjetMessageInformatif('GMessageInformatif');GHtml.setHtml(this.getIdConteneur(),GMessageInformatif.Compose());GApplication.getCommunication().demarrerPolling();GObjetWAI=new ObjetWAI();GEtatUtilisateur.Initialiser();if(this.estDebug()){this.creerFenetreDebug();}
GInterface=new ObjetInterfaceIdentification('GInterface',null,null,null);GInterface.Initialiser();if(this.acces.estConnexionCAS()){GInterface.traiterEvenementValidation(this.acces.utilisateur.identifiant,this.acces.utilisateur.password,true);} else if((!GApplication.getDemo())&&(GEtatUtilisateur.GenreEspace!==EGenreEspace.Commun)&&this.getDebug()&&this.getDebug().optionsDebug.identificationAuto&&this.getDebug().optionsDebug.getLogin(GEtatUtilisateur.GenreEspace)&&this.getDebug().optionsDebug.getMdp(GEtatUtilisateur.GenreEspace)){GInterface.traiterEvenementValidation(this.getDebug().optionsDebug.getLogin(GEtatUtilisateur.GenreEspace),this.getDebug().optionsDebug.getMdp(GEtatUtilisateur.GenreEspace));GLog.addLog('Tentative connexion automatique DEBUG');}
_finLoadingScript.call(this);};ObjetApplicationPNEspace.prototype.getOptionsDebug=function(){return new IEClasses.ObjetOptionsEspace_Debug(true);};ObjetApplicationPNEspace.prototype.getConstructeursDebug=function(){return{constructeurFenetre:IEClasses.ObjetFenetre_Debug,constructeurTraitements:IEClasses.ObjetTraitementEspace_Debug};};ObjetApplicationPNEspace.prototype.avecGestionModeExclusif=function(){return GEtatUtilisateur.Identification;};ObjetApplicationPNEspace.prototype.afficherEspaceApresAuthentification=function(aParametres){if(this._scriptsCharges)
_afficherEspaceApresAuthentification.call(this,aParametres);else{this._authentification=aParametres;IE.Invocateur.evenement(IE.Invocateur.events.eventIOAjax,{emission:true});}};function _finLoadingScript(){this._scriptsCharges=true;if(this._authentification){IE.Invocateur.evenement(IE.Invocateur.events.eventIOAjax,{emission:false});_afficherEspaceApresAuthentification.call(this,this._authentification);}}
function _afficherEspaceApresAuthentification(aParametres){if(GInterface&&GInterface._DetruireInstances)
GInterface._DetruireInstances();GInterface=new ObjetInterfaceEspace('GInterface',null,null,null);GInterface.SetDonnees(aParametres.libelle,aParametres.listeRessource);this.getCommunication().activerPresence();if(GEtatUtilisateur.getGenreOnglet())
GInterface.GetInstance(GInterface.IdentBandeauEntete).evenementSurMenuOnglets(new ObjetElement('',0,GEtatUtilisateur.getGenreOnglet()));if(this.avecGestionModeExclusif()){if(this.getModeExclusif())
this.entreeModeExclusif();}
GInterface.focusAuDebut();}
ObjetApplicationPNEspace.prototype.initialisationObjetsPage=function(){return;};}());;
